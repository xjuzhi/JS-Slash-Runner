import*as __WEBPACK_EXTERNAL_MODULE__lib_jszip_min_js_715b4132__ from"../../../../../lib/jszip.min.js";import*as __WEBPACK_EXTERNAL_MODULE__script_js_588e7203__ from"../../../../../script.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_PromptManager_js_3415be00__ from"../../../../../scripts/PromptManager.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_RossAscends_mods_js_224b6398__ from"../../../../../scripts/RossAscends-mods.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_authors_note_js_60883899__ from"../../../../../scripts/authors-note.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_extensions_js_86ff8498__ from"../../../../../scripts/extensions.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_extensions_regex_engine_js_bce0a3be__ from"../../../../../scripts/extensions/regex/engine.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_group_chats_js_79178f54__ from"../../../../../scripts/group-chats.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_i18n_js_b4bbac2e__ from"../../../../../scripts/i18n.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_macros_js_3c1c7442__ from"../../../../../scripts/macros.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_openai_js_991751fb__ from"../../../../../scripts/openai.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_popup_js_d782a329__ from"../../../../../scripts/popup.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_power_user_js_8eb57d1d__ from"../../../../../scripts/power-user.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_js_aacea5c1__ from"../../../../../scripts/slash-commands.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommand_js_7714abe5__ from"../../../../../scripts/slash-commands/SlashCommand.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandArgument_js_9ae1817d__ from"../../../../../scripts/slash-commands/SlashCommandArgument.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandCommonEnumsProvider_js_56229d14__ from"../../../../../scripts/slash-commands/SlashCommandCommonEnumsProvider.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandEnumValue_js_4a448917__ from"../../../../../scripts/slash-commands/SlashCommandEnumValue.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandParser_js_585e5f4d__ from"../../../../../scripts/slash-commands/SlashCommandParser.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_tags_js_fe93ed66__ from"../../../../../scripts/tags.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_utils_js_ee651b62__ from"../../../../../scripts/utils.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_world_info_js_1b945dbf__ from"../../../../../scripts/world-info.js";var __webpack_modules__={"./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js ***!
  \**************************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Emitter: () => (/* binding */ Emitter)\n/* harmony export */ });\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vQHNvY2tldC5pbytjb21wb25lbnQtZW1pdHRlckAzLjEuMi9ub2RlX21vZHVsZXMvQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlci9saWIvZXNtL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLFVBQVU7QUFDckIsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxVQUFVO0FBQ3JCLFlBQVk7QUFDWjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxVQUFVO0FBQ3JCLFlBQVk7QUFDWjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCLHNCQUFzQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLE9BQU87QUFDbEIsWUFBWTtBQUNaOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxrQkFBa0Isc0JBQXNCO0FBQ3hDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDRDQUE0QyxTQUFTO0FBQ3JEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFlBQVk7QUFDWjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixZQUFZO0FBQ1o7QUFDQTs7QUFFQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vQHNvY2tldC5pbytjb21wb25lbnQtZW1pdHRlckAzLjEuMi9ub2RlX21vZHVsZXMvQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlci9saWIvZXNtL2luZGV4LmpzPzRhNjAiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBJbml0aWFsaXplIGEgbmV3IGBFbWl0dGVyYC5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbmV4cG9ydCBmdW5jdGlvbiBFbWl0dGVyKG9iaikge1xuICBpZiAob2JqKSByZXR1cm4gbWl4aW4ob2JqKTtcbn1cblxuLyoqXG4gKiBNaXhpbiB0aGUgZW1pdHRlciBwcm9wZXJ0aWVzLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcbiAqIEByZXR1cm4ge09iamVjdH1cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIG1peGluKG9iaikge1xuICBmb3IgKHZhciBrZXkgaW4gRW1pdHRlci5wcm90b3R5cGUpIHtcbiAgICBvYmpba2V5XSA9IEVtaXR0ZXIucHJvdG90eXBlW2tleV07XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cblxuLyoqXG4gKiBMaXN0ZW4gb24gdGhlIGdpdmVuIGBldmVudGAgd2l0aCBgZm5gLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cbiAqIEByZXR1cm4ge0VtaXR0ZXJ9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbkVtaXR0ZXIucHJvdG90eXBlLm9uID1cbkVtaXR0ZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCwgZm4pe1xuICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG4gICh0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdID0gdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XSB8fCBbXSlcbiAgICAucHVzaChmbik7XG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBBZGRzIGFuIGBldmVudGAgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGludm9rZWQgYSBzaW5nbGVcbiAqIHRpbWUgdGhlbiBhdXRvbWF0aWNhbGx5IHJlbW92ZWQuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50XG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICogQHJldHVybiB7RW1pdHRlcn1cbiAqIEBhcGkgcHVibGljXG4gKi9cblxuRW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uKGV2ZW50LCBmbil7XG4gIGZ1bmN0aW9uIG9uKCkge1xuICAgIHRoaXMub2ZmKGV2ZW50LCBvbik7XG4gICAgZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIG9uLmZuID0gZm47XG4gIHRoaXMub24oZXZlbnQsIG9uKTtcbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIFJlbW92ZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgZm9yIGBldmVudGAgb3IgYWxsXG4gKiByZWdpc3RlcmVkIGNhbGxiYWNrcy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gKiBAcmV0dXJuIHtFbWl0dGVyfVxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5FbWl0dGVyLnByb3RvdHlwZS5vZmYgPVxuRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPVxuRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID1cbkVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCwgZm4pe1xuICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cbiAgLy8gYWxsXG4gIGlmICgwID09IGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICB0aGlzLl9jYWxsYmFja3MgPSB7fTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8vIHNwZWNpZmljIGV2ZW50XG4gIHZhciBjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdO1xuICBpZiAoIWNhbGxiYWNrcykgcmV0dXJuIHRoaXM7XG5cbiAgLy8gcmVtb3ZlIGFsbCBoYW5kbGVyc1xuICBpZiAoMSA9PSBhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgZGVsZXRlIHRoaXMuX2NhbGxiYWNrc1snJCcgKyBldmVudF07XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvLyByZW1vdmUgc3BlY2lmaWMgaGFuZGxlclxuICB2YXIgY2I7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgY2IgPSBjYWxsYmFja3NbaV07XG4gICAgaWYgKGNiID09PSBmbiB8fCBjYi5mbiA9PT0gZm4pIHtcbiAgICAgIGNhbGxiYWNrcy5zcGxpY2UoaSwgMSk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvLyBSZW1vdmUgZXZlbnQgc3BlY2lmaWMgYXJyYXlzIGZvciBldmVudCB0eXBlcyB0aGF0IG5vXG4gIC8vIG9uZSBpcyBzdWJzY3JpYmVkIGZvciB0byBhdm9pZCBtZW1vcnkgbGVhay5cbiAgaWYgKGNhbGxiYWNrcy5sZW5ndGggPT09IDApIHtcbiAgICBkZWxldGUgdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBFbWl0IGBldmVudGAgd2l0aCB0aGUgZ2l2ZW4gYXJncy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEBwYXJhbSB7TWl4ZWR9IC4uLlxuICogQHJldHVybiB7RW1pdHRlcn1cbiAqL1xuXG5FbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24oZXZlbnQpe1xuICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cbiAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpXG4gICAgLCBjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdO1xuXG4gIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gIH1cblxuICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgY2FsbGJhY2tzID0gY2FsbGJhY2tzLnNsaWNlKDApO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjYWxsYmFja3MubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgIGNhbGxiYWNrc1tpXS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbi8vIGFsaWFzIHVzZWQgZm9yIHJlc2VydmVkIGV2ZW50cyAocHJvdGVjdGVkIG1ldGhvZClcbkVtaXR0ZXIucHJvdG90eXBlLmVtaXRSZXNlcnZlZCA9IEVtaXR0ZXIucHJvdG90eXBlLmVtaXQ7XG5cbi8qKlxuICogUmV0dXJuIGFycmF5IG9mIGNhbGxiYWNrcyBmb3IgYGV2ZW50YC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEByZXR1cm4ge0FycmF5fVxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5FbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lcnMgPSBmdW5jdGlvbihldmVudCl7XG4gIHRoaXMuX2NhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcyB8fCB7fTtcbiAgcmV0dXJuIHRoaXMuX2NhbGxiYWNrc1snJCcgKyBldmVudF0gfHwgW107XG59O1xuXG4vKipcbiAqIENoZWNrIGlmIHRoaXMgZW1pdHRlciBoYXMgYGV2ZW50YCBoYW5kbGVycy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEByZXR1cm4ge0Jvb2xlYW59XG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbkVtaXR0ZXIucHJvdG90eXBlLmhhc0xpc3RlbmVycyA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgcmV0dXJuICEhIHRoaXMubGlzdGVuZXJzKGV2ZW50KS5sZW5ndGg7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js\n")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js ***!
  \***************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hasCORS: () => (/* binding */ hasCORS)\n/* harmony export */ });\n// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nconst hasCORS = value;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9oYXMtY29ycy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9jb250cmliL2hhcy1jb3JzLmpzP2M0MjkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vY29tcG9uZW50L2hhcy1jb3JzXG5sZXQgdmFsdWUgPSBmYWxzZTtcbnRyeSB7XG4gICAgdmFsdWUgPSB0eXBlb2YgWE1MSHR0cFJlcXVlc3QgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICd3aXRoQ3JlZGVudGlhbHMnIGluIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xufVxuY2F0Y2ggKGVycikge1xuICAgIC8vIGlmIFhNTEh0dHAgc3VwcG9ydCBpcyBkaXNhYmxlZCBpbiBJRSB0aGVuIGl0IHdpbGwgdGhyb3dcbiAgICAvLyB3aGVuIHRyeWluZyB0byBjcmVhdGVcbn1cbmV4cG9ydCBjb25zdCBoYXNDT1JTID0gdmFsdWU7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js\n")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js ***!
  \**************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nfunction encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nfunction decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9wYXJzZXFzLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQjtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0Esc0NBQXNDLE9BQU87QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9jb250cmliL3BhcnNlcXMuanM/YTllMCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnRlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9nYWxrbi9xdWVyeXN0cmluZ1xuLyoqXG4gKiBDb21waWxlcyBhIHF1ZXJ5c3RyaW5nXG4gKiBSZXR1cm5zIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0XG4gKlxuICogQHBhcmFtIHtPYmplY3R9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZShvYmopIHtcbiAgICBsZXQgc3RyID0gJyc7XG4gICAgZm9yIChsZXQgaSBpbiBvYmopIHtcbiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgaWYgKHN0ci5sZW5ndGgpXG4gICAgICAgICAgICAgICAgc3RyICs9ICcmJztcbiAgICAgICAgICAgIHN0ciArPSBlbmNvZGVVUklDb21wb25lbnQoaSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQob2JqW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3RyO1xufVxuLyoqXG4gKiBQYXJzZXMgYSBzaW1wbGUgcXVlcnlzdHJpbmcgaW50byBhbiBvYmplY3RcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gcXNcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlKHFzKSB7XG4gICAgbGV0IHFyeSA9IHt9O1xuICAgIGxldCBwYWlycyA9IHFzLnNwbGl0KCcmJyk7XG4gICAgZm9yIChsZXQgaSA9IDAsIGwgPSBwYWlycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgbGV0IHBhaXIgPSBwYWlyc1tpXS5zcGxpdCgnPScpO1xuICAgICAgICBxcnlbZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChwYWlyWzFdKTtcbiAgICB9XG4gICAgcmV0dXJuIHFyeTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js\n")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js ***!
  \***************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parse: () => (/* binding */ parse)\n/* harmony export */ });\n// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nfunction parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9wYXJzZXVyaS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1SEFBdUgsSUFBSSxHQUFHLElBQUksU0FBUyxJQUFJO0FBQy9JO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RTtBQUN4RTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFO0FBQ3hFLGtGQUFrRjtBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixJQUFJO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9jb250cmliL3BhcnNldXJpLmpzP2NjZjEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vZ2Fsa24vcGFyc2V1cmlcbi8qKlxuICogUGFyc2VzIGEgVVJJXG4gKlxuICogTm90ZTogd2UgY291bGQgYWxzbyBoYXZlIHVzZWQgdGhlIGJ1aWx0LWluIFVSTCBvYmplY3QsIGJ1dCBpdCBpc24ndCBzdXBwb3J0ZWQgb24gYWxsIHBsYXRmb3Jtcy5cbiAqXG4gKiBTZWU6XG4gKiAtIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9VUkxcbiAqIC0gaHR0cHM6Ly9jYW5pdXNlLmNvbS91cmxcbiAqIC0gaHR0cHM6Ly93d3cucmZjLWVkaXRvci5vcmcvcmZjL3JmYzM5ODYjYXBwZW5kaXgtQlxuICpcbiAqIEhpc3Rvcnkgb2YgdGhlIHBhcnNlKCkgbWV0aG9kOlxuICogLSBmaXJzdCBjb21taXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9zb2NrZXRpby9zb2NrZXQuaW8tY2xpZW50L2NvbW1pdC80ZWUxZDVkOTRiMzkwNmE5YzA1MmI0NTlmMWE4MThiMTVmMzhmOTFjXG4gKiAtIGV4cG9ydCBpbnRvIGl0cyBvd24gbW9kdWxlOiBodHRwczovL2dpdGh1Yi5jb20vc29ja2V0aW8vZW5naW5lLmlvLWNsaWVudC9jb21taXQvZGUyYzU2MWU0NTY0ZWZlYjc4ZjFiZGIxYmEzOWVmODFiMjgyMmNiM1xuICogLSByZWltcG9ydDogaHR0cHM6Ly9naXRodWIuY29tL3NvY2tldGlvL2VuZ2luZS5pby1jbGllbnQvY29tbWl0L2RmMzIyNzdjM2Y2ZDYyMmVlYzVlZDA5ZjQ5M2NhZTNmMzM5MWQyNDJcbiAqXG4gKiBAYXV0aG9yIFN0ZXZlbiBMZXZpdGhhbiA8c3RldmVubGV2aXRoYW4uY29tPiAoTUlUIGxpY2Vuc2UpXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuY29uc3QgcmUgPSAvXig/Oig/IVteOkBcXC8/I10rOlteOkBcXC9dKkApKGh0dHB8aHR0cHN8d3N8d3NzKTpcXC9cXC8pPygoPzooKFteOkBcXC8/I10qKSg/OjooW146QFxcLz8jXSopKT8pP0ApPygoPzpbYS1mMC05XXswLDR9Oil7Miw3fVthLWYwLTldezAsNH18W146XFwvPyNdKikoPzo6KFxcZCopKT8pKCgoXFwvKD86W14/I10oPyFbXj8jXFwvXSpcXC5bXj8jXFwvLl0rKD86Wz8jXXwkKSkpKlxcLz8pPyhbXj8jXFwvXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pLztcbmNvbnN0IHBhcnRzID0gW1xuICAgICdzb3VyY2UnLCAncHJvdG9jb2wnLCAnYXV0aG9yaXR5JywgJ3VzZXJJbmZvJywgJ3VzZXInLCAncGFzc3dvcmQnLCAnaG9zdCcsICdwb3J0JywgJ3JlbGF0aXZlJywgJ3BhdGgnLCAnZGlyZWN0b3J5JywgJ2ZpbGUnLCAncXVlcnknLCAnYW5jaG9yJ1xuXTtcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZShzdHIpIHtcbiAgICBpZiAoc3RyLmxlbmd0aCA+IDgwMDApIHtcbiAgICAgICAgdGhyb3cgXCJVUkkgdG9vIGxvbmdcIjtcbiAgICB9XG4gICAgY29uc3Qgc3JjID0gc3RyLCBiID0gc3RyLmluZGV4T2YoJ1snKSwgZSA9IHN0ci5pbmRleE9mKCddJyk7XG4gICAgaWYgKGIgIT0gLTEgJiYgZSAhPSAtMSkge1xuICAgICAgICBzdHIgPSBzdHIuc3Vic3RyaW5nKDAsIGIpICsgc3RyLnN1YnN0cmluZyhiLCBlKS5yZXBsYWNlKC86L2csICc7JykgKyBzdHIuc3Vic3RyaW5nKGUsIHN0ci5sZW5ndGgpO1xuICAgIH1cbiAgICBsZXQgbSA9IHJlLmV4ZWMoc3RyIHx8ICcnKSwgdXJpID0ge30sIGkgPSAxNDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHVyaVtwYXJ0c1tpXV0gPSBtW2ldIHx8ICcnO1xuICAgIH1cbiAgICBpZiAoYiAhPSAtMSAmJiBlICE9IC0xKSB7XG4gICAgICAgIHVyaS5zb3VyY2UgPSBzcmM7XG4gICAgICAgIHVyaS5ob3N0ID0gdXJpLmhvc3Quc3Vic3RyaW5nKDEsIHVyaS5ob3N0Lmxlbmd0aCAtIDEpLnJlcGxhY2UoLzsvZywgJzonKTtcbiAgICAgICAgdXJpLmF1dGhvcml0eSA9IHVyaS5hdXRob3JpdHkucmVwbGFjZSgnWycsICcnKS5yZXBsYWNlKCddJywgJycpLnJlcGxhY2UoLzsvZywgJzonKTtcbiAgICAgICAgdXJpLmlwdjZ1cmkgPSB0cnVlO1xuICAgIH1cbiAgICB1cmkucGF0aE5hbWVzID0gcGF0aE5hbWVzKHVyaSwgdXJpWydwYXRoJ10pO1xuICAgIHVyaS5xdWVyeUtleSA9IHF1ZXJ5S2V5KHVyaSwgdXJpWydxdWVyeSddKTtcbiAgICByZXR1cm4gdXJpO1xufVxuZnVuY3Rpb24gcGF0aE5hbWVzKG9iaiwgcGF0aCkge1xuICAgIGNvbnN0IHJlZ3ggPSAvXFwvezIsOX0vZywgbmFtZXMgPSBwYXRoLnJlcGxhY2UocmVneCwgXCIvXCIpLnNwbGl0KFwiL1wiKTtcbiAgICBpZiAocGF0aC5zbGljZSgwLCAxKSA9PSAnLycgfHwgcGF0aC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgbmFtZXMuc3BsaWNlKDAsIDEpO1xuICAgIH1cbiAgICBpZiAocGF0aC5zbGljZSgtMSkgPT0gJy8nKSB7XG4gICAgICAgIG5hbWVzLnNwbGljZShuYW1lcy5sZW5ndGggLSAxLCAxKTtcbiAgICB9XG4gICAgcmV0dXJuIG5hbWVzO1xufVxuZnVuY3Rpb24gcXVlcnlLZXkodXJpLCBxdWVyeSkge1xuICAgIGNvbnN0IGRhdGEgPSB7fTtcbiAgICBxdWVyeS5yZXBsYWNlKC8oPzpefCYpKFteJj1dKik9PyhbXiZdKikvZywgZnVuY3Rpb24gKCQwLCAkMSwgJDIpIHtcbiAgICAgICAgaWYgKCQxKSB7XG4gICAgICAgICAgICBkYXRhWyQxXSA9ICQyO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGRhdGE7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js\n")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js ***!
  \******************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCookieJar: () => (/* binding */ createCookieJar),\n/* harmony export */   defaultBinaryType: () => (/* binding */ defaultBinaryType),\n/* harmony export */   globalThisShim: () => (/* binding */ globalThisShim),\n/* harmony export */   nextTick: () => (/* binding */ nextTick)\n/* harmony export */ });\nconst nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === "function" && typeof Promise.resolve === "function";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nconst globalThisShim = (() => {\n    if (typeof self !== "undefined") {\n        return self;\n    }\n    else if (typeof window !== "undefined") {\n        return window;\n    }\n    else {\n        return Function("return this")();\n    }\n})();\nconst defaultBinaryType = "arraybuffer";\nfunction createCookieJar() { }\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vZ2xvYmFscy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDTTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDTTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL2dsb2JhbHMuanM/ZDc0MSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgbmV4dFRpY2sgPSAoKCkgPT4ge1xuICAgIGNvbnN0IGlzUHJvbWlzZUF2YWlsYWJsZSA9IHR5cGVvZiBQcm9taXNlID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFByb21pc2UucmVzb2x2ZSA9PT0gXCJmdW5jdGlvblwiO1xuICAgIGlmIChpc1Byb21pc2VBdmFpbGFibGUpIHtcbiAgICAgICAgcmV0dXJuIChjYikgPT4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihjYik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gKGNiLCBzZXRUaW1lb3V0Rm4pID0+IHNldFRpbWVvdXRGbihjYiwgMCk7XG4gICAgfVxufSkoKTtcbmV4cG9ydCBjb25zdCBnbG9iYWxUaGlzU2hpbSA9ICgoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIHJldHVybiBzZWxmO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3c7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1xuICAgIH1cbn0pKCk7XG5leHBvcnQgY29uc3QgZGVmYXVsdEJpbmFyeVR5cGUgPSBcImFycmF5YnVmZmVyXCI7XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ29va2llSmFyKCkgeyB9XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Fetch: () => (/* reexport safe */ _transports_polling_fetch_js__WEBPACK_IMPORTED_MODULE_6__.Fetch),\n/* harmony export */   NodeWebSocket: () => (/* reexport safe */ _transports_websocket_node_js__WEBPACK_IMPORTED_MODULE_8__.WS),\n/* harmony export */   NodeXHR: () => (/* reexport safe */ _transports_polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_7__.XHR),\n/* harmony export */   Socket: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_0__.Socket),\n/* harmony export */   SocketWithUpgrade: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_0__.SocketWithUpgrade),\n/* harmony export */   SocketWithoutUpgrade: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_0__.SocketWithoutUpgrade),\n/* harmony export */   Transport: () => (/* reexport safe */ _transport_js__WEBPACK_IMPORTED_MODULE_1__.Transport),\n/* harmony export */   TransportError: () => (/* reexport safe */ _transport_js__WEBPACK_IMPORTED_MODULE_1__.TransportError),\n/* harmony export */   WebSocket: () => (/* reexport safe */ _transports_websocket_node_js__WEBPACK_IMPORTED_MODULE_8__.WS),\n/* harmony export */   WebTransport: () => (/* reexport safe */ _transports_webtransport_js__WEBPACK_IMPORTED_MODULE_9__.WT),\n/* harmony export */   XHR: () => (/* reexport safe */ _transports_polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_7__.XHR),\n/* harmony export */   installTimerFunctions: () => (/* reexport safe */ _util_js__WEBPACK_IMPORTED_MODULE_3__.installTimerFunctions),\n/* harmony export */   nextTick: () => (/* reexport safe */ _globals_node_js__WEBPACK_IMPORTED_MODULE_5__.nextTick),\n/* harmony export */   parse: () => (/* reexport safe */ _contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_4__.parse),\n/* harmony export */   protocol: () => (/* binding */ protocol),\n/* harmony export */   transports: () => (/* reexport safe */ _transports_index_js__WEBPACK_IMPORTED_MODULE_2__.transports)\n/* harmony export */ });\n/* harmony import */ var _socket_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./socket.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js");\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _transports_index_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./transports/index.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./contrib/parseuri.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n/* harmony import */ var _transports_polling_fetch_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./transports/polling-fetch.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js");\n/* harmony import */ var _transports_polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./transports/polling-xhr.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js");\n/* harmony import */ var _transports_websocket_node_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./transports/websocket.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js");\n/* harmony import */ var _transports_webtransport_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./transports/webtransport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js");\n\n\n\nconst protocol = _socket_js__WEBPACK_IMPORTED_MODULE_0__.Socket.protocol;\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBcUM7QUFDbkI7QUFDcUQ7QUFDaEUsaUJBQWlCLDhDQUFNO0FBQzZCO0FBQ1I7QUFDRDtBQUNKO0FBQ0Q7QUFDUztBQUNZO0FBQ2hCO0FBQ21CO0FBQ1Q7QUFDTSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9pbmRleC5qcz8xZTE2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNvY2tldCB9IGZyb20gXCIuL3NvY2tldC5qc1wiO1xuZXhwb3J0IHsgU29ja2V0IH07XG5leHBvcnQgeyBTb2NrZXRXaXRob3V0VXBncmFkZSwgU29ja2V0V2l0aFVwZ3JhZGUsIH0gZnJvbSBcIi4vc29ja2V0LmpzXCI7XG5leHBvcnQgY29uc3QgcHJvdG9jb2wgPSBTb2NrZXQucHJvdG9jb2w7XG5leHBvcnQgeyBUcmFuc3BvcnQsIFRyYW5zcG9ydEVycm9yIH0gZnJvbSBcIi4vdHJhbnNwb3J0LmpzXCI7XG5leHBvcnQgeyB0cmFuc3BvcnRzIH0gZnJvbSBcIi4vdHJhbnNwb3J0cy9pbmRleC5qc1wiO1xuZXhwb3J0IHsgaW5zdGFsbFRpbWVyRnVuY3Rpb25zIH0gZnJvbSBcIi4vdXRpbC5qc1wiO1xuZXhwb3J0IHsgcGFyc2UgfSBmcm9tIFwiLi9jb250cmliL3BhcnNldXJpLmpzXCI7XG5leHBvcnQgeyBuZXh0VGljayB9IGZyb20gXCIuL2dsb2JhbHMubm9kZS5qc1wiO1xuZXhwb3J0IHsgRmV0Y2ggfSBmcm9tIFwiLi90cmFuc3BvcnRzL3BvbGxpbmctZmV0Y2guanNcIjtcbmV4cG9ydCB7IFhIUiBhcyBOb2RlWEhSIH0gZnJvbSBcIi4vdHJhbnNwb3J0cy9wb2xsaW5nLXhoci5ub2RlLmpzXCI7XG5leHBvcnQgeyBYSFIgfSBmcm9tIFwiLi90cmFuc3BvcnRzL3BvbGxpbmcteGhyLmpzXCI7XG5leHBvcnQgeyBXUyBhcyBOb2RlV2ViU29ja2V0IH0gZnJvbSBcIi4vdHJhbnNwb3J0cy93ZWJzb2NrZXQubm9kZS5qc1wiO1xuZXhwb3J0IHsgV1MgYXMgV2ViU29ja2V0IH0gZnJvbSBcIi4vdHJhbnNwb3J0cy93ZWJzb2NrZXQuanNcIjtcbmV4cG9ydCB7IFdUIGFzIFdlYlRyYW5zcG9ydCB9IGZyb20gXCIuL3RyYW5zcG9ydHMvd2VidHJhbnNwb3J0LmpzXCI7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js ***!
  \*****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Socket: () => (/* binding */ Socket),\n/* harmony export */   SocketWithUpgrade: () => (/* binding */ SocketWithUpgrade),\n/* harmony export */   SocketWithoutUpgrade: () => (/* binding */ SocketWithoutUpgrade)\n/* harmony export */ });\n/* harmony import */ var _transports_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./transports/index.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./contrib/parseqs.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js");\n/* harmony import */ var _contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./contrib/parseuri.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n\n\n\n\n\n\n\nconst withEventListeners = typeof addEventListener === "function" &&\n    typeof removeEventListener === "function";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the \'offline\' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener("offline", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that\'s why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from "engine.io-client";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on("open", () => {\n *   socket.send("hello");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nclass SocketWithoutUpgrade extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_4__.Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = _globals_node_js__WEBPACK_IMPORTED_MODULE_6__.defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && "object" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = (0,_contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_3__.parse)(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === "https" || parsedUri.protocol === "wss";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = (0,_contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_3__.parse)(opts.host).host;\n        }\n        (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.installTimerFunctions)(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== "undefined" && "https:" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? "443" : "80";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== "undefined" ? location.hostname : "localhost");\n        this.port =\n            opts.port ||\n                (typeof location !== "undefined" && location.port\n                    ? location.port\n                    : this.secure\n                        ? "443"\n                        : "80");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: "/engine.io",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: "t",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, "") +\n                (this.opts.addTrailingSlash ? "/" : "");\n        if (typeof this.opts.query === "string") {\n            this.opts.query = (0,_contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_2__.decode)(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the "beforeunload" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no "disconnect" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener("beforeunload", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== "localhost") {\n                this._offlineEventListener = () => {\n                    this._onClose("transport close", {\n                        description: "network connection lost",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_6__.createCookieJar)();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = engine_io_parser__WEBPACK_IMPORTED_MODULE_5__.protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved("error", "No transports available");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf("websocket") !== -1\n            ? "websocket"\n            : this.transports[0];\n        this.readyState = "opening";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on("drain", this._onDrain.bind(this))\n            .on("packet", this._onPacket.bind(this))\n            .on("error", this._onError.bind(this))\n            .on("close", (reason) => this._onClose("transport close", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = "open";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            "websocket" === this.transport.name;\n        this.emitReserved("open");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if ("opening" === this.readyState ||\n            "open" === this.readyState ||\n            "closing" === this.readyState) {\n            this.emitReserved("packet", packet);\n            // Socket is live - any packet counts\n            this.emitReserved("heartbeat");\n            switch (packet.type) {\n                case "open":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case "ping":\n                    this._sendPacket("pong");\n                    this.emitReserved("ping");\n                    this.emitReserved("pong");\n                    this._resetPingTimeout();\n                    break;\n                case "error":\n                    const err = new Error("server error");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case "message":\n                    this.emitReserved("data", packet.data);\n                    this.emitReserved("message", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved("handshake", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if ("closed" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose("ping timeout");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved("drain");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if ("closed" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved("flush");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === "polling" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.byteLength)(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_6__.nextTick)(() => {\n                this._onClose("ping timeout");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket("message", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket("message", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if ("function" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if ("function" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if ("closing" === this.readyState || "closed" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved("packetCreate", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once("flush", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose("forced close");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off("upgrade", cleanupAndClose);\n            this.off("upgradeError", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can\'t send packets while pausing a transport\n            this.once("upgrade", cleanupAndClose);\n            this.once("upgradeError", cleanupAndClose);\n        };\n        if ("opening" === this.readyState || "open" === this.readyState) {\n            this.readyState = "closing";\n            if (this.writeBuffer.length) {\n                this.once("drain", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === "opening") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved("error", err);\n        this._onClose("transport error", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if ("opening" === this.readyState ||\n            "open" === this.readyState ||\n            "closing" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners("close");\n            // ensure transport won\'t stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener("beforeunload", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = "closed";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved("close", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = engine_io_parser__WEBPACK_IMPORTED_MODULE_5__.protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that\'s why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from "engine.io-client";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on("open", () => {\n *   socket.send("hello");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nclass SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if ("open" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: "ping", data: "probe" }]);\n            transport.once("packet", (msg) => {\n                if (failed)\n                    return;\n                if ("pong" === msg.type && "probe" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved("upgrading", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        "websocket" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if ("closed" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: "upgrade" }]);\n                        this.emitReserved("upgrade", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error("probe error");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved("upgradeError", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error("probe error: " + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved("upgradeError", error);\n        };\n        function onTransportClose() {\n            onerror("transport closed");\n        }\n        // When the socket is closed while we\'re probing\n        function onclose() {\n            onerror("socket closed");\n        }\n        // When the socket is upgraded while we\'re probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener("open", onTransportOpen);\n            transport.removeListener("error", onerror);\n            transport.removeListener("close", onTransportClose);\n            this.off("close", onclose);\n            this.off("upgrading", onupgrade);\n        };\n        transport.once("open", onTransportOpen);\n        transport.once("error", onerror);\n        transport.once("close", onTransportClose);\n        this.once("close", onclose);\n        this.once("upgrading", onupgrade);\n        if (this._upgrades.indexOf("webtransport") !== -1 &&\n            name !== "webtransport") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from "engine.io-client";\n *\n * const socket = new Socket();\n *\n * socket.on("open", () => {\n *   socket.send("hello");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nclass Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === "object" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === "string")) {\n            o.transports = (o.transports || ["polling", "websocket", "webtransport"])\n                .map((transportName) => _transports_index_js__WEBPACK_IMPORTED_MODULE_0__.transports[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vc29ja2V0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBeUU7QUFDWDtBQUNoQjtBQUNBO0FBQ1M7QUFDWDtBQUNzQztBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGtDQUFrQztBQUM5QztBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ08sbUNBQW1DLGlFQUFPO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZUFBZTtBQUM5QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLCtEQUFpQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMseUJBQXlCO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsMkRBQUs7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwyREFBSztBQUNqQztBQUNBLFFBQVEsK0RBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLGdDQUFnQztBQUNoQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FB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bW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9zb2NrZXQuanM/YTBkMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0cmFuc3BvcnRzIGFzIERFRkFVTFRfVFJBTlNQT1JUUyB9IGZyb20gXCIuL3RyYW5zcG9ydHMvaW5kZXguanNcIjtcbmltcG9ydCB7IGluc3RhbGxUaW1lckZ1bmN0aW9ucywgYnl0ZUxlbmd0aCB9IGZyb20gXCIuL3V0aWwuanNcIjtcbmltcG9ydCB7IGRlY29kZSB9IGZyb20gXCIuL2NvbnRyaWIvcGFyc2Vxcy5qc1wiO1xuaW1wb3J0IHsgcGFyc2UgfSBmcm9tIFwiLi9jb250cmliL3BhcnNldXJpLmpzXCI7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIkBzb2NrZXQuaW8vY29tcG9uZW50LWVtaXR0ZXJcIjtcbmltcG9ydCB7IHByb3RvY29sIH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmltcG9ydCB7IGNyZWF0ZUNvb2tpZUphciwgZGVmYXVsdEJpbmFyeVR5cGUsIG5leHRUaWNrLCB9IGZyb20gXCIuL2dsb2JhbHMubm9kZS5qc1wiO1xuY29uc3Qgd2l0aEV2ZW50TGlzdGVuZXJzID0gdHlwZW9mIGFkZEV2ZW50TGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIiAmJlxuICAgIHR5cGVvZiByZW1vdmVFdmVudExpc3RlbmVyID09PSBcImZ1bmN0aW9uXCI7XG5jb25zdCBPRkZMSU5FX0VWRU5UX0xJU1RFTkVSUyA9IFtdO1xuaWYgKHdpdGhFdmVudExpc3RlbmVycykge1xuICAgIC8vIHdpdGhpbiBhIFNlcnZpY2VXb3JrZXIsIGFueSBldmVudCBoYW5kbGVyIGZvciB0aGUgJ29mZmxpbmUnIGV2ZW50IG11c3QgYmUgYWRkZWQgb24gdGhlIGluaXRpYWwgZXZhbHVhdGlvbiBvZiB0aGVcbiAgICAvLyBzY3JpcHQsIHNvIHdlIGNyZWF0ZSBvbmUgc2luZ2xlIGV2ZW50IGxpc3RlbmVyIGhlcmUgd2hpY2ggd2lsbCBmb3J3YXJkIHRoZSBldmVudCB0byB0aGUgc29ja2V0IGluc3RhbmNlc1xuICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJvZmZsaW5lXCIsICgpID0+IHtcbiAgICAgICAgT0ZGTElORV9FVkVOVF9MSVNURU5FUlMuZm9yRWFjaCgobGlzdGVuZXIpID0+IGxpc3RlbmVyKCkpO1xuICAgIH0sIGZhbHNlKTtcbn1cbi8qKlxuICogVGhpcyBjbGFzcyBwcm92aWRlcyBhIFdlYlNvY2tldC1saWtlIGludGVyZmFjZSB0byBjb25uZWN0IHRvIGFuIEVuZ2luZS5JTyBzZXJ2ZXIuIFRoZSBjb25uZWN0aW9uIHdpbGwgYmUgZXN0YWJsaXNoZWRcbiAqIHdpdGggb25lIG9mIHRoZSBhdmFpbGFibGUgbG93LWxldmVsIHRyYW5zcG9ydHMsIGxpa2UgSFRUUCBsb25nLXBvbGxpbmcsIFdlYlNvY2tldCBvciBXZWJUcmFuc3BvcnQuXG4gKlxuICogVGhpcyBjbGFzcyBjb21lcyB3aXRob3V0IHVwZ3JhZGUgbWVjaGFuaXNtLCB3aGljaCBtZWFucyB0aGF0IGl0IHdpbGwga2VlcCB0aGUgZmlyc3QgbG93LWxldmVsIHRyYW5zcG9ydCB0aGF0XG4gKiBzdWNjZXNzZnVsbHkgZXN0YWJsaXNoZXMgdGhlIGNvbm5lY3Rpb24uXG4gKlxuICogSW4gb3JkZXIgdG8gYWxsb3cgdHJlZS1zaGFraW5nLCB0aGVyZSBhcmUgbm8gdHJhbnNwb3J0cyBpbmNsdWRlZCwgdGhhdCdzIHdoeSB0aGUgYHRyYW5zcG9ydHNgIG9wdGlvbiBpcyBtYW5kYXRvcnkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFNvY2tldFdpdGhvdXRVcGdyYWRlLCBXZWJTb2NrZXQgfSBmcm9tIFwiZW5naW5lLmlvLWNsaWVudFwiO1xuICpcbiAqIGNvbnN0IHNvY2tldCA9IG5ldyBTb2NrZXRXaXRob3V0VXBncmFkZSh7XG4gKiAgIHRyYW5zcG9ydHM6IFtXZWJTb2NrZXRdXG4gKiB9KTtcbiAqXG4gKiBzb2NrZXQub24oXCJvcGVuXCIsICgpID0+IHtcbiAqICAgc29ja2V0LnNlbmQoXCJoZWxsb1wiKTtcbiAqIH0pO1xuICpcbiAqIEBzZWUgU29ja2V0V2l0aFVwZ3JhZGVcbiAqIEBzZWUgU29ja2V0XG4gKi9cbmV4cG9ydCBjbGFzcyBTb2NrZXRXaXRob3V0VXBncmFkZSBleHRlbmRzIEVtaXR0ZXIge1xuICAgIC8qKlxuICAgICAqIFNvY2tldCBjb25zdHJ1Y3Rvci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gdXJpIC0gdXJpIG9yIG9wdGlvbnNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0cyAtIG9wdGlvbnNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih1cmksIG9wdHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5iaW5hcnlUeXBlID0gZGVmYXVsdEJpbmFyeVR5cGU7XG4gICAgICAgIHRoaXMud3JpdGVCdWZmZXIgPSBbXTtcbiAgICAgICAgdGhpcy5fcHJldkJ1ZmZlckxlbiA9IDA7XG4gICAgICAgIHRoaXMuX3BpbmdJbnRlcnZhbCA9IC0xO1xuICAgICAgICB0aGlzLl9waW5nVGltZW91dCA9IC0xO1xuICAgICAgICB0aGlzLl9tYXhQYXlsb2FkID0gLTE7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZXhwaXJhdGlvbiB0aW1lc3RhbXAgb2YgdGhlIHtAbGluayBfcGluZ1RpbWVvdXRUaW1lcn0gb2JqZWN0IGlzIHRyYWNrZWQsIGluIGNhc2UgdGhlIHRpbWVyIGlzIHRocm90dGxlZCBhbmQgdGhlXG4gICAgICAgICAqIGNhbGxiYWNrIGlzIG5vdCBmaXJlZCBvbiB0aW1lLiBUaGlzIGNhbiBoYXBwZW4gZm9yIGV4YW1wbGUgd2hlbiBhIGxhcHRvcCBpcyBzdXNwZW5kZWQgb3Igd2hlbiBhIHBob25lIGlzIGxvY2tlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3BpbmdUaW1lb3V0VGltZSA9IEluZmluaXR5O1xuICAgICAgICBpZiAodXJpICYmIFwib2JqZWN0XCIgPT09IHR5cGVvZiB1cmkpIHtcbiAgICAgICAgICAgIG9wdHMgPSB1cmk7XG4gICAgICAgICAgICB1cmkgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmkpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZFVyaSA9IHBhcnNlKHVyaSk7XG4gICAgICAgICAgICBvcHRzLmhvc3RuYW1lID0gcGFyc2VkVXJpLmhvc3Q7XG4gICAgICAgICAgICBvcHRzLnNlY3VyZSA9XG4gICAgICAgICAgICAgICAgcGFyc2VkVXJpLnByb3RvY29sID09PSBcImh0dHBzXCIgfHwgcGFyc2VkVXJpLnByb3RvY29sID09PSBcIndzc1wiO1xuICAgICAgICAgICAgb3B0cy5wb3J0ID0gcGFyc2VkVXJpLnBvcnQ7XG4gICAgICAgICAgICBpZiAocGFyc2VkVXJpLnF1ZXJ5KVxuICAgICAgICAgICAgICAgIG9wdHMucXVlcnkgPSBwYXJzZWRVcmkucXVlcnk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3B0cy5ob3N0KSB7XG4gICAgICAgICAgICBvcHRzLmhvc3RuYW1lID0gcGFyc2Uob3B0cy5ob3N0KS5ob3N0O1xuICAgICAgICB9XG4gICAgICAgIGluc3RhbGxUaW1lckZ1bmN0aW9ucyh0aGlzLCBvcHRzKTtcbiAgICAgICAgdGhpcy5zZWN1cmUgPVxuICAgICAgICAgICAgbnVsbCAhPSBvcHRzLnNlY3VyZVxuICAgICAgICAgICAgICAgID8gb3B0cy5zZWN1cmVcbiAgICAgICAgICAgICAgICA6IHR5cGVvZiBsb2NhdGlvbiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBcImh0dHBzOlwiID09PSBsb2NhdGlvbi5wcm90b2NvbDtcbiAgICAgICAgaWYgKG9wdHMuaG9zdG5hbWUgJiYgIW9wdHMucG9ydCkge1xuICAgICAgICAgICAgLy8gaWYgbm8gcG9ydCBpcyBzcGVjaWZpZWQgbWFudWFsbHksIHVzZSB0aGUgcHJvdG9jb2wgZGVmYXVsdFxuICAgICAgICAgICAgb3B0cy5wb3J0ID0gdGhpcy5zZWN1cmUgPyBcIjQ0M1wiIDogXCI4MFwiO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaG9zdG5hbWUgPVxuICAgICAgICAgICAgb3B0cy5ob3N0bmFtZSB8fFxuICAgICAgICAgICAgICAgICh0eXBlb2YgbG9jYXRpb24gIT09IFwidW5kZWZpbmVkXCIgPyBsb2NhdGlvbi5ob3N0bmFtZSA6IFwibG9jYWxob3N0XCIpO1xuICAgICAgICB0aGlzLnBvcnQgPVxuICAgICAgICAgICAgb3B0cy5wb3J0IHx8XG4gICAgICAgICAgICAgICAgKHR5cGVvZiBsb2NhdGlvbiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBsb2NhdGlvbi5wb3J0XG4gICAgICAgICAgICAgICAgICAgID8gbG9jYXRpb24ucG9ydFxuICAgICAgICAgICAgICAgICAgICA6IHRoaXMuc2VjdXJlXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwiNDQzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogXCI4MFwiKTtcbiAgICAgICAgdGhpcy50cmFuc3BvcnRzID0gW107XG4gICAgICAgIHRoaXMuX3RyYW5zcG9ydHNCeU5hbWUgPSB7fTtcbiAgICAgICAgb3B0cy50cmFuc3BvcnRzLmZvckVhY2goKHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydE5hbWUgPSB0LnByb3RvdHlwZS5uYW1lO1xuICAgICAgICAgICAgdGhpcy50cmFuc3BvcnRzLnB1c2godHJhbnNwb3J0TmFtZSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc3BvcnRzQnlOYW1lW3RyYW5zcG9ydE5hbWVdID0gdDtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMub3B0cyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgcGF0aDogXCIvZW5naW5lLmlvXCIsXG4gICAgICAgICAgICBhZ2VudDogZmFsc2UsXG4gICAgICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IGZhbHNlLFxuICAgICAgICAgICAgdXBncmFkZTogdHJ1ZSxcbiAgICAgICAgICAgIHRpbWVzdGFtcFBhcmFtOiBcInRcIixcbiAgICAgICAgICAgIHJlbWVtYmVyVXBncmFkZTogZmFsc2UsXG4gICAgICAgICAgICBhZGRUcmFpbGluZ1NsYXNoOiB0cnVlLFxuICAgICAgICAgICAgcmVqZWN0VW5hdXRob3JpemVkOiB0cnVlLFxuICAgICAgICAgICAgcGVyTWVzc2FnZURlZmxhdGU6IHtcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IDEwMjQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdHJhbnNwb3J0T3B0aW9uczoge30sXG4gICAgICAgICAgICBjbG9zZU9uQmVmb3JldW5sb2FkOiBmYWxzZSxcbiAgICAgICAgfSwgb3B0cyk7XG4gICAgICAgIHRoaXMub3B0cy5wYXRoID1cbiAgICAgICAgICAgIHRoaXMub3B0cy5wYXRoLnJlcGxhY2UoL1xcLyQvLCBcIlwiKSArXG4gICAgICAgICAgICAgICAgKHRoaXMub3B0cy5hZGRUcmFpbGluZ1NsYXNoID8gXCIvXCIgOiBcIlwiKTtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdHMucXVlcnkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMub3B0cy5xdWVyeSA9IGRlY29kZSh0aGlzLm9wdHMucXVlcnkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3aXRoRXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdHMuY2xvc2VPbkJlZm9yZXVubG9hZCkge1xuICAgICAgICAgICAgICAgIC8vIEZpcmVmb3ggY2xvc2VzIHRoZSBjb25uZWN0aW9uIHdoZW4gdGhlIFwiYmVmb3JldW5sb2FkXCIgZXZlbnQgaXMgZW1pdHRlZCBidXQgbm90IENocm9tZS4gVGhpcyBldmVudCBsaXN0ZW5lclxuICAgICAgICAgICAgICAgIC8vIGVuc3VyZXMgZXZlcnkgYnJvd3NlciBiZWhhdmVzIHRoZSBzYW1lIChubyBcImRpc2Nvbm5lY3RcIiBldmVudCBhdCB0aGUgU29ja2V0LklPIGxldmVsIHdoZW4gdGhlIHBhZ2UgaXNcbiAgICAgICAgICAgICAgICAvLyBjbG9zZWQvcmVsb2FkZWQpXG4gICAgICAgICAgICAgICAgdGhpcy5fYmVmb3JldW5sb2FkRXZlbnRMaXN0ZW5lciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNwb3J0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzaWxlbnRseSBjbG9zZSB0aGUgdHJhbnNwb3J0XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJiZWZvcmV1bmxvYWRcIiwgdGhpcy5fYmVmb3JldW5sb2FkRXZlbnRMaXN0ZW5lciwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaG9zdG5hbWUgIT09IFwibG9jYWxob3N0XCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vZmZsaW5lRXZlbnRMaXN0ZW5lciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25DbG9zZShcInRyYW5zcG9ydCBjbG9zZVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJuZXR3b3JrIGNvbm5lY3Rpb24gbG9zdFwiLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIE9GRkxJTkVfRVZFTlRfTElTVEVORVJTLnB1c2godGhpcy5fb2ZmbGluZUV2ZW50TGlzdGVuZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9wdHMud2l0aENyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICB0aGlzLl9jb29raWVKYXIgPSBjcmVhdGVDb29raWVKYXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9vcGVuKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgdHJhbnNwb3J0IG9mIHRoZSBnaXZlbiB0eXBlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgLSB0cmFuc3BvcnQgbmFtZVxuICAgICAqIEByZXR1cm4ge1RyYW5zcG9ydH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIGNyZWF0ZVRyYW5zcG9ydChuYW1lKSB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5vcHRzLnF1ZXJ5KTtcbiAgICAgICAgLy8gYXBwZW5kIGVuZ2luZS5pbyBwcm90b2NvbCBpZGVudGlmaWVyXG4gICAgICAgIHF1ZXJ5LkVJTyA9IHByb3RvY29sO1xuICAgICAgICAvLyB0cmFuc3BvcnQgbmFtZVxuICAgICAgICBxdWVyeS50cmFuc3BvcnQgPSBuYW1lO1xuICAgICAgICAvLyBzZXNzaW9uIGlkIGlmIHdlIGFscmVhZHkgaGF2ZSBvbmVcbiAgICAgICAgaWYgKHRoaXMuaWQpXG4gICAgICAgICAgICBxdWVyeS5zaWQgPSB0aGlzLmlkO1xuICAgICAgICBjb25zdCBvcHRzID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5vcHRzLCB7XG4gICAgICAgICAgICBxdWVyeSxcbiAgICAgICAgICAgIHNvY2tldDogdGhpcyxcbiAgICAgICAgICAgIGhvc3RuYW1lOiB0aGlzLmhvc3RuYW1lLFxuICAgICAgICAgICAgc2VjdXJlOiB0aGlzLnNlY3VyZSxcbiAgICAgICAgICAgIHBvcnQ6IHRoaXMucG9ydCxcbiAgICAgICAgfSwgdGhpcy5vcHRzLnRyYW5zcG9ydE9wdGlvbnNbbmFtZV0pO1xuICAgICAgICByZXR1cm4gbmV3IHRoaXMuX3RyYW5zcG9ydHNCeU5hbWVbbmFtZV0ob3B0cyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRyYW5zcG9ydCB0byB1c2UgYW5kIHN0YXJ0cyBwcm9iZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29wZW4oKSB7XG4gICAgICAgIGlmICh0aGlzLnRyYW5zcG9ydHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAvLyBFbWl0IGVycm9yIG9uIG5leHQgdGljayBzbyBpdCBjYW4gYmUgbGlzdGVuZWQgdG9cbiAgICAgICAgICAgIHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImVycm9yXCIsIFwiTm8gdHJhbnNwb3J0cyBhdmFpbGFibGVcIik7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0cmFuc3BvcnROYW1lID0gdGhpcy5vcHRzLnJlbWVtYmVyVXBncmFkZSAmJlxuICAgICAgICAgICAgU29ja2V0V2l0aG91dFVwZ3JhZGUucHJpb3JXZWJzb2NrZXRTdWNjZXNzICYmXG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydHMuaW5kZXhPZihcIndlYnNvY2tldFwiKSAhPT0gLTFcbiAgICAgICAgICAgID8gXCJ3ZWJzb2NrZXRcIlxuICAgICAgICAgICAgOiB0aGlzLnRyYW5zcG9ydHNbMF07XG4gICAgICAgIHRoaXMucmVhZHlTdGF0ZSA9IFwib3BlbmluZ1wiO1xuICAgICAgICBjb25zdCB0cmFuc3BvcnQgPSB0aGlzLmNyZWF0ZVRyYW5zcG9ydCh0cmFuc3BvcnROYW1lKTtcbiAgICAgICAgdHJhbnNwb3J0Lm9wZW4oKTtcbiAgICAgICAgdGhpcy5zZXRUcmFuc3BvcnQodHJhbnNwb3J0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY3VycmVudCB0cmFuc3BvcnQuIERpc2FibGVzIHRoZSBleGlzdGluZyBvbmUgKGlmIGFueSkuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHNldFRyYW5zcG9ydCh0cmFuc3BvcnQpIHtcbiAgICAgICAgaWYgKHRoaXMudHJhbnNwb3J0KSB7XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBzZXQgdXAgdHJhbnNwb3J0XG4gICAgICAgIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0O1xuICAgICAgICAvLyBzZXQgdXAgdHJhbnNwb3J0IGxpc3RlbmVyc1xuICAgICAgICB0cmFuc3BvcnRcbiAgICAgICAgICAgIC5vbihcImRyYWluXCIsIHRoaXMuX29uRHJhaW4uYmluZCh0aGlzKSlcbiAgICAgICAgICAgIC5vbihcInBhY2tldFwiLCB0aGlzLl9vblBhY2tldC5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwiZXJyb3JcIiwgdGhpcy5fb25FcnJvci5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwiY2xvc2VcIiwgKHJlYXNvbikgPT4gdGhpcy5fb25DbG9zZShcInRyYW5zcG9ydCBjbG9zZVwiLCByZWFzb24pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gY29ubmVjdGlvbiBpcyBkZWVtZWQgb3Blbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPSBcIm9wZW5cIjtcbiAgICAgICAgU29ja2V0V2l0aG91dFVwZ3JhZGUucHJpb3JXZWJzb2NrZXRTdWNjZXNzID1cbiAgICAgICAgICAgIFwid2Vic29ja2V0XCIgPT09IHRoaXMudHJhbnNwb3J0Lm5hbWU7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwib3BlblwiKTtcbiAgICAgICAgdGhpcy5mbHVzaCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25QYWNrZXQocGFja2V0KSB7XG4gICAgICAgIGlmIChcIm9wZW5pbmdcIiA9PT0gdGhpcy5yZWFkeVN0YXRlIHx8XG4gICAgICAgICAgICBcIm9wZW5cIiA9PT0gdGhpcy5yZWFkeVN0YXRlIHx8XG4gICAgICAgICAgICBcImNsb3NpbmdcIiA9PT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBhY2tldFwiLCBwYWNrZXQpO1xuICAgICAgICAgICAgLy8gU29ja2V0IGlzIGxpdmUgLSBhbnkgcGFja2V0IGNvdW50c1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJoZWFydGJlYXRcIik7XG4gICAgICAgICAgICBzd2l0Y2ggKHBhY2tldC50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm9wZW5cIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkhhbmRzaGFrZShKU09OLnBhcnNlKHBhY2tldC5kYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJwaW5nXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbmRQYWNrZXQoXCJwb25nXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBpbmdcIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwicG9uZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzZXRQaW5nVGltZW91dCgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZXJyb3JcIjpcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyID0gbmV3IEVycm9yKFwic2VydmVyIGVycm9yXCIpO1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGVyci5jb2RlID0gcGFja2V0LmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm1lc3NhZ2VcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJkYXRhXCIsIHBhY2tldC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJtZXNzYWdlXCIsIHBhY2tldC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gaGFuZHNoYWtlIGNvbXBsZXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIGhhbmRzaGFrZSBvYmpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uSGFuZHNoYWtlKGRhdGEpIHtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJoYW5kc2hha2VcIiwgZGF0YSk7XG4gICAgICAgIHRoaXMuaWQgPSBkYXRhLnNpZDtcbiAgICAgICAgdGhpcy50cmFuc3BvcnQucXVlcnkuc2lkID0gZGF0YS5zaWQ7XG4gICAgICAgIHRoaXMuX3BpbmdJbnRlcnZhbCA9IGRhdGEucGluZ0ludGVydmFsO1xuICAgICAgICB0aGlzLl9waW5nVGltZW91dCA9IGRhdGEucGluZ1RpbWVvdXQ7XG4gICAgICAgIHRoaXMuX21heFBheWxvYWQgPSBkYXRhLm1heFBheWxvYWQ7XG4gICAgICAgIHRoaXMub25PcGVuKCk7XG4gICAgICAgIC8vIEluIGNhc2Ugb3BlbiBoYW5kbGVyIGNsb3NlcyBzb2NrZXRcbiAgICAgICAgaWYgKFwiY2xvc2VkXCIgPT09IHRoaXMucmVhZHlTdGF0ZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5fcmVzZXRQaW5nVGltZW91dCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIGFuZCByZXNldHMgcGluZyB0aW1lb3V0IHRpbWVyIGJhc2VkIG9uIHNlcnZlciBwaW5ncy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3Jlc2V0UGluZ1RpbWVvdXQoKSB7XG4gICAgICAgIHRoaXMuY2xlYXJUaW1lb3V0Rm4odGhpcy5fcGluZ1RpbWVvdXRUaW1lcik7XG4gICAgICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5fcGluZ0ludGVydmFsICsgdGhpcy5fcGluZ1RpbWVvdXQ7XG4gICAgICAgIHRoaXMuX3BpbmdUaW1lb3V0VGltZSA9IERhdGUubm93KCkgKyBkZWxheTtcbiAgICAgICAgdGhpcy5fcGluZ1RpbWVvdXRUaW1lciA9IHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX29uQ2xvc2UoXCJwaW5nIHRpbWVvdXRcIik7XG4gICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgaWYgKHRoaXMub3B0cy5hdXRvVW5yZWYpIHtcbiAgICAgICAgICAgIHRoaXMuX3BpbmdUaW1lb3V0VGltZXIudW5yZWYoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgb24gYGRyYWluYCBldmVudFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25EcmFpbigpIHtcbiAgICAgICAgdGhpcy53cml0ZUJ1ZmZlci5zcGxpY2UoMCwgdGhpcy5fcHJldkJ1ZmZlckxlbik7XG4gICAgICAgIC8vIHNldHRpbmcgcHJldkJ1ZmZlckxlbiA9IDAgaXMgdmVyeSBpbXBvcnRhbnRcbiAgICAgICAgLy8gZm9yIGV4YW1wbGUsIHdoZW4gdXBncmFkaW5nLCB1cGdyYWRlIHBhY2tldCBpcyBzZW50IG92ZXIsXG4gICAgICAgIC8vIGFuZCBhIG5vbnplcm8gcHJldkJ1ZmZlckxlbiBjb3VsZCBjYXVzZSBwcm9ibGVtcyBvbiBgZHJhaW5gXG4gICAgICAgIHRoaXMuX3ByZXZCdWZmZXJMZW4gPSAwO1xuICAgICAgICBpZiAoMCA9PT0gdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwiZHJhaW5cIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZsdXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRmx1c2ggd3JpdGUgYnVmZmVycy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZmx1c2goKSB7XG4gICAgICAgIGlmIChcImNsb3NlZFwiICE9PSB0aGlzLnJlYWR5U3RhdGUgJiZcbiAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LndyaXRhYmxlICYmXG4gICAgICAgICAgICAhdGhpcy51cGdyYWRpbmcgJiZcbiAgICAgICAgICAgIHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBwYWNrZXRzID0gdGhpcy5fZ2V0V3JpdGFibGVQYWNrZXRzKCk7XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5zZW5kKHBhY2tldHMpO1xuICAgICAgICAgICAgLy8ga2VlcCB0cmFjayBvZiBjdXJyZW50IGxlbmd0aCBvZiB3cml0ZUJ1ZmZlclxuICAgICAgICAgICAgLy8gc3BsaWNlIHdyaXRlQnVmZmVyIGFuZCBjYWxsYmFja0J1ZmZlciBvbiBgZHJhaW5gXG4gICAgICAgICAgICB0aGlzLl9wcmV2QnVmZmVyTGVuID0gcGFja2V0cy5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImZsdXNoXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuc3VyZSB0aGUgZW5jb2RlZCBzaXplIG9mIHRoZSB3cml0ZUJ1ZmZlciBpcyBiZWxvdyB0aGUgbWF4UGF5bG9hZCB2YWx1ZSBzZW50IGJ5IHRoZSBzZXJ2ZXIgKG9ubHkgZm9yIEhUVFBcbiAgICAgKiBsb25nLXBvbGxpbmcpXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9nZXRXcml0YWJsZVBhY2tldHMoKSB7XG4gICAgICAgIGNvbnN0IHNob3VsZENoZWNrUGF5bG9hZFNpemUgPSB0aGlzLl9tYXhQYXlsb2FkICYmXG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5uYW1lID09PSBcInBvbGxpbmdcIiAmJlxuICAgICAgICAgICAgdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGggPiAxO1xuICAgICAgICBpZiAoIXNob3VsZENoZWNrUGF5bG9hZFNpemUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndyaXRlQnVmZmVyO1xuICAgICAgICB9XG4gICAgICAgIGxldCBwYXlsb2FkU2l6ZSA9IDE7IC8vIGZpcnN0IHBhY2tldCB0eXBlXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMud3JpdGVCdWZmZXJbaV0uZGF0YTtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcGF5bG9hZFNpemUgKz0gYnl0ZUxlbmd0aChkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpID4gMCAmJiBwYXlsb2FkU2l6ZSA+IHRoaXMuX21heFBheWxvYWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy53cml0ZUJ1ZmZlci5zbGljZSgwLCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBheWxvYWRTaXplICs9IDI7IC8vIHNlcGFyYXRvciArIHBhY2tldCB0eXBlXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMud3JpdGVCdWZmZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyB3aGV0aGVyIHRoZSBoZWFydGJlYXQgdGltZXIgaGFzIGV4cGlyZWQgYnV0IHRoZSBzb2NrZXQgaGFzIG5vdCB5ZXQgYmVlbiBub3RpZmllZC5cbiAgICAgKlxuICAgICAqIE5vdGU6IHRoaXMgbWV0aG9kIGlzIHByaXZhdGUgZm9yIG5vdyBiZWNhdXNlIGl0IGRvZXMgbm90IHJlYWxseSBmaXQgdGhlIFdlYlNvY2tldCBBUEksIGJ1dCBpZiB3ZSBwdXQgaXQgaW4gdGhlXG4gICAgICogYHdyaXRlKClgIG1ldGhvZCB0aGVuIHRoZSBtZXNzYWdlIHdvdWxkIG5vdCBiZSBidWZmZXJlZCBieSB0aGUgU29ja2V0LklPIGNsaWVudC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAvKiBwcml2YXRlICovIF9oYXNQaW5nRXhwaXJlZCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9waW5nVGltZW91dFRpbWUpXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgY29uc3QgaGFzRXhwaXJlZCA9IERhdGUubm93KCkgPiB0aGlzLl9waW5nVGltZW91dFRpbWU7XG4gICAgICAgIGlmIChoYXNFeHBpcmVkKSB7XG4gICAgICAgICAgICB0aGlzLl9waW5nVGltZW91dFRpbWUgPSAwO1xuICAgICAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uQ2xvc2UoXCJwaW5nIHRpbWVvdXRcIik7XG4gICAgICAgICAgICB9LCB0aGlzLnNldFRpbWVvdXRGbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhhc0V4cGlyZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgbWVzc2FnZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtc2cgLSBtZXNzYWdlLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gY2FsbGJhY2sgZnVuY3Rpb24uXG4gICAgICogQHJldHVybiB7U29ja2V0fSBmb3IgY2hhaW5pbmcuXG4gICAgICovXG4gICAgd3JpdGUobXNnLCBvcHRpb25zLCBmbikge1xuICAgICAgICB0aGlzLl9zZW5kUGFja2V0KFwibWVzc2FnZVwiLCBtc2csIG9wdGlvbnMsIGZuKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgbWVzc2FnZS4gQWxpYXMgb2Yge0BsaW5rIFNvY2tldCN3cml0ZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbXNnIC0gbWVzc2FnZS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIGNhbGxiYWNrIGZ1bmN0aW9uLlxuICAgICAqIEByZXR1cm4ge1NvY2tldH0gZm9yIGNoYWluaW5nLlxuICAgICAqL1xuICAgIHNlbmQobXNnLCBvcHRpb25zLCBmbikge1xuICAgICAgICB0aGlzLl9zZW5kUGFja2V0KFwibWVzc2FnZVwiLCBtc2csIG9wdGlvbnMsIGZuKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGU6IHBhY2tldCB0eXBlLlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gY2FsbGJhY2sgZnVuY3Rpb24uXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2VuZFBhY2tldCh0eXBlLCBkYXRhLCBvcHRpb25zLCBmbikge1xuICAgICAgICBpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2YgZGF0YSkge1xuICAgICAgICAgICAgZm4gPSBkYXRhO1xuICAgICAgICAgICAgZGF0YSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2Ygb3B0aW9ucykge1xuICAgICAgICAgICAgZm4gPSBvcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwiY2xvc2luZ1wiID09PSB0aGlzLnJlYWR5U3RhdGUgfHwgXCJjbG9zZWRcIiA9PT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgIG9wdGlvbnMuY29tcHJlc3MgPSBmYWxzZSAhPT0gb3B0aW9ucy5jb21wcmVzcztcbiAgICAgICAgY29uc3QgcGFja2V0ID0ge1xuICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBhY2tldENyZWF0ZVwiLCBwYWNrZXQpO1xuICAgICAgICB0aGlzLndyaXRlQnVmZmVyLnB1c2gocGFja2V0KTtcbiAgICAgICAgaWYgKGZuKVxuICAgICAgICAgICAgdGhpcy5vbmNlKFwiZmx1c2hcIiwgZm4pO1xuICAgICAgICB0aGlzLmZsdXNoKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgY29ubmVjdGlvbi5cbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgY29uc3QgY2xvc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9vbkNsb3NlKFwiZm9yY2VkIGNsb3NlXCIpO1xuICAgICAgICAgICAgdGhpcy50cmFuc3BvcnQuY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgY2xlYW51cEFuZENsb3NlID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vZmYoXCJ1cGdyYWRlXCIsIGNsZWFudXBBbmRDbG9zZSk7XG4gICAgICAgICAgICB0aGlzLm9mZihcInVwZ3JhZGVFcnJvclwiLCBjbGVhbnVwQW5kQ2xvc2UpO1xuICAgICAgICAgICAgY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgd2FpdEZvclVwZ3JhZGUgPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyB3YWl0IGZvciB1cGdyYWRlIHRvIGZpbmlzaCBzaW5jZSB3ZSBjYW4ndCBzZW5kIHBhY2tldHMgd2hpbGUgcGF1c2luZyBhIHRyYW5zcG9ydFxuICAgICAgICAgICAgdGhpcy5vbmNlKFwidXBncmFkZVwiLCBjbGVhbnVwQW5kQ2xvc2UpO1xuICAgICAgICAgICAgdGhpcy5vbmNlKFwidXBncmFkZUVycm9yXCIsIGNsZWFudXBBbmRDbG9zZSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChcIm9wZW5pbmdcIiA9PT0gdGhpcy5yZWFkeVN0YXRlIHx8IFwib3BlblwiID09PSB0aGlzLnJlYWR5U3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMucmVhZHlTdGF0ZSA9IFwiY2xvc2luZ1wiO1xuICAgICAgICAgICAgaWYgKHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmNlKFwiZHJhaW5cIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51cGdyYWRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRGb3JVcGdyYWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnVwZ3JhZGluZykge1xuICAgICAgICAgICAgICAgIHdhaXRGb3JVcGdyYWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiB0cmFuc3BvcnQgZXJyb3JcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uRXJyb3IoZXJyKSB7XG4gICAgICAgIFNvY2tldFdpdGhvdXRVcGdyYWRlLnByaW9yV2Vic29ja2V0U3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5vcHRzLnRyeUFsbFRyYW5zcG9ydHMgJiZcbiAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0cy5sZW5ndGggPiAxICYmXG4gICAgICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPT09IFwib3BlbmluZ1wiKSB7XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydHMuc2hpZnQoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vcGVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIpO1xuICAgICAgICB0aGlzLl9vbkNsb3NlKFwidHJhbnNwb3J0IGVycm9yXCIsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHRyYW5zcG9ydCBjbG9zZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uQ2xvc2UocmVhc29uLCBkZXNjcmlwdGlvbikge1xuICAgICAgICBpZiAoXCJvcGVuaW5nXCIgPT09IHRoaXMucmVhZHlTdGF0ZSB8fFxuICAgICAgICAgICAgXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSB8fFxuICAgICAgICAgICAgXCJjbG9zaW5nXCIgPT09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgLy8gY2xlYXIgdGltZXJzXG4gICAgICAgICAgICB0aGlzLmNsZWFyVGltZW91dEZuKHRoaXMuX3BpbmdUaW1lb3V0VGltZXIpO1xuICAgICAgICAgICAgLy8gc3RvcCBldmVudCBmcm9tIGZpcmluZyBhZ2FpbiBmb3IgdHJhbnNwb3J0XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoXCJjbG9zZVwiKTtcbiAgICAgICAgICAgIC8vIGVuc3VyZSB0cmFuc3BvcnQgd29uJ3Qgc3RheSBvcGVuXG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5jbG9zZSgpO1xuICAgICAgICAgICAgLy8gaWdub3JlIGZ1cnRoZXIgdHJhbnNwb3J0IGNvbW11bmljYXRpb25cbiAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgICAgICAgaWYgKHdpdGhFdmVudExpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9iZWZvcmV1bmxvYWRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoXCJiZWZvcmV1bmxvYWRcIiwgdGhpcy5fYmVmb3JldW5sb2FkRXZlbnRMaXN0ZW5lciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb2ZmbGluZUV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IE9GRkxJTkVfRVZFTlRfTElTVEVORVJTLmluZGV4T2YodGhpcy5fb2ZmbGluZUV2ZW50TGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE9GRkxJTkVfRVZFTlRfTElTVEVORVJTLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHNldCByZWFkeSBzdGF0ZVxuICAgICAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgICAgIC8vIGNsZWFyIHNlc3Npb24gaWRcbiAgICAgICAgICAgIHRoaXMuaWQgPSBudWxsO1xuICAgICAgICAgICAgLy8gZW1pdCBjbG9zZSBldmVudFxuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjbG9zZVwiLCByZWFzb24sIGRlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgIC8vIGNsZWFuIGJ1ZmZlcnMgYWZ0ZXIsIHNvIHVzZXJzIGNhbiBzdGlsbFxuICAgICAgICAgICAgLy8gZ3JhYiB0aGUgYnVmZmVycyBvbiBgY2xvc2VgIGV2ZW50XG4gICAgICAgICAgICB0aGlzLndyaXRlQnVmZmVyID0gW107XG4gICAgICAgICAgICB0aGlzLl9wcmV2QnVmZmVyTGVuID0gMDtcbiAgICAgICAgfVxuICAgIH1cbn1cblNvY2tldFdpdGhvdXRVcGdyYWRlLnByb3RvY29sID0gcHJvdG9jb2w7XG4vKipcbiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgYSBXZWJTb2NrZXQtbGlrZSBpbnRlcmZhY2UgdG8gY29ubmVjdCB0byBhbiBFbmdpbmUuSU8gc2VydmVyLiBUaGUgY29ubmVjdGlvbiB3aWxsIGJlIGVzdGFibGlzaGVkXG4gKiB3aXRoIG9uZSBvZiB0aGUgYXZhaWxhYmxlIGxvdy1sZXZlbCB0cmFuc3BvcnRzLCBsaWtlIEhUVFAgbG9uZy1wb2xsaW5nLCBXZWJTb2NrZXQgb3IgV2ViVHJhbnNwb3J0LlxuICpcbiAqIFRoaXMgY2xhc3MgY29tZXMgd2l0aCBhbiB1cGdyYWRlIG1lY2hhbmlzbSwgd2hpY2ggbWVhbnMgdGhhdCBvbmNlIHRoZSBjb25uZWN0aW9uIGlzIGVzdGFibGlzaGVkIHdpdGggdGhlIGZpcnN0XG4gKiBsb3ctbGV2ZWwgdHJhbnNwb3J0LCBpdCB3aWxsIHRyeSB0byB1cGdyYWRlIHRvIGEgYmV0dGVyIHRyYW5zcG9ydC5cbiAqXG4gKiBJbiBvcmRlciB0byBhbGxvdyB0cmVlLXNoYWtpbmcsIHRoZXJlIGFyZSBubyB0cmFuc3BvcnRzIGluY2x1ZGVkLCB0aGF0J3Mgd2h5IHRoZSBgdHJhbnNwb3J0c2Agb3B0aW9uIGlzIG1hbmRhdG9yeS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgU29ja2V0V2l0aFVwZ3JhZGUsIFdlYlNvY2tldCB9IGZyb20gXCJlbmdpbmUuaW8tY2xpZW50XCI7XG4gKlxuICogY29uc3Qgc29ja2V0ID0gbmV3IFNvY2tldFdpdGhVcGdyYWRlKHtcbiAqICAgdHJhbnNwb3J0czogW1dlYlNvY2tldF1cbiAqIH0pO1xuICpcbiAqIHNvY2tldC5vbihcIm9wZW5cIiwgKCkgPT4ge1xuICogICBzb2NrZXQuc2VuZChcImhlbGxvXCIpO1xuICogfSk7XG4gKlxuICogQHNlZSBTb2NrZXRXaXRob3V0VXBncmFkZVxuICogQHNlZSBTb2NrZXRcbiAqL1xuZXhwb3J0IGNsYXNzIFNvY2tldFdpdGhVcGdyYWRlIGV4dGVuZHMgU29ja2V0V2l0aG91dFVwZ3JhZGUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgICB0aGlzLl91cGdyYWRlcyA9IFtdO1xuICAgIH1cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpO1xuICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSAmJiB0aGlzLm9wdHMudXBncmFkZSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl91cGdyYWRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2JlKHRoaXMuX3VwZ3JhZGVzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm9iZXMgYSB0cmFuc3BvcnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSAtIHRyYW5zcG9ydCBuYW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfcHJvYmUobmFtZSkge1xuICAgICAgICBsZXQgdHJhbnNwb3J0ID0gdGhpcy5jcmVhdGVUcmFuc3BvcnQobmFtZSk7XG4gICAgICAgIGxldCBmYWlsZWQgPSBmYWxzZTtcbiAgICAgICAgU29ja2V0V2l0aG91dFVwZ3JhZGUucHJpb3JXZWJzb2NrZXRTdWNjZXNzID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IG9uVHJhbnNwb3J0T3BlbiA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChmYWlsZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgdHJhbnNwb3J0LnNlbmQoW3sgdHlwZTogXCJwaW5nXCIsIGRhdGE6IFwicHJvYmVcIiB9XSk7XG4gICAgICAgICAgICB0cmFuc3BvcnQub25jZShcInBhY2tldFwiLCAobXNnKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGZhaWxlZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChcInBvbmdcIiA9PT0gbXNnLnR5cGUgJiYgXCJwcm9iZVwiID09PSBtc2cuZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZ3JhZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwidXBncmFkaW5nXCIsIHRyYW5zcG9ydCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdHJhbnNwb3J0KVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBTb2NrZXRXaXRob3V0VXBncmFkZS5wcmlvcldlYnNvY2tldFN1Y2Nlc3MgPVxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3ZWJzb2NrZXRcIiA9PT0gdHJhbnNwb3J0Lm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LnBhdXNlKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmYWlsZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwiY2xvc2VkXCIgPT09IHRoaXMucmVhZHlTdGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFRyYW5zcG9ydCh0cmFuc3BvcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNwb3J0LnNlbmQoW3sgdHlwZTogXCJ1cGdyYWRlXCIgfV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJ1cGdyYWRlXCIsIHRyYW5zcG9ydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGdyYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmx1c2goKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnIgPSBuZXcgRXJyb3IoXCJwcm9iZSBlcnJvclwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBlcnIudHJhbnNwb3J0ID0gdHJhbnNwb3J0Lm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwidXBncmFkZUVycm9yXCIsIGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIGZyZWV6ZVRyYW5zcG9ydCgpIHtcbiAgICAgICAgICAgIGlmIChmYWlsZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgLy8gQW55IGNhbGxiYWNrIGNhbGxlZCBieSB0cmFuc3BvcnQgc2hvdWxkIGJlIGlnbm9yZWQgc2luY2Ugbm93XG4gICAgICAgICAgICBmYWlsZWQgPSB0cnVlO1xuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgdHJhbnNwb3J0LmNsb3NlKCk7XG4gICAgICAgICAgICB0cmFuc3BvcnQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIC8vIEhhbmRsZSBhbnkgZXJyb3IgdGhhdCBoYXBwZW5zIHdoaWxlIHByb2JpbmdcbiAgICAgICAgY29uc3Qgb25lcnJvciA9IChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwicHJvYmUgZXJyb3I6IFwiICsgZXJyKTtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGVycm9yLnRyYW5zcG9ydCA9IHRyYW5zcG9ydC5uYW1lO1xuICAgICAgICAgICAgZnJlZXplVHJhbnNwb3J0KCk7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInVwZ3JhZGVFcnJvclwiLCBlcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIG9uVHJhbnNwb3J0Q2xvc2UoKSB7XG4gICAgICAgICAgICBvbmVycm9yKFwidHJhbnNwb3J0IGNsb3NlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBXaGVuIHRoZSBzb2NrZXQgaXMgY2xvc2VkIHdoaWxlIHdlJ3JlIHByb2JpbmdcbiAgICAgICAgZnVuY3Rpb24gb25jbG9zZSgpIHtcbiAgICAgICAgICAgIG9uZXJyb3IoXCJzb2NrZXQgY2xvc2VkXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFdoZW4gdGhlIHNvY2tldCBpcyB1cGdyYWRlZCB3aGlsZSB3ZSdyZSBwcm9iaW5nXG4gICAgICAgIGZ1bmN0aW9uIG9udXBncmFkZSh0bykge1xuICAgICAgICAgICAgaWYgKHRyYW5zcG9ydCAmJiB0by5uYW1lICE9PSB0cmFuc3BvcnQubmFtZSkge1xuICAgICAgICAgICAgICAgIGZyZWV6ZVRyYW5zcG9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIFJlbW92ZSBhbGwgbGlzdGVuZXJzIG9uIHRoZSB0cmFuc3BvcnQgYW5kIG9uIHNlbGZcbiAgICAgICAgY29uc3QgY2xlYW51cCA9ICgpID0+IHtcbiAgICAgICAgICAgIHRyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcihcIm9wZW5cIiwgb25UcmFuc3BvcnRPcGVuKTtcbiAgICAgICAgICAgIHRyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcihcImVycm9yXCIsIG9uZXJyb3IpO1xuICAgICAgICAgICAgdHJhbnNwb3J0LnJlbW92ZUxpc3RlbmVyKFwiY2xvc2VcIiwgb25UcmFuc3BvcnRDbG9zZSk7XG4gICAgICAgICAgICB0aGlzLm9mZihcImNsb3NlXCIsIG9uY2xvc2UpO1xuICAgICAgICAgICAgdGhpcy5vZmYoXCJ1cGdyYWRpbmdcIiwgb251cGdyYWRlKTtcbiAgICAgICAgfTtcbiAgICAgICAgdHJhbnNwb3J0Lm9uY2UoXCJvcGVuXCIsIG9uVHJhbnNwb3J0T3Blbik7XG4gICAgICAgIHRyYW5zcG9ydC5vbmNlKFwiZXJyb3JcIiwgb25lcnJvcik7XG4gICAgICAgIHRyYW5zcG9ydC5vbmNlKFwiY2xvc2VcIiwgb25UcmFuc3BvcnRDbG9zZSk7XG4gICAgICAgIHRoaXMub25jZShcImNsb3NlXCIsIG9uY2xvc2UpO1xuICAgICAgICB0aGlzLm9uY2UoXCJ1cGdyYWRpbmdcIiwgb251cGdyYWRlKTtcbiAgICAgICAgaWYgKHRoaXMuX3VwZ3JhZGVzLmluZGV4T2YoXCJ3ZWJ0cmFuc3BvcnRcIikgIT09IC0xICYmXG4gICAgICAgICAgICBuYW1lICE9PSBcIndlYnRyYW5zcG9ydFwiKSB7XG4gICAgICAgICAgICAvLyBmYXZvciBXZWJUcmFuc3BvcnRcbiAgICAgICAgICAgIHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWZhaWxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFuc3BvcnQub3BlbigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uSGFuZHNoYWtlKGRhdGEpIHtcbiAgICAgICAgdGhpcy5fdXBncmFkZXMgPSB0aGlzLl9maWx0ZXJVcGdyYWRlcyhkYXRhLnVwZ3JhZGVzKTtcbiAgICAgICAgc3VwZXIub25IYW5kc2hha2UoZGF0YSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpbHRlcnMgdXBncmFkZXMsIHJldHVybmluZyBvbmx5IHRob3NlIG1hdGNoaW5nIGNsaWVudCB0cmFuc3BvcnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gdXBncmFkZXMgLSBzZXJ2ZXIgdXBncmFkZXNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9maWx0ZXJVcGdyYWRlcyh1cGdyYWRlcykge1xuICAgICAgICBjb25zdCBmaWx0ZXJlZFVwZ3JhZGVzID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXBncmFkZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh+dGhpcy50cmFuc3BvcnRzLmluZGV4T2YodXBncmFkZXNbaV0pKVxuICAgICAgICAgICAgICAgIGZpbHRlcmVkVXBncmFkZXMucHVzaCh1cGdyYWRlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpbHRlcmVkVXBncmFkZXM7XG4gICAgfVxufVxuLyoqXG4gKiBUaGlzIGNsYXNzIHByb3ZpZGVzIGEgV2ViU29ja2V0LWxpa2UgaW50ZXJmYWNlIHRvIGNvbm5lY3QgdG8gYW4gRW5naW5lLklPIHNlcnZlci4gVGhlIGNvbm5lY3Rpb24gd2lsbCBiZSBlc3RhYmxpc2hlZFxuICogd2l0aCBvbmUgb2YgdGhlIGF2YWlsYWJsZSBsb3ctbGV2ZWwgdHJhbnNwb3J0cywgbGlrZSBIVFRQIGxvbmctcG9sbGluZywgV2ViU29ja2V0IG9yIFdlYlRyYW5zcG9ydC5cbiAqXG4gKiBUaGlzIGNsYXNzIGNvbWVzIHdpdGggYW4gdXBncmFkZSBtZWNoYW5pc20sIHdoaWNoIG1lYW5zIHRoYXQgb25jZSB0aGUgY29ubmVjdGlvbiBpcyBlc3RhYmxpc2hlZCB3aXRoIHRoZSBmaXJzdFxuICogbG93LWxldmVsIHRyYW5zcG9ydCwgaXQgd2lsbCB0cnkgdG8gdXBncmFkZSB0byBhIGJldHRlciB0cmFuc3BvcnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFNvY2tldCB9IGZyb20gXCJlbmdpbmUuaW8tY2xpZW50XCI7XG4gKlxuICogY29uc3Qgc29ja2V0ID0gbmV3IFNvY2tldCgpO1xuICpcbiAqIHNvY2tldC5vbihcIm9wZW5cIiwgKCkgPT4ge1xuICogICBzb2NrZXQuc2VuZChcImhlbGxvXCIpO1xuICogfSk7XG4gKlxuICogQHNlZSBTb2NrZXRXaXRob3V0VXBncmFkZVxuICogQHNlZSBTb2NrZXRXaXRoVXBncmFkZVxuICovXG5leHBvcnQgY2xhc3MgU29ja2V0IGV4dGVuZHMgU29ja2V0V2l0aFVwZ3JhZGUge1xuICAgIGNvbnN0cnVjdG9yKHVyaSwgb3B0cyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG8gPSB0eXBlb2YgdXJpID09PSBcIm9iamVjdFwiID8gdXJpIDogb3B0cztcbiAgICAgICAgaWYgKCFvLnRyYW5zcG9ydHMgfHxcbiAgICAgICAgICAgIChvLnRyYW5zcG9ydHMgJiYgdHlwZW9mIG8udHJhbnNwb3J0c1swXSA9PT0gXCJzdHJpbmdcIikpIHtcbiAgICAgICAgICAgIG8udHJhbnNwb3J0cyA9IChvLnRyYW5zcG9ydHMgfHwgW1wicG9sbGluZ1wiLCBcIndlYnNvY2tldFwiLCBcIndlYnRyYW5zcG9ydFwiXSlcbiAgICAgICAgICAgICAgICAubWFwKCh0cmFuc3BvcnROYW1lKSA9PiBERUZBVUxUX1RSQU5TUE9SVFNbdHJhbnNwb3J0TmFtZV0pXG4gICAgICAgICAgICAgICAgLmZpbHRlcigodCkgPT4gISF0KTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlcih1cmksIG8pO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js ***!
  \********************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Transport: () => (/* binding */ Transport),\n/* harmony export */   TransportError: () => (/* binding */ TransportError)\n/* harmony export */ });\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./contrib/parseqs.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js");\n\n\n\n\nclass TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = "TransportError";\n    }\n}\nclass Transport extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__.Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        (0,_util_js__WEBPACK_IMPORTED_MODULE_2__.installTimerFunctions)(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved("error", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = "opening";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === "opening" || this.readyState === "open") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === "open") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = "open";\n        this.writable = true;\n        super.emitReserved("open");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_0__.decodePacket)(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved("packet", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = "closed";\n        super.emitReserved("close", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            "://" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(":") === -1 ? hostname : "[" + hostname + "]";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return ":" + this.opts.port;\n        }\n        else {\n            return "";\n        }\n    }\n    _query(query) {\n        const encodedQuery = (0,_contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_3__.encode)(query);\n        return encodedQuery.length ? "?" + encodedQuery : "";\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFnRDtBQUNPO0FBQ0w7QUFDSjtBQUN2QztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sd0JBQXdCLGlFQUFPO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwrREFBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0EsZ0JBQWdCLFdBQVc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qiw4REFBWTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwyREFBTTtBQUNuQztBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0LmpzP2VjM2YiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVjb2RlUGFja2V0IH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmltcG9ydCB7IEVtaXR0ZXIgfSBmcm9tIFwiQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlclwiO1xuaW1wb3J0IHsgaW5zdGFsbFRpbWVyRnVuY3Rpb25zIH0gZnJvbSBcIi4vdXRpbC5qc1wiO1xuaW1wb3J0IHsgZW5jb2RlIH0gZnJvbSBcIi4vY29udHJpYi9wYXJzZXFzLmpzXCI7XG5leHBvcnQgY2xhc3MgVHJhbnNwb3J0RXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IocmVhc29uLCBkZXNjcmlwdGlvbiwgY29udGV4dCkge1xuICAgICAgICBzdXBlcihyZWFzb24pO1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMudHlwZSA9IFwiVHJhbnNwb3J0RXJyb3JcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVHJhbnNwb3J0IGV4dGVuZHMgRW1pdHRlciB7XG4gICAgLyoqXG4gICAgICogVHJhbnNwb3J0IGFic3RyYWN0IGNvbnN0cnVjdG9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdHMgLSBvcHRpb25zXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9wdHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy53cml0YWJsZSA9IGZhbHNlO1xuICAgICAgICBpbnN0YWxsVGltZXJGdW5jdGlvbnModGhpcywgb3B0cyk7XG4gICAgICAgIHRoaXMub3B0cyA9IG9wdHM7XG4gICAgICAgIHRoaXMucXVlcnkgPSBvcHRzLnF1ZXJ5O1xuICAgICAgICB0aGlzLnNvY2tldCA9IG9wdHMuc29ja2V0O1xuICAgICAgICB0aGlzLnN1cHBvcnRzQmluYXJ5ID0gIW9wdHMuZm9yY2VCYXNlNjQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVtaXRzIGFuIGVycm9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHJlYXNvblxuICAgICAqIEBwYXJhbSBkZXNjcmlwdGlvblxuICAgICAqIEBwYXJhbSBjb250ZXh0IC0gdGhlIGVycm9yIGNvbnRleHRcbiAgICAgKiBAcmV0dXJuIHtUcmFuc3BvcnR9IGZvciBjaGFpbmluZ1xuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBvbkVycm9yKHJlYXNvbiwgZGVzY3JpcHRpb24sIGNvbnRleHQpIHtcbiAgICAgICAgc3VwZXIuZW1pdFJlc2VydmVkKFwiZXJyb3JcIiwgbmV3IFRyYW5zcG9ydEVycm9yKHJlYXNvbiwgZGVzY3JpcHRpb24sIGNvbnRleHQpKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9wZW5zIHRoZSB0cmFuc3BvcnQuXG4gICAgICovXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJvcGVuaW5nXCI7XG4gICAgICAgIHRoaXMuZG9PcGVuKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIHRyYW5zcG9ydC5cbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gXCJvcGVuaW5nXCIgfHwgdGhpcy5yZWFkeVN0YXRlID09PSBcIm9wZW5cIikge1xuICAgICAgICAgICAgdGhpcy5kb0Nsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLm9uQ2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgbXVsdGlwbGUgcGFja2V0cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhY2tldHNcbiAgICAgKi9cbiAgICBzZW5kKHBhY2tldHMpIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gXCJvcGVuXCIpIHtcbiAgICAgICAgICAgIHRoaXMud3JpdGUocGFja2V0cyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyB0aGlzIG1pZ2h0IGhhcHBlbiBpZiB0aGUgdHJhbnNwb3J0IHdhcyBzaWxlbnRseSBjbG9zZWQgaW4gdGhlIGJlZm9yZXVubG9hZCBldmVudCBoYW5kbGVyXG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gb3BlblxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJvcGVuXCI7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSB0cnVlO1xuICAgICAgICBzdXBlci5lbWl0UmVzZXJ2ZWQoXCJvcGVuXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2l0aCBkYXRhLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGFcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgb25EYXRhKGRhdGEpIHtcbiAgICAgICAgY29uc3QgcGFja2V0ID0gZGVjb2RlUGFja2V0KGRhdGEsIHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpO1xuICAgICAgICB0aGlzLm9uUGFja2V0KHBhY2tldCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aXRoIGEgZGVjb2RlZCBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgb25QYWNrZXQocGFja2V0KSB7XG4gICAgICAgIHN1cGVyLmVtaXRSZXNlcnZlZChcInBhY2tldFwiLCBwYWNrZXQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBjbG9zZS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBvbkNsb3NlKGRldGFpbHMpIHtcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgc3VwZXIuZW1pdFJlc2VydmVkKFwiY2xvc2VcIiwgZGV0YWlscyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhdXNlcyB0aGUgdHJhbnNwb3J0LCBpbiBvcmRlciBub3QgdG8gbG9zZSBwYWNrZXRzIGR1cmluZyBhbiB1cGdyYWRlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9uUGF1c2VcbiAgICAgKi9cbiAgICBwYXVzZShvblBhdXNlKSB7IH1cbiAgICBjcmVhdGVVcmkoc2NoZW1hLCBxdWVyeSA9IHt9KSB7XG4gICAgICAgIHJldHVybiAoc2NoZW1hICtcbiAgICAgICAgICAgIFwiOi8vXCIgK1xuICAgICAgICAgICAgdGhpcy5faG9zdG5hbWUoKSArXG4gICAgICAgICAgICB0aGlzLl9wb3J0KCkgK1xuICAgICAgICAgICAgdGhpcy5vcHRzLnBhdGggK1xuICAgICAgICAgICAgdGhpcy5fcXVlcnkocXVlcnkpKTtcbiAgICB9XG4gICAgX2hvc3RuYW1lKCkge1xuICAgICAgICBjb25zdCBob3N0bmFtZSA9IHRoaXMub3B0cy5ob3N0bmFtZTtcbiAgICAgICAgcmV0dXJuIGhvc3RuYW1lLmluZGV4T2YoXCI6XCIpID09PSAtMSA/IGhvc3RuYW1lIDogXCJbXCIgKyBob3N0bmFtZSArIFwiXVwiO1xuICAgIH1cbiAgICBfcG9ydCgpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0cy5wb3J0ICYmXG4gICAgICAgICAgICAoKHRoaXMub3B0cy5zZWN1cmUgJiYgTnVtYmVyKHRoaXMub3B0cy5wb3J0ICE9PSA0NDMpKSB8fFxuICAgICAgICAgICAgICAgICghdGhpcy5vcHRzLnNlY3VyZSAmJiBOdW1iZXIodGhpcy5vcHRzLnBvcnQpICE9PSA4MCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gXCI6XCIgKyB0aGlzLm9wdHMucG9ydDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9xdWVyeShxdWVyeSkge1xuICAgICAgICBjb25zdCBlbmNvZGVkUXVlcnkgPSBlbmNvZGUocXVlcnkpO1xuICAgICAgICByZXR1cm4gZW5jb2RlZFF1ZXJ5Lmxlbmd0aCA/IFwiP1wiICsgZW5jb2RlZFF1ZXJ5IDogXCJcIjtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js ***!
  \***************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   transports: () => (/* binding */ transports)\n/* harmony export */ });\n/* harmony import */ var _polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./polling-xhr.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js");\n/* harmony import */ var _websocket_node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./websocket.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js");\n/* harmony import */ var _webtransport_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./webtransport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js");\n\n\n\nconst transports = {\n    websocket: _websocket_node_js__WEBPACK_IMPORTED_MODULE_1__.WS,\n    webtransport: _webtransport_js__WEBPACK_IMPORTED_MODULE_2__.WT,\n    polling: _polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_0__.XHR,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTRDO0FBQ0g7QUFDRjtBQUNoQztBQUNQLGVBQWUsa0RBQUU7QUFDakIsa0JBQWtCLGdEQUFFO0FBQ3BCLGFBQWEscURBQUc7QUFDaEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9pbmRleC5qcz85NWYzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFhIUiB9IGZyb20gXCIuL3BvbGxpbmcteGhyLm5vZGUuanNcIjtcbmltcG9ydCB7IFdTIH0gZnJvbSBcIi4vd2Vic29ja2V0Lm5vZGUuanNcIjtcbmltcG9ydCB7IFdUIH0gZnJvbSBcIi4vd2VidHJhbnNwb3J0LmpzXCI7XG5leHBvcnQgY29uc3QgdHJhbnNwb3J0cyA9IHtcbiAgICB3ZWJzb2NrZXQ6IFdTLFxuICAgIHdlYnRyYW5zcG9ydDogV1QsXG4gICAgcG9sbGluZzogWEhSLFxufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js ***!
  \***********************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Fetch: () => (/* binding */ Fetch)\n/* harmony export */ });\n/* harmony import */ var _polling_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./polling.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js");\n\n/**\n * HTTP long-polling based on the built-in `fetch()` method.\n *\n * Usage: browser, Node.js (since v18), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/fetch\n * @see https://caniuse.com/fetch\n * @see https://nodejs.org/api/globals.html#fetch\n */\nclass Fetch extends _polling_js__WEBPACK_IMPORTED_MODULE_0__.Polling {\n    doPoll() {\n        this._fetch()\n            .then((res) => {\n            if (!res.ok) {\n                return this.onError("fetch read error", res.status, res);\n            }\n            res.text().then((data) => this.onData(data));\n        })\n            .catch((err) => {\n            this.onError("fetch read error", err);\n        });\n    }\n    doWrite(data, callback) {\n        this._fetch(data)\n            .then((res) => {\n            if (!res.ok) {\n                return this.onError("fetch write error", res.status, res);\n            }\n            callback();\n        })\n            .catch((err) => {\n            this.onError("fetch write error", err);\n        });\n    }\n    _fetch(data) {\n        var _a;\n        const isPost = data !== undefined;\n        const headers = new Headers(this.opts.extraHeaders);\n        if (isPost) {\n            headers.set("content-type", "text/plain;charset=UTF-8");\n        }\n        (_a = this.socket._cookieJar) === null || _a === void 0 ? void 0 : _a.appendCookies(headers);\n        return fetch(this.uri(), {\n            method: isPost ? "POST" : "GET",\n            body: isPost ? data : null,\n            headers,\n            credentials: this.opts.withCredentials ? "include" : "omit",\n        }).then((res) => {\n            var _a;\n            // @ts-ignore getSetCookie() was added in Node.js v19.7.0\n            (_a = this.socket._cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(res.headers.getSetCookie());\n            return res;\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9wb2xsaW5nLWZldGNoLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLG9CQUFvQixnREFBTztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS90cmFuc3BvcnRzL3BvbGxpbmctZmV0Y2guanM/MmI4ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb2xsaW5nIH0gZnJvbSBcIi4vcG9sbGluZy5qc1wiO1xuLyoqXG4gKiBIVFRQIGxvbmctcG9sbGluZyBiYXNlZCBvbiB0aGUgYnVpbHQtaW4gYGZldGNoKClgIG1ldGhvZC5cbiAqXG4gKiBVc2FnZTogYnJvd3NlciwgTm9kZS5qcyAoc2luY2UgdjE4KSwgRGVubywgQnVuXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvZmV0Y2hcbiAqIEBzZWUgaHR0cHM6Ly9jYW5pdXNlLmNvbS9mZXRjaFxuICogQHNlZSBodHRwczovL25vZGVqcy5vcmcvYXBpL2dsb2JhbHMuaHRtbCNmZXRjaFxuICovXG5leHBvcnQgY2xhc3MgRmV0Y2ggZXh0ZW5kcyBQb2xsaW5nIHtcbiAgICBkb1BvbGwoKSB7XG4gICAgICAgIHRoaXMuX2ZldGNoKClcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICghcmVzLm9rKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub25FcnJvcihcImZldGNoIHJlYWQgZXJyb3JcIiwgcmVzLnN0YXR1cywgcmVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcy50ZXh0KCkudGhlbigoZGF0YSkgPT4gdGhpcy5vbkRhdGEoZGF0YSkpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25FcnJvcihcImZldGNoIHJlYWQgZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRvV3JpdGUoZGF0YSwgY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5fZmV0Y2goZGF0YSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICghcmVzLm9rKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub25FcnJvcihcImZldGNoIHdyaXRlIGVycm9yXCIsIHJlcy5zdGF0dXMsIHJlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25FcnJvcihcImZldGNoIHdyaXRlIGVycm9yXCIsIGVycik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBfZmV0Y2goZGF0YSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IGlzUG9zdCA9IGRhdGEgIT09IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IG5ldyBIZWFkZXJzKHRoaXMub3B0cy5leHRyYUhlYWRlcnMpO1xuICAgICAgICBpZiAoaXNQb3N0KSB7XG4gICAgICAgICAgICBoZWFkZXJzLnNldChcImNvbnRlbnQtdHlwZVwiLCBcInRleHQvcGxhaW47Y2hhcnNldD1VVEYtOFwiKTtcbiAgICAgICAgfVxuICAgICAgICAoX2EgPSB0aGlzLnNvY2tldC5fY29va2llSmFyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYXBwZW5kQ29va2llcyhoZWFkZXJzKTtcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMudXJpKCksIHtcbiAgICAgICAgICAgIG1ldGhvZDogaXNQb3N0ID8gXCJQT1NUXCIgOiBcIkdFVFwiLFxuICAgICAgICAgICAgYm9keTogaXNQb3N0ID8gZGF0YSA6IG51bGwsXG4gICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgY3JlZGVudGlhbHM6IHRoaXMub3B0cy53aXRoQ3JlZGVudGlhbHMgPyBcImluY2x1ZGVcIiA6IFwib21pdFwiLFxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgZ2V0U2V0Q29va2llKCkgd2FzIGFkZGVkIGluIE5vZGUuanMgdjE5LjcuMFxuICAgICAgICAgICAgKF9hID0gdGhpcy5zb2NrZXQuX2Nvb2tpZUphcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBhcnNlQ29va2llcyhyZXMuaGVhZGVycy5nZXRTZXRDb29raWUoKSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js ***!
  \*********************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseXHR: () => (/* binding */ BaseXHR),\n/* harmony export */   Request: () => (/* binding */ Request),\n/* harmony export */   XHR: () => (/* binding */ XHR)\n/* harmony export */ });\n/* harmony import */ var _polling_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./polling.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n/* harmony import */ var _contrib_has_cors_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../contrib/has-cors.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js");\n\n\n\n\n\nfunction empty() { }\nclass BaseXHR extends _polling_js__WEBPACK_IMPORTED_MODULE_0__.Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== "undefined") {\n            const isSSL = "https:" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? "443" : "80";\n            }\n            this.xd =\n                (typeof location !== "undefined" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: "POST",\n            data: data,\n        });\n        req.on("success", fn);\n        req.on("error", (xhrStatus, context) => {\n            this.onError("xhr post error", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on("data", this.onData.bind(this));\n        req.on("error", (xhrStatus, context) => {\n            this.onError("xhr poll error", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nclass Request extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__.Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        (0,_util_js__WEBPACK_IMPORTED_MODULE_2__.installTimerFunctions)(this, opts);\n        this._opts = opts;\n        this._method = opts.method || "GET";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = (0,_util_js__WEBPACK_IMPORTED_MODULE_2__.pick)(this._opts, "agent", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "autoUnref");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if ("POST" === this._method) {\n                try {\n                    xhr.setRequestHeader("Content-type", "text/plain;charset=UTF-8");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader("Accept", "*/*");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if ("withCredentials" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader("set-cookie"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that\'s user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === "number" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the \'error\' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== "undefined") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved("error", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if ("undefined" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== "undefined") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved("data", data);\n            this.emitReserved("success");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== "undefined") {\n    // @ts-ignore\n    if (typeof attachEvent === "function") {\n        // @ts-ignore\n        attachEvent("onunload", unloadHandler);\n    }\n    else if (typeof addEventListener === "function") {\n        const terminationEvent = "onpagehide" in _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim ? "pagehide" : "unload";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nclass XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if ("undefined" !== typeof XMLHttpRequest && (!xdomain || _contrib_has_cors_js__WEBPACK_IMPORTED_MODULE_4__.hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP");\n        }\n        catch (e) { }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9wb2xsaW5nLXhoci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUF1QztBQUNnQjtBQUNFO0FBQ1M7QUFDakI7QUFDakQ7QUFDTyxzQkFBc0IsZ0RBQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxVQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDTyxzQkFBc0IsaUVBQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtEQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw4Q0FBSTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyw0RUFBMEI7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsOEJBQThCLGFBQWE7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRUFBa0UseURBQU87QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDREQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL3RyYW5zcG9ydHMvcG9sbGluZy14aHIuanM/NjBlYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb2xsaW5nIH0gZnJvbSBcIi4vcG9sbGluZy5qc1wiO1xuaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gXCJAc29ja2V0LmlvL2NvbXBvbmVudC1lbWl0dGVyXCI7XG5pbXBvcnQgeyBpbnN0YWxsVGltZXJGdW5jdGlvbnMsIHBpY2sgfSBmcm9tIFwiLi4vdXRpbC5qc1wiO1xuaW1wb3J0IHsgZ2xvYmFsVGhpc1NoaW0gYXMgZ2xvYmFsVGhpcyB9IGZyb20gXCIuLi9nbG9iYWxzLm5vZGUuanNcIjtcbmltcG9ydCB7IGhhc0NPUlMgfSBmcm9tIFwiLi4vY29udHJpYi9oYXMtY29ycy5qc1wiO1xuZnVuY3Rpb24gZW1wdHkoKSB7IH1cbmV4cG9ydCBjbGFzcyBCYXNlWEhSIGV4dGVuZHMgUG9sbGluZyB7XG4gICAgLyoqXG4gICAgICogWEhSIFBvbGxpbmcgY29uc3RydWN0b3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0c1xuICAgICAqIEBwYWNrYWdlXG4gICAgICovXG4gICAgY29uc3RydWN0b3Iob3B0cykge1xuICAgICAgICBzdXBlcihvcHRzKTtcbiAgICAgICAgaWYgKHR5cGVvZiBsb2NhdGlvbiAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgY29uc3QgaXNTU0wgPSBcImh0dHBzOlwiID09PSBsb2NhdGlvbi5wcm90b2NvbDtcbiAgICAgICAgICAgIGxldCBwb3J0ID0gbG9jYXRpb24ucG9ydDtcbiAgICAgICAgICAgIC8vIHNvbWUgdXNlciBhZ2VudHMgaGF2ZSBlbXB0eSBgbG9jYXRpb24ucG9ydGBcbiAgICAgICAgICAgIGlmICghcG9ydCkge1xuICAgICAgICAgICAgICAgIHBvcnQgPSBpc1NTTCA/IFwiNDQzXCIgOiBcIjgwXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnhkID1cbiAgICAgICAgICAgICAgICAodHlwZW9mIGxvY2F0aW9uICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgICAgICAgICAgICAgICAgIG9wdHMuaG9zdG5hbWUgIT09IGxvY2F0aW9uLmhvc3RuYW1lKSB8fFxuICAgICAgICAgICAgICAgICAgICBwb3J0ICE9PSBvcHRzLnBvcnQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgZGF0YS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhIHRvIHNlbmQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGVkIHVwb24gZmx1c2guXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBkb1dyaXRlKGRhdGEsIGZuKSB7XG4gICAgICAgIGNvbnN0IHJlcSA9IHRoaXMucmVxdWVzdCh7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJlcS5vbihcInN1Y2Nlc3NcIiwgZm4pO1xuICAgICAgICByZXEub24oXCJlcnJvclwiLCAoeGhyU3RhdHVzLCBjb250ZXh0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRXJyb3IoXCJ4aHIgcG9zdCBlcnJvclwiLCB4aHJTdGF0dXMsIGNvbnRleHQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIGEgcG9sbCBjeWNsZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZG9Qb2xsKCkge1xuICAgICAgICBjb25zdCByZXEgPSB0aGlzLnJlcXVlc3QoKTtcbiAgICAgICAgcmVxLm9uKFwiZGF0YVwiLCB0aGlzLm9uRGF0YS5iaW5kKHRoaXMpKTtcbiAgICAgICAgcmVxLm9uKFwiZXJyb3JcIiwgKHhoclN0YXR1cywgY29udGV4dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbkVycm9yKFwieGhyIHBvbGwgZXJyb3JcIiwgeGhyU3RhdHVzLCBjb250ZXh0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucG9sbFhociA9IHJlcTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUmVxdWVzdCBleHRlbmRzIEVtaXR0ZXIge1xuICAgIC8qKlxuICAgICAqIFJlcXVlc3QgY29uc3RydWN0b3JcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAgICogQHBhY2thZ2VcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihjcmVhdGVSZXF1ZXN0LCB1cmksIG9wdHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVSZXF1ZXN0ID0gY3JlYXRlUmVxdWVzdDtcbiAgICAgICAgaW5zdGFsbFRpbWVyRnVuY3Rpb25zKHRoaXMsIG9wdHMpO1xuICAgICAgICB0aGlzLl9vcHRzID0gb3B0cztcbiAgICAgICAgdGhpcy5fbWV0aG9kID0gb3B0cy5tZXRob2QgfHwgXCJHRVRcIjtcbiAgICAgICAgdGhpcy5fdXJpID0gdXJpO1xuICAgICAgICB0aGlzLl9kYXRhID0gdW5kZWZpbmVkICE9PSBvcHRzLmRhdGEgPyBvcHRzLmRhdGEgOiBudWxsO1xuICAgICAgICB0aGlzLl9jcmVhdGUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyB0aGUgWEhSIG9iamVjdCBhbmQgc2VuZHMgdGhlIHJlcXVlc3QuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jcmVhdGUoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc3Qgb3B0cyA9IHBpY2sodGhpcy5fb3B0cywgXCJhZ2VudFwiLCBcInBmeFwiLCBcImtleVwiLCBcInBhc3NwaHJhc2VcIiwgXCJjZXJ0XCIsIFwiY2FcIiwgXCJjaXBoZXJzXCIsIFwicmVqZWN0VW5hdXRob3JpemVkXCIsIFwiYXV0b1VucmVmXCIpO1xuICAgICAgICBvcHRzLnhkb21haW4gPSAhIXRoaXMuX29wdHMueGQ7XG4gICAgICAgIGNvbnN0IHhociA9ICh0aGlzLl94aHIgPSB0aGlzLmNyZWF0ZVJlcXVlc3Qob3B0cykpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgeGhyLm9wZW4odGhpcy5fbWV0aG9kLCB0aGlzLl91cmksIHRydWUpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb3B0cy5leHRyYUhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICB4aHIuc2V0RGlzYWJsZUhlYWRlckNoZWNrICYmIHhoci5zZXREaXNhYmxlSGVhZGVyQ2hlY2sodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5fb3B0cy5leHRyYUhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vcHRzLmV4dHJhSGVhZGVycy5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKGksIHRoaXMuX29wdHMuZXh0cmFIZWFkZXJzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgIGlmIChcIlBPU1RcIiA9PT0gdGhpcy5fbWV0aG9kKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LXR5cGVcIiwgXCJ0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLThcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJBY2NlcHRcIiwgXCIqLypcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkgeyB9XG4gICAgICAgICAgICAoX2EgPSB0aGlzLl9vcHRzLmNvb2tpZUphcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmFkZENvb2tpZXMoeGhyKTtcbiAgICAgICAgICAgIC8vIGllNiBjaGVja1xuICAgICAgICAgICAgaWYgKFwid2l0aENyZWRlbnRpYWxzXCIgaW4geGhyKSB7XG4gICAgICAgICAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRoaXMuX29wdHMud2l0aENyZWRlbnRpYWxzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX29wdHMucmVxdWVzdFRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICB4aHIudGltZW91dCA9IHRoaXMuX29wdHMucmVxdWVzdFRpbWVvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgKF9hID0gdGhpcy5fb3B0cy5jb29raWVKYXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wYXJzZUNvb2tpZXMoXG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgeGhyLmdldFJlc3BvbnNlSGVhZGVyKFwic2V0LWNvb2tpZVwiKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICg0ICE9PSB4aHIucmVhZHlTdGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmICgyMDAgPT09IHhoci5zdGF0dXMgfHwgMTIyMyA9PT0geGhyLnN0YXR1cykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkxvYWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgYGVycm9yYCBldmVudCBoYW5kbGVyIHRoYXQncyB1c2VyLXNldFxuICAgICAgICAgICAgICAgICAgICAvLyBkb2VzIG5vdCB0aHJvdyBpbiB0aGUgc2FtZSB0aWNrIGFuZCBnZXRzIGNhdWdodCBoZXJlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IodHlwZW9mIHhoci5zdGF0dXMgPT09IFwibnVtYmVyXCIgPyB4aHIuc3RhdHVzIDogMCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB4aHIuc2VuZCh0aGlzLl9kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gTmVlZCB0byBkZWZlciBzaW5jZSAuY3JlYXRlKCkgaXMgY2FsbGVkIGRpcmVjdGx5IGZyb20gdGhlIGNvbnN0cnVjdG9yXG4gICAgICAgICAgICAvLyBhbmQgdGh1cyB0aGUgJ2Vycm9yJyBldmVudCBjYW4gb25seSBiZSBvbmx5IGJvdW5kICphZnRlciogdGhpcyBleGNlcHRpb25cbiAgICAgICAgICAgIC8vIG9jY3Vycy4gIFRoZXJlZm9yZSwgYWxzbywgd2UgY2Fubm90IHRocm93IGhlcmUgYXQgYWxsLlxuICAgICAgICAgICAgdGhpcy5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoZSk7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB0aGlzLl9pbmRleCA9IFJlcXVlc3QucmVxdWVzdHNDb3VudCsrO1xuICAgICAgICAgICAgUmVxdWVzdC5yZXF1ZXN0c1t0aGlzLl9pbmRleF0gPSB0aGlzO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGVycm9yLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25FcnJvcihlcnIpIHtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIsIHRoaXMuX3hocik7XG4gICAgICAgIHRoaXMuX2NsZWFudXAodHJ1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFucyB1cCBob3VzZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2NsZWFudXAoZnJvbUVycm9yKSB7XG4gICAgICAgIGlmIChcInVuZGVmaW5lZFwiID09PSB0eXBlb2YgdGhpcy5feGhyIHx8IG51bGwgPT09IHRoaXMuX3hocikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3hoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBlbXB0eTtcbiAgICAgICAgaWYgKGZyb21FcnJvcikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBkZWxldGUgUmVxdWVzdC5yZXF1ZXN0c1t0aGlzLl9pbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5feGhyID0gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gbG9hZC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uTG9hZCgpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX3hoci5yZXNwb25zZVRleHQ7XG4gICAgICAgIGlmIChkYXRhICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImRhdGFcIiwgZGF0YSk7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInN1Y2Nlc3NcIik7XG4gICAgICAgICAgICB0aGlzLl9jbGVhbnVwKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQWJvcnRzIHRoZSByZXF1ZXN0LlxuICAgICAqXG4gICAgICogQHBhY2thZ2VcbiAgICAgKi9cbiAgICBhYm9ydCgpIHtcbiAgICAgICAgdGhpcy5fY2xlYW51cCgpO1xuICAgIH1cbn1cblJlcXVlc3QucmVxdWVzdHNDb3VudCA9IDA7XG5SZXF1ZXN0LnJlcXVlc3RzID0ge307XG4vKipcbiAqIEFib3J0cyBwZW5kaW5nIHJlcXVlc3RzIHdoZW4gdW5sb2FkaW5nIHRoZSB3aW5kb3cuIFRoaXMgaXMgbmVlZGVkIHRvIHByZXZlbnRcbiAqIG1lbW9yeSBsZWFrcyAoZS5nLiB3aGVuIHVzaW5nIElFKSBhbmQgdG8gZW5zdXJlIHRoYXQgbm8gc3B1cmlvdXMgZXJyb3IgaXNcbiAqIGVtaXR0ZWQuXG4gKi9cbmlmICh0eXBlb2YgZG9jdW1lbnQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgaWYgKHR5cGVvZiBhdHRhY2hFdmVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgYXR0YWNoRXZlbnQoXCJvbnVubG9hZFwiLCB1bmxvYWRIYW5kbGVyKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGFkZEV2ZW50TGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBjb25zdCB0ZXJtaW5hdGlvbkV2ZW50ID0gXCJvbnBhZ2VoaWRlXCIgaW4gZ2xvYmFsVGhpcyA/IFwicGFnZWhpZGVcIiA6IFwidW5sb2FkXCI7XG4gICAgICAgIGFkZEV2ZW50TGlzdGVuZXIodGVybWluYXRpb25FdmVudCwgdW5sb2FkSGFuZGxlciwgZmFsc2UpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVubG9hZEhhbmRsZXIoKSB7XG4gICAgZm9yIChsZXQgaSBpbiBSZXF1ZXN0LnJlcXVlc3RzKSB7XG4gICAgICAgIGlmIChSZXF1ZXN0LnJlcXVlc3RzLmhhc093blByb3BlcnR5KGkpKSB7XG4gICAgICAgICAgICBSZXF1ZXN0LnJlcXVlc3RzW2ldLmFib3J0KCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5jb25zdCBoYXNYSFIyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB4aHIgPSBuZXdSZXF1ZXN0KHtcbiAgICAgICAgeGRvbWFpbjogZmFsc2UsXG4gICAgfSk7XG4gICAgcmV0dXJuIHhociAmJiB4aHIucmVzcG9uc2VUeXBlICE9PSBudWxsO1xufSkoKTtcbi8qKlxuICogSFRUUCBsb25nLXBvbGxpbmcgYmFzZWQgb24gdGhlIGJ1aWx0LWluIGBYTUxIdHRwUmVxdWVzdGAgb2JqZWN0LlxuICpcbiAqIFVzYWdlOiBicm93c2VyXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvWE1MSHR0cFJlcXVlc3RcbiAqL1xuZXhwb3J0IGNsYXNzIFhIUiBleHRlbmRzIEJhc2VYSFIge1xuICAgIGNvbnN0cnVjdG9yKG9wdHMpIHtcbiAgICAgICAgc3VwZXIob3B0cyk7XG4gICAgICAgIGNvbnN0IGZvcmNlQmFzZTY0ID0gb3B0cyAmJiBvcHRzLmZvcmNlQmFzZTY0O1xuICAgICAgICB0aGlzLnN1cHBvcnRzQmluYXJ5ID0gaGFzWEhSMiAmJiAhZm9yY2VCYXNlNjQ7XG4gICAgfVxuICAgIHJlcXVlc3Qob3B0cyA9IHt9KSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24ob3B0cywgeyB4ZDogdGhpcy54ZCB9LCB0aGlzLm9wdHMpO1xuICAgICAgICByZXR1cm4gbmV3IFJlcXVlc3QobmV3UmVxdWVzdCwgdGhpcy51cmkoKSwgb3B0cyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbmV3UmVxdWVzdChvcHRzKSB7XG4gICAgY29uc3QgeGRvbWFpbiA9IG9wdHMueGRvbWFpbjtcbiAgICAvLyBYTUxIdHRwUmVxdWVzdCBjYW4gYmUgZGlzYWJsZWQgb24gSUVcbiAgICB0cnkge1xuICAgICAgICBpZiAoXCJ1bmRlZmluZWRcIiAhPT0gdHlwZW9mIFhNTEh0dHBSZXF1ZXN0ICYmICgheGRvbWFpbiB8fCBoYXNDT1JTKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlKSB7IH1cbiAgICBpZiAoIXhkb21haW4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgZ2xvYmFsVGhpc1tbXCJBY3RpdmVcIl0uY29uY2F0KFwiT2JqZWN0XCIpLmpvaW4oXCJYXCIpXShcIk1pY3Jvc29mdC5YTUxIVFRQXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js ***!
  \*****************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Polling: () => (/* binding */ Polling)\n/* harmony export */ });\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n\n\n\nclass Polling extends _transport_js__WEBPACK_IMPORTED_MODULE_0__.Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return "polling";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = "pausing";\n        const pause = () => {\n            this.readyState = "paused";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once("pollComplete", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once("drain", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved("poll");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if ("opening" === this.readyState && packet.type === "open") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if ("close" === packet.type) {\n                this.onClose({ description: "transport closed by the server" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.decodePayload)(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if ("closed" !== this.readyState) {\n            // if we got data we\'re not polling\n            this._polling = false;\n            this.emitReserved("pollComplete");\n            if ("open" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: "close" }]);\n        };\n        if ("open" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we\'re trying to close while\n            // handshaking is in progress (GH-164)\n            this.once("open", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.encodePayload)(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved("drain");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? "https" : "http";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.randomString)();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9wb2xsaW5nLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBNEM7QUFDRjtBQUNzQjtBQUN6RCxzQkFBc0Isb0RBQVM7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFVBQVU7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsK0NBQStDO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQWE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQWE7QUFDckI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHNEQUFZO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL3RyYW5zcG9ydHMvcG9sbGluZy5qcz9jZGFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRyYW5zcG9ydCB9IGZyb20gXCIuLi90cmFuc3BvcnQuanNcIjtcbmltcG9ydCB7IHJhbmRvbVN0cmluZyB9IGZyb20gXCIuLi91dGlsLmpzXCI7XG5pbXBvcnQgeyBlbmNvZGVQYXlsb2FkLCBkZWNvZGVQYXlsb2FkIH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmV4cG9ydCBjbGFzcyBQb2xsaW5nIGV4dGVuZHMgVHJhbnNwb3J0IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5fcG9sbGluZyA9IGZhbHNlO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwicG9sbGluZ1wiO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPcGVucyB0aGUgc29ja2V0ICh0cmlnZ2VycyBwb2xsaW5nKS4gV2Ugd3JpdGUgYSBQSU5HIG1lc3NhZ2UgdG8gZGV0ZXJtaW5lXG4gICAgICogd2hlbiB0aGUgdHJhbnNwb3J0IGlzIG9wZW4uXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgZG9PcGVuKCkge1xuICAgICAgICB0aGlzLl9wb2xsKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhdXNlcyBwb2xsaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25QYXVzZSAtIGNhbGxiYWNrIHVwb24gYnVmZmVycyBhcmUgZmx1c2hlZCBhbmQgdHJhbnNwb3J0IGlzIHBhdXNlZFxuICAgICAqIEBwYWNrYWdlXG4gICAgICovXG4gICAgcGF1c2Uob25QYXVzZSkge1xuICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPSBcInBhdXNpbmdcIjtcbiAgICAgICAgY29uc3QgcGF1c2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPSBcInBhdXNlZFwiO1xuICAgICAgICAgICAgb25QYXVzZSgpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5fcG9sbGluZyB8fCAhdGhpcy53cml0YWJsZSkge1xuICAgICAgICAgICAgbGV0IHRvdGFsID0gMDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wb2xsaW5nKSB7XG4gICAgICAgICAgICAgICAgdG90YWwrKztcbiAgICAgICAgICAgICAgICB0aGlzLm9uY2UoXCJwb2xsQ29tcGxldGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAtLXRvdGFsIHx8IHBhdXNlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMud3JpdGFibGUpIHtcbiAgICAgICAgICAgICAgICB0b3RhbCsrO1xuICAgICAgICAgICAgICAgIHRoaXMub25jZShcImRyYWluXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLS10b3RhbCB8fCBwYXVzZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGF1c2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgcG9sbGluZyBjeWNsZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3BvbGwoKSB7XG4gICAgICAgIHRoaXMuX3BvbGxpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLmRvUG9sbCgpO1xuICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBvbGxcIik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE92ZXJsb2FkcyBvbkRhdGEgdG8gZGV0ZWN0IHBheWxvYWRzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIG9uRGF0YShkYXRhKSB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrID0gKHBhY2tldCkgPT4ge1xuICAgICAgICAgICAgLy8gaWYgaXRzIHRoZSBmaXJzdCBtZXNzYWdlIHdlIGNvbnNpZGVyIHRoZSB0cmFuc3BvcnQgb3BlblxuICAgICAgICAgICAgaWYgKFwib3BlbmluZ1wiID09PSB0aGlzLnJlYWR5U3RhdGUgJiYgcGFja2V0LnR5cGUgPT09IFwib3BlblwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIGl0cyBhIGNsb3NlIHBhY2tldCwgd2UgY2xvc2UgdGhlIG9uZ29pbmcgcmVxdWVzdHNcbiAgICAgICAgICAgIGlmIChcImNsb3NlXCIgPT09IHBhY2tldC50eXBlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNsb3NlKHsgZGVzY3JpcHRpb246IFwidHJhbnNwb3J0IGNsb3NlZCBieSB0aGUgc2VydmVyXCIgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGJ5cGFzcyBvbkRhdGEgYW5kIGhhbmRsZSB0aGUgbWVzc2FnZVxuICAgICAgICAgICAgdGhpcy5vblBhY2tldChwYWNrZXQpO1xuICAgICAgICB9O1xuICAgICAgICAvLyBkZWNvZGUgcGF5bG9hZFxuICAgICAgICBkZWNvZGVQYXlsb2FkKGRhdGEsIHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpLmZvckVhY2goY2FsbGJhY2spO1xuICAgICAgICAvLyBpZiBhbiBldmVudCBkaWQgbm90IHRyaWdnZXIgY2xvc2luZ1xuICAgICAgICBpZiAoXCJjbG9zZWRcIiAhPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICAvLyBpZiB3ZSBnb3QgZGF0YSB3ZSdyZSBub3QgcG9sbGluZ1xuICAgICAgICAgICAgdGhpcy5fcG9sbGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJwb2xsQ29tcGxldGVcIik7XG4gICAgICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BvbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBwb2xsaW5nLCBzZW5kIGEgY2xvc2UgcGFja2V0LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGRvQ2xvc2UoKSB7XG4gICAgICAgIGNvbnN0IGNsb3NlID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy53cml0ZShbeyB0eXBlOiBcImNsb3NlXCIgfV0pO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGluIGNhc2Ugd2UncmUgdHJ5aW5nIHRvIGNsb3NlIHdoaWxlXG4gICAgICAgICAgICAvLyBoYW5kc2hha2luZyBpcyBpbiBwcm9ncmVzcyAoR0gtMTY0KVxuICAgICAgICAgICAgdGhpcy5vbmNlKFwib3BlblwiLCBjbG9zZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JpdGVzIGEgcGFja2V0cyBwYXlsb2FkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gcGFja2V0cyAtIGRhdGEgcGFja2V0c1xuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICB3cml0ZShwYWNrZXRzKSB7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgZW5jb2RlUGF5bG9hZChwYWNrZXRzLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kb1dyaXRlKGRhdGEsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndyaXRhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImRyYWluXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZXMgdXJpIGZvciBjb25uZWN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB1cmkoKSB7XG4gICAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMub3B0cy5zZWN1cmUgPyBcImh0dHBzXCIgOiBcImh0dHBcIjtcbiAgICAgICAgY29uc3QgcXVlcnkgPSB0aGlzLnF1ZXJ5IHx8IHt9O1xuICAgICAgICAvLyBjYWNoZSBidXN0aW5nIGlzIGZvcmNlZFxuICAgICAgICBpZiAoZmFsc2UgIT09IHRoaXMub3B0cy50aW1lc3RhbXBSZXF1ZXN0cykge1xuICAgICAgICAgICAgcXVlcnlbdGhpcy5vcHRzLnRpbWVzdGFtcFBhcmFtXSA9IHJhbmRvbVN0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5zdXBwb3J0c0JpbmFyeSAmJiAhcXVlcnkuc2lkKSB7XG4gICAgICAgICAgICBxdWVyeS5iNjQgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVVyaShzY2hlbWEsIHF1ZXJ5KTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js ***!
  \*******************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseWS: () => (/* binding */ BaseWS),\n/* harmony export */   WS: () => (/* binding */ WS)\n/* harmony export */ });\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n\n\n\n\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== "undefined" &&\n    typeof navigator.product === "string" &&\n    navigator.product.toLowerCase() === "reactnative";\nclass BaseWS extends _transport_js__WEBPACK_IMPORTED_MODULE_0__.Transport {\n    get name() {\n        return "websocket";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the \'headers\' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.pick)(this.opts, "agent", "perMessageDeflate", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "localAddress", "protocolVersion", "origin", "maxPayload", "family", "checkServerIdentity");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved("error", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: "websocket connection closed",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError("websocket error", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.encodePacket)(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn\'t\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_3__.nextTick)(() => {\n                        this.writable = true;\n                        this.emitReserved("drain");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== "undefined") {\n            this.ws.onerror = () => { };\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? "wss" : "ws";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.randomString)();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim.WebSocket || _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nclass WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy93ZWJzb2NrZXQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTRDO0FBQ0k7QUFDQTtBQUM0QjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNPLHFCQUFxQixvREFBUztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDhDQUFJO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixvQkFBb0I7QUFDNUM7QUFDQTtBQUNBLFlBQVksOERBQVk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwREFBUTtBQUM1QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHNEQUFZO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsNERBQVUsY0FBYyw0REFBVTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy93ZWJzb2NrZXQuanM/YzQ2MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUcmFuc3BvcnQgfSBmcm9tIFwiLi4vdHJhbnNwb3J0LmpzXCI7XG5pbXBvcnQgeyBwaWNrLCByYW5kb21TdHJpbmcgfSBmcm9tIFwiLi4vdXRpbC5qc1wiO1xuaW1wb3J0IHsgZW5jb2RlUGFja2V0IH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmltcG9ydCB7IGdsb2JhbFRoaXNTaGltIGFzIGdsb2JhbFRoaXMsIG5leHRUaWNrIH0gZnJvbSBcIi4uL2dsb2JhbHMubm9kZS5qc1wiO1xuLy8gZGV0ZWN0IFJlYWN0TmF0aXZlIGVudmlyb25tZW50XG5jb25zdCBpc1JlYWN0TmF0aXZlID0gdHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgIHR5cGVvZiBuYXZpZ2F0b3IucHJvZHVjdCA9PT0gXCJzdHJpbmdcIiAmJlxuICAgIG5hdmlnYXRvci5wcm9kdWN0LnRvTG93ZXJDYXNlKCkgPT09IFwicmVhY3RuYXRpdmVcIjtcbmV4cG9ydCBjbGFzcyBCYXNlV1MgZXh0ZW5kcyBUcmFuc3BvcnQge1xuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJ3ZWJzb2NrZXRcIjtcbiAgICB9XG4gICAgZG9PcGVuKCkge1xuICAgICAgICBjb25zdCB1cmkgPSB0aGlzLnVyaSgpO1xuICAgICAgICBjb25zdCBwcm90b2NvbHMgPSB0aGlzLm9wdHMucHJvdG9jb2xzO1xuICAgICAgICAvLyBSZWFjdCBOYXRpdmUgb25seSBzdXBwb3J0cyB0aGUgJ2hlYWRlcnMnIG9wdGlvbiwgYW5kIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIGFueXRoaW5nIGVsc2UgaXMgcGFzc2VkXG4gICAgICAgIGNvbnN0IG9wdHMgPSBpc1JlYWN0TmF0aXZlXG4gICAgICAgICAgICA/IHt9XG4gICAgICAgICAgICA6IHBpY2sodGhpcy5vcHRzLCBcImFnZW50XCIsIFwicGVyTWVzc2FnZURlZmxhdGVcIiwgXCJwZnhcIiwgXCJrZXlcIiwgXCJwYXNzcGhyYXNlXCIsIFwiY2VydFwiLCBcImNhXCIsIFwiY2lwaGVyc1wiLCBcInJlamVjdFVuYXV0aG9yaXplZFwiLCBcImxvY2FsQWRkcmVzc1wiLCBcInByb3RvY29sVmVyc2lvblwiLCBcIm9yaWdpblwiLCBcIm1heFBheWxvYWRcIiwgXCJmYW1pbHlcIiwgXCJjaGVja1NlcnZlcklkZW50aXR5XCIpO1xuICAgICAgICBpZiAodGhpcy5vcHRzLmV4dHJhSGVhZGVycykge1xuICAgICAgICAgICAgb3B0cy5oZWFkZXJzID0gdGhpcy5vcHRzLmV4dHJhSGVhZGVycztcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy53cyA9IHRoaXMuY3JlYXRlU29ja2V0KHVyaSwgcHJvdG9jb2xzLCBvcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud3MuYmluYXJ5VHlwZSA9IHRoaXMuc29ja2V0LmJpbmFyeVR5cGU7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBldmVudCBsaXN0ZW5lcnMgdG8gdGhlIHNvY2tldFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBhZGRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy53cy5vbm9wZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRzLmF1dG9VbnJlZikge1xuICAgICAgICAgICAgICAgIHRoaXMud3MuX3NvY2tldC51bnJlZigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy53cy5vbmNsb3NlID0gKGNsb3NlRXZlbnQpID0+IHRoaXMub25DbG9zZSh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJ3ZWJzb2NrZXQgY29ubmVjdGlvbiBjbG9zZWRcIixcbiAgICAgICAgICAgIGNvbnRleHQ6IGNsb3NlRXZlbnQsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLndzLm9ubWVzc2FnZSA9IChldikgPT4gdGhpcy5vbkRhdGEoZXYuZGF0YSk7XG4gICAgICAgIHRoaXMud3Mub25lcnJvciA9IChlKSA9PiB0aGlzLm9uRXJyb3IoXCJ3ZWJzb2NrZXQgZXJyb3JcIiwgZSk7XG4gICAgfVxuICAgIHdyaXRlKHBhY2tldHMpIHtcbiAgICAgICAgdGhpcy53cml0YWJsZSA9IGZhbHNlO1xuICAgICAgICAvLyBlbmNvZGVQYWNrZXQgZWZmaWNpZW50IGFzIGl0IHVzZXMgV1MgZnJhbWluZ1xuICAgICAgICAvLyBubyBuZWVkIGZvciBlbmNvZGVQYXlsb2FkXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFja2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgcGFja2V0ID0gcGFja2V0c1tpXTtcbiAgICAgICAgICAgIGNvbnN0IGxhc3RQYWNrZXQgPSBpID09PSBwYWNrZXRzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBlbmNvZGVQYWNrZXQocGFja2V0LCB0aGlzLnN1cHBvcnRzQmluYXJ5LCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFNvbWV0aW1lcyB0aGUgd2Vic29ja2V0IGhhcyBhbHJlYWR5IGJlZW4gY2xvc2VkIGJ1dCB0aGUgYnJvd3NlciBkaWRuJ3RcbiAgICAgICAgICAgICAgICAvLyBoYXZlIGEgY2hhbmNlIG9mIGluZm9ybWluZyB1cyBhYm91dCBpdCB5ZXQsIGluIHRoYXQgY2FzZSBzZW5kIHdpbGxcbiAgICAgICAgICAgICAgICAvLyB0aHJvdyBhbiBlcnJvclxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG9Xcml0ZShwYWNrZXQsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobGFzdFBhY2tldCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBmYWtlIGRyYWluXG4gICAgICAgICAgICAgICAgICAgIC8vIGRlZmVyIHRvIG5leHQgdGljayB0byBhbGxvdyBTb2NrZXQgdG8gY2xlYXIgd3JpdGVCdWZmZXJcbiAgICAgICAgICAgICAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53cml0YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImRyYWluXCIpO1xuICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLnNldFRpbWVvdXRGbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZG9DbG9zZSgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLndzICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB0aGlzLndzLm9uZXJyb3IgPSAoKSA9PiB7IH07XG4gICAgICAgICAgICB0aGlzLndzLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLndzID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZXMgdXJpIGZvciBjb25uZWN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB1cmkoKSB7XG4gICAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMub3B0cy5zZWN1cmUgPyBcIndzc1wiIDogXCJ3c1wiO1xuICAgICAgICBjb25zdCBxdWVyeSA9IHRoaXMucXVlcnkgfHwge307XG4gICAgICAgIC8vIGFwcGVuZCB0aW1lc3RhbXAgdG8gVVJJXG4gICAgICAgIGlmICh0aGlzLm9wdHMudGltZXN0YW1wUmVxdWVzdHMpIHtcbiAgICAgICAgICAgIHF1ZXJ5W3RoaXMub3B0cy50aW1lc3RhbXBQYXJhbV0gPSByYW5kb21TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjb21tdW5pY2F0ZSBiaW5hcnkgc3VwcG9ydCBjYXBhYmlsaXRpZXNcbiAgICAgICAgaWYgKCF0aGlzLnN1cHBvcnRzQmluYXJ5KSB7XG4gICAgICAgICAgICBxdWVyeS5iNjQgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVVyaShzY2hlbWEsIHF1ZXJ5KTtcbiAgICB9XG59XG5jb25zdCBXZWJTb2NrZXRDdG9yID0gZ2xvYmFsVGhpcy5XZWJTb2NrZXQgfHwgZ2xvYmFsVGhpcy5Nb3pXZWJTb2NrZXQ7XG4vKipcbiAqIFdlYlNvY2tldCB0cmFuc3BvcnQgYmFzZWQgb24gdGhlIGJ1aWx0LWluIGBXZWJTb2NrZXRgIG9iamVjdC5cbiAqXG4gKiBVc2FnZTogYnJvd3NlciwgTm9kZS5qcyAoc2luY2UgdjIxKSwgRGVubywgQnVuXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViU29ja2V0XG4gKiBAc2VlIGh0dHBzOi8vY2FuaXVzZS5jb20vbWRuLWFwaV93ZWJzb2NrZXRcbiAqIEBzZWUgaHR0cHM6Ly9ub2RlanMub3JnL2FwaS9nbG9iYWxzLmh0bWwjd2Vic29ja2V0XG4gKi9cbmV4cG9ydCBjbGFzcyBXUyBleHRlbmRzIEJhc2VXUyB7XG4gICAgY3JlYXRlU29ja2V0KHVyaSwgcHJvdG9jb2xzLCBvcHRzKSB7XG4gICAgICAgIHJldHVybiAhaXNSZWFjdE5hdGl2ZVxuICAgICAgICAgICAgPyBwcm90b2NvbHNcbiAgICAgICAgICAgICAgICA/IG5ldyBXZWJTb2NrZXRDdG9yKHVyaSwgcHJvdG9jb2xzKVxuICAgICAgICAgICAgICAgIDogbmV3IFdlYlNvY2tldEN0b3IodXJpKVxuICAgICAgICAgICAgOiBuZXcgV2ViU29ja2V0Q3Rvcih1cmksIHByb3RvY29scywgb3B0cyk7XG4gICAgfVxuICAgIGRvV3JpdGUoX3BhY2tldCwgZGF0YSkge1xuICAgICAgICB0aGlzLndzLnNlbmQoZGF0YSk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js ***!
  \**********************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WT: () => (/* binding */ WT)\n/* harmony export */ });\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n\n\n\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nclass WT extends _transport_js__WEBPACK_IMPORTED_MODULE_0__.Transport {\n    get name() {\n        return "webtransport";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri("https"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved("error", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError("webtransport error", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.createPacketEncoderStream)();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: "open" };\n                if (this.query.sid) {\n                    packet.data = `{"sid":"${this.query.sid}"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_1__.nextTick)(() => {\n                        this.writable = true;\n                        this.emitReserved("drain");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy93ZWJ0cmFuc3BvcnQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE0QztBQUNFO0FBQzJDO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxpQkFBaUIsb0RBQVM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQywyRUFBeUI7QUFDL0Q7QUFDQSxzQ0FBc0MsMkVBQXlCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsYUFBYTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQSxvQ0FBb0MsU0FBUyxlQUFlLEVBQUU7QUFDOUQ7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLG9CQUFvQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwREFBUTtBQUM1QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL3RyYW5zcG9ydHMvd2VidHJhbnNwb3J0LmpzPzIzMzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHJhbnNwb3J0IH0gZnJvbSBcIi4uL3RyYW5zcG9ydC5qc1wiO1xuaW1wb3J0IHsgbmV4dFRpY2sgfSBmcm9tIFwiLi4vZ2xvYmFscy5ub2RlLmpzXCI7XG5pbXBvcnQgeyBjcmVhdGVQYWNrZXREZWNvZGVyU3RyZWFtLCBjcmVhdGVQYWNrZXRFbmNvZGVyU3RyZWFtLCB9IGZyb20gXCJlbmdpbmUuaW8tcGFyc2VyXCI7XG4vKipcbiAqIFdlYlRyYW5zcG9ydCB0cmFuc3BvcnQgYmFzZWQgb24gdGhlIGJ1aWx0LWluIGBXZWJUcmFuc3BvcnRgIG9iamVjdC5cbiAqXG4gKiBVc2FnZTogYnJvd3NlciwgTm9kZS5qcyAod2l0aCB0aGUgYEBmYWlscy1jb21wb25lbnRzL3dlYnRyYW5zcG9ydGAgcGFja2FnZSlcbiAqXG4gKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9XZWJUcmFuc3BvcnRcbiAqIEBzZWUgaHR0cHM6Ly9jYW5pdXNlLmNvbS93ZWJ0cmFuc3BvcnRcbiAqL1xuZXhwb3J0IGNsYXNzIFdUIGV4dGVuZHMgVHJhbnNwb3J0IHtcbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwid2VidHJhbnNwb3J0XCI7XG4gICAgfVxuICAgIGRvT3BlbigpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zcG9ydCA9IG5ldyBXZWJUcmFuc3BvcnQodGhpcy5jcmVhdGVVcmkoXCJodHRwc1wiKSwgdGhpcy5vcHRzLnRyYW5zcG9ydE9wdGlvbnNbdGhpcy5uYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1pdFJlc2VydmVkKFwiZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90cmFuc3BvcnQuY2xvc2VkXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uQ2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRXJyb3IoXCJ3ZWJ0cmFuc3BvcnQgZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIG5vdGU6IHdlIGNvdWxkIGhhdmUgdXNlZCBhc3luYy9hd2FpdCwgYnV0IHRoYXQgd291bGQgcmVxdWlyZSBzb21lIGFkZGl0aW9uYWwgcG9seWZpbGxzXG4gICAgICAgIHRoaXMuX3RyYW5zcG9ydC5yZWFkeS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zcG9ydC5jcmVhdGVCaWRpcmVjdGlvbmFsU3RyZWFtKCkudGhlbigoc3RyZWFtKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVjb2RlclN0cmVhbSA9IGNyZWF0ZVBhY2tldERlY29kZXJTdHJlYW0oTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsIHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IHN0cmVhbS5yZWFkYWJsZS5waXBlVGhyb3VnaChkZWNvZGVyU3RyZWFtKS5nZXRSZWFkZXIoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmNvZGVyU3RyZWFtID0gY3JlYXRlUGFja2V0RW5jb2RlclN0cmVhbSgpO1xuICAgICAgICAgICAgICAgIGVuY29kZXJTdHJlYW0ucmVhZGFibGUucGlwZVRvKHN0cmVhbS53cml0YWJsZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fd3JpdGVyID0gZW5jb2RlclN0cmVhbS53cml0YWJsZS5nZXRXcml0ZXIoKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZWFkID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZWFkKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCh7IGRvbmUsIHZhbHVlIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblBhY2tldCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJlYWQoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwYWNrZXQgPSB7IHR5cGU6IFwib3BlblwiIH07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucXVlcnkuc2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhY2tldC5kYXRhID0gYHtcInNpZFwiOlwiJHt0aGlzLnF1ZXJ5LnNpZH1cIn1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl93cml0ZXIud3JpdGUocGFja2V0KS50aGVuKCgpID0+IHRoaXMub25PcGVuKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB3cml0ZShwYWNrZXRzKSB7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYWNrZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBwYWNrZXQgPSBwYWNrZXRzW2ldO1xuICAgICAgICAgICAgY29uc3QgbGFzdFBhY2tldCA9IGkgPT09IHBhY2tldHMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHRoaXMuX3dyaXRlci53cml0ZShwYWNrZXQpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsYXN0UGFja2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud3JpdGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJkcmFpblwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcy5zZXRUaW1lb3V0Rm4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRvQ2xvc2UoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgKF9hID0gdGhpcy5fdHJhbnNwb3J0KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2xvc2UoKTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js ***!
  \***************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   byteLength: () => (/* binding */ byteLength),\n/* harmony export */   installTimerFunctions: () => (/* binding */ installTimerFunctions),\n/* harmony export */   pick: () => (/* binding */ pick),\n/* harmony export */   randomString: () => (/* binding */ randomString)\n/* harmony export */ });\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n\nfunction pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.clearTimeout;\nfunction installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n    }\n    else {\n        obj.setTimeoutFn = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.setTimeout.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n        obj.clearTimeoutFn = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.clearTimeout.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn\'t supported in IE9\nfunction byteLength(obj) {\n    if (typeof obj === "string") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nfunction randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdXRpbC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFpRTtBQUMxRDtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLElBQUk7QUFDVDtBQUNBO0FBQ0EsMkJBQTJCLDREQUFVO0FBQ3JDLDZCQUE2Qiw0REFBVTtBQUNoQztBQUNQO0FBQ0EsbURBQW1ELDREQUFVO0FBQzdELHVEQUF1RCw0REFBVTtBQUNqRTtBQUNBO0FBQ0EsMkJBQTJCLDREQUFVLGlCQUFpQiw0REFBVTtBQUNoRSw2QkFBNkIsNERBQVUsbUJBQW1CLDREQUFVO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsT0FBTztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdXRpbC5qcz82MmEyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdsb2JhbFRoaXNTaGltIGFzIGdsb2JhbFRoaXMgfSBmcm9tIFwiLi9nbG9iYWxzLm5vZGUuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiBwaWNrKG9iaiwgLi4uYXR0cikge1xuICAgIHJldHVybiBhdHRyLnJlZHVjZSgoYWNjLCBrKSA9PiB7XG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoaykpIHtcbiAgICAgICAgICAgIGFjY1trXSA9IG9ialtrXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcbn1cbi8vIEtlZXAgYSByZWZlcmVuY2UgdG8gdGhlIHJlYWwgdGltZW91dCBmdW5jdGlvbnMgc28gdGhleSBjYW4gYmUgdXNlZCB3aGVuIG92ZXJyaWRkZW5cbmNvbnN0IE5BVElWRV9TRVRfVElNRU9VVCA9IGdsb2JhbFRoaXMuc2V0VGltZW91dDtcbmNvbnN0IE5BVElWRV9DTEVBUl9USU1FT1VUID0gZ2xvYmFsVGhpcy5jbGVhclRpbWVvdXQ7XG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFRpbWVyRnVuY3Rpb25zKG9iaiwgb3B0cykge1xuICAgIGlmIChvcHRzLnVzZU5hdGl2ZVRpbWVycykge1xuICAgICAgICBvYmouc2V0VGltZW91dEZuID0gTkFUSVZFX1NFVF9USU1FT1VULmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgICAgIG9iai5jbGVhclRpbWVvdXRGbiA9IE5BVElWRV9DTEVBUl9USU1FT1VULmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBvYmouc2V0VGltZW91dEZuID0gZ2xvYmFsVGhpcy5zZXRUaW1lb3V0LmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgICAgIG9iai5jbGVhclRpbWVvdXRGbiA9IGdsb2JhbFRoaXMuY2xlYXJUaW1lb3V0LmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgfVxufVxuLy8gYmFzZTY0IGVuY29kZWQgYnVmZmVycyBhcmUgYWJvdXQgMzMlIGJpZ2dlciAoaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQmFzZTY0KVxuY29uc3QgQkFTRTY0X09WRVJIRUFEID0gMS4zMztcbi8vIHdlIGNvdWxkIGFsc28gaGF2ZSB1c2VkIGBuZXcgQmxvYihbb2JqXSkuc2l6ZWAsIGJ1dCBpdCBpc24ndCBzdXBwb3J0ZWQgaW4gSUU5XG5leHBvcnQgZnVuY3Rpb24gYnl0ZUxlbmd0aChvYmopIHtcbiAgICBpZiAodHlwZW9mIG9iaiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4gdXRmOExlbmd0aChvYmopO1xuICAgIH1cbiAgICAvLyBhcnJheWJ1ZmZlciBvciBibG9iXG4gICAgcmV0dXJuIE1hdGguY2VpbCgob2JqLmJ5dGVMZW5ndGggfHwgb2JqLnNpemUpICogQkFTRTY0X09WRVJIRUFEKTtcbn1cbmZ1bmN0aW9uIHV0ZjhMZW5ndGgoc3RyKSB7XG4gICAgbGV0IGMgPSAwLCBsZW5ndGggPSAwO1xuICAgIGZvciAobGV0IGkgPSAwLCBsID0gc3RyLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgIGlmIChjIDwgMHg4MCkge1xuICAgICAgICAgICAgbGVuZ3RoICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYyA8IDB4ODAwKSB7XG4gICAgICAgICAgICBsZW5ndGggKz0gMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjIDwgMHhkODAwIHx8IGMgPj0gMHhlMDAwKSB7XG4gICAgICAgICAgICBsZW5ndGggKz0gMztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIGxlbmd0aCArPSA0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBsZW5ndGg7XG59XG4vKipcbiAqIEdlbmVyYXRlcyBhIHJhbmRvbSA4LWNoYXJhY3RlcnMgc3RyaW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tU3RyaW5nKCkge1xuICAgIHJldHVybiAoRGF0ZS5ub3coKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDMpICtcbiAgICAgICAgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDUpKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js\n')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js ***!
  \******************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ERROR_PACKET: () => (/* binding */ ERROR_PACKET),\n/* harmony export */   PACKET_TYPES: () => (/* binding */ PACKET_TYPES),\n/* harmony export */   PACKET_TYPES_REVERSE: () => (/* binding */ PACKET_TYPES_REVERSE)\n/* harmony export */ });\nconst PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES["open"] = "0";\nPACKET_TYPES["close"] = "1";\nPACKET_TYPES["ping"] = "2";\nPACKET_TYPES["pong"] = "3";\nPACKET_TYPES["message"] = "4";\nPACKET_TYPES["upgrade"] = "5";\nPACKET_TYPES["noop"] = "6";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: "error", data: "parser error" };\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vY29tbW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsdUJBQXVCO0FBQ3FDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1wYXJzZXJANS4yLjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1wYXJzZXIvYnVpbGQvZXNtL2NvbW1vbnMuanM/ZmU0MyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBQQUNLRVRfVFlQRVMgPSBPYmplY3QuY3JlYXRlKG51bGwpOyAvLyBubyBNYXAgPSBubyBwb2x5ZmlsbFxuUEFDS0VUX1RZUEVTW1wib3BlblwiXSA9IFwiMFwiO1xuUEFDS0VUX1RZUEVTW1wiY2xvc2VcIl0gPSBcIjFcIjtcblBBQ0tFVF9UWVBFU1tcInBpbmdcIl0gPSBcIjJcIjtcblBBQ0tFVF9UWVBFU1tcInBvbmdcIl0gPSBcIjNcIjtcblBBQ0tFVF9UWVBFU1tcIm1lc3NhZ2VcIl0gPSBcIjRcIjtcblBBQ0tFVF9UWVBFU1tcInVwZ3JhZGVcIl0gPSBcIjVcIjtcblBBQ0tFVF9UWVBFU1tcIm5vb3BcIl0gPSBcIjZcIjtcbmNvbnN0IFBBQ0tFVF9UWVBFU19SRVZFUlNFID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbk9iamVjdC5rZXlzKFBBQ0tFVF9UWVBFUykuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgUEFDS0VUX1RZUEVTX1JFVkVSU0VbUEFDS0VUX1RZUEVTW2tleV1dID0ga2V5O1xufSk7XG5jb25zdCBFUlJPUl9QQUNLRVQgPSB7IHR5cGU6IFwiZXJyb3JcIiwgZGF0YTogXCJwYXJzZXIgZXJyb3JcIiB9O1xuZXhwb3J0IHsgUEFDS0VUX1RZUEVTLCBQQUNLRVRfVFlQRVNfUkVWRVJTRSwgRVJST1JfUEFDS0VUIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js\n')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js ***!
  \*************************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nconst encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nconst decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vY29udHJpYi9iYXNlNjQtYXJyYXlidWZmZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrQkFBa0I7QUFDbEM7QUFDQTtBQUNPO0FBQ1A7QUFDQSxnQkFBZ0IsU0FBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixTQUFTO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1wYXJzZXJANS4yLjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1wYXJzZXIvYnVpbGQvZXNtL2NvbnRyaWIvYmFzZTY0LWFycmF5YnVmZmVyLmpzPzRiNTgiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vc29ja2V0aW8vYmFzZTY0LWFycmF5YnVmZmVyXG5jb25zdCBjaGFycyA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJztcbi8vIFVzZSBhIGxvb2t1cCB0YWJsZSB0byBmaW5kIHRoZSBpbmRleC5cbmNvbnN0IGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAndW5kZWZpbmVkJyA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTtcbmZvciAobGV0IGkgPSAwOyBpIDwgY2hhcnMubGVuZ3RoOyBpKyspIHtcbiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpO1xufVxuZXhwb3J0IGNvbnN0IGVuY29kZSA9IChhcnJheWJ1ZmZlcikgPT4ge1xuICAgIGxldCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaSwgbGVuID0gYnl0ZXMubGVuZ3RoLCBiYXNlNjQgPSAnJztcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDMpIHtcbiAgICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2ldID4+IDJdO1xuICAgICAgICBiYXNlNjQgKz0gY2hhcnNbKChieXRlc1tpXSAmIDMpIDw8IDQpIHwgKGJ5dGVzW2kgKyAxXSA+PiA0KV07XG4gICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2kgKyAxXSAmIDE1KSA8PCAyKSB8IChieXRlc1tpICsgMl0gPj4gNildO1xuICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaSArIDJdICYgNjNdO1xuICAgIH1cbiAgICBpZiAobGVuICUgMyA9PT0gMikge1xuICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAxKSArICc9JztcbiAgICB9XG4gICAgZWxzZSBpZiAobGVuICUgMyA9PT0gMSkge1xuICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAyKSArICc9PSc7XG4gICAgfVxuICAgIHJldHVybiBiYXNlNjQ7XG59O1xuZXhwb3J0IGNvbnN0IGRlY29kZSA9IChiYXNlNjQpID0+IHtcbiAgICBsZXQgYnVmZmVyTGVuZ3RoID0gYmFzZTY0Lmxlbmd0aCAqIDAuNzUsIGxlbiA9IGJhc2U2NC5sZW5ndGgsIGksIHAgPSAwLCBlbmNvZGVkMSwgZW5jb2RlZDIsIGVuY29kZWQzLCBlbmNvZGVkNDtcbiAgICBpZiAoYmFzZTY0W2Jhc2U2NC5sZW5ndGggLSAxXSA9PT0gJz0nKSB7XG4gICAgICAgIGJ1ZmZlckxlbmd0aC0tO1xuICAgICAgICBpZiAoYmFzZTY0W2Jhc2U2NC5sZW5ndGggLSAyXSA9PT0gJz0nKSB7XG4gICAgICAgICAgICBidWZmZXJMZW5ndGgtLTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBhcnJheWJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihidWZmZXJMZW5ndGgpLCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpIHtcbiAgICAgICAgZW5jb2RlZDEgPSBsb29rdXBbYmFzZTY0LmNoYXJDb2RlQXQoaSldO1xuICAgICAgICBlbmNvZGVkMiA9IGxvb2t1cFtiYXNlNjQuY2hhckNvZGVBdChpICsgMSldO1xuICAgICAgICBlbmNvZGVkMyA9IGxvb2t1cFtiYXNlNjQuY2hhckNvZGVBdChpICsgMildO1xuICAgICAgICBlbmNvZGVkNCA9IGxvb2t1cFtiYXNlNjQuY2hhckNvZGVBdChpICsgMyldO1xuICAgICAgICBieXRlc1twKytdID0gKGVuY29kZWQxIDw8IDIpIHwgKGVuY29kZWQyID4+IDQpO1xuICAgICAgICBieXRlc1twKytdID0gKChlbmNvZGVkMiAmIDE1KSA8PCA0KSB8IChlbmNvZGVkMyA+PiAyKTtcbiAgICAgICAgYnl0ZXNbcCsrXSA9ICgoZW5jb2RlZDMgJiAzKSA8PCA2KSB8IChlbmNvZGVkNCAmIDYzKTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5YnVmZmVyO1xufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js\n")},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js ***!
  \*******************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decodePacket: () => (/* binding */ decodePacket)\n/* harmony export */ });\n/* harmony import */ var _commons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./commons.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js");\n/* harmony import */ var _contrib_base64_arraybuffer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./contrib/base64-arraybuffer.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js");\n\n\nconst withNativeArrayBuffer = typeof ArrayBuffer === "function";\nconst decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== "string") {\n        return {\n            type: "message",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === "b") {\n        return {\n            type: "message",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = _commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return _commons_js__WEBPACK_IMPORTED_MODULE_0__.ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: _commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: _commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = (0,_contrib_base64_arraybuffer_js__WEBPACK_IMPORTED_MODULE_1__.decode)(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case "blob":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType "blob"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case "arraybuffer":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType "arraybuffer"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vZGVjb2RlUGFja2V0LmJyb3dzZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW1FO0FBQ1Y7QUFDekQ7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDZEQUFvQjtBQUMzQztBQUNBLGVBQWUscURBQVk7QUFDM0I7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDZEQUFvQjtBQUN0QztBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNkRBQW9CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNFQUFNO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixzQkFBc0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vZGVjb2RlUGFja2V0LmJyb3dzZXIuanM/OTFiYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFUlJPUl9QQUNLRVQsIFBBQ0tFVF9UWVBFU19SRVZFUlNFLCB9IGZyb20gXCIuL2NvbW1vbnMuanNcIjtcbmltcG9ydCB7IGRlY29kZSB9IGZyb20gXCIuL2NvbnRyaWIvYmFzZTY0LWFycmF5YnVmZmVyLmpzXCI7XG5jb25zdCB3aXRoTmF0aXZlQXJyYXlCdWZmZXIgPSB0eXBlb2YgQXJyYXlCdWZmZXIgPT09IFwiZnVuY3Rpb25cIjtcbmV4cG9ydCBjb25zdCBkZWNvZGVQYWNrZXQgPSAoZW5jb2RlZFBhY2tldCwgYmluYXJ5VHlwZSkgPT4ge1xuICAgIGlmICh0eXBlb2YgZW5jb2RlZFBhY2tldCAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogXCJtZXNzYWdlXCIsXG4gICAgICAgICAgICBkYXRhOiBtYXBCaW5hcnkoZW5jb2RlZFBhY2tldCwgYmluYXJ5VHlwZSksXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IHR5cGUgPSBlbmNvZGVkUGFja2V0LmNoYXJBdCgwKTtcbiAgICBpZiAodHlwZSA9PT0gXCJiXCIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IFwibWVzc2FnZVwiLFxuICAgICAgICAgICAgZGF0YTogZGVjb2RlQmFzZTY0UGFja2V0KGVuY29kZWRQYWNrZXQuc3Vic3RyaW5nKDEpLCBiaW5hcnlUeXBlKSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgcGFja2V0VHlwZSA9IFBBQ0tFVF9UWVBFU19SRVZFUlNFW3R5cGVdO1xuICAgIGlmICghcGFja2V0VHlwZSkge1xuICAgICAgICByZXR1cm4gRVJST1JfUEFDS0VUO1xuICAgIH1cbiAgICByZXR1cm4gZW5jb2RlZFBhY2tldC5sZW5ndGggPiAxXG4gICAgICAgID8ge1xuICAgICAgICAgICAgdHlwZTogUEFDS0VUX1RZUEVTX1JFVkVSU0VbdHlwZV0sXG4gICAgICAgICAgICBkYXRhOiBlbmNvZGVkUGFja2V0LnN1YnN0cmluZygxKSxcbiAgICAgICAgfVxuICAgICAgICA6IHtcbiAgICAgICAgICAgIHR5cGU6IFBBQ0tFVF9UWVBFU19SRVZFUlNFW3R5cGVdLFxuICAgICAgICB9O1xufTtcbmNvbnN0IGRlY29kZUJhc2U2NFBhY2tldCA9IChkYXRhLCBiaW5hcnlUeXBlKSA9PiB7XG4gICAgaWYgKHdpdGhOYXRpdmVBcnJheUJ1ZmZlcikge1xuICAgICAgICBjb25zdCBkZWNvZGVkID0gZGVjb2RlKGRhdGEpO1xuICAgICAgICByZXR1cm4gbWFwQmluYXJ5KGRlY29kZWQsIGJpbmFyeVR5cGUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHsgYmFzZTY0OiB0cnVlLCBkYXRhIH07IC8vIGZhbGxiYWNrIGZvciBvbGQgYnJvd3NlcnNcbiAgICB9XG59O1xuY29uc3QgbWFwQmluYXJ5ID0gKGRhdGEsIGJpbmFyeVR5cGUpID0+IHtcbiAgICBzd2l0Y2ggKGJpbmFyeVR5cGUpIHtcbiAgICAgICAgY2FzZSBcImJsb2JcIjpcbiAgICAgICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQmxvYikge1xuICAgICAgICAgICAgICAgIC8vIGZyb20gV2ViU29ja2V0ICsgYmluYXJ5VHlwZSBcImJsb2JcIlxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZnJvbSBIVFRQIGxvbmctcG9sbGluZyBvciBXZWJUcmFuc3BvcnRcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEJsb2IoW2RhdGFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgY2FzZSBcImFycmF5YnVmZmVyXCI6XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgLy8gZnJvbSBIVFRQIGxvbmctcG9sbGluZyAoYmFzZTY0KSBvciBXZWJTb2NrZXQgKyBiaW5hcnlUeXBlIFwiYXJyYXlidWZmZXJcIlxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZnJvbSBXZWJUcmFuc3BvcnQgKFVpbnQ4QXJyYXkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuYnVmZmVyO1xuICAgICAgICAgICAgfVxuICAgIH1cbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js\n')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js ***!
  \*******************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   encodePacket: () => (/* binding */ encodePacket),\n/* harmony export */   encodePacketToBinary: () => (/* binding */ encodePacketToBinary)\n/* harmony export */ });\n/* harmony import */ var _commons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./commons.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js");\n\nconst withNativeBlob = typeof Blob === "function" ||\n    (typeof Blob !== "undefined" &&\n        Object.prototype.toString.call(Blob) === "[object BlobConstructor]");\nconst withNativeArrayBuffer = typeof ArrayBuffer === "function";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === "function"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(_commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES[type] + (data || ""));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(",")[1];\n        callback("b" + (content || ""));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nfunction encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vZW5jb2RlUGFja2V0LmJyb3dzZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFlBQVk7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHFEQUFZO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3dCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1wYXJzZXJANS4yLjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1wYXJzZXIvYnVpbGQvZXNtL2VuY29kZVBhY2tldC5icm93c2VyLmpzP2UzNzAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUEFDS0VUX1RZUEVTIH0gZnJvbSBcIi4vY29tbW9ucy5qc1wiO1xuY29uc3Qgd2l0aE5hdGl2ZUJsb2IgPSB0eXBlb2YgQmxvYiA9PT0gXCJmdW5jdGlvblwiIHx8XG4gICAgKHR5cGVvZiBCbG9iICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgICAgIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChCbG9iKSA9PT0gXCJbb2JqZWN0IEJsb2JDb25zdHJ1Y3Rvcl1cIik7XG5jb25zdCB3aXRoTmF0aXZlQXJyYXlCdWZmZXIgPSB0eXBlb2YgQXJyYXlCdWZmZXIgPT09IFwiZnVuY3Rpb25cIjtcbi8vIEFycmF5QnVmZmVyLmlzVmlldyBtZXRob2QgaXMgbm90IGRlZmluZWQgaW4gSUUxMFxuY29uc3QgaXNWaWV3ID0gKG9iaikgPT4ge1xuICAgIHJldHVybiB0eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3ID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgPyBBcnJheUJ1ZmZlci5pc1ZpZXcob2JqKVxuICAgICAgICA6IG9iaiAmJiBvYmouYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI7XG59O1xuY29uc3QgZW5jb2RlUGFja2V0ID0gKHsgdHlwZSwgZGF0YSB9LCBzdXBwb3J0c0JpbmFyeSwgY2FsbGJhY2spID0+IHtcbiAgICBpZiAod2l0aE5hdGl2ZUJsb2IgJiYgZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHtcbiAgICAgICAgaWYgKHN1cHBvcnRzQmluYXJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZW5jb2RlQmxvYkFzQmFzZTY0KGRhdGEsIGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmICh3aXRoTmF0aXZlQXJyYXlCdWZmZXIgJiZcbiAgICAgICAgKGRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciB8fCBpc1ZpZXcoZGF0YSkpKSB7XG4gICAgICAgIGlmIChzdXBwb3J0c0JpbmFyeSkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGVuY29kZUJsb2JBc0Jhc2U2NChuZXcgQmxvYihbZGF0YV0pLCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gcGxhaW4gc3RyaW5nXG4gICAgcmV0dXJuIGNhbGxiYWNrKFBBQ0tFVF9UWVBFU1t0eXBlXSArIChkYXRhIHx8IFwiXCIpKTtcbn07XG5jb25zdCBlbmNvZGVCbG9iQXNCYXNlNjQgPSAoZGF0YSwgY2FsbGJhY2spID0+IHtcbiAgICBjb25zdCBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGZpbGVSZWFkZXIucmVzdWx0LnNwbGl0KFwiLFwiKVsxXTtcbiAgICAgICAgY2FsbGJhY2soXCJiXCIgKyAoY29udGVudCB8fCBcIlwiKSk7XG4gICAgfTtcbiAgICByZXR1cm4gZmlsZVJlYWRlci5yZWFkQXNEYXRhVVJMKGRhdGEpO1xufTtcbmZ1bmN0aW9uIHRvQXJyYXkoZGF0YSkge1xuICAgIGlmIChkYXRhIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShkYXRhKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShkYXRhLmJ1ZmZlciwgZGF0YS5ieXRlT2Zmc2V0LCBkYXRhLmJ5dGVMZW5ndGgpO1xuICAgIH1cbn1cbmxldCBURVhUX0VOQ09ERVI7XG5leHBvcnQgZnVuY3Rpb24gZW5jb2RlUGFja2V0VG9CaW5hcnkocGFja2V0LCBjYWxsYmFjaykge1xuICAgIGlmICh3aXRoTmF0aXZlQmxvYiAmJiBwYWNrZXQuZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHtcbiAgICAgICAgcmV0dXJuIHBhY2tldC5kYXRhLmFycmF5QnVmZmVyKCkudGhlbih0b0FycmF5KS50aGVuKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgZWxzZSBpZiAod2l0aE5hdGl2ZUFycmF5QnVmZmVyICYmXG4gICAgICAgIChwYWNrZXQuZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyIHx8IGlzVmlldyhwYWNrZXQuZGF0YSkpKSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayh0b0FycmF5KHBhY2tldC5kYXRhKSk7XG4gICAgfVxuICAgIGVuY29kZVBhY2tldChwYWNrZXQsIGZhbHNlLCAoZW5jb2RlZCkgPT4ge1xuICAgICAgICBpZiAoIVRFWFRfRU5DT0RFUikge1xuICAgICAgICAgICAgVEVYVF9FTkNPREVSID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2soVEVYVF9FTkNPREVSLmVuY29kZShlbmNvZGVkKSk7XG4gICAgfSk7XG59XG5leHBvcnQgeyBlbmNvZGVQYWNrZXQgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js\n')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createPacketDecoderStream: () => (/* binding */ createPacketDecoderStream),\n/* harmony export */   createPacketEncoderStream: () => (/* binding */ createPacketEncoderStream),\n/* harmony export */   decodePacket: () => (/* reexport safe */ _decodePacket_js__WEBPACK_IMPORTED_MODULE_1__.decodePacket),\n/* harmony export */   decodePayload: () => (/* binding */ decodePayload),\n/* harmony export */   encodePacket: () => (/* reexport safe */ _encodePacket_js__WEBPACK_IMPORTED_MODULE_0__.encodePacket),\n/* harmony export */   encodePayload: () => (/* binding */ encodePayload),\n/* harmony export */   protocol: () => (/* binding */ protocol)\n/* harmony export */ });\n/* harmony import */ var _encodePacket_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./encodePacket.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js");\n/* harmony import */ var _decodePacket_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./decodePacket.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js");\n/* harmony import */ var _commons_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./commons.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js");\n\n\n\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        (0,_encodePacket_js__WEBPACK_IMPORTED_MODULE_0__.encodePacket)(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = (0,_decodePacket_js__WEBPACK_IMPORTED_MODULE_1__.decodePacket)(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === "error") {\n            break;\n        }\n    }\n    return packets;\n};\nfunction createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            (0,_encodePacket_js__WEBPACK_IMPORTED_MODULE_0__.encodePacketToBinary)(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== "string") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nfunction createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(_commons_js__WEBPACK_IMPORTED_MODULE_2__.ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue((0,_decodePacket_js__WEBPACK_IMPORTED_MODULE_1__.decodePacket)(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(_commons_js__WEBPACK_IMPORTED_MODULE_2__.ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nconst protocol = 4;\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUF1RTtBQUN0QjtBQUNKO0FBQzdDLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsOERBQVk7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDJCQUEyQjtBQUMvQyw4QkFBOEIsOERBQVk7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQSxZQUFZLHNFQUFvQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsVUFBVTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMscURBQVk7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsOERBQVk7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHFEQUFZO0FBQ25EO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDTztBQUM4RCIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tcGFyc2VyQDUuMi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tcGFyc2VyL2J1aWxkL2VzbS9pbmRleC5qcz8zN2ZlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGVuY29kZVBhY2tldCwgZW5jb2RlUGFja2V0VG9CaW5hcnkgfSBmcm9tIFwiLi9lbmNvZGVQYWNrZXQuanNcIjtcbmltcG9ydCB7IGRlY29kZVBhY2tldCB9IGZyb20gXCIuL2RlY29kZVBhY2tldC5qc1wiO1xuaW1wb3J0IHsgRVJST1JfUEFDS0VULCB9IGZyb20gXCIuL2NvbW1vbnMuanNcIjtcbmNvbnN0IFNFUEFSQVRPUiA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMzApOyAvLyBzZWUgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRGVsaW1pdGVyI0FTQ0lJX2RlbGltaXRlZF90ZXh0XG5jb25zdCBlbmNvZGVQYXlsb2FkID0gKHBhY2tldHMsIGNhbGxiYWNrKSA9PiB7XG4gICAgLy8gc29tZSBwYWNrZXRzIG1heSBiZSBhZGRlZCB0byB0aGUgYXJyYXkgd2hpbGUgZW5jb2RpbmcsIHNvIHRoZSBpbml0aWFsIGxlbmd0aCBtdXN0IGJlIHNhdmVkXG4gICAgY29uc3QgbGVuZ3RoID0gcGFja2V0cy5sZW5ndGg7XG4gICAgY29uc3QgZW5jb2RlZFBhY2tldHMgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgICBsZXQgY291bnQgPSAwO1xuICAgIHBhY2tldHMuZm9yRWFjaCgocGFja2V0LCBpKSA9PiB7XG4gICAgICAgIC8vIGZvcmNlIGJhc2U2NCBlbmNvZGluZyBmb3IgYmluYXJ5IHBhY2tldHNcbiAgICAgICAgZW5jb2RlUGFja2V0KHBhY2tldCwgZmFsc2UsIChlbmNvZGVkUGFja2V0KSA9PiB7XG4gICAgICAgICAgICBlbmNvZGVkUGFja2V0c1tpXSA9IGVuY29kZWRQYWNrZXQ7XG4gICAgICAgICAgICBpZiAoKytjb3VudCA9PT0gbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZW5jb2RlZFBhY2tldHMuam9pbihTRVBBUkFUT1IpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuY29uc3QgZGVjb2RlUGF5bG9hZCA9IChlbmNvZGVkUGF5bG9hZCwgYmluYXJ5VHlwZSkgPT4ge1xuICAgIGNvbnN0IGVuY29kZWRQYWNrZXRzID0gZW5jb2RlZFBheWxvYWQuc3BsaXQoU0VQQVJBVE9SKTtcbiAgICBjb25zdCBwYWNrZXRzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbmNvZGVkUGFja2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBkZWNvZGVkUGFja2V0ID0gZGVjb2RlUGFja2V0KGVuY29kZWRQYWNrZXRzW2ldLCBiaW5hcnlUeXBlKTtcbiAgICAgICAgcGFja2V0cy5wdXNoKGRlY29kZWRQYWNrZXQpO1xuICAgICAgICBpZiAoZGVjb2RlZFBhY2tldC50eXBlID09PSBcImVycm9yXCIpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwYWNrZXRzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYWNrZXRFbmNvZGVyU3RyZWFtKCkge1xuICAgIHJldHVybiBuZXcgVHJhbnNmb3JtU3RyZWFtKHtcbiAgICAgICAgdHJhbnNmb3JtKHBhY2tldCwgY29udHJvbGxlcikge1xuICAgICAgICAgICAgZW5jb2RlUGFja2V0VG9CaW5hcnkocGFja2V0LCAoZW5jb2RlZFBhY2tldCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBheWxvYWRMZW5ndGggPSBlbmNvZGVkUGFja2V0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsZXQgaGVhZGVyO1xuICAgICAgICAgICAgICAgIC8vIGluc3BpcmVkIGJ5IHRoZSBXZWJTb2NrZXQgZm9ybWF0OiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViU29ja2V0c19BUEkvV3JpdGluZ19XZWJTb2NrZXRfc2VydmVycyNkZWNvZGluZ19wYXlsb2FkX2xlbmd0aFxuICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkTGVuZ3RoIDwgMTI2KSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG5ldyBVaW50OEFycmF5KDEpO1xuICAgICAgICAgICAgICAgICAgICBuZXcgRGF0YVZpZXcoaGVhZGVyLmJ1ZmZlcikuc2V0VWludDgoMCwgcGF5bG9hZExlbmd0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBheWxvYWRMZW5ndGggPCA2NTUzNikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBuZXcgVWludDhBcnJheSgzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyhoZWFkZXIuYnVmZmVyKTtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5zZXRVaW50OCgwLCAxMjYpO1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnNldFVpbnQxNigxLCBwYXlsb2FkTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG5ldyBVaW50OEFycmF5KDkpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KGhlYWRlci5idWZmZXIpO1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnNldFVpbnQ4KDAsIDEyNyk7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcuc2V0QmlnVWludDY0KDEsIEJpZ0ludChwYXlsb2FkTGVuZ3RoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGZpcnN0IGJpdCBpbmRpY2F0ZXMgd2hldGhlciB0aGUgcGF5bG9hZCBpcyBwbGFpbiB0ZXh0ICgwKSBvciBiaW5hcnkgKDEpXG4gICAgICAgICAgICAgICAgaWYgKHBhY2tldC5kYXRhICYmIHR5cGVvZiBwYWNrZXQuZGF0YSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJbMF0gfD0gMHg4MDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGhlYWRlcik7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZWRQYWNrZXQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgfSk7XG59XG5sZXQgVEVYVF9ERUNPREVSO1xuZnVuY3Rpb24gdG90YWxMZW5ndGgoY2h1bmtzKSB7XG4gICAgcmV0dXJuIGNodW5rcy5yZWR1Y2UoKGFjYywgY2h1bmspID0+IGFjYyArIGNodW5rLmxlbmd0aCwgMCk7XG59XG5mdW5jdGlvbiBjb25jYXRDaHVua3MoY2h1bmtzLCBzaXplKSB7XG4gICAgaWYgKGNodW5rc1swXS5sZW5ndGggPT09IHNpemUpIHtcbiAgICAgICAgcmV0dXJuIGNodW5rcy5zaGlmdCgpO1xuICAgIH1cbiAgICBjb25zdCBidWZmZXIgPSBuZXcgVWludDhBcnJheShzaXplKTtcbiAgICBsZXQgaiA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgYnVmZmVyW2ldID0gY2h1bmtzWzBdW2orK107XG4gICAgICAgIGlmIChqID09PSBjaHVua3NbMF0ubGVuZ3RoKSB7XG4gICAgICAgICAgICBjaHVua3Muc2hpZnQoKTtcbiAgICAgICAgICAgIGogPSAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChjaHVua3MubGVuZ3RoICYmIGogPCBjaHVua3NbMF0ubGVuZ3RoKSB7XG4gICAgICAgIGNodW5rc1swXSA9IGNodW5rc1swXS5zbGljZShqKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1ZmZlcjtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYWNrZXREZWNvZGVyU3RyZWFtKG1heFBheWxvYWQsIGJpbmFyeVR5cGUpIHtcbiAgICBpZiAoIVRFWFRfREVDT0RFUikge1xuICAgICAgICBURVhUX0RFQ09ERVIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICB9XG4gICAgY29uc3QgY2h1bmtzID0gW107XG4gICAgbGV0IHN0YXRlID0gMCAvKiBTdGF0ZS5SRUFEX0hFQURFUiAqLztcbiAgICBsZXQgZXhwZWN0ZWRMZW5ndGggPSAtMTtcbiAgICBsZXQgaXNCaW5hcnkgPSBmYWxzZTtcbiAgICByZXR1cm4gbmV3IFRyYW5zZm9ybVN0cmVhbSh7XG4gICAgICAgIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcikge1xuICAgICAgICAgICAgY2h1bmtzLnB1c2goY2h1bmspO1xuICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUgPT09IDAgLyogU3RhdGUuUkVBRF9IRUFERVIgKi8pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsTGVuZ3RoKGNodW5rcykgPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBjb25jYXRDaHVua3MoY2h1bmtzLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgaXNCaW5hcnkgPSAoaGVhZGVyWzBdICYgMHg4MCkgPT09IDB4ODA7XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkTGVuZ3RoID0gaGVhZGVyWzBdICYgMHg3ZjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4cGVjdGVkTGVuZ3RoIDwgMTI2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IDMgLyogU3RhdGUuUkVBRF9QQVlMT0FEICovO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV4cGVjdGVkTGVuZ3RoID09PSAxMjYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMSAvKiBTdGF0ZS5SRUFEX0VYVEVOREVEX0xFTkdUSF8xNiAqLztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMiAvKiBTdGF0ZS5SRUFEX0VYVEVOREVEX0xFTkdUSF82NCAqLztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdGF0ZSA9PT0gMSAvKiBTdGF0ZS5SRUFEX0VYVEVOREVEX0xFTkdUSF8xNiAqLykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodG90YWxMZW5ndGgoY2h1bmtzKSA8IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlckFycmF5ID0gY29uY2F0Q2h1bmtzKGNodW5rcywgMik7XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkTGVuZ3RoID0gbmV3IERhdGFWaWV3KGhlYWRlckFycmF5LmJ1ZmZlciwgaGVhZGVyQXJyYXkuYnl0ZU9mZnNldCwgaGVhZGVyQXJyYXkubGVuZ3RoKS5nZXRVaW50MTYoMCk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMyAvKiBTdGF0ZS5SRUFEX1BBWUxPQUQgKi87XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN0YXRlID09PSAyIC8qIFN0YXRlLlJFQURfRVhURU5ERURfTEVOR1RIXzY0ICovKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbExlbmd0aChjaHVua3MpIDwgOCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyQXJyYXkgPSBjb25jYXRDaHVua3MoY2h1bmtzLCA4KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyhoZWFkZXJBcnJheS5idWZmZXIsIGhlYWRlckFycmF5LmJ5dGVPZmZzZXQsIGhlYWRlckFycmF5Lmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB2aWV3LmdldFVpbnQzMigwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4gPiBNYXRoLnBvdygyLCA1MyAtIDMyKSAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBtYXhpbXVtIHNhZmUgaW50ZWdlciBpbiBKYXZhU2NyaXB0IGlzIDJeNTMgLSAxXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoRVJST1JfUEFDS0VUKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkTGVuZ3RoID0gbiAqIE1hdGgucG93KDIsIDMyKSArIHZpZXcuZ2V0VWludDMyKDQpO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IDMgLyogU3RhdGUuUkVBRF9QQVlMT0FEICovO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsTGVuZ3RoKGNodW5rcykgPCBleHBlY3RlZExlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IGNvbmNhdENodW5rcyhjaHVua3MsIGV4cGVjdGVkTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGRlY29kZVBhY2tldChpc0JpbmFyeSA/IGRhdGEgOiBURVhUX0RFQ09ERVIuZGVjb2RlKGRhdGEpLCBiaW5hcnlUeXBlKSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMCAvKiBTdGF0ZS5SRUFEX0hFQURFUiAqLztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGV4cGVjdGVkTGVuZ3RoID09PSAwIHx8IGV4cGVjdGVkTGVuZ3RoID4gbWF4UGF5bG9hZCkge1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoRVJST1JfUEFDS0VUKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgIH0pO1xufVxuZXhwb3J0IGNvbnN0IHByb3RvY29sID0gNDtcbmV4cG9ydCB7IGVuY29kZVBhY2tldCwgZW5jb2RlUGF5bG9hZCwgZGVjb2RlUGFja2V0LCBkZWNvZGVQYXlsb2FkLCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js\n')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js ***!
  \*************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Backoff: () => (/* binding */ Backoff)\n/* harmony export */ });\n/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nfunction Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9iYWNrbzIuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkI7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9iYWNrbzIuanM/MDMyYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEluaXRpYWxpemUgYmFja29mZiB0aW1lciB3aXRoIGBvcHRzYC5cbiAqXG4gKiAtIGBtaW5gIGluaXRpYWwgdGltZW91dCBpbiBtaWxsaXNlY29uZHMgWzEwMF1cbiAqIC0gYG1heGAgbWF4IHRpbWVvdXQgWzEwMDAwXVxuICogLSBgaml0dGVyYCBbMF1cbiAqIC0gYGZhY3RvcmAgWzJdXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdHNcbiAqIEBhcGkgcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBCYWNrb2ZmKG9wdHMpIHtcbiAgICBvcHRzID0gb3B0cyB8fCB7fTtcbiAgICB0aGlzLm1zID0gb3B0cy5taW4gfHwgMTAwO1xuICAgIHRoaXMubWF4ID0gb3B0cy5tYXggfHwgMTAwMDA7XG4gICAgdGhpcy5mYWN0b3IgPSBvcHRzLmZhY3RvciB8fCAyO1xuICAgIHRoaXMuaml0dGVyID0gb3B0cy5qaXR0ZXIgPiAwICYmIG9wdHMuaml0dGVyIDw9IDEgPyBvcHRzLmppdHRlciA6IDA7XG4gICAgdGhpcy5hdHRlbXB0cyA9IDA7XG59XG4vKipcbiAqIFJldHVybiB0aGUgYmFja29mZiBkdXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJuIHtOdW1iZXJ9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5CYWNrb2ZmLnByb3RvdHlwZS5kdXJhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbXMgPSB0aGlzLm1zICogTWF0aC5wb3codGhpcy5mYWN0b3IsIHRoaXMuYXR0ZW1wdHMrKyk7XG4gICAgaWYgKHRoaXMuaml0dGVyKSB7XG4gICAgICAgIHZhciByYW5kID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgdmFyIGRldmlhdGlvbiA9IE1hdGguZmxvb3IocmFuZCAqIHRoaXMuaml0dGVyICogbXMpO1xuICAgICAgICBtcyA9IChNYXRoLmZsb29yKHJhbmQgKiAxMCkgJiAxKSA9PSAwID8gbXMgLSBkZXZpYXRpb24gOiBtcyArIGRldmlhdGlvbjtcbiAgICB9XG4gICAgcmV0dXJuIE1hdGgubWluKG1zLCB0aGlzLm1heCkgfCAwO1xufTtcbi8qKlxuICogUmVzZXQgdGhlIG51bWJlciBvZiBhdHRlbXB0cy5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5CYWNrb2ZmLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmF0dGVtcHRzID0gMDtcbn07XG4vKipcbiAqIFNldCB0aGUgbWluaW11bSBkdXJhdGlvblxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cbkJhY2tvZmYucHJvdG90eXBlLnNldE1pbiA9IGZ1bmN0aW9uIChtaW4pIHtcbiAgICB0aGlzLm1zID0gbWluO1xufTtcbi8qKlxuICogU2V0IHRoZSBtYXhpbXVtIGR1cmF0aW9uXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuQmFja29mZi5wcm90b3R5cGUuc2V0TWF4ID0gZnVuY3Rpb24gKG1heCkge1xuICAgIHRoaXMubWF4ID0gbWF4O1xufTtcbi8qKlxuICogU2V0IHRoZSBqaXR0ZXJcbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5CYWNrb2ZmLnByb3RvdHlwZS5zZXRKaXR0ZXIgPSBmdW5jdGlvbiAoaml0dGVyKSB7XG4gICAgdGhpcy5qaXR0ZXIgPSBqaXR0ZXI7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js\n")},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Fetch: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.Fetch),\n/* harmony export */   Manager: () => (/* reexport safe */ _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager),\n/* harmony export */   NodeWebSocket: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.NodeWebSocket),\n/* harmony export */   NodeXHR: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.NodeXHR),\n/* harmony export */   Socket: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_2__.Socket),\n/* harmony export */   WebSocket: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.WebSocket),\n/* harmony export */   WebTransport: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.WebTransport),\n/* harmony export */   XHR: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.XHR),\n/* harmony export */   connect: () => (/* binding */ lookup),\n/* harmony export */   "default": () => (/* binding */ lookup),\n/* harmony export */   io: () => (/* binding */ lookup),\n/* harmony export */   protocol: () => (/* reexport safe */ socket_io_parser__WEBPACK_IMPORTED_MODULE_3__.protocol)\n/* harmony export */ });\n/* harmony import */ var _url_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./url.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js");\n/* harmony import */ var _manager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./manager.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js");\n/* harmony import */ var _socket_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./socket.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js");\n/* harmony import */ var socket_io_parser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! socket.io-parser */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js");\n/* harmony import */ var engine_io_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! engine.io-client */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js");\n\n\n\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === "object") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = (0,_url_js__WEBPACK_IMPORTED_MODULE_0__.url)(uri, opts.path || "/socket.io");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id]["nsps"];\n    const newConnection = opts.forceNew ||\n        opts["force new connection"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that "lookup" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager: _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager,\n    Socket: _socket_js__WEBPACK_IMPORTED_MODULE_2__.Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\n\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0I7QUFDUTtBQUNGO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDRDQUFHO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGdEQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixnREFBTztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFVBQVU7QUFDVjtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNnRjtBQUNnQiIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9zb2NrZXQuaW8tY2xpZW50QDQuOC4xL25vZGVfbW9kdWxlcy9zb2NrZXQuaW8tY2xpZW50L2J1aWxkL2VzbS9pbmRleC5qcz8zODUxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVybCB9IGZyb20gXCIuL3VybC5qc1wiO1xuaW1wb3J0IHsgTWFuYWdlciB9IGZyb20gXCIuL21hbmFnZXIuanNcIjtcbmltcG9ydCB7IFNvY2tldCB9IGZyb20gXCIuL3NvY2tldC5qc1wiO1xuLyoqXG4gKiBNYW5hZ2VycyBjYWNoZS5cbiAqL1xuY29uc3QgY2FjaGUgPSB7fTtcbmZ1bmN0aW9uIGxvb2t1cCh1cmksIG9wdHMpIHtcbiAgICBpZiAodHlwZW9mIHVyaSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBvcHRzID0gdXJpO1xuICAgICAgICB1cmkgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xuICAgIGNvbnN0IHBhcnNlZCA9IHVybCh1cmksIG9wdHMucGF0aCB8fCBcIi9zb2NrZXQuaW9cIik7XG4gICAgY29uc3Qgc291cmNlID0gcGFyc2VkLnNvdXJjZTtcbiAgICBjb25zdCBpZCA9IHBhcnNlZC5pZDtcbiAgICBjb25zdCBwYXRoID0gcGFyc2VkLnBhdGg7XG4gICAgY29uc3Qgc2FtZU5hbWVzcGFjZSA9IGNhY2hlW2lkXSAmJiBwYXRoIGluIGNhY2hlW2lkXVtcIm5zcHNcIl07XG4gICAgY29uc3QgbmV3Q29ubmVjdGlvbiA9IG9wdHMuZm9yY2VOZXcgfHxcbiAgICAgICAgb3B0c1tcImZvcmNlIG5ldyBjb25uZWN0aW9uXCJdIHx8XG4gICAgICAgIGZhbHNlID09PSBvcHRzLm11bHRpcGxleCB8fFxuICAgICAgICBzYW1lTmFtZXNwYWNlO1xuICAgIGxldCBpbztcbiAgICBpZiAobmV3Q29ubmVjdGlvbikge1xuICAgICAgICBpbyA9IG5ldyBNYW5hZ2VyKHNvdXJjZSwgb3B0cyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoIWNhY2hlW2lkXSkge1xuICAgICAgICAgICAgY2FjaGVbaWRdID0gbmV3IE1hbmFnZXIoc291cmNlLCBvcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBpbyA9IGNhY2hlW2lkXTtcbiAgICB9XG4gICAgaWYgKHBhcnNlZC5xdWVyeSAmJiAhb3B0cy5xdWVyeSkge1xuICAgICAgICBvcHRzLnF1ZXJ5ID0gcGFyc2VkLnF1ZXJ5S2V5O1xuICAgIH1cbiAgICByZXR1cm4gaW8uc29ja2V0KHBhcnNlZC5wYXRoLCBvcHRzKTtcbn1cbi8vIHNvIHRoYXQgXCJsb29rdXBcIiBjYW4gYmUgdXNlZCBib3RoIGFzIGEgZnVuY3Rpb24gKGUuZy4gYGlvKC4uLilgKSBhbmQgYXMgYVxuLy8gbmFtZXNwYWNlIChlLmcuIGBpby5jb25uZWN0KC4uLilgKSwgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbk9iamVjdC5hc3NpZ24obG9va3VwLCB7XG4gICAgTWFuYWdlcixcbiAgICBTb2NrZXQsXG4gICAgaW86IGxvb2t1cCxcbiAgICBjb25uZWN0OiBsb29rdXAsXG59KTtcbi8qKlxuICogUHJvdG9jb2wgdmVyc2lvbi5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCB7IHByb3RvY29sIH0gZnJvbSBcInNvY2tldC5pby1wYXJzZXJcIjtcbi8qKlxuICogRXhwb3NlIGNvbnN0cnVjdG9ycyBmb3Igc3RhbmRhbG9uZSBidWlsZC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCB7IE1hbmFnZXIsIFNvY2tldCwgbG9va3VwIGFzIGlvLCBsb29rdXAgYXMgY29ubmVjdCwgbG9va3VwIGFzIGRlZmF1bHQsIH07XG5leHBvcnQgeyBGZXRjaCwgTm9kZVhIUiwgWEhSLCBOb2RlV2ViU29ja2V0LCBXZWJTb2NrZXQsIFdlYlRyYW5zcG9ydCwgfSBmcm9tIFwiZW5naW5lLmlvLWNsaWVudFwiO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js\n')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js ***!
  \******************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Manager: () => (/* binding */ Manager)\n/* harmony export */ });\n/* harmony import */ var engine_io_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! engine.io-client */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js");\n/* harmony import */ var _socket_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./socket.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js");\n/* harmony import */ var socket_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! socket.io-parser */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js");\n/* harmony import */ var _on_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./on.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js");\n/* harmony import */ var _contrib_backo2_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./contrib/backo2.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n\n\n\n\n\n\nclass Manager extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_5__.Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && "object" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || "/socket.io";\n        this.opts = opts;\n        (0,engine_io_client__WEBPACK_IMPORTED_MODULE_0__.installTimerFunctions)(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new _contrib_backo2_js__WEBPACK_IMPORTED_MODULE_4__.Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = "closed";\n        this.uri = uri;\n        const _parser = opts.parser || socket_io_parser__WEBPACK_IMPORTED_MODULE_2__;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        if (!v) {\n            this.skipReconnect = true;\n        }\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it\'s the first time we\'re connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf("open"))\n            return this;\n        this.engine = new engine_io_client__WEBPACK_IMPORTED_MODULE_0__.Socket(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = "opening";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "open", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = "closed";\n            this.emitReserved("error", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "error", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error("timeout"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = "open";\n        this.emitReserved("open");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push((0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "ping", this.onping.bind(this)), (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "data", this.ondata.bind(this)), (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "error", this.onerror.bind(this)), (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "close", this.onclose.bind(this)), \n        // @ts-ignore\n        (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(this.decoder, "decoded", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved("ping");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose("parse error", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a "parse error"\n        (0,engine_io_client__WEBPACK_IMPORTED_MODULE_0__.nextTick)(() => {\n            this.emitReserved("packet", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved("error", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new _socket_js__WEBPACK_IMPORTED_MODULE_1__.Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose("forced close");\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called when:\n     *\n     * - the low-level engine is closed\n     * - the parser encountered a badly formatted packet\n     * - all sockets are disconnected\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        var _a;\n        this.cleanup();\n        (_a = this.engine) === null || _a === void 0 ? void 0 : _a.close();\n        this.backoff.reset();\n        this._readyState = "closed";\n        this.emitReserved("close", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved("reconnect_failed");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved("reconnect_attempt", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved("reconnect_error", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved("reconnect", attempt);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vbWFuYWdlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXNGO0FBQ2pEO0FBQ007QUFDZDtBQUNpQjtBQUNVO0FBQ2pELHNCQUFzQixpRUFBTztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVFQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHVEQUFPO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsNkNBQU07QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxVQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixvREFBTTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDBDQUFFO0FBQ2pDO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsMENBQUU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsMENBQUUsMENBQTBDLDBDQUFFLDBDQUEwQywwQ0FBRSw0Q0FBNEMsMENBQUU7QUFDL0o7QUFDQSxRQUFRLDBDQUFFO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsMERBQVE7QUFDaEI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsOENBQU07QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMkJBQTJCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1jbGllbnRANC44LjEvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1jbGllbnQvYnVpbGQvZXNtL21hbmFnZXIuanM/NmNmZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTb2NrZXQgYXMgRW5naW5lLCBpbnN0YWxsVGltZXJGdW5jdGlvbnMsIG5leHRUaWNrLCB9IGZyb20gXCJlbmdpbmUuaW8tY2xpZW50XCI7XG5pbXBvcnQgeyBTb2NrZXQgfSBmcm9tIFwiLi9zb2NrZXQuanNcIjtcbmltcG9ydCAqIGFzIHBhcnNlciBmcm9tIFwic29ja2V0LmlvLXBhcnNlclwiO1xuaW1wb3J0IHsgb24gfSBmcm9tIFwiLi9vbi5qc1wiO1xuaW1wb3J0IHsgQmFja29mZiB9IGZyb20gXCIuL2NvbnRyaWIvYmFja28yLmpzXCI7XG5pbXBvcnQgeyBFbWl0dGVyLCB9IGZyb20gXCJAc29ja2V0LmlvL2NvbXBvbmVudC1lbWl0dGVyXCI7XG5leHBvcnQgY2xhc3MgTWFuYWdlciBleHRlbmRzIEVtaXR0ZXIge1xuICAgIGNvbnN0cnVjdG9yKHVyaSwgb3B0cykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMubnNwcyA9IHt9O1xuICAgICAgICB0aGlzLnN1YnMgPSBbXTtcbiAgICAgICAgaWYgKHVyaSAmJiBcIm9iamVjdFwiID09PSB0eXBlb2YgdXJpKSB7XG4gICAgICAgICAgICBvcHRzID0gdXJpO1xuICAgICAgICAgICAgdXJpID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xuICAgICAgICBvcHRzLnBhdGggPSBvcHRzLnBhdGggfHwgXCIvc29ja2V0LmlvXCI7XG4gICAgICAgIHRoaXMub3B0cyA9IG9wdHM7XG4gICAgICAgIGluc3RhbGxUaW1lckZ1bmN0aW9ucyh0aGlzLCBvcHRzKTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3Rpb24ob3B0cy5yZWNvbm5lY3Rpb24gIT09IGZhbHNlKTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3Rpb25BdHRlbXB0cyhvcHRzLnJlY29ubmVjdGlvbkF0dGVtcHRzIHx8IEluZmluaXR5KTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3Rpb25EZWxheShvcHRzLnJlY29ubmVjdGlvbkRlbGF5IHx8IDEwMDApO1xuICAgICAgICB0aGlzLnJlY29ubmVjdGlvbkRlbGF5TWF4KG9wdHMucmVjb25uZWN0aW9uRGVsYXlNYXggfHwgNTAwMCk7XG4gICAgICAgIHRoaXMucmFuZG9taXphdGlvbkZhY3RvcigoX2EgPSBvcHRzLnJhbmRvbWl6YXRpb25GYWN0b3IpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IDAuNSk7XG4gICAgICAgIHRoaXMuYmFja29mZiA9IG5ldyBCYWNrb2ZmKHtcbiAgICAgICAgICAgIG1pbjogdGhpcy5yZWNvbm5lY3Rpb25EZWxheSgpLFxuICAgICAgICAgICAgbWF4OiB0aGlzLnJlY29ubmVjdGlvbkRlbGF5TWF4KCksXG4gICAgICAgICAgICBqaXR0ZXI6IHRoaXMucmFuZG9taXphdGlvbkZhY3RvcigpLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50aW1lb3V0KG51bGwgPT0gb3B0cy50aW1lb3V0ID8gMjAwMDAgOiBvcHRzLnRpbWVvdXQpO1xuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgdGhpcy51cmkgPSB1cmk7XG4gICAgICAgIGNvbnN0IF9wYXJzZXIgPSBvcHRzLnBhcnNlciB8fCBwYXJzZXI7XG4gICAgICAgIHRoaXMuZW5jb2RlciA9IG5ldyBfcGFyc2VyLkVuY29kZXIoKTtcbiAgICAgICAgdGhpcy5kZWNvZGVyID0gbmV3IF9wYXJzZXIuRGVjb2RlcigpO1xuICAgICAgICB0aGlzLl9hdXRvQ29ubmVjdCA9IG9wdHMuYXV0b0Nvbm5lY3QgIT09IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5fYXV0b0Nvbm5lY3QpXG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICB9XG4gICAgcmVjb25uZWN0aW9uKHYpIHtcbiAgICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlY29ubmVjdGlvbjtcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW9uID0gISF2O1xuICAgICAgICBpZiAoIXYpIHtcbiAgICAgICAgICAgIHRoaXMuc2tpcFJlY29ubmVjdCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHJlY29ubmVjdGlvbkF0dGVtcHRzKHYpIHtcbiAgICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWNvbm5lY3Rpb25BdHRlbXB0cztcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW9uQXR0ZW1wdHMgPSB2O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmVjb25uZWN0aW9uRGVsYXkodikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh2ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXk7XG4gICAgICAgIHRoaXMuX3JlY29ubmVjdGlvbkRlbGF5ID0gdjtcbiAgICAgICAgKF9hID0gdGhpcy5iYWNrb2ZmKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0TWluKHYpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmFuZG9taXphdGlvbkZhY3Rvcih2KSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yYW5kb21pemF0aW9uRmFjdG9yO1xuICAgICAgICB0aGlzLl9yYW5kb21pemF0aW9uRmFjdG9yID0gdjtcbiAgICAgICAgKF9hID0gdGhpcy5iYWNrb2ZmKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0Sml0dGVyKHYpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmVjb25uZWN0aW9uRGVsYXlNYXgodikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh2ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXlNYXg7XG4gICAgICAgIHRoaXMuX3JlY29ubmVjdGlvbkRlbGF5TWF4ID0gdjtcbiAgICAgICAgKF9hID0gdGhpcy5iYWNrb2ZmKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0TWF4KHYpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdGltZW91dCh2KSB7XG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90aW1lb3V0O1xuICAgICAgICB0aGlzLl90aW1lb3V0ID0gdjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyB0cnlpbmcgdG8gcmVjb25uZWN0IGlmIHJlY29ubmVjdGlvbiBpcyBlbmFibGVkIGFuZCB3ZSBoYXZlIG5vdFxuICAgICAqIHN0YXJ0ZWQgcmVjb25uZWN0aW5nIHlldFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBtYXliZVJlY29ubmVjdE9uT3BlbigpIHtcbiAgICAgICAgLy8gT25seSB0cnkgdG8gcmVjb25uZWN0IGlmIGl0J3MgdGhlIGZpcnN0IHRpbWUgd2UncmUgY29ubmVjdGluZ1xuICAgICAgICBpZiAoIXRoaXMuX3JlY29ubmVjdGluZyAmJlxuICAgICAgICAgICAgdGhpcy5fcmVjb25uZWN0aW9uICYmXG4gICAgICAgICAgICB0aGlzLmJhY2tvZmYuYXR0ZW1wdHMgPT09IDApIHtcbiAgICAgICAgICAgIC8vIGtlZXBzIHJlY29ubmVjdGlvbiBmcm9tIGZpcmluZyB0d2ljZSBmb3IgdGhlIHNhbWUgcmVjb25uZWN0aW9uIGxvb3BcbiAgICAgICAgICAgIHRoaXMucmVjb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY3VycmVudCB0cmFuc3BvcnQgYHNvY2tldGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIG9wdGlvbmFsLCBjYWxsYmFja1xuICAgICAqIEByZXR1cm4gc2VsZlxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBvcGVuKGZuKSB7XG4gICAgICAgIGlmICh+dGhpcy5fcmVhZHlTdGF0ZS5pbmRleE9mKFwib3BlblwiKSlcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB0aGlzLmVuZ2luZSA9IG5ldyBFbmdpbmUodGhpcy51cmksIHRoaXMub3B0cyk7XG4gICAgICAgIGNvbnN0IHNvY2tldCA9IHRoaXMuZW5naW5lO1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5fcmVhZHlTdGF0ZSA9IFwib3BlbmluZ1wiO1xuICAgICAgICB0aGlzLnNraXBSZWNvbm5lY3QgPSBmYWxzZTtcbiAgICAgICAgLy8gZW1pdCBgb3BlbmBcbiAgICAgICAgY29uc3Qgb3BlblN1YkRlc3Ryb3kgPSBvbihzb2NrZXQsIFwib3BlblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLm9ub3BlbigpO1xuICAgICAgICAgICAgZm4gJiYgZm4oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG9uRXJyb3IgPSAoZXJyKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXAoKTtcbiAgICAgICAgICAgIHRoaXMuX3JlYWR5U3RhdGUgPSBcImNsb3NlZFwiO1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIpO1xuICAgICAgICAgICAgaWYgKGZuKSB7XG4gICAgICAgICAgICAgICAgZm4oZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgZG8gdGhpcyBpZiB0aGVyZSBpcyBubyBmbiB0byBoYW5kbGUgdGhlIGVycm9yXG4gICAgICAgICAgICAgICAgdGhpcy5tYXliZVJlY29ubmVjdE9uT3BlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBlbWl0IGBlcnJvcmBcbiAgICAgICAgY29uc3QgZXJyb3JTdWIgPSBvbihzb2NrZXQsIFwiZXJyb3JcIiwgb25FcnJvcik7XG4gICAgICAgIGlmIChmYWxzZSAhPT0gdGhpcy5fdGltZW91dCkge1xuICAgICAgICAgICAgY29uc3QgdGltZW91dCA9IHRoaXMuX3RpbWVvdXQ7XG4gICAgICAgICAgICAvLyBzZXQgdGltZXJcbiAgICAgICAgICAgIGNvbnN0IHRpbWVyID0gdGhpcy5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIG9wZW5TdWJEZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJ0aW1lb3V0XCIpKTtcbiAgICAgICAgICAgICAgICBzb2NrZXQuY2xvc2UoKTtcbiAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0cy5hdXRvVW5yZWYpIHtcbiAgICAgICAgICAgICAgICB0aW1lci51bnJlZigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdWJzLnB1c2goKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJUaW1lb3V0Rm4odGltZXIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdWJzLnB1c2gob3BlblN1YkRlc3Ryb3kpO1xuICAgICAgICB0aGlzLnN1YnMucHVzaChlcnJvclN1Yik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBbGlhcyBmb3Igb3BlbigpXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHNlbGZcbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY29ubmVjdChmbikge1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVuKGZuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gdHJhbnNwb3J0IG9wZW4uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9ub3BlbigpIHtcbiAgICAgICAgLy8gY2xlYXIgb2xkIHN1YnNcbiAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG4gICAgICAgIC8vIG1hcmsgYXMgb3BlblxuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gXCJvcGVuXCI7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwib3BlblwiKTtcbiAgICAgICAgLy8gYWRkIG5ldyBzdWJzXG4gICAgICAgIGNvbnN0IHNvY2tldCA9IHRoaXMuZW5naW5lO1xuICAgICAgICB0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsIFwicGluZ1wiLCB0aGlzLm9ucGluZy5iaW5kKHRoaXMpKSwgb24oc29ja2V0LCBcImRhdGFcIiwgdGhpcy5vbmRhdGEuYmluZCh0aGlzKSksIG9uKHNvY2tldCwgXCJlcnJvclwiLCB0aGlzLm9uZXJyb3IuYmluZCh0aGlzKSksIG9uKHNvY2tldCwgXCJjbG9zZVwiLCB0aGlzLm9uY2xvc2UuYmluZCh0aGlzKSksIFxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIG9uKHRoaXMuZGVjb2RlciwgXCJkZWNvZGVkXCIsIHRoaXMub25kZWNvZGVkLmJpbmQodGhpcykpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gYSBwaW5nLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbnBpbmcoKSB7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwicGluZ1wiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdpdGggZGF0YS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgb25kYXRhKGRhdGEpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuZGVjb2Rlci5hZGQoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRoaXMub25jbG9zZShcInBhcnNlIGVycm9yXCIsIGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHBhcnNlciBmdWxseSBkZWNvZGVzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmRlY29kZWQocGFja2V0KSB7XG4gICAgICAgIC8vIHRoZSBuZXh0VGljayBjYWxsIHByZXZlbnRzIGFuIGV4Y2VwdGlvbiBpbiBhIHVzZXItcHJvdmlkZWQgZXZlbnQgbGlzdGVuZXIgZnJvbSB0cmlnZ2VyaW5nIGEgZGlzY29ubmVjdGlvbiBkdWUgdG8gYSBcInBhcnNlIGVycm9yXCJcbiAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJwYWNrZXRcIiwgcGFja2V0KTtcbiAgICAgICAgfSwgdGhpcy5zZXRUaW1lb3V0Rm4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBzb2NrZXQgZXJyb3IuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uZXJyb3IoZXJyKSB7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwiZXJyb3JcIiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBzb2NrZXQgZm9yIHRoZSBnaXZlbiBgbnNwYC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1NvY2tldH1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgc29ja2V0KG5zcCwgb3B0cykge1xuICAgICAgICBsZXQgc29ja2V0ID0gdGhpcy5uc3BzW25zcF07XG4gICAgICAgIGlmICghc29ja2V0KSB7XG4gICAgICAgICAgICBzb2NrZXQgPSBuZXcgU29ja2V0KHRoaXMsIG5zcCwgb3B0cyk7XG4gICAgICAgICAgICB0aGlzLm5zcHNbbnNwXSA9IHNvY2tldDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9hdXRvQ29ubmVjdCAmJiAhc29ja2V0LmFjdGl2ZSkge1xuICAgICAgICAgICAgc29ja2V0LmNvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc29ja2V0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBhIHNvY2tldCBjbG9zZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzb2NrZXRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9kZXN0cm95KHNvY2tldCkge1xuICAgICAgICBjb25zdCBuc3BzID0gT2JqZWN0LmtleXModGhpcy5uc3BzKTtcbiAgICAgICAgZm9yIChjb25zdCBuc3Agb2YgbnNwcykge1xuICAgICAgICAgICAgY29uc3Qgc29ja2V0ID0gdGhpcy5uc3BzW25zcF07XG4gICAgICAgICAgICBpZiAoc29ja2V0LmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jbG9zZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBXcml0ZXMgYSBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFja2V0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfcGFja2V0KHBhY2tldCkge1xuICAgICAgICBjb25zdCBlbmNvZGVkUGFja2V0cyA9IHRoaXMuZW5jb2Rlci5lbmNvZGUocGFja2V0KTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbmNvZGVkUGFja2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5lbmdpbmUud3JpdGUoZW5jb2RlZFBhY2tldHNbaV0sIHBhY2tldC5vcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCB0cmFuc3BvcnQgc3Vic2NyaXB0aW9ucyBhbmQgcGFja2V0IGJ1ZmZlci5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgY2xlYW51cCgpIHtcbiAgICAgICAgdGhpcy5zdWJzLmZvckVhY2goKHN1YkRlc3Ryb3kpID0+IHN1YkRlc3Ryb3koKSk7XG4gICAgICAgIHRoaXMuc3Vicy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLmRlY29kZXIuZGVzdHJveSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZSB0aGUgY3VycmVudCBzb2NrZXQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jbG9zZSgpIHtcbiAgICAgICAgdGhpcy5za2lwUmVjb25uZWN0ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMub25jbG9zZShcImZvcmNlZCBjbG9zZVwiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWxpYXMgZm9yIGNsb3NlKClcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb3NlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuOlxuICAgICAqXG4gICAgICogLSB0aGUgbG93LWxldmVsIGVuZ2luZSBpcyBjbG9zZWRcbiAgICAgKiAtIHRoZSBwYXJzZXIgZW5jb3VudGVyZWQgYSBiYWRseSBmb3JtYXR0ZWQgcGFja2V0XG4gICAgICogLSBhbGwgc29ja2V0cyBhcmUgZGlzY29ubmVjdGVkXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uY2xvc2UocmVhc29uLCBkZXNjcmlwdGlvbikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMuY2xlYW51cCgpO1xuICAgICAgICAoX2EgPSB0aGlzLmVuZ2luZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjbG9zZVwiLCByZWFzb24sIGRlc2NyaXB0aW9uKTtcbiAgICAgICAgaWYgKHRoaXMuX3JlY29ubmVjdGlvbiAmJiAhdGhpcy5za2lwUmVjb25uZWN0KSB7XG4gICAgICAgICAgICB0aGlzLnJlY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEF0dGVtcHQgYSByZWNvbm5lY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHJlY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlY29ubmVjdGluZyB8fCB0aGlzLnNraXBSZWNvbm5lY3QpXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmJhY2tvZmYuYXR0ZW1wdHMgPj0gdGhpcy5fcmVjb25uZWN0aW9uQXR0ZW1wdHMpIHtcbiAgICAgICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJyZWNvbm5lY3RfZmFpbGVkXCIpO1xuICAgICAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMuYmFja29mZi5kdXJhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVyID0gdGhpcy5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLnNraXBSZWNvbm5lY3QpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInJlY29ubmVjdF9hdHRlbXB0XCIsIHNlbGYuYmFja29mZi5hdHRlbXB0cyk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgYWdhaW4gZm9yIHRoZSBjYXNlIHNvY2tldCBjbG9zZWQgaW4gYWJvdmUgZXZlbnRzXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuc2tpcFJlY29ubmVjdClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHNlbGYub3BlbigoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3JlY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWNvbm5lY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwicmVjb25uZWN0X2Vycm9yXCIsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm9ucmVjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdHMuYXV0b1VucmVmKSB7XG4gICAgICAgICAgICAgICAgdGltZXIudW5yZWYoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3Vicy5wdXNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyVGltZW91dEZuKHRpbWVyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHN1Y2Nlc3NmdWwgcmVjb25uZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbnJlY29ubmVjdCgpIHtcbiAgICAgICAgY29uc3QgYXR0ZW1wdCA9IHRoaXMuYmFja29mZi5hdHRlbXB0cztcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xuICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInJlY29ubmVjdFwiLCBhdHRlbXB0KTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js\n')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js ***!
  \*************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   on: () => (/* binding */ on)\n/* harmony export */ });\nfunction on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vb24uanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9zb2NrZXQuaW8tY2xpZW50QDQuOC4xL25vZGVfbW9kdWxlcy9zb2NrZXQuaW8tY2xpZW50L2J1aWxkL2VzbS9vbi5qcz9lMWY4Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBvbihvYmosIGV2LCBmbikge1xuICAgIG9iai5vbihldiwgZm4pO1xuICAgIHJldHVybiBmdW5jdGlvbiBzdWJEZXN0cm95KCkge1xuICAgICAgICBvYmoub2ZmKGV2LCBmbik7XG4gICAgfTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js\n")},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js ***!
  \*****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Socket: () => (/* binding */ Socket)\n/* harmony export */ });\n/* harmony import */ var socket_io_parser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! socket.io-parser */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js");\n/* harmony import */ var _on_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./on.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n\n\n\n/**\n * Internal events.\n * These events can\'t be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on("connect", () => {\n *   console.log("connected");\n * });\n *\n * // send an event to the server\n * socket.emit("foo", "bar");\n *\n * socket.on("foobar", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on("disconnect", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nclass Socket extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_2__.Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on("connect", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on("disconnect", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        /**\n         * A map containing acknowledgement handlers.\n         *\n         * The `withError` attribute is used to differentiate handlers that accept an error as first argument:\n         *\n         * - `socket.emit("test", (err, value) => { ... })` with `ackTimeout` option\n         * - `socket.timeout(5000).emit("test", (err, value) => { ... })`\n         * - `const value = await socket.emitWithAck("test")`\n         *\n         * From those that don\'t:\n         *\n         * - `socket.emit("test", (value) => { ... });`\n         *\n         * In the first case, the handlers will be called with an error when:\n         *\n         * - the timeout is reached\n         * - the socket gets disconnected\n         *\n         * In the second case, the handlers will be simply discarded upon disconnection, since the client will never receive\n         * an acknowledgement from the server.\n         *\n         * @private\n         */\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on("connect", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on("disconnect", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "open", this.onopen.bind(this)),\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "packet", this.onpacket.bind(this)),\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "error", this.onerror.bind(this)),\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "close", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on("disconnect", (reason) => {\n     *   if (reason === "io server disconnect") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * "Opens" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io["_reconnecting"])\n            this.io.open(); // ensure open\n        if ("open" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send("hello");\n     *\n     * // this is equivalent to\n     * socket.emit("message", "hello");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift("message");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it\'s emitted normally.\n     *\n     * @example\n     * socket.emit("hello", "world");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit("hello", 1, "2", { 3: ["4"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit("hello", "world", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        var _a, _b, _c;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error(\'"\' + ev.toString() + \'" is a reserved event name\');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if ("function" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = (_b = (_a = this.io.engine) === null || _a === void 0 ? void 0 : _a.transport) === null || _b === void 0 ? void 0 : _b.writable;\n        const isConnected = this.connected && !((_c = this.io.engine) === null || _c === void 0 ? void 0 : _c._hasPingExpired());\n        const discardPacket = this.flags.volatile && !isTransportWritable;\n        if (discardPacket) {\n        }\n        else if (isConnected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error("operation has timed out"));\n        }, timeout);\n        const fn = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, args);\n        };\n        fn.withError = true;\n        this.acks[id] = fn;\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck("hello", "world");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck("hello", "world");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        return new Promise((resolve, reject) => {\n            const fn = (arg1, arg2) => {\n                return arg1 ? reject(arg1) : resolve(arg2);\n            };\n            fn.withError = true;\n            args.push(fn);\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === "function") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == "function") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved("connect_error", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved("disconnect", reason, description);\n        this._clearAcks();\n    }\n    /**\n     * Clears the acknowledgement handlers upon disconnection, since the client will never receive an acknowledgement from\n     * the server.\n     *\n     * @private\n     */\n    _clearAcks() {\n        Object.keys(this.acks).forEach((id) => {\n            const isBuffered = this.sendBuffer.some((packet) => String(packet.id) === id);\n            if (!isBuffered) {\n                // note: handlers that do not accept an error as first argument are ignored here\n                const ack = this.acks[id];\n                delete this.acks[id];\n                if (ack.withError) {\n                    ack.call(this, new Error("socket has been disconnected"));\n                }\n            }\n        });\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved("connect_error", new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));\n                }\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.EVENT:\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.ACK:\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved("connect_error", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === "string") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowledgement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (typeof ack !== "function") {\n            return;\n        }\n        delete this.acks[packet.id];\n        // @ts-ignore FIXME ack is incorrectly inferred as \'never\'\n        if (ack.withError) {\n            packet.data.unshift(null);\n        }\n        // @ts-ignore\n        ack.apply(this, packet.data);\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved("connect");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose("io server disconnect");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don\'t get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io["_destroy"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on("disconnect", (reason) => {\n     *   // console.log(reason); prints "io client disconnect"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose("io client disconnect");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit("hello");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit("hello"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit("my-event", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vc29ja2V0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBOEM7QUFDakI7QUFDMkI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLGtGQUFrRixlQUFlO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLE9BQU87QUFDL0MsSUFBSTtBQUNKO0FBQ08scUJBQXFCLGlFQUFPO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QyxZQUFZO0FBQ1o7QUFDQTtBQUNBLDRDQUE0QztBQUM1QyxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxtQkFBbUI7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELEtBQUs7QUFDekQsa0VBQWtFLEtBQUs7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsS0FBSyxFQUFFO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQyxRQUFRO0FBQ1I7QUFDQTtBQUNBLDJDQUEyQztBQUMzQyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMENBQUU7QUFDZCxZQUFZLDBDQUFFO0FBQ2QsWUFBWSwwQ0FBRTtBQUNkLFlBQVksMENBQUU7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckMsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixnQkFBZ0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxtQ0FBbUM7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix3REFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNEJBQTRCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGlCQUFpQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0Isd0RBQVU7QUFDNUI7QUFDQSxrQ0FBa0MsMENBQTBDO0FBQzVFO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0IsaUJBQWlCLHdEQUFVO0FBQzNCO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0IsaUJBQWlCLHdEQUFVO0FBQzNCO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0I7QUFDQTtBQUNBLGlCQUFpQix3REFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBVTtBQUNoQztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCxjQUFjO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLE1BQU0sd0RBQVUsYUFBYTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtQkFBbUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLE1BQU07QUFDbEMsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsTUFBTTtBQUN4QyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsTUFBTTtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsc0JBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsTUFBTTtBQUN6QyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsTUFBTTtBQUN6QyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsTUFBTTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsc0JBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1jbGllbnRANC44LjEvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1jbGllbnQvYnVpbGQvZXNtL3NvY2tldC5qcz80MjFmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhY2tldFR5cGUgfSBmcm9tIFwic29ja2V0LmlvLXBhcnNlclwiO1xuaW1wb3J0IHsgb24gfSBmcm9tIFwiLi9vbi5qc1wiO1xuaW1wb3J0IHsgRW1pdHRlciwgfSBmcm9tIFwiQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlclwiO1xuLyoqXG4gKiBJbnRlcm5hbCBldmVudHMuXG4gKiBUaGVzZSBldmVudHMgY2FuJ3QgYmUgZW1pdHRlZCBieSB0aGUgdXNlci5cbiAqL1xuY29uc3QgUkVTRVJWRURfRVZFTlRTID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgY29ubmVjdDogMSxcbiAgICBjb25uZWN0X2Vycm9yOiAxLFxuICAgIGRpc2Nvbm5lY3Q6IDEsXG4gICAgZGlzY29ubmVjdGluZzogMSxcbiAgICAvLyBFdmVudEVtaXR0ZXIgcmVzZXJ2ZWQgZXZlbnRzOiBodHRwczovL25vZGVqcy5vcmcvYXBpL2V2ZW50cy5odG1sI2V2ZW50c19ldmVudF9uZXdsaXN0ZW5lclxuICAgIG5ld0xpc3RlbmVyOiAxLFxuICAgIHJlbW92ZUxpc3RlbmVyOiAxLFxufSk7XG4vKipcbiAqIEEgU29ja2V0IGlzIHRoZSBmdW5kYW1lbnRhbCBjbGFzcyBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgc2VydmVyLlxuICpcbiAqIEEgU29ja2V0IGJlbG9uZ3MgdG8gYSBjZXJ0YWluIE5hbWVzcGFjZSAoYnkgZGVmYXVsdCAvKSBhbmQgdXNlcyBhbiB1bmRlcmx5aW5nIHtAbGluayBNYW5hZ2VyfSB0byBjb21tdW5pY2F0ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3Qgc29ja2V0ID0gaW8oKTtcbiAqXG4gKiBzb2NrZXQub24oXCJjb25uZWN0XCIsICgpID0+IHtcbiAqICAgY29uc29sZS5sb2coXCJjb25uZWN0ZWRcIik7XG4gKiB9KTtcbiAqXG4gKiAvLyBzZW5kIGFuIGV2ZW50IHRvIHRoZSBzZXJ2ZXJcbiAqIHNvY2tldC5lbWl0KFwiZm9vXCIsIFwiYmFyXCIpO1xuICpcbiAqIHNvY2tldC5vbihcImZvb2JhclwiLCAoKSA9PiB7XG4gKiAgIC8vIGFuIGV2ZW50IHdhcyByZWNlaXZlZCBmcm9tIHRoZSBzZXJ2ZXJcbiAqIH0pO1xuICpcbiAqIC8vIHVwb24gZGlzY29ubmVjdGlvblxuICogc29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAocmVhc29uKSA9PiB7XG4gKiAgIGNvbnNvbGUubG9nKGBkaXNjb25uZWN0ZWQgZHVlIHRvICR7cmVhc29ufWApO1xuICogfSk7XG4gKi9cbmV4cG9ydCBjbGFzcyBTb2NrZXQgZXh0ZW5kcyBFbWl0dGVyIHtcbiAgICAvKipcbiAgICAgKiBgU29ja2V0YCBjb25zdHJ1Y3Rvci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihpbywgbnNwLCBvcHRzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIHRoZSBzb2NrZXQgaXMgY3VycmVudGx5IGNvbm5lY3RlZCB0byB0aGUgc2VydmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBjb25zdCBzb2NrZXQgPSBpbygpO1xuICAgICAgICAgKlxuICAgICAgICAgKiBzb2NrZXQub24oXCJjb25uZWN0XCIsICgpID0+IHtcbiAgICAgICAgICogICBjb25zb2xlLmxvZyhzb2NrZXQuY29ubmVjdGVkKTsgLy8gdHJ1ZVxuICAgICAgICAgKiB9KTtcbiAgICAgICAgICpcbiAgICAgICAgICogc29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAoKSA9PiB7XG4gICAgICAgICAqICAgY29uc29sZS5sb2coc29ja2V0LmNvbm5lY3RlZCk7IC8vIGZhbHNlXG4gICAgICAgICAqIH0pO1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgdGhlIGNvbm5lY3Rpb24gc3RhdGUgd2FzIHJlY292ZXJlZCBhZnRlciBhIHRlbXBvcmFyeSBkaXNjb25uZWN0aW9uLiBJbiB0aGF0IGNhc2UsIGFueSBtaXNzZWQgcGFja2V0cyB3aWxsXG4gICAgICAgICAqIGJlIHRyYW5zbWl0dGVkIGJ5IHRoZSBzZXJ2ZXIuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlY292ZXJlZCA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogQnVmZmVyIGZvciBwYWNrZXRzIHJlY2VpdmVkIGJlZm9yZSB0aGUgQ09OTkVDVCBwYWNrZXRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlciA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogQnVmZmVyIGZvciBwYWNrZXRzIHRoYXQgd2lsbCBiZSBzZW50IG9uY2UgdGhlIHNvY2tldCBpcyBjb25uZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VuZEJ1ZmZlciA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHF1ZXVlIG9mIHBhY2tldHMgdG8gYmUgc2VudCB3aXRoIHJldHJ5IGluIGNhc2Ugb2YgZmFpbHVyZS5cbiAgICAgICAgICpcbiAgICAgICAgICogUGFja2V0cyBhcmUgc2VudCBvbmUgYnkgb25lLCBlYWNoIHdhaXRpbmcgZm9yIHRoZSBzZXJ2ZXIgYWNrbm93bGVkZ2VtZW50LCBpbiBvcmRlciB0byBndWFyYW50ZWUgdGhlIGRlbGl2ZXJ5IG9yZGVyLlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcXVldWUgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgc2VxdWVuY2UgdG8gZ2VuZXJhdGUgdGhlIElEIG9mIHRoZSB7QGxpbmsgUXVldWVkUGFja2V0fS5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3F1ZXVlU2VxID0gMDtcbiAgICAgICAgdGhpcy5pZHMgPSAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogQSBtYXAgY29udGFpbmluZyBhY2tub3dsZWRnZW1lbnQgaGFuZGxlcnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZSBgd2l0aEVycm9yYCBhdHRyaWJ1dGUgaXMgdXNlZCB0byBkaWZmZXJlbnRpYXRlIGhhbmRsZXJzIHRoYXQgYWNjZXB0IGFuIGVycm9yIGFzIGZpcnN0IGFyZ3VtZW50OlxuICAgICAgICAgKlxuICAgICAgICAgKiAtIGBzb2NrZXQuZW1pdChcInRlc3RcIiwgKGVyciwgdmFsdWUpID0+IHsgLi4uIH0pYCB3aXRoIGBhY2tUaW1lb3V0YCBvcHRpb25cbiAgICAgICAgICogLSBgc29ja2V0LnRpbWVvdXQoNTAwMCkuZW1pdChcInRlc3RcIiwgKGVyciwgdmFsdWUpID0+IHsgLi4uIH0pYFxuICAgICAgICAgKiAtIGBjb25zdCB2YWx1ZSA9IGF3YWl0IHNvY2tldC5lbWl0V2l0aEFjayhcInRlc3RcIilgXG4gICAgICAgICAqXG4gICAgICAgICAqIEZyb20gdGhvc2UgdGhhdCBkb24ndDpcbiAgICAgICAgICpcbiAgICAgICAgICogLSBgc29ja2V0LmVtaXQoXCJ0ZXN0XCIsICh2YWx1ZSkgPT4geyAuLi4gfSk7YFxuICAgICAgICAgKlxuICAgICAgICAgKiBJbiB0aGUgZmlyc3QgY2FzZSwgdGhlIGhhbmRsZXJzIHdpbGwgYmUgY2FsbGVkIHdpdGggYW4gZXJyb3Igd2hlbjpcbiAgICAgICAgICpcbiAgICAgICAgICogLSB0aGUgdGltZW91dCBpcyByZWFjaGVkXG4gICAgICAgICAqIC0gdGhlIHNvY2tldCBnZXRzIGRpc2Nvbm5lY3RlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBJbiB0aGUgc2Vjb25kIGNhc2UsIHRoZSBoYW5kbGVycyB3aWxsIGJlIHNpbXBseSBkaXNjYXJkZWQgdXBvbiBkaXNjb25uZWN0aW9uLCBzaW5jZSB0aGUgY2xpZW50IHdpbGwgbmV2ZXIgcmVjZWl2ZVxuICAgICAgICAgKiBhbiBhY2tub3dsZWRnZW1lbnQgZnJvbSB0aGUgc2VydmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hY2tzID0ge307XG4gICAgICAgIHRoaXMuZmxhZ3MgPSB7fTtcbiAgICAgICAgdGhpcy5pbyA9IGlvO1xuICAgICAgICB0aGlzLm5zcCA9IG5zcDtcbiAgICAgICAgaWYgKG9wdHMgJiYgb3B0cy5hdXRoKSB7XG4gICAgICAgICAgICB0aGlzLmF1dGggPSBvcHRzLmF1dGg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fb3B0cyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdHMpO1xuICAgICAgICBpZiAodGhpcy5pby5fYXV0b0Nvbm5lY3QpXG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGUgc29ja2V0IGlzIGN1cnJlbnRseSBkaXNjb25uZWN0ZWRcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogY29uc3Qgc29ja2V0ID0gaW8oKTtcbiAgICAgKlxuICAgICAqIHNvY2tldC5vbihcImNvbm5lY3RcIiwgKCkgPT4ge1xuICAgICAqICAgY29uc29sZS5sb2coc29ja2V0LmRpc2Nvbm5lY3RlZCk7IC8vIGZhbHNlXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBzb2NrZXQub24oXCJkaXNjb25uZWN0XCIsICgpID0+IHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKHNvY2tldC5kaXNjb25uZWN0ZWQpOyAvLyB0cnVlXG4gICAgICogfSk7XG4gICAgICovXG4gICAgZ2V0IGRpc2Nvbm5lY3RlZCgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmNvbm5lY3RlZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlIHRvIG9wZW4sIGNsb3NlIGFuZCBwYWNrZXQgZXZlbnRzXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHN1YkV2ZW50cygpIHtcbiAgICAgICAgaWYgKHRoaXMuc3VicylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgaW8gPSB0aGlzLmlvO1xuICAgICAgICB0aGlzLnN1YnMgPSBbXG4gICAgICAgICAgICBvbihpbywgXCJvcGVuXCIsIHRoaXMub25vcGVuLmJpbmQodGhpcykpLFxuICAgICAgICAgICAgb24oaW8sIFwicGFja2V0XCIsIHRoaXMub25wYWNrZXQuYmluZCh0aGlzKSksXG4gICAgICAgICAgICBvbihpbywgXCJlcnJvclwiLCB0aGlzLm9uZXJyb3IuYmluZCh0aGlzKSksXG4gICAgICAgICAgICBvbihpbywgXCJjbG9zZVwiLCB0aGlzLm9uY2xvc2UuYmluZCh0aGlzKSksXG4gICAgICAgIF07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhlIFNvY2tldCB3aWxsIHRyeSB0byByZWNvbm5lY3Qgd2hlbiBpdHMgTWFuYWdlciBjb25uZWN0cyBvciByZWNvbm5lY3RzLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBjb25zdCBzb2NrZXQgPSBpbygpO1xuICAgICAqXG4gICAgICogY29uc29sZS5sb2coc29ja2V0LmFjdGl2ZSk7IC8vIHRydWVcbiAgICAgKlxuICAgICAqIHNvY2tldC5vbihcImRpc2Nvbm5lY3RcIiwgKHJlYXNvbikgPT4ge1xuICAgICAqICAgaWYgKHJlYXNvbiA9PT0gXCJpbyBzZXJ2ZXIgZGlzY29ubmVjdFwiKSB7XG4gICAgICogICAgIC8vIHRoZSBkaXNjb25uZWN0aW9uIHdhcyBpbml0aWF0ZWQgYnkgdGhlIHNlcnZlciwgeW91IG5lZWQgdG8gbWFudWFsbHkgcmVjb25uZWN0XG4gICAgICogICAgIGNvbnNvbGUubG9nKHNvY2tldC5hY3RpdmUpOyAvLyBmYWxzZVxuICAgICAqICAgfVxuICAgICAqICAgLy8gZWxzZSB0aGUgc29ja2V0IHdpbGwgYXV0b21hdGljYWxseSB0cnkgdG8gcmVjb25uZWN0XG4gICAgICogICBjb25zb2xlLmxvZyhzb2NrZXQuYWN0aXZlKTsgLy8gdHJ1ZVxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIGdldCBhY3RpdmUoKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuc3VicztcbiAgICB9XG4gICAgLyoqXG4gICAgICogXCJPcGVuc1wiIHRoZSBzb2NrZXQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IHNvY2tldCA9IGlvKHtcbiAgICAgKiAgIGF1dG9Db25uZWN0OiBmYWxzZVxuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogc29ja2V0LmNvbm5lY3QoKTtcbiAgICAgKi9cbiAgICBjb25uZWN0KCkge1xuICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWQpXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgdGhpcy5zdWJFdmVudHMoKTtcbiAgICAgICAgaWYgKCF0aGlzLmlvW1wiX3JlY29ubmVjdGluZ1wiXSlcbiAgICAgICAgICAgIHRoaXMuaW8ub3BlbigpOyAvLyBlbnN1cmUgb3BlblxuICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMuaW8uX3JlYWR5U3RhdGUpXG4gICAgICAgICAgICB0aGlzLm9ub3BlbigpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWxpYXMgZm9yIHtAbGluayBjb25uZWN0KCl9LlxuICAgICAqL1xuICAgIG9wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3QoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYSBgbWVzc2FnZWAgZXZlbnQuXG4gICAgICpcbiAgICAgKiBUaGlzIG1ldGhvZCBtaW1pY3MgdGhlIFdlYlNvY2tldC5zZW5kKCkgbWV0aG9kLlxuICAgICAqXG4gICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViU29ja2V0L3NlbmRcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0LnNlbmQoXCJoZWxsb1wiKTtcbiAgICAgKlxuICAgICAqIC8vIHRoaXMgaXMgZXF1aXZhbGVudCB0b1xuICAgICAqIHNvY2tldC5lbWl0KFwibWVzc2FnZVwiLCBcImhlbGxvXCIpO1xuICAgICAqXG4gICAgICogQHJldHVybiBzZWxmXG4gICAgICovXG4gICAgc2VuZCguLi5hcmdzKSB7XG4gICAgICAgIGFyZ3MudW5zaGlmdChcIm1lc3NhZ2VcIik7XG4gICAgICAgIHRoaXMuZW1pdC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE92ZXJyaWRlIGBlbWl0YC5cbiAgICAgKiBJZiB0aGUgZXZlbnQgaXMgaW4gYGV2ZW50c2AsIGl0J3MgZW1pdHRlZCBub3JtYWxseS5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0LmVtaXQoXCJoZWxsb1wiLCBcIndvcmxkXCIpO1xuICAgICAqXG4gICAgICogLy8gYWxsIHNlcmlhbGl6YWJsZSBkYXRhc3RydWN0dXJlcyBhcmUgc3VwcG9ydGVkIChubyBuZWVkIHRvIGNhbGwgSlNPTi5zdHJpbmdpZnkpXG4gICAgICogc29ja2V0LmVtaXQoXCJoZWxsb1wiLCAxLCBcIjJcIiwgeyAzOiBbXCI0XCJdLCA1OiBVaW50OEFycmF5LmZyb20oWzZdKSB9KTtcbiAgICAgKlxuICAgICAqIC8vIHdpdGggYW4gYWNrbm93bGVkZ2VtZW50IGZyb20gdGhlIHNlcnZlclxuICAgICAqIHNvY2tldC5lbWl0KFwiaGVsbG9cIiwgXCJ3b3JsZFwiLCAodmFsKSA9PiB7XG4gICAgICogICAvLyAuLi5cbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIEByZXR1cm4gc2VsZlxuICAgICAqL1xuICAgIGVtaXQoZXYsIC4uLmFyZ3MpIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgIGlmIChSRVNFUlZFRF9FVkVOVFMuaGFzT3duUHJvcGVydHkoZXYpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1wiJyArIGV2LnRvU3RyaW5nKCkgKyAnXCIgaXMgYSByZXNlcnZlZCBldmVudCBuYW1lJyk7XG4gICAgICAgIH1cbiAgICAgICAgYXJncy51bnNoaWZ0KGV2KTtcbiAgICAgICAgaWYgKHRoaXMuX29wdHMucmV0cmllcyAmJiAhdGhpcy5mbGFncy5mcm9tUXVldWUgJiYgIXRoaXMuZmxhZ3Mudm9sYXRpbGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2FkZFRvUXVldWUoYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYWNrZXQgPSB7XG4gICAgICAgICAgICB0eXBlOiBQYWNrZXRUeXBlLkVWRU5ULFxuICAgICAgICAgICAgZGF0YTogYXJncyxcbiAgICAgICAgfTtcbiAgICAgICAgcGFja2V0Lm9wdGlvbnMgPSB7fTtcbiAgICAgICAgcGFja2V0Lm9wdGlvbnMuY29tcHJlc3MgPSB0aGlzLmZsYWdzLmNvbXByZXNzICE9PSBmYWxzZTtcbiAgICAgICAgLy8gZXZlbnQgYWNrIGNhbGxiYWNrXG4gICAgICAgIGlmIChcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhcmdzW2FyZ3MubGVuZ3RoIC0gMV0pIHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gdGhpcy5pZHMrKztcbiAgICAgICAgICAgIGNvbnN0IGFjayA9IGFyZ3MucG9wKCk7XG4gICAgICAgICAgICB0aGlzLl9yZWdpc3RlckFja0NhbGxiYWNrKGlkLCBhY2spO1xuICAgICAgICAgICAgcGFja2V0LmlkID0gaWQ7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNUcmFuc3BvcnRXcml0YWJsZSA9IChfYiA9IChfYSA9IHRoaXMuaW8uZW5naW5lKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudHJhbnNwb3J0KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iud3JpdGFibGU7XG4gICAgICAgIGNvbnN0IGlzQ29ubmVjdGVkID0gdGhpcy5jb25uZWN0ZWQgJiYgISgoX2MgPSB0aGlzLmlvLmVuZ2luZSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLl9oYXNQaW5nRXhwaXJlZCgpKTtcbiAgICAgICAgY29uc3QgZGlzY2FyZFBhY2tldCA9IHRoaXMuZmxhZ3Mudm9sYXRpbGUgJiYgIWlzVHJhbnNwb3J0V3JpdGFibGU7XG4gICAgICAgIGlmIChkaXNjYXJkUGFja2V0KSB7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5T3V0Z29pbmdMaXN0ZW5lcnMocGFja2V0KTtcbiAgICAgICAgICAgIHRoaXMucGFja2V0KHBhY2tldCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRCdWZmZXIucHVzaChwYWNrZXQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmxhZ3MgPSB7fTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3JlZ2lzdGVyQWNrQ2FsbGJhY2soaWQsIGFjaykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IHRpbWVvdXQgPSAoX2EgPSB0aGlzLmZsYWdzLnRpbWVvdXQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHRoaXMuX29wdHMuYWNrVGltZW91dDtcbiAgICAgICAgaWYgKHRpbWVvdXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5hY2tzW2lkXSA9IGFjaztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IHRpbWVyID0gdGhpcy5pby5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuYWNrc1tpZF07XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2VuZEJ1ZmZlci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbmRCdWZmZXJbaV0uaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZEJ1ZmZlci5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWNrLmNhbGwodGhpcywgbmV3IEVycm9yKFwib3BlcmF0aW9uIGhhcyB0aW1lZCBvdXRcIikpO1xuICAgICAgICB9LCB0aW1lb3V0KTtcbiAgICAgICAgY29uc3QgZm4gPSAoLi4uYXJncykgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGhpcy5pby5jbGVhclRpbWVvdXRGbih0aW1lcik7XG4gICAgICAgICAgICBhY2suYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIGZuLndpdGhFcnJvciA9IHRydWU7XG4gICAgICAgIHRoaXMuYWNrc1tpZF0gPSBmbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW1pdHMgYW4gZXZlbnQgYW5kIHdhaXRzIGZvciBhbiBhY2tub3dsZWRnZW1lbnRcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gd2l0aG91dCB0aW1lb3V0XG4gICAgICogY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzb2NrZXQuZW1pdFdpdGhBY2soXCJoZWxsb1wiLCBcIndvcmxkXCIpO1xuICAgICAqXG4gICAgICogLy8gd2l0aCBhIHNwZWNpZmljIHRpbWVvdXRcbiAgICAgKiB0cnkge1xuICAgICAqICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzb2NrZXQudGltZW91dCgxMDAwKS5lbWl0V2l0aEFjayhcImhlbGxvXCIsIFwid29ybGRcIik7XG4gICAgICogfSBjYXRjaCAoZXJyKSB7XG4gICAgICogICAvLyB0aGUgc2VydmVyIGRpZCBub3QgYWNrbm93bGVkZ2UgdGhlIGV2ZW50IGluIHRoZSBnaXZlbiBkZWxheVxuICAgICAqIH1cbiAgICAgKlxuICAgICAqIEByZXR1cm4gYSBQcm9taXNlIHRoYXQgd2lsbCBiZSBmdWxmaWxsZWQgd2hlbiB0aGUgc2VydmVyIGFja25vd2xlZGdlcyB0aGUgZXZlbnRcbiAgICAgKi9cbiAgICBlbWl0V2l0aEFjayhldiwgLi4uYXJncykge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZm4gPSAoYXJnMSwgYXJnMikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcmcxID8gcmVqZWN0KGFyZzEpIDogcmVzb2x2ZShhcmcyKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmbi53aXRoRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgYXJncy5wdXNoKGZuKTtcbiAgICAgICAgICAgIHRoaXMuZW1pdChldiwgLi4uYXJncyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgdGhlIHBhY2tldCB0byB0aGUgcXVldWUuXG4gICAgICogQHBhcmFtIGFyZ3NcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9hZGRUb1F1ZXVlKGFyZ3MpIHtcbiAgICAgICAgbGV0IGFjaztcbiAgICAgICAgaWYgKHR5cGVvZiBhcmdzW2FyZ3MubGVuZ3RoIC0gMV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgYWNrID0gYXJncy5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYWNrZXQgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5fcXVldWVTZXErKyxcbiAgICAgICAgICAgIHRyeUNvdW50OiAwLFxuICAgICAgICAgICAgcGVuZGluZzogZmFsc2UsXG4gICAgICAgICAgICBhcmdzLFxuICAgICAgICAgICAgZmxhZ3M6IE9iamVjdC5hc3NpZ24oeyBmcm9tUXVldWU6IHRydWUgfSwgdGhpcy5mbGFncyksXG4gICAgICAgIH07XG4gICAgICAgIGFyZ3MucHVzaCgoZXJyLCAuLi5yZXNwb25zZUFyZ3MpID0+IHtcbiAgICAgICAgICAgIGlmIChwYWNrZXQgIT09IHRoaXMuX3F1ZXVlWzBdKSB7XG4gICAgICAgICAgICAgICAgLy8gdGhlIHBhY2tldCBoYXMgYWxyZWFkeSBiZWVuIGFja25vd2xlZGdlZFxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGhhc0Vycm9yID0gZXJyICE9PSBudWxsO1xuICAgICAgICAgICAgaWYgKGhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhY2tldC50cnlDb3VudCA+IHRoaXMuX29wdHMucmV0cmllcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9xdWV1ZS5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2soZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3F1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgaWYgKGFjaykge1xuICAgICAgICAgICAgICAgICAgICBhY2sobnVsbCwgLi4ucmVzcG9uc2VBcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYWNrZXQucGVuZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RyYWluUXVldWUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3F1ZXVlLnB1c2gocGFja2V0KTtcbiAgICAgICAgdGhpcy5fZHJhaW5RdWV1ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kIHRoZSBmaXJzdCBwYWNrZXQgb2YgdGhlIHF1ZXVlLCBhbmQgd2FpdCBmb3IgYW4gYWNrbm93bGVkZ2VtZW50IGZyb20gdGhlIHNlcnZlci5cbiAgICAgKiBAcGFyYW0gZm9yY2UgLSB3aGV0aGVyIHRvIHJlc2VuZCBhIHBhY2tldCB0aGF0IGhhcyBub3QgYmVlbiBhY2tub3dsZWRnZWQgeWV0XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9kcmFpblF1ZXVlKGZvcmNlID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbm5lY3RlZCB8fCB0aGlzLl9xdWV1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYWNrZXQgPSB0aGlzLl9xdWV1ZVswXTtcbiAgICAgICAgaWYgKHBhY2tldC5wZW5kaW5nICYmICFmb3JjZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHBhY2tldC5wZW5kaW5nID0gdHJ1ZTtcbiAgICAgICAgcGFja2V0LnRyeUNvdW50Kys7XG4gICAgICAgIHRoaXMuZmxhZ3MgPSBwYWNrZXQuZmxhZ3M7XG4gICAgICAgIHRoaXMuZW1pdC5hcHBseSh0aGlzLCBwYWNrZXQuYXJncyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhY2tldFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcGFja2V0KHBhY2tldCkge1xuICAgICAgICBwYWNrZXQubnNwID0gdGhpcy5uc3A7XG4gICAgICAgIHRoaXMuaW8uX3BhY2tldChwYWNrZXQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBlbmdpbmUgYG9wZW5gLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbm9wZW4oKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5hdXRoID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhpcy5hdXRoKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2VuZENvbm5lY3RQYWNrZXQoZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3NlbmRDb25uZWN0UGFja2V0KHRoaXMuYXV0aCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYSBDT05ORUNUIHBhY2tldCB0byBpbml0aWF0ZSB0aGUgU29ja2V0LklPIHNlc3Npb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NlbmRDb25uZWN0UGFja2V0KGRhdGEpIHtcbiAgICAgICAgdGhpcy5wYWNrZXQoe1xuICAgICAgICAgICAgdHlwZTogUGFja2V0VHlwZS5DT05ORUNULFxuICAgICAgICAgICAgZGF0YTogdGhpcy5fcGlkXG4gICAgICAgICAgICAgICAgPyBPYmplY3QuYXNzaWduKHsgcGlkOiB0aGlzLl9waWQsIG9mZnNldDogdGhpcy5fbGFzdE9mZnNldCB9LCBkYXRhKVxuICAgICAgICAgICAgICAgIDogZGF0YSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGVuZ2luZSBvciBtYW5hZ2VyIGBlcnJvcmAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmVycm9yKGVycikge1xuICAgICAgICBpZiAoIXRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImNvbm5lY3RfZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBlbmdpbmUgYGNsb3NlYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZWFzb25cbiAgICAgKiBAcGFyYW0gZGVzY3JpcHRpb25cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uY2xvc2UocmVhc29uLCBkZXNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICBkZWxldGUgdGhpcy5pZDtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJkaXNjb25uZWN0XCIsIHJlYXNvbiwgZGVzY3JpcHRpb24pO1xuICAgICAgICB0aGlzLl9jbGVhckFja3MoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYXJzIHRoZSBhY2tub3dsZWRnZW1lbnQgaGFuZGxlcnMgdXBvbiBkaXNjb25uZWN0aW9uLCBzaW5jZSB0aGUgY2xpZW50IHdpbGwgbmV2ZXIgcmVjZWl2ZSBhbiBhY2tub3dsZWRnZW1lbnQgZnJvbVxuICAgICAqIHRoZSBzZXJ2ZXIuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jbGVhckFja3MoKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuYWNrcykuZm9yRWFjaCgoaWQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlzQnVmZmVyZWQgPSB0aGlzLnNlbmRCdWZmZXIuc29tZSgocGFja2V0KSA9PiBTdHJpbmcocGFja2V0LmlkKSA9PT0gaWQpO1xuICAgICAgICAgICAgaWYgKCFpc0J1ZmZlcmVkKSB7XG4gICAgICAgICAgICAgICAgLy8gbm90ZTogaGFuZGxlcnMgdGhhdCBkbyBub3QgYWNjZXB0IGFuIGVycm9yIGFzIGZpcnN0IGFyZ3VtZW50IGFyZSBpZ25vcmVkIGhlcmVcbiAgICAgICAgICAgICAgICBjb25zdCBhY2sgPSB0aGlzLmFja3NbaWRdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmFja3NbaWRdO1xuICAgICAgICAgICAgICAgIGlmIChhY2sud2l0aEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjay5jYWxsKHRoaXMsIG5ldyBFcnJvcihcInNvY2tldCBoYXMgYmVlbiBkaXNjb25uZWN0ZWRcIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aXRoIHNvY2tldCBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFja2V0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbnBhY2tldChwYWNrZXQpIHtcbiAgICAgICAgY29uc3Qgc2FtZU5hbWVzcGFjZSA9IHBhY2tldC5uc3AgPT09IHRoaXMubnNwO1xuICAgICAgICBpZiAoIXNhbWVOYW1lc3BhY2UpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHN3aXRjaCAocGFja2V0LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5DT05ORUNUOlxuICAgICAgICAgICAgICAgIGlmIChwYWNrZXQuZGF0YSAmJiBwYWNrZXQuZGF0YS5zaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmNvbm5lY3QocGFja2V0LmRhdGEuc2lkLCBwYWNrZXQuZGF0YS5waWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjb25uZWN0X2Vycm9yXCIsIG5ldyBFcnJvcihcIkl0IHNlZW1zIHlvdSBhcmUgdHJ5aW5nIHRvIHJlYWNoIGEgU29ja2V0LklPIHNlcnZlciBpbiB2Mi54IHdpdGggYSB2My54IGNsaWVudCwgYnV0IHRoZXkgYXJlIG5vdCBjb21wYXRpYmxlIChtb3JlIGluZm9ybWF0aW9uIGhlcmU6IGh0dHBzOi8vc29ja2V0LmlvL2RvY3MvdjMvbWlncmF0aW5nLWZyb20tMi14LXRvLTMtMC8pXCIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFBhY2tldFR5cGUuRVZFTlQ6XG4gICAgICAgICAgICBjYXNlIFBhY2tldFR5cGUuQklOQVJZX0VWRU5UOlxuICAgICAgICAgICAgICAgIHRoaXMub25ldmVudChwYWNrZXQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkFDSzpcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5CSU5BUllfQUNLOlxuICAgICAgICAgICAgICAgIHRoaXMub25hY2socGFja2V0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5ESVNDT05ORUNUOlxuICAgICAgICAgICAgICAgIHRoaXMub25kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFBhY2tldFR5cGUuQ09OTkVDVF9FUlJPUjpcbiAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnIgPSBuZXcgRXJyb3IocGFja2V0LmRhdGEubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIGVyci5kYXRhID0gcGFja2V0LmRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImNvbm5lY3RfZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBhIHNlcnZlciBldmVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYWNrZXRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uZXZlbnQocGFja2V0KSB7XG4gICAgICAgIGNvbnN0IGFyZ3MgPSBwYWNrZXQuZGF0YSB8fCBbXTtcbiAgICAgICAgaWYgKG51bGwgIT0gcGFja2V0LmlkKSB7XG4gICAgICAgICAgICBhcmdzLnB1c2godGhpcy5hY2socGFja2V0LmlkKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRFdmVudChhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlci5wdXNoKE9iamVjdC5mcmVlemUoYXJncykpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVtaXRFdmVudChhcmdzKSB7XG4gICAgICAgIGlmICh0aGlzLl9hbnlMaXN0ZW5lcnMgJiYgdGhpcy5fYW55TGlzdGVuZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fYW55TGlzdGVuZXJzLnNsaWNlKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGxpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN1cGVyLmVtaXQuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIGlmICh0aGlzLl9waWQgJiYgYXJncy5sZW5ndGggJiYgdHlwZW9mIGFyZ3NbYXJncy5sZW5ndGggLSAxXSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhpcy5fbGFzdE9mZnNldCA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm9kdWNlcyBhbiBhY2sgY2FsbGJhY2sgdG8gZW1pdCB3aXRoIGFuIGV2ZW50LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBhY2soaWQpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIGxldCBzZW50ID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICAgICAgLy8gcHJldmVudCBkb3VibGUgY2FsbGJhY2tzXG4gICAgICAgICAgICBpZiAoc2VudClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBzZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYucGFja2V0KHtcbiAgICAgICAgICAgICAgICB0eXBlOiBQYWNrZXRUeXBlLkFDSyxcbiAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgZGF0YTogYXJncyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBhIHNlcnZlciBhY2tub3dsZWRnZW1lbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFja2V0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmFjayhwYWNrZXQpIHtcbiAgICAgICAgY29uc3QgYWNrID0gdGhpcy5hY2tzW3BhY2tldC5pZF07XG4gICAgICAgIGlmICh0eXBlb2YgYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgdGhpcy5hY2tzW3BhY2tldC5pZF07XG4gICAgICAgIC8vIEB0cy1pZ25vcmUgRklYTUUgYWNrIGlzIGluY29ycmVjdGx5IGluZmVycmVkIGFzICduZXZlcidcbiAgICAgICAgaWYgKGFjay53aXRoRXJyb3IpIHtcbiAgICAgICAgICAgIHBhY2tldC5kYXRhLnVuc2hpZnQobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBhY2suYXBwbHkodGhpcywgcGFja2V0LmRhdGEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBzZXJ2ZXIgY29ubmVjdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgb25jb25uZWN0KGlkLCBwaWQpIHtcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICB0aGlzLnJlY292ZXJlZCA9IHBpZCAmJiB0aGlzLl9waWQgPT09IHBpZDtcbiAgICAgICAgdGhpcy5fcGlkID0gcGlkOyAvLyBkZWZpbmVkIG9ubHkgaWYgY29ubmVjdGlvbiBzdGF0ZSByZWNvdmVyeSBpcyBlbmFibGVkXG4gICAgICAgIHRoaXMuY29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lbWl0QnVmZmVyZWQoKTtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjb25uZWN0XCIpO1xuICAgICAgICB0aGlzLl9kcmFpblF1ZXVlKHRydWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbWl0IGJ1ZmZlcmVkIGV2ZW50cyAocmVjZWl2ZWQgYW5kIGVtaXR0ZWQpLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBlbWl0QnVmZmVyZWQoKSB7XG4gICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlci5mb3JFYWNoKChhcmdzKSA9PiB0aGlzLmVtaXRFdmVudChhcmdzKSk7XG4gICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlciA9IFtdO1xuICAgICAgICB0aGlzLnNlbmRCdWZmZXIuZm9yRWFjaCgocGFja2V0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeU91dGdvaW5nTGlzdGVuZXJzKHBhY2tldCk7XG4gICAgICAgICAgICB0aGlzLnBhY2tldChwYWNrZXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZW5kQnVmZmVyID0gW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHNlcnZlciBkaXNjb25uZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLm9uY2xvc2UoXCJpbyBzZXJ2ZXIgZGlzY29ubmVjdFwiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gZm9yY2VkIGNsaWVudC9zZXJ2ZXIgc2lkZSBkaXNjb25uZWN0aW9ucyxcbiAgICAgKiB0aGlzIG1ldGhvZCBlbnN1cmVzIHRoZSBtYW5hZ2VyIHN0b3BzIHRyYWNraW5nIHVzIGFuZFxuICAgICAqIHRoYXQgcmVjb25uZWN0aW9ucyBkb24ndCBnZXQgdHJpZ2dlcmVkIGZvciB0aGlzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBkZXN0cm95KCkge1xuICAgICAgICBpZiAodGhpcy5zdWJzKSB7XG4gICAgICAgICAgICAvLyBjbGVhbiBzdWJzY3JpcHRpb25zIHRvIGF2b2lkIHJlY29ubmVjdGlvbnNcbiAgICAgICAgICAgIHRoaXMuc3Vicy5mb3JFYWNoKChzdWJEZXN0cm95KSA9PiBzdWJEZXN0cm95KCkpO1xuICAgICAgICAgICAgdGhpcy5zdWJzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW9bXCJfZGVzdHJveVwiXSh0aGlzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGlzY29ubmVjdHMgdGhlIHNvY2tldCBtYW51YWxseS4gSW4gdGhhdCBjYXNlLCB0aGUgc29ja2V0IHdpbGwgbm90IHRyeSB0byByZWNvbm5lY3QuXG4gICAgICpcbiAgICAgKiBJZiB0aGlzIGlzIHRoZSBsYXN0IGFjdGl2ZSBTb2NrZXQgaW5zdGFuY2Ugb2YgdGhlIHtAbGluayBNYW5hZ2VyfSwgdGhlIGxvdy1sZXZlbCBjb25uZWN0aW9uIHdpbGwgYmUgY2xvc2VkLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBjb25zdCBzb2NrZXQgPSBpbygpO1xuICAgICAqXG4gICAgICogc29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAocmVhc29uKSA9PiB7XG4gICAgICogICAvLyBjb25zb2xlLmxvZyhyZWFzb24pOyBwcmludHMgXCJpbyBjbGllbnQgZGlzY29ubmVjdFwiXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBzb2NrZXQuZGlzY29ubmVjdCgpO1xuICAgICAqXG4gICAgICogQHJldHVybiBzZWxmXG4gICAgICovXG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLnBhY2tldCh7IHR5cGU6IFBhY2tldFR5cGUuRElTQ09OTkVDVCB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyByZW1vdmUgc29ja2V0IGZyb20gcG9vbFxuICAgICAgICB0aGlzLmRlc3Ryb3koKTtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAvLyBmaXJlIGV2ZW50c1xuICAgICAgICAgICAgdGhpcy5vbmNsb3NlKFwiaW8gY2xpZW50IGRpc2Nvbm5lY3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFsaWFzIGZvciB7QGxpbmsgZGlzY29ubmVjdCgpfS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gc2VsZlxuICAgICAqL1xuICAgIGNsb3NlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGNvbXByZXNzIGZsYWcuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHNvY2tldC5jb21wcmVzcyhmYWxzZSkuZW1pdChcImhlbGxvXCIpO1xuICAgICAqXG4gICAgICogQHBhcmFtIGNvbXByZXNzIC0gaWYgYHRydWVgLCBjb21wcmVzc2VzIHRoZSBzZW5kaW5nIGRhdGFcbiAgICAgKiBAcmV0dXJuIHNlbGZcbiAgICAgKi9cbiAgICBjb21wcmVzcyhjb21wcmVzcykge1xuICAgICAgICB0aGlzLmZsYWdzLmNvbXByZXNzID0gY29tcHJlc3M7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIGEgbW9kaWZpZXIgZm9yIGEgc3Vic2VxdWVudCBldmVudCBlbWlzc2lvbiB0aGF0IHRoZSBldmVudCBtZXNzYWdlIHdpbGwgYmUgZHJvcHBlZCB3aGVuIHRoaXMgc29ja2V0IGlzIG5vdFxuICAgICAqIHJlYWR5IHRvIHNlbmQgbWVzc2FnZXMuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHNvY2tldC52b2xhdGlsZS5lbWl0KFwiaGVsbG9cIik7IC8vIHRoZSBzZXJ2ZXIgbWF5IG9yIG1heSBub3QgcmVjZWl2ZSBpdFxuICAgICAqXG4gICAgICogQHJldHVybnMgc2VsZlxuICAgICAqL1xuICAgIGdldCB2b2xhdGlsZSgpIHtcbiAgICAgICAgdGhpcy5mbGFncy52b2xhdGlsZSA9IHRydWU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIGEgbW9kaWZpZXIgZm9yIGEgc3Vic2VxdWVudCBldmVudCBlbWlzc2lvbiB0aGF0IHRoZSBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZCB3aXRoIGFuIGVycm9yIHdoZW4gdGhlXG4gICAgICogZ2l2ZW4gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBoYXZlIGVsYXBzZWQgd2l0aG91dCBhbiBhY2tub3dsZWRnZW1lbnQgZnJvbSB0aGUgc2VydmVyOlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBzb2NrZXQudGltZW91dCg1MDAwKS5lbWl0KFwibXktZXZlbnRcIiwgKGVycikgPT4ge1xuICAgICAqICAgaWYgKGVycikge1xuICAgICAqICAgICAvLyB0aGUgc2VydmVyIGRpZCBub3QgYWNrbm93bGVkZ2UgdGhlIGV2ZW50IGluIHRoZSBnaXZlbiBkZWxheVxuICAgICAqICAgfVxuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHJldHVybnMgc2VsZlxuICAgICAqL1xuICAgIHRpbWVvdXQodGltZW91dCkge1xuICAgICAgICB0aGlzLmZsYWdzLnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSBmaXJlZCB3aGVuIGFueSBldmVudCBpcyBlbWl0dGVkLiBUaGUgZXZlbnQgbmFtZSBpcyBwYXNzZWQgYXMgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHRoZVxuICAgICAqIGNhbGxiYWNrLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBzb2NrZXQub25BbnkoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgZ290ICR7ZXZlbnR9YCk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGlzdGVuZXJcbiAgICAgKi9cbiAgICBvbkFueShsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLl9hbnlMaXN0ZW5lcnMgPSB0aGlzLl9hbnlMaXN0ZW5lcnMgfHwgW107XG4gICAgICAgIHRoaXMuX2FueUxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgZmlyZWQgd2hlbiBhbnkgZXZlbnQgaXMgZW1pdHRlZC4gVGhlIGV2ZW50IG5hbWUgaXMgcGFzc2VkIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGVcbiAgICAgKiBjYWxsYmFjay4gVGhlIGxpc3RlbmVyIGlzIGFkZGVkIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGxpc3RlbmVycyBhcnJheS5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0LnByZXBlbmRBbnkoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgZ290IGV2ZW50ICR7ZXZlbnR9YCk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGlzdGVuZXJcbiAgICAgKi9cbiAgICBwcmVwZW5kQW55KGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuX2FueUxpc3RlbmVycyA9IHRoaXMuX2FueUxpc3RlbmVycyB8fCBbXTtcbiAgICAgICAgdGhpcy5fYW55TGlzdGVuZXJzLnVuc2hpZnQobGlzdGVuZXIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGZpcmVkIHdoZW4gYW55IGV2ZW50IGlzIGVtaXR0ZWQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IGNhdGNoQWxsTGlzdGVuZXIgPSAoZXZlbnQsIC4uLmFyZ3MpID0+IHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKGBnb3QgZXZlbnQgJHtldmVudH1gKTtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBzb2NrZXQub25BbnkoY2F0Y2hBbGxMaXN0ZW5lcik7XG4gICAgICpcbiAgICAgKiAvLyByZW1vdmUgYSBzcGVjaWZpYyBsaXN0ZW5lclxuICAgICAqIHNvY2tldC5vZmZBbnkoY2F0Y2hBbGxMaXN0ZW5lcik7XG4gICAgICpcbiAgICAgKiAvLyBvciByZW1vdmUgYWxsIGxpc3RlbmVyc1xuICAgICAqIHNvY2tldC5vZmZBbnkoKTtcbiAgICAgKlxuICAgICAqIEBwYXJhbSBsaXN0ZW5lclxuICAgICAqL1xuICAgIG9mZkFueShsaXN0ZW5lcikge1xuICAgICAgICBpZiAoIXRoaXMuX2FueUxpc3RlbmVycykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLl9hbnlMaXN0ZW5lcnM7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lciA9PT0gbGlzdGVuZXJzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2FueUxpc3RlbmVycyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIGxpc3RlbmVycyB0aGF0IGFyZSBsaXN0ZW5pbmcgZm9yIGFueSBldmVudCB0aGF0IGlzIHNwZWNpZmllZC4gVGhpcyBhcnJheSBjYW4gYmUgbWFuaXB1bGF0ZWQsXG4gICAgICogZS5nLiB0byByZW1vdmUgbGlzdGVuZXJzLlxuICAgICAqL1xuICAgIGxpc3RlbmVyc0FueSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FueUxpc3RlbmVycyB8fCBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSBmaXJlZCB3aGVuIGFueSBldmVudCBpcyBlbWl0dGVkLiBUaGUgZXZlbnQgbmFtZSBpcyBwYXNzZWQgYXMgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHRoZVxuICAgICAqIGNhbGxiYWNrLlxuICAgICAqXG4gICAgICogTm90ZTogYWNrbm93bGVkZ2VtZW50cyBzZW50IHRvIHRoZSBzZXJ2ZXIgYXJlIG5vdCBpbmNsdWRlZC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0Lm9uQW55T3V0Z29pbmcoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgc2VudCBldmVudCAke2V2ZW50fWApO1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHBhcmFtIGxpc3RlbmVyXG4gICAgICovXG4gICAgb25BbnlPdXRnb2luZyhsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycyA9IHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzIHx8IFtdO1xuICAgICAgICB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgZmlyZWQgd2hlbiBhbnkgZXZlbnQgaXMgZW1pdHRlZC4gVGhlIGV2ZW50IG5hbWUgaXMgcGFzc2VkIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGVcbiAgICAgKiBjYWxsYmFjay4gVGhlIGxpc3RlbmVyIGlzIGFkZGVkIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGxpc3RlbmVycyBhcnJheS5cbiAgICAgKlxuICAgICAqIE5vdGU6IGFja25vd2xlZGdlbWVudHMgc2VudCB0byB0aGUgc2VydmVyIGFyZSBub3QgaW5jbHVkZWQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHNvY2tldC5wcmVwZW5kQW55T3V0Z29pbmcoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgc2VudCBldmVudCAke2V2ZW50fWApO1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHBhcmFtIGxpc3RlbmVyXG4gICAgICovXG4gICAgcHJlcGVuZEFueU91dGdvaW5nKGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzID0gdGhpcy5fYW55T3V0Z29pbmdMaXN0ZW5lcnMgfHwgW107XG4gICAgICAgIHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzLnVuc2hpZnQobGlzdGVuZXIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGZpcmVkIHdoZW4gYW55IGV2ZW50IGlzIGVtaXR0ZWQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IGNhdGNoQWxsTGlzdGVuZXIgPSAoZXZlbnQsIC4uLmFyZ3MpID0+IHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKGBzZW50IGV2ZW50ICR7ZXZlbnR9YCk7XG4gICAgICogfVxuICAgICAqXG4gICAgICogc29ja2V0Lm9uQW55T3V0Z29pbmcoY2F0Y2hBbGxMaXN0ZW5lcik7XG4gICAgICpcbiAgICAgKiAvLyByZW1vdmUgYSBzcGVjaWZpYyBsaXN0ZW5lclxuICAgICAqIHNvY2tldC5vZmZBbnlPdXRnb2luZyhjYXRjaEFsbExpc3RlbmVyKTtcbiAgICAgKlxuICAgICAqIC8vIG9yIHJlbW92ZSBhbGwgbGlzdGVuZXJzXG4gICAgICogc29ja2V0Lm9mZkFueU91dGdvaW5nKCk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0gW2xpc3RlbmVyXSAtIHRoZSBjYXRjaC1hbGwgbGlzdGVuZXIgKG9wdGlvbmFsKVxuICAgICAqL1xuICAgIG9mZkFueU91dGdvaW5nKGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICghdGhpcy5fYW55T3V0Z29pbmdMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fYW55T3V0Z29pbmdMaXN0ZW5lcnM7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lciA9PT0gbGlzdGVuZXJzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4gYXJyYXkgb2YgbGlzdGVuZXJzIHRoYXQgYXJlIGxpc3RlbmluZyBmb3IgYW55IGV2ZW50IHRoYXQgaXMgc3BlY2lmaWVkLiBUaGlzIGFycmF5IGNhbiBiZSBtYW5pcHVsYXRlZCxcbiAgICAgKiBlLmcuIHRvIHJlbW92ZSBsaXN0ZW5lcnMuXG4gICAgICovXG4gICAgbGlzdGVuZXJzQW55T3V0Z29pbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycyB8fCBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTm90aWZ5IHRoZSBsaXN0ZW5lcnMgZm9yIGVhY2ggcGFja2V0IHNlbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYWNrZXRcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgbm90aWZ5T3V0Z29pbmdMaXN0ZW5lcnMocGFja2V0KSB7XG4gICAgICAgIGlmICh0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycyAmJiB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzLnNsaWNlKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGxpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIHBhY2tldC5kYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js\n')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js ***!
  \**************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   url: () => (/* binding */ url)\n/* harmony export */ });\n/* harmony import */ var engine_io_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! engine.io-client */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js");\n\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nfunction url(uri, path = "", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== "undefined" && location);\n    if (null == uri)\n        uri = loc.protocol + "//" + loc.host;\n    // relative path support\n    if (typeof uri === "string") {\n        if ("/" === uri.charAt(0)) {\n            if ("/" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if ("undefined" !== typeof loc) {\n                uri = loc.protocol + "//" + uri;\n            }\n            else {\n                uri = "https://" + uri;\n            }\n        }\n        // parse\n        obj = (0,engine_io_client__WEBPACK_IMPORTED_MODULE_0__.parse)(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = "80";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = "443";\n        }\n    }\n    obj.path = obj.path || "/";\n    const ipv6 = obj.host.indexOf(":") !== -1;\n    const host = ipv6 ? "[" + obj.host + "]" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + "://" + host + ":" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            "://" +\n            host +\n            (loc && loc.port === obj.port ? "" : ":" + obj.port);\n    return obj;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vdXJsLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx1REFBSztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1jbGllbnRANC44LjEvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1jbGllbnQvYnVpbGQvZXNtL3VybC5qcz9lOTcxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlIH0gZnJvbSBcImVuZ2luZS5pby1jbGllbnRcIjtcbi8qKlxuICogVVJMIHBhcnNlci5cbiAqXG4gKiBAcGFyYW0gdXJpIC0gdXJsXG4gKiBAcGFyYW0gcGF0aCAtIHRoZSByZXF1ZXN0IHBhdGggb2YgdGhlIGNvbm5lY3Rpb25cbiAqIEBwYXJhbSBsb2MgLSBBbiBvYmplY3QgbWVhbnQgdG8gbWltaWMgd2luZG93LmxvY2F0aW9uLlxuICogICAgICAgIERlZmF1bHRzIHRvIHdpbmRvdy5sb2NhdGlvbi5cbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVybCh1cmksIHBhdGggPSBcIlwiLCBsb2MpIHtcbiAgICBsZXQgb2JqID0gdXJpO1xuICAgIC8vIGRlZmF1bHQgdG8gd2luZG93LmxvY2F0aW9uXG4gICAgbG9jID0gbG9jIHx8ICh0eXBlb2YgbG9jYXRpb24gIT09IFwidW5kZWZpbmVkXCIgJiYgbG9jYXRpb24pO1xuICAgIGlmIChudWxsID09IHVyaSlcbiAgICAgICAgdXJpID0gbG9jLnByb3RvY29sICsgXCIvL1wiICsgbG9jLmhvc3Q7XG4gICAgLy8gcmVsYXRpdmUgcGF0aCBzdXBwb3J0XG4gICAgaWYgKHR5cGVvZiB1cmkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgaWYgKFwiL1wiID09PSB1cmkuY2hhckF0KDApKSB7XG4gICAgICAgICAgICBpZiAoXCIvXCIgPT09IHVyaS5jaGFyQXQoMSkpIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBsb2MucHJvdG9jb2wgKyB1cmk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBsb2MuaG9zdCArIHVyaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIS9eKGh0dHBzP3x3c3M/KTpcXC9cXC8vLnRlc3QodXJpKSkge1xuICAgICAgICAgICAgaWYgKFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBsb2MpIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBsb2MucHJvdG9jb2wgKyBcIi8vXCIgKyB1cmk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBcImh0dHBzOi8vXCIgKyB1cmk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gcGFyc2VcbiAgICAgICAgb2JqID0gcGFyc2UodXJpKTtcbiAgICB9XG4gICAgLy8gbWFrZSBzdXJlIHdlIHRyZWF0IGBsb2NhbGhvc3Q6ODBgIGFuZCBgbG9jYWxob3N0YCBlcXVhbGx5XG4gICAgaWYgKCFvYmoucG9ydCkge1xuICAgICAgICBpZiAoL14oaHR0cHx3cykkLy50ZXN0KG9iai5wcm90b2NvbCkpIHtcbiAgICAgICAgICAgIG9iai5wb3J0ID0gXCI4MFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKC9eKGh0dHB8d3MpcyQvLnRlc3Qob2JqLnByb3RvY29sKSkge1xuICAgICAgICAgICAgb2JqLnBvcnQgPSBcIjQ0M1wiO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9iai5wYXRoID0gb2JqLnBhdGggfHwgXCIvXCI7XG4gICAgY29uc3QgaXB2NiA9IG9iai5ob3N0LmluZGV4T2YoXCI6XCIpICE9PSAtMTtcbiAgICBjb25zdCBob3N0ID0gaXB2NiA/IFwiW1wiICsgb2JqLmhvc3QgKyBcIl1cIiA6IG9iai5ob3N0O1xuICAgIC8vIGRlZmluZSB1bmlxdWUgaWRcbiAgICBvYmouaWQgPSBvYmoucHJvdG9jb2wgKyBcIjovL1wiICsgaG9zdCArIFwiOlwiICsgb2JqLnBvcnQgKyBwYXRoO1xuICAgIC8vIGRlZmluZSBocmVmXG4gICAgb2JqLmhyZWYgPVxuICAgICAgICBvYmoucHJvdG9jb2wgK1xuICAgICAgICAgICAgXCI6Ly9cIiArXG4gICAgICAgICAgICBob3N0ICtcbiAgICAgICAgICAgIChsb2MgJiYgbG9jLnBvcnQgPT09IG9iai5wb3J0ID8gXCJcIiA6IFwiOlwiICsgb2JqLnBvcnQpO1xuICAgIHJldHVybiBvYmo7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js\n')},"./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js ***!
  \*****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deconstructPacket: () => (/* binding */ deconstructPacket),\n/* harmony export */   reconstructPacket: () => (/* binding */ reconstructPacket)\n/* harmony export */ });\n/* harmony import */ var _is_binary_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./is-binary.js */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js");\n\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nfunction deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary \'attachments\'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if ((0,_is_binary_js__WEBPACK_IMPORTED_MODULE_0__.isBinary)(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === "object" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nfunction reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === "number" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error("illegal attachments");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === "object") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vYmluYXJ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsWUFBWSxRQUFRO0FBQ3BCO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdURBQVE7QUFDaEIsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsaUJBQWlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLE9BQU87QUFDbEIsWUFBWSxRQUFRO0FBQ3BCO0FBQ0E7QUFDTztBQUNQO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpQkFBaUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1wYXJzZXJANC4yLjQvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1wYXJzZXIvYnVpbGQvZXNtL2JpbmFyeS5qcz9jMTk0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzQmluYXJ5IH0gZnJvbSBcIi4vaXMtYmluYXJ5LmpzXCI7XG4vKipcbiAqIFJlcGxhY2VzIGV2ZXJ5IEJ1ZmZlciB8IEFycmF5QnVmZmVyIHwgQmxvYiB8IEZpbGUgaW4gcGFja2V0IHdpdGggYSBudW1iZXJlZCBwbGFjZWhvbGRlci5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcGFja2V0IC0gc29ja2V0LmlvIGV2ZW50IHBhY2tldFxuICogQHJldHVybiB7T2JqZWN0fSB3aXRoIGRlY29uc3RydWN0ZWQgcGFja2V0IGFuZCBsaXN0IG9mIGJ1ZmZlcnNcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlY29uc3RydWN0UGFja2V0KHBhY2tldCkge1xuICAgIGNvbnN0IGJ1ZmZlcnMgPSBbXTtcbiAgICBjb25zdCBwYWNrZXREYXRhID0gcGFja2V0LmRhdGE7XG4gICAgY29uc3QgcGFjayA9IHBhY2tldDtcbiAgICBwYWNrLmRhdGEgPSBfZGVjb25zdHJ1Y3RQYWNrZXQocGFja2V0RGF0YSwgYnVmZmVycyk7XG4gICAgcGFjay5hdHRhY2htZW50cyA9IGJ1ZmZlcnMubGVuZ3RoOyAvLyBudW1iZXIgb2YgYmluYXJ5ICdhdHRhY2htZW50cydcbiAgICByZXR1cm4geyBwYWNrZXQ6IHBhY2ssIGJ1ZmZlcnM6IGJ1ZmZlcnMgfTtcbn1cbmZ1bmN0aW9uIF9kZWNvbnN0cnVjdFBhY2tldChkYXRhLCBidWZmZXJzKSB7XG4gICAgaWYgKCFkYXRhKVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICBpZiAoaXNCaW5hcnkoZGF0YSkpIHtcbiAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSB7IF9wbGFjZWhvbGRlcjogdHJ1ZSwgbnVtOiBidWZmZXJzLmxlbmd0aCB9O1xuICAgICAgICBidWZmZXJzLnB1c2goZGF0YSk7XG4gICAgICAgIHJldHVybiBwbGFjZWhvbGRlcjtcbiAgICB9XG4gICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICBjb25zdCBuZXdEYXRhID0gbmV3IEFycmF5KGRhdGEubGVuZ3RoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBuZXdEYXRhW2ldID0gX2RlY29uc3RydWN0UGFja2V0KGRhdGFbaV0sIGJ1ZmZlcnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdEYXRhO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgZGF0YSA9PT0gXCJvYmplY3RcIiAmJiAhKGRhdGEgaW5zdGFuY2VvZiBEYXRlKSkge1xuICAgICAgICBjb25zdCBuZXdEYXRhID0ge307XG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZGF0YSwga2V5KSkge1xuICAgICAgICAgICAgICAgIG5ld0RhdGFba2V5XSA9IF9kZWNvbnN0cnVjdFBhY2tldChkYXRhW2tleV0sIGJ1ZmZlcnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdEYXRhO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbn1cbi8qKlxuICogUmVjb25zdHJ1Y3RzIGEgYmluYXJ5IHBhY2tldCBmcm9tIGl0cyBwbGFjZWhvbGRlciBwYWNrZXQgYW5kIGJ1ZmZlcnNcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcGFja2V0IC0gZXZlbnQgcGFja2V0IHdpdGggcGxhY2Vob2xkZXJzXG4gKiBAcGFyYW0ge0FycmF5fSBidWZmZXJzIC0gYmluYXJ5IGJ1ZmZlcnMgdG8gcHV0IGluIHBsYWNlaG9sZGVyIHBvc2l0aW9uc1xuICogQHJldHVybiB7T2JqZWN0fSByZWNvbnN0cnVjdGVkIHBhY2tldFxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVjb25zdHJ1Y3RQYWNrZXQocGFja2V0LCBidWZmZXJzKSB7XG4gICAgcGFja2V0LmRhdGEgPSBfcmVjb25zdHJ1Y3RQYWNrZXQocGFja2V0LmRhdGEsIGJ1ZmZlcnMpO1xuICAgIGRlbGV0ZSBwYWNrZXQuYXR0YWNobWVudHM7IC8vIG5vIGxvbmdlciB1c2VmdWxcbiAgICByZXR1cm4gcGFja2V0O1xufVxuZnVuY3Rpb24gX3JlY29uc3RydWN0UGFja2V0KGRhdGEsIGJ1ZmZlcnMpIHtcbiAgICBpZiAoIWRhdGEpXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIGlmIChkYXRhICYmIGRhdGEuX3BsYWNlaG9sZGVyID09PSB0cnVlKSB7XG4gICAgICAgIGNvbnN0IGlzSW5kZXhWYWxpZCA9IHR5cGVvZiBkYXRhLm51bSA9PT0gXCJudW1iZXJcIiAmJlxuICAgICAgICAgICAgZGF0YS5udW0gPj0gMCAmJlxuICAgICAgICAgICAgZGF0YS5udW0gPCBidWZmZXJzLmxlbmd0aDtcbiAgICAgICAgaWYgKGlzSW5kZXhWYWxpZCkge1xuICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcnNbZGF0YS5udW1dOyAvLyBhcHByb3ByaWF0ZSBidWZmZXIgKHNob3VsZCBiZSBuYXR1cmFsIG9yZGVyIGFueXdheSlcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgYXR0YWNobWVudHNcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGRhdGFbaV0gPSBfcmVjb25zdHJ1Y3RQYWNrZXQoZGF0YVtpXSwgYnVmZmVycyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGRhdGEgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gZGF0YSkge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkYXRhLCBrZXkpKSB7XG4gICAgICAgICAgICAgICAgZGF0YVtrZXldID0gX3JlY29uc3RydWN0UGFja2V0KGRhdGFba2V5XSwgYnVmZmVycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js\n')},"./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Decoder: () => (/* binding */ Decoder),\n/* harmony export */   Encoder: () => (/* binding */ Encoder),\n/* harmony export */   PacketType: () => (/* binding */ PacketType),\n/* harmony export */   protocol: () => (/* binding */ protocol)\n/* harmony export */ });\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var _binary_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./binary.js */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js");\n/* harmony import */ var _is_binary_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./is-binary.js */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js");\n\n\n\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    "connect",\n    "connect_error",\n    "disconnect",\n    "disconnecting",\n    "newListener",\n    "removeListener", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nconst protocol = 5;\nvar PacketType;\n(function (PacketType) {\n    PacketType[PacketType["CONNECT"] = 0] = "CONNECT";\n    PacketType[PacketType["DISCONNECT"] = 1] = "DISCONNECT";\n    PacketType[PacketType["EVENT"] = 2] = "EVENT";\n    PacketType[PacketType["ACK"] = 3] = "ACK";\n    PacketType[PacketType["CONNECT_ERROR"] = 4] = "CONNECT_ERROR";\n    PacketType[PacketType["BINARY_EVENT"] = 5] = "BINARY_EVENT";\n    PacketType[PacketType["BINARY_ACK"] = 6] = "BINARY_ACK";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nclass Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if ((0,_is_binary_js__WEBPACK_IMPORTED_MODULE_2__.hasBinary)(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = "" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + "-";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && "/" !== obj.nsp) {\n            str += obj.nsp + ",";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as \'buffer sequence\' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = (0,_binary_js__WEBPACK_IMPORTED_MODULE_1__.deconstructPacket)(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === "[object Object]";\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nclass Decoder extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_0__.Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === "string") {\n            if (this.reconstructor) {\n                throw new Error("got plaintext data when reconstructing a packet");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet\'s json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved("decoded", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved("decoded", packet);\n            }\n        }\n        else if ((0,_is_binary_js__WEBPACK_IMPORTED_MODULE_2__.isBinary)(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error("got binary data when not reconstructing a packet");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved("decoded", packet);\n                }\n            }\n        }\n        else {\n            throw new Error("Unknown type: " + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error("unknown packet type " + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== "-" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== "-") {\n                throw new Error("Illegal attachments");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if ("/" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if ("," === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = "/";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if ("" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error("invalid payload");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === "string" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === "number" ||\n                        (typeof payload[0] === "string" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser\'s resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event\'s \'buffer sequence\'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = (0,_binary_js__WEBPACK_IMPORTED_MODULE_1__.reconstructPacket)(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF1RDtBQUNZO0FBQ2Q7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNBO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsZ0NBQWdDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsZUFBZSxVQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHdEQUFTO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw2REFBaUI7QUFDaEQ7QUFDQTtBQUNBLCtCQUErQjtBQUMvQix3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxRQUFRO0FBQ3BCO0FBQ08sc0JBQXNCLGlFQUFPO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLGVBQWUsVUFBVTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsdURBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsWUFBWSxxQkFBcUI7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsc0JBQXNCO0FBQ3JDLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw2REFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaW5kZXguanM/YTdjYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIkBzb2NrZXQuaW8vY29tcG9uZW50LWVtaXR0ZXJcIjtcbmltcG9ydCB7IGRlY29uc3RydWN0UGFja2V0LCByZWNvbnN0cnVjdFBhY2tldCB9IGZyb20gXCIuL2JpbmFyeS5qc1wiO1xuaW1wb3J0IHsgaXNCaW5hcnksIGhhc0JpbmFyeSB9IGZyb20gXCIuL2lzLWJpbmFyeS5qc1wiO1xuLyoqXG4gKiBUaGVzZSBzdHJpbmdzIG11c3Qgbm90IGJlIHVzZWQgYXMgZXZlbnQgbmFtZXMsIGFzIHRoZXkgaGF2ZSBhIHNwZWNpYWwgbWVhbmluZy5cbiAqL1xuY29uc3QgUkVTRVJWRURfRVZFTlRTID0gW1xuICAgIFwiY29ubmVjdFwiLFxuICAgIFwiY29ubmVjdF9lcnJvclwiLFxuICAgIFwiZGlzY29ubmVjdFwiLFxuICAgIFwiZGlzY29ubmVjdGluZ1wiLFxuICAgIFwibmV3TGlzdGVuZXJcIixcbiAgICBcInJlbW92ZUxpc3RlbmVyXCIsIC8vIHVzZWQgYnkgdGhlIE5vZGUuanMgRXZlbnRFbWl0dGVyXG5dO1xuLyoqXG4gKiBQcm90b2NvbCB2ZXJzaW9uLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNvbnN0IHByb3RvY29sID0gNTtcbmV4cG9ydCB2YXIgUGFja2V0VHlwZTtcbihmdW5jdGlvbiAoUGFja2V0VHlwZSkge1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkNPTk5FQ1RcIl0gPSAwXSA9IFwiQ09OTkVDVFwiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkRJU0NPTk5FQ1RcIl0gPSAxXSA9IFwiRElTQ09OTkVDVFwiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkVWRU5UXCJdID0gMl0gPSBcIkVWRU5UXCI7XG4gICAgUGFja2V0VHlwZVtQYWNrZXRUeXBlW1wiQUNLXCJdID0gM10gPSBcIkFDS1wiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkNPTk5FQ1RfRVJST1JcIl0gPSA0XSA9IFwiQ09OTkVDVF9FUlJPUlwiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkJJTkFSWV9FVkVOVFwiXSA9IDVdID0gXCJCSU5BUllfRVZFTlRcIjtcbiAgICBQYWNrZXRUeXBlW1BhY2tldFR5cGVbXCJCSU5BUllfQUNLXCJdID0gNl0gPSBcIkJJTkFSWV9BQ0tcIjtcbn0pKFBhY2tldFR5cGUgfHwgKFBhY2tldFR5cGUgPSB7fSkpO1xuLyoqXG4gKiBBIHNvY2tldC5pbyBFbmNvZGVyIGluc3RhbmNlXG4gKi9cbmV4cG9ydCBjbGFzcyBFbmNvZGVyIHtcbiAgICAvKipcbiAgICAgKiBFbmNvZGVyIGNvbnN0cnVjdG9yXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSByZXBsYWNlciAtIGN1c3RvbSByZXBsYWNlciB0byBwYXNzIGRvd24gdG8gSlNPTi5wYXJzZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlcGxhY2VyKSB7XG4gICAgICAgIHRoaXMucmVwbGFjZXIgPSByZXBsYWNlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5jb2RlIGEgcGFja2V0IGFzIGEgc2luZ2xlIHN0cmluZyBpZiBub24tYmluYXJ5LCBvciBhcyBhXG4gICAgICogYnVmZmVyIHNlcXVlbmNlLCBkZXBlbmRpbmcgb24gcGFja2V0IHR5cGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIC0gcGFja2V0IG9iamVjdFxuICAgICAqL1xuICAgIGVuY29kZShvYmopIHtcbiAgICAgICAgaWYgKG9iai50eXBlID09PSBQYWNrZXRUeXBlLkVWRU5UIHx8IG9iai50eXBlID09PSBQYWNrZXRUeXBlLkFDSykge1xuICAgICAgICAgICAgaWYgKGhhc0JpbmFyeShvYmopKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlQXNCaW5hcnkoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBvYmoudHlwZSA9PT0gUGFja2V0VHlwZS5FVkVOVFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBQYWNrZXRUeXBlLkJJTkFSWV9FVkVOVFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBQYWNrZXRUeXBlLkJJTkFSWV9BQ0ssXG4gICAgICAgICAgICAgICAgICAgIG5zcDogb2JqLm5zcCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogb2JqLmRhdGEsXG4gICAgICAgICAgICAgICAgICAgIGlkOiBvYmouaWQsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFt0aGlzLmVuY29kZUFzU3RyaW5nKG9iaildO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmNvZGUgcGFja2V0IGFzIHN0cmluZy5cbiAgICAgKi9cbiAgICBlbmNvZGVBc1N0cmluZyhvYmopIHtcbiAgICAgICAgLy8gZmlyc3QgaXMgdHlwZVxuICAgICAgICBsZXQgc3RyID0gXCJcIiArIG9iai50eXBlO1xuICAgICAgICAvLyBhdHRhY2htZW50cyBpZiB3ZSBoYXZlIHRoZW1cbiAgICAgICAgaWYgKG9iai50eXBlID09PSBQYWNrZXRUeXBlLkJJTkFSWV9FVkVOVCB8fFxuICAgICAgICAgICAgb2JqLnR5cGUgPT09IFBhY2tldFR5cGUuQklOQVJZX0FDSykge1xuICAgICAgICAgICAgc3RyICs9IG9iai5hdHRhY2htZW50cyArIFwiLVwiO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIHdlIGhhdmUgYSBuYW1lc3BhY2Ugb3RoZXIgdGhhbiBgL2BcbiAgICAgICAgLy8gd2UgYXBwZW5kIGl0IGZvbGxvd2VkIGJ5IGEgY29tbWEgYCxgXG4gICAgICAgIGlmIChvYmoubnNwICYmIFwiL1wiICE9PSBvYmoubnNwKSB7XG4gICAgICAgICAgICBzdHIgKz0gb2JqLm5zcCArIFwiLFwiO1xuICAgICAgICB9XG4gICAgICAgIC8vIGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5IHRoZSBpZFxuICAgICAgICBpZiAobnVsbCAhPSBvYmouaWQpIHtcbiAgICAgICAgICAgIHN0ciArPSBvYmouaWQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8ganNvbiBkYXRhXG4gICAgICAgIGlmIChudWxsICE9IG9iai5kYXRhKSB7XG4gICAgICAgICAgICBzdHIgKz0gSlNPTi5zdHJpbmdpZnkob2JqLmRhdGEsIHRoaXMucmVwbGFjZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuY29kZSBwYWNrZXQgYXMgJ2J1ZmZlciBzZXF1ZW5jZScgYnkgcmVtb3ZpbmcgYmxvYnMsIGFuZFxuICAgICAqIGRlY29uc3RydWN0aW5nIHBhY2tldCBpbnRvIG9iamVjdCB3aXRoIHBsYWNlaG9sZGVycyBhbmRcbiAgICAgKiBhIGxpc3Qgb2YgYnVmZmVycy5cbiAgICAgKi9cbiAgICBlbmNvZGVBc0JpbmFyeShvYmopIHtcbiAgICAgICAgY29uc3QgZGVjb25zdHJ1Y3Rpb24gPSBkZWNvbnN0cnVjdFBhY2tldChvYmopO1xuICAgICAgICBjb25zdCBwYWNrID0gdGhpcy5lbmNvZGVBc1N0cmluZyhkZWNvbnN0cnVjdGlvbi5wYWNrZXQpO1xuICAgICAgICBjb25zdCBidWZmZXJzID0gZGVjb25zdHJ1Y3Rpb24uYnVmZmVycztcbiAgICAgICAgYnVmZmVycy51bnNoaWZ0KHBhY2spOyAvLyBhZGQgcGFja2V0IGluZm8gdG8gYmVnaW5uaW5nIG9mIGRhdGEgbGlzdFxuICAgICAgICByZXR1cm4gYnVmZmVyczsgLy8gd3JpdGUgYWxsIHRoZSBidWZmZXJzXG4gICAgfVxufVxuLy8gc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzg1MTEyODEvY2hlY2staWYtYS12YWx1ZS1pcy1hbi1vYmplY3QtaW4tamF2YXNjcmlwdFxuZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gXCJbb2JqZWN0IE9iamVjdF1cIjtcbn1cbi8qKlxuICogQSBzb2NrZXQuaW8gRGVjb2RlciBpbnN0YW5jZVxuICpcbiAqIEByZXR1cm4ge09iamVjdH0gZGVjb2RlclxuICovXG5leHBvcnQgY2xhc3MgRGVjb2RlciBleHRlbmRzIEVtaXR0ZXIge1xuICAgIC8qKlxuICAgICAqIERlY29kZXIgY29uc3RydWN0b3JcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJldml2ZXIgLSBjdXN0b20gcmV2aXZlciB0byBwYXNzIGRvd24gdG8gSlNPTi5zdHJpbmdpZnlcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXZpdmVyKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucmV2aXZlciA9IHJldml2ZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlY29kZXMgYW4gZW5jb2RlZCBwYWNrZXQgc3RyaW5nIGludG8gcGFja2V0IEpTT04uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gb2JqIC0gZW5jb2RlZCBwYWNrZXRcbiAgICAgKi9cbiAgICBhZGQob2JqKSB7XG4gICAgICAgIGxldCBwYWNrZXQ7XG4gICAgICAgIGlmICh0eXBlb2Ygb2JqID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5yZWNvbnN0cnVjdG9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZ290IHBsYWludGV4dCBkYXRhIHdoZW4gcmVjb25zdHJ1Y3RpbmcgYSBwYWNrZXRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYWNrZXQgPSB0aGlzLmRlY29kZVN0cmluZyhvYmopO1xuICAgICAgICAgICAgY29uc3QgaXNCaW5hcnlFdmVudCA9IHBhY2tldC50eXBlID09PSBQYWNrZXRUeXBlLkJJTkFSWV9FVkVOVDtcbiAgICAgICAgICAgIGlmIChpc0JpbmFyeUV2ZW50IHx8IHBhY2tldC50eXBlID09PSBQYWNrZXRUeXBlLkJJTkFSWV9BQ0spIHtcbiAgICAgICAgICAgICAgICBwYWNrZXQudHlwZSA9IGlzQmluYXJ5RXZlbnQgPyBQYWNrZXRUeXBlLkVWRU5UIDogUGFja2V0VHlwZS5BQ0s7XG4gICAgICAgICAgICAgICAgLy8gYmluYXJ5IHBhY2tldCdzIGpzb25cbiAgICAgICAgICAgICAgICB0aGlzLnJlY29uc3RydWN0b3IgPSBuZXcgQmluYXJ5UmVjb25zdHJ1Y3RvcihwYWNrZXQpO1xuICAgICAgICAgICAgICAgIC8vIG5vIGF0dGFjaG1lbnRzLCBsYWJlbGVkIGJpbmFyeSBidXQgbm8gYmluYXJ5IGRhdGEgdG8gZm9sbG93XG4gICAgICAgICAgICAgICAgaWYgKHBhY2tldC5hdHRhY2htZW50cyA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdXBlci5lbWl0UmVzZXJ2ZWQoXCJkZWNvZGVkXCIsIHBhY2tldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gbm9uLWJpbmFyeSBmdWxsIHBhY2tldFxuICAgICAgICAgICAgICAgIHN1cGVyLmVtaXRSZXNlcnZlZChcImRlY29kZWRcIiwgcGFja2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc0JpbmFyeShvYmopIHx8IG9iai5iYXNlNjQpIHtcbiAgICAgICAgICAgIC8vIHJhdyBiaW5hcnkgZGF0YVxuICAgICAgICAgICAgaWYgKCF0aGlzLnJlY29uc3RydWN0b3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJnb3QgYmluYXJ5IGRhdGEgd2hlbiBub3QgcmVjb25zdHJ1Y3RpbmcgYSBwYWNrZXRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYWNrZXQgPSB0aGlzLnJlY29uc3RydWN0b3IudGFrZUJpbmFyeURhdGEob2JqKTtcbiAgICAgICAgICAgICAgICBpZiAocGFja2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlY2VpdmVkIGZpbmFsIGJ1ZmZlclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY29uc3RydWN0b3IgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBzdXBlci5lbWl0UmVzZXJ2ZWQoXCJkZWNvZGVkXCIsIHBhY2tldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5rbm93biB0eXBlOiBcIiArIG9iaik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVjb2RlIGEgcGFja2V0IFN0cmluZyAoSlNPTiBkYXRhKVxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0clxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcGFja2V0XG4gICAgICovXG4gICAgZGVjb2RlU3RyaW5nKHN0cikge1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIC8vIGxvb2sgdXAgdHlwZVxuICAgICAgICBjb25zdCBwID0ge1xuICAgICAgICAgICAgdHlwZTogTnVtYmVyKHN0ci5jaGFyQXQoMCkpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAoUGFja2V0VHlwZVtwLnR5cGVdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInVua25vd24gcGFja2V0IHR5cGUgXCIgKyBwLnR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGxvb2sgdXAgYXR0YWNobWVudHMgaWYgdHlwZSBiaW5hcnlcbiAgICAgICAgaWYgKHAudHlwZSA9PT0gUGFja2V0VHlwZS5CSU5BUllfRVZFTlQgfHxcbiAgICAgICAgICAgIHAudHlwZSA9PT0gUGFja2V0VHlwZS5CSU5BUllfQUNLKSB7XG4gICAgICAgICAgICBjb25zdCBzdGFydCA9IGkgKyAxO1xuICAgICAgICAgICAgd2hpbGUgKHN0ci5jaGFyQXQoKytpKSAhPT0gXCItXCIgJiYgaSAhPSBzdHIubGVuZ3RoKSB7IH1cbiAgICAgICAgICAgIGNvbnN0IGJ1ZiA9IHN0ci5zdWJzdHJpbmcoc3RhcnQsIGkpO1xuICAgICAgICAgICAgaWYgKGJ1ZiAhPSBOdW1iZXIoYnVmKSB8fCBzdHIuY2hhckF0KGkpICE9PSBcIi1cIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIklsbGVnYWwgYXR0YWNobWVudHNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwLmF0dGFjaG1lbnRzID0gTnVtYmVyKGJ1Zik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gbG9vayB1cCBuYW1lc3BhY2UgKGlmIGFueSlcbiAgICAgICAgaWYgKFwiL1wiID09PSBzdHIuY2hhckF0KGkgKyAxKSkge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICAgIHdoaWxlICgrK2kpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gc3RyLmNoYXJBdChpKTtcbiAgICAgICAgICAgICAgICBpZiAoXCIsXCIgPT09IGMpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGlmIChpID09PSBzdHIubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHAubnNwID0gc3RyLnN1YnN0cmluZyhzdGFydCwgaSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwLm5zcCA9IFwiL1wiO1xuICAgICAgICB9XG4gICAgICAgIC8vIGxvb2sgdXAgaWRcbiAgICAgICAgY29uc3QgbmV4dCA9IHN0ci5jaGFyQXQoaSArIDEpO1xuICAgICAgICBpZiAoXCJcIiAhPT0gbmV4dCAmJiBOdW1iZXIobmV4dCkgPT0gbmV4dCkge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICAgIHdoaWxlICgrK2kpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gc3RyLmNoYXJBdChpKTtcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBjIHx8IE51bWJlcihjKSAhPSBjKSB7XG4gICAgICAgICAgICAgICAgICAgIC0taTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpID09PSBzdHIubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHAuaWQgPSBOdW1iZXIoc3RyLnN1YnN0cmluZyhzdGFydCwgaSArIDEpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBsb29rIHVwIGpzb24gZGF0YVxuICAgICAgICBpZiAoc3RyLmNoYXJBdCgrK2kpKSB7XG4gICAgICAgICAgICBjb25zdCBwYXlsb2FkID0gdGhpcy50cnlQYXJzZShzdHIuc3Vic3RyKGkpKTtcbiAgICAgICAgICAgIGlmIChEZWNvZGVyLmlzUGF5bG9hZFZhbGlkKHAudHlwZSwgcGF5bG9hZCkpIHtcbiAgICAgICAgICAgICAgICBwLmRhdGEgPSBwYXlsb2FkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaW52YWxpZCBwYXlsb2FkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwO1xuICAgIH1cbiAgICB0cnlQYXJzZShzdHIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHN0ciwgdGhpcy5yZXZpdmVyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBpc1BheWxvYWRWYWxpZCh0eXBlLCBwYXlsb2FkKSB7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkNPTk5FQ1Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlzT2JqZWN0KHBheWxvYWQpO1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkRJU0NPTk5FQ1Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBheWxvYWQgPT09IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5DT05ORUNUX0VSUk9SOlxuICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgcGF5bG9hZCA9PT0gXCJzdHJpbmdcIiB8fCBpc09iamVjdChwYXlsb2FkKTtcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5FVkVOVDpcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5CSU5BUllfRVZFTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChBcnJheS5pc0FycmF5KHBheWxvYWQpICYmXG4gICAgICAgICAgICAgICAgICAgICh0eXBlb2YgcGF5bG9hZFswXSA9PT0gXCJudW1iZXJcIiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgKHR5cGVvZiBwYXlsb2FkWzBdID09PSBcInN0cmluZ1wiICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVTRVJWRURfRVZFTlRTLmluZGV4T2YocGF5bG9hZFswXSkgPT09IC0xKSkpO1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkFDSzpcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5CSU5BUllfQUNLOlxuICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KHBheWxvYWQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlYWxsb2NhdGVzIGEgcGFyc2VyJ3MgcmVzb3VyY2VzXG4gICAgICovXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVjb25zdHJ1Y3Rvcikge1xuICAgICAgICAgICAgdGhpcy5yZWNvbnN0cnVjdG9yLmZpbmlzaGVkUmVjb25zdHJ1Y3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMucmVjb25zdHJ1Y3RvciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEEgbWFuYWdlciBvZiBhIGJpbmFyeSBldmVudCdzICdidWZmZXIgc2VxdWVuY2UnLiBTaG91bGRcbiAqIGJlIGNvbnN0cnVjdGVkIHdoZW5ldmVyIGEgcGFja2V0IG9mIHR5cGUgQklOQVJZX0VWRU5UIGlzXG4gKiBkZWNvZGVkLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXRcbiAqIEByZXR1cm4ge0JpbmFyeVJlY29uc3RydWN0b3J9IGluaXRpYWxpemVkIHJlY29uc3RydWN0b3JcbiAqL1xuY2xhc3MgQmluYXJ5UmVjb25zdHJ1Y3RvciB7XG4gICAgY29uc3RydWN0b3IocGFja2V0KSB7XG4gICAgICAgIHRoaXMucGFja2V0ID0gcGFja2V0O1xuICAgICAgICB0aGlzLmJ1ZmZlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5yZWNvblBhY2sgPSBwYWNrZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0byBiZSBjYWxsZWQgd2hlbiBiaW5hcnkgZGF0YSByZWNlaXZlZCBmcm9tIGNvbm5lY3Rpb25cbiAgICAgKiBhZnRlciBhIEJJTkFSWV9FVkVOVCBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0J1ZmZlciB8IEFycmF5QnVmZmVyfSBiaW5EYXRhIC0gdGhlIHJhdyBiaW5hcnkgZGF0YSByZWNlaXZlZFxuICAgICAqIEByZXR1cm4ge251bGwgfCBPYmplY3R9IHJldHVybnMgbnVsbCBpZiBtb3JlIGJpbmFyeSBkYXRhIGlzIGV4cGVjdGVkIG9yXG4gICAgICogICBhIHJlY29uc3RydWN0ZWQgcGFja2V0IG9iamVjdCBpZiBhbGwgYnVmZmVycyBoYXZlIGJlZW4gcmVjZWl2ZWQuXG4gICAgICovXG4gICAgdGFrZUJpbmFyeURhdGEoYmluRGF0YSkge1xuICAgICAgICB0aGlzLmJ1ZmZlcnMucHVzaChiaW5EYXRhKTtcbiAgICAgICAgaWYgKHRoaXMuYnVmZmVycy5sZW5ndGggPT09IHRoaXMucmVjb25QYWNrLmF0dGFjaG1lbnRzKSB7XG4gICAgICAgICAgICAvLyBkb25lIHdpdGggYnVmZmVyIGxpc3RcbiAgICAgICAgICAgIGNvbnN0IHBhY2tldCA9IHJlY29uc3RydWN0UGFja2V0KHRoaXMucmVjb25QYWNrLCB0aGlzLmJ1ZmZlcnMpO1xuICAgICAgICAgICAgdGhpcy5maW5pc2hlZFJlY29uc3RydWN0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm4gcGFja2V0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhbnMgdXAgYmluYXJ5IHBhY2tldCByZWNvbnN0cnVjdGlvbiB2YXJpYWJsZXMuXG4gICAgICovXG4gICAgZmluaXNoZWRSZWNvbnN0cnVjdGlvbigpIHtcbiAgICAgICAgdGhpcy5yZWNvblBhY2sgPSBudWxsO1xuICAgICAgICB0aGlzLmJ1ZmZlcnMgPSBbXTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js\n')},"./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js ***!
  \********************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hasBinary: () => (/* binding */ hasBinary),\n/* harmony export */   isBinary: () => (/* binding */ isBinary)\n/* harmony export */ });\nconst withNativeArrayBuffer = typeof ArrayBuffer === "function";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === "function"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === "function" ||\n    (typeof Blob !== "undefined" &&\n        toString.call(Blob) === "[object BlobConstructor]");\nconst withNativeFile = typeof File === "function" ||\n    (typeof File !== "undefined" &&\n        toString.call(File) === "[object FileConstructor]");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nfunction isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nfunction hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== "object") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === "function" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaXMtYmluYXJ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsT0FBTztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaXMtYmluYXJ5LmpzPzI0OWIiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgd2l0aE5hdGl2ZUFycmF5QnVmZmVyID0gdHlwZW9mIEFycmF5QnVmZmVyID09PSBcImZ1bmN0aW9uXCI7XG5jb25zdCBpc1ZpZXcgPSAob2JqKSA9PiB7XG4gICAgcmV0dXJuIHR5cGVvZiBBcnJheUJ1ZmZlci5pc1ZpZXcgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICA/IEFycmF5QnVmZmVyLmlzVmlldyhvYmopXG4gICAgICAgIDogb2JqLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyO1xufTtcbmNvbnN0IHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbmNvbnN0IHdpdGhOYXRpdmVCbG9iID0gdHlwZW9mIEJsb2IgPT09IFwiZnVuY3Rpb25cIiB8fFxuICAgICh0eXBlb2YgQmxvYiAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICB0b1N0cmluZy5jYWxsKEJsb2IpID09PSBcIltvYmplY3QgQmxvYkNvbnN0cnVjdG9yXVwiKTtcbmNvbnN0IHdpdGhOYXRpdmVGaWxlID0gdHlwZW9mIEZpbGUgPT09IFwiZnVuY3Rpb25cIiB8fFxuICAgICh0eXBlb2YgRmlsZSAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICB0b1N0cmluZy5jYWxsKEZpbGUpID09PSBcIltvYmplY3QgRmlsZUNvbnN0cnVjdG9yXVwiKTtcbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIG9iaiBpcyBhIEJ1ZmZlciwgYW4gQXJyYXlCdWZmZXIsIGEgQmxvYiBvciBhIEZpbGUuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQmluYXJ5KG9iaikge1xuICAgIHJldHVybiAoKHdpdGhOYXRpdmVBcnJheUJ1ZmZlciAmJiAob2JqIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIgfHwgaXNWaWV3KG9iaikpKSB8fFxuICAgICAgICAod2l0aE5hdGl2ZUJsb2IgJiYgb2JqIGluc3RhbmNlb2YgQmxvYikgfHxcbiAgICAgICAgKHdpdGhOYXRpdmVGaWxlICYmIG9iaiBpbnN0YW5jZW9mIEZpbGUpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBoYXNCaW5hcnkob2JqLCB0b0pTT04pIHtcbiAgICBpZiAoIW9iaiB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IG9iai5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChoYXNCaW5hcnkob2JqW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGlzQmluYXJ5KG9iaikpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmIChvYmoudG9KU09OICYmXG4gICAgICAgIHR5cGVvZiBvYmoudG9KU09OID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgICAgICAgYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICByZXR1cm4gaGFzQmluYXJ5KG9iai50b0pTT04oKSwgdHJ1ZSk7XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSAmJiBoYXNCaW5hcnkob2JqW2tleV0pKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js\n')},"./src/compatibility.ts":
/*!******************************!*\
  !*** ./src/compatibility.ts ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   findChar: () => (/* binding */ findChar),\n/* harmony export */   reloadEditor: () => (/* binding */ reloadEditor),\n/* harmony export */   reloadEditorDebounced: () => (/* binding */ reloadEditorDebounced)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_group_chats__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/group-chats */ \"@sillytavern/scripts/group-chats\");\n/* harmony import */ var _sillytavern_scripts_tags__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/tags */ \"@sillytavern/scripts/tags\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n// for compatibility with old sillytavern versions\n\n// @ts-ignore\n\n\n\n\n// for 1.12.6\n/**\n * Finds a character by name, with optional filtering and precedence for avatars\n * @param {object} [options={}] - The options for the search\n * @param {string?} [options.name=null] - The name to search for\n * @param {boolean} [options.allowAvatar=true] - Whether to allow searching by avatar\n * @param {boolean} [options.insensitive=true] - Whether the search should be case insensitive\n * @param {string[]?} [options.filteredByTags=null] - Tags to filter characters by\n * @param {boolean} [options.preferCurrentChar=true] - Whether to prefer the current character(s)\n * @param {boolean} [options.quiet=false] - Whether to suppress warnings\n * @returns {any?} - The found character or null if not found\n */\nfunction findChar({ name = null, allowAvatar = true, insensitive = true, filteredByTags = null, preferCurrentChar = true, quiet = false, } = {}) {\n    const matches = (char) => !name ||\n        (allowAvatar && char.avatar === name) ||\n        (insensitive ? (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_3__.equalsIgnoreCaseAndAccents)(char.name, name) : char.name === name);\n    // Filter characters by tags if provided\n    let filteredCharacters = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters;\n    if (filteredByTags) {\n        filteredCharacters = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters.filter(char => {\n            const charTags = (0,_sillytavern_scripts_tags__WEBPACK_IMPORTED_MODULE_2__.getTagsList)(char.avatar, false);\n            // @ts-ignore\n            return filteredByTags.every(tagName => charTags.some(x => x.name == tagName));\n        });\n    }\n    // Get the current character(s)\n    /** @type {any[]} */\n    // @ts-ignore\n    const currentChars = _sillytavern_scripts_group_chats__WEBPACK_IMPORTED_MODULE_1__.selected_group\n        ? // @ts-ignore\n            groups\n                // @ts-ignore\n                .find(group => group.id === _sillytavern_scripts_group_chats__WEBPACK_IMPORTED_MODULE_1__.selected_group)\n                // @ts-ignore\n                ?.members.map(member => filteredCharacters.find(char => char.avatar === member))\n        : // @ts-ignore\n            filteredCharacters.filter(char => _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.avatar === char.avatar);\n    // If we have a current char and prefer it, return that if it matches\n    if (preferCurrentChar) {\n        const preferredCharSearch = currentChars.filter(matches);\n        if (preferredCharSearch.length > 1) {\n            // @ts-ignore\n            if (!quiet)\n                toastr.warning('Multiple characters found for given conditions.');\n            else\n                console.warn('Multiple characters found for given conditions. Returning the first match.');\n        }\n        if (preferredCharSearch.length) {\n            return preferredCharSearch[0];\n        }\n    }\n    // If allowAvatar is true, search by avatar first\n    if (allowAvatar && name) {\n        const characterByAvatar = filteredCharacters.find(char => char.avatar === name);\n        if (characterByAvatar) {\n            return characterByAvatar;\n        }\n    }\n    // Search for matching characters by name\n    const matchingCharacters = name ? filteredCharacters.filter(matches) : filteredCharacters;\n    if (matchingCharacters.length > 1) {\n        // @ts-ignore\n        if (!quiet)\n            toastr.warning('Multiple characters found for given conditions.');\n        else\n            console.warn('Multiple characters found for given conditions. Returning the first match.');\n    }\n    return matchingCharacters[0] || null;\n}\n/**\n * Reloads the editor with the specified world info file\n * @param file The file to load in the editor\n * @param loadIfNotSelected Indicates whether to load the file even if it's not currently selected\n */\nfunction reloadEditor(file, load_if_not_selected = false) {\n    const current_index = Number($('#world_editor_select').val());\n    const selected_index = _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names.indexOf(file);\n    if (selected_index !== -1 && (load_if_not_selected || current_index === selected_index)) {\n        $('#world_editor_select').val(selected_index).trigger('change');\n    }\n}\nconst reloadEditorDebounced = _.debounce(reloadEditor, 1000);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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USxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wYXRpYmlsaXR5LnRzPzg1MGMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBvbGQgc2lsbHl0YXZlcm4gdmVyc2lvbnNcbmltcG9ydCB7IGNoYXJhY3RlcnMsIHRoaXNfY2hpZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuLy8gQHRzLWlnbm9yZVxuaW1wb3J0IHsgc2VsZWN0ZWRfZ3JvdXAgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9ncm91cC1jaGF0cyc7XG5pbXBvcnQgeyBnZXRUYWdzTGlzdCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3RhZ3MnO1xuaW1wb3J0IHsgZXF1YWxzSWdub3JlQ2FzZUFuZEFjY2VudHMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy91dGlscyc7XG5pbXBvcnQgeyB3b3JsZF9uYW1lcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3dvcmxkLWluZm8nO1xuXG4vLyBmb3IgMS4xMi42XG4vKipcbiAqIEZpbmRzIGEgY2hhcmFjdGVyIGJ5IG5hbWUsIHdpdGggb3B0aW9uYWwgZmlsdGVyaW5nIGFuZCBwcmVjZWRlbmNlIGZvciBhdmF0YXJzXG4gKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnM9e31dIC0gVGhlIG9wdGlvbnMgZm9yIHRoZSBzZWFyY2hcbiAqIEBwYXJhbSB7c3RyaW5nP30gW29wdGlvbnMubmFtZT1udWxsXSAtIFRoZSBuYW1lIHRvIHNlYXJjaCBmb3JcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuYWxsb3dBdmF0YXI9dHJ1ZV0gLSBXaGV0aGVyIHRvIGFsbG93IHNlYXJjaGluZyBieSBhdmF0YXJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuaW5zZW5zaXRpdmU9dHJ1ZV0gLSBXaGV0aGVyIHRoZSBzZWFyY2ggc2hvdWxkIGJlIGNhc2UgaW5zZW5zaXRpdmVcbiAqIEBwYXJhbSB7c3RyaW5nW10/fSBbb3B0aW9ucy5maWx0ZXJlZEJ5VGFncz1udWxsXSAtIFRhZ3MgdG8gZmlsdGVyIGNoYXJhY3RlcnMgYnlcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMucHJlZmVyQ3VycmVudENoYXI9dHJ1ZV0gLSBXaGV0aGVyIHRvIHByZWZlciB0aGUgY3VycmVudCBjaGFyYWN0ZXIocylcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMucXVpZXQ9ZmFsc2VdIC0gV2hldGhlciB0byBzdXBwcmVzcyB3YXJuaW5nc1xuICogQHJldHVybnMge2FueT99IC0gVGhlIGZvdW5kIGNoYXJhY3RlciBvciBudWxsIGlmIG5vdCBmb3VuZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZmluZENoYXIoe1xuICBuYW1lID0gbnVsbCxcbiAgYWxsb3dBdmF0YXIgPSB0cnVlLFxuICBpbnNlbnNpdGl2ZSA9IHRydWUsXG4gIGZpbHRlcmVkQnlUYWdzID0gbnVsbCxcbiAgcHJlZmVyQ3VycmVudENoYXIgPSB0cnVlLFxuICBxdWlldCA9IGZhbHNlLFxufSA9IHt9KSB7XG4gIGNvbnN0IG1hdGNoZXMgPSAoY2hhcjogYW55KSA9PlxuICAgICFuYW1lIHx8XG4gICAgKGFsbG93QXZhdGFyICYmIGNoYXIuYXZhdGFyID09PSBuYW1lKSB8fFxuICAgIChpbnNlbnNpdGl2ZSA/IGVxdWFsc0lnbm9yZUNhc2VBbmRBY2NlbnRzKGNoYXIubmFtZSwgbmFtZSkgOiBjaGFyLm5hbWUgPT09IG5hbWUpO1xuXG4gIC8vIEZpbHRlciBjaGFyYWN0ZXJzIGJ5IHRhZ3MgaWYgcHJvdmlkZWRcbiAgbGV0IGZpbHRlcmVkQ2hhcmFjdGVycyA9IGNoYXJhY3RlcnM7XG4gIGlmIChmaWx0ZXJlZEJ5VGFncykge1xuICAgIGZpbHRlcmVkQ2hhcmFjdGVycyA9IGNoYXJhY3RlcnMuZmlsdGVyKGNoYXIgPT4ge1xuICAgICAgY29uc3QgY2hhclRhZ3MgPSBnZXRUYWdzTGlzdChjaGFyLmF2YXRhciwgZmFsc2UpO1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgcmV0dXJuIGZpbHRlcmVkQnlUYWdzLmV2ZXJ5KHRhZ05hbWUgPT4gY2hhclRhZ3Muc29tZSh4ID0+IHgubmFtZSA9PSB0YWdOYW1lKSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBHZXQgdGhlIGN1cnJlbnQgY2hhcmFjdGVyKHMpXG4gIC8qKiBAdHlwZSB7YW55W119ICovXG4gIC8vIEB0cy1pZ25vcmVcbiAgY29uc3QgY3VycmVudENoYXJzID0gKHNlbGVjdGVkX2dyb3VwIGFzIGFueSlcbiAgICA/IC8vIEB0cy1pZ25vcmVcbiAgICAgIGdyb3Vwc1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIC5maW5kKGdyb3VwID0+IGdyb3VwLmlkID09PSBzZWxlY3RlZF9ncm91cClcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICA/Lm1lbWJlcnMubWFwKG1lbWJlciA9PiBmaWx0ZXJlZENoYXJhY3RlcnMuZmluZChjaGFyID0+IGNoYXIuYXZhdGFyID09PSBtZW1iZXIpKVxuICAgIDogLy8gQHRzLWlnbm9yZVxuICAgICAgZmlsdGVyZWRDaGFyYWN0ZXJzLmZpbHRlcihjaGFyID0+IGNoYXJhY3RlcnNbdGhpc19jaGlkXT8uYXZhdGFyID09PSBjaGFyLmF2YXRhcik7XG5cbiAgLy8gSWYgd2UgaGF2ZSBhIGN1cnJlbnQgY2hhciBhbmQgcHJlZmVyIGl0LCByZXR1cm4gdGhhdCBpZiBpdCBtYXRjaGVzXG4gIGlmIChwcmVmZXJDdXJyZW50Q2hhcikge1xuICAgIGNvbnN0IHByZWZlcnJlZENoYXJTZWFyY2ggPSBjdXJyZW50Q2hhcnMuZmlsdGVyKG1hdGNoZXMpO1xuICAgIGlmIChwcmVmZXJyZWRDaGFyU2VhcmNoLmxlbmd0aCA+IDEpIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGlmICghcXVpZXQpIHRvYXN0ci53YXJuaW5nKCdNdWx0aXBsZSBjaGFyYWN0ZXJzIGZvdW5kIGZvciBnaXZlbiBjb25kaXRpb25zLicpO1xuICAgICAgZWxzZSBjb25zb2xlLndhcm4oJ011bHRpcGxlIGNoYXJhY3RlcnMgZm91bmQgZm9yIGdpdmVuIGNvbmRpdGlvbnMuIFJldHVybmluZyB0aGUgZmlyc3QgbWF0Y2guJyk7XG4gICAgfVxuICAgIGlmIChwcmVmZXJyZWRDaGFyU2VhcmNoLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIHByZWZlcnJlZENoYXJTZWFyY2hbMF07XG4gICAgfVxuICB9XG5cbiAgLy8gSWYgYWxsb3dBdmF0YXIgaXMgdHJ1ZSwgc2VhcmNoIGJ5IGF2YXRhciBmaXJzdFxuICBpZiAoYWxsb3dBdmF0YXIgJiYgbmFtZSkge1xuICAgIGNvbnN0IGNoYXJhY3RlckJ5QXZhdGFyID0gZmlsdGVyZWRDaGFyYWN0ZXJzLmZpbmQoY2hhciA9PiBjaGFyLmF2YXRhciA9PT0gbmFtZSk7XG4gICAgaWYgKGNoYXJhY3RlckJ5QXZhdGFyKSB7XG4gICAgICByZXR1cm4gY2hhcmFjdGVyQnlBdmF0YXI7XG4gICAgfVxuICB9XG5cbiAgLy8gU2VhcmNoIGZvciBtYXRjaGluZyBjaGFyYWN0ZXJzIGJ5IG5hbWVcbiAgY29uc3QgbWF0Y2hpbmdDaGFyYWN0ZXJzID0gbmFtZSA/IGZpbHRlcmVkQ2hhcmFjdGVycy5maWx0ZXIobWF0Y2hlcykgOiBmaWx0ZXJlZENoYXJhY3RlcnM7XG4gIGlmIChtYXRjaGluZ0NoYXJhY3RlcnMubGVuZ3RoID4gMSkge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBpZiAoIXF1aWV0KSB0b2FzdHIud2FybmluZygnTXVsdGlwbGUgY2hhcmFjdGVycyBmb3VuZCBmb3IgZ2l2ZW4gY29uZGl0aW9ucy4nKTtcbiAgICBlbHNlIGNvbnNvbGUud2FybignTXVsdGlwbGUgY2hhcmFjdGVycyBmb3VuZCBmb3IgZ2l2ZW4gY29uZGl0aW9ucy4gUmV0dXJuaW5nIHRoZSBmaXJzdCBtYXRjaC4nKTtcbiAgfVxuXG4gIHJldHVybiBtYXRjaGluZ0NoYXJhY3RlcnNbMF0gfHwgbnVsbDtcbn1cblxuLyoqXG4gKiBSZWxvYWRzIHRoZSBlZGl0b3Igd2l0aCB0aGUgc3BlY2lmaWVkIHdvcmxkIGluZm8gZmlsZVxuICogQHBhcmFtIGZpbGUgVGhlIGZpbGUgdG8gbG9hZCBpbiB0aGUgZWRpdG9yXG4gKiBAcGFyYW0gbG9hZElmTm90U2VsZWN0ZWQgSW5kaWNhdGVzIHdoZXRoZXIgdG8gbG9hZCB0aGUgZmlsZSBldmVuIGlmIGl0J3Mgbm90IGN1cnJlbnRseSBzZWxlY3RlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVsb2FkRWRpdG9yKGZpbGU6IHN0cmluZywgbG9hZF9pZl9ub3Rfc2VsZWN0ZWQ6IGJvb2xlYW4gPSBmYWxzZSkge1xuICBjb25zdCBjdXJyZW50X2luZGV4ID0gTnVtYmVyKCQoJyN3b3JsZF9lZGl0b3Jfc2VsZWN0JykudmFsKCkpO1xuICBjb25zdCBzZWxlY3RlZF9pbmRleCA9IHdvcmxkX25hbWVzLmluZGV4T2YoZmlsZSk7XG4gIGlmIChzZWxlY3RlZF9pbmRleCAhPT0gLTEgJiYgKGxvYWRfaWZfbm90X3NlbGVjdGVkIHx8IGN1cnJlbnRfaW5kZXggPT09IHNlbGVjdGVkX2luZGV4KSkge1xuICAgICQoJyN3b3JsZF9lZGl0b3Jfc2VsZWN0JykudmFsKHNlbGVjdGVkX2luZGV4KS50cmlnZ2VyKCdjaGFuZ2UnKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcmVsb2FkRWRpdG9yRGVib3VuY2VkID0gXy5kZWJvdW5jZShyZWxvYWRFZGl0b3IsIDEwMDApO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/compatibility.ts\n")},"./src/component/audio/index.ts":
/*!**************************************!*\
  !*** ./src/component/audio/index.ts ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   defaultAudioSettings: () => (/* binding */ defaultAudioSettings),\n/* harmony export */   getAudioUrl: () => (/* binding */ getAudioUrl),\n/* harmony export */   getAudioUrlWithCacheBusting: () => (/* binding */ getAudioUrlWithCacheBusting),\n/* harmony export */   getNextFileByMode: () => (/* binding */ getNextFileByMode),\n/* harmony export */   initAudioComponents: () => (/* binding */ initAudioComponents),\n/* harmony export */   initAudioEventListeners: () => (/* binding */ initAudioEventListeners),\n/* harmony export */   initializeProgressBar: () => (/* binding */ initializeProgressBar),\n/* harmony export */   list_BGMS: () => (/* binding */ list_BGMS),\n/* harmony export */   list_ambients: () => (/* binding */ list_ambients),\n/* harmony export */   onAudioEnabledClick: () => (/* binding */ onAudioEnabledClick),\n/* harmony export */   playAudio: () => (/* binding */ playAudio),\n/* harmony export */   refreshAudioResources: () => (/* binding */ refreshAudioResources),\n/* harmony export */   toggleAudioControls: () => (/* binding */ toggleAudioControls),\n/* harmony export */   togglePlayPause: () => (/* binding */ togglePlayPause),\n/* harmony export */   updateAudio: () => (/* binding */ updateAudio),\n/* harmony export */   updateAudioSelect: () => (/* binding */ updateAudioSelect)\n/* harmony export */ });\n/* harmony import */ var _util_collapsible__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/collapsible */ \"./src/util/collapsible.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/RossAscends-mods */ \"@sillytavern/scripts/RossAscends-mods\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n\n\n\n\n\n\n\nlet isExtensionEnabled;\nlet isAudioEnabled;\nlet list_BGMS = [];\nlet list_ambients = [];\nlet bgmEnded = true;\nlet ambientEnded = true;\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.extensionFolderPath}/src/component/audio`;\n// \nconst defaultAudioSettings = {\n    audio_enabled: true,\n    bgm_enabled: true,\n    ambient_enabled: true,\n    bgm_mode: 'repeat',\n    bgm_muted: false,\n    bgm_volume: 50,\n    bgm_selected: null,\n    bgm_current_time: 0,\n    ambient_mode: 'stop',\n    ambient_muted: false,\n    ambient_volume: 50,\n    ambient_selected: null,\n    ambient_current_time: 0,\n    audio_cooldown: 0,\n};\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n * @param isUserInput -\n */\nasync function updateAudio(type = 'bgm', isUserInput = false) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled')) {\n        return;\n    }\n    const isTypeEnabled = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_enabled') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_enabled');\n    if (!isTypeEnabled) {\n        return;\n    }\n    const audioEnded = type === 'bgm' ? bgmEnded : ambientEnded;\n    const audioSelector = `#audio_${type}`;\n    if (!isUserInput && $(audioSelector).attr('src') != '' && !audioEnded) {\n        return;\n    }\n    let audio_url = '';\n    const playlist = await getAudioUrl(type);\n    if (isUserInput) {\n        audio_url =\n            type === 'bgm'\n                ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected') || playlist[0]\n                : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected') || playlist[0];\n    }\n    else {\n        const mode = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_mode') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_mode');\n        const selected = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected');\n        audio_url = getNextFileByMode(mode, playlist, selected);\n    }\n    if (!audio_url) {\n        return;\n    }\n    const audio = $(audioSelector)[0];\n    // ambient\n    if (type === 'ambient') {\n        const cleanAudioSrc = audio.src.split('?')[0];\n        const cleanAudioUrl = audio_url.split('?')[0];\n        if (decodeURIComponent(cleanAudioSrc) === decodeURIComponent(cleanAudioUrl) && !audioEnded) {\n            return;\n        }\n    }\n    else if (decodeURIComponent(audio.src) === decodeURIComponent(audio_url) && !audioEnded) {\n        return;\n    }\n    // audioEnded\n    if (type === 'bgm') {\n        bgmEnded = false;\n    }\n    else {\n        ambientEnded = false;\n    }\n    if (type === 'bgm') {\n        audio.src = audio_url;\n        audio.load();\n        await new Promise(resolve => {\n            const canPlayHandler = () => {\n                audio.removeEventListener('canplaythrough', canPlayHandler);\n                resolve();\n            };\n            if (audio.readyState >= HTMLMediaElement.HAVE_ENOUGH_DATA) {\n                resolve();\n            }\n            else {\n                audio.addEventListener('canplaythrough', canPlayHandler);\n            }\n        });\n        await playAudio(type);\n    }\n    else {\n        // ambient\n        const audioUrlWithCacheBusting = getAudioUrlWithCacheBusting(audio_url);\n        audio.src = audioUrlWithCacheBusting;\n        audio.load();\n        await new Promise(resolve => {\n            const canPlayHandler = () => {\n                audio.removeEventListener('canplaythrough', canPlayHandler);\n                resolve();\n            };\n            if (audio.readyState >= HTMLMediaElement.HAVE_ENOUGH_DATA) {\n                resolve();\n            }\n            else {\n                audio.addEventListener('canplaythrough', canPlayHandler);\n            }\n        });\n        await playAudio(type);\n    }\n    // \n    if (type === 'bgm') {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', audio_url);\n    }\n    else {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', audio_url);\n    }\n    // \n    const selectElement = $(`#audio_${type}_select`);\n    if (selectElement.val() !== audio_url) {\n        selectElement.val(audio_url);\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettingsDebounced)();\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n */\nasync function updateAudioSelect(type = 'bgm') {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_enabled`)) {\n        return;\n    }\n    const selectElement = $(`#audio_${type}_select`);\n    selectElement.empty();\n    if (type === 'bgm') {\n        list_BGMS = await getAudioUrl('bgm');\n    }\n    else {\n        list_ambients = await getAudioUrl('ambient');\n    }\n    const audioList = type === 'bgm' ? list_BGMS : list_ambients;\n    let selectedSetting = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected');\n    if (audioList && audioList.length > 0) {\n        // \n        if (!audioList.includes(selectedSetting)) {\n            console.warn(`[Audio]  ${selectedSetting} `);\n            selectedSetting = audioList[0];\n            if (type === 'bgm') {\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', selectedSetting);\n            }\n            else {\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', selectedSetting);\n            }\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettingsDebounced)();\n        }\n        const audioFiles = Array.isArray(audioList) ? audioList : audioList.split(',').map(file => file.trim());\n        audioFiles.forEach((file) => {\n            const fileLabel = file.replace(/^.*[\\\\\\/]/, '').replace(/\\.[^/.]+$/, '');\n            selectElement.append(new Option(fileLabel, file));\n        });\n        selectElement.val(selectedSetting);\n    }\n    else {\n        console.log(`[Audio]  ${type.toUpperCase()} `);\n    }\n}\n/**\n * URL\n * @param type  \"bgm\"  \"ambient\"\n * @returns URL\n */\nasync function getAudioUrl(type = 'bgm') {\n    const typeKey = type === 'bgm' ? 'bgmurl' : 'ambienturl';\n    //@ts-ignore\n    const chatSpecificUrls = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables?.[typeKey] || [];\n    return chatSpecificUrls;\n}\n/**\n * \n * @param originalUrl URL\n */\nfunction getAudioUrlWithCacheBusting(originalUrl) {\n    if (!originalUrl)\n        return '';\n    const cacheBuster = new Date().getTime();\n    const separator = originalUrl.includes('?') ? '&' : '?';\n    return `${originalUrl}${separator}_=${cacheBuster}`;\n}\n/**\n * \n * @param mode \n * @param playlist \n * @param currentFile \n */\nfunction getNextFileByMode(mode, playlist, currentFile) {\n    if (!playlist || playlist.length === 0) {\n        return '';\n    }\n    switch (mode) {\n        case 'repeat':\n            return playlist[0];\n        case 'single':\n            return currentFile || playlist[0];\n        case 'random': {\n            const filteredPlaylist = playlist.filter(file => file !== currentFile);\n            if (filteredPlaylist.length === 0) {\n                return playlist[0];\n            }\n            const randomIndex = Math.floor(Math.random() * filteredPlaylist.length);\n            return filteredPlaylist[randomIndex];\n        }\n        case 'stop':\n            return '';\n        default:\n            return playlist[0];\n    }\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n * @param status \n */\nfunction toggleAudioControls(type, status = 'enable') {\n    const isMainEnabled = $('#audio_enabled').prop('checked');\n    const shouldEnable = isMainEnabled && status === 'enable';\n    const controlIds = [\n        `#audio_${type}_play_pause`,\n        `#audio_${type}_mute`,\n        `#audio_${type}_mode`,\n        `#audio_${type}_select`,\n        `#audio_${type}_volume_slider`,\n    ];\n    controlIds.forEach(id => {\n        $(id).prop('disabled', !shouldEnable);\n    });\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n */\nasync function onAudioEnabledClick(type = 'bgm') {\n    const enabled = $(`#enable_${type}`).prop('checked');\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_enabled`, enabled);\n    if (enabled) {\n        toggleAudioControls(type, 'enable');\n        await updateAudio(type, false);\n    }\n    else {\n        $(`#audio_${type}`)[0].pause();\n        toggleAudioControls(type, 'disable');\n    }\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n */\nfunction initAudioEventListeners(type) {\n    $(`#audio_${type}`).on('ended', async function () {\n        if (type === 'bgm') {\n            bgmEnded = true;\n        }\n        else {\n            ambientEnded = true;\n        }\n        const mode = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_mode`);\n        if (mode === 'stop') {\n            return;\n        }\n        await updateAudio(type, false);\n    });\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n */\nfunction initializeProgressBar(type) {\n    const $audioElement = $(`#audio_${type}`);\n    const $progressSlider = $(`#audio_${type}_progress_slider`);\n    $audioElement.on('timeupdate', function () {\n        if (!isNaN(this.duration)) {\n            const progressPercent = (this.currentTime / this.duration) * 100;\n            $progressSlider.val(progressPercent);\n        }\n        const cooldownBGM = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_cooldown');\n        const remainingTime = this.duration - this.currentTime;\n        if (cooldownBGM > 0 && remainingTime <= cooldownBGM && !this.isFadingOut) {\n            const initialVolume = this.volume;\n            const fadeStep = initialVolume / (cooldownBGM * 10);\n            this.isFadingOut = true;\n            const fadeOutInterval = setInterval(() => {\n                if (this.volume > 0) {\n                    this.volume = Math.max(0, this.volume - fadeStep);\n                }\n                else {\n                    clearInterval(fadeOutInterval);\n                    this.isFadingOut = false;\n                }\n            }, 100);\n        }\n    });\n    $audioElement.on('play', function () {\n        const cooldownBGM = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_cooldown');\n        const targetVolume = $(`#audio_${type}_volume_slider`).val() / 100;\n        if (cooldownBGM <= 0) {\n            this.volume = targetVolume;\n            return;\n        }\n        this.volume = 0;\n        const fadeStep = targetVolume / (cooldownBGM * 10);\n        const fadeInInterval = setInterval(() => {\n            if (this.volume < targetVolume) {\n                this.volume = Math.min(targetVolume, this.volume + fadeStep);\n            }\n            else {\n                clearInterval(fadeInInterval);\n            }\n        }, 100);\n    });\n    $audioElement.on('loadedmetadata', function () {\n        if (!isNaN(this.duration)) {\n            $progressSlider.attr('max', 100);\n        }\n    });\n    $progressSlider.on('input', function () {\n        const value = $(this).val();\n        if (!isNaN($audioElement[0].duration)) {\n            $audioElement[0].currentTime = (value / 100) * $audioElement[0].duration;\n        }\n    });\n}\n/**\n * \n * @param e \n */\nfunction onVolumeSliderWheelEvent(e) {\n    const slider = $(this);\n    e.preventDefault();\n    e.stopPropagation();\n    const delta = e.deltaY / 20;\n    const sliderVal = Number(slider.val());\n    let newVal = sliderVal - delta;\n    if (newVal < 0) {\n        newVal = 0;\n    }\n    else if (newVal > 100) {\n        newVal = 100;\n    }\n    slider.val(newVal).trigger('input');\n}\n/**\n * \n * @param volumeControlId ID\n * @param iconId ID\n */\nfunction handleLongPress(volumeControlId, iconId) {\n    const $volumeControl = $(`#${volumeControlId}`);\n    const $icon = $(`#${iconId}`);\n    let pressTimer;\n    if ((0,_sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_5__.isMobile)()) {\n        $icon.on('touchstart', function (e) {\n            pressTimer = setTimeout(() => {\n                $volumeControl.css('display', 'block');\n            }, 500);\n        });\n        $icon.on('touchend', function (e) {\n            clearTimeout(pressTimer);\n        });\n        $(document).on('click', function (event) {\n            if (!$icon.is(event.target) &&\n                $icon.has(event.target).length === 0 &&\n                !$volumeControl.is(event.target) &&\n                $volumeControl.has(event.target).length === 0) {\n                $volumeControl.css('display', 'none');\n            }\n        });\n    }\n}\n/**\n * \n */\nasync function refreshAudioResources() {\n    updateAudioSelect('bgm');\n    updateAudioSelect('ambient');\n}\n/**\n * \n * @param typeKey  \"bgmurl\"  \"ambienturl\"\n */\nasync function openUrlManagerPopup(typeKey) {\n    const urlManager = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.renderExtensionTemplateAsync)(`${templatePath}`, 'audio_url_manager'));\n    urlManager.prepend(`\n    <style>\n      #saved_audio_url.empty::after {\n        content: \"\";\n        color: #999;\n        margin-top: 20px;\n        font-size: 12px;\n      }\n    </style>\n  `);\n    const savedAudioUrl = urlManager.find('#saved_audio_url').empty();\n    const urlTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.renderExtensionTemplateAsync)(`${templatePath}`, 'audio_url_template'));\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables) {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables = {};\n    }\n    let urlValue = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey];\n    if (!urlValue) {\n        urlValue = [];\n        savedAudioUrl.addClass('empty');\n    }\n    else {\n        try {\n            if (urlValue.length === 0) {\n                savedAudioUrl.addClass('empty');\n            }\n        }\n        catch (error) {\n            console.error(`[Audio] Failed to parse ${typeKey}:`, error);\n            return null;\n        }\n    }\n    const updatedUrls = {};\n    let newUrlOrder = [...urlValue];\n    function renderUrl(container, url) {\n        const urlHtml = urlTemplate.clone();\n        let fileName;\n        if (url.includes('/')) {\n            const parts = url.split('/');\n            fileName = parts[parts.length - 1] || parts[parts.length - 2];\n        }\n        else {\n            fileName = url;\n        }\n        const id = fileName.replace(/\\./g, '-');\n        urlHtml.attr('id', id);\n        urlHtml.find('.audio_url_name').text(fileName);\n        urlHtml.find('.audio_url_name').attr('data-url', url);\n        urlHtml.find('.edit_existing_url').on('click', async function () {\n            const currentUrl = urlHtml.find('.audio_url_name').attr('data-url');\n            if (!currentUrl) {\n                console.error('[Audio] No URL found for this element.');\n                return;\n            }\n            const inputUrl = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)('', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.INPUT, currentUrl);\n            if (!inputUrl) {\n                return;\n            }\n            const newFileName = inputUrl.split('/').pop();\n            const newId = newFileName.replace(/\\./g, '-');\n            urlHtml.attr('id', newId);\n            urlHtml.find('.audio_url_name').text(newFileName);\n            urlHtml.find('.audio_url_name').attr('data-url', inputUrl);\n            updatedUrls[currentUrl] = inputUrl;\n        });\n        urlHtml.find('.delete_url').on('click', async function () {\n            const confirmDelete = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)('?', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.CONFIRM);\n            if (!confirmDelete) {\n                return;\n            }\n            // DOM\n            urlHtml.remove();\n            // \n            if (savedAudioUrl.find('.audio_url_name').length === 0) {\n                savedAudioUrl.addClass('empty');\n            }\n        });\n        container.append(urlHtml);\n    }\n    urlValue.forEach(url => {\n        renderUrl(savedAudioUrl, url);\n    });\n    urlManager.find('#import_button').on('click', async function () {\n        const newUrls = await openUrlImportPopup();\n        if (!newUrls) {\n            console.debug(`[Audio] ${typeKey} URL`);\n            return;\n        }\n        savedAudioUrl.removeClass('empty');\n        newUrls.forEach(url => {\n            renderUrl(savedAudioUrl, url);\n        });\n    });\n    savedAudioUrl.sortable({\n        delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_6__.getSortableDelay)(),\n        handle: '.drag-handle',\n        stop: function () {\n            newUrlOrder = [];\n            savedAudioUrl.find('.audio_url_name').each(function () {\n                const newUrl = $(this).attr('data-url');\n                if (newUrl) {\n                    newUrlOrder.push(newUrl);\n                }\n            });\n        },\n    });\n    const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)(urlManager, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.CONFIRM, '', {\n        okButton: ``,\n        cancelButton: ``,\n    });\n    if (!result) {\n        return;\n    }\n    else {\n        // data-urlURL\n        const newUrlList = [];\n        savedAudioUrl.find('.audio_url_name').each(function () {\n            const url = $(this).attr('data-url');\n            if (url) {\n                newUrlList.push(url);\n            }\n        });\n        // \n        const currentBgmUrl = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected');\n        const currentAmbientUrl = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected');\n        // \n        if (typeKey === 'bgmurl' && currentBgmUrl && !newUrlList.includes(currentBgmUrl)) {\n            const bgmAudio = $('#audio_bgm')[0];\n            bgmAudio.pause();\n            bgmEnded = true;\n        }\n        else if (typeKey === 'ambienturl' && currentAmbientUrl && !newUrlList.includes(currentAmbientUrl)) {\n            const ambientAudio = $('#audio_ambient')[0];\n            ambientAudio.pause();\n            ambientEnded = true;\n        }\n        // URL\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] = newUrlList;\n        (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.saveMetadataDebounced)();\n        if (typeKey === 'bgmurl') {\n            updateAudioSelect('bgm');\n        }\n        else if (typeKey === 'ambienturl') {\n            updateAudioSelect('ambient');\n        }\n    }\n}\n/**\n * \n */\nasync function handleAudioToggle(enable = true, userInput = true) {\n    if (userInput) {\n        isAudioEnabled = enable;\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.audio_enabled', isAudioEnabled);\n    }\n    if (enable) {\n        $('#audio-player-content').removeClass('audio-disabled-mask');\n        if (isExtensionEnabled === undefined) {\n            isExtensionEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('enabled_extension');\n        }\n        if (!isExtensionEnabled) {\n            return;\n        }\n        toggleAudioControls('bgm', 'enable');\n        toggleAudioControls('ambient', 'enable');\n        const bgmUrl = await getAudioUrl('bgm');\n        const ambientUrl = await getAudioUrl('ambient');\n        if (bgmUrl.length > 0) {\n            const bgmAudioElement = $('#audio_bgm')[0];\n            try {\n                await bgmAudioElement.play();\n            }\n            catch (error) {\n                throw new Error('[Audio] ');\n            }\n        }\n        if (ambientUrl.length > 0) {\n            const ambientAudioElement = $('#audio_ambient')[0];\n            try {\n                await ambientAudioElement.play();\n            }\n            catch (error) {\n                throw new Error('[Audio] ');\n            }\n        }\n    }\n    else {\n        $('#audio-player-content').addClass('audio-disabled-mask');\n        $('#audio_bgm')[0].pause();\n        $('#audio_ambient')[0].pause();\n        toggleAudioControls('bgm', 'disable');\n        toggleAudioControls('ambient', 'disable');\n    }\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n */\nasync function playAudio(type) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('enabled_extension') ||\n        !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled') ||\n        !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_enabled`)) {\n        return;\n    }\n    const audioElement = $(`#audio_${type}`)[0];\n    const playPauseIcon = $(`#audio_${type}_play_pause_icon`);\n    if (audioElement.error && audioElement.error.code === 4) {\n        console.warn(`The ${type} element has no supported sources. Trying to reload selected audio from dropdown...`);\n        const selectedAudio = $(`#audio_${type}_select`).val();\n        if (!selectedAudio) {\n            console.error(`No audio selected for ${type}`);\n            return;\n        }\n        audioElement.src = selectedAudio;\n        audioElement.load();\n    }\n    try {\n        await audioElement.play();\n        playPauseIcon.removeClass('fa-play');\n        playPauseIcon.addClass('fa-pause');\n    }\n    catch (error) {\n        console.error(`[Audio]  ${type} :`, error);\n    }\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n */\nasync function onAudioModeClick(type) {\n    const modes = [\n        { mode: 'repeat', icon: 'fa-repeat' },\n        { mode: 'random', icon: 'fa-random' },\n        { mode: 'single', icon: 'fa-redo-alt' },\n        { mode: 'stop', icon: 'fa-cancel' },\n    ];\n    const currentModeIndex = modes.findIndex(m => m.mode === (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_mode`));\n    const nextModeIndex = (currentModeIndex + 1) % modes.length;\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_mode`, modes[nextModeIndex].mode);\n    $(`#audio_${type}_mode_icon`).removeClass('fa-repeat fa-random fa-redo-alt fa-cancel');\n    $(`#audio_${type}_mode_icon`).addClass(modes[nextModeIndex].icon);\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n */\nasync function onAudioSelectChange(type) {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_selected`, $(`#audio_${type}_select`).val());\n    await updateAudio(type, true);\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n */\nasync function onAudioCooldownInput() {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.audio_cooldown', ~~$(`#audio_cooldown`).val());\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n */\nasync function onAudioVolumeChange(type) {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_volume`, ~~$(`#audio_${type}_volume_slider`).val());\n    $(`#audio_${type}`).prop('volume', (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_volume`) * 0.01);\n    $(`#audio_${type}_volume`).text((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_volume`));\n}\n/**\n * \n * @param type  \"bgm\"  \"ambient\"\n */\nasync function onAudioMuteClick(type) {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_muted`, !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_muted`));\n    $(`#audio_${type}_mute_icon`).toggleClass('fa-volume-high');\n    $(`#audio_${type}_mute_icon`).toggleClass('fa-volume-mute');\n    $(`#audio_${type}`).prop('muted', !$(`#audio_${type}`).prop('muted'));\n    $(`#audio_${type}_mute`).toggleClass('redOverlayGlow');\n}\n/**\n * /\n * @param type  \"bgm\"  \"ambient\"\n */\nasync function togglePlayPause(type) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled')) {\n        return;\n    }\n    const audioElement = $(`#audio_${type}`)[0];\n    const playPauseIcon = $(`#audio_${type}_play_pause_icon`);\n    if (audioElement.paused) {\n        await playAudio(type);\n    }\n    else {\n        audioElement.pause();\n        playPauseIcon.removeClass('fa-pause');\n        playPauseIcon.addClass('fa-play');\n    }\n}\n/**\n * URL\n * @param type \n */\nasync function openUrlImportPopup() {\n    const input = (await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)('', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.INPUT, ''));\n    if (!input) {\n        console.debug('[Audio] URL import cancelled');\n        return null;\n    }\n    const urlArray = input\n        .trim()\n        .split('\\n')\n        .map((url) => url.trim())\n        .filter((url) => url !== '');\n    return Array.from(new Set(urlArray));\n}\n// \n_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.event_types.CHAT_CHANGED, async () => {\n    const $bgmPlayer = $('#audio_bgm')[0];\n    const $ambientPlayer = $('#audio_ambient')[0];\n    if ($bgmPlayer && !$bgmPlayer.paused) {\n        $bgmPlayer.pause();\n    }\n    if ($ambientPlayer && !$ambientPlayer.paused) {\n        $ambientPlayer.pause();\n    }\n    await refreshAudioResources();\n    console.log('[Audio] ');\n});\n/** \n * @param type  \"bgm\"  \"ambient\"\n */\nfunction initAudioStyles(type) {\n    // \n    $(`#audio_${type}`).hide();\n    if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_muted`)) {\n        $(`#audio_${type}_mute_icon`).removeClass('fa-volume-high');\n        $(`#audio_${type}_mute_icon`).addClass('fa-volume-mute');\n        $(`#audio_${type}_mute`).addClass('redOverlayGlow');\n        $(`#audio_${type}`).prop('muted', true);\n    }\n    else {\n        $(`#audio_${type}_mute_icon`).addClass('fa-volume-high');\n        $(`#audio_${type}_mute_icon`).removeClass('fa-volume-mute');\n        $(`#audio_${type}_mute`).removeClass('redOverlayGlow');\n        $(`#audio_${type}`).prop('muted', false);\n    }\n    $(`#enable_${type}`).prop('checked', (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_enabled`));\n    const audioElement = $(`#audio_${type}`)[0];\n    const playPauseIcon = $(`#audio_${type}_play_pause_icon`);\n    if (audioElement && audioElement.paused) {\n        playPauseIcon.removeClass('fa-pause');\n        playPauseIcon.addClass('fa-play');\n    }\n    else if (audioElement && !audioElement.paused) {\n        playPauseIcon.removeClass('fa-play');\n        playPauseIcon.addClass('fa-pause');\n    }\n    updateAudioSelect(type);\n    initializeProgressBar(type);\n}\n/**\n * \n */\nasync function initAudioComponents() {\n    // \n    await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_6__.loadFileToDocument)(`/scripts/extensions/${_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.extensionFolderPath}/src/component/audio/style.css`, 'css');\n    isAudioEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled');\n    handleAudioToggle(isAudioEnabled, false);\n    $('#audio-enable-toggle')\n        .prop('checked', isAudioEnabled)\n        .on('click', (event) => handleAudioToggle(event.target.checked, true));\n    // \n    _util_collapsible__WEBPACK_IMPORTED_MODULE_0__.Collapsible.initAll('#audio-player-header', {\n        headerSelector: '#audio-player-header',\n        contentSelector: '#audio-player-content',\n        initiallyExpanded: true,\n        animationDuration: {\n            expand: 280,\n            collapse: 250,\n        },\n    });\n    // \n    initAudioStyles('bgm');\n    initAudioStyles('ambient');\n    const audioTypes = ['bgm', 'ambient'];\n    const bindTypeEvents = (type, events) => {\n        events.forEach(({ selector, event, handler }) => {\n            $(`#${selector}`).on(event, () => handler(type));\n        });\n    };\n    audioTypes.forEach(type => {\n        $(`#enable_${type}`).on('click', () => onAudioEnabledClick(type));\n        bindTypeEvents(type, [\n            {\n                selector: `enable_${type}`,\n                event: 'click',\n                handler: onAudioEnabledClick,\n            },\n            {\n                selector: `audio_${type}_mode`,\n                event: 'click',\n                handler: onAudioModeClick,\n            },\n            {\n                selector: `audio_${type}_mute`,\n                event: 'click',\n                handler: onAudioMuteClick,\n            },\n            {\n                selector: `audio_${type}_volume_slider`,\n                event: 'input',\n                handler: onAudioVolumeChange,\n            },\n            {\n                selector: `audio_${type}_select`,\n                event: 'change',\n                handler: onAudioSelectChange,\n            },\n            {\n                selector: `audio_${type}_play_pause`,\n                event: 'click',\n                handler: togglePlayPause,\n            },\n        ]);\n        $('#audio_cooldown').on('input', onAudioCooldownInput).val((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_cooldown'));\n        // \n        initAudioEventListeners('bgm');\n        initAudioEventListeners('ambient');\n        const volumeSlider = $(`#audio_${type}_volume_slider`).get(0);\n        if (volumeSlider) {\n            volumeSlider.addEventListener('wheel', onVolumeSliderWheelEvent, {\n                passive: false,\n            });\n        }\n    });\n    $('#audio_refresh_assets').on('click', async () => {\n        await refreshAudioResources();\n    });\n    handleLongPress('bgm-volume-control', 'audio_bgm_mute_icon');\n    handleLongPress('ambient-volume-control', 'audio_ambient_mute_icon');\n    const urlManagerMap = {\n        bgm: 'bgmurl',\n        ambient: 'ambienturl',\n    };\n    audioTypes.forEach(type => {\n        $(`#${type}_manager_button`).on('click', async () => {\n            await openUrlManagerPopup(urlManagerMap[type]);\n            await refreshAudioResources();\n        });\n    });\n    const bgmAudio = $('#audio_bgm')[0];\n    const ambientAudio = $('#audio_ambient')[0];\n    const togglePlayPauseIcon = (audioElement, iconSelector) => {\n        const icon = $(iconSelector);\n        audioElement.addEventListener('play', () => icon.removeClass('fa-play').addClass('fa-pause'));\n        audioElement.addEventListener('pause', () => icon.removeClass('fa-pause').addClass('fa-play'));\n    };\n    togglePlayPauseIcon(bgmAudio, '#audio_bgm_play_pause_icon');\n    togglePlayPauseIcon(ambientAudio, '#audio_ambient_play_pause_icon');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L2F1ZGlvL2luZGV4LnRzPzU1YzIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29sbGFwc2libGUgfSBmcm9tICdAL3V0aWwvY29sbGFwc2libGUnO1xuaW1wb3J0IHsgZXh0ZW5zaW9uRm9sZGVyUGF0aCwgZ2V0U2V0dGluZ1ZhbHVlLCBzYXZlU2V0dGluZ1ZhbHVlIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuXG5pbXBvcnQgeyBjaGF0X21ldGFkYXRhLCBldmVudFNvdXJjZSwgZXZlbnRfdHlwZXMsIHNhdmVTZXR0aW5nc0RlYm91bmNlZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYywgc2F2ZU1ldGFkYXRhRGVib3VuY2VkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyBQT1BVUF9UWVBFLCBjYWxsR2VuZXJpY1BvcHVwIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG9wdXAnO1xuaW1wb3J0IHsgaXNNb2JpbGUgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9Sb3NzQXNjZW5kcy1tb2RzJztcbmltcG9ydCB7IGdldFNvcnRhYmxlRGVsYXksIGxvYWRGaWxlVG9Eb2N1bWVudCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxubGV0IGlzRXh0ZW5zaW9uRW5hYmxlZDogYm9vbGVhbjtcbmxldCBpc0F1ZGlvRW5hYmxlZDogYm9vbGVhbjtcbmV4cG9ydCBsZXQgbGlzdF9CR01TOiBzdHJpbmdbXSA9IFtdO1xuZXhwb3J0IGxldCBsaXN0X2FtYmllbnRzOiBzdHJpbmdbXSA9IFtdO1xubGV0IGJnbUVuZGVkID0gdHJ1ZTtcbmxldCBhbWJpZW50RW5kZWQgPSB0cnVlO1xuXG5jb25zdCB0ZW1wbGF0ZVBhdGggPSBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L2F1ZGlvYDtcbi8vIOWumuS5iem7mOiupOmfs+mikeiuvue9rlxuZXhwb3J0IGNvbnN0IGRlZmF1bHRBdWRpb1NldHRpbmdzID0ge1xuICBhdWRpb19lbmFibGVkOiB0cnVlLFxuICBiZ21fZW5hYmxlZDogdHJ1ZSxcbiAgYW1iaWVudF9lbmFibGVkOiB0cnVlLFxuICBiZ21fbW9kZTogJ3JlcGVhdCcsXG4gIGJnbV9tdXRlZDogZmFsc2UsXG4gIGJnbV92b2x1bWU6IDUwLFxuICBiZ21fc2VsZWN0ZWQ6IG51bGwsXG4gIGJnbV9jdXJyZW50X3RpbWU6IDAsXG4gIGFtYmllbnRfbW9kZTogJ3N0b3AnLFxuICBhbWJpZW50X211dGVkOiBmYWxzZSxcbiAgYW1iaWVudF92b2x1bWU6IDUwLFxuICBhbWJpZW50X3NlbGVjdGVkOiBudWxsLFxuICBhbWJpZW50X2N1cnJlbnRfdGltZTogMCxcbiAgYXVkaW9fY29vbGRvd246IDAsXG59O1xuXG4vKipcbiAqIOabtOaWsOmfs+mikVxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKiBAcGFyYW0gaXNVc2VySW5wdXQg5piv5ZCm55Sx55So5oi35pON5L2c6Kem5Y+RLeWwhuWvvOiHtOmfs+mikeS4reaWrVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQXVkaW8odHlwZSA9ICdiZ20nLCBpc1VzZXJJbnB1dCA9IGZhbHNlKSB7XG4gIGlmICghZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19lbmFibGVkJykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBpc1R5cGVFbmFibGVkID1cbiAgICB0eXBlID09PSAnYmdtJyA/IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX2VuYWJsZWQnKSA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9lbmFibGVkJyk7XG5cbiAgaWYgKCFpc1R5cGVFbmFibGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGF1ZGlvRW5kZWQgPSB0eXBlID09PSAnYmdtJyA/IGJnbUVuZGVkIDogYW1iaWVudEVuZGVkO1xuICBjb25zdCBhdWRpb1NlbGVjdG9yID0gYCNhdWRpb18ke3R5cGV9YDtcblxuICBpZiAoIWlzVXNlcklucHV0ICYmICQoYXVkaW9TZWxlY3RvcikuYXR0cignc3JjJykgIT0gJycgJiYgIWF1ZGlvRW5kZWQpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgYXVkaW9fdXJsID0gJyc7XG4gIGNvbnN0IHBsYXlsaXN0ID0gYXdhaXQgZ2V0QXVkaW9VcmwodHlwZSBhcyAnYmdtJyB8ICdhbWJpZW50Jyk7XG5cbiAgaWYgKGlzVXNlcklucHV0KSB7XG4gICAgYXVkaW9fdXJsID1cbiAgICAgIHR5cGUgPT09ICdiZ20nXG4gICAgICAgID8gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnKSB8fCBwbGF5bGlzdFswXVxuICAgICAgICA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcpIHx8IHBsYXlsaXN0WzBdO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IG1vZGUgPSB0eXBlID09PSAnYmdtJyA/IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX21vZGUnKSA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9tb2RlJyk7XG5cbiAgICBjb25zdCBzZWxlY3RlZCA9IHR5cGUgPT09ICdiZ20nID8gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnKSA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcpO1xuXG4gICAgYXVkaW9fdXJsID0gZ2V0TmV4dEZpbGVCeU1vZGUobW9kZSwgcGxheWxpc3QsIHNlbGVjdGVkKTtcbiAgfVxuXG4gIGlmICghYXVkaW9fdXJsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgYXVkaW8gPSAkKGF1ZGlvU2VsZWN0b3IpWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG5cbiAgLy8g5a+55LqOYW1iaWVudOexu+Wei++8jOWkhOeQhuaOiemYsue8k+WtmOWQjue8gFxuICBpZiAodHlwZSA9PT0gJ2FtYmllbnQnKSB7XG4gICAgY29uc3QgY2xlYW5BdWRpb1NyYyA9IGF1ZGlvLnNyYy5zcGxpdCgnPycpWzBdO1xuICAgIGNvbnN0IGNsZWFuQXVkaW9VcmwgPSBhdWRpb191cmwuc3BsaXQoJz8nKVswXTtcbiAgICBpZiAoZGVjb2RlVVJJQ29tcG9uZW50KGNsZWFuQXVkaW9TcmMpID09PSBkZWNvZGVVUklDb21wb25lbnQoY2xlYW5BdWRpb1VybCkgJiYgIWF1ZGlvRW5kZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0gZWxzZSBpZiAoZGVjb2RlVVJJQ29tcG9uZW50KGF1ZGlvLnNyYykgPT09IGRlY29kZVVSSUNvbXBvbmVudChhdWRpb191cmwpICYmICFhdWRpb0VuZGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8g6K6+572uYXVkaW9FbmRlZOeKtuaAgVxuICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICBiZ21FbmRlZCA9IGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIGFtYmllbnRFbmRlZCA9IGZhbHNlO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgYXVkaW8uc3JjID0gYXVkaW9fdXJsO1xuICAgIGF1ZGlvLmxvYWQoKTtcblxuICAgIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KHJlc29sdmUgPT4ge1xuICAgICAgY29uc3QgY2FuUGxheUhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgIGF1ZGlvLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgY2FuUGxheUhhbmRsZXIpO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuXG4gICAgICBpZiAoYXVkaW8ucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfRU5PVUdIX0RBVEEpIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXVkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCBjYW5QbGF5SGFuZGxlcik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBhd2FpdCBwbGF5QXVkaW8odHlwZSk7XG4gIH0gZWxzZSB7XG4gICAgLy8g5a+55LqOYW1iaWVudOexu+Wei++8jOS9v+eUqOe8k+WtmOegtOWdj1xuICAgIGNvbnN0IGF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZyA9IGdldEF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZyhhdWRpb191cmwpO1xuICAgIGF1ZGlvLnNyYyA9IGF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZztcbiAgICBhdWRpby5sb2FkKCk7XG5cbiAgICBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPihyZXNvbHZlID0+IHtcbiAgICAgIGNvbnN0IGNhblBsYXlIYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICBhdWRpby5yZW1vdmVFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIGNhblBsYXlIYW5kbGVyKTtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfTtcblxuICAgICAgaWYgKGF1ZGlvLnJlYWR5U3RhdGUgPj0gSFRNTE1lZGlhRWxlbWVudC5IQVZFX0VOT1VHSF9EQVRBKSB7XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF1ZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgY2FuUGxheUhhbmRsZXIpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgYXdhaXQgcGxheUF1ZGlvKHR5cGUgYXMgJ2JnbScgfCAnYW1iaWVudCcpO1xuICB9XG5cbiAgLy8g5pu05paw6YCJ5Lit55qE6Z+z6aKRXG4gIGlmICh0eXBlID09PSAnYmdtJykge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmJnbV9zZWxlY3RlZCcsIGF1ZGlvX3VybCk7XG4gIH0gZWxzZSB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcsIGF1ZGlvX3VybCk7XG4gIH1cblxuICAvLyDmm7TmlrDpgInmi6nlmahcbiAgY29uc3Qgc2VsZWN0RWxlbWVudCA9ICQoYCNhdWRpb18ke3R5cGV9X3NlbGVjdGApO1xuICBpZiAoc2VsZWN0RWxlbWVudC52YWwoKSAhPT0gYXVkaW9fdXJsKSB7XG4gICAgc2VsZWN0RWxlbWVudC52YWwoYXVkaW9fdXJsKTtcbiAgfVxuXG4gIHNhdmVTZXR0aW5nc0RlYm91bmNlZCgpO1xufVxuXG4vKipcbiAqIOabtOaWsOmfs+mikeS4i+aLiemAieaLqeiPnOWNlVxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVBdWRpb1NlbGVjdCh0eXBlID0gJ2JnbScpIHtcbiAgaWYgKCFnZXRTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fZW5hYmxlZGApKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgc2VsZWN0RWxlbWVudCA9ICQoYCNhdWRpb18ke3R5cGV9X3NlbGVjdGApO1xuICBzZWxlY3RFbGVtZW50LmVtcHR5KCk7XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgbGlzdF9CR01TID0gYXdhaXQgZ2V0QXVkaW9VcmwoJ2JnbScpO1xuICB9IGVsc2Uge1xuICAgIGxpc3RfYW1iaWVudHMgPSBhd2FpdCBnZXRBdWRpb1VybCgnYW1iaWVudCcpO1xuICB9XG5cbiAgY29uc3QgYXVkaW9MaXN0ID0gdHlwZSA9PT0gJ2JnbScgPyBsaXN0X0JHTVMgOiBsaXN0X2FtYmllbnRzO1xuICBsZXQgc2VsZWN0ZWRTZXR0aW5nID1cbiAgICB0eXBlID09PSAnYmdtJyA/IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX3NlbGVjdGVkJykgOiBnZXRTZXR0aW5nVmFsdWUoJ2F1ZGlvLmFtYmllbnRfc2VsZWN0ZWQnKTtcblxuICBpZiAoYXVkaW9MaXN0ICYmIGF1ZGlvTGlzdC5sZW5ndGggPiAwKSB7XG4gICAgLy8g5qOA5p+l5b2T5YmN6YCJ5oup55qE6Z+z6aKR5piv5ZCm5Zyo5YiX6KGo5Lit77yM5aaC5p6c5LiN5Zyo5YiZ6YCJ5oup56ys5LiA5LiqXG4gICAgaWYgKCFhdWRpb0xpc3QuaW5jbHVkZXMoc2VsZWN0ZWRTZXR0aW5nKSkge1xuICAgICAgY29uc29sZS53YXJuKGBbQXVkaW9dIOW9k+WJjemAieaLqeeahOmfs+mikSAke3NlbGVjdGVkU2V0dGluZ30g5LiN5Zyo5YiX6KGo5Lit77yM6Ieq5Yqo6YCJ5oup5YiX6KGo56ys5LiA5Liq6Z+z6aKRYCk7XG4gICAgICBzZWxlY3RlZFNldHRpbmcgPSBhdWRpb0xpc3RbMF07XG4gICAgICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX3NlbGVjdGVkJywgc2VsZWN0ZWRTZXR0aW5nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmFtYmllbnRfc2VsZWN0ZWQnLCBzZWxlY3RlZFNldHRpbmcpO1xuICAgICAgfVxuICAgICAgc2F2ZVNldHRpbmdzRGVib3VuY2VkKCk7XG4gICAgfVxuXG4gICAgY29uc3QgYXVkaW9GaWxlcyA9IEFycmF5LmlzQXJyYXkoYXVkaW9MaXN0KSA/IGF1ZGlvTGlzdCA6IGF1ZGlvTGlzdC5zcGxpdCgnLCcpLm1hcChmaWxlID0+IGZpbGUudHJpbSgpKTtcbiAgICBhdWRpb0ZpbGVzLmZvckVhY2goKGZpbGU6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgZmlsZUxhYmVsID0gZmlsZS5yZXBsYWNlKC9eLipbXFxcXFxcL10vLCAnJykucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTtcbiAgICAgIHNlbGVjdEVsZW1lbnQuYXBwZW5kKG5ldyBPcHRpb24oZmlsZUxhYmVsLCBmaWxlKSk7XG4gICAgfSk7XG5cbiAgICBzZWxlY3RFbGVtZW50LnZhbChzZWxlY3RlZFNldHRpbmcpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUubG9nKGBbQXVkaW9dIOaaguaXoOWPr+eUqOeahCAke3R5cGUudG9VcHBlckNhc2UoKX0g6LWE5rqQYCk7XG4gIH1cbn1cblxuLyoqXG4gKiDojrflj5bpn7PpopFVUkxcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICogQHJldHVybnMg6Z+z6aKRVVJM5pWw57uEXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdWRpb1VybCh0eXBlID0gJ2JnbScpIHtcbiAgY29uc3QgdHlwZUtleSA9IHR5cGUgPT09ICdiZ20nID8gJ2JnbXVybCcgOiAnYW1iaWVudHVybCc7XG4gIC8vQHRzLWlnbm9yZVxuICBjb25zdCBjaGF0U3BlY2lmaWNVcmxzID0gY2hhdF9tZXRhZGF0YS52YXJpYWJsZXM/Llt0eXBlS2V5XSB8fCBbXTtcbiAgcmV0dXJuIGNoYXRTcGVjaWZpY1VybHM7XG59XG5cbi8qKlxuICog5re75Yqg57yT5a2Y5Y+C5pWw6Ziy5q2i57yT5a2YXG4gKiBAcGFyYW0gb3JpZ2luYWxVcmwg5Y6f5aeLVVJMXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBdWRpb1VybFdpdGhDYWNoZUJ1c3Rpbmcob3JpZ2luYWxVcmw6IHN0cmluZykge1xuICBpZiAoIW9yaWdpbmFsVXJsKSByZXR1cm4gJyc7XG4gIGNvbnN0IGNhY2hlQnVzdGVyID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gIGNvbnN0IHNlcGFyYXRvciA9IG9yaWdpbmFsVXJsLmluY2x1ZGVzKCc/JykgPyAnJicgOiAnPyc7XG4gIHJldHVybiBgJHtvcmlnaW5hbFVybH0ke3NlcGFyYXRvcn1fPSR7Y2FjaGVCdXN0ZXJ9YDtcbn1cblxuLyoqXG4gKiDmoLnmja7mkq3mlL7mqKHlvI/ojrflj5bkuIvkuIDkuKrpn7PpopHmlofku7ZcbiAqIEBwYXJhbSBtb2RlIOaSreaUvuaooeW8j1xuICogQHBhcmFtIHBsYXlsaXN0IOaSreaUvuWIl+ihqFxuICogQHBhcmFtIGN1cnJlbnRGaWxlIOW9k+WJjeaWh+S7tlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmV4dEZpbGVCeU1vZGUobW9kZTogc3RyaW5nLCBwbGF5bGlzdDogc3RyaW5nW10sIGN1cnJlbnRGaWxlOiBzdHJpbmcpIHtcbiAgaWYgKCFwbGF5bGlzdCB8fCBwbGF5bGlzdC5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBzd2l0Y2ggKG1vZGUpIHtcbiAgICBjYXNlICdyZXBlYXQnOlxuICAgICAgcmV0dXJuIHBsYXlsaXN0WzBdO1xuICAgIGNhc2UgJ3NpbmdsZSc6XG4gICAgICByZXR1cm4gY3VycmVudEZpbGUgfHwgcGxheWxpc3RbMF07XG4gICAgY2FzZSAncmFuZG9tJzoge1xuICAgICAgY29uc3QgZmlsdGVyZWRQbGF5bGlzdCA9IHBsYXlsaXN0LmZpbHRlcihmaWxlID0+IGZpbGUgIT09IGN1cnJlbnRGaWxlKTtcbiAgICAgIGlmIChmaWx0ZXJlZFBsYXlsaXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gcGxheWxpc3RbMF07XG4gICAgICB9XG4gICAgICBjb25zdCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGZpbHRlcmVkUGxheWxpc3QubGVuZ3RoKTtcbiAgICAgIHJldHVybiBmaWx0ZXJlZFBsYXlsaXN0W3JhbmRvbUluZGV4XTtcbiAgICB9XG4gICAgY2FzZSAnc3RvcCc6XG4gICAgICByZXR1cm4gJyc7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBwbGF5bGlzdFswXTtcbiAgfVxufVxuXG4vKipcbiAqIOWIh+aNoumfs+mikeaOp+S7tueKtuaAgVxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKiBAcGFyYW0gc3RhdHVzIOaYr+WQpuWQr+eUqFxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlQXVkaW9Db250cm9scyh0eXBlOiAnYmdtJyB8ICdhbWJpZW50Jywgc3RhdHVzID0gJ2VuYWJsZScpIHtcbiAgY29uc3QgaXNNYWluRW5hYmxlZCA9ICQoJyNhdWRpb19lbmFibGVkJykucHJvcCgnY2hlY2tlZCcpO1xuXG4gIGNvbnN0IHNob3VsZEVuYWJsZSA9IGlzTWFpbkVuYWJsZWQgJiYgc3RhdHVzID09PSAnZW5hYmxlJztcblxuICBjb25zdCBjb250cm9sSWRzID0gW1xuICAgIGAjYXVkaW9fJHt0eXBlfV9wbGF5X3BhdXNlYCxcbiAgICBgI2F1ZGlvXyR7dHlwZX1fbXV0ZWAsXG4gICAgYCNhdWRpb18ke3R5cGV9X21vZGVgLFxuICAgIGAjYXVkaW9fJHt0eXBlfV9zZWxlY3RgLFxuICAgIGAjYXVkaW9fJHt0eXBlfV92b2x1bWVfc2xpZGVyYCxcbiAgXTtcblxuICBjb250cm9sSWRzLmZvckVhY2goaWQgPT4ge1xuICAgICQoaWQpLnByb3AoJ2Rpc2FibGVkJywgIXNob3VsZEVuYWJsZSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIOeCueWHu+mfs+mikeWQr+eUqOaMiemSruaXtueahOmAmueUqOWkhOeQhuWHveaVsFxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvbkF1ZGlvRW5hYmxlZENsaWNrKHR5cGUgPSAnYmdtJykge1xuICBjb25zdCBlbmFibGVkID0gJChgI2VuYWJsZV8ke3R5cGV9YCkucHJvcCgnY2hlY2tlZCcpO1xuICBzYXZlU2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X2VuYWJsZWRgLCBlbmFibGVkKTtcblxuICBpZiAoZW5hYmxlZCkge1xuICAgIHRvZ2dsZUF1ZGlvQ29udHJvbHModHlwZSBhcyAnYmdtJyB8ICdhbWJpZW50JywgJ2VuYWJsZScpO1xuICAgIGF3YWl0IHVwZGF0ZUF1ZGlvKHR5cGUsIGZhbHNlKTtcbiAgfSBlbHNlIHtcbiAgICAoJChgI2F1ZGlvXyR7dHlwZX1gKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50KS5wYXVzZSgpO1xuICAgIHRvZ2dsZUF1ZGlvQ29udHJvbHModHlwZSBhcyAnYmdtJyB8ICdhbWJpZW50JywgJ2Rpc2FibGUnKTtcbiAgfVxufVxuXG4vKipcbiAqIOWIneWni+WMlumfs+mikeS6i+S7tuebkeWQrFxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0QXVkaW9FdmVudExpc3RlbmVycyh0eXBlOiAnYmdtJyB8ICdhbWJpZW50Jykge1xuICAoJChgI2F1ZGlvXyR7dHlwZX1gKSBhcyBIVE1MQXVkaW9FbGVtZW50KS5vbignZW5kZWQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgICBiZ21FbmRlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFtYmllbnRFbmRlZCA9IHRydWU7XG4gICAgfVxuICAgIGNvbnN0IG1vZGUgPSBnZXRTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fbW9kZWApO1xuXG4gICAgaWYgKG1vZGUgPT09ICdzdG9wJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGF3YWl0IHVwZGF0ZUF1ZGlvKHR5cGUsIGZhbHNlKTtcbiAgfSk7XG59XG5cbi8qKlxuICog5Yid5aeL5YyW6L+b5bqm5p2hXG4gKiBAcGFyYW0gdHlwZSDpn7PpopHnsbvlnosgXCJiZ21cIiDmiJYgXCJhbWJpZW50XCJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVQcm9ncmVzc0Jhcih0eXBlOiAnYmdtJyB8ICdhbWJpZW50Jykge1xuICBjb25zdCAkYXVkaW9FbGVtZW50ID0gJChgI2F1ZGlvXyR7dHlwZX1gKTtcbiAgY29uc3QgJHByb2dyZXNzU2xpZGVyID0gJChgI2F1ZGlvXyR7dHlwZX1fcHJvZ3Jlc3Nfc2xpZGVyYCk7XG5cbiAgJGF1ZGlvRWxlbWVudC5vbigndGltZXVwZGF0ZScsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIWlzTmFOKHRoaXMuZHVyYXRpb24pKSB7XG4gICAgICBjb25zdCBwcm9ncmVzc1BlcmNlbnQgPSAodGhpcy5jdXJyZW50VGltZSAvIHRoaXMuZHVyYXRpb24pICogMTAwO1xuICAgICAgJHByb2dyZXNzU2xpZGVyLnZhbChwcm9ncmVzc1BlcmNlbnQpO1xuICAgIH1cbiAgICBjb25zdCBjb29sZG93bkJHTSA9IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYXVkaW9fY29vbGRvd24nKTtcbiAgICBjb25zdCByZW1haW5pbmdUaW1lID0gdGhpcy5kdXJhdGlvbiAtIHRoaXMuY3VycmVudFRpbWU7XG5cbiAgICBpZiAoY29vbGRvd25CR00gPiAwICYmIHJlbWFpbmluZ1RpbWUgPD0gY29vbGRvd25CR00gJiYgIXRoaXMuaXNGYWRpbmdPdXQpIHtcbiAgICAgIGNvbnN0IGluaXRpYWxWb2x1bWUgPSB0aGlzLnZvbHVtZTtcbiAgICAgIGNvbnN0IGZhZGVTdGVwID0gaW5pdGlhbFZvbHVtZSAvIChjb29sZG93bkJHTSAqIDEwKTtcbiAgICAgIHRoaXMuaXNGYWRpbmdPdXQgPSB0cnVlO1xuXG4gICAgICBjb25zdCBmYWRlT3V0SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnZvbHVtZSA+IDApIHtcbiAgICAgICAgICB0aGlzLnZvbHVtZSA9IE1hdGgubWF4KDAsIHRoaXMudm9sdW1lIC0gZmFkZVN0ZXApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNsZWFySW50ZXJ2YWwoZmFkZU91dEludGVydmFsKTtcbiAgICAgICAgICB0aGlzLmlzRmFkaW5nT3V0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0sIDEwMCk7XG4gICAgfVxuICB9KTtcblxuICAkYXVkaW9FbGVtZW50Lm9uKCdwbGF5JywgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGNvb2xkb3duQkdNID0gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19jb29sZG93bicpO1xuICAgIGNvbnN0IHRhcmdldFZvbHVtZSA9ICQoYCNhdWRpb18ke3R5cGV9X3ZvbHVtZV9zbGlkZXJgKS52YWwoKSAvIDEwMDtcblxuICAgIGlmIChjb29sZG93bkJHTSA8PSAwKSB7XG4gICAgICB0aGlzLnZvbHVtZSA9IHRhcmdldFZvbHVtZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnZvbHVtZSA9IDA7XG4gICAgY29uc3QgZmFkZVN0ZXAgPSB0YXJnZXRWb2x1bWUgLyAoY29vbGRvd25CR00gKiAxMCk7XG4gICAgY29uc3QgZmFkZUluSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAodGhpcy52b2x1bWUgPCB0YXJnZXRWb2x1bWUpIHtcbiAgICAgICAgdGhpcy52b2x1bWUgPSBNYXRoLm1pbih0YXJnZXRWb2x1bWUsIHRoaXMudm9sdW1lICsgZmFkZVN0ZXApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChmYWRlSW5JbnRlcnZhbCk7XG4gICAgICB9XG4gICAgfSwgMTAwKTtcbiAgfSk7XG5cbiAgJGF1ZGlvRWxlbWVudC5vbignbG9hZGVkbWV0YWRhdGEnLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFpc05hTih0aGlzLmR1cmF0aW9uKSkge1xuICAgICAgJHByb2dyZXNzU2xpZGVyLmF0dHIoJ21heCcsIDEwMCk7XG4gICAgfVxuICB9KTtcblxuICAkcHJvZ3Jlc3NTbGlkZXIub24oJ2lucHV0JywgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHZhbHVlID0gJCh0aGlzKS52YWwoKTtcbiAgICBpZiAoIWlzTmFOKCRhdWRpb0VsZW1lbnRbMF0uZHVyYXRpb24pKSB7XG4gICAgICAkYXVkaW9FbGVtZW50WzBdLmN1cnJlbnRUaW1lID0gKHZhbHVlIC8gMTAwKSAqICRhdWRpb0VsZW1lbnRbMF0uZHVyYXRpb247XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiDpn7Pph4/mu5HlnZfmu5rova7osIPoioLkuovku7blpITnkIZcbiAqIEBwYXJhbSBlIOS6i+S7tuWvueixoVxuICovXG5mdW5jdGlvbiBvblZvbHVtZVNsaWRlcldoZWVsRXZlbnQodGhpczogYW55LCBlOiBXaGVlbEV2ZW50KSB7XG4gIGNvbnN0IHNsaWRlciA9ICQodGhpcyk7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICBjb25zdCBkZWx0YSA9IGUuZGVsdGFZIC8gMjA7XG4gIGNvbnN0IHNsaWRlclZhbCA9IE51bWJlcihzbGlkZXIudmFsKCkpO1xuXG4gIGxldCBuZXdWYWwgPSBzbGlkZXJWYWwgLSBkZWx0YTtcbiAgaWYgKG5ld1ZhbCA8IDApIHtcbiAgICBuZXdWYWwgPSAwO1xuICB9IGVsc2UgaWYgKG5ld1ZhbCA+IDEwMCkge1xuICAgIG5ld1ZhbCA9IDEwMDtcbiAgfVxuXG4gIHNsaWRlci52YWwobmV3VmFsKS50cmlnZ2VyKCdpbnB1dCcpO1xufVxuXG4vKipcbiAqIOmVv+aMiemfs+mHj+aOp+WItuaMiemSruWHuueOsOmfs+mHj+iwg+iKglxuICogQHBhcmFtIHZvbHVtZUNvbnRyb2xJZCDpn7Pph4/mjqfliLbmjInpkq5JRFxuICogQHBhcmFtIGljb25JZCDpn7Pph4/mjqfliLbmjInpkq7lm77moIdJRFxuICovXG5mdW5jdGlvbiBoYW5kbGVMb25nUHJlc3Modm9sdW1lQ29udHJvbElkOiBzdHJpbmcsIGljb25JZDogc3RyaW5nKSB7XG4gIGNvbnN0ICR2b2x1bWVDb250cm9sID0gJChgIyR7dm9sdW1lQ29udHJvbElkfWApO1xuICBjb25zdCAkaWNvbiA9ICQoYCMke2ljb25JZH1gKTtcbiAgbGV0IHByZXNzVGltZXI6IG51bWJlciB8IHVuZGVmaW5lZDtcblxuICBpZiAoaXNNb2JpbGUoKSkge1xuICAgICRpY29uLm9uKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIHByZXNzVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgJHZvbHVtZUNvbnRyb2wuY3NzKCdkaXNwbGF5JywgJ2Jsb2NrJyk7XG4gICAgICB9LCA1MDApO1xuICAgIH0pO1xuXG4gICAgJGljb24ub24oJ3RvdWNoZW5kJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGNsZWFyVGltZW91dChwcmVzc1RpbWVyKTtcbiAgICB9KTtcblxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgaWYgKFxuICAgICAgICAhJGljb24uaXMoZXZlbnQudGFyZ2V0KSAmJlxuICAgICAgICAkaWNvbi5oYXMoZXZlbnQudGFyZ2V0KS5sZW5ndGggPT09IDAgJiZcbiAgICAgICAgISR2b2x1bWVDb250cm9sLmlzKGV2ZW50LnRhcmdldCkgJiZcbiAgICAgICAgJHZvbHVtZUNvbnRyb2wuaGFzKGV2ZW50LnRhcmdldCkubGVuZ3RoID09PSAwXG4gICAgICApIHtcbiAgICAgICAgJHZvbHVtZUNvbnRyb2wuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIOWIt+aWsOmfs+mikei1hOa6kFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVmcmVzaEF1ZGlvUmVzb3VyY2VzKCkge1xuICB1cGRhdGVBdWRpb1NlbGVjdCgnYmdtJyk7XG4gIHVwZGF0ZUF1ZGlvU2VsZWN0KCdhbWJpZW50Jyk7XG59XG5cbi8qKlxuICog5omT5byA6Z+z6aKR6LWE5rqQ566h55CG5by556qXXG4gKiBAcGFyYW0gdHlwZUtleSDpn7PpopHnsbvlnosgXCJiZ211cmxcIiDmiJYgXCJhbWJpZW50dXJsXCJcbiAqL1xuXG5hc3luYyBmdW5jdGlvbiBvcGVuVXJsTWFuYWdlclBvcHVwKHR5cGVLZXk6ICdiZ211cmwnIHwgJ2FtYmllbnR1cmwnKSB7XG4gIGNvbnN0IHVybE1hbmFnZXIgPSAkKGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoYCR7dGVtcGxhdGVQYXRofWAsICdhdWRpb191cmxfbWFuYWdlcicpKTtcbiAgdXJsTWFuYWdlci5wcmVwZW5kKGBcbiAgICA8c3R5bGU+XG4gICAgICAjc2F2ZWRfYXVkaW9fdXJsLmVtcHR5OjphZnRlciB7XG4gICAgICAgIGNvbnRlbnQ6IFwi5pqC5peg6Z+z6aKRXCI7XG4gICAgICAgIGNvbG9yOiAjOTk5O1xuICAgICAgICBtYXJnaW4tdG9wOiAyMHB4O1xuICAgICAgICBmb250LXNpemU6IDEycHg7XG4gICAgICB9XG4gICAgPC9zdHlsZT5cbiAgYCk7XG4gIGNvbnN0IHNhdmVkQXVkaW9VcmwgPSB1cmxNYW5hZ2VyLmZpbmQoJyNzYXZlZF9hdWRpb191cmwnKS5lbXB0eSgpO1xuICBjb25zdCB1cmxUZW1wbGF0ZSA9ICQoYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhgJHt0ZW1wbGF0ZVBhdGh9YCwgJ2F1ZGlvX3VybF90ZW1wbGF0ZScpKTtcblxuICBpZiAoIWNoYXRfbWV0YWRhdGEudmFyaWFibGVzKSB7XG4gICAgY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMgPSB7fTtcbiAgfVxuXG4gIGxldCB1cmxWYWx1ZTogc3RyaW5nW10gPSBjaGF0X21ldGFkYXRhLnZhcmlhYmxlc1t0eXBlS2V5XTtcbiAgaWYgKCF1cmxWYWx1ZSkge1xuICAgIHVybFZhbHVlID0gW107XG5cbiAgICBzYXZlZEF1ZGlvVXJsLmFkZENsYXNzKCdlbXB0eScpO1xuICB9IGVsc2Uge1xuICAgIHRyeSB7XG4gICAgICBpZiAodXJsVmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNhdmVkQXVkaW9VcmwuYWRkQ2xhc3MoJ2VtcHR5Jyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtBdWRpb10gRmFpbGVkIHRvIHBhcnNlICR7dHlwZUtleX06YCwgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgdXBkYXRlZFVybHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgbGV0IG5ld1VybE9yZGVyID0gWy4uLnVybFZhbHVlXTtcbiAgZnVuY3Rpb24gcmVuZGVyVXJsKGNvbnRhaW5lcjogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgdXJsOiBzdHJpbmcpIHtcbiAgICBjb25zdCB1cmxIdG1sID0gdXJsVGVtcGxhdGUuY2xvbmUoKTtcbiAgICBsZXQgZmlsZU5hbWU7XG4gICAgaWYgKHVybC5pbmNsdWRlcygnLycpKSB7XG4gICAgICBjb25zdCBwYXJ0cyA9IHVybC5zcGxpdCgnLycpO1xuICAgICAgZmlsZU5hbWUgPSBwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSB8fCBwYXJ0c1twYXJ0cy5sZW5ndGggLSAyXTtcbiAgICB9IGVsc2Uge1xuICAgICAgZmlsZU5hbWUgPSB1cmw7XG4gICAgfVxuXG4gICAgY29uc3QgaWQgPSBmaWxlTmFtZS5yZXBsYWNlKC9cXC4vZywgJy0nKTtcblxuICAgIHVybEh0bWwuYXR0cignaWQnLCBpZCk7XG4gICAgdXJsSHRtbC5maW5kKCcuYXVkaW9fdXJsX25hbWUnKS50ZXh0KGZpbGVOYW1lKTtcblxuICAgIHVybEh0bWwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykuYXR0cignZGF0YS11cmwnLCB1cmwpO1xuXG4gICAgdXJsSHRtbC5maW5kKCcuZWRpdF9leGlzdGluZ191cmwnKS5vbignY2xpY2snLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBjdXJyZW50VXJsID0gdXJsSHRtbC5maW5kKCcuYXVkaW9fdXJsX25hbWUnKS5hdHRyKCdkYXRhLXVybCcpO1xuXG4gICAgICBpZiAoIWN1cnJlbnRVcmwpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW0F1ZGlvXSBObyBVUkwgZm91bmQgZm9yIHRoaXMgZWxlbWVudC4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpbnB1dFVybCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoJycsIFBPUFVQX1RZUEUuSU5QVVQsIGN1cnJlbnRVcmwpO1xuXG4gICAgICBpZiAoIWlucHV0VXJsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgbmV3RmlsZU5hbWUgPSBpbnB1dFVybC5zcGxpdCgnLycpLnBvcCgpO1xuXG4gICAgICBjb25zdCBuZXdJZCA9IG5ld0ZpbGVOYW1lLnJlcGxhY2UoL1xcLi9nLCAnLScpO1xuXG4gICAgICB1cmxIdG1sLmF0dHIoJ2lkJywgbmV3SWQpO1xuICAgICAgdXJsSHRtbC5maW5kKCcuYXVkaW9fdXJsX25hbWUnKS50ZXh0KG5ld0ZpbGVOYW1lKTtcbiAgICAgIHVybEh0bWwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykuYXR0cignZGF0YS11cmwnLCBpbnB1dFVybCk7XG5cbiAgICAgIHVwZGF0ZWRVcmxzW2N1cnJlbnRVcmxdID0gaW5wdXRVcmw7XG4gICAgfSk7XG5cbiAgICB1cmxIdG1sLmZpbmQoJy5kZWxldGVfdXJsJykub24oJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgY29uZmlybURlbGV0ZSA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoJ+ehruiupOimgeWIoOmZpOatpOmTvuaOpT8nLCBQT1BVUF9UWVBFLkNPTkZJUk0pO1xuXG4gICAgICBpZiAoIWNvbmZpcm1EZWxldGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDku4Xku45ET03kuK3np7vpmaTlhYPntKBcbiAgICAgIHVybEh0bWwucmVtb3ZlKCk7XG5cbiAgICAgIC8vIOajgOafpeaYr+WQpumcgOimgeaYvuekuuepuueKtuaAgeaPkOekulxuICAgICAgaWYgKHNhdmVkQXVkaW9VcmwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNhdmVkQXVkaW9VcmwuYWRkQ2xhc3MoJ2VtcHR5Jyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb250YWluZXIuYXBwZW5kKHVybEh0bWwpO1xuICB9XG5cbiAgdXJsVmFsdWUuZm9yRWFjaCh1cmwgPT4ge1xuICAgIHJlbmRlclVybChzYXZlZEF1ZGlvVXJsLCB1cmwpO1xuICB9KTtcbiAgdXJsTWFuYWdlci5maW5kKCcjaW1wb3J0X2J1dHRvbicpLm9uKCdjbGljaycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBuZXdVcmxzID0gYXdhaXQgb3BlblVybEltcG9ydFBvcHVwKCk7XG5cbiAgICBpZiAoIW5ld1VybHMpIHtcbiAgICAgIGNvbnNvbGUuZGVidWcoYFtBdWRpb10gJHt0eXBlS2V5fSBVUkzlr7zlhaXlt7Llj5bmtohgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzYXZlZEF1ZGlvVXJsLnJlbW92ZUNsYXNzKCdlbXB0eScpO1xuXG4gICAgbmV3VXJscy5mb3JFYWNoKHVybCA9PiB7XG4gICAgICByZW5kZXJVcmwoc2F2ZWRBdWRpb1VybCwgdXJsKTtcbiAgICB9KTtcbiAgfSk7XG4gIChzYXZlZEF1ZGlvVXJsIGFzIGFueSkuc29ydGFibGUoe1xuICAgIGRlbGF5OiBnZXRTb3J0YWJsZURlbGF5KCksXG4gICAgaGFuZGxlOiAnLmRyYWctaGFuZGxlJyxcbiAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XG4gICAgICBuZXdVcmxPcmRlciA9IFtdO1xuICAgICAgc2F2ZWRBdWRpb1VybC5maW5kKCcuYXVkaW9fdXJsX25hbWUnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgbmV3VXJsID0gJCh0aGlzKS5hdHRyKCdkYXRhLXVybCcpO1xuICAgICAgICBpZiAobmV3VXJsKSB7XG4gICAgICAgICAgbmV3VXJsT3JkZXIucHVzaChuZXdVcmwpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICB9KTtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh1cmxNYW5hZ2VyLCBQT1BVUF9UWVBFLkNPTkZJUk0sICcnLCB7XG4gICAgb2tCdXR0b246IGDnoa7orqRgLFxuICAgIGNhbmNlbEJ1dHRvbjogYOWPlua2iGAsXG4gIH0pO1xuXG4gIGlmICghcmVzdWx0KSB7XG4gICAgcmV0dXJuO1xuICB9IGVsc2Uge1xuICAgIC8vIOebtOaOpeivu+WPluaJgOaciWRhdGEtdXJs5bGe5oCn77yM55Sf5oiQ5paw55qEVVJM5YiX6KGoXG4gICAgY29uc3QgbmV3VXJsTGlzdDogc3RyaW5nW10gPSBbXTtcbiAgICBzYXZlZEF1ZGlvVXJsLmZpbmQoJy5hdWRpb191cmxfbmFtZScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgdXJsID0gJCh0aGlzKS5hdHRyKCdkYXRhLXVybCcpO1xuICAgICAgaWYgKHVybCkge1xuICAgICAgICBuZXdVcmxMaXN0LnB1c2godXJsKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIOajgOafpeW9k+WJjeaSreaUvueahOmfs+mikeaYr+WQpuWcqOaWsOeahOWIl+ihqOS4rVxuICAgIGNvbnN0IGN1cnJlbnRCZ21VcmwgPSBnZXRTZXR0aW5nVmFsdWUoJ2F1ZGlvLmJnbV9zZWxlY3RlZCcpO1xuICAgIGNvbnN0IGN1cnJlbnRBbWJpZW50VXJsID0gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hbWJpZW50X3NlbGVjdGVkJyk7XG5cbiAgICAvLyDlpoLmnpzlvZPliY3mkq3mlL7nmoTpn7PpopHkuI3lnKjmlrDnmoTliJfooajkuK3vvIzlgZzmraLmkq3mlL5cbiAgICBpZiAodHlwZUtleSA9PT0gJ2JnbXVybCcgJiYgY3VycmVudEJnbVVybCAmJiAhbmV3VXJsTGlzdC5pbmNsdWRlcyhjdXJyZW50QmdtVXJsKSkge1xuICAgICAgY29uc3QgYmdtQXVkaW8gPSAkKCcjYXVkaW9fYmdtJylbMF0gYXMgSFRNTEF1ZGlvRWxlbWVudDtcbiAgICAgIGJnbUF1ZGlvLnBhdXNlKCk7XG4gICAgICBiZ21FbmRlZCA9IHRydWU7XG4gICAgfSBlbHNlIGlmICh0eXBlS2V5ID09PSAnYW1iaWVudHVybCcgJiYgY3VycmVudEFtYmllbnRVcmwgJiYgIW5ld1VybExpc3QuaW5jbHVkZXMoY3VycmVudEFtYmllbnRVcmwpKSB7XG4gICAgICBjb25zdCBhbWJpZW50QXVkaW8gPSAkKCcjYXVkaW9fYW1iaWVudCcpWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG4gICAgICBhbWJpZW50QXVkaW8ucGF1c2UoKTtcbiAgICAgIGFtYmllbnRFbmRlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgLy8g5pu05paw5bm25L+d5a2Y5paw55qEVVJM5YiX6KGoXG4gICAgY2hhdF9tZXRhZGF0YS52YXJpYWJsZXNbdHlwZUtleV0gPSBuZXdVcmxMaXN0O1xuICAgIHNhdmVNZXRhZGF0YURlYm91bmNlZCgpO1xuICAgIGlmICh0eXBlS2V5ID09PSAnYmdtdXJsJykge1xuICAgICAgdXBkYXRlQXVkaW9TZWxlY3QoJ2JnbScpO1xuICAgIH0gZWxzZSBpZiAodHlwZUtleSA9PT0gJ2FtYmllbnR1cmwnKSB7XG4gICAgICB1cGRhdGVBdWRpb1NlbGVjdCgnYW1iaWVudCcpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOeCueWHu+mfs+mikeaAu+W8gOWFs+aXtueahOWkhOeQhuWHveaVsFxuICovXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVBdWRpb1RvZ2dsZShlbmFibGU6IGJvb2xlYW4gPSB0cnVlLCB1c2VySW5wdXQ6IGJvb2xlYW4gPSB0cnVlKSB7XG4gIGlmICh1c2VySW5wdXQpIHtcbiAgICBpc0F1ZGlvRW5hYmxlZCA9IGVuYWJsZTtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19lbmFibGVkJywgaXNBdWRpb0VuYWJsZWQpO1xuICB9XG5cbiAgaWYgKGVuYWJsZSkge1xuICAgICQoJyNhdWRpby1wbGF5ZXItY29udGVudCcpLnJlbW92ZUNsYXNzKCdhdWRpby1kaXNhYmxlZC1tYXNrJyk7XG4gICAgaWYgKGlzRXh0ZW5zaW9uRW5hYmxlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBpc0V4dGVuc2lvbkVuYWJsZWQgPSBnZXRTZXR0aW5nVmFsdWUoJ2VuYWJsZWRfZXh0ZW5zaW9uJyk7XG4gICAgfVxuICAgIGlmICghaXNFeHRlbnNpb25FbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRvZ2dsZUF1ZGlvQ29udHJvbHMoJ2JnbScsICdlbmFibGUnKTtcbiAgICB0b2dnbGVBdWRpb0NvbnRyb2xzKCdhbWJpZW50JywgJ2VuYWJsZScpO1xuICAgIGNvbnN0IGJnbVVybCA9IGF3YWl0IGdldEF1ZGlvVXJsKCdiZ20nKTtcbiAgICBjb25zdCBhbWJpZW50VXJsID0gYXdhaXQgZ2V0QXVkaW9VcmwoJ2FtYmllbnQnKTtcbiAgICBpZiAoYmdtVXJsLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IGJnbUF1ZGlvRWxlbWVudCA9ICQoJyNhdWRpb19iZ20nKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgYmdtQXVkaW9FbGVtZW50LnBsYXkoKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW0F1ZGlvXSDmkq3mlL7pn7PkuZDlpLHotKXvvJrmsqHmnInmj5DkvpvmnInmlYjmupAnKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGFtYmllbnRVcmwubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgYW1iaWVudEF1ZGlvRWxlbWVudCA9ICQoJyNhdWRpb19hbWJpZW50JylbMF0gYXMgSFRNTEF1ZGlvRWxlbWVudDtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGFtYmllbnRBdWRpb0VsZW1lbnQucGxheSgpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbQXVkaW9dIOaSreaUvumfs+aViOWksei0pe+8muayoeacieaPkOS+m+acieaViOa6kCcpO1xuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAkKCcjYXVkaW8tcGxheWVyLWNvbnRlbnQnKS5hZGRDbGFzcygnYXVkaW8tZGlzYWJsZWQtbWFzaycpO1xuICAgICgkKCcjYXVkaW9fYmdtJylbMF0gYXMgSFRNTEF1ZGlvRWxlbWVudCkucGF1c2UoKTtcbiAgICAoJCgnI2F1ZGlvX2FtYmllbnQnKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50KS5wYXVzZSgpO1xuICAgIHRvZ2dsZUF1ZGlvQ29udHJvbHMoJ2JnbScsICdkaXNhYmxlJyk7XG4gICAgdG9nZ2xlQXVkaW9Db250cm9scygnYW1iaWVudCcsICdkaXNhYmxlJyk7XG4gIH1cbn1cblxuLyoqXG4gKiDmkq3mlL7pn7PpopFcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcGxheUF1ZGlvKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIGlmIChcbiAgICAhZ2V0U2V0dGluZ1ZhbHVlKCdlbmFibGVkX2V4dGVuc2lvbicpIHx8XG4gICAgIWdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYXVkaW9fZW5hYmxlZCcpIHx8XG4gICAgIWdldFNldHRpbmdWYWx1ZShgYXVkaW8uJHt0eXBlfV9lbmFibGVkYClcbiAgKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgYXVkaW9FbGVtZW50ID0gJChgI2F1ZGlvXyR7dHlwZX1gKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICBjb25zdCBwbGF5UGF1c2VJY29uID0gJChgI2F1ZGlvXyR7dHlwZX1fcGxheV9wYXVzZV9pY29uYCk7XG5cbiAgaWYgKGF1ZGlvRWxlbWVudC5lcnJvciAmJiBhdWRpb0VsZW1lbnQuZXJyb3IuY29kZSA9PT0gNCkge1xuICAgIGNvbnNvbGUud2FybihgVGhlICR7dHlwZX0gZWxlbWVudCBoYXMgbm8gc3VwcG9ydGVkIHNvdXJjZXMuIFRyeWluZyB0byByZWxvYWQgc2VsZWN0ZWQgYXVkaW8gZnJvbSBkcm9wZG93bi4uLmApO1xuXG4gICAgY29uc3Qgc2VsZWN0ZWRBdWRpbyA9ICQoYCNhdWRpb18ke3R5cGV9X3NlbGVjdGApLnZhbCgpIGFzIHN0cmluZztcbiAgICBpZiAoIXNlbGVjdGVkQXVkaW8pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYE5vIGF1ZGlvIHNlbGVjdGVkIGZvciAke3R5cGV9YCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXVkaW9FbGVtZW50LnNyYyA9IHNlbGVjdGVkQXVkaW87XG4gICAgYXVkaW9FbGVtZW50LmxvYWQoKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgYXdhaXQgYXVkaW9FbGVtZW50LnBsYXkoKTtcbiAgICBwbGF5UGF1c2VJY29uLnJlbW92ZUNsYXNzKCdmYS1wbGF5Jyk7XG4gICAgcGxheVBhdXNlSWNvbi5hZGRDbGFzcygnZmEtcGF1c2UnKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGBbQXVkaW9dIOaSreaUviAke3R5cGV9IOmfs+mikeaXtuWHuumUmTpgLCBlcnJvcik7XG4gIH1cbn1cblxuLyoqXG4gKiDngrnlh7vlkIToh6rpn7PpopHmqKHlvI/mjInpkq7ml7bnmoTpgJrnlKjlpITnkIblh73mlbBcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5hc3luYyBmdW5jdGlvbiBvbkF1ZGlvTW9kZUNsaWNrKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIGNvbnN0IG1vZGVzID0gW1xuICAgIHsgbW9kZTogJ3JlcGVhdCcsIGljb246ICdmYS1yZXBlYXQnIH0sXG4gICAgeyBtb2RlOiAncmFuZG9tJywgaWNvbjogJ2ZhLXJhbmRvbScgfSxcbiAgICB7IG1vZGU6ICdzaW5nbGUnLCBpY29uOiAnZmEtcmVkby1hbHQnIH0sXG4gICAgeyBtb2RlOiAnc3RvcCcsIGljb246ICdmYS1jYW5jZWwnIH0sXG4gIF07XG5cbiAgY29uc3QgY3VycmVudE1vZGVJbmRleCA9IG1vZGVzLmZpbmRJbmRleChtID0+IG0ubW9kZSA9PT0gZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X21vZGVgKSk7XG5cbiAgY29uc3QgbmV4dE1vZGVJbmRleCA9IChjdXJyZW50TW9kZUluZGV4ICsgMSkgJSBtb2Rlcy5sZW5ndGg7XG5cbiAgc2F2ZVNldHRpbmdWYWx1ZShgYXVkaW8uJHt0eXBlfV9tb2RlYCwgbW9kZXNbbmV4dE1vZGVJbmRleF0ubW9kZSk7XG5cbiAgJChgI2F1ZGlvXyR7dHlwZX1fbW9kZV9pY29uYCkucmVtb3ZlQ2xhc3MoJ2ZhLXJlcGVhdCBmYS1yYW5kb20gZmEtcmVkby1hbHQgZmEtY2FuY2VsJyk7XG5cbiAgJChgI2F1ZGlvXyR7dHlwZX1fbW9kZV9pY29uYCkuYWRkQ2xhc3MobW9kZXNbbmV4dE1vZGVJbmRleF0uaWNvbik7XG59XG5cbi8qKlxuICog6Z+z6aKR6YCJ5oup5Y+Y5YyW5pe255qE6YCa55So5aSE55CG5Ye95pWwXG4gKiBAcGFyYW0gdHlwZSDpn7PpopHnsbvlnosgXCJiZ21cIiDmiJYgXCJhbWJpZW50XCJcbiAqL1xuYXN5bmMgZnVuY3Rpb24gb25BdWRpb1NlbGVjdENoYW5nZSh0eXBlOiAnYmdtJyB8ICdhbWJpZW50Jykge1xuICBzYXZlU2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X3NlbGVjdGVkYCwgJChgI2F1ZGlvXyR7dHlwZX1fc2VsZWN0YCkudmFsKCkpO1xuICBhd2FpdCB1cGRhdGVBdWRpbyh0eXBlLCB0cnVlKTtcbn1cblxuLyoqXG4gKiDovpPlhaXlhrfljbTml7bpl7TnmoTlpITnkIblh73mlbBcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5hc3luYyBmdW5jdGlvbiBvbkF1ZGlvQ29vbGRvd25JbnB1dCgpIHtcbiAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYXVkaW9fY29vbGRvd24nLCB+figkKGAjYXVkaW9fY29vbGRvd25gKS52YWwoKSBhcyBzdHJpbmcpKTtcbn1cblxuLyoqXG4gKiDpn7PpopHpn7Pph4/lj5jljJbml7bnmoTpgJrnlKjlpITnkIblh73mlbBcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5hc3luYyBmdW5jdGlvbiBvbkF1ZGlvVm9sdW1lQ2hhbmdlKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIHNhdmVTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fdm9sdW1lYCwgfn4oJChgI2F1ZGlvXyR7dHlwZX1fdm9sdW1lX3NsaWRlcmApLnZhbCgpIGFzIHN0cmluZykpO1xuICAkKGAjYXVkaW9fJHt0eXBlfWApLnByb3AoJ3ZvbHVtZScsIGdldFNldHRpbmdWYWx1ZShgYXVkaW8uJHt0eXBlfV92b2x1bWVgKSAqIDAuMDEpO1xuICAkKGAjYXVkaW9fJHt0eXBlfV92b2x1bWVgKS50ZXh0KGdldFNldHRpbmdWYWx1ZShgYXVkaW8uJHt0eXBlfV92b2x1bWVgKSk7XG59XG5cbi8qKlxuICog54K55Ye76Z+z6aKR6Z2Z6Z+z5oyJ6ZKu5pe255qE6YCa55So5aSE55CG5Ye95pWwXG4gKiBAcGFyYW0gdHlwZSDpn7PpopHnsbvlnosgXCJiZ21cIiDmiJYgXCJhbWJpZW50XCJcbiAqL1xuYXN5bmMgZnVuY3Rpb24gb25BdWRpb011dGVDbGljayh0eXBlOiAnYmdtJyB8ICdhbWJpZW50Jykge1xuICBzYXZlU2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X211dGVkYCwgIWdldFNldHRpbmdWYWx1ZShgYXVkaW8uJHt0eXBlfV9tdXRlZGApKTtcbiAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZV9pY29uYCkudG9nZ2xlQ2xhc3MoJ2ZhLXZvbHVtZS1oaWdoJyk7XG4gICQoYCNhdWRpb18ke3R5cGV9X211dGVfaWNvbmApLnRvZ2dsZUNsYXNzKCdmYS12b2x1bWUtbXV0ZScpO1xuICAkKGAjYXVkaW9fJHt0eXBlfWApLnByb3AoJ211dGVkJywgISQoYCNhdWRpb18ke3R5cGV9YCkucHJvcCgnbXV0ZWQnKSk7XG4gICQoYCNhdWRpb18ke3R5cGV9X211dGVgKS50b2dnbGVDbGFzcygncmVkT3ZlcmxheUdsb3cnKTtcbn1cblxuLyoqXG4gKiDliIfmjaLmkq3mlL4v5pqC5YGc54q25oCBXG4gKiBAcGFyYW0gdHlwZSDpn7PpopHnsbvlnosgXCJiZ21cIiDmiJYgXCJhbWJpZW50XCJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRvZ2dsZVBsYXlQYXVzZSh0eXBlOiAnYmdtJyB8ICdhbWJpZW50Jykge1xuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYXVkaW9fZW5hYmxlZCcpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgYXVkaW9FbGVtZW50ID0gJChgI2F1ZGlvXyR7dHlwZX1gKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICBjb25zdCBwbGF5UGF1c2VJY29uID0gJChgI2F1ZGlvXyR7dHlwZX1fcGxheV9wYXVzZV9pY29uYCk7XG5cbiAgaWYgKGF1ZGlvRWxlbWVudC5wYXVzZWQpIHtcbiAgICBhd2FpdCBwbGF5QXVkaW8odHlwZSk7XG4gIH0gZWxzZSB7XG4gICAgYXVkaW9FbGVtZW50LnBhdXNlKCk7XG4gICAgcGxheVBhdXNlSWNvbi5yZW1vdmVDbGFzcygnZmEtcGF1c2UnKTtcbiAgICBwbGF5UGF1c2VJY29uLmFkZENsYXNzKCdmYS1wbGF5Jyk7XG4gIH1cbn1cblxuLyoqXG4gKiDmiZPlvIBVUkzlr7zlhaXlvLnnqpdcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+Wei1xuICovXG5hc3luYyBmdW5jdGlvbiBvcGVuVXJsSW1wb3J0UG9wdXAoKTogUHJvbWlzZTxzdHJpbmdbXSB8IG51bGw+IHtcbiAgY29uc3QgaW5wdXQgPSAoYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCgn6L6T5YWl6KaB5a+85YWl55qE572R57uc6Z+z6aKR6ZO+5o6l77yI5q+P6KGM5LiA5Liq77yJJywgUE9QVVBfVFlQRS5JTlBVVCwgJycpKSBhcyBzdHJpbmcgfCBudWxsO1xuXG4gIGlmICghaW5wdXQpIHtcbiAgICBjb25zb2xlLmRlYnVnKCdbQXVkaW9dIFVSTCBpbXBvcnQgY2FuY2VsbGVkJyk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBjb25zdCB1cmxBcnJheSA9IGlucHV0XG4gICAgLnRyaW0oKVxuICAgIC5zcGxpdCgnXFxuJylcbiAgICAubWFwKCh1cmw6IHN0cmluZykgPT4gdXJsLnRyaW0oKSlcbiAgICAuZmlsdGVyKCh1cmw6IHN0cmluZykgPT4gdXJsICE9PSAnJyk7XG5cbiAgcmV0dXJuIEFycmF5LmZyb20obmV3IFNldCh1cmxBcnJheSkpO1xufVxuXG4vLyDogYrlpKnmm7TmlLnml7bnmoTkuovku7blpITnkIZcbmV2ZW50U291cmNlLm9uKGV2ZW50X3R5cGVzLkNIQVRfQ0hBTkdFRCwgYXN5bmMgKCkgPT4ge1xuICBjb25zdCAkYmdtUGxheWVyID0gJCgnI2F1ZGlvX2JnbScpWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG4gIGNvbnN0ICRhbWJpZW50UGxheWVyID0gJCgnI2F1ZGlvX2FtYmllbnQnKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuXG4gIGlmICgkYmdtUGxheWVyICYmICEkYmdtUGxheWVyLnBhdXNlZCkge1xuICAgICRiZ21QbGF5ZXIucGF1c2UoKTtcbiAgfVxuXG4gIGlmICgkYW1iaWVudFBsYXllciAmJiAhJGFtYmllbnRQbGF5ZXIucGF1c2VkKSB7XG4gICAgJGFtYmllbnRQbGF5ZXIucGF1c2UoKTtcbiAgfVxuICBhd2FpdCByZWZyZXNoQXVkaW9SZXNvdXJjZXMoKTtcbiAgY29uc29sZS5sb2coJ1tBdWRpb10g6IGK5aSp5bey5pu05pS577yM6Z+z6aKR6LWE5rqQ5Yi35paw5a6M5oiQJyk7XG59KTtcblxuLyoqIOWIneWni+WMluagt+W8j1xuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmZ1bmN0aW9uIGluaXRBdWRpb1N0eWxlcyh0eXBlOiAnYmdtJyB8ICdhbWJpZW50Jykge1xuICAvLyDpmpDol4/pu5jorqTmkq3mlL7lmajmoLflvI9cbiAgJChgI2F1ZGlvXyR7dHlwZX1gKS5oaWRlKCk7XG5cbiAgaWYgKGdldFNldHRpbmdWYWx1ZShgYXVkaW8uJHt0eXBlfV9tdXRlZGApKSB7XG4gICAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZV9pY29uYCkucmVtb3ZlQ2xhc3MoJ2ZhLXZvbHVtZS1oaWdoJyk7XG4gICAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZV9pY29uYCkuYWRkQ2xhc3MoJ2ZhLXZvbHVtZS1tdXRlJyk7XG4gICAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZWApLmFkZENsYXNzKCdyZWRPdmVybGF5R2xvdycpO1xuICAgICQoYCNhdWRpb18ke3R5cGV9YCkucHJvcCgnbXV0ZWQnLCB0cnVlKTtcbiAgfSBlbHNlIHtcbiAgICAkKGAjYXVkaW9fJHt0eXBlfV9tdXRlX2ljb25gKS5hZGRDbGFzcygnZmEtdm9sdW1lLWhpZ2gnKTtcbiAgICAkKGAjYXVkaW9fJHt0eXBlfV9tdXRlX2ljb25gKS5yZW1vdmVDbGFzcygnZmEtdm9sdW1lLW11dGUnKTtcbiAgICAkKGAjYXVkaW9fJHt0eXBlfV9tdXRlYCkucmVtb3ZlQ2xhc3MoJ3JlZE92ZXJsYXlHbG93Jyk7XG4gICAgJChgI2F1ZGlvXyR7dHlwZX1gKS5wcm9wKCdtdXRlZCcsIGZhbHNlKTtcbiAgfVxuXG4gICQoYCNlbmFibGVfJHt0eXBlfWApLnByb3AoJ2NoZWNrZWQnLCBnZXRTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fZW5hYmxlZGApKTtcblxuICBjb25zdCBhdWRpb0VsZW1lbnQgPSAkKGAjYXVkaW9fJHt0eXBlfWApWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG4gIGNvbnN0IHBsYXlQYXVzZUljb24gPSAkKGAjYXVkaW9fJHt0eXBlfV9wbGF5X3BhdXNlX2ljb25gKTtcblxuICBpZiAoYXVkaW9FbGVtZW50ICYmIGF1ZGlvRWxlbWVudC5wYXVzZWQpIHtcbiAgICBwbGF5UGF1c2VJY29uLnJlbW92ZUNsYXNzKCdmYS1wYXVzZScpO1xuICAgIHBsYXlQYXVzZUljb24uYWRkQ2xhc3MoJ2ZhLXBsYXknKTtcbiAgfSBlbHNlIGlmIChhdWRpb0VsZW1lbnQgJiYgIWF1ZGlvRWxlbWVudC5wYXVzZWQpIHtcbiAgICBwbGF5UGF1c2VJY29uLnJlbW92ZUNsYXNzKCdmYS1wbGF5Jyk7XG4gICAgcGxheVBhdXNlSWNvbi5hZGRDbGFzcygnZmEtcGF1c2UnKTtcbiAgfVxuICB1cGRhdGVBdWRpb1NlbGVjdCh0eXBlKTtcbiAgaW5pdGlhbGl6ZVByb2dyZXNzQmFyKHR5cGUpO1xufVxuXG4vKipcbiAqIOWIneWni+WMluaJgOaciemfs+mikeebuOWFs+e7hOS7tuWSjOS6i+S7tuebkeWQrOWZqFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdEF1ZGlvQ29tcG9uZW50cygpIHtcbiAgLy8g5Yqg6L296Z+z6aKR5pKt5pS+5Zmo5qC35byPXG4gIGF3YWl0IGxvYWRGaWxlVG9Eb2N1bWVudChgL3NjcmlwdHMvZXh0ZW5zaW9ucy8ke2V4dGVuc2lvbkZvbGRlclBhdGh9L3NyYy9jb21wb25lbnQvYXVkaW8vc3R5bGUuY3NzYCwgJ2NzcycpO1xuXG4gIGlzQXVkaW9FbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19lbmFibGVkJyk7XG4gIGhhbmRsZUF1ZGlvVG9nZ2xlKGlzQXVkaW9FbmFibGVkLCBmYWxzZSk7XG4gICQoJyNhdWRpby1lbmFibGUtdG9nZ2xlJylcbiAgICAucHJvcCgnY2hlY2tlZCcsIGlzQXVkaW9FbmFibGVkKVxuICAgIC5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiBoYW5kbGVBdWRpb1RvZ2dsZShldmVudC50YXJnZXQuY2hlY2tlZCwgdHJ1ZSkpO1xuXG4gIC8vIOWIneWni+WMluaKmOWPoOaOp+S7tlxuICBDb2xsYXBzaWJsZS5pbml0QWxsKCcjYXVkaW8tcGxheWVyLWhlYWRlcicsIHtcbiAgICBoZWFkZXJTZWxlY3RvcjogJyNhdWRpby1wbGF5ZXItaGVhZGVyJyxcbiAgICBjb250ZW50U2VsZWN0b3I6ICcjYXVkaW8tcGxheWVyLWNvbnRlbnQnLFxuICAgIGluaXRpYWxseUV4cGFuZGVkOiB0cnVlLFxuICAgIGFuaW1hdGlvbkR1cmF0aW9uOiB7XG4gICAgICBleHBhbmQ6IDI4MCxcbiAgICAgIGNvbGxhcHNlOiAyNTAsXG4gICAgfSxcbiAgfSk7XG5cbiAgLy8g5Yid5aeL5YyW6Z+z5LmQ5ZKM6Z+z5pWI5qC35byPXG4gIGluaXRBdWRpb1N0eWxlcygnYmdtJyk7XG4gIGluaXRBdWRpb1N0eWxlcygnYW1iaWVudCcpO1xuXG4gIGNvbnN0IGF1ZGlvVHlwZXMgPSBbJ2JnbScsICdhbWJpZW50J10gYXMgY29uc3Q7XG5cbiAgY29uc3QgYmluZFR5cGVFdmVudHMgPSAoXG4gICAgdHlwZTogJ2JnbScgfCAnYW1iaWVudCcsXG4gICAgZXZlbnRzOiBBcnJheTx7XG4gICAgICBzZWxlY3Rvcjogc3RyaW5nO1xuICAgICAgZXZlbnQ6IHN0cmluZztcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zaGFkb3dcbiAgICAgIGhhbmRsZXI6ICh0eXBlOiAnYmdtJyB8ICdhbWJpZW50JykgPT4gdm9pZDtcbiAgICB9PixcbiAgKSA9PiB7XG4gICAgZXZlbnRzLmZvckVhY2goKHsgc2VsZWN0b3IsIGV2ZW50LCBoYW5kbGVyIH0pID0+IHtcbiAgICAgICQoYCMke3NlbGVjdG9yfWApLm9uKGV2ZW50LCAoKSA9PiBoYW5kbGVyKHR5cGUpKTtcbiAgICB9KTtcbiAgfTtcblxuICBhdWRpb1R5cGVzLmZvckVhY2godHlwZSA9PiB7XG4gICAgJChgI2VuYWJsZV8ke3R5cGV9YCkub24oJ2NsaWNrJywgKCkgPT4gb25BdWRpb0VuYWJsZWRDbGljayh0eXBlKSk7XG5cbiAgICBiaW5kVHlwZUV2ZW50cyh0eXBlLCBbXG4gICAgICB7XG4gICAgICAgIHNlbGVjdG9yOiBgZW5hYmxlXyR7dHlwZX1gLFxuICAgICAgICBldmVudDogJ2NsaWNrJyxcbiAgICAgICAgaGFuZGxlcjogb25BdWRpb0VuYWJsZWRDbGljayxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHNlbGVjdG9yOiBgYXVkaW9fJHt0eXBlfV9tb2RlYCxcbiAgICAgICAgZXZlbnQ6ICdjbGljaycsXG4gICAgICAgIGhhbmRsZXI6IG9uQXVkaW9Nb2RlQ2xpY2ssXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBzZWxlY3RvcjogYGF1ZGlvXyR7dHlwZX1fbXV0ZWAsXG4gICAgICAgIGV2ZW50OiAnY2xpY2snLFxuICAgICAgICBoYW5kbGVyOiBvbkF1ZGlvTXV0ZUNsaWNrLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgc2VsZWN0b3I6IGBhdWRpb18ke3R5cGV9X3ZvbHVtZV9zbGlkZXJgLFxuICAgICAgICBldmVudDogJ2lucHV0JyxcbiAgICAgICAgaGFuZGxlcjogb25BdWRpb1ZvbHVtZUNoYW5nZSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHNlbGVjdG9yOiBgYXVkaW9fJHt0eXBlfV9zZWxlY3RgLFxuICAgICAgICBldmVudDogJ2NoYW5nZScsXG4gICAgICAgIGhhbmRsZXI6IG9uQXVkaW9TZWxlY3RDaGFuZ2UsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBzZWxlY3RvcjogYGF1ZGlvXyR7dHlwZX1fcGxheV9wYXVzZWAsXG4gICAgICAgIGV2ZW50OiAnY2xpY2snLFxuICAgICAgICBoYW5kbGVyOiB0b2dnbGVQbGF5UGF1c2UsXG4gICAgICB9LFxuICAgIF0pO1xuXG4gICAgJCgnI2F1ZGlvX2Nvb2xkb3duJykub24oJ2lucHV0Jywgb25BdWRpb0Nvb2xkb3duSW5wdXQpLnZhbChnZXRTZXR0aW5nVmFsdWUoJ2F1ZGlvLmF1ZGlvX2Nvb2xkb3duJykpO1xuXG4gICAgLy8g55uR5ZCs6Z+z6aKR57uT5p2f5LqL5Lu2XG4gICAgaW5pdEF1ZGlvRXZlbnRMaXN0ZW5lcnMoJ2JnbScpO1xuICAgIGluaXRBdWRpb0V2ZW50TGlzdGVuZXJzKCdhbWJpZW50Jyk7XG5cbiAgICBjb25zdCB2b2x1bWVTbGlkZXIgPSAkKGAjYXVkaW9fJHt0eXBlfV92b2x1bWVfc2xpZGVyYCkuZ2V0KDApO1xuICAgIGlmICh2b2x1bWVTbGlkZXIpIHtcbiAgICAgIHZvbHVtZVNsaWRlci5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIG9uVm9sdW1lU2xpZGVyV2hlZWxFdmVudCwge1xuICAgICAgICBwYXNzaXZlOiBmYWxzZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgJCgnI2F1ZGlvX3JlZnJlc2hfYXNzZXRzJykub24oJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHJlZnJlc2hBdWRpb1Jlc291cmNlcygpO1xuICB9KTtcblxuICBoYW5kbGVMb25nUHJlc3MoJ2JnbS12b2x1bWUtY29udHJvbCcsICdhdWRpb19iZ21fbXV0ZV9pY29uJyk7XG4gIGhhbmRsZUxvbmdQcmVzcygnYW1iaWVudC12b2x1bWUtY29udHJvbCcsICdhdWRpb19hbWJpZW50X211dGVfaWNvbicpO1xuXG4gIGNvbnN0IHVybE1hbmFnZXJNYXAgPSB7XG4gICAgYmdtOiAnYmdtdXJsJyxcbiAgICBhbWJpZW50OiAnYW1iaWVudHVybCcsXG4gIH07XG5cbiAgYXVkaW9UeXBlcy5mb3JFYWNoKHR5cGUgPT4ge1xuICAgICQoYCMke3R5cGV9X21hbmFnZXJfYnV0dG9uYCkub24oJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgb3BlblVybE1hbmFnZXJQb3B1cCh1cmxNYW5hZ2VyTWFwW3R5cGVdIGFzICdiZ211cmwnIHwgJ2FtYmllbnR1cmwnKTtcbiAgICAgIGF3YWl0IHJlZnJlc2hBdWRpb1Jlc291cmNlcygpO1xuICAgIH0pO1xuICB9KTtcblxuICBjb25zdCBiZ21BdWRpbyA9ICQoJyNhdWRpb19iZ20nKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICBjb25zdCBhbWJpZW50QXVkaW8gPSAkKCcjYXVkaW9fYW1iaWVudCcpWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG5cbiAgY29uc3QgdG9nZ2xlUGxheVBhdXNlSWNvbiA9IChhdWRpb0VsZW1lbnQ6IEhUTUxBdWRpb0VsZW1lbnQsIGljb25TZWxlY3Rvcjogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgaWNvbiA9ICQoaWNvblNlbGVjdG9yKTtcbiAgICBhdWRpb0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncGxheScsICgpID0+IGljb24ucmVtb3ZlQ2xhc3MoJ2ZhLXBsYXknKS5hZGRDbGFzcygnZmEtcGF1c2UnKSk7XG4gICAgYXVkaW9FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BhdXNlJywgKCkgPT4gaWNvbi5yZW1vdmVDbGFzcygnZmEtcGF1c2UnKS5hZGRDbGFzcygnZmEtcGxheScpKTtcbiAgfTtcblxuICB0b2dnbGVQbGF5UGF1c2VJY29uKGJnbUF1ZGlvLCAnI2F1ZGlvX2JnbV9wbGF5X3BhdXNlX2ljb24nKTtcbiAgdG9nZ2xlUGxheVBhdXNlSWNvbihhbWJpZW50QXVkaW8sICcjYXVkaW9fYW1iaWVudF9wbGF5X3BhdXNlX2ljb24nKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/audio/index.ts\n")},"./src/component/listener/index.ts":
/*!*****************************************!*\
  !*** ./src/component/listener/index.ts ***!
  \*****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initListener: () => (/* binding */ initListener)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var socket_io_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! socket.io-client */ \"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js\");\n/* harmony import */ var _script_repository_index__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../script_repository/index */ \"./src/component/script_repository/index.ts\");\n/* harmony import */ var _script_repository_script_controller__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n\n\n\n\n\n\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.extensionFolderPath}/src/component/listener`;\nconst default_settings = {\n    enabled: false,\n    url: 'http://localhost:6621',\n    duration: 1000,\n    enable_echo: true,\n};\nlet socket;\nlet refresh_iframe_debounced;\nfunction reset_refresh_duration() {\n    refresh_iframe_debounced = _.debounce(refresh_iframe, (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('listener.duration'));\n}\nasync function refresh_iframe() {\n    console.log(`[Listener]  iframe `);\n    // @ts-expect-error\n    const character = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid];\n    if (character) {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveChatConditional)();\n    }\n    const scriptManager = _script_repository_script_controller__WEBPACK_IMPORTED_MODULE_5__.ScriptManager.getInstance();\n    const globalScripts = scriptManager.getGlobalScripts();\n    await scriptManager.stopScriptsByType(globalScripts, _script_repository_index__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n    await scriptManager.runScriptsByType(globalScripts, _script_repository_index__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.reloadCurrentChat)();\n}\nfunction toggle_status(should_enable) {\n    if (should_enable) {\n        $('#online_status_indicator').addClass('success');\n    }\n    else {\n        $('#online_status_indicator').removeClass('success');\n    }\n}\nfunction connect_socket(url) {\n    if (socket) {\n        toggle_status(false);\n        socket.close();\n    }\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('listener.enabled') || !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('listener.url')) {\n        return;\n    }\n    socket = (0,socket_io_client__WEBPACK_IMPORTED_MODULE_3__.io)(url);\n    socket.on('connect_error', (error) => {\n        toggle_status(false);\n        if (socket.active) {\n            if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('listener.enable_echo')) {\n                toastr.error(`, ...\\n${error.name}: ${error.message}`);\n            }\n            console.error(`${error.name}: ${error.message}${error.stack ?? ''}`);\n        }\n        else {\n            if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('listener.enable_echo')) {\n                toastr.error(`, !\\n${error.name}: ${error.message}`);\n            }\n            console.error(`${error.name}: ${error.message}${error.stack ?? ''}`);\n        }\n    });\n    socket.on('connect', () => {\n        toggle_status(true);\n        console.log('[Listener] ');\n    });\n    socket.on('iframe_updated', () => {\n        refresh_iframe_debounced();\n    });\n    socket.on('disconnect', (reason, details) => {\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('listener.enable_echo')) {\n            toastr.warning(`: ${reason}`);\n        }\n        toggle_status(false);\n        console.log(`[Listener] : ${reason}\\n${details}`);\n    });\n}\n/**\n * \n */\nasync function initListener() {\n    const $listener_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.renderExtensionTemplateAsync)(`${templatePath}`, 'index'));\n    $listener_container\n        .find('#iframe_update_listener_enabled')\n        .prop('checked', await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getOrSaveSettingValue)('listener.enabled', default_settings.enabled))\n        .on('click', async function () {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('listener.enabled', $(this).prop('checked'));\n        connect_socket((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('listener.url'));\n    });\n    $listener_container\n        .find('#iframe_update_listener_enable_echo')\n        .prop('checked', await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getOrSaveSettingValue)('listener.enable_echo', default_settings.enable_echo))\n        .on('click', function () {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('listener.enable_echo', $(this).prop('checked'));\n    });\n    $listener_container\n        .find('#iframe_update_listener_url')\n        .val(await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getOrSaveSettingValue)('listener.url', default_settings.url))\n        .on('input', async function () {\n        const url = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('listener.url', String($(this).val()));\n        connect_socket(url);\n    });\n    $listener_container\n        .find('#iframe_update_listener_duration')\n        .val(await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getOrSaveSettingValue)('listener.duration', default_settings.duration))\n        .on('input', async function () {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('listener.duration', Number($(this).val()));\n        reset_refresh_duration();\n    });\n    $('#extension-listener').append($listener_container);\n    reset_refresh_duration();\n    connect_socket((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('listener.url'));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RkFBcUIsQ0FBQyxtQkFBbUIsRUFBRSxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztTQUNoRixFQUFFLENBQUMsT0FBTyxFQUFFLEtBQUs7UUFDaEIsMkVBQWdCLENBQUMsbUJBQW1CLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDN0Qsc0JBQXNCLEVBQUUsQ0FBQztJQUMzQixDQUFDLENBQUMsQ0FBQztJQUVMLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0lBRXJELHNCQUFzQixFQUFFLENBQUM7SUFDekIsY0FBYyxDQUFDLDBFQUFlLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQztBQUNsRCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9saXN0ZW5lci9pbmRleC50cz9jZjU0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGV4dGVuc2lvbkZvbGRlclBhdGgsXG4gIGdldE9yU2F2ZVNldHRpbmdWYWx1ZSxcbiAgZ2V0U2V0dGluZ1ZhbHVlLFxuICBzYXZlU2V0dGluZ1ZhbHVlLFxufSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5pbXBvcnQgeyBjaGFyYWN0ZXJzLCByZWxvYWRDdXJyZW50Q2hhdCwgc2F2ZUNoYXRDb25kaXRpb25hbCwgdGhpc19jaGlkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmltcG9ydCB7IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcblxuaW1wb3J0IHsgaW8gfSBmcm9tICdzb2NrZXQuaW8tY2xpZW50JztcbmltcG9ydCB7IFNjcmlwdFR5cGUgfSBmcm9tICcuLi9zY3JpcHRfcmVwb3NpdG9yeS9pbmRleCc7XG5pbXBvcnQgeyBTY3JpcHRNYW5hZ2VyIH0gZnJvbSAnLi4vc2NyaXB0X3JlcG9zaXRvcnkvc2NyaXB0X2NvbnRyb2xsZXInO1xuXG5jb25zdCB0ZW1wbGF0ZVBhdGggPSBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L2xpc3RlbmVyYDtcbmNvbnN0IGRlZmF1bHRfc2V0dGluZ3MgPSB7XG4gIGVuYWJsZWQ6IGZhbHNlLFxuICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjY2MjEnLFxuICBkdXJhdGlvbjogMTAwMCxcbiAgZW5hYmxlX2VjaG86IHRydWUsXG59IGFzIGNvbnN0O1xuXG5sZXQgc29ja2V0OiBSZXR1cm5UeXBlPHR5cGVvZiBpbz47XG5cbmxldCByZWZyZXNoX2lmcmFtZV9kZWJvdW5jZWQ6IF8uRGVib3VuY2VkRnVuYzwoKSA9PiBQcm9taXNlPHZvaWQ+PjtcbmZ1bmN0aW9uIHJlc2V0X3JlZnJlc2hfZHVyYXRpb24oKSB7XG4gIHJlZnJlc2hfaWZyYW1lX2RlYm91bmNlZCA9IF8uZGVib3VuY2UocmVmcmVzaF9pZnJhbWUsIGdldFNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZHVyYXRpb24nKSk7XG59XG5hc3luYyBmdW5jdGlvbiByZWZyZXNoX2lmcmFtZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc29sZS5sb2coYFtMaXN0ZW5lcl0g5bey5bCGIGlmcmFtZSDliLfmlrDkuLrmnIDmlrDniYjmnKxgKTtcblxuICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gIGNvbnN0IGNoYXJhY3RlciA9IGNoYXJhY3RlcnNbdGhpc19jaGlkXTtcbiAgaWYgKGNoYXJhY3Rlcikge1xuICAgIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgfVxuXG4gIGNvbnN0IHNjcmlwdE1hbmFnZXIgPSBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gIGNvbnN0IGdsb2JhbFNjcmlwdHMgPSBzY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFNjcmlwdHMoKTtcblxuICBhd2FpdCBzY3JpcHRNYW5hZ2VyLnN0b3BTY3JpcHRzQnlUeXBlKGdsb2JhbFNjcmlwdHMsIFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgYXdhaXQgc2NyaXB0TWFuYWdlci5ydW5TY3JpcHRzQnlUeXBlKGdsb2JhbFNjcmlwdHMsIFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbn1cblxuZnVuY3Rpb24gdG9nZ2xlX3N0YXR1cyhzaG91bGRfZW5hYmxlOiBib29sZWFuKSB7XG4gIGlmIChzaG91bGRfZW5hYmxlKSB7XG4gICAgJCgnI29ubGluZV9zdGF0dXNfaW5kaWNhdG9yJykuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcbiAgfSBlbHNlIHtcbiAgICAkKCcjb25saW5lX3N0YXR1c19pbmRpY2F0b3InKS5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbm5lY3Rfc29ja2V0KHVybDogc3RyaW5nKTogdm9pZCB7XG4gIGlmIChzb2NrZXQpIHtcbiAgICB0b2dnbGVfc3RhdHVzKGZhbHNlKTtcbiAgICBzb2NrZXQuY2xvc2UoKTtcbiAgfVxuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZW5hYmxlZCcpIHx8ICFnZXRTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLnVybCcpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgc29ja2V0ID0gaW8odXJsKTtcblxuICBzb2NrZXQub24oJ2Nvbm5lY3RfZXJyb3InLCAoZXJyb3I6IEVycm9yKSA9PiB7XG4gICAgdG9nZ2xlX3N0YXR1cyhmYWxzZSk7XG4gICAgaWYgKHNvY2tldC5hY3RpdmUpIHtcbiAgICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmVuYWJsZV9lY2hvJykpIHtcbiAgICAgICAgdG9hc3RyLmVycm9yKGDov57mjqXphZLppobliqnmiYvlrp7ml7bnm5HlkKzlip/og73lh7rplJksIOWwneivlemHjei/ni4uLlxcbiR7ZXJyb3IubmFtZX06ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUuZXJyb3IoYCR7ZXJyb3IubmFtZX06ICR7ZXJyb3IubWVzc2FnZX0ke2Vycm9yLnN0YWNrID8/ICcnfWApO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZ2V0U2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci5lbmFibGVfZWNobycpKSB7XG4gICAgICAgIHRvYXN0ci5lcnJvcihg6L+e5o6l6YWS6aaG5Yqp5omL5a6e5pe255uR5ZCs5Yqf6IO95Ye66ZSZLCDor7fmiYvliqjov57mjqXph43or5UhXFxuJHtlcnJvci5uYW1lfTogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgfVxuICAgICAgY29uc29sZS5lcnJvcihgJHtlcnJvci5uYW1lfTogJHtlcnJvci5tZXNzYWdlfSR7ZXJyb3Iuc3RhY2sgPz8gJyd9YCk7XG4gICAgfVxuICB9KTtcblxuICBzb2NrZXQub24oJ2Nvbm5lY3QnLCAoKSA9PiB7XG4gICAgdG9nZ2xlX3N0YXR1cyh0cnVlKTtcbiAgICBjb25zb2xlLmxvZygnW0xpc3RlbmVyXSDmiJDlip/ov57mjqXoh7PmnI3liqHlmagnKTtcbiAgfSk7XG5cbiAgc29ja2V0Lm9uKCdpZnJhbWVfdXBkYXRlZCcsICgpID0+IHtcbiAgICByZWZyZXNoX2lmcmFtZV9kZWJvdW5jZWQoKTtcbiAgfSk7XG5cbiAgc29ja2V0Lm9uKCdkaXNjb25uZWN0JywgKHJlYXNvbiwgZGV0YWlscykgPT4ge1xuICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmVuYWJsZV9lY2hvJykpIHtcbiAgICAgIHRvYXN0ci53YXJuaW5nKGDphZLppobliqnmiYvlrp7ml7bnm5HlkKzlmajmlq3lvIDov57mjqU6ICR7cmVhc29ufWApO1xuICAgIH1cbiAgICB0b2dnbGVfc3RhdHVzKGZhbHNlKTtcbiAgICBjb25zb2xlLmxvZyhgW0xpc3RlbmVyXSDkuI7mnI3liqHlmajmlq3lvIDov57mjqU6ICR7cmVhc29ufVxcbiR7ZGV0YWlsc31gKTtcbiAgfSk7XG59XG5cbi8qKlxuICog5Yid5aeL5YyW5a6e5pe255uR5ZCsXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0TGlzdGVuZXIoKSB7XG4gIGNvbnN0ICRsaXN0ZW5lcl9jb250YWluZXIgPSAkKGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoYCR7dGVtcGxhdGVQYXRofWAsICdpbmRleCcpKTtcblxuICAkbGlzdGVuZXJfY29udGFpbmVyXG4gICAgLmZpbmQoJyNpZnJhbWVfdXBkYXRlX2xpc3RlbmVyX2VuYWJsZWQnKVxuICAgIC5wcm9wKCdjaGVja2VkJywgYXdhaXQgZ2V0T3JTYXZlU2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci5lbmFibGVkJywgZGVmYXVsdF9zZXR0aW5ncy5lbmFibGVkKSlcbiAgICAub24oJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKHRoaXM6IEhUTUxJbnB1dEVsZW1lbnQpIHtcbiAgICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmVuYWJsZWQnLCAkKHRoaXMpLnByb3AoJ2NoZWNrZWQnKSk7XG4gICAgICBjb25uZWN0X3NvY2tldChnZXRTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLnVybCcpKTtcbiAgICB9KTtcblxuICAkbGlzdGVuZXJfY29udGFpbmVyXG4gICAgLmZpbmQoJyNpZnJhbWVfdXBkYXRlX2xpc3RlbmVyX2VuYWJsZV9lY2hvJylcbiAgICAucHJvcCgnY2hlY2tlZCcsIGF3YWl0IGdldE9yU2F2ZVNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZW5hYmxlX2VjaG8nLCBkZWZhdWx0X3NldHRpbmdzLmVuYWJsZV9lY2hvKSlcbiAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24gKHRoaXM6IEhUTUxJbnB1dEVsZW1lbnQpIHtcbiAgICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmVuYWJsZV9lY2hvJywgJCh0aGlzKS5wcm9wKCdjaGVja2VkJykpO1xuICAgIH0pO1xuXG4gICRsaXN0ZW5lcl9jb250YWluZXJcbiAgICAuZmluZCgnI2lmcmFtZV91cGRhdGVfbGlzdGVuZXJfdXJsJylcbiAgICAudmFsKGF3YWl0IGdldE9yU2F2ZVNldHRpbmdWYWx1ZSgnbGlzdGVuZXIudXJsJywgZGVmYXVsdF9zZXR0aW5ncy51cmwpKVxuICAgIC5vbignaW5wdXQnLCBhc3luYyBmdW5jdGlvbiAodGhpczogSFRNTElucHV0RWxlbWVudCkge1xuICAgICAgY29uc3QgdXJsID0gc2F2ZVNldHRpbmdWYWx1ZSgnbGlzdGVuZXIudXJsJywgU3RyaW5nKCQodGhpcykudmFsKCkpKTtcbiAgICAgIGNvbm5lY3Rfc29ja2V0KHVybCk7XG4gICAgfSk7XG5cbiAgJGxpc3RlbmVyX2NvbnRhaW5lclxuICAgIC5maW5kKCcjaWZyYW1lX3VwZGF0ZV9saXN0ZW5lcl9kdXJhdGlvbicpXG4gICAgLnZhbChhd2FpdCBnZXRPclNhdmVTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmR1cmF0aW9uJywgZGVmYXVsdF9zZXR0aW5ncy5kdXJhdGlvbikpXG4gICAgLm9uKCdpbnB1dCcsIGFzeW5jIGZ1bmN0aW9uICh0aGlzOiBIVE1MSW5wdXRFbGVtZW50KSB7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci5kdXJhdGlvbicsIE51bWJlcigkKHRoaXMpLnZhbCgpKSk7XG4gICAgICByZXNldF9yZWZyZXNoX2R1cmF0aW9uKCk7XG4gICAgfSk7XG5cbiAgJCgnI2V4dGVuc2lvbi1saXN0ZW5lcicpLmFwcGVuZCgkbGlzdGVuZXJfY29udGFpbmVyKTtcblxuICByZXNldF9yZWZyZXNoX2R1cmF0aW9uKCk7XG4gIGNvbm5lY3Rfc29ja2V0KGdldFNldHRpbmdWYWx1ZSgnbGlzdGVuZXIudXJsJykpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/listener/index.ts\n")},"./src/component/macro.ts":
/*!********************************!*\
  !*** ./src/component/macro.ts ***!
  \********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerAllMacros: () => (/* binding */ registerAllMacros),\n/* harmony export */   registerMacro: () => (/* binding */ registerMacro),\n/* harmony export */   unregisterAllMacros: () => (/* binding */ unregisterAllMacros),\n/* harmony export */   unregisterMacro: () => (/* binding */ unregisterMacro)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ "./src/util/extension_variables.ts");\n/* harmony import */ var _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/macros */ "@sillytavern/scripts/macros");\n\n\nconst predefinedMacros = new Map([\n    [\'userAvatarPath\', _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getUserAvatarPath],\n    [\'charAvatarPath\', _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getCharAvatarPath],\n]);\n/**\n * \n * @param {string} key - \n * @param {MacroFunction|string} value - \n */\nfunction registerMacro(key, value) {\n    _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.registerMacro(key, value);\n    console.log(`[Macro]  "${key}" `);\n}\n/**\n * \n */\nfunction registerAllMacros() {\n    for (const [key, value] of predefinedMacros.entries()) {\n        _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.registerMacro(key, value);\n        console.log(`[Macro]  "${key}" `);\n    }\n}\n/**\n * \n * @param {string} key - \n */\nfunction unregisterMacro(key) {\n    _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.unregisterMacro(key);\n    console.log(`[Macro]  "${key}" `);\n}\n/**\n * \n */\nfunction unregisterAllMacros() {\n    for (const key of predefinedMacros.keys()) {\n        _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.unregisterMacro(key);\n        console.log(`[Macro]  "${key}" `);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21hY3JvLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFrRjtBQUdSO0FBRTFFLE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxHQUFHLENBQWlDO0lBQy9ELENBQUMsZ0JBQWdCLEVBQUUsd0VBQWlCLENBQUM7SUFDckMsQ0FBQyxnQkFBZ0IsRUFBRSx3RUFBaUIsQ0FBQztDQUN0QyxDQUFDLENBQUM7QUFFSDs7OztHQUlHO0FBQ0ksU0FBUyxhQUFhLENBQUMsR0FBVyxFQUFFLEtBQTZCO0lBQ3RFLHFFQUFZLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUN2QyxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsR0FBRyxRQUFRLENBQUMsQ0FBQztBQUN6QyxDQUFDO0FBRUQ7O0dBRUc7QUFDSSxTQUFTLGlCQUFpQjtJQUMvQixLQUFLLE1BQU0sQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLElBQUksZ0JBQWdCLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQztRQUN0RCxxRUFBWSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdkMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEdBQUcsUUFBUSxDQUFDLENBQUM7SUFDekMsQ0FBQztBQUNILENBQUM7QUFFRDs7O0dBR0c7QUFDSSxTQUFTLGVBQWUsQ0FBQyxHQUFXO0lBQ3pDLHFFQUFZLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2xDLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxHQUFHLFFBQVEsQ0FBQyxDQUFDO0FBQ3pDLENBQUM7QUFFRDs7R0FFRztBQUNJLFNBQVMsbUJBQW1CO0lBQ2pDLEtBQUssTUFBTSxHQUFHLElBQUksZ0JBQWdCLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQztRQUMxQyxxRUFBWSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNsQyxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsR0FBRyxRQUFRLENBQUMsQ0FBQztJQUN6QyxDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvbWFjcm8udHM/MjUwMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRDaGFyQXZhdGFyUGF0aCwgZ2V0VXNlckF2YXRhclBhdGggfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5cblxuaW1wb3J0IHsgTWFjcm9GdW5jdGlvbiwgTWFjcm9zUGFyc2VyIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvbWFjcm9zJztcblxuY29uc3QgcHJlZGVmaW5lZE1hY3JvcyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmcgfCBNYWNyb0Z1bmN0aW9uPihbXG4gIFsndXNlckF2YXRhclBhdGgnLCBnZXRVc2VyQXZhdGFyUGF0aF0sXG4gIFsnY2hhckF2YXRhclBhdGgnLCBnZXRDaGFyQXZhdGFyUGF0aF0sXG5dKTtcblxuLyoqXG4gKiDms6jlhozkuIDkuKrlro9cbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSDlro/nmoTlkI3np7BcbiAqIEBwYXJhbSB7TWFjcm9GdW5jdGlvbnxzdHJpbmd9IHZhbHVlIC0g5a2X56ym5Liy5oiW6L+U5Zue5a2X56ym5Liy55qE5Ye95pWwXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3Rlck1hY3JvKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nIHwgTWFjcm9GdW5jdGlvbikge1xuICBNYWNyb3NQYXJzZXIucmVnaXN0ZXJNYWNybyhrZXksIHZhbHVlKTtcbiAgY29uc29sZS5sb2coYFtNYWNyb10g5a6PIFwiJHtrZXl9XCIg5rOo5YaM5oiQ5YqfYCk7XG59XG5cbi8qKlxuICog5rOo5YaM5omA5pyJ6aKE5a6a5LmJ55qE5a6PXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlckFsbE1hY3JvcygpIHtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgcHJlZGVmaW5lZE1hY3Jvcy5lbnRyaWVzKCkpIHtcbiAgICBNYWNyb3NQYXJzZXIucmVnaXN0ZXJNYWNybyhrZXksIHZhbHVlKTtcbiAgICBjb25zb2xlLmxvZyhgW01hY3JvXSDlro8gXCIke2tleX1cIiDms6jlhozmiJDlip9gKTtcbiAgfVxufVxuXG4vKipcbiAqIOazqOmUgOaMh+WumueahOWuj1xuICogQHBhcmFtIHtzdHJpbmd9IGtleSAtIOimgeazqOmUgOeahOWuj+WQjeensFxuICovXG5leHBvcnQgZnVuY3Rpb24gdW5yZWdpc3Rlck1hY3JvKGtleTogc3RyaW5nKSB7XG4gIE1hY3Jvc1BhcnNlci51bnJlZ2lzdGVyTWFjcm8oa2V5KTtcbiAgY29uc29sZS5sb2coYFtNYWNyb10g5a6PIFwiJHtrZXl9XCIg5rOo6ZSA5oiQ5YqfYCk7XG59XG5cbi8qKlxuICog5rOo6ZSA5omA5pyJ6aKE5a6a5LmJ55qE5a6PXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1bnJlZ2lzdGVyQWxsTWFjcm9zKCkge1xuICBmb3IgKGNvbnN0IGtleSBvZiBwcmVkZWZpbmVkTWFjcm9zLmtleXMoKSkge1xuICAgIE1hY3Jvc1BhcnNlci51bnJlZ2lzdGVyTWFjcm8oa2V5KTtcbiAgICBjb25zb2xlLmxvZyhgW01hY3JvXSDlro8gXCIke2tleX1cIiDms6jplIDmiJDlip9gKTtcbiAgfVxufSJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/macro.ts\n')},"./src/component/macrolike.ts":
/*!************************************!*\
  !*** ./src/component/macrolike.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   destroyMacroOnExtension: () => (/* binding */ destroyMacroOnExtension),\n/* harmony export */   initializeMacroOnExtension: () => (/* binding */ initializeMacroOnExtension),\n/* harmony export */   registerMacroLike: () => (/* binding */ registerMacroLike),\n/* harmony export */   renderAllMacros: () => (/* binding */ renderAllMacros)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n\n\nconst macros = [\n    {\n        regex: /\\{\\{get_global_variable::(.*?)\\}\\}/gi,\n        replace: (_context, _substring, path) => {\n            const variables = _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings.variables.global;\n            return JSON.stringify(_.get(variables, path, null));\n        },\n    },\n    {\n        regex: /\\{\\{get_chat_variable::(.*?)\\}\\}/gi,\n        replace: (_context, _substring, path) => {\n            const variables = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata.variables;\n            return JSON.stringify(_.get(variables, path, null));\n        },\n    },\n    {\n        regex: /\\{\\{get_message_variable::(.*?)\\}\\}/gi,\n        replace: (context, _substring, path) => {\n            const variables = (context.message_id !== undefined ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.slice(0, context.message_id + 1) : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat)\n                .map(chat_message => _.get(chat_message, ['variables', chat_message.swipe_id ?? 0]))\n                .findLast(data => data !== undefined) ?? {};\n            return JSON.stringify(_.get(variables, path, null));\n        },\n    },\n];\nfunction registerMacroLike(regex, replace) {\n    macros.push({ regex, replace });\n}\nfunction demacroOnPrompt(event_data) {\n    if (event_data.dryRun) {\n        return;\n    }\n    for (const message of event_data.chat) {\n        for (const macro of macros) {\n            message.content = message.content.replace(macro.regex, (substring, ...args) => macro.replace({ role: message.role }, substring, ...args));\n        }\n    }\n}\nfunction demacroOnRender(message_id) {\n    const $mes = $(`div.mes[mesid=\"${message_id}\"]`);\n    const $mes_text = $mes.find('.mes_text');\n    if ($mes_text.length === 0 || !macros.some(macro => macro.regex.test($mes_text.text()))) {\n        return;\n    }\n    const replace_html = (html) => {\n        for (const macro of macros) {\n            html = html.replace(macro.regex, (substring, ...args) => macro.replace({ message_id: Number(message_id), role: $mes.attr('is_user') === 'true' ? 'user' : 'assistant' }, substring, ...args));\n        }\n        return html;\n    };\n    $mes_text.html((_index, html) => replace_html(html));\n    $mes_text\n        .find('code')\n        .filter((_index, node) => macros.some(macro => macro.regex.test($(node).text())))\n        .text((_index, text) => replace_html(text));\n}\nfunction renderAllMacros() {\n    $('div.mes').each((_index, node) => {\n        demacroOnRender($(node).attr('mesid'));\n    });\n}\nfunction initializeMacroOnExtension() {\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHAT_COMPLETION_PROMPT_READY, demacroOnPrompt);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_UPDATED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_SWIPED, demacroOnRender);\n}\nfunction destroyMacroOnExtension() {\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHAT_COMPLETION_PROMPT_READY, demacroOnPrompt);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_UPDATED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_SWIPED, demacroOnRender);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztJQUN6RSw0REFBVyxDQUFDLGNBQWMsQ0FBQyw0REFBVyxDQUFDLGNBQWMsRUFBRSxlQUFlLENBQUMsQ0FBQztBQUMxRSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9tYWNyb2xpa2UudHM/YzgwMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjaGF0LCBjaGF0X21ldGFkYXRhLCBldmVudF90eXBlcywgZXZlbnRTb3VyY2UgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGV4dGVuc2lvbl9zZXR0aW5ncyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuXG5pbnRlcmZhY2UgTWFjcm9MaWtlIHtcbiAgcmVnZXg6IFJlZ0V4cDtcbiAgcmVwbGFjZTogKGNvbnRleHQ6IENvbnRleHQsIHN1YnN0cmluZzogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSkgPT4gc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgQ29udGV4dCB7XG4gIG1lc3NhZ2VfaWQ/OiBudW1iZXI7XG4gIHJvbGU/OiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nO1xufVxuXG5jb25zdCBtYWNyb3M6IE1hY3JvTGlrZVtdID0gW1xuICB7XG4gICAgcmVnZXg6IC9cXHtcXHtnZXRfZ2xvYmFsX3ZhcmlhYmxlOjooLio/KVxcfVxcfS9naSxcbiAgICByZXBsYWNlOiAoX2NvbnRleHQ6IENvbnRleHQsIF9zdWJzdHJpbmc6IHN0cmluZywgcGF0aDogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCB2YXJpYWJsZXMgPSBleHRlbnNpb25fc2V0dGluZ3MudmFyaWFibGVzLmdsb2JhbDtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShfLmdldCh2YXJpYWJsZXMsIHBhdGgsIG51bGwpKTtcbiAgICB9LFxuICB9LFxuICB7XG4gICAgcmVnZXg6IC9cXHtcXHtnZXRfY2hhdF92YXJpYWJsZTo6KC4qPylcXH1cXH0vZ2ksXG4gICAgcmVwbGFjZTogKF9jb250ZXh0OiBDb250ZXh0LCBfc3Vic3RyaW5nOiBzdHJpbmcsIHBhdGg6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGVzID0gKGNoYXRfbWV0YWRhdGEgYXMgeyB2YXJpYWJsZXM6IE9iamVjdCB9KS52YXJpYWJsZXM7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoXy5nZXQodmFyaWFibGVzLCBwYXRoLCBudWxsKSk7XG4gICAgfSxcbiAgfSxcbiAge1xuICAgIHJlZ2V4OiAvXFx7XFx7Z2V0X21lc3NhZ2VfdmFyaWFibGU6OiguKj8pXFx9XFx9L2dpLFxuICAgIHJlcGxhY2U6IChjb250ZXh0OiBDb250ZXh0LCBfc3Vic3RyaW5nOiBzdHJpbmcsIHBhdGg6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGVzID1cbiAgICAgICAgKGNvbnRleHQubWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkID8gY2hhdC5zbGljZSgwLCBjb250ZXh0Lm1lc3NhZ2VfaWQgKyAxKSA6IGNoYXQpXG4gICAgICAgICAgLm1hcChjaGF0X21lc3NhZ2UgPT4gXy5nZXQoY2hhdF9tZXNzYWdlLCBbJ3ZhcmlhYmxlcycsIGNoYXRfbWVzc2FnZS5zd2lwZV9pZCA/PyAwXSkpXG4gICAgICAgICAgLmZpbmRMYXN0KGRhdGEgPT4gZGF0YSAhPT0gdW5kZWZpbmVkKSA/PyB7fTtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShfLmdldCh2YXJpYWJsZXMsIHBhdGgsIG51bGwpKTtcbiAgICB9LFxuICB9LFxuXTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyTWFjcm9MaWtlKFxuICByZWdleDogUmVnRXhwLFxuICByZXBsYWNlOiAoY29udGV4dDogQ29udGV4dCwgc3Vic3RyaW5nOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKSA9PiBzdHJpbmcsXG4pIHtcbiAgbWFjcm9zLnB1c2goeyByZWdleCwgcmVwbGFjZSB9KTtcbn1cblxuZnVuY3Rpb24gZGVtYWNyb09uUHJvbXB0KGV2ZW50X2RhdGE6IFBhcmFtZXRlcnM8TGlzdGVuZXJUeXBlWydjaGF0X2NvbXBsZXRpb25fcHJvbXB0X3JlYWR5J10+WzBdKSB7XG4gIGlmIChldmVudF9kYXRhLmRyeVJ1bikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGZvciAoY29uc3QgbWVzc2FnZSBvZiBldmVudF9kYXRhLmNoYXQpIHtcbiAgICBmb3IgKGNvbnN0IG1hY3JvIG9mIG1hY3Jvcykge1xuICAgICAgbWVzc2FnZS5jb250ZW50ID0gbWVzc2FnZS5jb250ZW50LnJlcGxhY2UobWFjcm8ucmVnZXgsIChzdWJzdHJpbmc6IHN0cmluZywgLi4uYXJnczogYW55W10pID0+XG4gICAgICAgIG1hY3JvLnJlcGxhY2UoeyByb2xlOiBtZXNzYWdlLnJvbGUgYXMgJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJyB9LCBzdWJzdHJpbmcsIC4uLmFyZ3MpLFxuICAgICAgKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZGVtYWNyb09uUmVuZGVyKG1lc3NhZ2VfaWQ6IHN0cmluZykge1xuICBjb25zdCAkbWVzID0gJChgZGl2Lm1lc1ttZXNpZD1cIiR7bWVzc2FnZV9pZH1cIl1gKTtcbiAgY29uc3QgJG1lc190ZXh0ID0gJG1lcy5maW5kKCcubWVzX3RleHQnKTtcbiAgaWYgKCRtZXNfdGV4dC5sZW5ndGggPT09IDAgfHwgIW1hY3Jvcy5zb21lKG1hY3JvID0+IG1hY3JvLnJlZ2V4LnRlc3QoJG1lc190ZXh0LnRleHQoKSkpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgcmVwbGFjZV9odG1sID0gKGh0bWw6IHN0cmluZykgPT4ge1xuICAgIGZvciAoY29uc3QgbWFjcm8gb2YgbWFjcm9zKSB7XG4gICAgICBodG1sID0gaHRtbC5yZXBsYWNlKG1hY3JvLnJlZ2V4LCAoc3Vic3RyaW5nOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKSA9PlxuICAgICAgICBtYWNyby5yZXBsYWNlKFxuICAgICAgICAgIHsgbWVzc2FnZV9pZDogTnVtYmVyKG1lc3NhZ2VfaWQpLCByb2xlOiAkbWVzLmF0dHIoJ2lzX3VzZXInKSA9PT0gJ3RydWUnID8gJ3VzZXInIDogJ2Fzc2lzdGFudCcgfSxcbiAgICAgICAgICBzdWJzdHJpbmcsXG4gICAgICAgICAgLi4uYXJncyxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBodG1sO1xuICB9O1xuXG4gICRtZXNfdGV4dC5odG1sKChfaW5kZXgsIGh0bWwpID0+IHJlcGxhY2VfaHRtbChodG1sKSk7XG4gICRtZXNfdGV4dFxuICAgIC5maW5kKCdjb2RlJylcbiAgICAuZmlsdGVyKChfaW5kZXgsIG5vZGUpID0+IG1hY3Jvcy5zb21lKG1hY3JvID0+IG1hY3JvLnJlZ2V4LnRlc3QoJChub2RlKS50ZXh0KCkpKSlcbiAgICAudGV4dCgoX2luZGV4LCB0ZXh0KSA9PiByZXBsYWNlX2h0bWwodGV4dCkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyQWxsTWFjcm9zKCkge1xuICAkKCdkaXYubWVzJykuZWFjaCgoX2luZGV4LCBub2RlKSA9PiB7XG4gICAgZGVtYWNyb09uUmVuZGVyKCQobm9kZSkuYXR0cignbWVzaWQnKSEpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVNYWNyb09uRXh0ZW5zaW9uKCkge1xuICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5DSEFUX0NPTVBMRVRJT05fUFJPTVBUX1JFQURZLCBkZW1hY3JvT25Qcm9tcHQpO1xuICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5DSEFSQUNURVJfTUVTU0FHRV9SRU5ERVJFRCwgZGVtYWNyb09uUmVuZGVyKTtcbiAgZXZlbnRTb3VyY2Uub24oZXZlbnRfdHlwZXMuVVNFUl9NRVNTQUdFX1JFTkRFUkVELCBkZW1hY3JvT25SZW5kZXIpO1xuICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5NRVNTQUdFX1VQREFURUQsIGRlbWFjcm9PblJlbmRlcik7XG4gIGV2ZW50U291cmNlLm9uKGV2ZW50X3R5cGVzLk1FU1NBR0VfU1dJUEVELCBkZW1hY3JvT25SZW5kZXIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVzdHJveU1hY3JvT25FeHRlbnNpb24oKSB7XG4gIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50X3R5cGVzLkNIQVRfQ09NUExFVElPTl9QUk9NUFRfUkVBRFksIGRlbWFjcm9PblByb21wdCk7XG4gIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50X3R5cGVzLkNIQVJBQ1RFUl9NRVNTQUdFX1JFTkRFUkVELCBkZW1hY3JvT25SZW5kZXIpO1xuICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudF90eXBlcy5VU0VSX01FU1NBR0VfUkVOREVSRUQsIGRlbWFjcm9PblJlbmRlcik7XG4gIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50X3R5cGVzLk1FU1NBR0VfVVBEQVRFRCwgZGVtYWNyb09uUmVuZGVyKTtcbiAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoZXZlbnRfdHlwZXMuTUVTU0FHRV9TV0lQRUQsIGRlbWFjcm9PblJlbmRlcik7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/macrolike.ts\n")},"./src/component/main.ts":
/*!*******************************!*\
  !*** ./src/component/main.ts ***!
  \*******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initExtensionMainPanel: () => (/* binding */ initExtensionMainPanel)\n/* harmony export */ });\n/* harmony import */ var _component_macro__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/macro */ \"./src/component/macro.ts\");\n/* harmony import */ var _component_macrolike__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/macrolike */ \"./src/component/macrolike.ts\");\n/* harmony import */ var _component_message_iframe__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/message_iframe */ \"./src/component/message_iframe/index.ts\");\n/* harmony import */ var _component_script_iframe__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/script_iframe */ \"./src/component/script_iframe.ts\");\n/* harmony import */ var _component_script_repository_index__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/script_repository/index */ \"./src/component/script_repository/index.ts\");\n/* harmony import */ var _component_toastr__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/toastr */ \"./src/component/toastr.ts\");\n/* harmony import */ var _iframe_client_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/iframe_client/index */ \"./src/iframe_client/index.ts\");\n/* harmony import */ var _iframe_server_index__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/iframe_server/index */ \"./src/iframe_server/index.ts\");\n/* harmony import */ var _iframe_server_variables__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/iframe_server/variables */ \"./src/iframe_server/variables.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n\n\n\n\n\n\n\n\n\n\n\n\nconst handleChatChanged = async () => {\n    (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_1__.renderAllMacros)();\n    await (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.renderAllIframes)();\n    if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_10__.getSettingValue)('render.rendering_optimize')) {\n        (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.addCodeToggleButtonsToAllMessages)();\n    }\n};\nconst handlePartialRender = (mesId) => {\n    const mesIdNumber = parseInt(mesId, 10);\n    (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.renderPartialIframes)(mesIdNumber);\n};\nconst handleMessageDeleted = (mesId) => {\n    const mesIdNumber = parseInt(mesId, 10);\n    (0,_iframe_server_variables__WEBPACK_IMPORTED_MODULE_8__.clearTempVariables)();\n    (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.renderMessageAfterDelete)(mesIdNumber);\n    if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_10__.getSettingValue)('render.rendering_optimize')) {\n        (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.addCodeToggleButtonsToAllMessages)();\n    }\n};\nconst handleVariableUpdated = (mesId) => {\n    const mesIdNumber = parseInt(mesId, 10);\n    (0,_iframe_server_variables__WEBPACK_IMPORTED_MODULE_8__.shouldUpdateVariables)(mesIdNumber);\n};\n/**\n * \n */\nfunction initExtensionMainPanel() {\n    const isEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_10__.getSettingValue)('enabled_extension');\n    if (isEnabled) {\n        handleExtensionToggle(false, true);\n    }\n    $('#extension-enable-toggle')\n        .prop('checked', isEnabled)\n        .on('change', function (event) {\n        handleExtensionToggle(true, $(event.currentTarget).prop('checked'));\n    });\n}\nasync function handleExtensionToggle(userAction = true, enable = true) {\n    if (userAction) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_10__.saveSettingValue)('enabled_extension', enable);\n    }\n    if (enable) {\n        // \n        $('#extension-status-icon').css('color', 'green').next().text('');\n        _script_url__WEBPACK_IMPORTED_MODULE_9__.script_url.set('iframe_client', _iframe_client_index__WEBPACK_IMPORTED_MODULE_6__.iframe_client);\n        _script_url__WEBPACK_IMPORTED_MODULE_9__.script_url.set('viewport_adjust_script', _component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.viewport_adjust_script);\n        _script_url__WEBPACK_IMPORTED_MODULE_9__.script_url.set('tampermonkey_script', _component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.tampermonkey_script);\n        (0,_component_macro__WEBPACK_IMPORTED_MODULE_0__.registerAllMacros)();\n        (0,_component_toastr__WEBPACK_IMPORTED_MODULE_5__.initializeToastr)();\n        (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_1__.initializeMacroOnExtension)();\n        (0,_component_script_iframe__WEBPACK_IMPORTED_MODULE_3__.initializeCharacterLevelOnExtension)();\n        (0,_component_script_repository_index__WEBPACK_IMPORTED_MODULE_4__.buildScriptRepositoryOnExtension)();\n        // \n        if (userAction && (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_10__.getSettingValue)('render.rendering_optimize')) {\n            (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.addRenderingOptimizeSettings)();\n        }\n        if (userAction && (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_10__.getSettingValue)('render.render_hide_style')) {\n            (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.addRenderingHideStyleSettings)();\n        }\n        window.addEventListener('message', _iframe_server_index__WEBPACK_IMPORTED_MODULE_7__.handleIframe);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.event_types.CHAT_CHANGED, handleChatChanged);\n        _component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.partialRenderEvents.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.eventSource.on(eventType, handlePartialRender);\n        });\n        _iframe_server_variables__WEBPACK_IMPORTED_MODULE_8__.checkVariablesEvents.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.eventSource.on(eventType, handleVariableUpdated);\n        });\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.event_types.MESSAGE_DELETED, handleMessageDeleted);\n        if (userAction && _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.this_chid !== undefined) {\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.reloadCurrentChat)();\n        }\n    }\n    else {\n        // \n        $('#extension-status-icon').css('color', 'red').next().text('');\n        _script_url__WEBPACK_IMPORTED_MODULE_9__.script_url.delete('iframe_client');\n        _script_url__WEBPACK_IMPORTED_MODULE_9__.script_url.delete('viewport_adjust_script');\n        _script_url__WEBPACK_IMPORTED_MODULE_9__.script_url.delete('tampermonkey_script');\n        (0,_component_macro__WEBPACK_IMPORTED_MODULE_0__.unregisterAllMacros)();\n        (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_1__.destroyMacroOnExtension)();\n        (0,_component_script_iframe__WEBPACK_IMPORTED_MODULE_3__.destroyCharacterLevelOnExtension)();\n        (0,_component_script_repository_index__WEBPACK_IMPORTED_MODULE_4__.destroyScriptRepositoryOnExtension)();\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_10__.getSettingValue)('render.rendering_optimize')) {\n            (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.removeRenderingOptimizeSettings)();\n        }\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_10__.getSettingValue)('render.render_hide_style')) {\n            (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.removeRenderingHideStyleSettings)();\n        }\n        window.removeEventListener('message', _iframe_server_index__WEBPACK_IMPORTED_MODULE_7__.handleIframe);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.event_types.CHAT_CHANGED, handleChatChanged);\n        _component_message_iframe__WEBPACK_IMPORTED_MODULE_2__.partialRenderEvents.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.eventSource.removeListener(eventType, handlePartialRender);\n        });\n        _iframe_server_variables__WEBPACK_IMPORTED_MODULE_8__.checkVariablesEvents.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.eventSource.removeListener(eventType, handleVariableUpdated);\n        });\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.event_types.MESSAGE_DELETED, handleMessageDeleted);\n        if (userAction && _sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.this_chid !== undefined) {\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.reloadCurrentChat)();\n        }\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_11__.saveSettingsDebounced)();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21haW4udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUEyRTtBQUNrQztBQWF6RTtBQUM4RTtBQUlyRTtBQUNTO0FBQ0E7QUFDRDtBQUN1RDtBQUNsRTtBQUNxQztBQUNxQztBQUVwSCxNQUFNLGlCQUFpQixHQUFHLEtBQUssSUFBSSxFQUFFO0lBQ25DLHFFQUFlLEVBQUUsQ0FBQztJQUNsQixNQUFNLDJFQUFnQixFQUFFLENBQUM7SUFDekIsSUFBSSwyRUFBZSxDQUFDLDJCQUEyQixDQUFDLEVBQUUsQ0FBQztRQUNqRCw0RkFBaUMsRUFBRSxDQUFDO0lBQ3RDLENBQUM7QUFDSCxDQUFDLENBQUM7QUFFRixNQUFNLG1CQUFtQixHQUFHLENBQUMsS0FBYSxFQUFFLEVBQUU7SUFDNUMsTUFBTSxXQUFXLEdBQUcsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN4QywrRUFBb0IsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUNwQyxDQUFDLENBQUM7QUFFRixNQUFNLG9CQUFvQixHQUFHLENBQUMsS0FBYSxFQUFFLEVBQUU7SUFDN0MsTUFBTSxXQUFXLEdBQUcsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN4Qyw0RUFBa0IsRUFBRSxDQUFDO0lBQ3JCLG1GQUF3QixDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ3RDLElBQUksMkVBQWUsQ0FBQywyQkFBMkIsQ0FBQyxFQUFFLENBQUM7UUFDakQsNEZBQWlDLEVBQUUsQ0FBQztJQUN0QyxDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBRUYsTUFBTSxxQkFBcUIsR0FBRyxDQUFDLEtBQWEsRUFBRSxFQUFFO0lBQzlDLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDeEMsK0VBQXFCLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDckMsQ0FBQyxDQUFDO0FBRUY7O0dBRUc7QUFDSSxTQUFTLHNCQUFzQjtJQUNwQyxNQUFNLFNBQVMsR0FBRywyRUFBZSxDQUFDLG1CQUFtQixDQUFDLENBQUM7SUFDdkQsSUFBSSxTQUFTLEVBQUUsQ0FBQztRQUNkLHFCQUFxQixDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNyQyxDQUFDO0lBQ0QsQ0FBQyxDQUFDLDBCQUEwQixDQUFDO1NBQzFCLElBQUksQ0FBQyxTQUFTLEVBQUUsU0FBUyxDQUFDO1NBQzFCLEVBQUUsQ0FBQyxRQUFRLEVBQUUsVUFBVSxLQUF5QjtRQUMvQyxxQkFBcUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztJQUN0RSxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFFRCxLQUFLLFVBQVUscUJBQXFCLENBQUMsYUFBc0IsSUFBSSxFQUFFLFNBQWtCLElBQUk7SUFDckYsSUFBSSxVQUFVLEVBQUUsQ0FBQztRQUNmLDRFQUFnQixDQUFDLG1CQUFtQixFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ2hELENBQUM7SUFDRCxJQUFJLE1BQU0sRUFBRSxDQUFDO1FBQ1gsUUFBUTtRQUNSLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXZFLG1EQUFVLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSwrREFBYSxDQUFDLENBQUM7UUFDL0MsbURBQVUsQ0FBQyxHQUFHLENBQUMsd0JBQXdCLEVBQUUsNkVBQXNCLENBQUMsQ0FBQztRQUNqRSxtREFBVSxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsRUFBRSwwRUFBbUIsQ0FBQyxDQUFDO1FBRTNELG1FQUFpQixFQUFFLENBQUM7UUFDcEIsbUVBQWdCLEVBQUUsQ0FBQztRQUNuQixnRkFBMEIsRUFBRSxDQUFDO1FBQzdCLDZGQUFtQyxFQUFFLENBQUM7UUFDdEMsb0dBQWdDLEVBQUUsQ0FBQztRQUVuQyxrQkFBa0I7UUFDbEIsSUFBSSxVQUFVLElBQUksMkVBQWUsQ0FBQywyQkFBMkIsQ0FBQyxFQUFFLENBQUM7WUFDL0QsdUZBQTRCLEVBQUUsQ0FBQztRQUNqQyxDQUFDO1FBQ0QsSUFBSSxVQUFVLElBQUksMkVBQWUsQ0FBQywwQkFBMEIsQ0FBQyxFQUFFLENBQUM7WUFDOUQsd0ZBQTZCLEVBQUUsQ0FBQztRQUNsQyxDQUFDO1FBRUQsTUFBTSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsRUFBRSw4REFBWSxDQUFDLENBQUM7UUFFakQsNkRBQVcsQ0FBQyxFQUFFLENBQUMsNkRBQVcsQ0FBQyxZQUFZLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztRQUU1RCwwRUFBbUIsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFDdEMsNkRBQVcsQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLG1CQUFtQixDQUFDLENBQUM7UUFDakQsQ0FBQyxDQUFDLENBQUM7UUFFSCwwRUFBb0IsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFDdkMsNkRBQVcsQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLHFCQUFxQixDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDLENBQUM7UUFDSCw2REFBVyxDQUFDLEVBQUUsQ0FBQyw2REFBVyxDQUFDLGVBQWUsRUFBRSxvQkFBb0IsQ0FBQyxDQUFDO1FBQ2xFLElBQUksVUFBVSxJQUFJLDJEQUFTLEtBQUssU0FBUyxFQUFFLENBQUM7WUFDMUMsTUFBTSx1RUFBaUIsRUFBRSxDQUFDO1FBQzVCLENBQUM7SUFDSCxDQUFDO1NBQU0sQ0FBQztRQUNOLFFBQVE7UUFDUixDQUFDLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUVyRSxtREFBVSxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUNuQyxtREFBVSxDQUFDLE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1FBQzVDLG1EQUFVLENBQUMsTUFBTSxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFFekMscUVBQW1CLEVBQUUsQ0FBQztRQUN0Qiw2RUFBdUIsRUFBRSxDQUFDO1FBQzFCLDBGQUFnQyxFQUFFLENBQUM7UUFDbkMsc0dBQWtDLEVBQUUsQ0FBQztRQUVyQyxJQUFJLDJFQUFlLENBQUMsMkJBQTJCLENBQUMsRUFBRSxDQUFDO1lBQ2pELDBGQUErQixFQUFFLENBQUM7UUFDcEMsQ0FBQztRQUVELElBQUksMkVBQWUsQ0FBQywwQkFBMEIsQ0FBQyxFQUFFLENBQUM7WUFDaEQsMkZBQWdDLEVBQUUsQ0FBQztRQUNyQyxDQUFDO1FBRUQsTUFBTSxDQUFDLG1CQUFtQixDQUFDLFNBQVMsRUFBRSw4REFBWSxDQUFDLENBQUM7UUFFcEQsNkRBQVcsQ0FBQyxjQUFjLENBQUMsNkRBQVcsQ0FBQyxZQUFZLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztRQUV4RSwwRUFBbUIsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFDdEMsNkRBQVcsQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLG1CQUFtQixDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFDSCwwRUFBb0IsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFDdkMsNkRBQVcsQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLHFCQUFxQixDQUFDLENBQUM7UUFDL0QsQ0FBQyxDQUFDLENBQUM7UUFDSCw2REFBVyxDQUFDLGNBQWMsQ0FBQyw2REFBVyxDQUFDLGVBQWUsRUFBRSxvQkFBb0IsQ0FBQyxDQUFDO1FBQzlFLElBQUksVUFBVSxJQUFJLDJEQUFTLEtBQUssU0FBUyxFQUFFLENBQUM7WUFDMUMsTUFBTSx1RUFBaUIsRUFBRSxDQUFDO1FBQzVCLENBQUM7SUFDSCxDQUFDO0lBQ0QsMkVBQXFCLEVBQUUsQ0FBQztBQUMxQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9tYWluLnRzPzk3YjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVnaXN0ZXJBbGxNYWNyb3MsIHVucmVnaXN0ZXJBbGxNYWNyb3MgfSBmcm9tICdAL2NvbXBvbmVudC9tYWNybyc7XG5pbXBvcnQgeyBkZXN0cm95TWFjcm9PbkV4dGVuc2lvbiwgaW5pdGlhbGl6ZU1hY3JvT25FeHRlbnNpb24sIHJlbmRlckFsbE1hY3JvcyB9IGZyb20gJ0AvY29tcG9uZW50L21hY3JvbGlrZSc7XG5pbXBvcnQge1xuICBhZGRDb2RlVG9nZ2xlQnV0dG9uc1RvQWxsTWVzc2FnZXMsXG4gIGFkZFJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzLFxuICBhZGRSZW5kZXJpbmdPcHRpbWl6ZVNldHRpbmdzLFxuICBwYXJ0aWFsUmVuZGVyRXZlbnRzLFxuICByZW1vdmVSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncyxcbiAgcmVtb3ZlUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncyxcbiAgcmVuZGVyQWxsSWZyYW1lcyxcbiAgcmVuZGVyTWVzc2FnZUFmdGVyRGVsZXRlLFxuICByZW5kZXJQYXJ0aWFsSWZyYW1lcyxcbiAgdGFtcGVybW9ua2V5X3NjcmlwdCxcbiAgdmlld3BvcnRfYWRqdXN0X3NjcmlwdCxcbn0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUnO1xuaW1wb3J0IHsgZGVzdHJveUNoYXJhY3RlckxldmVsT25FeHRlbnNpb24sIGluaXRpYWxpemVDaGFyYWN0ZXJMZXZlbE9uRXh0ZW5zaW9uIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X2lmcmFtZSc7XG5pbXBvcnQge1xuICBidWlsZFNjcmlwdFJlcG9zaXRvcnlPbkV4dGVuc2lvbixcbiAgZGVzdHJveVNjcmlwdFJlcG9zaXRvcnlPbkV4dGVuc2lvbixcbn0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvaW5kZXgnO1xuaW1wb3J0IHsgaW5pdGlhbGl6ZVRvYXN0ciB9IGZyb20gJ0AvY29tcG9uZW50L3RvYXN0cic7XG5pbXBvcnQgeyBpZnJhbWVfY2xpZW50IH0gZnJvbSAnQC9pZnJhbWVfY2xpZW50L2luZGV4JztcbmltcG9ydCB7IGhhbmRsZUlmcmFtZSB9IGZyb20gJ0AvaWZyYW1lX3NlcnZlci9pbmRleCc7XG5pbXBvcnQgeyBjaGVja1ZhcmlhYmxlc0V2ZW50cywgY2xlYXJUZW1wVmFyaWFibGVzLCBzaG91bGRVcGRhdGVWYXJpYWJsZXMgfSBmcm9tICdAL2lmcmFtZV9zZXJ2ZXIvdmFyaWFibGVzJztcbmltcG9ydCB7IHNjcmlwdF91cmwgfSBmcm9tICdAL3NjcmlwdF91cmwnO1xuaW1wb3J0IHsgZ2V0U2V0dGluZ1ZhbHVlLCBzYXZlU2V0dGluZ1ZhbHVlIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuaW1wb3J0IHsgZXZlbnRTb3VyY2UsIGV2ZW50X3R5cGVzLCByZWxvYWRDdXJyZW50Q2hhdCwgc2F2ZVNldHRpbmdzRGVib3VuY2VkLCB0aGlzX2NoaWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcblxuY29uc3QgaGFuZGxlQ2hhdENoYW5nZWQgPSBhc3luYyAoKSA9PiB7XG4gIHJlbmRlckFsbE1hY3JvcygpO1xuICBhd2FpdCByZW5kZXJBbGxJZnJhbWVzKCk7XG4gIGlmIChnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJpbmdfb3B0aW1pemUnKSkge1xuICAgIGFkZENvZGVUb2dnbGVCdXR0b25zVG9BbGxNZXNzYWdlcygpO1xuICB9XG59O1xuXG5jb25zdCBoYW5kbGVQYXJ0aWFsUmVuZGVyID0gKG1lc0lkOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgbWVzSWROdW1iZXIgPSBwYXJzZUludChtZXNJZCwgMTApO1xuICByZW5kZXJQYXJ0aWFsSWZyYW1lcyhtZXNJZE51bWJlcik7XG59O1xuXG5jb25zdCBoYW5kbGVNZXNzYWdlRGVsZXRlZCA9IChtZXNJZDogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IG1lc0lkTnVtYmVyID0gcGFyc2VJbnQobWVzSWQsIDEwKTtcbiAgY2xlYXJUZW1wVmFyaWFibGVzKCk7XG4gIHJlbmRlck1lc3NhZ2VBZnRlckRlbGV0ZShtZXNJZE51bWJlcik7XG4gIGlmIChnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJpbmdfb3B0aW1pemUnKSkge1xuICAgIGFkZENvZGVUb2dnbGVCdXR0b25zVG9BbGxNZXNzYWdlcygpO1xuICB9XG59O1xuXG5jb25zdCBoYW5kbGVWYXJpYWJsZVVwZGF0ZWQgPSAobWVzSWQ6IHN0cmluZykgPT4ge1xuICBjb25zdCBtZXNJZE51bWJlciA9IHBhcnNlSW50KG1lc0lkLCAxMCk7XG4gIHNob3VsZFVwZGF0ZVZhcmlhYmxlcyhtZXNJZE51bWJlcik7XG59O1xuXG4vKipcbiAqIOWIneWni+WMluaJqeWxleS4u+iuvue9rueVjOmdolxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdEV4dGVuc2lvbk1haW5QYW5lbCgpIHtcbiAgY29uc3QgaXNFbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdlbmFibGVkX2V4dGVuc2lvbicpO1xuICBpZiAoaXNFbmFibGVkKSB7XG4gICAgaGFuZGxlRXh0ZW5zaW9uVG9nZ2xlKGZhbHNlLCB0cnVlKTtcbiAgfVxuICAkKCcjZXh0ZW5zaW9uLWVuYWJsZS10b2dnbGUnKVxuICAgIC5wcm9wKCdjaGVja2VkJywgaXNFbmFibGVkKVxuICAgIC5vbignY2hhbmdlJywgZnVuY3Rpb24gKGV2ZW50OiBKUXVlcnkuQ2hhbmdlRXZlbnQpIHtcbiAgICAgIGhhbmRsZUV4dGVuc2lvblRvZ2dsZSh0cnVlLCAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLnByb3AoJ2NoZWNrZWQnKSk7XG4gICAgfSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUV4dGVuc2lvblRvZ2dsZSh1c2VyQWN0aW9uOiBib29sZWFuID0gdHJ1ZSwgZW5hYmxlOiBib29sZWFuID0gdHJ1ZSkge1xuICBpZiAodXNlckFjdGlvbikge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2VuYWJsZWRfZXh0ZW5zaW9uJywgZW5hYmxlKTtcbiAgfVxuICBpZiAoZW5hYmxlKSB7XG4gICAgLy8g5oyH56S65Zmo5qC35byPXG4gICAgJCgnI2V4dGVuc2lvbi1zdGF0dXMtaWNvbicpLmNzcygnY29sb3InLCAnZ3JlZW4nKS5uZXh0KCkudGV4dCgn5omp5bGV5bey5ZCv55SoJyk7XG5cbiAgICBzY3JpcHRfdXJsLnNldCgnaWZyYW1lX2NsaWVudCcsIGlmcmFtZV9jbGllbnQpO1xuICAgIHNjcmlwdF91cmwuc2V0KCd2aWV3cG9ydF9hZGp1c3Rfc2NyaXB0Jywgdmlld3BvcnRfYWRqdXN0X3NjcmlwdCk7XG4gICAgc2NyaXB0X3VybC5zZXQoJ3RhbXBlcm1vbmtleV9zY3JpcHQnLCB0YW1wZXJtb25rZXlfc2NyaXB0KTtcblxuICAgIHJlZ2lzdGVyQWxsTWFjcm9zKCk7XG4gICAgaW5pdGlhbGl6ZVRvYXN0cigpO1xuICAgIGluaXRpYWxpemVNYWNyb09uRXh0ZW5zaW9uKCk7XG4gICAgaW5pdGlhbGl6ZUNoYXJhY3RlckxldmVsT25FeHRlbnNpb24oKTtcbiAgICBidWlsZFNjcmlwdFJlcG9zaXRvcnlPbkV4dGVuc2lvbigpO1xuXG4gICAgLy8g6YeN5paw5rOo5YWl5YmN56uv5Y2h5LyY5YyW55qE5qC35byP5ZKM6K6+572uXG4gICAgaWYgKHVzZXJBY3Rpb24gJiYgZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyaW5nX29wdGltaXplJykpIHtcbiAgICAgIGFkZFJlbmRlcmluZ09wdGltaXplU2V0dGluZ3MoKTtcbiAgICB9XG4gICAgaWYgKHVzZXJBY3Rpb24gJiYgZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2hpZGVfc3R5bGUnKSkge1xuICAgICAgYWRkUmVuZGVyaW5nSGlkZVN0eWxlU2V0dGluZ3MoKTtcbiAgICB9XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGhhbmRsZUlmcmFtZSk7XG5cbiAgICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5DSEFUX0NIQU5HRUQsIGhhbmRsZUNoYXRDaGFuZ2VkKTtcblxuICAgIHBhcnRpYWxSZW5kZXJFdmVudHMuZm9yRWFjaChldmVudFR5cGUgPT4ge1xuICAgICAgZXZlbnRTb3VyY2Uub24oZXZlbnRUeXBlLCBoYW5kbGVQYXJ0aWFsUmVuZGVyKTtcbiAgICB9KTtcblxuICAgIGNoZWNrVmFyaWFibGVzRXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICAgIGV2ZW50U291cmNlLm9uKGV2ZW50VHlwZSwgaGFuZGxlVmFyaWFibGVVcGRhdGVkKTtcbiAgICB9KTtcbiAgICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5NRVNTQUdFX0RFTEVURUQsIGhhbmRsZU1lc3NhZ2VEZWxldGVkKTtcbiAgICBpZiAodXNlckFjdGlvbiAmJiB0aGlzX2NoaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8g5oyH56S65Zmo5qC35byPXG4gICAgJCgnI2V4dGVuc2lvbi1zdGF0dXMtaWNvbicpLmNzcygnY29sb3InLCAncmVkJykubmV4dCgpLnRleHQoJ+aJqeWxleW3suemgeeUqCcpO1xuXG4gICAgc2NyaXB0X3VybC5kZWxldGUoJ2lmcmFtZV9jbGllbnQnKTtcbiAgICBzY3JpcHRfdXJsLmRlbGV0ZSgndmlld3BvcnRfYWRqdXN0X3NjcmlwdCcpO1xuICAgIHNjcmlwdF91cmwuZGVsZXRlKCd0YW1wZXJtb25rZXlfc2NyaXB0Jyk7XG5cbiAgICB1bnJlZ2lzdGVyQWxsTWFjcm9zKCk7XG4gICAgZGVzdHJveU1hY3JvT25FeHRlbnNpb24oKTtcbiAgICBkZXN0cm95Q2hhcmFjdGVyTGV2ZWxPbkV4dGVuc2lvbigpO1xuICAgIGRlc3Ryb3lTY3JpcHRSZXBvc2l0b3J5T25FeHRlbnNpb24oKTtcblxuICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJpbmdfb3B0aW1pemUnKSkge1xuICAgICAgcmVtb3ZlUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncygpO1xuICAgIH1cblxuICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfaGlkZV9zdHlsZScpKSB7XG4gICAgICByZW1vdmVSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncygpO1xuICAgIH1cblxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgaGFuZGxlSWZyYW1lKTtcblxuICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50X3R5cGVzLkNIQVRfQ0hBTkdFRCwgaGFuZGxlQ2hhdENoYW5nZWQpO1xuXG4gICAgcGFydGlhbFJlbmRlckV2ZW50cy5mb3JFYWNoKGV2ZW50VHlwZSA9PiB7XG4gICAgICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudFR5cGUsIGhhbmRsZVBhcnRpYWxSZW5kZXIpO1xuICAgIH0pO1xuICAgIGNoZWNrVmFyaWFibGVzRXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50VHlwZSwgaGFuZGxlVmFyaWFibGVVcGRhdGVkKTtcbiAgICB9KTtcbiAgICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudF90eXBlcy5NRVNTQUdFX0RFTEVURUQsIGhhbmRsZU1lc3NhZ2VEZWxldGVkKTtcbiAgICBpZiAodXNlckFjdGlvbiAmJiB0aGlzX2NoaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgICB9XG4gIH1cbiAgc2F2ZVNldHRpbmdzRGVib3VuY2VkKCk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/main.ts\n")},"./src/component/message_iframe/index.ts":
/*!***********************************************!*\
  !*** ./src/component/message_iframe/index.ts ***!
  \***********************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addCodeToggleButtonsToAllMessages: () => (/* binding */ addCodeToggleButtonsToAllMessages),\n/* harmony export */   addRenderingHideStyleSettings: () => (/* binding */ addRenderingHideStyleSettings),\n/* harmony export */   addRenderingOptimizeSettings: () => (/* binding */ addRenderingOptimizeSettings),\n/* harmony export */   clearAllIframes: () => (/* binding */ clearAllIframes),\n/* harmony export */   clearAndRenderAllIframes: () => (/* binding */ clearAndRenderAllIframes),\n/* harmony export */   defaultIframeSettings: () => (/* binding */ defaultIframeSettings),\n/* harmony export */   destroyIframe: () => (/* binding */ destroyIframe),\n/* harmony export */   handlePartialRender: () => (/* binding */ handlePartialRender),\n/* harmony export */   handleRenderToggle: () => (/* binding */ handleRenderToggle),\n/* harmony export */   initIframePanel: () => (/* binding */ initIframePanel),\n/* harmony export */   injectCodeBlockHideStyles: () => (/* binding */ injectCodeBlockHideStyles),\n/* harmony export */   injectLoadingStyles: () => (/* binding */ injectLoadingStyles),\n/* harmony export */   partialRenderEvents: () => (/* binding */ partialRenderEvents),\n/* harmony export */   removeRenderingHideStyleSettings: () => (/* binding */ removeRenderingHideStyleSettings),\n/* harmony export */   removeRenderingOptimizeSettings: () => (/* binding */ removeRenderingOptimizeSettings),\n/* harmony export */   renderAllIframes: () => (/* binding */ renderAllIframes),\n/* harmony export */   renderMessageAfterDelete: () => (/* binding */ renderMessageAfterDelete),\n/* harmony export */   renderPartialIframes: () => (/* binding */ renderPartialIframes),\n/* harmony export */   tampermonkey_script: () => (/* binding */ tampermonkey_script),\n/* harmony export */   viewport_adjust_script: () => (/* binding */ viewport_adjust_script)\n/* harmony export */ });\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _third_party_html__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/third_party.html */ \"./src/third_party.html\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n\n\n\n\n\nlet isExtensionEnabled;\nlet tampermonkeyMessageListener = null;\nlet isRenderEnabled;\nlet isRenderingOptimizeEnabled;\nlet isRenderingHideStyleEnabled;\nlet renderDepth;\nlet isTampermonkeyEnabled;\n// \nconst originalHighlightElement = hljs.highlightElement;\nconst RENDER_MODES = {\n    FULL: 'FULL',\n    PARTIAL: 'PARTIAL',\n};\nconst partialRenderEvents = [\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.event_types.CHARACTER_MESSAGE_RENDERED,\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.event_types.USER_MESSAGE_RENDERED,\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.event_types.MESSAGE_UPDATED,\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.event_types.MESSAGE_SWIPED,\n];\nconst defaultIframeSettings = {\n    render_enabled: true,\n    tampermonkey_compatibility: false,\n    render_depth: 0,\n    render_optimize: false,\n};\nasync function handleRenderToggle(userInput = true, enable = true) {\n    if (enable) {\n        renderMessagesInIframes(RENDER_MODES.FULL);\n    }\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('render.render_enabled', enable);\n    }\n}\n/**\n * iframe\n */\nasync function clearAndRenderAllIframes() {\n    await clearAllIframes();\n    if (_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.this_chid !== undefined) {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.reloadCurrentChat)();\n        await renderAllIframes();\n    }\n}\n/**\n * iframe\n */\nasync function renderAllIframes() {\n    await renderMessagesInIframes(RENDER_MODES.FULL);\n    console.log('[Render] iframe');\n}\n/**\n * iframe\n * @param mesId ID\n */\nasync function renderPartialIframes(mesId) {\n    const processDepth = parseInt($('#render-depth').val(), 10);\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_4__.getContext)();\n    const totalMessages = context.chat.length;\n    if (processDepth > 0) {\n        const depthOffset = totalMessages - processDepth;\n        if (mesId < depthOffset) {\n            return;\n        }\n    }\n    await renderMessagesInIframes(RENDER_MODES.PARTIAL, mesId);\n    console.log('[Render] ' + mesId + 'iframe');\n}\n/**\n * min-height:vhiframe\n */\nconst viewport_adjust_script = `\n$(window).on(\"message\", function (event) {\n    if (event.originalEvent.data.request === \"updateViewportHeight\") {\n        const newHeight = event.originalEvent.data.newHeight;\n        $(\"html\").css(\"--viewport-height\", newHeight + \"px\");\n    }\n});\n`;\n/**\n * \n */\nconst tampermonkey_script = `\nclass AudioManager {\n  constructor() {\n    this.currentlyPlaying = null;\n  }\n  handlePlay(audio) {\n    if (this.currentlyPlaying && this.currentlyPlaying !== audio) {\n      this.currentlyPlaying.pause();\n    }\n    window.parent.postMessage({\n      type: 'audioPlay',\n      iframeId: window.frameElement.id\n    }, '*');\n\n    this.currentlyPlaying = audio;\n  }\n  stopAll() {\n    if (this.currentlyPlaying) {\n      this.currentlyPlaying.pause();\n      this.currentlyPlaying = null;\n    }\n  }\n}\nconst audioManager = new AudioManager();\n$('.qr-button').on('click', function() {\n  const buttonName = $(this).text().trim();\n  window.parent.postMessage({ type: 'buttonClick', name: buttonName }, '*');\n});\n$('.st-text').each(function() {\n  $(this).on('input', function() {\n    window.parent.postMessage({ type: 'textInput', text: $(this).val() }, '*');\n  });\n  $(this).on('change', function() {\n    window.parent.postMessage({ type: 'textInput', text: $(this).val() }, '*');\n  });\n  const textarea = this;\n  const observer = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n      if (mutation.type === 'attributes' && mutation.attributeName === 'value') {\n        window.parent.postMessage({ type: 'textInput', text: $(textarea).val() }, '*');\n      }\n    });\n  });\n  observer.observe(textarea, { attributes: true });\n});\n$('.st-send-button').on('click', function() {\n  window.parent.postMessage({ type: 'sendClick' }, '*');\n});\n$('.st-audio').on('play', function() {\n  audioManager.handlePlay(this);\n});\n$(window).on('message', function(event) {\n  if (event.originalEvent.data.type === 'stopAudio' &&\n    event.originalEvent.data.iframeId !== window.frameElement.id) {\n    audioManager.stopAll();\n  }\n});\n`;\n/**\n * min-height:vh\n * @param htmlContent \n * @returns \n */\nfunction processVhUnits(htmlContent) {\n    const hasMinVh = /min-height:\\s*[^;]*vh/.test(htmlContent);\n    if (!hasMinVh) {\n        return htmlContent;\n    }\n    const viewportHeight = window.innerHeight;\n    const processedContent = htmlContent.replace(/min-height:\\s*([^;]*vh[^;]*);/g, expression => {\n        const processedExpression = expression.replace(/(\\d+)vh/g, `calc(var(--viewport-height, ${viewportHeight}px) * $1 / 100)`);\n        return `${processedExpression};`;\n    });\n    return processedContent;\n}\n/**\n * min-height:vhiframeviewport\n */\nfunction updateIframeViewportHeight() {\n    $(window).on('resize', function () {\n        if ($('iframe[data-needs-vh=\"true\"]').length) {\n            const viewportHeight = window.innerHeight;\n            $('iframe[data-needs-vh=\"true\"]').each(function () {\n                const iframe = this;\n                if (iframe.contentWindow) {\n                    iframe.contentWindow.postMessage({\n                        request: 'updateViewportHeight',\n                        newHeight: viewportHeight,\n                    }, '*');\n                }\n            });\n        }\n    });\n}\n/**\n * iframe\n * @param mode \n * @param specificMesId ID\n */\nasync function renderMessagesInIframes(mode = RENDER_MODES.FULL, specificMesId = null) {\n    if (isExtensionEnabled === undefined) {\n        isExtensionEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('enabled_extension');\n    }\n    if (!isExtensionEnabled || !isRenderEnabled) {\n        return;\n    }\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_4__.getContext)();\n    const totalMessages = context.chat.length;\n    const processDepth = renderDepth ?? 0;\n    const depthLimit = processDepth > 0 ? processDepth : totalMessages;\n    const depthLimitedMessageIds = [...Array(totalMessages).keys()].slice(-depthLimit);\n    let messagesToRenderIds = [];\n    const messagesToCancelIds = [...Array(totalMessages).keys()].filter(id => !depthLimitedMessageIds.includes(id));\n    if (mode === RENDER_MODES.FULL) {\n        messagesToRenderIds = depthLimitedMessageIds;\n    }\n    else if (mode === RENDER_MODES.PARTIAL && specificMesId !== null) {\n        if (depthLimitedMessageIds.includes(specificMesId)) {\n            messagesToRenderIds = [specificMesId];\n        }\n        else {\n            return;\n        }\n    }\n    for (const messageId of messagesToCancelIds) {\n        const message = context.chat[messageId];\n        const $iframes = $(`[id^=\"message-iframe-${messageId}-\"]`);\n        if ($iframes.length > 0) {\n            await Promise.all($iframes.toArray().map(async (iframe) => {\n                await destroyIframe(iframe);\n            }));\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.updateMessageBlock)(messageId, message);\n        }\n        if (isRenderingHideStyleEnabled) {\n            const $mesText = $(`.mes[mesid=\"${messageId}\"] .mes_block .mes_reasoning_details, .mes[mesid=\"${messageId}\"] .mes_block .mes_text`);\n            addToggleButtonsToMessage($mesText);\n        }\n    }\n    for (const messageId of messagesToRenderIds) {\n        const $messageElement = $(`.mes[mesid=\"${messageId}\"]`);\n        if (!$messageElement.length) {\n            console.debug(` mesid: ${messageId} `);\n            continue;\n        }\n        const $codeElements = $messageElement.find('pre');\n        if (!$codeElements.length) {\n            continue;\n        }\n        let iframeCounter = 1;\n        $codeElements.each(function () {\n            let extractedText = extractTextFromCode(this);\n            const shouldHaveButton = shouldHaveCodeToggle(this);\n            const shouldRenderAsIframe = !shouldHaveButton;\n            if (shouldHaveButton && isRenderingHideStyleEnabled) {\n                const $pre = $(this);\n                addToggleButtonToCodeBlock($pre);\n            }\n            if (shouldRenderAsIframe) {\n                const disableLoading = /\x3c!--\\s*disable-default-loading\\s*--\x3e/.test(extractedText);\n                const hasMinVh = /min-height:\\s*[^;]*vh/.test(extractedText);\n                extractedText = hasMinVh ? processVhUnits(extractedText) : extractedText;\n                let $wrapper = $('<div>').css({\n                    position: 'relative',\n                    width: '100%',\n                });\n                const $iframe = $('<iframe>')\n                    .attr({\n                    id: `message-iframe-${messageId}-${iframeCounter}`,\n                    srcdoc: '',\n                    loading: 'lazy',\n                })\n                    .css({\n                    margin: '5px auto',\n                    border: 'none',\n                    width: '100%',\n                });\n                iframeCounter++;\n                if (hasMinVh) {\n                    $iframe.attr('data-needs-vh', 'true');\n                }\n                let loadingTimeout = null;\n                if (!disableLoading) {\n                    const $loadingOverlay = $('<div>').addClass('iframe-loading-overlay').html(`\n              <div class=\"iframe-loading-content\">\n                <i class=\"fa-solid fa-spinner fa-spin\"></i>\n                <span class=\"loading-text\">Loading...</span>\n              </div>`);\n                    loadingTimeout = setTimeout(() => {\n                        const $loadingText = $loadingOverlay.find('.loading-text');\n                        if ($loadingText.length) {\n                            $loadingText.text('');\n                        }\n                    }, 10000);\n                    $wrapper.append($loadingOverlay);\n                }\n                $wrapper.append($iframe);\n                const srcdocContent = `\n          <html>\n          <head>\n            <style>\n            ${hasMinVh ? `:root{--viewport-height:${window.innerHeight}px;}` : ``}\n            html,body{margin:0;padding:0;overflow:hidden;max-width:100%!important;box-sizing:border-box}\n            .user_avatar,.user-avatar{background-image:url('${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getUserAvatarPath)()}')}\n            .char_avatar,.char-avatar{background-image:url('${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getCharAvatarPath)()}')}\n            </style>\n            ${_third_party_html__WEBPACK_IMPORTED_MODULE_1__[\"default\"]}\n            <script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_0__.script_url.get('iframe_client')}\"><\/script>\n          </head>\n          <body>\n            ${extractedText}\n            ${hasMinVh ? `<script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_0__.script_url.get('viewport_adjust_script')}\"><\/script>` : ``}\n            ${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('render.tampermonkey_compatibility')\n                    ? `<script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_0__.script_url.get('tampermonkey_script')}\"><\/script>`\n                    : ``}\n          </body>\n          </html>\n        `;\n                $iframe.attr('srcdoc', srcdocContent);\n                $iframe.on('load', function () {\n                    observeIframeContent(this);\n                    $wrapper = $(this).parent();\n                    if ($wrapper.length) {\n                        const $loadingOverlay = $wrapper.find('.iframe-loading-overlay');\n                        if ($loadingOverlay.length) {\n                            $loadingOverlay.css('opacity', '0');\n                            setTimeout(() => $loadingOverlay.remove(), 300);\n                        }\n                    }\n                    if ($(this).attr('data-needs-vh') === 'true') {\n                        const iframe = this;\n                        if (iframe.contentWindow) {\n                            iframe.contentWindow.postMessage({\n                                request: 'updateViewportHeight',\n                                newHeight: window.innerHeight,\n                            }, '*');\n                        }\n                    }\n                    _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.emitAndWait('message_iframe_render_ended', this.id);\n                    if (isRenderingHideStyleEnabled) {\n                        removeCodeToggleButtonsByMesId(messageId);\n                    }\n                    if (loadingTimeout) {\n                        clearTimeout(loadingTimeout);\n                    }\n                });\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.emitAndWait('message_iframe_render_started', $iframe.attr('id'));\n                $(this).replaceWith($wrapper);\n            }\n        });\n    }\n}\n/**\n * ResizeObserver\n */\nfunction getSharedResizeObserver() {\n    if (!window._sharedResizeObserver) {\n        window._observedElements = new Map();\n        window._sharedResizeObserver = new ResizeObserver(entries => {\n            for (const entry of entries) {\n                const element = entry.target;\n                const data = window._observedElements?.get(element);\n                if (data) {\n                    const { iframe } = data;\n                    adjustIframeHeight(iframe);\n                }\n            }\n        });\n        console.log('Created shared ResizeObserver instance');\n    }\n    return window._sharedResizeObserver;\n}\n/**\n * iframe\n * @param iframe iframe\n */\nfunction observeIframeContent(iframe) {\n    const $iframe = $(iframe);\n    if (!$iframe.length || !$iframe[0].contentWindow || !$iframe[0].contentWindow.document.body) {\n        return;\n    }\n    try {\n        const docBody = $iframe[0].contentWindow.document.body;\n        const resizeObserver = getSharedResizeObserver();\n        if (window._observedElements) {\n            for (const [element, data] of window._observedElements.entries()) {\n                if (data.iframe === iframe) {\n                    resizeObserver.unobserve(element);\n                    window._observedElements.delete(element);\n                    break;\n                }\n            }\n        }\n        window._observedElements?.set(docBody, { iframe });\n        resizeObserver.observe(docBody);\n        adjustIframeHeight(iframe);\n    }\n    catch (error) {\n        console.error('[Render]  iframe :', error);\n    }\n}\n/**\n * iframe\n * @param iframe iframe\n */\nfunction destroyIframe(iframe) {\n    return new Promise(resolve => {\n        const $iframe = $(iframe);\n        if (!$iframe.length) {\n            resolve();\n            return;\n        }\n        const iframeId = $iframe.attr('id');\n        $iframe.off();\n        try {\n            if ($iframe[0].contentWindow) {\n                const iframeDoc = $iframe[0].contentWindow.document;\n                if (iframeDoc) {\n                    $(iframeDoc).find('*').off();\n                    $(iframeDoc).off();\n                }\n            }\n        }\n        catch (e) {\n            console.debug('[Render] iframe:', e);\n        }\n        try {\n            const $mediaElements = $iframe.contents().find('audio, video');\n            $mediaElements.each(function () {\n                if (this instanceof HTMLMediaElement) {\n                    this.pause();\n                    this.src = '';\n                    this.load();\n                    $(this).off();\n                }\n            });\n        }\n        catch (e) {\n            console.debug('[Render] :', e);\n        }\n        if ($iframe[0].contentWindow && 'stop' in $iframe[0].contentWindow) {\n            $iframe[0].contentWindow.stop();\n        }\n        // ResizeObserver\n        if (window._sharedResizeObserver && window._observedElements) {\n            for (const [element, data] of window._observedElements.entries()) {\n                if (data.iframe === iframe) {\n                    window._sharedResizeObserver.unobserve(element);\n                    window._observedElements.delete(element);\n                    break;\n                }\n            }\n        }\n        // iframe\n        if ($iframe[0].contentWindow) {\n            try {\n                if (iframeId && typeof _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.removeListener === 'function') {\n                    _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.removeListener('message_iframe_render_ended', iframeId);\n                    _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.removeListener('message_iframe_render_started', iframeId);\n                }\n                $iframe.attr('src', 'about:blank');\n            }\n            catch (e) {\n                console.debug('[Render] iframe:', e);\n            }\n        }\n        // DOM\n        $iframe.remove();\n        // jQuery\n        try {\n            $iframe.removeData();\n        }\n        catch (e) {\n            console.debug('[Render] jQuery:', e);\n        }\n        if (window._observedElements?.size === 0 && window._sharedResizeObserver) {\n            window._sharedResizeObserver.disconnect();\n            window._sharedResizeObserver = undefined;\n            console.log('[Render] iframe');\n        }\n        // resolve\n        setTimeout(() => {\n            resolve();\n        }, 0);\n    });\n}\n/**\n * iframe\n * @returns {Promise<void>}\n */\nasync function clearAllIframes() {\n    const $iframes = $('iframe[id^=\"message-iframe\"]');\n    await Promise.all($iframes.toArray().map(async (iframe) => {\n        await destroyIframe(iframe);\n    }));\n    // \n    try {\n        if (typeof _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.removeListener === 'function') {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.removeListener('message_iframe_render_started', null);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.removeListener('message_iframe_render_ended', null);\n        }\n    }\n    catch (e) {\n        console.debug('[Render] :', e);\n    }\n    // \n    try {\n        let arr = [];\n        for (let i = 0; i < 10; i++) {\n            arr.push(new Array(1000000).fill(1));\n        }\n        arr = null;\n        if (window.gc) {\n            window.gc();\n        }\n    }\n    catch (e) {\n        console.debug(':', e);\n    }\n}\n/**\n * iframe\n * @returns {MutationObserver} \n */\nfunction setupIframeRemovalListener() {\n    const observer = new MutationObserver(mutations => {\n        mutations.forEach(mutation => {\n            if (mutation.removedNodes.length) {\n                mutation.removedNodes.forEach(node => {\n                    if (node instanceof HTMLIFrameElement) {\n                        destroyIframe(node).catch(err => {\n                            console.error('[Render] iframe:', err);\n                        });\n                    }\n                    else if (node instanceof HTMLElement) {\n                        const iframes = node.querySelectorAll('iframe');\n                        if (iframes.length) {\n                            iframes.forEach(iframe => {\n                                destroyIframe(iframe).catch(err => {\n                                    console.error('[Render] iframe:', err);\n                                });\n                            });\n                        }\n                    }\n                });\n            }\n        });\n    });\n    observer.observe(document.body, { childList: true, subtree: true });\n    return observer;\n}\n/**\n * \n * @param event \n */\nfunction handleTampermonkeyMessages(event) {\n    if (event.data.type === 'buttonClick') {\n        const buttonName = event.data.name;\n        $('.qr--button.menu_button').each(function () {\n            if ($(this).find('.qr--button-label').text().trim() === buttonName) {\n                $(this).trigger('click');\n            }\n        });\n    }\n    else if (event.data.type === 'textInput') {\n        const $sendTextarea = jQuery('#send_textarea');\n        if ($sendTextarea.length) {\n            $sendTextarea.val(event.data.text).trigger('input').trigger('change');\n        }\n    }\n    else if (event.data.type === 'sendClick') {\n        const $sendButton = jQuery('#send_but');\n        if ($sendButton.length) {\n            $sendButton.trigger('click');\n        }\n    }\n}\n/**\n * -\n */\nfunction createGlobalAudioManager() {\n    let currentPlayingIframeId = null;\n    window.addEventListener('message', function (event) {\n        if (event.data.type === 'audioPlay') {\n            const newIframeId = event.data.iframeId;\n            if (currentPlayingIframeId && currentPlayingIframeId !== newIframeId) {\n                $('iframe').each(function () {\n                    const iframe = this;\n                    if (iframe.contentWindow) {\n                        iframe.contentWindow.postMessage({\n                            type: 'stopAudio',\n                            iframeId: newIframeId,\n                        }, '*');\n                    }\n                });\n            }\n            currentPlayingIframeId = newIframeId;\n        }\n    });\n}\n/**\n * iframe\n * @param iframe iframe\n */\nfunction adjustIframeHeight(iframe) {\n    const $iframe = $(iframe);\n    if (!$iframe.length || !$iframe[0].contentWindow || !$iframe[0].contentWindow.document.body) {\n        return;\n    }\n    const doc = $iframe[0].contentWindow.document;\n    const bodyHeight = doc.body.offsetHeight;\n    const htmlHeight = doc.documentElement.offsetHeight;\n    const newHeight = Math.max(bodyHeight, htmlHeight);\n    const currentHeight = parseFloat($iframe.css('height')) || 0;\n    if (Math.abs(currentHeight - newHeight) > 5) {\n        $iframe.css('height', newHeight + 'px');\n        if ($iframe.attr('data-needs-vh') === 'true' && iframe.contentWindow) {\n            iframe.contentWindow.postMessage({\n                request: 'updateViewportHeight',\n                newHeight: window.innerHeight,\n            }, '*');\n        }\n    }\n}\n/**\n * \n * @param codeElement \n * @returns \n */\nfunction extractTextFromCode(codeElement) {\n    let textContent = '';\n    $(codeElement)\n        .contents()\n        .each(function () {\n        if (this.nodeType === Node.TEXT_NODE) {\n            textContent += this.textContent;\n        }\n        else if (this.nodeType === Node.ELEMENT_NODE) {\n            textContent += extractTextFromCode(this);\n        }\n    });\n    return textContent;\n}\n/**\n * \n * @param mesId ID\n */\nasync function renderMessageAfterDelete(mesId) {\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_4__.getContext)();\n    const processDepth = parseInt($('#render-depth').val(), 10);\n    const totalMessages = context.chat.length;\n    const maxRemainId = mesId - 1;\n    const getMessage = (id) => {\n        const message = context.chat[id] ?? {};\n        return message;\n    };\n    const getIframe = (id) => {\n        const $iframe = $('[id^=\"message-iframe-' + id + '-\"]');\n        return $iframe.length > 0 ? $iframe.get(0) : null;\n    };\n    const checkCodeBlock = (message) => {\n        return /```[\\s\\S]*?```/.test(message.mes);\n    };\n    // 0\n    if (processDepth === 0) {\n        const message = getMessage(maxRemainId);\n        const hasCodeBlock = checkCodeBlock(message);\n        const iframe = getIframe(maxRemainId);\n        if (!hasCodeBlock && !iframe) {\n            return;\n        }\n        await destroyIframe(iframe);\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.updateMessageBlock)(maxRemainId, message);\n        renderPartialIframes(maxRemainId);\n    }\n    else {\n        let startRenderIndex = totalMessages - processDepth;\n        if (startRenderIndex < 0) {\n            startRenderIndex = 0;\n        }\n        for (let i = startRenderIndex; i <= maxRemainId; i++) {\n            const message = getMessage(i);\n            const hasCodeBlock = checkCodeBlock(message);\n            const iframe = getIframe(i);\n            if (!hasCodeBlock && !iframe) {\n                continue;\n            }\n            await destroyIframe(iframe);\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.updateMessageBlock)(i, message);\n            renderPartialIframes(i);\n        }\n    }\n}\n/**\n * \n */\nasync function handleTampermonkeyCompatibilityChange(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('render.tampermonkey_compatibility', enable);\n    }\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('enabled_extension')) {\n        return;\n    }\n    if (enable) {\n        if (!tampermonkeyMessageListener) {\n            tampermonkeyMessageListener = handleTampermonkeyMessages;\n            window.addEventListener('message', tampermonkeyMessageListener);\n            createGlobalAudioManager();\n        }\n    }\n    else if (tampermonkeyMessageListener) {\n        window.removeEventListener('message', tampermonkeyMessageListener);\n        tampermonkeyMessageListener = null;\n    }\n    await clearAndRenderAllIframes();\n}\n/**\n * \n */\nasync function onDepthInput(value) {\n    const processDepth = parseInt(value, 10);\n    renderDepth = processDepth;\n    if (processDepth < 0) {\n        toastr.warning('');\n        $('#render-depth').val((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('render.render_depth'));\n        return;\n    }\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('render.render_depth', processDepth);\n    await clearAndRenderAllIframes();\n}\nconst handlePartialRender = (mesId) => {\n    console.log('[Render] ID:', mesId);\n    const processDepth = parseInt($('#render-depth').val(), 10);\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_4__.getContext)();\n    const totalMessages = context.chat.length;\n    if (processDepth > 0) {\n        const depthOffset = totalMessages - processDepth;\n        if (mesId < depthOffset) {\n            return;\n        }\n    }\n    setTimeout(() => {\n        renderMessagesInIframes(RENDER_MODES.PARTIAL, mesId);\n    }, 100);\n};\n/**\n * \n */\nfunction injectLoadingStyles() {\n    if ($('#iframe-loading-styles').length)\n        return;\n    const styleSheet = $('<style>', {\n        id: 'iframe-loading-styles',\n        text: `\n      .iframe-loading-overlay{\n        position:absolute;\n        top:0;\n        left:0;\n        right:0;\n        bottom:0;\n        background:rgba(0,0,0,.7);\n        display:flex;\n        justify-content:center;\n        align-items:center;\n        z-index:1000;\n        transition:opacity .3s ease\n      }\n      .iframe-loading-content{\n        color:#fff;\n        display:flex;\n        align-items:center;\n        gap:10px;\n        font-size:16px\n      }\n      .iframe-loading-content i{\n        font-size:20px\n      }\n      .loading-text {\n        transition: opacity 0.3s ease;\n      }`,\n    });\n    $('head').append(styleSheet);\n}\n/**\n * \n */\nfunction injectCodeBlockHideStyles() {\n    const styleId = 'hidden-code-block-styles';\n    let style = document.getElementById(styleId);\n    if (!style) {\n        style = document.createElement('style');\n        style.setAttribute('type', 'text/css');\n        style.setAttribute('id', styleId);\n        document.head.appendChild(style);\n    }\n    style.innerHTML = `\n    pre {\n      display: none;\n    }\n    .code-toggle-button {\n      display: inline-block;\n      margin: 5px 0;\n      padding: 5px 10px;\n      background-color: rgba(0, 0, 0, 0.1);\n      border-radius: 4px;\n      cursor: pointer;\n      font-size: 0.9em;\n      user-select: none;\n      transition: background-color 0.3s;\n    }\n    .code-toggle-button:hover {\n      background-color: rgba(0, 0, 0, 0.2);\n    }\n    .popup:has(#qr--modalEditor) .popup-content > #qr--modalEditor > #qr--main > .qr--modal-messageContainer > #qr--modal-messageHolder > #qr--modal-message {\n      color: var(--SmartThemeEmColor) !important;\n    }\n  `;\n}\n/**\n * \n */\nfunction removeCodeBlockHideStyles() {\n    const styleId = 'hidden-code-block-styles';\n    const style = document.getElementById(styleId);\n    if (style) {\n        style.remove();\n    }\n}\n/**\n * \n * @param $pre \n */\nfunction addToggleButtonToCodeBlock($pre) {\n    // \n    if ($pre.prev('.code-toggle-button').length > 0) {\n        return;\n    }\n    const $toggleButton = $('<div class=\"code-toggle-button\" title=\"[--]\"></div>');\n    $toggleButton.on('click', function () {\n        const isVisible = $pre.is(':visible');\n        if (isVisible) {\n            $pre.hide();\n            $(this).text('');\n        }\n        else {\n            $pre.show();\n            $(this).text('');\n        }\n    });\n    $pre.before($toggleButton);\n}\n/**\n * \n * @param $mesText \n */\nfunction addToggleButtonsToMessage($mesText) {\n    if ($mesText.find('.code-toggle-button').length > 0 || $mesText.find('pre').length === 0) {\n        return;\n    }\n    $mesText.find('pre').each(function () {\n        const $pre = $(this);\n        const $code = $pre.find('code');\n        if ($code.length && shouldHaveCodeToggle($code[0])) {\n            addToggleButtonToCodeBlock($pre);\n        }\n    });\n}\n/**\n * \n */\nfunction addCodeToggleButtonsToAllMessages() {\n    const $chat = $('#chat');\n    if (!$chat.length) {\n        return;\n    }\n    $chat.find('.mes .mes_block .mes_text, .mes .mes_block .mes_reasoning_details').each(function () {\n        const $mesText = $(this);\n        addToggleButtonsToMessage($mesText);\n    });\n}\n/**\n * \n * @param $codeElement \n */\nfunction removeToggleButtonFromCodeBlock($codeElement) {\n    const $parent = $codeElement.parent();\n    const $toggleButton = $parent.prev('.code-toggle-button');\n    if ($toggleButton.length) {\n        $toggleButton.off('click').remove();\n    }\n}\n/**\n * mesId\n * @param mesId ID\n */\nfunction removeCodeToggleButtonsByMesId(mesId) {\n    const $messageElement = $(`div[mesid=\"${mesId}\"]`);\n    const $codeElements = $messageElement.find('pre code');\n    $codeElements.each(function () {\n        const $codeElement = $(this);\n        // \n        if (!shouldHaveCodeToggle(this)) {\n            removeToggleButtonFromCodeBlock($codeElement);\n        }\n    });\n}\n/**\n * \n */\nfunction removeAllCodeToggleButtons() {\n    $('.code-toggle-button').each(function () {\n        $(this).off('click').remove();\n    });\n    // predisplay:none\n    $('pre').css('display', 'block');\n}\n/**\n * \n */\nfunction addRenderingOptimizeSettings() {\n    hljs.highlightElement = function () {\n        return;\n    };\n}\n/**\n * \n */\nfunction removeRenderingOptimizeSettings() {\n    hljs.highlightElement = originalHighlightElement;\n}\n/**\n * \n * @param enable \n * @param userInput \n */\nasync function handleRenderingOptimizationToggle(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('render.render_optimize', enable);\n        isRenderingOptimizeEnabled = enable;\n    }\n    if (enable) {\n        addRenderingOptimizeSettings();\n        if (userInput) {\n            await clearAndRenderAllIframes();\n        }\n    }\n    else {\n        removeRenderingOptimizeSettings();\n        if (userInput) {\n            await clearAndRenderAllIframes();\n        }\n    }\n}\n/**\n * \n */\nfunction addRenderingHideStyleSettings() {\n    injectCodeBlockHideStyles();\n}\n/**\n * \n */\nfunction removeRenderingHideStyleSettings() {\n    removeCodeBlockHideStyles();\n    removeAllCodeToggleButtons();\n}\n/**\n * \n * @param enable \n * @param userInput \n */\nasync function handleRenderingHideStyleToggle(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('render.render_hide_style', enable);\n        isRenderingHideStyleEnabled = enable;\n    }\n    if (enable) {\n        addRenderingHideStyleSettings();\n        if (userInput) {\n            await clearAndRenderAllIframes();\n        }\n    }\n    else {\n        removeRenderingHideStyleSettings();\n        if (userInput) {\n            await clearAndRenderAllIframes();\n        }\n    }\n}\n/**\n * \n * @param enable \n * @param userInput \n */\nasync function handleRenderEnableToggle(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('render.render_enabled', enable);\n        isRenderEnabled = enable;\n    }\n    if (enable) {\n        $('#render-settings-content .extension-content-item').not(':first').css('opacity', 1);\n        if (isRenderingOptimizeEnabled) {\n            addRenderingOptimizeSettings();\n        }\n        if (isRenderingHideStyleEnabled) {\n            addRenderingHideStyleSettings();\n        }\n        await renderAllIframes();\n    }\n    else {\n        $('#render-settings-content .extension-content-item').not(':first').css('opacity', 0.5);\n        if (isRenderingOptimizeEnabled) {\n            removeRenderingOptimizeSettings();\n        }\n        if (isRenderingHideStyleEnabled) {\n            removeRenderingHideStyleSettings();\n        }\n        await clearAllIframes();\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.reloadCurrentChat)();\n    }\n}\n/**\n * \n */\nfunction addRenderQuickButton() {\n    const buttonHtml = $(`\n  <div id=\"tavern-helper-render-container\" class=\"list-group-item flex-container flexGap5 interactable\">\n      <div class=\"fa-solid fa-puzzle-piece extensionsMenuExtensionButton\" /></div>\n      <span id=\"tavern-helper-render-text\">${isRenderEnabled ? '' : ''}</span>\n  </div>`);\n    buttonHtml.css('display', 'flex');\n    $('#extensionsMenu').append(buttonHtml);\n    $('#tavern-helper-render-container').on('click', async function () {\n        $('#tavern-helper-render-text').text(!isRenderEnabled ? '' : '');\n        await handleRenderEnableToggle(!isRenderEnabled, true);\n        $('#render-enable-toggle').prop('checked', isRenderEnabled);\n    });\n}\n/**\n * iframe\n */\nasync function initIframePanel() {\n    // \n    isRenderingOptimizeEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('render.render_optimize');\n    if (isRenderingOptimizeEnabled) {\n        handleRenderingOptimizationToggle(true, false);\n    }\n    $('#render-optimize-toggle')\n        .prop('checked', isRenderingOptimizeEnabled)\n        .on('click', (event) => handleRenderingOptimizationToggle(event.target.checked, true));\n    isRenderingHideStyleEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('render.render_hide_style');\n    if (isRenderingHideStyleEnabled) {\n        handleRenderingHideStyleToggle(true, false);\n    }\n    $('#render-hide-style-toggle')\n        .prop('checked', isRenderingHideStyleEnabled)\n        .on('click', (event) => handleRenderingHideStyleToggle(event.target.checked, true));\n    // \n    renderDepth = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('render.render_depth');\n    $('#render-depth')\n        .val(renderDepth ?? defaultIframeSettings.render_depth)\n        .on('blur', function (event) {\n        onDepthInput(event.target.value);\n    });\n    isRenderEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('render.render_enabled');\n    handleRenderEnableToggle(isRenderEnabled, false);\n    $('#render-enable-toggle')\n        .prop('checked', isRenderEnabled)\n        .on('click', (event) => handleRenderEnableToggle(event.target.checked, true));\n    // \n    isTampermonkeyEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('render.tampermonkey_compatibility');\n    if (isTampermonkeyEnabled) {\n        handleTampermonkeyCompatibilityChange(true, false);\n    }\n    $('#tampermonkey-compatibility-toggle')\n        .prop('checked', isTampermonkeyEnabled)\n        .on('click', (event) => handleTampermonkeyCompatibilityChange(event.target.checked, true));\n    $(window).on('resize', function () {\n        if ($('iframe[data-needs-vh=\"true\"]').length) {\n            updateIframeViewportHeight();\n        }\n    });\n    addRenderQuickButton();\n    injectLoadingStyles();\n    setupIframeRemovalListener();\n}\n/**\n * \n * @param codeElement \n * @returns \n */\nfunction shouldHaveCodeToggle(codeElement) {\n    const extractedText = extractTextFromCode(codeElement);\n    return !(extractedText.includes('<body') && extractedText.includes('</body>'));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUQ7Ozs7R0FJRztBQUNILFNBQVMsb0JBQW9CLENBQUMsV0FBd0I7SUFDcEQsTUFBTSxhQUFhLEdBQUcsbUJBQW1CLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDdkQsT0FBTyxDQUFDLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxhQUFhLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7QUFDakYsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvaW5kZXgudHM/YjM0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzY3JpcHRfdXJsIH0gZnJvbSAnQC9zY3JpcHRfdXJsJztcbmltcG9ydCB0aGlyZF9wYXJ0eSBmcm9tICdAL3RoaXJkX3BhcnR5Lmh0bWwnO1xuaW1wb3J0IHsgZ2V0Q2hhckF2YXRhclBhdGgsIGdldFNldHRpbmdWYWx1ZSwgZ2V0VXNlckF2YXRhclBhdGgsIHNhdmVTZXR0aW5nVmFsdWUgfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5cbmltcG9ydCB7IGV2ZW50U291cmNlLCBldmVudF90eXBlcywgcmVsb2FkQ3VycmVudENoYXQsIHVwZGF0ZU1lc3NhZ2VCbG9jaywgdGhpc19jaGlkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBnZXRDb250ZXh0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5cbmxldCBpc0V4dGVuc2lvbkVuYWJsZWQ6IGJvb2xlYW47XG5sZXQgdGFtcGVybW9ua2V5TWVzc2FnZUxpc3RlbmVyOiAoKGV2ZW50OiBNZXNzYWdlRXZlbnQpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG5sZXQgaXNSZW5kZXJFbmFibGVkOiBib29sZWFuO1xubGV0IGlzUmVuZGVyaW5nT3B0aW1pemVFbmFibGVkOiBib29sZWFuO1xubGV0IGlzUmVuZGVyaW5nSGlkZVN0eWxlRW5hYmxlZDogYm9vbGVhbjtcbmxldCByZW5kZXJEZXB0aDogbnVtYmVyO1xubGV0IGlzVGFtcGVybW9ua2V5RW5hYmxlZDogYm9vbGVhbjtcblxuLy8g5L+d5a2Y5Y6f5aeL6auY5Lqu5pa55rOVXG5jb25zdCBvcmlnaW5hbEhpZ2hsaWdodEVsZW1lbnQgPSBobGpzLmhpZ2hsaWdodEVsZW1lbnQ7XG5cbmNvbnN0IFJFTkRFUl9NT0RFUyA9IHtcbiAgRlVMTDogJ0ZVTEwnLFxuICBQQVJUSUFMOiAnUEFSVElBTCcsXG59O1xuXG4vLyDmianlsZVXaW5kb3fmjqXlj6PlrprkuYlcbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgX3NoYXJlZFJlc2l6ZU9ic2VydmVyPzogUmVzaXplT2JzZXJ2ZXI7XG4gICAgX29ic2VydmVkRWxlbWVudHM/OiBNYXA8SFRNTEVsZW1lbnQsIHsgaWZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudCB9PjtcbiAgICBnYz86ICgpID0+IHZvaWQ7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHBhcnRpYWxSZW5kZXJFdmVudHMgPSBbXG4gIGV2ZW50X3R5cGVzLkNIQVJBQ1RFUl9NRVNTQUdFX1JFTkRFUkVELFxuICBldmVudF90eXBlcy5VU0VSX01FU1NBR0VfUkVOREVSRUQsXG4gIGV2ZW50X3R5cGVzLk1FU1NBR0VfVVBEQVRFRCxcbiAgZXZlbnRfdHlwZXMuTUVTU0FHRV9TV0lQRUQsXG5dO1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdElmcmFtZVNldHRpbmdzID0ge1xuICByZW5kZXJfZW5hYmxlZDogdHJ1ZSxcbiAgdGFtcGVybW9ua2V5X2NvbXBhdGliaWxpdHk6IGZhbHNlLFxuICByZW5kZXJfZGVwdGg6IDAsXG4gIHJlbmRlcl9vcHRpbWl6ZTogZmFsc2UsXG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlUmVuZGVyVG9nZ2xlKHVzZXJJbnB1dDogYm9vbGVhbiA9IHRydWUsIGVuYWJsZTogYm9vbGVhbiA9IHRydWUpIHtcbiAgaWYgKGVuYWJsZSkge1xuICAgIHJlbmRlck1lc3NhZ2VzSW5JZnJhbWVzKFJFTkRFUl9NT0RFUy5GVUxMKTtcbiAgfVxuICBpZiAodXNlcklucHV0KSB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9lbmFibGVkJywgZW5hYmxlKTtcbiAgfVxufVxuXG4vKipcbiAqIOa4heeQhuWQju+8jOmHjeaWsOa4suafk+aJgOaciWlmcmFtZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xlYXJBbmRSZW5kZXJBbGxJZnJhbWVzKCkge1xuICBhd2FpdCBjbGVhckFsbElmcmFtZXMoKTtcbiAgaWYgKHRoaXNfY2hpZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgICBhd2FpdCByZW5kZXJBbGxJZnJhbWVzKCk7XG4gIH1cbn1cblxuLyoqXG4gKiDmuLLmn5PmiYDmnIlpZnJhbWVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbmRlckFsbElmcmFtZXMoKSB7XG4gIGF3YWl0IHJlbmRlck1lc3NhZ2VzSW5JZnJhbWVzKFJFTkRFUl9NT0RFUy5GVUxMKTtcbiAgY29uc29sZS5sb2coJ1tSZW5kZXJdIOa4suafk+aJgOaciWlmcmFtZScpO1xufVxuXG4vKipcbiAqIOa4suafk+mDqOWIhmlmcmFtZVxuICogQHBhcmFtIG1lc0lkIOa2iOaBr0lEXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW5kZXJQYXJ0aWFsSWZyYW1lcyhtZXNJZDogbnVtYmVyKSB7XG4gIGNvbnN0IHByb2Nlc3NEZXB0aCA9IHBhcnNlSW50KCQoJyNyZW5kZXItZGVwdGgnKS52YWwoKSBhcyBzdHJpbmcsIDEwKTtcbiAgY29uc3QgY29udGV4dCA9IGdldENvbnRleHQoKTtcbiAgY29uc3QgdG90YWxNZXNzYWdlcyA9IGNvbnRleHQuY2hhdC5sZW5ndGg7XG5cbiAgaWYgKHByb2Nlc3NEZXB0aCA+IDApIHtcbiAgICBjb25zdCBkZXB0aE9mZnNldCA9IHRvdGFsTWVzc2FnZXMgLSBwcm9jZXNzRGVwdGg7XG5cbiAgICBpZiAobWVzSWQgPCBkZXB0aE9mZnNldCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIGF3YWl0IHJlbmRlck1lc3NhZ2VzSW5JZnJhbWVzKFJFTkRFUl9NT0RFUy5QQVJUSUFMLCBtZXNJZCk7XG5cbiAgY29uc29sZS5sb2coJ1tSZW5kZXJdIOa4suafkycgKyBtZXNJZCArICflj7fmtojmga/nmoRpZnJhbWUnKTtcbn1cblxuLyoqXG4gKiDkvb/nlKjkuoZtaW4taGVpZ2h0OnZo5pe277yM6Ieq5Yqo6LCD5pW0aWZyYW1l6auY5bqmXG4gKi9cbmV4cG9ydCBjb25zdCB2aWV3cG9ydF9hZGp1c3Rfc2NyaXB0ID0gYFxuJCh3aW5kb3cpLm9uKFwibWVzc2FnZVwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQub3JpZ2luYWxFdmVudC5kYXRhLnJlcXVlc3QgPT09IFwidXBkYXRlVmlld3BvcnRIZWlnaHRcIikge1xuICAgICAgICBjb25zdCBuZXdIZWlnaHQgPSBldmVudC5vcmlnaW5hbEV2ZW50LmRhdGEubmV3SGVpZ2h0O1xuICAgICAgICAkKFwiaHRtbFwiKS5jc3MoXCItLXZpZXdwb3J0LWhlaWdodFwiLCBuZXdIZWlnaHQgKyBcInB4XCIpO1xuICAgIH1cbn0pO1xuYDtcblxuLyoqXG4gKiDmsrnnjLTohJrmnKxcbiAqL1xuZXhwb3J0IGNvbnN0IHRhbXBlcm1vbmtleV9zY3JpcHQgPSBgXG5jbGFzcyBBdWRpb01hbmFnZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmN1cnJlbnRseVBsYXlpbmcgPSBudWxsO1xuICB9XG4gIGhhbmRsZVBsYXkoYXVkaW8pIHtcbiAgICBpZiAodGhpcy5jdXJyZW50bHlQbGF5aW5nICYmIHRoaXMuY3VycmVudGx5UGxheWluZyAhPT0gYXVkaW8pIHtcbiAgICAgIHRoaXMuY3VycmVudGx5UGxheWluZy5wYXVzZSgpO1xuICAgIH1cbiAgICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHtcbiAgICAgIHR5cGU6ICdhdWRpb1BsYXknLFxuICAgICAgaWZyYW1lSWQ6IHdpbmRvdy5mcmFtZUVsZW1lbnQuaWRcbiAgICB9LCAnKicpO1xuXG4gICAgdGhpcy5jdXJyZW50bHlQbGF5aW5nID0gYXVkaW87XG4gIH1cbiAgc3RvcEFsbCgpIHtcbiAgICBpZiAodGhpcy5jdXJyZW50bHlQbGF5aW5nKSB7XG4gICAgICB0aGlzLmN1cnJlbnRseVBsYXlpbmcucGF1c2UoKTtcbiAgICAgIHRoaXMuY3VycmVudGx5UGxheWluZyA9IG51bGw7XG4gICAgfVxuICB9XG59XG5jb25zdCBhdWRpb01hbmFnZXIgPSBuZXcgQXVkaW9NYW5hZ2VyKCk7XG4kKCcucXItYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gIGNvbnN0IGJ1dHRvbk5hbWUgPSAkKHRoaXMpLnRleHQoKS50cmltKCk7XG4gIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoeyB0eXBlOiAnYnV0dG9uQ2xpY2snLCBuYW1lOiBidXR0b25OYW1lIH0sICcqJyk7XG59KTtcbiQoJy5zdC10ZXh0JykuZWFjaChmdW5jdGlvbigpIHtcbiAgJCh0aGlzKS5vbignaW5wdXQnLCBmdW5jdGlvbigpIHtcbiAgICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHsgdHlwZTogJ3RleHRJbnB1dCcsIHRleHQ6ICQodGhpcykudmFsKCkgfSwgJyonKTtcbiAgfSk7XG4gICQodGhpcykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoeyB0eXBlOiAndGV4dElucHV0JywgdGV4dDogJCh0aGlzKS52YWwoKSB9LCAnKicpO1xuICB9KTtcbiAgY29uc3QgdGV4dGFyZWEgPSB0aGlzO1xuICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHtcbiAgICBtdXRhdGlvbnMuZm9yRWFjaCgobXV0YXRpb24pID0+IHtcbiAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnYXR0cmlidXRlcycgJiYgbXV0YXRpb24uYXR0cmlidXRlTmFtZSA9PT0gJ3ZhbHVlJykge1xuICAgICAgICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHsgdHlwZTogJ3RleHRJbnB1dCcsIHRleHQ6ICQodGV4dGFyZWEpLnZhbCgpIH0sICcqJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICBvYnNlcnZlci5vYnNlcnZlKHRleHRhcmVhLCB7IGF0dHJpYnV0ZXM6IHRydWUgfSk7XG59KTtcbiQoJy5zdC1zZW5kLWJ1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHsgdHlwZTogJ3NlbmRDbGljaycgfSwgJyonKTtcbn0pO1xuJCgnLnN0LWF1ZGlvJykub24oJ3BsYXknLCBmdW5jdGlvbigpIHtcbiAgYXVkaW9NYW5hZ2VyLmhhbmRsZVBsYXkodGhpcyk7XG59KTtcbiQod2luZG93KS5vbignbWVzc2FnZScsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gIGlmIChldmVudC5vcmlnaW5hbEV2ZW50LmRhdGEudHlwZSA9PT0gJ3N0b3BBdWRpbycgJiZcbiAgICBldmVudC5vcmlnaW5hbEV2ZW50LmRhdGEuaWZyYW1lSWQgIT09IHdpbmRvdy5mcmFtZUVsZW1lbnQuaWQpIHtcbiAgICBhdWRpb01hbmFnZXIuc3RvcEFsbCgpO1xuICB9XG59KTtcbmA7XG5cbi8qKlxuICog6L2s5o2i5Luj56CB5Z2X5Lit55qEbWluLWhlaWdodDp2aFxuICogQHBhcmFtIGh0bWxDb250ZW50IOS7o+eggeWdl+WGheWuuVxuICogQHJldHVybnMg6L2s5o2i5ZCO55qE5Luj56CB5Z2X5YaF5a65XG4gKi9cbmZ1bmN0aW9uIHByb2Nlc3NWaFVuaXRzKGh0bWxDb250ZW50OiBzdHJpbmcpIHtcbiAgY29uc3QgaGFzTWluVmggPSAvbWluLWhlaWdodDpcXHMqW147XSp2aC8udGVzdChodG1sQ29udGVudCk7XG5cbiAgaWYgKCFoYXNNaW5WaCkge1xuICAgIHJldHVybiBodG1sQ29udGVudDtcbiAgfVxuXG4gIGNvbnN0IHZpZXdwb3J0SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICBjb25zdCBwcm9jZXNzZWRDb250ZW50ID0gaHRtbENvbnRlbnQucmVwbGFjZSgvbWluLWhlaWdodDpcXHMqKFteO10qdmhbXjtdKik7L2csIGV4cHJlc3Npb24gPT4ge1xuICAgIGNvbnN0IHByb2Nlc3NlZEV4cHJlc3Npb24gPSBleHByZXNzaW9uLnJlcGxhY2UoXG4gICAgICAvKFxcZCspdmgvZyxcbiAgICAgIGBjYWxjKHZhcigtLXZpZXdwb3J0LWhlaWdodCwgJHt2aWV3cG9ydEhlaWdodH1weCkgKiAkMSAvIDEwMClgLFxuICAgICk7XG4gICAgcmV0dXJuIGAke3Byb2Nlc3NlZEV4cHJlc3Npb259O2A7XG4gIH0pO1xuXG4gIHJldHVybiBwcm9jZXNzZWRDb250ZW50O1xufVxuXG4vKipcbiAqIOS9v+eUqOS6hm1pbi1oZWlnaHQ6dmjml7bvvIzmm7TmlrBpZnJhbWXnmoR2aWV3cG9ydOmrmOW6plxuICovXG5mdW5jdGlvbiB1cGRhdGVJZnJhbWVWaWV3cG9ydEhlaWdodCgpIHtcbiAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCQoJ2lmcmFtZVtkYXRhLW5lZWRzLXZoPVwidHJ1ZVwiXScpLmxlbmd0aCkge1xuICAgICAgY29uc3Qgdmlld3BvcnRIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgICAkKCdpZnJhbWVbZGF0YS1uZWVkcy12aD1cInRydWVcIl0nKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgaWZyYW1lID0gdGhpcyBhcyBIVE1MSUZyYW1lRWxlbWVudDtcbiAgICAgICAgaWYgKGlmcmFtZS5jb250ZW50V2luZG93KSB7XG4gICAgICAgICAgaWZyYW1lLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHJlcXVlc3Q6ICd1cGRhdGVWaWV3cG9ydEhlaWdodCcsXG4gICAgICAgICAgICAgIG5ld0hlaWdodDogdmlld3BvcnRIZWlnaHQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJyonLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICog5riy5p+T5raI5oGv5YiwaWZyYW1lXG4gKiBAcGFyYW0gbW9kZSDmuLLmn5PmqKHlvI9cbiAqIEBwYXJhbSBzcGVjaWZpY01lc0lkIOaMh+Wumua2iOaBr0lEXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHJlbmRlck1lc3NhZ2VzSW5JZnJhbWVzKG1vZGUgPSBSRU5ERVJfTU9ERVMuRlVMTCwgc3BlY2lmaWNNZXNJZDogbnVtYmVyIHwgbnVsbCA9IG51bGwpIHtcbiAgaWYgKGlzRXh0ZW5zaW9uRW5hYmxlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgaXNFeHRlbnNpb25FbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdlbmFibGVkX2V4dGVuc2lvbicpO1xuICB9XG4gIGlmICghaXNFeHRlbnNpb25FbmFibGVkIHx8ICFpc1JlbmRlckVuYWJsZWQpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgY29udGV4dCA9IGdldENvbnRleHQoKTtcbiAgY29uc3QgdG90YWxNZXNzYWdlcyA9IGNvbnRleHQuY2hhdC5sZW5ndGg7XG4gIGNvbnN0IHByb2Nlc3NEZXB0aCA9IHJlbmRlckRlcHRoID8/IDA7XG4gIGNvbnN0IGRlcHRoTGltaXQgPSBwcm9jZXNzRGVwdGggPiAwID8gcHJvY2Vzc0RlcHRoIDogdG90YWxNZXNzYWdlcztcbiAgY29uc3QgZGVwdGhMaW1pdGVkTWVzc2FnZUlkcyA9IFsuLi5BcnJheSh0b3RhbE1lc3NhZ2VzKS5rZXlzKCldLnNsaWNlKC1kZXB0aExpbWl0KTtcblxuICBsZXQgbWVzc2FnZXNUb1JlbmRlcklkczogbnVtYmVyW10gPSBbXTtcbiAgY29uc3QgbWVzc2FnZXNUb0NhbmNlbElkczogbnVtYmVyW10gPSBbLi4uQXJyYXkodG90YWxNZXNzYWdlcykua2V5cygpXS5maWx0ZXIoXG4gICAgaWQgPT4gIWRlcHRoTGltaXRlZE1lc3NhZ2VJZHMuaW5jbHVkZXMoaWQpLFxuICApO1xuXG4gIGlmIChtb2RlID09PSBSRU5ERVJfTU9ERVMuRlVMTCkge1xuICAgIG1lc3NhZ2VzVG9SZW5kZXJJZHMgPSBkZXB0aExpbWl0ZWRNZXNzYWdlSWRzO1xuICB9IGVsc2UgaWYgKG1vZGUgPT09IFJFTkRFUl9NT0RFUy5QQVJUSUFMICYmIHNwZWNpZmljTWVzSWQgIT09IG51bGwpIHtcbiAgICBpZiAoZGVwdGhMaW1pdGVkTWVzc2FnZUlkcy5pbmNsdWRlcyhzcGVjaWZpY01lc0lkKSkge1xuICAgICAgbWVzc2FnZXNUb1JlbmRlcklkcyA9IFtzcGVjaWZpY01lc0lkXTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIGZvciAoY29uc3QgbWVzc2FnZUlkIG9mIG1lc3NhZ2VzVG9DYW5jZWxJZHMpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gY29udGV4dC5jaGF0W21lc3NhZ2VJZF07XG4gICAgY29uc3QgJGlmcmFtZXMgPSAkKGBbaWRePVwibWVzc2FnZS1pZnJhbWUtJHttZXNzYWdlSWR9LVwiXWApO1xuICAgIGlmICgkaWZyYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgJGlmcmFtZXMudG9BcnJheSgpLm1hcChhc3luYyBpZnJhbWUgPT4ge1xuICAgICAgICAgIGF3YWl0IGRlc3Ryb3lJZnJhbWUoaWZyYW1lIGFzIEhUTUxJRnJhbWVFbGVtZW50KTtcbiAgICAgICAgfSksXG4gICAgICApO1xuICAgICAgdXBkYXRlTWVzc2FnZUJsb2NrKG1lc3NhZ2VJZCwgbWVzc2FnZSk7XG4gICAgfVxuICAgIGlmIChpc1JlbmRlcmluZ0hpZGVTdHlsZUVuYWJsZWQpIHtcbiAgICAgIGNvbnN0ICRtZXNUZXh0ID0gJChcbiAgICAgICAgYC5tZXNbbWVzaWQ9XCIke21lc3NhZ2VJZH1cIl0gLm1lc19ibG9jayAubWVzX3JlYXNvbmluZ19kZXRhaWxzLCAubWVzW21lc2lkPVwiJHttZXNzYWdlSWR9XCJdIC5tZXNfYmxvY2sgLm1lc190ZXh0YCxcbiAgICAgICk7XG4gICAgICBhZGRUb2dnbGVCdXR0b25zVG9NZXNzYWdlKCRtZXNUZXh0KTtcbiAgICB9XG4gIH1cblxuICBmb3IgKGNvbnN0IG1lc3NhZ2VJZCBvZiBtZXNzYWdlc1RvUmVuZGVySWRzKSB7XG4gICAgY29uc3QgJG1lc3NhZ2VFbGVtZW50ID0gJChgLm1lc1ttZXNpZD1cIiR7bWVzc2FnZUlkfVwiXWApO1xuICAgIGlmICghJG1lc3NhZ2VFbGVtZW50Lmxlbmd0aCkge1xuICAgICAgY29uc29sZS5kZWJ1Zyhg5pyq5om+5YiwIG1lc2lkOiAke21lc3NhZ2VJZH0g5a+55bqU55qE5raI5oGv5YWD57Sg44CCYCk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBjb25zdCAkY29kZUVsZW1lbnRzID0gJG1lc3NhZ2VFbGVtZW50LmZpbmQoJ3ByZScpO1xuICAgIGlmICghJGNvZGVFbGVtZW50cy5sZW5ndGgpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGxldCBpZnJhbWVDb3VudGVyID0gMTtcblxuICAgICRjb2RlRWxlbWVudHMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgZXh0cmFjdGVkVGV4dCA9IGV4dHJhY3RUZXh0RnJvbUNvZGUodGhpcyk7XG5cbiAgICAgIGNvbnN0IHNob3VsZEhhdmVCdXR0b24gPSBzaG91bGRIYXZlQ29kZVRvZ2dsZSh0aGlzKTtcbiAgICAgIGNvbnN0IHNob3VsZFJlbmRlckFzSWZyYW1lID0gIXNob3VsZEhhdmVCdXR0b247XG5cbiAgICAgIGlmIChzaG91bGRIYXZlQnV0dG9uICYmIGlzUmVuZGVyaW5nSGlkZVN0eWxlRW5hYmxlZCkge1xuICAgICAgICBjb25zdCAkcHJlID0gJCh0aGlzKTtcbiAgICAgICAgYWRkVG9nZ2xlQnV0dG9uVG9Db2RlQmxvY2soJHByZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChzaG91bGRSZW5kZXJBc0lmcmFtZSkge1xuICAgICAgICBjb25zdCBkaXNhYmxlTG9hZGluZyA9IC88IS0tXFxzKmRpc2FibGUtZGVmYXVsdC1sb2FkaW5nXFxzKi0tPi8udGVzdChleHRyYWN0ZWRUZXh0KTtcbiAgICAgICAgY29uc3QgaGFzTWluVmggPSAvbWluLWhlaWdodDpcXHMqW147XSp2aC8udGVzdChleHRyYWN0ZWRUZXh0KTtcbiAgICAgICAgZXh0cmFjdGVkVGV4dCA9IGhhc01pblZoID8gcHJvY2Vzc1ZoVW5pdHMoZXh0cmFjdGVkVGV4dCkgOiBleHRyYWN0ZWRUZXh0O1xuXG4gICAgICAgIGxldCAkd3JhcHBlciA9ICQoJzxkaXY+JykuY3NzKHtcbiAgICAgICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICAgICAgICB3aWR0aDogJzEwMCUnLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCAkaWZyYW1lID0gJCgnPGlmcmFtZT4nKVxuICAgICAgICAgIC5hdHRyKHtcbiAgICAgICAgICAgIGlkOiBgbWVzc2FnZS1pZnJhbWUtJHttZXNzYWdlSWR9LSR7aWZyYW1lQ291bnRlcn1gLFxuICAgICAgICAgICAgc3JjZG9jOiAnJyxcbiAgICAgICAgICAgIGxvYWRpbmc6ICdsYXp5JyxcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jc3Moe1xuICAgICAgICAgICAgbWFyZ2luOiAnNXB4IGF1dG8nLFxuICAgICAgICAgICAgYm9yZGVyOiAnbm9uZScsXG4gICAgICAgICAgICB3aWR0aDogJzEwMCUnLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgIGlmcmFtZUNvdW50ZXIrKztcblxuICAgICAgICBpZiAoaGFzTWluVmgpIHtcbiAgICAgICAgICAkaWZyYW1lLmF0dHIoJ2RhdGEtbmVlZHMtdmgnLCAndHJ1ZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGxvYWRpbmdUaW1lb3V0OiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xuICAgICAgICBpZiAoIWRpc2FibGVMb2FkaW5nKSB7XG4gICAgICAgICAgY29uc3QgJGxvYWRpbmdPdmVybGF5ID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnaWZyYW1lLWxvYWRpbmctb3ZlcmxheScpLmh0bWwoYFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaWZyYW1lLWxvYWRpbmctY29udGVudFwiPlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmEtc29saWQgZmEtc3Bpbm5lciBmYS1zcGluXCI+PC9pPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibG9hZGluZy10ZXh0XCI+TG9hZGluZy4uLjwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9kaXY+YCk7XG5cbiAgICAgICAgICBsb2FkaW5nVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgJGxvYWRpbmdUZXh0ID0gJGxvYWRpbmdPdmVybGF5LmZpbmQoJy5sb2FkaW5nLXRleHQnKTtcbiAgICAgICAgICAgIGlmICgkbG9hZGluZ1RleHQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICRsb2FkaW5nVGV4dC50ZXh0KCflpoLliqDovb3ml7bpl7Tov4fplb/vvIzor7fmo4Dmn6XnvZHnu5wnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCAxMDAwMCk7XG5cbiAgICAgICAgICAkd3JhcHBlci5hcHBlbmQoJGxvYWRpbmdPdmVybGF5KTtcbiAgICAgICAgfVxuXG4gICAgICAgICR3cmFwcGVyLmFwcGVuZCgkaWZyYW1lKTtcblxuICAgICAgICBjb25zdCBzcmNkb2NDb250ZW50ID0gYFxuICAgICAgICAgIDxodG1sPlxuICAgICAgICAgIDxoZWFkPlxuICAgICAgICAgICAgPHN0eWxlPlxuICAgICAgICAgICAgJHtoYXNNaW5WaCA/IGA6cm9vdHstLXZpZXdwb3J0LWhlaWdodDoke3dpbmRvdy5pbm5lckhlaWdodH1weDt9YCA6IGBgfVxuICAgICAgICAgICAgaHRtbCxib2R5e21hcmdpbjowO3BhZGRpbmc6MDtvdmVyZmxvdzpoaWRkZW47bWF4LXdpZHRoOjEwMCUhaW1wb3J0YW50O2JveC1zaXppbmc6Ym9yZGVyLWJveH1cbiAgICAgICAgICAgIC51c2VyX2F2YXRhciwudXNlci1hdmF0YXJ7YmFja2dyb3VuZC1pbWFnZTp1cmwoJyR7Z2V0VXNlckF2YXRhclBhdGgoKX0nKX1cbiAgICAgICAgICAgIC5jaGFyX2F2YXRhciwuY2hhci1hdmF0YXJ7YmFja2dyb3VuZC1pbWFnZTp1cmwoJyR7Z2V0Q2hhckF2YXRhclBhdGgoKX0nKX1cbiAgICAgICAgICAgIDwvc3R5bGU+XG4gICAgICAgICAgICAke3RoaXJkX3BhcnR5fVxuICAgICAgICAgICAgPHNjcmlwdCBzcmM9XCIke3NjcmlwdF91cmwuZ2V0KCdpZnJhbWVfY2xpZW50Jyl9XCI+PC9zY3JpcHQ+XG4gICAgICAgICAgPC9oZWFkPlxuICAgICAgICAgIDxib2R5PlxuICAgICAgICAgICAgJHtleHRyYWN0ZWRUZXh0fVxuICAgICAgICAgICAgJHtoYXNNaW5WaCA/IGA8c2NyaXB0IHNyYz1cIiR7c2NyaXB0X3VybC5nZXQoJ3ZpZXdwb3J0X2FkanVzdF9zY3JpcHQnKX1cIj48L3NjcmlwdD5gIDogYGB9XG4gICAgICAgICAgICAke1xuICAgICAgICAgICAgICBnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci50YW1wZXJtb25rZXlfY29tcGF0aWJpbGl0eScpXG4gICAgICAgICAgICAgICAgPyBgPHNjcmlwdCBzcmM9XCIke3NjcmlwdF91cmwuZ2V0KCd0YW1wZXJtb25rZXlfc2NyaXB0Jyl9XCI+PC9zY3JpcHQ+YFxuICAgICAgICAgICAgICAgIDogYGBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA8L2JvZHk+XG4gICAgICAgICAgPC9odG1sPlxuICAgICAgICBgO1xuICAgICAgICAkaWZyYW1lLmF0dHIoJ3NyY2RvYycsIHNyY2RvY0NvbnRlbnQpO1xuXG4gICAgICAgICRpZnJhbWUub24oJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgb2JzZXJ2ZUlmcmFtZUNvbnRlbnQodGhpcyBhcyBIVE1MSUZyYW1lRWxlbWVudCk7XG5cbiAgICAgICAgICAkd3JhcHBlciA9ICQodGhpcykucGFyZW50KCk7XG4gICAgICAgICAgaWYgKCR3cmFwcGVyLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgJGxvYWRpbmdPdmVybGF5ID0gJHdyYXBwZXIuZmluZCgnLmlmcmFtZS1sb2FkaW5nLW92ZXJsYXknKTtcbiAgICAgICAgICAgIGlmICgkbG9hZGluZ092ZXJsYXkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICRsb2FkaW5nT3ZlcmxheS5jc3MoJ29wYWNpdHknLCAnMCcpO1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+ICRsb2FkaW5nT3ZlcmxheS5yZW1vdmUoKSwgMzAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKCdkYXRhLW5lZWRzLXZoJykgPT09ICd0cnVlJykge1xuICAgICAgICAgICAgY29uc3QgaWZyYW1lID0gdGhpcyBhcyBIVE1MSUZyYW1lRWxlbWVudDtcbiAgICAgICAgICAgIGlmIChpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgICAgICAgICBpZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZShcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICByZXF1ZXN0OiAndXBkYXRlVmlld3BvcnRIZWlnaHQnLFxuICAgICAgICAgICAgICAgICAgbmV3SGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAnKicsXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZXZlbnRTb3VyY2UuZW1pdEFuZFdhaXQoJ21lc3NhZ2VfaWZyYW1lX3JlbmRlcl9lbmRlZCcsIHRoaXMuaWQpO1xuXG4gICAgICAgICAgaWYgKGlzUmVuZGVyaW5nSGlkZVN0eWxlRW5hYmxlZCkge1xuICAgICAgICAgICAgcmVtb3ZlQ29kZVRvZ2dsZUJ1dHRvbnNCeU1lc0lkKG1lc3NhZ2VJZCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGxvYWRpbmdUaW1lb3V0KSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQobG9hZGluZ1RpbWVvdXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZXZlbnRTb3VyY2UuZW1pdEFuZFdhaXQoJ21lc3NhZ2VfaWZyYW1lX3JlbmRlcl9zdGFydGVkJywgJGlmcmFtZS5hdHRyKCdpZCcpKTtcbiAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aCgkd3JhcHBlcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cblxuLyoqXG4gKiDojrflj5bmiJbliJvlu7rlhbHkuqvnmoRSZXNpemVPYnNlcnZlcuWunuS+i1xuICovXG5mdW5jdGlvbiBnZXRTaGFyZWRSZXNpemVPYnNlcnZlcigpOiBSZXNpemVPYnNlcnZlciB7XG4gIGlmICghd2luZG93Ll9zaGFyZWRSZXNpemVPYnNlcnZlcikge1xuICAgIHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cyA9IG5ldyBNYXAoKTtcblxuICAgIHdpbmRvdy5fc2hhcmVkUmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoZW50cmllcyA9PiB7XG4gICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGVudHJpZXMpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGVudHJ5LnRhcmdldDtcblxuICAgICAgICBjb25zdCBkYXRhID0gd2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzPy5nZXQoZWxlbWVudCBhcyBIVE1MRWxlbWVudCk7XG4gICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgY29uc3QgeyBpZnJhbWUgfSA9IGRhdGE7XG4gICAgICAgICAgYWRqdXN0SWZyYW1lSGVpZ2h0KGlmcmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKCdDcmVhdGVkIHNoYXJlZCBSZXNpemVPYnNlcnZlciBpbnN0YW5jZScpO1xuICB9XG5cbiAgcmV0dXJuIHdpbmRvdy5fc2hhcmVkUmVzaXplT2JzZXJ2ZXI7XG59XG5cbi8qKlxuICog6KeC5a+faWZyYW1l5YaF5a6555So5LqO6Ieq5Yqo6LCD5pW06auY5bqmXG4gKiBAcGFyYW0gaWZyYW1lIGlmcmFtZeWFg+e0oFxuICovXG5mdW5jdGlvbiBvYnNlcnZlSWZyYW1lQ29udGVudChpZnJhbWU6IEhUTUxJRnJhbWVFbGVtZW50KSB7XG4gIGNvbnN0ICRpZnJhbWUgPSAkKGlmcmFtZSk7XG4gIGlmICghJGlmcmFtZS5sZW5ndGggfHwgISRpZnJhbWVbMF0uY29udGVudFdpbmRvdyB8fCAhJGlmcmFtZVswXS5jb250ZW50V2luZG93LmRvY3VtZW50LmJvZHkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCBkb2NCb2R5ID0gJGlmcmFtZVswXS5jb250ZW50V2luZG93LmRvY3VtZW50LmJvZHk7XG5cbiAgICBjb25zdCByZXNpemVPYnNlcnZlciA9IGdldFNoYXJlZFJlc2l6ZU9ic2VydmVyKCk7XG5cbiAgICBpZiAod2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzKSB7XG4gICAgICBmb3IgKGNvbnN0IFtlbGVtZW50LCBkYXRhXSBvZiB3aW5kb3cuX29ic2VydmVkRWxlbWVudHMuZW50cmllcygpKSB7XG4gICAgICAgIGlmIChkYXRhLmlmcmFtZSA9PT0gaWZyYW1lKSB7XG4gICAgICAgICAgcmVzaXplT2JzZXJ2ZXIudW5vYnNlcnZlKGVsZW1lbnQpO1xuICAgICAgICAgIHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cy5kZWxldGUoZWxlbWVudCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB3aW5kb3cuX29ic2VydmVkRWxlbWVudHM/LnNldChkb2NCb2R5LCB7IGlmcmFtZSB9KTtcbiAgICByZXNpemVPYnNlcnZlci5vYnNlcnZlKGRvY0JvZHkpO1xuXG4gICAgYWRqdXN0SWZyYW1lSGVpZ2h0KGlmcmFtZSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1JlbmRlcl0g6K6+572uIGlmcmFtZSDlhoXlrrnop4Llr5/ml7blh7rplJk6JywgZXJyb3IpO1xuICB9XG59XG5cbi8qKlxuICog6ZSA5q+BaWZyYW1lXG4gKiBAcGFyYW0gaWZyYW1lIGlmcmFtZeWFg+e0oFxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVzdHJveUlmcmFtZShpZnJhbWU6IEhUTUxJRnJhbWVFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICBjb25zdCAkaWZyYW1lID0gJChpZnJhbWUpO1xuXG4gICAgaWYgKCEkaWZyYW1lLmxlbmd0aCkge1xuICAgICAgcmVzb2x2ZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGlmcmFtZUlkID0gJGlmcmFtZS5hdHRyKCdpZCcpO1xuICAgICRpZnJhbWUub2ZmKCk7XG5cbiAgICB0cnkge1xuICAgICAgaWYgKCRpZnJhbWVbMF0uY29udGVudFdpbmRvdykge1xuICAgICAgICBjb25zdCBpZnJhbWVEb2MgPSAkaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XG4gICAgICAgIGlmIChpZnJhbWVEb2MpIHtcbiAgICAgICAgICAkKGlmcmFtZURvYykuZmluZCgnKicpLm9mZigpO1xuICAgICAgICAgICQoaWZyYW1lRG9jKS5vZmYoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZGVidWcoJ1tSZW5kZXJdIOa4heeQhmlmcmFtZeWGhemDqOS6i+S7tuaXtuWHuumUmTonLCBlKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgJG1lZGlhRWxlbWVudHMgPSAkaWZyYW1lLmNvbnRlbnRzKCkuZmluZCgnYXVkaW8sIHZpZGVvJyk7XG4gICAgICAkbWVkaWFFbGVtZW50cy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMgaW5zdGFuY2VvZiBIVE1MTWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgdGhpcy5wYXVzZSgpO1xuICAgICAgICAgIHRoaXMuc3JjID0gJyc7XG4gICAgICAgICAgdGhpcy5sb2FkKCk7XG4gICAgICAgICAgJCh0aGlzKS5vZmYoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5kZWJ1ZygnW1JlbmRlcl0g5riF55CG5aqS5L2T5YWD57Sg5pe25Ye66ZSZOicsIGUpO1xuICAgIH1cblxuICAgIGlmICgkaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cgJiYgJ3N0b3AnIGluICRpZnJhbWVbMF0uY29udGVudFdpbmRvdykge1xuICAgICAgJGlmcmFtZVswXS5jb250ZW50V2luZG93LnN0b3AoKTtcbiAgICB9XG5cbiAgICAvLyDlpoLmnpzmnIlSZXNpemVPYnNlcnZlcuWunuS+i+WSjOW3suinguWvn+WFg+e0oOeahOiusOW9lVxuICAgIGlmICh3aW5kb3cuX3NoYXJlZFJlc2l6ZU9ic2VydmVyICYmIHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cykge1xuICAgICAgZm9yIChjb25zdCBbZWxlbWVudCwgZGF0YV0gb2Ygd2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzLmVudHJpZXMoKSkge1xuICAgICAgICBpZiAoZGF0YS5pZnJhbWUgPT09IGlmcmFtZSkge1xuICAgICAgICAgIHdpbmRvdy5fc2hhcmVkUmVzaXplT2JzZXJ2ZXIudW5vYnNlcnZlKGVsZW1lbnQpO1xuICAgICAgICAgIHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cy5kZWxldGUoZWxlbWVudCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyDmuIXnqbppZnJhbWXlhoXlrrlcbiAgICBpZiAoJGlmcmFtZVswXS5jb250ZW50V2luZG93KSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoaWZyYW1lSWQgJiYgdHlwZW9mIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoJ21lc3NhZ2VfaWZyYW1lX3JlbmRlcl9lbmRlZCcsIGlmcmFtZUlkIGFzIGFueSk7XG4gICAgICAgICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoJ21lc3NhZ2VfaWZyYW1lX3JlbmRlcl9zdGFydGVkJywgaWZyYW1lSWQgYXMgYW55KTtcbiAgICAgICAgfVxuXG4gICAgICAgICRpZnJhbWUuYXR0cignc3JjJywgJ2Fib3V0OmJsYW5rJyk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZGVidWcoJ1tSZW5kZXJdIOa4heepumlmcmFtZeWGheWuueaXtuWHuumUmTonLCBlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyDku45ET03kuK3np7vpmaRcbiAgICAkaWZyYW1lLnJlbW92ZSgpO1xuXG4gICAgLy8g56e76ZmkalF1ZXJ55pWw5o2u57yT5a2YXG4gICAgdHJ5IHtcbiAgICAgICRpZnJhbWUucmVtb3ZlRGF0YSgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZGVidWcoJ1tSZW5kZXJdIOenu+mZpGpRdWVyeeaVsOaNrue8k+WtmOaXtuWHuumUmTonLCBlKTtcbiAgICB9XG5cbiAgICBpZiAod2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzPy5zaXplID09PSAwICYmIHdpbmRvdy5fc2hhcmVkUmVzaXplT2JzZXJ2ZXIpIHtcbiAgICAgIHdpbmRvdy5fc2hhcmVkUmVzaXplT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgd2luZG93Ll9zaGFyZWRSZXNpemVPYnNlcnZlciA9IHVuZGVmaW5lZDtcbiAgICAgIGNvbnNvbGUubG9nKCdbUmVuZGVyXSDmiYDmnIlpZnJhbWXlt7Lnp7vpmaTvvIzlgZzmraLop4Llr58nKTtcbiAgICB9XG5cbiAgICAvLyDnoa7kv53miYDmnInmuIXnkIbmk43kvZzpg73lrozmiJDlkI7lho1yZXNvbHZlXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICByZXNvbHZlKCk7XG4gICAgfSwgMCk7XG4gIH0pO1xufVxuXG4vKipcbiAqIOa4heeQhuaJgOaciWlmcmFtZVxuICogQHJldHVybnMge1Byb21pc2U8dm9pZD59XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbGVhckFsbElmcmFtZXMoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0ICRpZnJhbWVzID0gJCgnaWZyYW1lW2lkXj1cIm1lc3NhZ2UtaWZyYW1lXCJdJyk7XG4gIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICRpZnJhbWVzLnRvQXJyYXkoKS5tYXAoYXN5bmMgaWZyYW1lID0+IHtcbiAgICAgIGF3YWl0IGRlc3Ryb3lJZnJhbWUoaWZyYW1lIGFzIEhUTUxJRnJhbWVFbGVtZW50KTtcbiAgICB9KSxcbiAgKTtcblxuICAvLyDmuIXnkIbnm7jlhbPnmoTkuovku7bnm5HlkKzlmahcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcignbWVzc2FnZV9pZnJhbWVfcmVuZGVyX3N0YXJ0ZWQnLCBudWxsIGFzIGFueSk7XG4gICAgICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcignbWVzc2FnZV9pZnJhbWVfcmVuZGVyX2VuZGVkJywgbnVsbCBhcyBhbnkpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZGVidWcoJ1tSZW5kZXJdIOa4heeQhuS6i+S7tuebkeWQrOWZqOaXtuWHuumUmTonLCBlKTtcbiAgfVxuXG4gIC8vIOWwneivleS4u+WKqOinpuWPkeWeg+WcvuWbnuaUtlxuICB0cnkge1xuICAgIGxldCBhcnIgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGFyci5wdXNoKG5ldyBBcnJheSgxMDAwMDAwKS5maWxsKDEpKTtcbiAgICB9XG4gICAgYXJyID0gbnVsbCBhcyBhbnk7XG5cbiAgICBpZiAod2luZG93LmdjKSB7XG4gICAgICB3aW5kb3cuZ2MoKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmRlYnVnKCflsJ3or5Xop6blj5HlnoPlnL7lm57mlLbml7blh7rplJk6JywgZSk7XG4gIH1cbn1cblxuLyoqXG4gKiDorr7nva5pZnJhbWXnp7vpmaTnm5HlkKzlmahcbiAqIEByZXR1cm5zIHtNdXRhdGlvbk9ic2VydmVyfSDop4Llr5/lmajlrp7kvotcbiAqL1xuZnVuY3Rpb24gc2V0dXBJZnJhbWVSZW1vdmFsTGlzdGVuZXIoKTogTXV0YXRpb25PYnNlcnZlciB7XG4gIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIobXV0YXRpb25zID0+IHtcbiAgICBtdXRhdGlvbnMuZm9yRWFjaChtdXRhdGlvbiA9PiB7XG4gICAgICBpZiAobXV0YXRpb24ucmVtb3ZlZE5vZGVzLmxlbmd0aCkge1xuICAgICAgICBtdXRhdGlvbi5yZW1vdmVkTm9kZXMuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIEhUTUxJRnJhbWVFbGVtZW50KSB7XG4gICAgICAgICAgICBkZXN0cm95SWZyYW1lKG5vZGUpLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tSZW5kZXJdIOa4heeQhmlmcmFtZeaXtuWHuumUmTonLCBlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChub2RlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGlmcmFtZXMgPSBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lmcmFtZScpO1xuICAgICAgICAgICAgaWYgKGlmcmFtZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGlmcmFtZXMuZm9yRWFjaChpZnJhbWUgPT4ge1xuICAgICAgICAgICAgICAgIGRlc3Ryb3lJZnJhbWUoaWZyYW1lKS5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignW1JlbmRlcl0g5riF55CGaWZyYW1l5pe25Ye66ZSZOicsIGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfSk7XG4gIHJldHVybiBvYnNlcnZlcjtcbn1cblxuLyoqXG4gKiDlpITnkIbmsrnnjLTohJrmnKzlhbzlrrnmqKHlvI/kvKDmnaXnmoTmtojmga9cbiAqIEBwYXJhbSBldmVudCDmtojmga/kuovku7ZcbiAqL1xuZnVuY3Rpb24gaGFuZGxlVGFtcGVybW9ua2V5TWVzc2FnZXMoZXZlbnQ6IE1lc3NhZ2VFdmVudCk6IHZvaWQge1xuICBpZiAoZXZlbnQuZGF0YS50eXBlID09PSAnYnV0dG9uQ2xpY2snKSB7XG4gICAgY29uc3QgYnV0dG9uTmFtZSA9IGV2ZW50LmRhdGEubmFtZTtcbiAgICAkKCcucXItLWJ1dHRvbi5tZW51X2J1dHRvbicpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCQodGhpcykuZmluZCgnLnFyLS1idXR0b24tbGFiZWwnKS50ZXh0KCkudHJpbSgpID09PSBidXR0b25OYW1lKSB7XG4gICAgICAgICQodGhpcykudHJpZ2dlcignY2xpY2snKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSBlbHNlIGlmIChldmVudC5kYXRhLnR5cGUgPT09ICd0ZXh0SW5wdXQnKSB7XG4gICAgY29uc3QgJHNlbmRUZXh0YXJlYSA9IGpRdWVyeSgnI3NlbmRfdGV4dGFyZWEnKTtcbiAgICBpZiAoJHNlbmRUZXh0YXJlYS5sZW5ndGgpIHtcbiAgICAgICRzZW5kVGV4dGFyZWEudmFsKGV2ZW50LmRhdGEudGV4dCkudHJpZ2dlcignaW5wdXQnKS50cmlnZ2VyKCdjaGFuZ2UnKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoZXZlbnQuZGF0YS50eXBlID09PSAnc2VuZENsaWNrJykge1xuICAgIGNvbnN0ICRzZW5kQnV0dG9uID0galF1ZXJ5KCcjc2VuZF9idXQnKTtcbiAgICBpZiAoJHNlbmRCdXR0b24ubGVuZ3RoKSB7XG4gICAgICAkc2VuZEJ1dHRvbi50cmlnZ2VyKCdjbGljaycpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOayueeMtOWFvOWuueaooeW8jy3liJvlu7rlhajlsYDpn7PpopHnrqHnkIblmahcbiAqL1xuZnVuY3Rpb24gY3JlYXRlR2xvYmFsQXVkaW9NYW5hZ2VyKCkge1xuICBsZXQgY3VycmVudFBsYXlpbmdJZnJhbWVJZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQuZGF0YS50eXBlID09PSAnYXVkaW9QbGF5Jykge1xuICAgICAgY29uc3QgbmV3SWZyYW1lSWQgPSBldmVudC5kYXRhLmlmcmFtZUlkO1xuXG4gICAgICBpZiAoY3VycmVudFBsYXlpbmdJZnJhbWVJZCAmJiBjdXJyZW50UGxheWluZ0lmcmFtZUlkICE9PSBuZXdJZnJhbWVJZCkge1xuICAgICAgICAkKCdpZnJhbWUnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjb25zdCBpZnJhbWUgPSB0aGlzIGFzIEhUTUxJRnJhbWVFbGVtZW50O1xuICAgICAgICAgIGlmIChpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgICAgICAgaWZyYW1lLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnc3RvcEF1ZGlvJyxcbiAgICAgICAgICAgICAgICBpZnJhbWVJZDogbmV3SWZyYW1lSWQsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICcqJyxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgY3VycmVudFBsYXlpbmdJZnJhbWVJZCA9IG5ld0lmcmFtZUlkO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICog6LCD5pW0aWZyYW1l6auY5bqmXG4gKiBAcGFyYW0gaWZyYW1lIGlmcmFtZeWFg+e0oFxuICovXG5mdW5jdGlvbiBhZGp1c3RJZnJhbWVIZWlnaHQoaWZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudCkge1xuICBjb25zdCAkaWZyYW1lID0gJChpZnJhbWUpO1xuICBpZiAoISRpZnJhbWUubGVuZ3RoIHx8ICEkaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cgfHwgISRpZnJhbWVbMF0uY29udGVudFdpbmRvdy5kb2N1bWVudC5ib2R5KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgZG9jID0gJGlmcmFtZVswXS5jb250ZW50V2luZG93LmRvY3VtZW50O1xuXG4gIGNvbnN0IGJvZHlIZWlnaHQgPSBkb2MuYm9keS5vZmZzZXRIZWlnaHQ7XG4gIGNvbnN0IGh0bWxIZWlnaHQgPSBkb2MuZG9jdW1lbnRFbGVtZW50Lm9mZnNldEhlaWdodDtcblxuICBjb25zdCBuZXdIZWlnaHQgPSBNYXRoLm1heChib2R5SGVpZ2h0LCBodG1sSGVpZ2h0KTtcbiAgY29uc3QgY3VycmVudEhlaWdodCA9IHBhcnNlRmxvYXQoJGlmcmFtZS5jc3MoJ2hlaWdodCcpKSB8fCAwO1xuXG4gIGlmIChNYXRoLmFicyhjdXJyZW50SGVpZ2h0IC0gbmV3SGVpZ2h0KSA+IDUpIHtcbiAgICAkaWZyYW1lLmNzcygnaGVpZ2h0JywgbmV3SGVpZ2h0ICsgJ3B4Jyk7XG5cbiAgICBpZiAoJGlmcmFtZS5hdHRyKCdkYXRhLW5lZWRzLXZoJykgPT09ICd0cnVlJyAmJiBpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgaWZyYW1lLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoXG4gICAgICAgIHtcbiAgICAgICAgICByZXF1ZXN0OiAndXBkYXRlVmlld3BvcnRIZWlnaHQnLFxuICAgICAgICAgIG5ld0hlaWdodDogd2luZG93LmlubmVySGVpZ2h0LFxuICAgICAgICB9LFxuICAgICAgICAnKicsXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOaPkOWPluS7o+eggeWdl+S4reeahOaWh+acrFxuICogQHBhcmFtIGNvZGVFbGVtZW50IOS7o+eggeWdl+WFg+e0oFxuICogQHJldHVybnMg5o+Q5Y+W55qE5paH5pysXG4gKi9cbmZ1bmN0aW9uIGV4dHJhY3RUZXh0RnJvbUNvZGUoY29kZUVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4gIGxldCB0ZXh0Q29udGVudCA9ICcnO1xuXG4gICQoY29kZUVsZW1lbnQpXG4gICAgLmNvbnRlbnRzKClcbiAgICAuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHtcbiAgICAgICAgdGV4dENvbnRlbnQgKz0gdGhpcy50ZXh0Q29udGVudDtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHtcbiAgICAgICAgdGV4dENvbnRlbnQgKz0gZXh0cmFjdFRleHRGcm9tQ29kZSh0aGlzIGFzIEhUTUxFbGVtZW50KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICByZXR1cm4gdGV4dENvbnRlbnQ7XG59XG5cbi8qKlxuICog5Yig6Zmk5raI5oGv5ZCO6YeN5paw5riy5p+TXG4gKiBAcGFyYW0gbWVzSWQg5raI5oGvSURcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbmRlck1lc3NhZ2VBZnRlckRlbGV0ZShtZXNJZDogbnVtYmVyKSB7XG4gIGNvbnN0IGNvbnRleHQgPSBnZXRDb250ZXh0KCk7XG4gIGNvbnN0IHByb2Nlc3NEZXB0aCA9IHBhcnNlSW50KCQoJyNyZW5kZXItZGVwdGgnKS52YWwoKSBhcyBzdHJpbmcsIDEwKTtcbiAgY29uc3QgdG90YWxNZXNzYWdlcyA9IGNvbnRleHQuY2hhdC5sZW5ndGg7XG4gIGNvbnN0IG1heFJlbWFpbklkID0gbWVzSWQgLSAxO1xuXG4gIGNvbnN0IGdldE1lc3NhZ2UgPSAoaWQ6IG51bWJlcikgPT4ge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjb250ZXh0LmNoYXRbaWRdID8/IHt9O1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9O1xuXG4gIGNvbnN0IGdldElmcmFtZSA9IChpZDogbnVtYmVyKSA9PiB7XG4gICAgY29uc3QgJGlmcmFtZSA9ICQoJ1tpZF49XCJtZXNzYWdlLWlmcmFtZS0nICsgaWQgKyAnLVwiXScpO1xuICAgIHJldHVybiAkaWZyYW1lLmxlbmd0aCA+IDAgPyAoJGlmcmFtZS5nZXQoMCkgYXMgSFRNTElGcmFtZUVsZW1lbnQpIDogbnVsbDtcbiAgfTtcblxuICBjb25zdCBjaGVja0NvZGVCbG9jayA9IChtZXNzYWdlOiBhbnkpID0+IHtcbiAgICByZXR1cm4gL2BgYFtcXHNcXFNdKj9gYGAvLnRlc3QobWVzc2FnZS5tZXMpO1xuICB9O1xuICAvLyDogIPomZHliLDpq5jmpbzlsYLnmoTmg4XlhrXvvIzmt7HluqbkuLow5pe277yM5Y+q5riy5p+T5pyA5ZCO5LiA5Liq5raI5oGvXG4gIGlmIChwcm9jZXNzRGVwdGggPT09IDApIHtcbiAgICBjb25zdCBtZXNzYWdlID0gZ2V0TWVzc2FnZShtYXhSZW1haW5JZCk7XG4gICAgY29uc3QgaGFzQ29kZUJsb2NrID0gY2hlY2tDb2RlQmxvY2sobWVzc2FnZSk7XG4gICAgY29uc3QgaWZyYW1lID0gZ2V0SWZyYW1lKG1heFJlbWFpbklkKTtcblxuICAgIGlmICghaGFzQ29kZUJsb2NrICYmICFpZnJhbWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYXdhaXQgZGVzdHJveUlmcmFtZShpZnJhbWUgYXMgSFRNTElGcmFtZUVsZW1lbnQpO1xuICAgIHVwZGF0ZU1lc3NhZ2VCbG9jayhtYXhSZW1haW5JZCwgbWVzc2FnZSk7XG4gICAgcmVuZGVyUGFydGlhbElmcmFtZXMobWF4UmVtYWluSWQpO1xuICB9IGVsc2Uge1xuICAgIGxldCBzdGFydFJlbmRlckluZGV4ID0gdG90YWxNZXNzYWdlcyAtIHByb2Nlc3NEZXB0aDtcbiAgICBpZiAoc3RhcnRSZW5kZXJJbmRleCA8IDApIHtcbiAgICAgIHN0YXJ0UmVuZGVySW5kZXggPSAwO1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSBzdGFydFJlbmRlckluZGV4OyBpIDw9IG1heFJlbWFpbklkOyBpKyspIHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBnZXRNZXNzYWdlKGkpO1xuICAgICAgY29uc3QgaGFzQ29kZUJsb2NrID0gY2hlY2tDb2RlQmxvY2sobWVzc2FnZSk7XG4gICAgICBjb25zdCBpZnJhbWUgPSBnZXRJZnJhbWUoaSk7XG5cbiAgICAgIGlmICghaGFzQ29kZUJsb2NrICYmICFpZnJhbWUpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBhd2FpdCBkZXN0cm95SWZyYW1lKGlmcmFtZSBhcyBIVE1MSUZyYW1lRWxlbWVudCk7XG4gICAgICB1cGRhdGVNZXNzYWdlQmxvY2soaSwgbWVzc2FnZSk7XG4gICAgICByZW5kZXJQYXJ0aWFsSWZyYW1lcyhpKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiDlpITnkIbmsrnnjLTlhbzlrrnmgKforr7nva7mlLnlj5hcbiAqL1xuYXN5bmMgZnVuY3Rpb24gaGFuZGxlVGFtcGVybW9ua2V5Q29tcGF0aWJpbGl0eUNoYW5nZShlbmFibGU6IGJvb2xlYW4sIHVzZXJJbnB1dDogYm9vbGVhbiA9IHRydWUpIHtcbiAgaWYgKHVzZXJJbnB1dCkge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ3JlbmRlci50YW1wZXJtb25rZXlfY29tcGF0aWJpbGl0eScsIGVuYWJsZSk7XG4gIH1cblxuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgnZW5hYmxlZF9leHRlbnNpb24nKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChlbmFibGUpIHtcbiAgICBpZiAoIXRhbXBlcm1vbmtleU1lc3NhZ2VMaXN0ZW5lcikge1xuICAgICAgdGFtcGVybW9ua2V5TWVzc2FnZUxpc3RlbmVyID0gaGFuZGxlVGFtcGVybW9ua2V5TWVzc2FnZXM7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRhbXBlcm1vbmtleU1lc3NhZ2VMaXN0ZW5lcik7XG4gICAgICBjcmVhdGVHbG9iYWxBdWRpb01hbmFnZXIoKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAodGFtcGVybW9ua2V5TWVzc2FnZUxpc3RlbmVyKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0YW1wZXJtb25rZXlNZXNzYWdlTGlzdGVuZXIpO1xuICAgIHRhbXBlcm1vbmtleU1lc3NhZ2VMaXN0ZW5lciA9IG51bGw7XG4gIH1cblxuICBhd2FpdCBjbGVhckFuZFJlbmRlckFsbElmcmFtZXMoKTtcbn1cblxuLyoqXG4gKiDlpITnkIbmt7HluqbovpPlhaXmlLnlj5jml7ZcbiAqL1xuYXN5bmMgZnVuY3Rpb24gb25EZXB0aElucHV0KHZhbHVlOiBzdHJpbmcpIHtcbiAgY29uc3QgcHJvY2Vzc0RlcHRoID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgcmVuZGVyRGVwdGggPSBwcm9jZXNzRGVwdGg7XG5cbiAgaWYgKHByb2Nlc3NEZXB0aCA8IDApIHtcbiAgICB0b2FzdHIud2FybmluZygn5aSE55CG5rex5bqm5LiN6IO95Li66LSf5pWwJyk7XG4gICAgJCgnI3JlbmRlci1kZXB0aCcpLnZhbChnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfZGVwdGgnKSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgc2F2ZVNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9kZXB0aCcsIHByb2Nlc3NEZXB0aCk7XG5cbiAgYXdhaXQgY2xlYXJBbmRSZW5kZXJBbGxJZnJhbWVzKCk7XG59XG5cbmV4cG9ydCBjb25zdCBoYW5kbGVQYXJ0aWFsUmVuZGVyID0gKG1lc0lkOiBudW1iZXIpID0+IHtcbiAgY29uc29sZS5sb2coJ1tSZW5kZXJdIOinpuWPkeWxgOmDqOa4suafk++8jOa2iOaBr0lEOicsIG1lc0lkKTtcbiAgY29uc3QgcHJvY2Vzc0RlcHRoID0gcGFyc2VJbnQoJCgnI3JlbmRlci1kZXB0aCcpLnZhbCgpIGFzIHN0cmluZywgMTApO1xuICBjb25zdCBjb250ZXh0ID0gZ2V0Q29udGV4dCgpO1xuICBjb25zdCB0b3RhbE1lc3NhZ2VzID0gY29udGV4dC5jaGF0Lmxlbmd0aDtcblxuICBpZiAocHJvY2Vzc0RlcHRoID4gMCkge1xuICAgIGNvbnN0IGRlcHRoT2Zmc2V0ID0gdG90YWxNZXNzYWdlcyAtIHByb2Nlc3NEZXB0aDtcblxuICAgIGlmIChtZXNJZCA8IGRlcHRoT2Zmc2V0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgcmVuZGVyTWVzc2FnZXNJbklmcmFtZXMoUkVOREVSX01PREVTLlBBUlRJQUwsIG1lc0lkKTtcbiAgfSwgMTAwKTtcbn07XG5cbi8qKlxuICog5rOo5YWl5Yqg6L295qC35byPXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbmplY3RMb2FkaW5nU3R5bGVzKCkge1xuICBpZiAoJCgnI2lmcmFtZS1sb2FkaW5nLXN0eWxlcycpLmxlbmd0aCkgcmV0dXJuO1xuXG4gIGNvbnN0IHN0eWxlU2hlZXQgPSAkKCc8c3R5bGU+Jywge1xuICAgIGlkOiAnaWZyYW1lLWxvYWRpbmctc3R5bGVzJyxcbiAgICB0ZXh0OiBgXG4gICAgICAuaWZyYW1lLWxvYWRpbmctb3ZlcmxheXtcbiAgICAgICAgcG9zaXRpb246YWJzb2x1dGU7XG4gICAgICAgIHRvcDowO1xuICAgICAgICBsZWZ0OjA7XG4gICAgICAgIHJpZ2h0OjA7XG4gICAgICAgIGJvdHRvbTowO1xuICAgICAgICBiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsLjcpO1xuICAgICAgICBkaXNwbGF5OmZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDpjZW50ZXI7XG4gICAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgICAgei1pbmRleDoxMDAwO1xuICAgICAgICB0cmFuc2l0aW9uOm9wYWNpdHkgLjNzIGVhc2VcbiAgICAgIH1cbiAgICAgIC5pZnJhbWUtbG9hZGluZy1jb250ZW50e1xuICAgICAgICBjb2xvcjojZmZmO1xuICAgICAgICBkaXNwbGF5OmZsZXg7XG4gICAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgICAgZ2FwOjEwcHg7XG4gICAgICAgIGZvbnQtc2l6ZToxNnB4XG4gICAgICB9XG4gICAgICAuaWZyYW1lLWxvYWRpbmctY29udGVudCBpe1xuICAgICAgICBmb250LXNpemU6MjBweFxuICAgICAgfVxuICAgICAgLmxvYWRpbmctdGV4dCB7XG4gICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4zcyBlYXNlO1xuICAgICAgfWAsXG4gIH0pO1xuXG4gICQoJ2hlYWQnKS5hcHBlbmQoc3R5bGVTaGVldCk7XG59XG5cbi8qKlxuICog5rOo5YWl5Luj56CB5Z2X6ZqQ6JeP5qC35byPXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbmplY3RDb2RlQmxvY2tIaWRlU3R5bGVzKCkge1xuICBjb25zdCBzdHlsZUlkID0gJ2hpZGRlbi1jb2RlLWJsb2NrLXN0eWxlcyc7XG4gIGxldCBzdHlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHN0eWxlSWQpO1xuICBpZiAoIXN0eWxlKSB7XG4gICAgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgIHN0eWxlLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0L2NzcycpO1xuICAgIHN0eWxlLnNldEF0dHJpYnV0ZSgnaWQnLCBzdHlsZUlkKTtcbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgfVxuICBzdHlsZS5pbm5lckhUTUwgPSBgXG4gICAgcHJlIHtcbiAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgfVxuICAgIC5jb2RlLXRvZ2dsZS1idXR0b24ge1xuICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgbWFyZ2luOiA1cHggMDtcbiAgICAgIHBhZGRpbmc6IDVweCAxMHB4O1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjEpO1xuICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgZm9udC1zaXplOiAwLjllbTtcbiAgICAgIHVzZXItc2VsZWN0OiBub25lO1xuICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjNzO1xuICAgIH1cbiAgICAuY29kZS10b2dnbGUtYnV0dG9uOmhvdmVyIHtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4yKTtcbiAgICB9XG4gICAgLnBvcHVwOmhhcygjcXItLW1vZGFsRWRpdG9yKSAucG9wdXAtY29udGVudCA+ICNxci0tbW9kYWxFZGl0b3IgPiAjcXItLW1haW4gPiAucXItLW1vZGFsLW1lc3NhZ2VDb250YWluZXIgPiAjcXItLW1vZGFsLW1lc3NhZ2VIb2xkZXIgPiAjcXItLW1vZGFsLW1lc3NhZ2Uge1xuICAgICAgY29sb3I6IHZhcigtLVNtYXJ0VGhlbWVFbUNvbG9yKSAhaW1wb3J0YW50O1xuICAgIH1cbiAgYDtcbn1cblxuLyoqXG4gKiDnp7vpmaTku6PnoIHlnZfpmpDol4/moLflvI9cbiAqL1xuZnVuY3Rpb24gcmVtb3ZlQ29kZUJsb2NrSGlkZVN0eWxlcygpIHtcbiAgY29uc3Qgc3R5bGVJZCA9ICdoaWRkZW4tY29kZS1ibG9jay1zdHlsZXMnO1xuICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHN0eWxlSWQpO1xuICBpZiAoc3R5bGUpIHtcbiAgICBzdHlsZS5yZW1vdmUoKTtcbiAgfVxufVxuXG4vKipcbiAqIOS4uuWNleS4quS7o+eggeWdl+a3u+WKoOaKmOWPoOaMiemSrlxuICogQHBhcmFtICRwcmUg5Luj56CB5Z2X5YWD57SgXG4gKi9cbmZ1bmN0aW9uIGFkZFRvZ2dsZUJ1dHRvblRvQ29kZUJsb2NrKCRwcmU6IEpRdWVyeTxIVE1MRWxlbWVudD4pIHtcbiAgLy8g5qOA5p+l5Luj56CB5Z2X5piv5ZCm5bey57uP5pyJ5oqY5Y+g5oyJ6ZKuXG4gIGlmICgkcHJlLnByZXYoJy5jb2RlLXRvZ2dsZS1idXR0b24nKS5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgJHRvZ2dsZUJ1dHRvbiA9ICQoXG4gICAgJzxkaXYgY2xhc3M9XCJjb2RlLXRvZ2dsZS1idXR0b25cIiB0aXRsZT1cIuWFs+mXrVvphZLppobliqnmiYst5riy5p+T5ZmoLea4suafk+S8mOWMll3ku6Xlj5bmtojmraTmipjlj6Dlip/og71cIj7mmL7npLrku6PnoIHlnZc8L2Rpdj4nLFxuICApO1xuXG4gICR0b2dnbGVCdXR0b24ub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGlzVmlzaWJsZSA9ICRwcmUuaXMoJzp2aXNpYmxlJyk7XG5cbiAgICBpZiAoaXNWaXNpYmxlKSB7XG4gICAgICAkcHJlLmhpZGUoKTtcbiAgICAgICQodGhpcykudGV4dCgn5pi+56S65Luj56CB5Z2XJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICRwcmUuc2hvdygpO1xuICAgICAgJCh0aGlzKS50ZXh0KCfpmpDol4/ku6PnoIHlnZcnKTtcbiAgICB9XG4gIH0pO1xuXG4gICRwcmUuYmVmb3JlKCR0b2dnbGVCdXR0b24pO1xufVxuXG4vKipcbiAqIOS4uua2iOaBr+a3u+WKoOaKmOWPoOaOp+S7tlxuICogQHBhcmFtICRtZXNUZXh0IOa2iOaBr+aWh+acrOWFg+e0oFxuICovXG5mdW5jdGlvbiBhZGRUb2dnbGVCdXR0b25zVG9NZXNzYWdlKCRtZXNUZXh0OiBKUXVlcnk8SFRNTEVsZW1lbnQ+KSB7XG4gIGlmICgkbWVzVGV4dC5maW5kKCcuY29kZS10b2dnbGUtYnV0dG9uJykubGVuZ3RoID4gMCB8fCAkbWVzVGV4dC5maW5kKCdwcmUnKS5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAkbWVzVGV4dC5maW5kKCdwcmUnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCAkcHJlID0gJCh0aGlzKTtcbiAgICBjb25zdCAkY29kZSA9ICRwcmUuZmluZCgnY29kZScpO1xuICAgIGlmICgkY29kZS5sZW5ndGggJiYgc2hvdWxkSGF2ZUNvZGVUb2dnbGUoJGNvZGVbMF0pKSB7XG4gICAgICBhZGRUb2dnbGVCdXR0b25Ub0NvZGVCbG9jaygkcHJlKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIOe7meaJgOaciea2iOaBr+a3u+WKoOaKmOWPoOaOp+S7tlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkQ29kZVRvZ2dsZUJ1dHRvbnNUb0FsbE1lc3NhZ2VzKCkge1xuICBjb25zdCAkY2hhdCA9ICQoJyNjaGF0Jyk7XG4gIGlmICghJGNoYXQubGVuZ3RoKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgJGNoYXQuZmluZCgnLm1lcyAubWVzX2Jsb2NrIC5tZXNfdGV4dCwgLm1lcyAubWVzX2Jsb2NrIC5tZXNfcmVhc29uaW5nX2RldGFpbHMnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCAkbWVzVGV4dCA9ICQodGhpcyk7XG4gICAgYWRkVG9nZ2xlQnV0dG9uc1RvTWVzc2FnZSgkbWVzVGV4dCk7XG4gIH0pO1xufVxuXG4vKipcbiAqIOS7juS7o+eggeWdl+S4reenu+mZpOaKmOWPoOaMiemSrlxuICogQHBhcmFtICRjb2RlRWxlbWVudCDku6PnoIHlhYPntKBcbiAqL1xuZnVuY3Rpb24gcmVtb3ZlVG9nZ2xlQnV0dG9uRnJvbUNvZGVCbG9jaygkY29kZUVsZW1lbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pIHtcbiAgY29uc3QgJHBhcmVudCA9ICRjb2RlRWxlbWVudC5wYXJlbnQoKTtcbiAgY29uc3QgJHRvZ2dsZUJ1dHRvbiA9ICRwYXJlbnQucHJldignLmNvZGUtdG9nZ2xlLWJ1dHRvbicpO1xuICBpZiAoJHRvZ2dsZUJ1dHRvbi5sZW5ndGgpIHtcbiAgICAkdG9nZ2xlQnV0dG9uLm9mZignY2xpY2snKS5yZW1vdmUoKTtcbiAgfVxufVxuXG4vKipcbiAqIOagueaNrm1lc0lk56e76Zmk5oqY5Y+g5o6n5Lu2XG4gKiBAcGFyYW0gbWVzSWQg5raI5oGvSURcbiAqL1xuZnVuY3Rpb24gcmVtb3ZlQ29kZVRvZ2dsZUJ1dHRvbnNCeU1lc0lkKG1lc0lkOiBudW1iZXIpIHtcbiAgY29uc3QgJG1lc3NhZ2VFbGVtZW50ID0gJChgZGl2W21lc2lkPVwiJHttZXNJZH1cIl1gKTtcbiAgY29uc3QgJGNvZGVFbGVtZW50cyA9ICRtZXNzYWdlRWxlbWVudC5maW5kKCdwcmUgY29kZScpO1xuXG4gICRjb2RlRWxlbWVudHMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgJGNvZGVFbGVtZW50ID0gJCh0aGlzKTtcblxuICAgIC8vIOWPquacieS4jeW6lOivpeacieaKmOWPoOaMiemSrueahOS7o+eggeWdl+aJjeenu+mZpOaMiemSrlxuICAgIGlmICghc2hvdWxkSGF2ZUNvZGVUb2dnbGUodGhpcykpIHtcbiAgICAgIHJlbW92ZVRvZ2dsZUJ1dHRvbkZyb21Db2RlQmxvY2soJGNvZGVFbGVtZW50KTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIOenu+mZpOaJgOacieaKmOWPoOaOp+S7tlxuICovXG5mdW5jdGlvbiByZW1vdmVBbGxDb2RlVG9nZ2xlQnV0dG9ucygpIHtcbiAgJCgnLmNvZGUtdG9nZ2xlLWJ1dHRvbicpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICQodGhpcykub2ZmKCdjbGljaycpLnJlbW92ZSgpO1xuICB9KTtcbiAgLy8g5Y675o6J5omA5pyJcHJl55qEZGlzcGxheTpub25lXG4gICQoJ3ByZScpLmNzcygnZGlzcGxheScsICdibG9jaycpO1xufVxuXG4vKipcbiAqIOa3u+WKoOWJjeerr+WNoea4suafk+S8mOWMluiuvue9rlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncygpIHtcbiAgaGxqcy5oaWdobGlnaHRFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybjtcbiAgfTtcbn1cblxuLyoqXG4gKiDnp7vpmaTliY3nq6/ljaHmuLLmn5PkvJjljJborr7nva5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVJlbmRlcmluZ09wdGltaXplU2V0dGluZ3MoKSB7XG4gIGhsanMuaGlnaGxpZ2h0RWxlbWVudCA9IG9yaWdpbmFsSGlnaGxpZ2h0RWxlbWVudDtcbn1cblxuLyoqXG4gKiDlpITnkIbph43lnovliY3nq6/ljaHmuLLmn5PkvJjljJZcbiAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55So6YeN5Z6L5YmN56uv5Y2h5riy5p+T5LyY5YyWXG4gKiBAcGFyYW0gdXNlcklucHV0IOaYr+WQpueUseeUqOaIt+aJi+WKqOinpuWPkVxuICovXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVSZW5kZXJpbmdPcHRpbWl6YXRpb25Ub2dnbGUoZW5hYmxlOiBib29sZWFuLCB1c2VySW5wdXQ6IGJvb2xlYW4gPSB0cnVlKSB7XG4gIGlmICh1c2VySW5wdXQpIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX29wdGltaXplJywgZW5hYmxlKTtcbiAgICBpc1JlbmRlcmluZ09wdGltaXplRW5hYmxlZCA9IGVuYWJsZTtcbiAgfVxuXG4gIGlmIChlbmFibGUpIHtcbiAgICBhZGRSZW5kZXJpbmdPcHRpbWl6ZVNldHRpbmdzKCk7XG4gICAgaWYgKHVzZXJJbnB1dCkge1xuICAgICAgYXdhaXQgY2xlYXJBbmRSZW5kZXJBbGxJZnJhbWVzKCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJlbW92ZVJlbmRlcmluZ09wdGltaXplU2V0dGluZ3MoKTtcbiAgICBpZiAodXNlcklucHV0KSB7XG4gICAgICBhd2FpdCBjbGVhckFuZFJlbmRlckFsbElmcmFtZXMoKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiDmt7vliqDku6PnoIHlnZfmipjlj6Dorr7nva5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzKCkge1xuICBpbmplY3RDb2RlQmxvY2tIaWRlU3R5bGVzKCk7XG59XG5cbi8qKlxuICog56e76Zmk5Luj56CB5Z2X5oqY5Y+g6K6+572uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncygpIHtcbiAgcmVtb3ZlQ29kZUJsb2NrSGlkZVN0eWxlcygpO1xuICByZW1vdmVBbGxDb2RlVG9nZ2xlQnV0dG9ucygpO1xufVxuXG4vKipcbiAqIOWkhOeQhuS7o+eggeWdl+aKmOWPoOiuvue9ruaUueWPmFxuICogQHBhcmFtIGVuYWJsZSDmmK/lkKblkK/nlKjku6PnoIHlnZfmipjlj6BcbiAqIEBwYXJhbSB1c2VySW5wdXQg5piv5ZCm55Sx55So5oi35omL5Yqo6Kem5Y+RXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVJlbmRlcmluZ0hpZGVTdHlsZVRvZ2dsZShlbmFibGU6IGJvb2xlYW4sIHVzZXJJbnB1dDogYm9vbGVhbiA9IHRydWUpIHtcbiAgaWYgKHVzZXJJbnB1dCkge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfaGlkZV9zdHlsZScsIGVuYWJsZSk7XG4gICAgaXNSZW5kZXJpbmdIaWRlU3R5bGVFbmFibGVkID0gZW5hYmxlO1xuICB9XG5cbiAgaWYgKGVuYWJsZSkge1xuICAgIGFkZFJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzKCk7XG4gICAgaWYgKHVzZXJJbnB1dCkge1xuICAgICAgYXdhaXQgY2xlYXJBbmRSZW5kZXJBbGxJZnJhbWVzKCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJlbW92ZVJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzKCk7XG4gICAgaWYgKHVzZXJJbnB1dCkge1xuICAgICAgYXdhaXQgY2xlYXJBbmRSZW5kZXJBbGxJZnJhbWVzKCk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICog5aSE55CG5riy5p+T5Zmo5ZCv55So6K6+572u5pS55Y+YXG4gKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqOa4suafk+WZqFxuICogQHBhcmFtIHVzZXJJbnB1dCDmmK/lkKbnlLHnlKjmiLfmiYvliqjop6blj5FcbiAqL1xuYXN5bmMgZnVuY3Rpb24gaGFuZGxlUmVuZGVyRW5hYmxlVG9nZ2xlKGVuYWJsZTogYm9vbGVhbiwgdXNlcklucHV0OiBib29sZWFuID0gdHJ1ZSkge1xuICBpZiAodXNlcklucHV0KSB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9lbmFibGVkJywgZW5hYmxlKTtcbiAgICBpc1JlbmRlckVuYWJsZWQgPSBlbmFibGU7XG4gIH1cbiAgaWYgKGVuYWJsZSkge1xuICAgICQoJyNyZW5kZXItc2V0dGluZ3MtY29udGVudCAuZXh0ZW5zaW9uLWNvbnRlbnQtaXRlbScpLm5vdCgnOmZpcnN0JykuY3NzKCdvcGFjaXR5JywgMSk7XG4gICAgaWYgKGlzUmVuZGVyaW5nT3B0aW1pemVFbmFibGVkKSB7XG4gICAgICBhZGRSZW5kZXJpbmdPcHRpbWl6ZVNldHRpbmdzKCk7XG4gICAgfVxuICAgIGlmIChpc1JlbmRlcmluZ0hpZGVTdHlsZUVuYWJsZWQpIHtcbiAgICAgIGFkZFJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzKCk7XG4gICAgfVxuICAgIGF3YWl0IHJlbmRlckFsbElmcmFtZXMoKTtcbiAgfSBlbHNlIHtcbiAgICAkKCcjcmVuZGVyLXNldHRpbmdzLWNvbnRlbnQgLmV4dGVuc2lvbi1jb250ZW50LWl0ZW0nKS5ub3QoJzpmaXJzdCcpLmNzcygnb3BhY2l0eScsIDAuNSk7XG4gICAgaWYgKGlzUmVuZGVyaW5nT3B0aW1pemVFbmFibGVkKSB7XG4gICAgICByZW1vdmVSZW5kZXJpbmdPcHRpbWl6ZVNldHRpbmdzKCk7XG4gICAgfVxuICAgIGlmIChpc1JlbmRlcmluZ0hpZGVTdHlsZUVuYWJsZWQpIHtcbiAgICAgIHJlbW92ZVJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzKCk7XG4gICAgfVxuICAgIGF3YWl0IGNsZWFyQWxsSWZyYW1lcygpO1xuICAgIGF3YWl0IHJlbG9hZEN1cnJlbnRDaGF0KCk7XG4gIH1cbn1cblxuLyoqXG4gKiDmt7vliqDliY3nq6/muLLmn5Plv6vpgJ/mjInpkq5cbiAqL1xuZnVuY3Rpb24gYWRkUmVuZGVyUXVpY2tCdXR0b24oKSB7XG4gIGNvbnN0IGJ1dHRvbkh0bWwgPSAkKGBcbiAgPGRpdiBpZD1cInRhdmVybi1oZWxwZXItcmVuZGVyLWNvbnRhaW5lclwiIGNsYXNzPVwibGlzdC1ncm91cC1pdGVtIGZsZXgtY29udGFpbmVyIGZsZXhHYXA1IGludGVyYWN0YWJsZVwiPlxuICAgICAgPGRpdiBjbGFzcz1cImZhLXNvbGlkIGZhLXB1enpsZS1waWVjZSBleHRlbnNpb25zTWVudUV4dGVuc2lvbkJ1dHRvblwiIC8+PC9kaXY+XG4gICAgICA8c3BhbiBpZD1cInRhdmVybi1oZWxwZXItcmVuZGVyLXRleHRcIj4ke2lzUmVuZGVyRW5hYmxlZCA/ICflhbPpl63liY3nq6/muLLmn5MnIDogJ+W8gOWQr+WJjeerr+a4suafkyd9PC9zcGFuPlxuICA8L2Rpdj5gKTtcbiAgYnV0dG9uSHRtbC5jc3MoJ2Rpc3BsYXknLCAnZmxleCcpO1xuICAkKCcjZXh0ZW5zaW9uc01lbnUnKS5hcHBlbmQoYnV0dG9uSHRtbCk7XG4gICQoJyN0YXZlcm4taGVscGVyLXJlbmRlci1jb250YWluZXInKS5vbignY2xpY2snLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgJCgnI3RhdmVybi1oZWxwZXItcmVuZGVyLXRleHQnKS50ZXh0KCFpc1JlbmRlckVuYWJsZWQgPyAn5YWz6Zet5YmN56uv5riy5p+TJyA6ICflvIDlkK/liY3nq6/muLLmn5MnKTtcbiAgICBhd2FpdCBoYW5kbGVSZW5kZXJFbmFibGVUb2dnbGUoIWlzUmVuZGVyRW5hYmxlZCwgdHJ1ZSk7XG4gICAgJCgnI3JlbmRlci1lbmFibGUtdG9nZ2xlJykucHJvcCgnY2hlY2tlZCcsIGlzUmVuZGVyRW5hYmxlZCk7XG4gIH0pO1xufVxuXG4vKipcbiAqIOWIneWni+WMlmlmcmFtZeaOp+WItumdouadv1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdElmcmFtZVBhbmVsKCkge1xuICAvLyDlpITnkIbph43lnovliY3nq6/ljaHmuLLmn5PkvJjljJZcbiAgaXNSZW5kZXJpbmdPcHRpbWl6ZUVuYWJsZWQgPSBnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfb3B0aW1pemUnKTtcbiAgaWYgKGlzUmVuZGVyaW5nT3B0aW1pemVFbmFibGVkKSB7XG4gICAgaGFuZGxlUmVuZGVyaW5nT3B0aW1pemF0aW9uVG9nZ2xlKHRydWUsIGZhbHNlKTtcbiAgfVxuICAkKCcjcmVuZGVyLW9wdGltaXplLXRvZ2dsZScpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBpc1JlbmRlcmluZ09wdGltaXplRW5hYmxlZClcbiAgICAub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlUmVuZGVyaW5nT3B0aW1pemF0aW9uVG9nZ2xlKGV2ZW50LnRhcmdldC5jaGVja2VkLCB0cnVlKSk7XG5cbiAgaXNSZW5kZXJpbmdIaWRlU3R5bGVFbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2hpZGVfc3R5bGUnKTtcbiAgaWYgKGlzUmVuZGVyaW5nSGlkZVN0eWxlRW5hYmxlZCkge1xuICAgIGhhbmRsZVJlbmRlcmluZ0hpZGVTdHlsZVRvZ2dsZSh0cnVlLCBmYWxzZSk7XG4gIH1cbiAgJCgnI3JlbmRlci1oaWRlLXN0eWxlLXRvZ2dsZScpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBpc1JlbmRlcmluZ0hpZGVTdHlsZUVuYWJsZWQpXG4gICAgLm9uKCdjbGljaycsIChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IGhhbmRsZVJlbmRlcmluZ0hpZGVTdHlsZVRvZ2dsZShldmVudC50YXJnZXQuY2hlY2tlZCwgdHJ1ZSkpO1xuXG4gIC8vIOWkhOeQhuWkhOeQhua3seW6puiuvue9rlxuICByZW5kZXJEZXB0aCA9IGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9kZXB0aCcpO1xuICAkKCcjcmVuZGVyLWRlcHRoJylcbiAgICAudmFsKHJlbmRlckRlcHRoID8/IGRlZmF1bHRJZnJhbWVTZXR0aW5ncy5yZW5kZXJfZGVwdGgpXG4gICAgLm9uKCdibHVyJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBvbkRlcHRoSW5wdXQoKGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSk7XG4gICAgfSk7XG5cbiAgaXNSZW5kZXJFbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2VuYWJsZWQnKTtcbiAgaGFuZGxlUmVuZGVyRW5hYmxlVG9nZ2xlKGlzUmVuZGVyRW5hYmxlZCwgZmFsc2UpO1xuICAkKCcjcmVuZGVyLWVuYWJsZS10b2dnbGUnKVxuICAgIC5wcm9wKCdjaGVja2VkJywgaXNSZW5kZXJFbmFibGVkKVxuICAgIC5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiBoYW5kbGVSZW5kZXJFbmFibGVUb2dnbGUoZXZlbnQudGFyZ2V0LmNoZWNrZWQsIHRydWUpKTtcblxuICAvLyDlpITnkIbmsrnnjLTlhbzlrrnmgKforr7nva5cbiAgaXNUYW1wZXJtb25rZXlFbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIudGFtcGVybW9ua2V5X2NvbXBhdGliaWxpdHknKTtcbiAgaWYgKGlzVGFtcGVybW9ua2V5RW5hYmxlZCkge1xuICAgIGhhbmRsZVRhbXBlcm1vbmtleUNvbXBhdGliaWxpdHlDaGFuZ2UodHJ1ZSwgZmFsc2UpO1xuICB9XG4gICQoJyN0YW1wZXJtb25rZXktY29tcGF0aWJpbGl0eS10b2dnbGUnKVxuICAgIC5wcm9wKCdjaGVja2VkJywgaXNUYW1wZXJtb25rZXlFbmFibGVkKVxuICAgIC5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiBoYW5kbGVUYW1wZXJtb25rZXlDb21wYXRpYmlsaXR5Q2hhbmdlKGV2ZW50LnRhcmdldC5jaGVja2VkLCB0cnVlKSk7XG5cbiAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCQoJ2lmcmFtZVtkYXRhLW5lZWRzLXZoPVwidHJ1ZVwiXScpLmxlbmd0aCkge1xuICAgICAgdXBkYXRlSWZyYW1lVmlld3BvcnRIZWlnaHQoKTtcbiAgICB9XG4gIH0pO1xuXG4gIGFkZFJlbmRlclF1aWNrQnV0dG9uKCk7XG4gIGluamVjdExvYWRpbmdTdHlsZXMoKTtcbiAgc2V0dXBJZnJhbWVSZW1vdmFsTGlzdGVuZXIoKTtcbn1cblxuLyoqXG4gKiDliKTmlq3ku6PnoIHlnZfmmK/lkKblupTor6XmnInmipjlj6DmjInpkq5cbiAqIEBwYXJhbSBjb2RlRWxlbWVudCDku6PnoIHlnZflhYPntKBcbiAqIEByZXR1cm5zIOaYr+WQpuW6lOivpeacieaKmOWPoOaMiemSrlxuICovXG5mdW5jdGlvbiBzaG91bGRIYXZlQ29kZVRvZ2dsZShjb2RlRWxlbWVudDogSFRNTEVsZW1lbnQpOiBib29sZWFuIHtcbiAgY29uc3QgZXh0cmFjdGVkVGV4dCA9IGV4dHJhY3RUZXh0RnJvbUNvZGUoY29kZUVsZW1lbnQpO1xuICByZXR1cm4gIShleHRyYWN0ZWRUZXh0LmluY2x1ZGVzKCc8Ym9keScpICYmIGV4dHJhY3RlZFRleHQuaW5jbHVkZXMoJzwvYm9keT4nKSk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/message_iframe/index.ts\n")},"./src/component/reference/index.ts":
/*!******************************************!*\
  !*** ./src/component/reference/index.ts ***!
  \******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initReference: () => (/* binding */ initReference)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandParser */ \"@sillytavern/scripts/slash-commands/SlashCommandParser\");\n\nfunction formatSlashCommands() {\n    const cmdList = Object.keys(_sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__.SlashCommandParser.commands)\n        .filter(key => _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__.SlashCommandParser.commands[key].name === key) // exclude aliases\n        .sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()))\n        .map(key => _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__.SlashCommandParser.commands[key]);\n    const transform_unnamed_arg = (arg) => {\n        return {\n            is_required: arg.isRequired,\n            default_value: arg.defaultValue ?? undefined,\n            accepts_multiple: arg.acceptsMultiple,\n            enum_list: arg.enumList.length > 0 ? arg.enumList.map(e => e.value) : undefined,\n            type_list: arg.typeList.length > 0 ? arg.typeList : undefined,\n        };\n    };\n    const transform_named_arg = (arg) => {\n        return {\n            name: arg.name,\n            ...transform_unnamed_arg(arg),\n        };\n    };\n    const transform_help_string = (help_string) => {\n        const content = $('<span>').html(help_string);\n        return content\n            .text()\n            .split('\\n')\n            .map(line => line.trim())\n            .filter(line => line !== '')\n            .join(' ');\n    };\n    return cmdList\n        .map(cmd => ({\n        name: cmd.name,\n        named_args: cmd.namedArgumentList.map(transform_named_arg) ?? [],\n        unnamed_args: cmd.unnamedArgumentList.map(transform_unnamed_arg) ?? [],\n        return_type: cmd.returns ?? 'void',\n        help_string: transform_help_string(cmd.helpString) ?? 'NO DETAILS',\n    }))\n        .map(cmd => `/${cmd.name}${cmd.named_args.length > 0 ? ` ` : ``}${cmd.named_args\n        .map(arg => `[${arg.accepts_multiple ? `...` : ``}${arg.name}=${arg.enum_list ? arg.enum_list.join('|') : arg.type_list ? arg.type_list.join('|') : ''}]${arg.is_required ? `` : `?`}${arg.default_value ? `=${arg.default_value}` : ``}`)\n        .join(' ')}${cmd.unnamed_args.length > 0 ? ` ` : ``}${cmd.unnamed_args\n        .map(arg => `(${arg.accepts_multiple ? `...` : ``}${arg.enum_list ? arg.enum_list.join('|') : arg.type_list ? arg.type_list.join('|') : ''})${arg.is_required ? `` : `?`}${arg.default_value ? `=${arg.default_value}` : ``}`)\n        .join(' ')} // ${cmd.help_string}`)\n        .join('\\n');\n}\nasync function initReference() {\n    $('#download_slash_commands').on('click', function () {\n        const url = URL.createObjectURL(new Blob([formatSlashCommands()], { type: 'text/plain' }));\n        $(this).attr('href', url);\n        $(this).attr('download', 'slash_command.txt');\n        setTimeout(() => URL.revokeObjectURL(url), 0);\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQyxDQUFDLENBQUMsQ0FBQyxFQUN0RixJQUFJLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FDdEY7U0FDQSxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sR0FBRyxDQUFDLFdBQVcsRUFBRSxDQUN2QztTQUNBLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNoQixDQUFDO0FBRU0sS0FBSyxVQUFVLGFBQWE7SUFDakMsQ0FBQyxDQUFDLDBCQUEwQixDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRTtRQUN4QyxNQUFNLEdBQUcsR0FBRyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQztRQUMzRixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQztRQUMxQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1FBQzlDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2hELENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvcmVmZXJlbmNlL2luZGV4LnRzPzQ2ZTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgU2xhc2hDb21tYW5kQXJndW1lbnQsXG4gIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQsXG59IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZEFyZ3VtZW50JztcbmltcG9ydCB7IFNsYXNoQ29tbWFuZFBhcnNlciB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZFBhcnNlcic7XG5cbmZ1bmN0aW9uIGZvcm1hdFNsYXNoQ29tbWFuZHMoKTogc3RyaW5nIHtcbiAgY29uc3QgY21kTGlzdCA9IE9iamVjdC5rZXlzKFNsYXNoQ29tbWFuZFBhcnNlci5jb21tYW5kcylcbiAgICAuZmlsdGVyKGtleSA9PiBTbGFzaENvbW1hbmRQYXJzZXIuY29tbWFuZHNba2V5XS5uYW1lID09PSBrZXkpIC8vIGV4Y2x1ZGUgYWxpYXNlc1xuICAgIC5zb3J0KChhLCBiKSA9PiBhLnRvTG93ZXJDYXNlKCkubG9jYWxlQ29tcGFyZShiLnRvTG93ZXJDYXNlKCkpKVxuICAgIC5tYXAoa2V5ID0+IFNsYXNoQ29tbWFuZFBhcnNlci5jb21tYW5kc1trZXldKTtcblxuICBjb25zdCB0cmFuc2Zvcm1fdW5uYW1lZF9hcmcgPSAoYXJnOiBTbGFzaENvbW1hbmRBcmd1bWVudCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBpc19yZXF1aXJlZDogYXJnLmlzUmVxdWlyZWQsXG4gICAgICBkZWZhdWx0X3ZhbHVlOiBhcmcuZGVmYXVsdFZhbHVlID8/IHVuZGVmaW5lZCxcbiAgICAgIGFjY2VwdHNfbXVsdGlwbGU6IGFyZy5hY2NlcHRzTXVsdGlwbGUsXG4gICAgICBlbnVtX2xpc3Q6IGFyZy5lbnVtTGlzdC5sZW5ndGggPiAwID8gYXJnLmVudW1MaXN0Lm1hcChlID0+IGUudmFsdWUpIDogdW5kZWZpbmVkLFxuICAgICAgdHlwZV9saXN0OiBhcmcudHlwZUxpc3QubGVuZ3RoID4gMCA/IGFyZy50eXBlTGlzdCA6IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9O1xuXG4gIGNvbnN0IHRyYW5zZm9ybV9uYW1lZF9hcmcgPSAoYXJnOiBTbGFzaENvbW1hbmROYW1lZEFyZ3VtZW50KSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IGFyZy5uYW1lLFxuICAgICAgLi4udHJhbnNmb3JtX3VubmFtZWRfYXJnKGFyZyksXG4gICAgfTtcbiAgfTtcblxuICBjb25zdCB0cmFuc2Zvcm1faGVscF9zdHJpbmcgPSAoaGVscF9zdHJpbmc6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSAkKCc8c3Bhbj4nKS5odG1sKGhlbHBfc3RyaW5nKTtcbiAgICByZXR1cm4gY29udGVudFxuICAgICAgLnRleHQoKVxuICAgICAgLnNwbGl0KCdcXG4nKVxuICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxuICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUgIT09ICcnKVxuICAgICAgLmpvaW4oJyAnKTtcbiAgfTtcblxuICByZXR1cm4gY21kTGlzdFxuICAgIC5tYXAoY21kID0+ICh7XG4gICAgICBuYW1lOiBjbWQubmFtZSxcbiAgICAgIG5hbWVkX2FyZ3M6IGNtZC5uYW1lZEFyZ3VtZW50TGlzdC5tYXAodHJhbnNmb3JtX25hbWVkX2FyZykgPz8gW10sXG4gICAgICB1bm5hbWVkX2FyZ3M6IGNtZC51bm5hbWVkQXJndW1lbnRMaXN0Lm1hcCh0cmFuc2Zvcm1fdW5uYW1lZF9hcmcpID8/IFtdLFxuICAgICAgcmV0dXJuX3R5cGU6IGNtZC5yZXR1cm5zID8/ICd2b2lkJyxcbiAgICAgIGhlbHBfc3RyaW5nOiB0cmFuc2Zvcm1faGVscF9zdHJpbmcoY21kLmhlbHBTdHJpbmcpID8/ICdOTyBERVRBSUxTJyxcbiAgICB9KSlcbiAgICAubWFwKFxuICAgICAgY21kID0+XG4gICAgICAgIGAvJHtjbWQubmFtZX0ke2NtZC5uYW1lZF9hcmdzLmxlbmd0aCA+IDAgPyBgIGAgOiBgYH0ke2NtZC5uYW1lZF9hcmdzXG4gICAgICAgICAgLm1hcChcbiAgICAgICAgICAgIGFyZyA9PlxuICAgICAgICAgICAgICBgWyR7YXJnLmFjY2VwdHNfbXVsdGlwbGUgPyBgLi4uYCA6IGBgfSR7YXJnLm5hbWV9PSR7XG4gICAgICAgICAgICAgICAgYXJnLmVudW1fbGlzdCA/IGFyZy5lbnVtX2xpc3Quam9pbignfCcpIDogYXJnLnR5cGVfbGlzdCA/IGFyZy50eXBlX2xpc3Quam9pbignfCcpIDogJydcbiAgICAgICAgICAgICAgfV0ke2FyZy5pc19yZXF1aXJlZCA/IGBgIDogYD9gfSR7YXJnLmRlZmF1bHRfdmFsdWUgPyBgPSR7YXJnLmRlZmF1bHRfdmFsdWV9YCA6IGBgfWAsXG4gICAgICAgICAgKVxuICAgICAgICAgIC5qb2luKCcgJyl9JHtjbWQudW5uYW1lZF9hcmdzLmxlbmd0aCA+IDAgPyBgIGAgOiBgYH0ke2NtZC51bm5hbWVkX2FyZ3NcbiAgICAgICAgICAubWFwKFxuICAgICAgICAgICAgYXJnID0+XG4gICAgICAgICAgICAgIGAoJHthcmcuYWNjZXB0c19tdWx0aXBsZSA/IGAuLi5gIDogYGB9JHtcbiAgICAgICAgICAgICAgICBhcmcuZW51bV9saXN0ID8gYXJnLmVudW1fbGlzdC5qb2luKCd8JykgOiBhcmcudHlwZV9saXN0ID8gYXJnLnR5cGVfbGlzdC5qb2luKCd8JykgOiAnJ1xuICAgICAgICAgICAgICB9KSR7YXJnLmlzX3JlcXVpcmVkID8gYGAgOiBgP2B9JHthcmcuZGVmYXVsdF92YWx1ZSA/IGA9JHthcmcuZGVmYXVsdF92YWx1ZX1gIDogYGB9YCxcbiAgICAgICAgICApXG4gICAgICAgICAgLmpvaW4oJyAnKX0gLy8gJHtjbWQuaGVscF9zdHJpbmd9YCxcbiAgICApXG4gICAgLmpvaW4oJ1xcbicpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdFJlZmVyZW5jZSgpIHtcbiAgJCgnI2Rvd25sb2FkX3NsYXNoX2NvbW1hbmRzJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2Zvcm1hdFNsYXNoQ29tbWFuZHMoKV0sIHsgdHlwZTogJ3RleHQvcGxhaW4nIH0pKTtcbiAgICAkKHRoaXMpLmF0dHIoJ2hyZWYnLCB1cmwpO1xuICAgICQodGhpcykuYXR0cignZG93bmxvYWQnLCAnc2xhc2hfY29tbWFuZC50eHQnKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IFVSTC5yZXZva2VPYmplY3RVUkwodXJsKSwgMCk7XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/reference/index.ts\n")},"./src/component/script_iframe.ts":
/*!****************************************!*\
  !*** ./src/component/script_iframe.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   destroyCharacterLevelOnExtension: () => (/* binding */ destroyCharacterLevelOnExtension),\n/* harmony export */   initializeCharacterLevelOnExtension: () => (/* binding */ initializeCharacterLevelOnExtension)\n/* harmony export */ });\n/* harmony import */ var _function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/function/tavern_regex */ \"./src/function/tavern_regex.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _third_party_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/third_party.html */ \"./src/third_party.html\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n\n\n\n\nfunction loadScripts() {\n    const prefix = '-';\n    const filterScriptFromRegex = (script) => script.scriptName.replace(/^.*/, '').startsWith(prefix);\n    const isEnabled = (script) => !script.disabled;\n    const toName = (script) => script.scriptName.replace(/^.*/, '').replace(prefix, '');\n    const scripts = [];\n    const enabled_global_regexes = (0,_function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__.getGlobalRegexes)().filter(filterScriptFromRegex).filter(isEnabled);\n    scripts.push(...enabled_global_regexes);\n    const enabled_character_regexes = (0,_function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__.getCharacterRegexes)()\n        .filter(filterScriptFromRegex)\n        .filter(isEnabled)\n        .filter(script => ((0,_function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__.isCharacterTavernRegexEnabled)() ? true : script.runOnEdit));\n    scripts.push(...enabled_character_regexes);\n    const to_script = (script) => ({ name: toName(script), code: script.replaceString });\n    return scripts.map(to_script);\n}\nconst script_map = new Map();\nfunction makeScriptIframe(script) {\n    const iframe = document.createElement('iframe');\n    iframe.style.display = 'none';\n    iframe.id = `script-iframe-${script.name}`;\n    const srcdocContent = `\n    <html>\n    <head>\n      ${_third_party_html__WEBPACK_IMPORTED_MODULE_2__[\"default\"]}\n      <script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_1__.script_url.get('iframe_client')}\"><\/script>\n    </head>\n    <body>\n      ${script.code}\n    </body>\n    </html>\n  `;\n    iframe.srcdoc = srcdocContent;\n    const load_promise = new Promise(resolve => {\n        iframe.onload = () => {\n            console.info(`[(deprecated)Script](${iframe.id}) `);\n            resolve();\n        };\n    });\n    document.body.appendChild(iframe);\n    return { iframe, load_promise };\n}\nfunction destroy() {\n    if (script_map.size !== 0) {\n        console.log(`[(deprecated)Script] ...`);\n        script_map.forEach((iframe, _) => {\n            iframe.remove();\n        });\n        script_map.clear();\n        console.log(`[(deprecated)Script] !`);\n    }\n}\nasync function initialize() {\n    try {\n        destroy();\n        const scripts = loadScripts();\n        console.info(`[(deprecated)Script] : ${JSON.stringify(scripts.map(script => script.name))}`);\n        const load_promises = [];\n        scripts.forEach(script => {\n            const { iframe, load_promise } = makeScriptIframe(script);\n            script_map.set(script.name, iframe);\n            load_promises.push(load_promise);\n        });\n        await Promise.allSettled(load_promises);\n    }\n    catch (error) {\n        console.error('[(deprecated)Script] :', error);\n        throw error;\n    }\n}\nconst load_events = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.event_types.CHAT_CHANGED];\nfunction initializeCharacterLevelOnExtension() {\n    initialize();\n    load_events.forEach(eventType => {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.makeFirst(eventType, initialize);\n    });\n}\nfunction destroyCharacterLevelOnExtension() {\n    load_events.forEach(eventType => {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.removeListener(eventType, initialize);\n    });\n    destroy();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxDQUFDO1FBQ3ZELE1BQU0sS0FBSyxDQUFDO0lBQ2QsQ0FBQztBQUNILENBQUM7QUFFRCxNQUFNLFdBQVcsR0FBRyxDQUFDLDREQUFXLENBQUMsWUFBWSxDQUFVLENBQUM7QUFFakQsU0FBUyxtQ0FBbUM7SUFDakQsVUFBVSxFQUFFLENBQUM7SUFDYixXQUFXLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1FBQzlCLDREQUFXLENBQUMsU0FBUyxDQUFDLFNBQVMsRUFBRSxVQUFVLENBQUMsQ0FBQztJQUMvQyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFTSxTQUFTLGdDQUFnQztJQUM5QyxXQUFXLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1FBQzlCLDREQUFXLENBQUMsY0FBYyxDQUFDLFNBQVMsRUFBRSxVQUFVLENBQUMsQ0FBQztJQUNwRCxDQUFDLENBQUMsQ0FBQztJQUNILE9BQU8sRUFBRSxDQUFDO0FBQ1osQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvc2NyaXB0X2lmcmFtZS50cz83NDcyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldENoYXJhY3RlclJlZ2V4ZXMsIGdldEdsb2JhbFJlZ2V4ZXMsIGlzQ2hhcmFjdGVyVGF2ZXJuUmVnZXhFbmFibGVkIH0gZnJvbSAnQC9mdW5jdGlvbi90YXZlcm5fcmVnZXgnO1xuaW1wb3J0IHsgc2NyaXB0X3VybCB9IGZyb20gJ0Avc2NyaXB0X3VybCc7XG5pbXBvcnQgdGhpcmRfcGFydHkgZnJvbSAnQC90aGlyZF9wYXJ0eS5odG1sJztcblxuaW1wb3J0IHsgZXZlbnRfdHlwZXMsIGV2ZW50U291cmNlIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBSZWdleFNjcmlwdERhdGEgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9jaGFyLWRhdGEnO1xuXG5pbnRlcmZhY2UgU2NyaXB0IHtcbiAgbmFtZTogc3RyaW5nO1xuICBjb2RlOiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGxvYWRTY3JpcHRzKCk6IFNjcmlwdFtdIHtcbiAgY29uc3QgcHJlZml4ID0gJ+iEmuacrC0nO1xuICBjb25zdCBmaWx0ZXJTY3JpcHRGcm9tUmVnZXggPSAoc2NyaXB0OiBSZWdleFNjcmlwdERhdGEpID0+XG4gICAgc2NyaXB0LnNjcmlwdE5hbWUucmVwbGFjZSgvXuOAkC4q44CRLywgJycpLnN0YXJ0c1dpdGgocHJlZml4KTtcbiAgY29uc3QgaXNFbmFibGVkID0gKHNjcmlwdDogUmVnZXhTY3JpcHREYXRhKSA9PiAhc2NyaXB0LmRpc2FibGVkO1xuICBjb25zdCB0b05hbWUgPSAoc2NyaXB0OiBSZWdleFNjcmlwdERhdGEpID0+IHNjcmlwdC5zY3JpcHROYW1lLnJlcGxhY2UoL17jgJAuKuOAkS8sICcnKS5yZXBsYWNlKHByZWZpeCwgJycpO1xuXG4gIGNvbnN0IHNjcmlwdHM6IFJlZ2V4U2NyaXB0RGF0YVtdID0gW107XG5cbiAgY29uc3QgZW5hYmxlZF9nbG9iYWxfcmVnZXhlcyA9IGdldEdsb2JhbFJlZ2V4ZXMoKS5maWx0ZXIoZmlsdGVyU2NyaXB0RnJvbVJlZ2V4KS5maWx0ZXIoaXNFbmFibGVkKTtcbiAgc2NyaXB0cy5wdXNoKC4uLmVuYWJsZWRfZ2xvYmFsX3JlZ2V4ZXMpO1xuXG4gIGNvbnN0IGVuYWJsZWRfY2hhcmFjdGVyX3JlZ2V4ZXMgPSBnZXRDaGFyYWN0ZXJSZWdleGVzKClcbiAgICAuZmlsdGVyKGZpbHRlclNjcmlwdEZyb21SZWdleClcbiAgICAuZmlsdGVyKGlzRW5hYmxlZClcbiAgICAuZmlsdGVyKHNjcmlwdCA9PiAoaXNDaGFyYWN0ZXJUYXZlcm5SZWdleEVuYWJsZWQoKSA/IHRydWUgOiBzY3JpcHQucnVuT25FZGl0KSk7XG4gIHNjcmlwdHMucHVzaCguLi5lbmFibGVkX2NoYXJhY3Rlcl9yZWdleGVzKTtcblxuICBjb25zdCB0b19zY3JpcHQgPSAoc2NyaXB0OiBSZWdleFNjcmlwdERhdGEpID0+ICh7IG5hbWU6IHRvTmFtZShzY3JpcHQpLCBjb2RlOiBzY3JpcHQucmVwbGFjZVN0cmluZyB9KTtcbiAgcmV0dXJuIHNjcmlwdHMubWFwKHRvX3NjcmlwdCk7XG59XG5cbmNvbnN0IHNjcmlwdF9tYXA6IE1hcDxzdHJpbmcsIEhUTUxJRnJhbWVFbGVtZW50PiA9IG5ldyBNYXAoKTtcblxuZnVuY3Rpb24gbWFrZVNjcmlwdElmcmFtZShzY3JpcHQ6IFNjcmlwdCk6IHsgaWZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudDsgbG9hZF9wcm9taXNlOiBQcm9taXNlPHZvaWQ+IH0ge1xuICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIGlmcmFtZS5pZCA9IGBzY3JpcHQtaWZyYW1lLSR7c2NyaXB0Lm5hbWV9YDtcblxuICBjb25zdCBzcmNkb2NDb250ZW50ID0gYFxuICAgIDxodG1sPlxuICAgIDxoZWFkPlxuICAgICAgJHt0aGlyZF9wYXJ0eX1cbiAgICAgIDxzY3JpcHQgc3JjPVwiJHtzY3JpcHRfdXJsLmdldCgnaWZyYW1lX2NsaWVudCcpfVwiPjwvc2NyaXB0PlxuICAgIDwvaGVhZD5cbiAgICA8Ym9keT5cbiAgICAgICR7c2NyaXB0LmNvZGV9XG4gICAgPC9ib2R5PlxuICAgIDwvaHRtbD5cbiAgYDtcblxuICBpZnJhbWUuc3JjZG9jID0gc3JjZG9jQ29udGVudDtcblxuICBjb25zdCBsb2FkX3Byb21pc2UgPSBuZXcgUHJvbWlzZTx2b2lkPihyZXNvbHZlID0+IHtcbiAgICBpZnJhbWUub25sb2FkID0gKCkgPT4ge1xuICAgICAgY29uc29sZS5pbmZvKGBbKGRlcHJlY2F0ZWQpU2NyaXB0XSgke2lmcmFtZS5pZH0pIOWKoOi9veWujOavlWApO1xuICAgICAgcmVzb2x2ZSgpO1xuICAgIH07XG4gIH0pO1xuXG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcblxuICByZXR1cm4geyBpZnJhbWUsIGxvYWRfcHJvbWlzZSB9O1xufVxuXG5mdW5jdGlvbiBkZXN0cm95KCk6IHZvaWQge1xuICBpZiAoc2NyaXB0X21hcC5zaXplICE9PSAwKSB7XG4gICAgY29uc29sZS5sb2coYFsoZGVwcmVjYXRlZClTY3JpcHRdIOa4heeQhuWFqOWxgOiEmuacrC4uLmApO1xuICAgIHNjcmlwdF9tYXAuZm9yRWFjaCgoaWZyYW1lLCBfKSA9PiB7XG4gICAgICBpZnJhbWUucmVtb3ZlKCk7XG4gICAgfSk7XG4gICAgc2NyaXB0X21hcC5jbGVhcigpO1xuICAgIGNvbnNvbGUubG9nKGBbKGRlcHJlY2F0ZWQpU2NyaXB0XSDlhajlsYDohJrmnKzmuIXnkIblrozmiJAhYCk7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICBkZXN0cm95KCk7XG5cbiAgICBjb25zdCBzY3JpcHRzID0gbG9hZFNjcmlwdHMoKTtcbiAgICBjb25zb2xlLmluZm8oYFsoZGVwcmVjYXRlZClTY3JpcHRdIOWKoOi9veWFqOWxgOiEmuacrDogJHtKU09OLnN0cmluZ2lmeShzY3JpcHRzLm1hcChzY3JpcHQgPT4gc2NyaXB0Lm5hbWUpKX1gKTtcblxuICAgIGNvbnN0IGxvYWRfcHJvbWlzZXM6IFByb21pc2U8dm9pZD5bXSA9IFtdO1xuXG4gICAgc2NyaXB0cy5mb3JFYWNoKHNjcmlwdCA9PiB7XG4gICAgICBjb25zdCB7IGlmcmFtZSwgbG9hZF9wcm9taXNlIH0gPSBtYWtlU2NyaXB0SWZyYW1lKHNjcmlwdCk7XG4gICAgICBzY3JpcHRfbWFwLnNldChzY3JpcHQubmFtZSwgaWZyYW1lKTtcbiAgICAgIGxvYWRfcHJvbWlzZXMucHVzaChsb2FkX3Byb21pc2UpO1xuICAgIH0pO1xuXG4gICAgYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKGxvYWRfcHJvbWlzZXMpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1soZGVwcmVjYXRlZClTY3JpcHRdIOWFqOWxgOiEmuacrOWKoOi9veWksei0pTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuY29uc3QgbG9hZF9ldmVudHMgPSBbZXZlbnRfdHlwZXMuQ0hBVF9DSEFOR0VEXSBhcyBjb25zdDtcblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVDaGFyYWN0ZXJMZXZlbE9uRXh0ZW5zaW9uKCkge1xuICBpbml0aWFsaXplKCk7XG4gIGxvYWRfZXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICBldmVudFNvdXJjZS5tYWtlRmlyc3QoZXZlbnRUeXBlLCBpbml0aWFsaXplKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXN0cm95Q2hhcmFjdGVyTGV2ZWxPbkV4dGVuc2lvbigpIHtcbiAgbG9hZF9ldmVudHMuZm9yRWFjaChldmVudFR5cGUgPT4ge1xuICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50VHlwZSwgaW5pdGlhbGl6ZSk7XG4gIH0pO1xuICBkZXN0cm95KCk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/script_iframe.ts\n")},"./src/component/script_repository/button.ts":
/*!***************************************************!*\
  !*** ./src/component/script_repository/button.ts ***!
  \***************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Button: () => (/* binding */ Button),\n/* harmony export */   ButtonFactory: () => (/* binding */ ButtonFactory),\n/* harmony export */   ButtonManager: () => (/* binding */ ButtonManager),\n/* harmony export */   ScriptButton: () => (/* binding */ ScriptButton),\n/* harmony export */   bindQrEnabledChangeListener: () => (/* binding */ bindQrEnabledChangeListener),\n/* harmony export */   checkQrEnabledStatusAndAddButton: () => (/* binding */ checkQrEnabledStatusAndAddButton),\n/* harmony export */   initScriptButton: () => (/* binding */ initScriptButton),\n/* harmony export */   unbindQrEnabledChangeListener: () => (/* binding */ unbindQrEnabledChangeListener)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n\n\nlet isQrEnabled = false;\nlet isCombined = false;\nclass Button {\n    id;\n    name;\n    visible;\n    scriptId;\n    constructor(name, scriptId, visible = true) {\n        this.id = `${scriptId}_${name}`;\n        this.name = name;\n        this.scriptId = scriptId;\n        this.visible = visible;\n    }\n    remove() {\n        $(`#${this.id}`).remove();\n    }\n}\nclass ScriptButton extends Button {\n    constructor(name, scriptId, visible = true) {\n        super(name, scriptId, visible);\n    }\n    render() {\n        return `<div class=\"qr--button menu_button interactable\" id=\"${this.id}\">${this.name}</div>`;\n    }\n    bindEvents() {\n        $(`#${this.id}`).on('click', () => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.eventSource.emit(this.id);\n            console.log(`[ScriptManager] ${this.id}`);\n        });\n    }\n}\nclass ButtonFactory {\n    static createButton(type, name, scriptId, visible = true) {\n        switch (type) {\n            case 'script':\n            default:\n                return new ScriptButton(name, scriptId, visible);\n        }\n    }\n}\nclass ButtonManager {\n    buttons = [];\n    /**\n     * \n     * @param oldContainerId ID\n     * @param newContainerId ID\n     */\n    migrateButtonsToNewContainer(oldContainerId, newContainerId) {\n        const $oldButtons = $(`#${oldContainerId} .qr--button`);\n        const $newContainer = $(`#${newContainerId}`);\n        if ($oldButtons.length && $newContainer.length) {\n            $oldButtons.detach().appendTo($newContainer);\n            this.buttons.forEach(button => {\n                button.bindEvents();\n            });\n        }\n    }\n    /**\n     * ID\n     * @param scriptId ID\n     * @returns ID\n     */\n    getScriptContainerId(scriptId) {\n        return `script_container_${scriptId}`;\n    }\n    /**\n     * \n     * @param globalScripts \n     * @param characterScripts \n     * @param isGlobalEnabled \n     * @param isCharacterEnabled \n     */\n    createButtonsFromScripts(globalScripts, characterScripts, isGlobalEnabled, isCharacterEnabled) {\n        this.clearButtons();\n        const hasGlobalVisibleButtons = isGlobalEnabled &&\n            globalScripts.some(script => script.enabled &&\n                script.buttons &&\n                script.buttons.length > 0 &&\n                script.buttons.some(button => button.visible));\n        const hasCharacterVisibleButtons = isCharacterEnabled &&\n            characterScripts.some(script => script.enabled &&\n                script.buttons &&\n                script.buttons.length > 0 &&\n                script.buttons.some(button => button.visible));\n        if (!hasGlobalVisibleButtons && !hasCharacterVisibleButtons) {\n            return;\n        }\n        if (isGlobalEnabled && hasGlobalVisibleButtons) {\n            this.addScriptButtons(globalScripts);\n        }\n        if (isCharacterEnabled && hasCharacterVisibleButtons) {\n            this.addScriptButtons(characterScripts);\n        }\n    }\n    /**\n     * \n     * @param scripts \n     */\n    addScriptButtons(scripts) {\n        scripts.forEach(script => {\n            if (script.enabled && script.buttons && script.buttons.length > 0) {\n                const visibleButtons = script.buttons\n                    .filter(buttonData => buttonData.visible)\n                    .map(buttonData => ButtonFactory.createButton('script', buttonData.name, script.id, buttonData.visible));\n                if (visibleButtons.length > 0) {\n                    this.addButtonsGroup(visibleButtons, script.id);\n                }\n            }\n        });\n    }\n    /**\n     * \n     * @param buttons \n     * @param scriptId ID\n     */\n    addButtonsGroup(buttons, scriptId) {\n        if (buttons.length === 0)\n            return;\n        const containerId = this.getScriptContainerId(scriptId);\n        $(`#${containerId}`).remove();\n        let containerHtml = `<div id=\"${containerId}\" class=\"qr--buttons th--button\">`;\n        buttons.forEach(button => {\n            this.buttons = this.buttons.filter(btn => btn.id !== button.id);\n            this.buttons.push(button);\n            containerHtml += button.render();\n        });\n        containerHtml += '</div>';\n        if (isCombined) {\n            $('#send_form #qr--bar .qr--buttons').first().append(containerHtml);\n        }\n        else {\n            $('#send_form #qr--bar').first().append(containerHtml);\n        }\n        buttons.forEach(button => button.bindEvents());\n    }\n    /**\n     * \n     * @param script \n     */\n    addButtonsForScript(script) {\n        if (!script.buttons || script.buttons.length === 0)\n            return;\n        const visibleButtons = script.buttons\n            .filter(buttonData => buttonData.visible)\n            .map(buttonData => ButtonFactory.createButton('script', buttonData.name, script.id, buttonData.visible));\n        if (visibleButtons.length > 0) {\n            this.addButtonsGroup(visibleButtons, script.id);\n        }\n    }\n    /**\n     * \n     * @param scriptId ID\n     */\n    removeButtonsByScriptId(scriptId) {\n        const containerId = this.getScriptContainerId(scriptId);\n        $(`#${containerId}`).remove();\n    }\n    /**\n     * \n     */\n    clearButtons() {\n        this.buttons.forEach(btn => btn.remove());\n        this.buttons = [];\n        $('.th-button').remove();\n    }\n}\nconst buttonManager = new ButtonManager();\n/**\n * \n */\nfunction _setButtonLogic() {\n    const scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__.ScriptManager.getInstance();\n    const globalScripts = scriptManager.getGlobalScripts();\n    const characterScripts = scriptManager.getCharacterScripts();\n    const isGlobalEnabled = scriptManager.isGlobalScriptEnabled;\n    const isCharacterEnabled = scriptManager.isCharacterScriptEnabled;\n    buttonManager.createButtonsFromScripts(globalScripts, characterScripts, isGlobalEnabled, isCharacterEnabled);\n}\n/**\n * qr\n */\nfunction bindQrEnabledChangeListener() {\n    $(`#qr--isEnabled`).on('change', () => {\n        isQrEnabled = $('#qr--isEnabled').prop('checked');\n        checkQrEnabledStatusAndAddButton();\n        console.log('[script_manager] ');\n    });\n    $('#qr--isCombined').on('change', () => {\n        isCombined = $('#qr--isCombined').prop('checked');\n        checkQrEnabledStatusAndAddButton();\n        console.log('[script_manager] ');\n    });\n    $('#qr--global-setListAdd, #qr--chat-setListAdd, .qr--del').on('click', () => {\n        checkQrEnabledStatusAndAddButton();\n        console.log('[script_manager] ');\n    });\n}\n/**\n *  qr--isEnabled  change \n */\nfunction unbindQrEnabledChangeListener() {\n    $(`#qr--isEnabled, #qr--isCombined`).off('change');\n    $(`#qr--global-setListAdd, #qr--chat-setListAdd, .qr--del`).off('click');\n}\n/**\n * qr--isEnabled\n */\nfunction checkQrEnabledStatus() {\n    isQrEnabled = $('#qr--isEnabled').prop('checked');\n    const qrBarLength = $('#send_form #qr--bar').length;\n    if (!isQrEnabled) {\n        if (qrBarLength === 0) {\n            $('#send_form').append('<div class=\"flex-container flexGap5\" id=\"qr--bar\"></div>');\n        }\n        else {\n            $('#send_form #qr--bar').not(':first').remove();\n        }\n    }\n}\n/**\n * qr--isCombined\n */\nfunction checkQrCombinedStatus() {\n    isCombined = $('#qr--isCombined').prop('checked');\n    if (!isQrEnabled) {\n        if (isCombined) {\n            const $qrBar = $('#send_form #qr--bar');\n            const isThButtonExist = $qrBar.find('.th--buttons').length > 0;\n            if (!isThButtonExist) {\n                $qrBar.append('<div class=\"qr--buttons th--buttons\"></div>');\n            }\n        }\n    }\n}\n/**\n * qr--isEnabledqr--isCombined\n */\nfunction checkQrEnabledStatusAndAddButton() {\n    checkQrEnabledStatus();\n    checkQrCombinedStatus();\n    _setButtonLogic();\n}\n/**\n * qrchange\n */\nfunction initScriptButton() {\n    checkQrEnabledStatus();\n    checkQrCombinedStatus();\n    bindQrEnabledChangeListener();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2J1dHRvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQWdGO0FBRTlCO0FBRWxELElBQUksV0FBVyxHQUFHLEtBQUssQ0FBQztBQUN4QixJQUFJLFVBQVUsR0FBRyxLQUFLLENBQUM7QUFDaEIsTUFBZSxNQUFNO0lBQzFCLEVBQUUsQ0FBUztJQUNYLElBQUksQ0FBUztJQUNiLE9BQU8sQ0FBVTtJQUNqQixRQUFRLENBQVM7SUFFakIsWUFBWSxJQUFZLEVBQUUsUUFBZ0IsRUFBRSxVQUFtQixJQUFJO1FBQ2pFLElBQUksQ0FBQyxFQUFFLEdBQUcsR0FBRyxRQUFRLElBQUksSUFBSSxFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDekIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7SUFDekIsQ0FBQztJQU1ELE1BQU07UUFDSixDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUM1QixDQUFDO0NBQ0Y7QUFFTSxNQUFNLFlBQWEsU0FBUSxNQUFNO0lBQ3RDLFlBQVksSUFBWSxFQUFFLFFBQWdCLEVBQUUsVUFBbUIsSUFBSTtRQUNqRSxLQUFLLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBRUQsTUFBTTtRQUNKLE9BQU8sd0RBQXdELElBQUksQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLElBQUksUUFBUSxDQUFDO0lBQy9GLENBQUM7SUFFRCxVQUFVO1FBQ1IsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7WUFDaEMsNERBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FB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QztZQUNOLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNsRCxDQUFDO0lBQ0gsQ0FBQztBQUNILENBQUM7QUFFRDs7R0FFRztBQUNILFNBQVMscUJBQXFCO0lBQzVCLFVBQVUsR0FBRyxDQUFDLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDbEQsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2pCLElBQUksVUFBVSxFQUFFLENBQUM7WUFDZixNQUFNLE1BQU0sR0FBRyxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQztZQUN4QyxNQUFNLGVBQWUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7WUFDL0QsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO2dCQUNyQixNQUFNLENBQUMsTUFBTSxDQUFDLDZDQUE2QyxDQUFDLENBQUM7WUFDL0QsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyxnQ0FBZ0M7SUFDOUMsb0JBQW9CLEVBQUUsQ0FBQztJQUN2QixxQkFBcUIsRUFBRSxDQUFDO0lBQ3hCLGVBQWUsRUFBRSxDQUFDO0FBQ3BCLENBQUM7QUFFRDs7R0FFRztBQUNJLFNBQVMsZ0JBQWdCO0lBQzlCLG9CQUFvQixFQUFFLENBQUM7SUFDdkIscUJBQXFCLEVBQUUsQ0FBQztJQUN4QiwyQkFBMkIsRUFBRSxDQUFDO0FBQ2hDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2J1dHRvbi50cz9lMjJiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNjcmlwdE1hbmFnZXIgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9zY3JpcHRfY29udHJvbGxlcic7XG5pbXBvcnQgeyBTY3JpcHQgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS90eXBlcyc7XG5pbXBvcnQgeyBldmVudFNvdXJjZSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG5sZXQgaXNRckVuYWJsZWQgPSBmYWxzZTtcbmxldCBpc0NvbWJpbmVkID0gZmFsc2U7XG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQnV0dG9uIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICB2aXNpYmxlOiBib29sZWFuO1xuICBzY3JpcHRJZDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgc2NyaXB0SWQ6IHN0cmluZywgdmlzaWJsZTogYm9vbGVhbiA9IHRydWUpIHtcbiAgICB0aGlzLmlkID0gYCR7c2NyaXB0SWR9XyR7bmFtZX1gO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5zY3JpcHRJZCA9IHNjcmlwdElkO1xuICAgIHRoaXMudmlzaWJsZSA9IHZpc2libGU7XG4gIH1cblxuICBhYnN0cmFjdCByZW5kZXIoKTogc3RyaW5nO1xuXG4gIGFic3RyYWN0IGJpbmRFdmVudHMoKTogdm9pZDtcblxuICByZW1vdmUoKTogdm9pZCB7XG4gICAgJChgIyR7dGhpcy5pZH1gKS5yZW1vdmUoKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU2NyaXB0QnV0dG9uIGV4dGVuZHMgQnV0dG9uIHtcbiAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCBzY3JpcHRJZDogc3RyaW5nLCB2aXNpYmxlOiBib29sZWFuID0gdHJ1ZSkge1xuICAgIHN1cGVyKG5hbWUsIHNjcmlwdElkLCB2aXNpYmxlKTtcbiAgfVxuXG4gIHJlbmRlcigpOiBzdHJpbmcge1xuICAgIHJldHVybiBgPGRpdiBjbGFzcz1cInFyLS1idXR0b24gbWVudV9idXR0b24gaW50ZXJhY3RhYmxlXCIgaWQ9XCIke3RoaXMuaWR9XCI+JHt0aGlzLm5hbWV9PC9kaXY+YDtcbiAgfVxuXG4gIGJpbmRFdmVudHMoKTogdm9pZCB7XG4gICAgJChgIyR7dGhpcy5pZH1gKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICBldmVudFNvdXJjZS5lbWl0KHRoaXMuaWQpO1xuICAgICAgY29uc29sZS5sb2coYFtTY3JpcHRNYW5hZ2VyXSDngrnlh7vmjInpkq7vvJoke3RoaXMuaWR9YCk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEJ1dHRvbkZhY3Rvcnkge1xuICBzdGF0aWMgY3JlYXRlQnV0dG9uKHR5cGU6IHN0cmluZywgbmFtZTogc3RyaW5nLCBzY3JpcHRJZDogc3RyaW5nLCB2aXNpYmxlOiBib29sZWFuID0gdHJ1ZSk6IEJ1dHRvbiB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdzY3JpcHQnOlxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRCdXR0b24obmFtZSwgc2NyaXB0SWQsIHZpc2libGUpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQnV0dG9uTWFuYWdlciB7XG4gIHByaXZhdGUgYnV0dG9uczogQnV0dG9uW10gPSBbXTtcblxuICAvKipcbiAgICog5bCG5oyJ6ZKu5LuO5pen5a655Zmo6L+B56e75Yiw5paw5a655ZmoXG4gICAqIEBwYXJhbSBvbGRDb250YWluZXJJZCDml6flrrnlmahJRFxuICAgKiBAcGFyYW0gbmV3Q29udGFpbmVySWQg5paw5a655ZmoSURcbiAgICovXG4gIG1pZ3JhdGVCdXR0b25zVG9OZXdDb250YWluZXIob2xkQ29udGFpbmVySWQ6IHN0cmluZywgbmV3Q29udGFpbmVySWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0ICRvbGRCdXR0b25zID0gJChgIyR7b2xkQ29udGFpbmVySWR9IC5xci0tYnV0dG9uYCk7XG4gICAgY29uc3QgJG5ld0NvbnRhaW5lciA9ICQoYCMke25ld0NvbnRhaW5lcklkfWApO1xuXG4gICAgaWYgKCRvbGRCdXR0b25zLmxlbmd0aCAmJiAkbmV3Q29udGFpbmVyLmxlbmd0aCkge1xuICAgICAgJG9sZEJ1dHRvbnMuZGV0YWNoKCkuYXBwZW5kVG8oJG5ld0NvbnRhaW5lcik7XG5cbiAgICAgIHRoaXMuYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgICAgIGJ1dHRvbi5iaW5kRXZlbnRzKCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W6ISa5pys5a655ZmoSURcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqIEByZXR1cm5zIOiEmuacrOWuueWZqElEXG4gICAqL1xuICBwcml2YXRlIGdldFNjcmlwdENvbnRhaW5lcklkKHNjcmlwdElkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBgc2NyaXB0X2NvbnRhaW5lcl8ke3NjcmlwdElkfWA7XG4gIH1cblxuICAvKipcbiAgICog5LuO6ISa5pys5pWw5o2u5Yib5bu65oyJ6ZKuXG4gICAqIEBwYXJhbSBnbG9iYWxTY3JpcHRzIOWFqOWxgOiEmuacrFxuICAgKiBAcGFyYW0gY2hhcmFjdGVyU2NyaXB0cyDop5LoibLohJrmnKxcbiAgICogQHBhcmFtIGlzR2xvYmFsRW5hYmxlZCDlhajlsYDohJrmnKzmmK/lkKblkK/nlKhcbiAgICogQHBhcmFtIGlzQ2hhcmFjdGVyRW5hYmxlZCDop5LoibLohJrmnKzmmK/lkKblkK/nlKhcbiAgICovXG4gIGNyZWF0ZUJ1dHRvbnNGcm9tU2NyaXB0cyhcbiAgICBnbG9iYWxTY3JpcHRzOiBTY3JpcHRbXSxcbiAgICBjaGFyYWN0ZXJTY3JpcHRzOiBTY3JpcHRbXSxcbiAgICBpc0dsb2JhbEVuYWJsZWQ6IGJvb2xlYW4sXG4gICAgaXNDaGFyYWN0ZXJFbmFibGVkOiBib29sZWFuLFxuICApOiB2b2lkIHtcbiAgICB0aGlzLmNsZWFyQnV0dG9ucygpO1xuXG4gICAgY29uc3QgaGFzR2xvYmFsVmlzaWJsZUJ1dHRvbnMgPVxuICAgICAgaXNHbG9iYWxFbmFibGVkICYmXG4gICAgICBnbG9iYWxTY3JpcHRzLnNvbWUoXG4gICAgICAgIHNjcmlwdCA9PlxuICAgICAgICAgIHNjcmlwdC5lbmFibGVkICYmXG4gICAgICAgICAgc2NyaXB0LmJ1dHRvbnMgJiZcbiAgICAgICAgICBzY3JpcHQuYnV0dG9ucy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgc2NyaXB0LmJ1dHRvbnMuc29tZShidXR0b24gPT4gYnV0dG9uLnZpc2libGUpLFxuICAgICAgKTtcblxuICAgIGNvbnN0IGhhc0NoYXJhY3RlclZpc2libGVCdXR0b25zID1cbiAgICAgIGlzQ2hhcmFjdGVyRW5hYmxlZCAmJlxuICAgICAgY2hhcmFjdGVyU2NyaXB0cy5zb21lKFxuICAgICAgICBzY3JpcHQgPT5cbiAgICAgICAgICBzY3JpcHQuZW5hYmxlZCAmJlxuICAgICAgICAgIHNjcmlwdC5idXR0b25zICYmXG4gICAgICAgICAgc2NyaXB0LmJ1dHRvbnMubGVuZ3RoID4gMCAmJlxuICAgICAgICAgIHNjcmlwdC5idXR0b25zLnNvbWUoYnV0dG9uID0+IGJ1dHRvbi52aXNpYmxlKSxcbiAgICAgICk7XG5cbiAgICBpZiAoIWhhc0dsb2JhbFZpc2libGVCdXR0b25zICYmICFoYXNDaGFyYWN0ZXJWaXNpYmxlQnV0dG9ucykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChpc0dsb2JhbEVuYWJsZWQgJiYgaGFzR2xvYmFsVmlzaWJsZUJ1dHRvbnMpIHtcbiAgICAgIHRoaXMuYWRkU2NyaXB0QnV0dG9ucyhnbG9iYWxTY3JpcHRzKTtcbiAgICB9XG5cbiAgICBpZiAoaXNDaGFyYWN0ZXJFbmFibGVkICYmIGhhc0NoYXJhY3RlclZpc2libGVCdXR0b25zKSB7XG4gICAgICB0aGlzLmFkZFNjcmlwdEJ1dHRvbnMoY2hhcmFjdGVyU2NyaXB0cyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOiEmuacrOaMiemSrlxuICAgKiBAcGFyYW0gc2NyaXB0cyDohJrmnKzliJfooahcbiAgICovXG4gIHByaXZhdGUgYWRkU2NyaXB0QnV0dG9ucyhzY3JpcHRzOiBTY3JpcHRbXSk6IHZvaWQge1xuICAgIHNjcmlwdHMuZm9yRWFjaChzY3JpcHQgPT4ge1xuICAgICAgaWYgKHNjcmlwdC5lbmFibGVkICYmIHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgdmlzaWJsZUJ1dHRvbnMgPSBzY3JpcHQuYnV0dG9uc1xuICAgICAgICAgIC5maWx0ZXIoYnV0dG9uRGF0YSA9PiBidXR0b25EYXRhLnZpc2libGUpXG4gICAgICAgICAgLm1hcChidXR0b25EYXRhID0+IEJ1dHRvbkZhY3RvcnkuY3JlYXRlQnV0dG9uKCdzY3JpcHQnLCBidXR0b25EYXRhLm5hbWUsIHNjcmlwdC5pZCwgYnV0dG9uRGF0YS52aXNpYmxlKSk7XG5cbiAgICAgICAgaWYgKHZpc2libGVCdXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0aGlzLmFkZEJ1dHRvbnNHcm91cCh2aXNpYmxlQnV0dG9ucywgc2NyaXB0LmlkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOaMiemSrue7hFxuICAgKiBAcGFyYW0gYnV0dG9ucyDmjInpkq7liJfooahcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqL1xuICBwcml2YXRlIGFkZEJ1dHRvbnNHcm91cChidXR0b25zOiBCdXR0b25bXSwgc2NyaXB0SWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmIChidXR0b25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3QgY29udGFpbmVySWQgPSB0aGlzLmdldFNjcmlwdENvbnRhaW5lcklkKHNjcmlwdElkKTtcblxuICAgICQoYCMke2NvbnRhaW5lcklkfWApLnJlbW92ZSgpO1xuXG4gICAgbGV0IGNvbnRhaW5lckh0bWwgPSBgPGRpdiBpZD1cIiR7Y29udGFpbmVySWR9XCIgY2xhc3M9XCJxci0tYnV0dG9ucyB0aC0tYnV0dG9uXCI+YDtcblxuICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgdGhpcy5idXR0b25zID0gdGhpcy5idXR0b25zLmZpbHRlcihidG4gPT4gYnRuLmlkICE9PSBidXR0b24uaWQpO1xuICAgICAgdGhpcy5idXR0b25zLnB1c2goYnV0dG9uKTtcbiAgICAgIGNvbnRhaW5lckh0bWwgKz0gYnV0dG9uLnJlbmRlcigpO1xuICAgIH0pO1xuXG4gICAgY29udGFpbmVySHRtbCArPSAnPC9kaXY+JztcblxuICAgIGlmIChpc0NvbWJpbmVkKSB7XG4gICAgICAkKCcjc2VuZF9mb3JtICNxci0tYmFyIC5xci0tYnV0dG9ucycpLmZpcnN0KCkuYXBwZW5kKGNvbnRhaW5lckh0bWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKCcjc2VuZF9mb3JtICNxci0tYmFyJykuZmlyc3QoKS5hcHBlbmQoY29udGFpbmVySHRtbCk7XG4gICAgfVxuXG4gICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24uYmluZEV2ZW50cygpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkuLrmjIflrprohJrmnKzmt7vliqDmiYDmnInmjInpkq5cbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICovXG4gIGFkZEJ1dHRvbnNGb3JTY3JpcHQoc2NyaXB0OiBTY3JpcHQpOiB2b2lkIHtcbiAgICBpZiAoIXNjcmlwdC5idXR0b25zIHx8IHNjcmlwdC5idXR0b25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3QgdmlzaWJsZUJ1dHRvbnMgPSBzY3JpcHQuYnV0dG9uc1xuICAgICAgLmZpbHRlcihidXR0b25EYXRhID0+IGJ1dHRvbkRhdGEudmlzaWJsZSlcbiAgICAgIC5tYXAoYnV0dG9uRGF0YSA9PiBCdXR0b25GYWN0b3J5LmNyZWF0ZUJ1dHRvbignc2NyaXB0JywgYnV0dG9uRGF0YS5uYW1lLCBzY3JpcHQuaWQsIGJ1dHRvbkRhdGEudmlzaWJsZSkpO1xuXG4gICAgaWYgKHZpc2libGVCdXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMuYWRkQnV0dG9uc0dyb3VwKHZpc2libGVCdXR0b25zLCBzY3JpcHQuaWQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDnp7vpmaTmjIflrprohJrmnKznmoTmjInpkq5cbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqL1xuICByZW1vdmVCdXR0b25zQnlTY3JpcHRJZChzY3JpcHRJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgY29udGFpbmVySWQgPSB0aGlzLmdldFNjcmlwdENvbnRhaW5lcklkKHNjcmlwdElkKTtcbiAgICAkKGAjJHtjb250YWluZXJJZH1gKS5yZW1vdmUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXpmaTmiYDmnInmjInpkq5cbiAgICovXG4gIGNsZWFyQnV0dG9ucygpOiB2b2lkIHtcbiAgICB0aGlzLmJ1dHRvbnMuZm9yRWFjaChidG4gPT4gYnRuLnJlbW92ZSgpKTtcbiAgICB0aGlzLmJ1dHRvbnMgPSBbXTtcblxuICAgICQoJy50aC1idXR0b24nKS5yZW1vdmUoKTtcbiAgfVxufVxuXG5jb25zdCBidXR0b25NYW5hZ2VyID0gbmV3IEJ1dHRvbk1hbmFnZXIoKTtcblxuLyoqXG4gKiDorr7nva7mjInpkq7ml7bpnIDopoHmiafooYznmoTooYzkuLpcbiAqL1xuZnVuY3Rpb24gX3NldEJ1dHRvbkxvZ2ljKCkge1xuICBjb25zdCBzY3JpcHRNYW5hZ2VyID0gU2NyaXB0TWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuXG4gIGNvbnN0IGdsb2JhbFNjcmlwdHMgPSBzY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFNjcmlwdHMoKTtcbiAgY29uc3QgY2hhcmFjdGVyU2NyaXB0cyA9IHNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuICBjb25zdCBpc0dsb2JhbEVuYWJsZWQgPSBzY3JpcHRNYW5hZ2VyLmlzR2xvYmFsU2NyaXB0RW5hYmxlZDtcbiAgY29uc3QgaXNDaGFyYWN0ZXJFbmFibGVkID0gc2NyaXB0TWFuYWdlci5pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQ7XG5cbiAgYnV0dG9uTWFuYWdlci5jcmVhdGVCdXR0b25zRnJvbVNjcmlwdHMoZ2xvYmFsU2NyaXB0cywgY2hhcmFjdGVyU2NyaXB0cywgaXNHbG9iYWxFbmFibGVkLCBpc0NoYXJhY3RlckVuYWJsZWQpO1xufVxuXG4vKipcbiAqIHFy5ZCv55So5oiW6ICF56aB55So5pe26YeN5paw5re75Yqg5oyJ6ZKuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBiaW5kUXJFbmFibGVkQ2hhbmdlTGlzdGVuZXIoKSB7XG4gICQoYCNxci0taXNFbmFibGVkYCkub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICBpc1FyRW5hYmxlZCA9ICQoJyNxci0taXNFbmFibGVkJykucHJvcCgnY2hlY2tlZCcpO1xuICAgIGNoZWNrUXJFbmFibGVkU3RhdHVzQW5kQWRkQnV0dG9uKCk7XG4gICAgY29uc29sZS5sb2coJ1tzY3JpcHRfbWFuYWdlcl0g5Yib5bu65oyJ6ZKuJyk7XG4gIH0pO1xuXG4gICQoJyNxci0taXNDb21iaW5lZCcpLm9uKCdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgaXNDb21iaW5lZCA9ICQoJyNxci0taXNDb21iaW5lZCcpLnByb3AoJ2NoZWNrZWQnKTtcbiAgICBjaGVja1FyRW5hYmxlZFN0YXR1c0FuZEFkZEJ1dHRvbigpO1xuICAgIGNvbnNvbGUubG9nKCdbc2NyaXB0X21hbmFnZXJdIOWIm+W7uuaMiemSricpO1xuICB9KTtcblxuICAkKCcjcXItLWdsb2JhbC1zZXRMaXN0QWRkLCAjcXItLWNoYXQtc2V0TGlzdEFkZCwgLnFyLS1kZWwnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgY2hlY2tRckVuYWJsZWRTdGF0dXNBbmRBZGRCdXR0b24oKTtcbiAgICBjb25zb2xlLmxvZygnW3NjcmlwdF9tYW5hZ2VyXSDliJvlu7rmjInpkq4nKTtcbiAgfSk7XG59XG5cbi8qKlxuICog6Kej57uRIHFyLS1pc0VuYWJsZWQg5YWD57Sg55qEIGNoYW5nZSDkuovku7bnm5HlkKzlmahcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVuYmluZFFyRW5hYmxlZENoYW5nZUxpc3RlbmVyKCkge1xuICAkKGAjcXItLWlzRW5hYmxlZCwgI3FyLS1pc0NvbWJpbmVkYCkub2ZmKCdjaGFuZ2UnKTtcbiAgJChgI3FyLS1nbG9iYWwtc2V0TGlzdEFkZCwgI3FyLS1jaGF0LXNldExpc3RBZGQsIC5xci0tZGVsYCkub2ZmKCdjbGljaycpO1xufVxuXG4vKipcbiAqIOagueaNrnFyLS1pc0VuYWJsZWTnirbmgIHlpITnkIblrrnlmahcbiAqL1xuZnVuY3Rpb24gY2hlY2tRckVuYWJsZWRTdGF0dXMoKSB7XG4gIGlzUXJFbmFibGVkID0gJCgnI3FyLS1pc0VuYWJsZWQnKS5wcm9wKCdjaGVja2VkJyk7XG4gIGNvbnN0IHFyQmFyTGVuZ3RoID0gJCgnI3NlbmRfZm9ybSAjcXItLWJhcicpLmxlbmd0aDtcbiAgaWYgKCFpc1FyRW5hYmxlZCkge1xuICAgIGlmIChxckJhckxlbmd0aCA9PT0gMCkge1xuICAgICAgJCgnI3NlbmRfZm9ybScpLmFwcGVuZCgnPGRpdiBjbGFzcz1cImZsZXgtY29udGFpbmVyIGZsZXhHYXA1XCIgaWQ9XCJxci0tYmFyXCI+PC9kaXY+Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJyNzZW5kX2Zvcm0gI3FyLS1iYXInKS5ub3QoJzpmaXJzdCcpLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOajgOafpXFyLS1pc0NvbWJpbmVk54q25oCBXG4gKi9cbmZ1bmN0aW9uIGNoZWNrUXJDb21iaW5lZFN0YXR1cygpIHtcbiAgaXNDb21iaW5lZCA9ICQoJyNxci0taXNDb21iaW5lZCcpLnByb3AoJ2NoZWNrZWQnKTtcbiAgaWYgKCFpc1FyRW5hYmxlZCkge1xuICAgIGlmIChpc0NvbWJpbmVkKSB7XG4gICAgICBjb25zdCAkcXJCYXIgPSAkKCcjc2VuZF9mb3JtICNxci0tYmFyJyk7XG4gICAgICBjb25zdCBpc1RoQnV0dG9uRXhpc3QgPSAkcXJCYXIuZmluZCgnLnRoLS1idXR0b25zJykubGVuZ3RoID4gMDtcbiAgICAgIGlmICghaXNUaEJ1dHRvbkV4aXN0KSB7XG4gICAgICAgICRxckJhci5hcHBlbmQoJzxkaXYgY2xhc3M9XCJxci0tYnV0dG9ucyB0aC0tYnV0dG9uc1wiPjwvZGl2PicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOajgOafpXFyLS1pc0VuYWJsZWTlkoxxci0taXNDb21iaW5lZOeKtuaAgeW5tua3u+WKoOaMiemSrlxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tRckVuYWJsZWRTdGF0dXNBbmRBZGRCdXR0b24oKSB7XG4gIGNoZWNrUXJFbmFibGVkU3RhdHVzKCk7XG4gIGNoZWNrUXJDb21iaW5lZFN0YXR1cygpO1xuICBfc2V0QnV0dG9uTG9naWMoKTtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJbohJrmnKzmjInpkq7vvIzljIXmi6znoa7orqRxcuWuueWZqOWSjOe7keWummNoYW5nZeS6i+S7tlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdFNjcmlwdEJ1dHRvbigpIHtcbiAgY2hlY2tRckVuYWJsZWRTdGF0dXMoKTtcbiAgY2hlY2tRckNvbWJpbmVkU3RhdHVzKCk7XG4gIGJpbmRRckVuYWJsZWRDaGFuZ2VMaXN0ZW5lcigpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/script_repository/button.ts\n")},"./src/component/script_repository/data.ts":
/*!*************************************************!*\
  !*** ./src/component/script_repository/data.ts ***!
  \*************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ScriptData: () => (/* binding */ ScriptData),\n/* harmony export */   purgeEmbeddedScripts: () => (/* binding */ purgeEmbeddedScripts)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n\n\n\n\n\n/**\n * \n */\nclass ScriptData {\n    static instance;\n    globalScripts = [];\n    characterScripts = [];\n    _isGlobalScriptEnabled = false;\n    _isCharacterScriptEnabled = false;\n    constructor() {\n        this.loadScripts();\n    }\n    get isGlobalScriptEnabled() {\n        return this._isGlobalScriptEnabled;\n    }\n    get isCharacterScriptEnabled() {\n        return this._isCharacterScriptEnabled;\n    }\n    static getInstance() {\n        if (!ScriptData.instance) {\n            ScriptData.instance = new ScriptData();\n        }\n        return ScriptData.instance;\n    }\n    static destroyInstance() {\n        if (ScriptData.instance) {\n            ScriptData.instance = undefined;\n        }\n    }\n    /**\n     * \n     * @returns \n     */\n    checkCharacterScriptEnabled() {\n        const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.characters_with_scripts') || [];\n        //@ts-ignore\n        const avatar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters?.[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.avatar;\n        return charactersWithScripts?.includes(avatar) || false;\n    }\n    /**\n     * \n     */\n    loadScripts() {\n        const rawGlobalRepository = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.scriptsRepository') || [];\n        this.globalScripts = this.migrateAndExtractScripts(rawGlobalRepository, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL);\n        //@ts-ignore\n        const rawCharacterRepository = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        this.characterScripts = this.migrateAndExtractScripts(rawCharacterRepository, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.CHARACTER);\n        this._isGlobalScriptEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.global_script_enabled') ?? false;\n        this._isCharacterScriptEnabled = this.checkCharacterScriptEnabled();\n    }\n    /**\n     * \n     * @param repository \n     * @param type \n     * @returns \n     */\n    migrateAndExtractScripts(repository, type) {\n        if (!Array.isArray(repository)) {\n            return [];\n        }\n        let needsMigration = false;\n        const migratedRepository = [];\n        for (const item of repository) {\n            if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScript)(item)) {\n                needsMigration = true;\n                migratedRepository.push({\n                    type: 'script',\n                    value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item),\n                });\n            }\n            else if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScriptRepositoryItem)(item)) {\n                if (item.type === 'script') {\n                    migratedRepository.push({\n                        type: 'script',\n                        value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item.value),\n                    });\n                }\n                else if (item.type === 'folder') {\n                    migratedRepository.push({\n                        type: 'folder',\n                        id: item.id,\n                        name: item.name,\n                        icon: item.icon || 'fa-folder',\n                        color: item.color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor'),\n                        value: Array.isArray(item.value) ? item.value.map((s) => new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(s)) : [],\n                    });\n                }\n            }\n            else {\n                console.warn('[ScriptManager] :', item);\n            }\n        }\n        if (needsMigration) {\n            this.saveMigratedRepository(migratedRepository, type);\n        }\n        return (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.extractScriptsFromRepository)(migratedRepository);\n    }\n    /**\n     * \n     * @param repository \n     * @param type \n     */\n    async saveMigratedRepository(repository, type) {\n        try {\n            if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.scriptsRepository', repository);\n            }\n            else {\n                if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n                    console.warn('[ScriptManager] ');\n                    return;\n                }\n                //@ts-ignore\n                await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_scripts', repository);\n            }\n            console.log(`[ScriptManager] ${type}`);\n        }\n        catch (error) {\n            console.error(`[ScriptManager] ${type}:`, error);\n        }\n    }\n    /**\n     * \n     */\n    getGlobalScripts() {\n        return this.globalScripts;\n    }\n    /**\n     * \n     */\n    getCharacterScripts() {\n        //@ts-ignore\n        const rawCharacterRepository = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        this.characterScripts = this.migrateAndExtractScripts(rawCharacterRepository, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.CHARACTER);\n        return this.characterScripts;\n    }\n    /**\n     * ID\n     * @param id ID\n     * @returns undefined\n     */\n    getScriptById(id) {\n        let script = this.globalScripts.find((s) => s.id === id);\n        if (script)\n            return script;\n        script = this.characterScripts.find((s) => s.id === id);\n        if (script)\n            return script;\n        return undefined;\n    }\n    /**\n     * \n     * @param script \n     * @param type \n     */\n    async saveScript(script, type) {\n        if (!script.name || script.name.trim() === '') {\n            throw new Error('[ScriptManager] ');\n        }\n        const rawRepository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL\n            ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.scriptsRepository') || []\n            : //@ts-ignore\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        const repository = this.ensureRepositoryStructure(rawRepository);\n        let foundIndex = -1;\n        let foundInFolder = false;\n        let folderIndex = -1;\n        for (let i = 0; i < repository.length; i++) {\n            const item = repository[i];\n            if (item.type === 'script' && item.value.id === script.id) {\n                foundIndex = i;\n                break;\n            }\n            else if (item.type === 'folder') {\n                const scripts = item.value;\n                const scriptIndex = scripts.findIndex(s => s.id === script.id);\n                if (scriptIndex !== -1) {\n                    foundInFolder = true;\n                    folderIndex = i;\n                    foundIndex = scriptIndex;\n                    break;\n                }\n            }\n        }\n        if (foundInFolder && folderIndex >= 0) {\n            const folder = repository[folderIndex];\n            folder.value[foundIndex] = script;\n        }\n        else if (foundIndex >= 0) {\n            repository[foundIndex].value = script;\n        }\n        else {\n            repository.push({\n                type: 'script',\n                value: script,\n            });\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n        this.loadScripts();\n    }\n    /**\n     * \n     * @param rawRepository \n     * @returns \n     */\n    ensureRepositoryStructure(rawRepository) {\n        const repository = [];\n        for (const item of rawRepository) {\n            if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScript)(item)) {\n                repository.push({\n                    type: 'script',\n                    value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item),\n                });\n            }\n            else if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScriptRepositoryItem)(item)) {\n                if (item.type === 'script') {\n                    repository.push({\n                        type: 'script',\n                        value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item.value),\n                    });\n                }\n                else if (item.type === 'folder') {\n                    if (!item.icon) {\n                        item.icon = 'fa-folder';\n                    }\n                    if (!item.color) {\n                        item.color = document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n                    }\n                    repository.push({\n                        ...item,\n                        value: Array.isArray(item.value) ? item.value.map((s) => new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(s)) : [],\n                    });\n                }\n            }\n            else {\n                try {\n                    repository.push({\n                        type: 'script',\n                        value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item),\n                    });\n                }\n                catch (error) {\n                    console.warn('[ScriptManager] :', item, error);\n                }\n            }\n        }\n        return repository;\n    }\n    /**\n     * \n     * @param array \n     */\n    async saveGlobalScripts(array) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.scriptsRepository', array);\n        this.globalScripts = array;\n    }\n    /**\n     * \n     * @param array \n     */\n    async saveCharacterScripts(array) {\n        if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n            throw new Error('[ScriptManager] ');\n        }\n        //@ts-ignore\n        await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_scripts', array);\n        this.characterScripts = array;\n    }\n    /**\n     * \n     * @param repository \n     */\n    async saveGlobalRepositoryItems(repository) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.scriptsRepository', repository);\n        this.globalScripts = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.extractScriptsFromRepository)(repository);\n    }\n    /**\n     * \n     * @param repository \n     */\n    async saveCharacterRepositoryItems(repository) {\n        if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n            throw new Error('[ScriptManager] ');\n        }\n        //@ts-ignore\n        await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_scripts', repository);\n        this.characterScripts = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.extractScriptsFromRepository)(repository);\n    }\n    /**\n     * \n     * @param id ID\n     * @param type \n     */\n    async deleteScript(id, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        let scriptFound = false;\n        for (let i = 0; i < repository.length; i++) {\n            const item = repository[i];\n            if (item.type === 'script' && item.value.id === id) {\n                repository.splice(i, 1);\n                scriptFound = true;\n                break;\n            }\n            else if (item.type === 'folder') {\n                const scripts = item.value;\n                const foundIndex = scripts.findIndex(s => s.id === id);\n                if (foundIndex !== -1) {\n                    scripts.splice(foundIndex, 1);\n                    scriptFound = true;\n                    break;\n                }\n            }\n        }\n        if (!scriptFound) {\n            throw new Error('[ScriptManager] ');\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * \n     * @param type \n     * @param enable \n     */\n    async updateScriptTypeEnableState(type, enable) {\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.global_script_enabled', enable);\n            this._isGlobalScriptEnabled = enable;\n        }\n        else {\n            const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.characters_with_scripts') || [];\n            //@ts-ignore\n            const avatar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters?.[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.avatar;\n            if (enable) {\n                if (avatar && !charactersWithScripts.includes(avatar)) {\n                    charactersWithScripts.push(avatar);\n                }\n            }\n            else {\n                const index = charactersWithScripts.indexOf(avatar);\n                if (index !== -1) {\n                    charactersWithScripts.splice(index, 1);\n                }\n            }\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.characters_with_scripts', charactersWithScripts);\n            this._isCharacterScriptEnabled = enable;\n        }\n    }\n    /**\n     * \n     * @param script \n     * @returns \n     */\n    getScriptType(script) {\n        return this.globalScripts.some(s => s.id === script.id) ? _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL : _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.CHARACTER;\n    }\n    /**\n     * \n     */\n    refreshCharacterScriptEnabledState() {\n        this._isCharacterScriptEnabled = this.checkCharacterScriptEnabled();\n    }\n    /**\n     * \n     */\n    getGlobalRepositoryItems() {\n        const rawRepository = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.scriptsRepository') || [];\n        return this.ensureRepositoryStructure(rawRepository);\n    }\n    /**\n     * \n     */\n    getCharacterRepositoryItems() {\n        //@ts-ignore\n        const rawRepository = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        return this.ensureRepositoryStructure(rawRepository);\n    }\n    /**\n     * \n     * @param name \n     * @param type \n     * @param icon \n     * @param color \n     * @returns ID\n     */\n    async createFolder(name, type, icon, color) {\n        if (!name || name.trim() === '') {\n            throw new Error('[ScriptManager] ');\n        }\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const existingFolder = repository.find(item => item.type === 'folder' && item.name === name.trim());\n        if (existingFolder) {\n            throw new Error('[ScriptManager] ');\n        }\n        const folderId = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__.uuidv4)();\n        const newFolder = {\n            type: 'folder',\n            id: folderId,\n            name: name.trim(),\n            icon: icon || 'fa-folder',\n            color: color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor'),\n            value: [],\n        };\n        repository.unshift(newFolder);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n        return folderId;\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param newName \n     * @param type \n     * @param newIcon \n     * @param newColor \n     */\n    async editFolder(folderId, newName, type, newIcon, newColor) {\n        if (!newName || newName.trim() === '') {\n            throw new Error('[ScriptManager] ');\n        }\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folderIndex = repository.findIndex(item => item.type === 'folder' && item.id === folderId);\n        if (folderIndex === -1) {\n            throw new Error('[ScriptManager] ');\n        }\n        const existingFolder = repository.find(item => item.type === 'folder' && item.name === newName.trim() && item.id !== folderId);\n        if (existingFolder) {\n            throw new Error('[ScriptManager] ');\n        }\n        repository[folderIndex].name = newName.trim();\n        if (newIcon !== undefined) {\n            repository[folderIndex].icon = newIcon;\n        }\n        if (newColor !== undefined) {\n            repository[folderIndex].color = newColor;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     */\n    async deleteFolder(folderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folderIndex = repository.findIndex(item => item.type === 'folder' && item.id === folderId);\n        if (folderIndex === -1) {\n            throw new Error('[ScriptManager] ');\n        }\n        repository.splice(folderIndex, 1);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * \n     * @param item \n     * @param sourceType \n     */\n    async moveItemToOtherType(item, sourceType) {\n        const targetType = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.getOppositeScriptType)(sourceType);\n        const sourceRepository = sourceType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        let itemFound = false;\n        let foundItem = null;\n        if (item.type === 'script') {\n            for (let i = 0; i < sourceRepository.length; i++) {\n                const repoItem = sourceRepository[i];\n                if (repoItem.type === 'script' && repoItem.value.id === item.id) {\n                    foundItem = repoItem;\n                    sourceRepository.splice(i, 1);\n                    itemFound = true;\n                    break;\n                }\n                else if (repoItem.type === 'folder') {\n                    const scripts = repoItem.value;\n                    const foundIndex = scripts.findIndex(s => s.id === item.id);\n                    if (foundIndex !== -1) {\n                        foundItem = { type: 'script', value: scripts[foundIndex] };\n                        scripts.splice(foundIndex, 1);\n                        itemFound = true;\n                        break;\n                    }\n                }\n            }\n            if (!itemFound) {\n                throw new Error('[ScriptManager] ');\n            }\n        }\n        else if (item.type === 'folder') {\n            const folderIndex = sourceRepository.findIndex(repoItem => repoItem.type === 'folder' && repoItem.id === item.id);\n            if (folderIndex === -1) {\n                throw new Error('[ScriptManager] ');\n            }\n            foundItem = sourceRepository[folderIndex];\n            sourceRepository.splice(folderIndex, 1);\n            itemFound = true;\n        }\n        if (!itemFound || !foundItem) {\n            throw new Error('[ScriptManager] ');\n        }\n        const targetRepository = targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        if (foundItem.type === 'folder') {\n            const existingFolder = targetRepository.find(repoItem => repoItem.type === 'folder' && repoItem.name === foundItem.name);\n            if (existingFolder) {\n                toastr.error('');\n                throw new Error('[ScriptManager] ');\n            }\n            targetRepository.unshift(foundItem);\n        }\n        else {\n            targetRepository.push(foundItem);\n        }\n        if (sourceType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(sourceRepository);\n            await this.saveCharacterRepositoryItems(targetRepository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(sourceRepository);\n            await this.saveGlobalRepositoryItems(targetRepository);\n        }\n    }\n    /**\n     * \n     * @param scriptId ID\n     * @param targetFolderId IDnull\n     * @param type \n     */\n    async moveScriptToFolder(scriptId, targetFolderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        let script = null;\n        for (let i = 0; i < repository.length; i++) {\n            const item = repository[i];\n            if (item.type === 'script' && item.value.id === scriptId) {\n                script = item.value;\n                repository.splice(i, 1);\n                break;\n            }\n            else if (item.type === 'folder') {\n                const scripts = item.value;\n                const foundIndex = scripts.findIndex(s => s.id === scriptId);\n                if (foundIndex !== -1) {\n                    script = scripts[foundIndex];\n                    scripts.splice(foundIndex, 1);\n                    break;\n                }\n            }\n        }\n        if (!script) {\n            throw new Error('[ScriptManager] ');\n        }\n        if (targetFolderId === null) {\n            repository.push({\n                type: 'script',\n                value: script,\n            });\n        }\n        else {\n            const targetFolder = repository.find(item => item.type === 'folder' && item.id === targetFolderId);\n            if (!targetFolder) {\n                throw new Error('[ScriptManager] ');\n            }\n            const folderScripts = targetFolder.value;\n            const existingScript = folderScripts.find(s => s.name === script.name);\n            if (existingScript) {\n                throw new Error('[ScriptManager] ');\n            }\n            folderScripts.push(script);\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     */\n    getFolderScripts(folderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        if (!folder) {\n            return [];\n        }\n        return folder.value;\n    }\n    /**\n     * \n     * @param type \n     */\n    getRootScripts(type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        return repository.filter(item => item.type === 'script').map(item => item.value);\n    }\n    /**\n     * \n     * @param type \n     */\n    getFolders(type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        return repository.filter(item => item.type === 'folder');\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     * @param enable \n     */\n    async toggleFolderScripts(folderId, type, enable) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        if (!folder) {\n            throw new Error('[ScriptManager] ');\n        }\n        const scripts = folder.value;\n        let hasChanges = false;\n        for (const script of scripts) {\n            if (script.enabled !== enable) {\n                script.enabled = enable;\n                hasChanges = true;\n            }\n        }\n        if (hasChanges) {\n            if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n                await this.saveGlobalRepositoryItems(repository);\n            }\n            else {\n                await this.saveCharacterRepositoryItems(repository);\n            }\n        }\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     * @returns 'all' - , 'none' - \n     */\n    getFolderScriptsState(folderId, type) {\n        const scripts = this.getFolderScripts(folderId, type);\n        if (scripts.length === 0) {\n            return 'none';\n        }\n        const enabledCount = scripts.filter(script => script.enabled).length;\n        if (enabledCount === 0) {\n            return 'none';\n        }\n        else {\n            return 'all';\n        }\n    }\n}\n/**\n * \n * @param param0\n */\nasync function purgeEmbeddedScripts({ character }) {\n    const avatar = character?.character?.avatar;\n    const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.characters_with_scripts') || [];\n    if (avatar) {\n        localStorage.removeItem(`AlertScript_${avatar}`);\n        if (charactersWithScripts?.includes(avatar)) {\n            const index = charactersWithScripts.indexOf(avatar);\n            if (index !== -1) {\n                charactersWithScripts.splice(index, 1);\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.characters_with_scripts', charactersWithScripts);\n            }\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2RhdGEudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQVE2QztBQUNrQztBQUNuQjtBQUNVO0FBQ2xCO0FBRXBEOztHQUVHO0FBQ0ksTUFBTSxVQUFVO0lBQ2IsTUFBTSxDQUFDLFFBQVEsQ0FBYTtJQUM1QixhQUFhLEdBQWEsRUFBRSxDQUFDO0lBQzdCLGdCQUFnQixHQUFhLEVBQUUsQ0FBQztJQUNoQyxzQkFBc0IsR0FBWSxLQUFLLENBQUM7SUFDeEMseUJBQXlCLEdBQVksS0FBSyxDQUFDO0lBRW5EO1FBQ0UsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3JCLENBQUM7SUFFRCxJQUFXLHFCQUFxQjtRQUM5QixPQUFPLElBQUksQ0FBQyxzQkFBc0IsQ0FBQztJQUNyQyxDQUFDO0lBRUQsSUFBVyx3QkFBd0I7UUFDakMsT0FBTyxJQUFJLENBQUMseUJBQXlCLENBQUM7SUFDeEMsQ0FBQztJQUVNLE1BQU0sQ0FBQyxXQUFXO1FBQ3ZCLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDekIsVUFBVSxDQUFDLFFBQVEsR0FBRyxJQUFJLFVBQVUsRUFBRSxDQUFDO1FBQ3pDLENBQUM7UUFDRCxPQUFPLFVBQVUsQ0FBQyxRQUFRLENBQUM7SUFDN0IsQ0FBQztJQUVNLE1BQU0sQ0FBQyxlQUFlO1FBQzNCLElBQUksVUFBVSxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQ3hCLFVBQVUsQ0FBQyxRQUFRLEdBQUcsU0FBa0MsQ0FBQztRQUMzRCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7T0FHRztJQUNJLDJCQUEyQjtRQUNoQyxNQUFNLHFCQUFxQixHQUFHLDBFQUFlLENBQUMsZ0NBQWdDLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDdEYsWUFBWTtRQUNaLE1BQU0sTUFBTSxHQUFHLDJEQUFVLEVBQUUsQ0FBQywwREFBUyxDQUFDLEVBQUUsTUFBTSxDQUFDO1FBQy9DLE9BQU8scUJBQXFCLEVBQUUs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QUksT0FBTyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUN6QixPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDO1FBRUQsTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUM7UUFFckUsSUFBSSxZQUFZLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDdkIsT0FBTyxNQUFNLENBQUM7UUFDaEIsQ0FBQzthQUFNLENBQUM7WUFDTixPQUFPLEtBQUssQ0FBQztRQUNmLENBQUM7SUFDSCxDQUFDO0NBQ0Y7QUFFRDs7O0dBR0c7QUFDSSxLQUFLLFVBQVUsb0JBQW9CLENBQUMsRUFBRSxTQUFTLEVBQXNCO0lBQzFFLE1BQU0sTUFBTSxHQUFHLFNBQVMsRUFBRSxTQUFTLEVBQUUsTUFBTSxDQUFDO0lBQzVDLE1BQU0scUJBQXFCLEdBQUcsMEVBQWUsQ0FBQyxnQ0FBZ0MsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUN0RixJQUFJLE1BQU0sRUFBRSxDQUFDO1FBQ1gsWUFBWSxDQUFDLFVBQVUsQ0FBQyxlQUFlLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDakQsSUFBSSxxQkFBcUIsRUFBRSxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQztZQUM1QyxNQUFNLEtBQUssR0FBRyxxQkFBcUIsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDcEQsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDakIscUJBQXFCLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDdkMsMkVBQWdCLENBQUMsZ0NBQWdDLEVBQUUscUJBQXFCLENBQUMsQ0FBQztZQUM1RSxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9kYXRhLnRzPzM2OTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgICBleHRyYWN0U2NyaXB0c0Zyb21SZXBvc2l0b3J5LFxuICAgIGdldE9wcG9zaXRlU2NyaXB0VHlwZSxcbiAgICBpc1NjcmlwdCxcbiAgICBpc1NjcmlwdFJlcG9zaXRvcnlJdGVtLFxuICAgIFNjcmlwdCxcbiAgICBTY3JpcHRSZXBvc2l0b3J5SXRlbSxcbiAgICBTY3JpcHRUeXBlLFxufSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS90eXBlcyc7XG5pbXBvcnQgeyBnZXRTZXR0aW5nVmFsdWUsIHNhdmVTZXR0aW5nVmFsdWUgfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5pbXBvcnQgeyBjaGFyYWN0ZXJzLCB0aGlzX2NoaWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IHdyaXRlRXh0ZW5zaW9uRmllbGQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuLyoqXG4gKiDohJrmnKzmlbDmja7nrqHnkIbnsbtcbiAqL1xuZXhwb3J0IGNsYXNzIFNjcmlwdERhdGEge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogU2NyaXB0RGF0YTtcbiAgcHJpdmF0ZSBnbG9iYWxTY3JpcHRzOiBTY3JpcHRbXSA9IFtdO1xuICBwcml2YXRlIGNoYXJhY3RlclNjcmlwdHM6IFNjcmlwdFtdID0gW107XG4gIHByaXZhdGUgX2lzR2xvYmFsU2NyaXB0RW5hYmxlZDogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIF9pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMubG9hZFNjcmlwdHMoKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgaXNHbG9iYWxTY3JpcHRFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9pc0dsb2JhbFNjcmlwdEVuYWJsZWQ7XG4gIH1cblxuICBwdWJsaWMgZ2V0IGlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5faXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBTY3JpcHREYXRhIHtcbiAgICBpZiAoIVNjcmlwdERhdGEuaW5zdGFuY2UpIHtcbiAgICAgIFNjcmlwdERhdGEuaW5zdGFuY2UgPSBuZXcgU2NyaXB0RGF0YSgpO1xuICAgIH1cbiAgICByZXR1cm4gU2NyaXB0RGF0YS5pbnN0YW5jZTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZGVzdHJveUluc3RhbmNlKCk6IHZvaWQge1xuICAgIGlmIChTY3JpcHREYXRhLmluc3RhbmNlKSB7XG4gICAgICBTY3JpcHREYXRhLmluc3RhbmNlID0gdW5kZWZpbmVkIGFzIHVua25vd24gYXMgU2NyaXB0RGF0YTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5qOA5p+l5b2T5YmN6KeS6Imy5piv5ZCm5ZCv55So5LqG6ISa5pys5bqTXG4gICAqIEByZXR1cm5zIOinkuiJsuiEmuacrOW6k+aYr+WQpuWQr+eUqFxuICAgKi9cbiAgcHVibGljIGNoZWNrQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCgpOiBib29sZWFuIHtcbiAgICBjb25zdCBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMgPSBnZXRTZXR0aW5nVmFsdWUoJ3NjcmlwdC5jaGFyYWN0ZXJzX3dpdGhfc2NyaXB0cycpIHx8IFtdO1xuICAgIC8vQHRzLWlnbm9yZVxuICAgIGNvbnN0IGF2YXRhciA9IGNoYXJhY3RlcnM/Llt0aGlzX2NoaWRdPy5hdmF0YXI7XG4gICAgcmV0dXJuIGNoYXJhY3RlcnNXaXRoU2NyaXB0cz8uaW5jbHVkZXMoYXZhdGFyKSB8fCBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliqDovb3ohJrmnKzlupPljp/lp4vmlbDmja7vvIzmlK/mjIHmlrDml6fmlbDmja7nu5PmnoTlhbzlrrlcbiAgICovXG4gIGxvYWRTY3JpcHRzKCkge1xuICAgIGNvbnN0IHJhd0dsb2JhbFJlcG9zaXRvcnkgPSBnZXRTZXR0aW5nVmFsdWUoJ3NjcmlwdC5zY3JpcHRzUmVwb3NpdG9yeScpIHx8IFtdO1xuICAgIHRoaXMuZ2xvYmFsU2NyaXB0cyA9IHRoaXMubWlncmF0ZUFuZEV4dHJhY3RTY3JpcHRzKHJhd0dsb2JhbFJlcG9zaXRvcnksIFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICBjb25zdCByYXdDaGFyYWN0ZXJSZXBvc2l0b3J5ID0gY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5UYXZlcm5IZWxwZXJfc2NyaXB0cyB8fCBbXTtcbiAgICB0aGlzLmNoYXJhY3RlclNjcmlwdHMgPSB0aGlzLm1pZ3JhdGVBbmRFeHRyYWN0U2NyaXB0cyhyYXdDaGFyYWN0ZXJSZXBvc2l0b3J5LCBTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG5cbiAgICB0aGlzLl9pc0dsb2JhbFNjcmlwdEVuYWJsZWQgPSBnZXRTZXR0aW5nVmFsdWUoJ3NjcmlwdC5nbG9iYWxfc2NyaXB0X2VuYWJsZWQnKSA/PyBmYWxzZTtcbiAgICB0aGlzLl9pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQgPSB0aGlzLmNoZWNrQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOajgOafpeW5tui/geenu+aVsOaNrue7k+aehO+8jOehruS/neWQkeWQjuWFvOWuuVxuICAgKiBAcGFyYW0gcmVwb3NpdG9yeSDljp/lp4vku5PlupPmlbDmja5cbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEByZXR1cm5zIOaPkOWPlueahOiEmuacrOaVsOe7hFxuICAgKi9cbiAgcHJpdmF0ZSBtaWdyYXRlQW5kRXh0cmFjdFNjcmlwdHMocmVwb3NpdG9yeTogYW55W10sIHR5cGU6IFNjcmlwdFR5cGUpOiBTY3JpcHRbXSB7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHJlcG9zaXRvcnkpKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgbGV0IG5lZWRzTWlncmF0aW9uID0gZmFsc2U7XG4gICAgY29uc3QgbWlncmF0ZWRSZXBvc2l0b3J5OiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgcmVwb3NpdG9yeSkge1xuICAgICAgaWYgKGlzU2NyaXB0KGl0ZW0pKSB7XG4gICAgICAgIG5lZWRzTWlncmF0aW9uID0gdHJ1ZTtcbiAgICAgICAgbWlncmF0ZWRSZXBvc2l0b3J5LnB1c2goe1xuICAgICAgICAgIHR5cGU6ICdzY3JpcHQnLFxuICAgICAgICAgIHZhbHVlOiBuZXcgU2NyaXB0KGl0ZW0pLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoaXNTY3JpcHRSZXBvc2l0b3J5SXRlbShpdGVtKSkge1xuICAgICAgICBpZiAoaXRlbS50eXBlID09PSAnc2NyaXB0Jykge1xuICAgICAgICAgIG1pZ3JhdGVkUmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdzY3JpcHQnLFxuICAgICAgICAgICAgdmFsdWU6IG5ldyBTY3JpcHQoaXRlbS52YWx1ZSBhcyBQYXJ0aWFsPFNjcmlwdD4pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgICBtaWdyYXRlZFJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnZm9sZGVyJyxcbiAgICAgICAgICAgIGlkOiBpdGVtLmlkLFxuICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxuICAgICAgICAgICAgaWNvbjogaXRlbS5pY29uIHx8ICdmYS1mb2xkZXInLFxuICAgICAgICAgICAgY29sb3I6IGl0ZW0uY29sb3IgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy0tU21hcnRUaGVtZUJvZHlDb2xvcicpLFxuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmlzQXJyYXkoaXRlbS52YWx1ZSkgPyBpdGVtLnZhbHVlLm1hcCgoczogYW55KSA9PiBuZXcgU2NyaXB0KHMpKSA6IFtdLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1tTY3JpcHRNYW5hZ2VyXSDml6Dms5Xop6PmnpDnmoTohJrmnKzmlbDmja46JywgaXRlbSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG5lZWRzTWlncmF0aW9uKSB7XG4gICAgICB0aGlzLnNhdmVNaWdyYXRlZFJlcG9zaXRvcnkobWlncmF0ZWRSZXBvc2l0b3J5LCB0eXBlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZXh0cmFjdFNjcmlwdHNGcm9tUmVwb3NpdG9yeShtaWdyYXRlZFJlcG9zaXRvcnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOi/geenu+WQjueahOS7k+W6k+aVsOaNrlxuICAgKiBAcGFyYW0gcmVwb3NpdG9yeSDov4Hnp7vlkI7nmoTku5PlupPmlbDmja5cbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNhdmVNaWdyYXRlZFJlcG9zaXRvcnkocmVwb3NpdG9yeTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0LnNjcmlwdHNSZXBvc2l0b3J5JywgcmVwb3NpdG9yeSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXRoaXNfY2hpZCkge1xuICAgICAgICAgIGNvbnNvbGUud2FybignW1NjcmlwdE1hbmFnZXJdIOaXoOazleS/neWtmOinkuiJsuiEmuacrOi/geenu+aVsOaNru+8muW9k+WJjeinkuiJsuS4uuepuicpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgYXdhaXQgd3JpdGVFeHRlbnNpb25GaWVsZCh0aGlzX2NoaWQsICdUYXZlcm5IZWxwZXJfc2NyaXB0cycsIHJlcG9zaXRvcnkpO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coYFtTY3JpcHRNYW5hZ2VyXSDmiJDlip/ov4Hnp7ske3R5cGV96ISa5pys5pWw5o2u57uT5p6EYCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtTY3JpcHRNYW5hZ2VyXSDov4Hnp7ske3R5cGV96ISa5pys5pWw5o2u5aSx6LSlOmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5YWo5bGA6ISa5pys5YiX6KGoXG4gICAqL1xuICBnZXRHbG9iYWxTY3JpcHRzKCk6IFNjcmlwdFtdIHtcbiAgICByZXR1cm4gdGhpcy5nbG9iYWxTY3JpcHRzO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuiEmuacrOWIl+ihqFxuICAgKi9cbiAgZ2V0Q2hhcmFjdGVyU2NyaXB0cygpOiBTY3JpcHRbXSB7XG4gICAgLy9AdHMtaWdub3JlXG4gICAgY29uc3QgcmF3Q2hhcmFjdGVyUmVwb3NpdG9yeSA9IGNoYXJhY3RlcnNbdGhpc19jaGlkXT8uZGF0YT8uZXh0ZW5zaW9ucz8uVGF2ZXJuSGVscGVyX3NjcmlwdHMgfHwgW107XG4gICAgdGhpcy5jaGFyYWN0ZXJTY3JpcHRzID0gdGhpcy5taWdyYXRlQW5kRXh0cmFjdFNjcmlwdHMocmF3Q2hhcmFjdGVyUmVwb3NpdG9yeSwgU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgIHJldHVybiB0aGlzLmNoYXJhY3RlclNjcmlwdHM7XG4gIH1cblxuICAvKipcbiAgICog5qC55o2uSUTojrflj5bohJrmnKxcbiAgICogQHBhcmFtIGlkIOiEmuacrElEXG4gICAqIEByZXR1cm5zIOiEmuacrOWvueixoe+8jOWmguaenOS4jeWtmOWcqOWImei/lOWbnnVuZGVmaW5lZFxuICAgKi9cbiAgZ2V0U2NyaXB0QnlJZChpZDogc3RyaW5nKTogU2NyaXB0IHwgdW5kZWZpbmVkIHtcbiAgICBsZXQgc2NyaXB0ID0gdGhpcy5nbG9iYWxTY3JpcHRzLmZpbmQoKHM6IFNjcmlwdCkgPT4gcy5pZCA9PT0gaWQpO1xuICAgIGlmIChzY3JpcHQpIHJldHVybiBzY3JpcHQ7XG5cbiAgICBzY3JpcHQgPSB0aGlzLmNoYXJhY3RlclNjcmlwdHMuZmluZCgoczogU2NyaXB0KSA9PiBzLmlkID09PSBpZCk7XG4gICAgaWYgKHNjcmlwdCkgcmV0dXJuIHNjcmlwdDtcblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICog5L+d5a2Y5Y2V5Liq6ISa5pys5Yiw6K6+572u5Lit77yM5LiN5a2Y5Zyo5YiZ5re75Yqg5Yiw5pyr5bC+77yM5a2Y5Zyo5YiZ6KaG55uWXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgYXN5bmMgc2F2ZVNjcmlwdChzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghc2NyaXB0Lm5hbWUgfHwgc2NyaXB0Lm5hbWUudHJpbSgpID09PSAnJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5L+d5a2Y5aSx6LSl77yM6ISa5pys5ZCN56ew5Li656m6Jyk7XG4gICAgfVxuXG4gICAgY29uc3QgcmF3UmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTFxuICAgICAgICA/IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LnNjcmlwdHNSZXBvc2l0b3J5JykgfHwgW11cbiAgICAgICAgOiAvL0B0cy1pZ25vcmVcbiAgICAgICAgICBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0/LmRhdGE/LmV4dGVuc2lvbnM/LlRhdmVybkhlbHBlcl9zY3JpcHRzIHx8IFtdO1xuXG4gICAgY29uc3QgcmVwb3NpdG9yeSA9IHRoaXMuZW5zdXJlUmVwb3NpdG9yeVN0cnVjdHVyZShyYXdSZXBvc2l0b3J5KTtcblxuICAgIGxldCBmb3VuZEluZGV4ID0gLTE7XG4gICAgbGV0IGZvdW5kSW5Gb2xkZXIgPSBmYWxzZTtcbiAgICBsZXQgZm9sZGVySW5kZXggPSAtMTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVwb3NpdG9yeS5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgaXRlbSA9IHJlcG9zaXRvcnlbaV07XG4gICAgICBpZiAoaXRlbS50eXBlID09PSAnc2NyaXB0JyAmJiAoaXRlbS52YWx1ZSBhcyBTY3JpcHQpLmlkID09PSBzY3JpcHQuaWQpIHtcbiAgICAgICAgZm91bmRJbmRleCA9IGk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfSBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICdmb2xkZXInKSB7XG4gICAgICAgIGNvbnN0IHNjcmlwdHMgPSBpdGVtLnZhbHVlIGFzIFNjcmlwdFtdO1xuICAgICAgICBjb25zdCBzY3JpcHRJbmRleCA9IHNjcmlwdHMuZmluZEluZGV4KHMgPT4gcy5pZCA9PT0gc2NyaXB0LmlkKTtcbiAgICAgICAgaWYgKHNjcmlwdEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgIGZvdW5kSW5Gb2xkZXIgPSB0cnVlO1xuICAgICAgICAgIGZvbGRlckluZGV4ID0gaTtcbiAgICAgICAgICBmb3VuZEluZGV4ID0gc2NyaXB0SW5kZXg7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZm91bmRJbkZvbGRlciAmJiBmb2xkZXJJbmRleCA+PSAwKSB7XG4gICAgICBjb25zdCBmb2xkZXIgPSByZXBvc2l0b3J5W2ZvbGRlckluZGV4XTtcbiAgICAgIChmb2xkZXIudmFsdWUgYXMgU2NyaXB0W10pW2ZvdW5kSW5kZXhdID0gc2NyaXB0O1xuICAgIH0gZWxzZSBpZiAoZm91bmRJbmRleCA+PSAwKSB7XG4gICAgICAocmVwb3NpdG9yeVtmb3VuZEluZGV4XS52YWx1ZSBhcyBTY3JpcHQpID0gc2NyaXB0O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXBvc2l0b3J5LnB1c2goe1xuICAgICAgICB0eXBlOiAnc2NyaXB0JyxcbiAgICAgICAgdmFsdWU6IHNjcmlwdCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlR2xvYmFsUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgfVxuXG4gICAgdGhpcy5sb2FkU2NyaXB0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOehruS/neS7k+W6k+S9v+eUqOaWsOeahOaVsOaNrue7k+aehFxuICAgKiBAcGFyYW0gcmF3UmVwb3NpdG9yeSDljp/lp4vku5PlupPmlbDmja5cbiAgICogQHJldHVybnMg6KeE6IyD5YyW55qE5LuT5bqT5pWw5o2uXG4gICAqL1xuICBwcml2YXRlIGVuc3VyZVJlcG9zaXRvcnlTdHJ1Y3R1cmUocmF3UmVwb3NpdG9yeTogYW55W10pOiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdIHtcbiAgICBjb25zdCByZXBvc2l0b3J5OiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgcmF3UmVwb3NpdG9yeSkge1xuICAgICAgaWYgKGlzU2NyaXB0KGl0ZW0pKSB7XG4gICAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgdHlwZTogJ3NjcmlwdCcsXG4gICAgICAgICAgdmFsdWU6IG5ldyBTY3JpcHQoaXRlbSksXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChpc1NjcmlwdFJlcG9zaXRvcnlJdGVtKGl0ZW0pKSB7XG4gICAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnKSB7XG4gICAgICAgICAgcmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdzY3JpcHQnLFxuICAgICAgICAgICAgdmFsdWU6IG5ldyBTY3JpcHQoaXRlbS52YWx1ZSBhcyBQYXJ0aWFsPFNjcmlwdD4pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgICBpZiAoIWl0ZW0uaWNvbikge1xuICAgICAgICAgICAgaXRlbS5pY29uID0gJ2ZhLWZvbGRlcic7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghaXRlbS5jb2xvcikge1xuICAgICAgICAgICAgaXRlbS5jb2xvciA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLVNtYXJ0VGhlbWVCb2R5Q29sb3InKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgICAgIC4uLml0ZW0sXG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuaXNBcnJheShpdGVtLnZhbHVlKSA/IGl0ZW0udmFsdWUubWFwKChzOiBhbnkpID0+IG5ldyBTY3JpcHQocykpIDogW10sXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdzY3JpcHQnLFxuICAgICAgICAgICAgdmFsdWU6IG5ldyBTY3JpcHQoaXRlbSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdbU2NyaXB0TWFuYWdlcl0g5peg5rOV6Kej5p6Q55qE6ISa5pys5pWw5o2uOicsIGl0ZW0sIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXBvc2l0b3J5O1xuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOWFqOWxgOiEmuacrOaVsOe7hOWIsOaJqeWxleiuvue9rlxuICAgKiBAcGFyYW0gYXJyYXkg6ISa5pys5pWw57uEXG4gICAqL1xuICBhc3luYyBzYXZlR2xvYmFsU2NyaXB0cyhhcnJheTogU2NyaXB0W10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdzY3JpcHQuc2NyaXB0c1JlcG9zaXRvcnknLCBhcnJheSk7XG4gICAgdGhpcy5nbG9iYWxTY3JpcHRzID0gYXJyYXk7XG4gIH1cblxuICAvKipcbiAgICog5L+d5a2Y6ISa5pys5pWw57uE5Yiw6KeS6Imy5Y2h5pWw5o2uXG4gICAqIEBwYXJhbSBhcnJheSDohJrmnKzmlbDnu4RcbiAgICovXG4gIGFzeW5jIHNhdmVDaGFyYWN0ZXJTY3JpcHRzKGFycmF5OiBTY3JpcHRbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpc19jaGlkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDkv53lrZjlpLHotKXvvIzlvZPliY3op5LoibLkuLrnqbonKTtcbiAgICB9XG5cbiAgICAvL0B0cy1pZ25vcmVcbiAgICBhd2FpdCB3cml0ZUV4dGVuc2lvbkZpZWxkKHRoaXNfY2hpZCwgJ1RhdmVybkhlbHBlcl9zY3JpcHRzJywgYXJyYXkpO1xuXG4gICAgdGhpcy5jaGFyYWN0ZXJTY3JpcHRzID0gYXJyYXk7XG4gIH1cblxuICAvKipcbiAgICog5L+d5a2Y5YWo5bGA6ISa5pys5LuT5bqT6aG55pWw57uE5Yiw5omp5bGV6K6+572uXG4gICAqIEBwYXJhbSByZXBvc2l0b3J5IOS7k+W6k+mhueaVsOe7hFxuICAgKi9cbiAgYXN5bmMgc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5OiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0LnNjcmlwdHNSZXBvc2l0b3J5JywgcmVwb3NpdG9yeSk7XG4gICAgdGhpcy5nbG9iYWxTY3JpcHRzID0gZXh0cmFjdFNjcmlwdHNGcm9tUmVwb3NpdG9yeShyZXBvc2l0b3J5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkv53lrZjohJrmnKzku5PlupPpobnmlbDnu4TliLDop5LoibLljaHmlbDmja5cbiAgICogQHBhcmFtIHJlcG9zaXRvcnkg5LuT5bqT6aG55pWw57uEXG4gICAqL1xuICBhc3luYyBzYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXNfY2hpZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5L+d5a2Y5aSx6LSl77yM5b2T5YmN6KeS6Imy5Li656m6Jyk7XG4gICAgfVxuICAgIC8vQHRzLWlnbm9yZVxuICAgIGF3YWl0IHdyaXRlRXh0ZW5zaW9uRmllbGQodGhpc19jaGlkLCAnVGF2ZXJuSGVscGVyX3NjcmlwdHMnLCByZXBvc2l0b3J5KTtcblxuICAgIHRoaXMuY2hhcmFjdGVyU2NyaXB0cyA9IGV4dHJhY3RTY3JpcHRzRnJvbVJlcG9zaXRvcnkocmVwb3NpdG9yeSk7XG4gIH1cblxuICAvKipcbiAgICog5LuO6ISa5pys5bqT5Lit5Yig6Zmk6ISa5pysXG4gICAqIEBwYXJhbSBpZCDohJrmnKxJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGFzeW5jIGRlbGV0ZVNjcmlwdChpZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgbGV0IHNjcmlwdEZvdW5kID0gZmFsc2U7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcG9zaXRvcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSByZXBvc2l0b3J5W2ldO1xuICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ3NjcmlwdCcgJiYgKGl0ZW0udmFsdWUgYXMgU2NyaXB0KS5pZCA9PT0gaWQpIHtcbiAgICAgICAgcmVwb3NpdG9yeS5zcGxpY2UoaSwgMSk7XG4gICAgICAgIHNjcmlwdEZvdW5kID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIGNvbnN0IGZvdW5kSW5kZXggPSBzY3JpcHRzLmZpbmRJbmRleChzID0+IHMuaWQgPT09IGlkKTtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgc2NyaXB0cy5zcGxpY2UoZm91bmRJbmRleCwgMSk7XG4gICAgICAgICAgc2NyaXB0Rm91bmQgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFzY3JpcHRGb3VuZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Yig6Zmk6ISa5pys5aSx6LSl77yM6ISa5pys5LiN5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMKSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUNoYXJhY3RlclJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pu05paw6ISa5pys5ZCv55So54q25oCBXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgYXN5bmMgdXBkYXRlU2NyaXB0VHlwZUVuYWJsZVN0YXRlKHR5cGU6IFNjcmlwdFR5cGUsIGVuYWJsZTogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0Lmdsb2JhbF9zY3JpcHRfZW5hYmxlZCcsIGVuYWJsZSk7XG4gICAgICB0aGlzLl9pc0dsb2JhbFNjcmlwdEVuYWJsZWQgPSBlbmFibGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNoYXJhY3RlcnNXaXRoU2NyaXB0cyA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJykgfHwgW107XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIGNvbnN0IGF2YXRhciA9IGNoYXJhY3RlcnM/Llt0aGlzX2NoaWRdPy5hdmF0YXI7XG5cbiAgICAgIGlmIChlbmFibGUpIHtcbiAgICAgICAgaWYgKGF2YXRhciAmJiAhY2hhcmFjdGVyc1dpdGhTY3JpcHRzLmluY2x1ZGVzKGF2YXRhcikpIHtcbiAgICAgICAgICBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMucHVzaChhdmF0YXIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBpbmRleCA9IGNoYXJhY3RlcnNXaXRoU2NyaXB0cy5pbmRleE9mKGF2YXRhcik7XG4gICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdzY3JpcHQuY2hhcmFjdGVyc193aXRoX3NjcmlwdHMnLCBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMpO1xuICAgICAgdGhpcy5faXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkID0gZW5hYmxlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bohJrmnKznmoTnsbvlnotcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKzlr7nosaFcbiAgICogQHJldHVybnMg6ISa5pys57G75Z6LXG4gICAqL1xuICBnZXRTY3JpcHRUeXBlKHNjcmlwdDogU2NyaXB0KTogU2NyaXB0VHlwZSB7XG4gICAgcmV0dXJuIHRoaXMuZ2xvYmFsU2NyaXB0cy5zb21lKHMgPT4gcy5pZCA9PT0gc2NyaXB0LmlkKSA/IFNjcmlwdFR5cGUuR0xPQkFMIDogU2NyaXB0VHlwZS5DSEFSQUNURVI7XG4gIH1cblxuICAvKipcbiAgICog5Yi35paw6KeS6Imy6ISa5pys5ZCv55So54q25oCBXG4gICAqL1xuICByZWZyZXNoQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZFN0YXRlKCk6IHZvaWQge1xuICAgIHRoaXMuX2lzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCA9IHRoaXMuY2hlY2tDaGFyYWN0ZXJTY3JpcHRFbmFibGVkKCk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5YWo5bGA6ISa5pys5LuT5bqT6aG5XG4gICAqL1xuICBnZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSB7XG4gICAgY29uc3QgcmF3UmVwb3NpdG9yeSA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LnNjcmlwdHNSZXBvc2l0b3J5JykgfHwgW107XG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlUmVwb3NpdG9yeVN0cnVjdHVyZShyYXdSZXBvc2l0b3J5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bop5LoibLohJrmnKzku5PlupPpoblcbiAgICovXG4gIGdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpOiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdIHtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICBjb25zdCByYXdSZXBvc2l0b3J5ID0gY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5UYXZlcm5IZWxwZXJfc2NyaXB0cyB8fCBbXTtcbiAgICByZXR1cm4gdGhpcy5lbnN1cmVSZXBvc2l0b3J5U3RydWN0dXJlKHJhd1JlcG9zaXRvcnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uuaWh+S7tuWkuVxuICAgKiBAcGFyYW0gbmFtZSDmlofku7blpLnlkI3np7BcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBpY29uIOaWh+S7tuWkueWbvuagh++8iOWPr+mAie+8iVxuICAgKiBAcGFyYW0gY29sb3Ig5paH5Lu25aS56aKc6Imy77yI5Y+v6YCJ77yJXG4gICAqIEByZXR1cm5zIOaWsOWIm+W7uueahOaWh+S7tuWkuUlEXG4gICAqL1xuICBhc3luYyBjcmVhdGVGb2xkZXIobmFtZTogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlLCBpY29uPzogc3RyaW5nLCBjb2xvcj86IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgaWYgKCFuYW1lIHx8IG5hbWUudHJpbSgpID09PSAnJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5paH5Lu25aS55ZCN56ew5LiN6IO95Li656m6Jyk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgY29uc3QgZXhpc3RpbmdGb2xkZXIgPSByZXBvc2l0b3J5LmZpbmQoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0ubmFtZSA9PT0gbmFtZS50cmltKCkpO1xuICAgIGlmIChleGlzdGluZ0ZvbGRlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5paH5Lu25aS55ZCN56ew5bey5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgY29uc3QgZm9sZGVySWQgPSB1dWlkdjQoKTtcbiAgICBjb25zdCBuZXdGb2xkZXI6IFNjcmlwdFJlcG9zaXRvcnlJdGVtID0ge1xuICAgICAgdHlwZTogJ2ZvbGRlcicsXG4gICAgICBpZDogZm9sZGVySWQsXG4gICAgICBuYW1lOiBuYW1lLnRyaW0oKSxcbiAgICAgIGljb246IGljb24gfHwgJ2ZhLWZvbGRlcicsXG4gICAgICBjb2xvcjogY29sb3IgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy0tU21hcnRUaGVtZUJvZHlDb2xvcicpLFxuICAgICAgdmFsdWU6IFtdLFxuICAgIH07XG5cbiAgICByZXBvc2l0b3J5LnVuc2hpZnQobmV3Rm9sZGVyKTtcblxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlR2xvYmFsUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZvbGRlcklkO1xuICB9XG5cbiAgLyoqXG4gICAqIOe8lui+keaWh+S7tuWkuVxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIG5ld05hbWUg5paw5ZCN56ewXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gbmV3SWNvbiDmlrDlm77moIdcbiAgICogQHBhcmFtIG5ld0NvbG9yIOaWsOminOiJslxuICAgKi9cbiAgYXN5bmMgZWRpdEZvbGRlcihcbiAgICBmb2xkZXJJZDogc3RyaW5nLFxuICAgIG5ld05hbWU6IHN0cmluZyxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgIG5ld0ljb24/OiBzdHJpbmcsXG4gICAgbmV3Q29sb3I/OiBzdHJpbmcsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghbmV3TmFtZSB8fCBuZXdOYW1lLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOaWh+S7tuWkueWQjeensOS4jeiDveS4uuepuicpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGNvbnN0IGZvbGRlckluZGV4ID0gcmVwb3NpdG9yeS5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0uaWQgPT09IGZvbGRlcklkKTtcbiAgICBpZiAoZm9sZGVySW5kZXggPT09IC0xKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmlofku7blpLnkuI3lrZjlnKgnKTtcbiAgICB9XG5cbiAgICBjb25zdCBleGlzdGluZ0ZvbGRlciA9IHJlcG9zaXRvcnkuZmluZChcbiAgICAgIGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLm5hbWUgPT09IG5ld05hbWUudHJpbSgpICYmIGl0ZW0uaWQgIT09IGZvbGRlcklkLFxuICAgICk7XG4gICAgaWYgKGV4aXN0aW5nRm9sZGVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmlofku7blpLnlkI3np7Dlt7LlrZjlnKgnKTtcbiAgICB9XG5cbiAgICByZXBvc2l0b3J5W2ZvbGRlckluZGV4XS5uYW1lID0gbmV3TmFtZS50cmltKCk7XG4gICAgaWYgKG5ld0ljb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmVwb3NpdG9yeVtmb2xkZXJJbmRleF0uaWNvbiA9IG5ld0ljb247XG4gICAgfVxuICAgIGlmIChuZXdDb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXBvc2l0b3J5W2ZvbGRlckluZGV4XS5jb2xvciA9IG5ld0NvbG9yO1xuICAgIH1cblxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlR2xvYmFsUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIoOmZpOaWh+S7tuWkue+8iOWQjOaXtuWIoOmZpOWGhemDqOeahOaJgOacieiEmuacrO+8iVxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBhc3luYyBkZWxldGVGb2xkZXIoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGNvbnN0IGZvbGRlckluZGV4ID0gcmVwb3NpdG9yeS5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0uaWQgPT09IGZvbGRlcklkKTtcbiAgICBpZiAoZm9sZGVySW5kZXggPT09IC0xKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmlofku7blpLnkuI3lrZjlnKgnKTtcbiAgICB9XG5cbiAgICByZXBvc2l0b3J5LnNwbGljZShmb2xkZXJJbmRleCwgMSk7XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlsIbpobnnm67vvIjohJrmnKzmiJbmlofku7blpLnvvInnp7vliqjliLDlhbbku5bnsbvlnovnmoTku5PlupNcbiAgICogQHBhcmFtIGl0ZW0g6KaB56e75Yqo55qE6aG555uu5L+h5oGvXG4gICAqIEBwYXJhbSBzb3VyY2VUeXBlIOa6kOexu+Wei1xuICAgKi9cbiAgYXN5bmMgbW92ZUl0ZW1Ub090aGVyVHlwZShcbiAgICBpdGVtOiB7IHR5cGU6ICdzY3JpcHQnOyBpZDogc3RyaW5nOyB2YWx1ZTogU2NyaXB0IH0gfCB7IHR5cGU6ICdmb2xkZXInOyBpZDogc3RyaW5nIH0sXG4gICAgc291cmNlVHlwZTogU2NyaXB0VHlwZSxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgdGFyZ2V0VHlwZSA9IGdldE9wcG9zaXRlU2NyaXB0VHlwZShzb3VyY2VUeXBlKTtcblxuICAgIGNvbnN0IHNvdXJjZVJlcG9zaXRvcnkgPVxuICAgICAgc291cmNlVHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGxldCBpdGVtRm91bmQgPSBmYWxzZTtcbiAgICBsZXQgZm91bmRJdGVtOiBTY3JpcHRSZXBvc2l0b3J5SXRlbSB8IG51bGwgPSBudWxsO1xuXG4gICAgaWYgKGl0ZW0udHlwZSA9PT0gJ3NjcmlwdCcpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc291cmNlUmVwb3NpdG9yeS5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCByZXBvSXRlbSA9IHNvdXJjZVJlcG9zaXRvcnlbaV07XG4gICAgICAgIGlmIChyZXBvSXRlbS50eXBlID09PSAnc2NyaXB0JyAmJiAocmVwb0l0ZW0udmFsdWUgYXMgU2NyaXB0KS5pZCA9PT0gaXRlbS5pZCkge1xuICAgICAgICAgIGZvdW5kSXRlbSA9IHJlcG9JdGVtO1xuICAgICAgICAgIHNvdXJjZVJlcG9zaXRvcnkuc3BsaWNlKGksIDEpO1xuICAgICAgICAgIGl0ZW1Gb3VuZCA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH0gZWxzZSBpZiAocmVwb0l0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgICBjb25zdCBzY3JpcHRzID0gcmVwb0l0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgICAgY29uc3QgZm91bmRJbmRleCA9IHNjcmlwdHMuZmluZEluZGV4KHMgPT4gcy5pZCA9PT0gaXRlbS5pZCk7XG4gICAgICAgICAgaWYgKGZvdW5kSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICBmb3VuZEl0ZW0gPSB7IHR5cGU6ICdzY3JpcHQnLCB2YWx1ZTogc2NyaXB0c1tmb3VuZEluZGV4XSB9O1xuICAgICAgICAgICAgc2NyaXB0cy5zcGxpY2UoZm91bmRJbmRleCwgMSk7XG4gICAgICAgICAgICBpdGVtRm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghaXRlbUZvdW5kKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOenu+WKqOiEmuacrOWksei0pe+8jOiEmuacrOS4jeWtmOWcqCcpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoaXRlbS50eXBlID09PSAnZm9sZGVyJykge1xuICAgICAgY29uc3QgZm9sZGVySW5kZXggPSBzb3VyY2VSZXBvc2l0b3J5LmZpbmRJbmRleChyZXBvSXRlbSA9PiByZXBvSXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiByZXBvSXRlbS5pZCA9PT0gaXRlbS5pZCk7XG4gICAgICBpZiAoZm9sZGVySW5kZXggPT09IC0xKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOaWh+S7tuWkueS4jeWtmOWcqCcpO1xuICAgICAgfVxuXG4gICAgICBmb3VuZEl0ZW0gPSBzb3VyY2VSZXBvc2l0b3J5W2ZvbGRlckluZGV4XTtcbiAgICAgIHNvdXJjZVJlcG9zaXRvcnkuc3BsaWNlKGZvbGRlckluZGV4LCAxKTtcbiAgICAgIGl0ZW1Gb3VuZCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKCFpdGVtRm91bmQgfHwgIWZvdW5kSXRlbSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g56e75Yqo5aSx6LSl77yM6aG555uu5LiN5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgY29uc3QgdGFyZ2V0UmVwb3NpdG9yeSA9XG4gICAgICB0YXJnZXRUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgaWYgKGZvdW5kSXRlbS50eXBlID09PSAnZm9sZGVyJykge1xuICAgICAgY29uc3QgZXhpc3RpbmdGb2xkZXIgPSB0YXJnZXRSZXBvc2l0b3J5LmZpbmQoXG4gICAgICAgIHJlcG9JdGVtID0+IHJlcG9JdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIHJlcG9JdGVtLm5hbWUgPT09IGZvdW5kSXRlbSEubmFtZSxcbiAgICAgICk7XG4gICAgICBpZiAoZXhpc3RpbmdGb2xkZXIpIHtcbiAgICAgICAgdG9hc3RyLmVycm9yKCfnm67moIfkvY3nva7lt7LlrZjlnKjlkIzlkI3mlofku7blpLknKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g55uu5qCH5L2N572u5bey5a2Y5Zyo5ZCM5ZCN5paH5Lu25aS5Jyk7XG4gICAgICB9XG4gICAgICB0YXJnZXRSZXBvc2l0b3J5LnVuc2hpZnQoZm91bmRJdGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFyZ2V0UmVwb3NpdG9yeS5wdXNoKGZvdW5kSXRlbSk7XG4gICAgfVxuXG4gICAgaWYgKHNvdXJjZVR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMKSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMoc291cmNlUmVwb3NpdG9yeSk7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXModGFyZ2V0UmVwb3NpdG9yeSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUNoYXJhY3RlclJlcG9zaXRvcnlJdGVtcyhzb3VyY2VSZXBvc2l0b3J5KTtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyh0YXJnZXRSZXBvc2l0b3J5KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5bCG6ISa5pys56e75Yqo5Yiw5paH5Lu25aS5XG4gICAqIEBwYXJhbSBzY3JpcHRJZCDohJrmnKxJRFxuICAgKiBAcGFyYW0gdGFyZ2V0Rm9sZGVySWQg55uu5qCH5paH5Lu25aS5SUTvvIzlpoLmnpzkuLpudWxs5YiZ56e75Yqo5Yiw5qC557qn5YirXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgYXN5bmMgbW92ZVNjcmlwdFRvRm9sZGVyKHNjcmlwdElkOiBzdHJpbmcsIHRhcmdldEZvbGRlcklkOiBzdHJpbmcgfCBudWxsLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgbGV0IHNjcmlwdDogU2NyaXB0IHwgbnVsbCA9IG51bGw7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcG9zaXRvcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSByZXBvc2l0b3J5W2ldO1xuICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ3NjcmlwdCcgJiYgKGl0ZW0udmFsdWUgYXMgU2NyaXB0KS5pZCA9PT0gc2NyaXB0SWQpIHtcbiAgICAgICAgc2NyaXB0ID0gaXRlbS52YWx1ZSBhcyBTY3JpcHQ7XG4gICAgICAgIHJlcG9zaXRvcnkuc3BsaWNlKGksIDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSBpZiAoaXRlbS50eXBlID09PSAnZm9sZGVyJykge1xuICAgICAgICBjb25zdCBzY3JpcHRzID0gaXRlbS52YWx1ZSBhcyBTY3JpcHRbXTtcbiAgICAgICAgY29uc3QgZm91bmRJbmRleCA9IHNjcmlwdHMuZmluZEluZGV4KHMgPT4gcy5pZCA9PT0gc2NyaXB0SWQpO1xuICAgICAgICBpZiAoZm91bmRJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICBzY3JpcHQgPSBzY3JpcHRzW2ZvdW5kSW5kZXhdO1xuICAgICAgICAgIHNjcmlwdHMuc3BsaWNlKGZvdW5kSW5kZXgsIDEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFzY3JpcHQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOiEmuacrOS4jeWtmOWcqCcpO1xuICAgIH1cblxuICAgIGlmICh0YXJnZXRGb2xkZXJJZCA9PT0gbnVsbCkge1xuICAgICAgcmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3NjcmlwdCcsXG4gICAgICAgIHZhbHVlOiBzY3JpcHQsXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgdGFyZ2V0Rm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSB0YXJnZXRGb2xkZXJJZCk7XG4gICAgICBpZiAoIXRhcmdldEZvbGRlcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDnm67moIfmlofku7blpLnkuI3lrZjlnKgnKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZm9sZGVyU2NyaXB0cyA9IHRhcmdldEZvbGRlci52YWx1ZSBhcyBTY3JpcHRbXTtcbiAgICAgIGNvbnN0IGV4aXN0aW5nU2NyaXB0ID0gZm9sZGVyU2NyaXB0cy5maW5kKHMgPT4gcy5uYW1lID09PSBzY3JpcHQubmFtZSk7XG4gICAgICBpZiAoZXhpc3RpbmdTY3JpcHQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5paH5Lu25aS55Lit5bey5a2Y5Zyo5ZCM5ZCN6ISa5pysJyk7XG4gICAgICB9XG5cbiAgICAgIGZvbGRlclNjcmlwdHMucHVzaChzY3JpcHQpO1xuICAgIH1cblxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlR2xvYmFsUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaWh+S7tuWkueS4reeahOiEmuacrOWIl+ihqFxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBnZXRGb2xkZXJTY3JpcHRzKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiBTY3JpcHRbXSB7XG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG5cbiAgICBpZiAoIWZvbGRlcikge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIHJldHVybiBmb2xkZXIudmFsdWUgYXMgU2NyaXB0W107XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5qC557qn5Yir55qE6ISa5pys5YiX6KGoXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgZ2V0Um9vdFNjcmlwdHModHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFtdIHtcbiAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gdGhpcy5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKSA6IHRoaXMuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICByZXR1cm4gcmVwb3NpdG9yeS5maWx0ZXIoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdzY3JpcHQnKS5tYXAoaXRlbSA9PiBpdGVtLnZhbHVlIGFzIFNjcmlwdCk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5omA5pyJ5paH5Lu25aS55YiX6KGoXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgZ2V0Rm9sZGVycyh0eXBlOiBTY3JpcHRUeXBlKTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSB7XG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgcmV0dXJuIHJlcG9zaXRvcnkuZmlsdGVyKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyk7XG4gIH1cblxuICAvKipcbiAgICog5om56YeP5YiH5o2i5paH5Lu25aS55YaF5omA5pyJ6ISa5pys55qE5ZCv55So54q25oCBXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHBhcmFtIGVuYWJsZSDmmK/lkKblkK/nlKhcbiAgICovXG4gIGFzeW5jIHRvZ2dsZUZvbGRlclNjcmlwdHMoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgZW5hYmxlOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgaWYgKCFmb2xkZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOaWh+S7tuWkueS4jeWtmOWcqCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHNjcmlwdHMgPSBmb2xkZXIudmFsdWUgYXMgU2NyaXB0W107XG4gICAgbGV0IGhhc0NoYW5nZXMgPSBmYWxzZTtcblxuICAgIGZvciAoY29uc3Qgc2NyaXB0IG9mIHNjcmlwdHMpIHtcbiAgICAgIGlmIChzY3JpcHQuZW5hYmxlZCAhPT0gZW5hYmxlKSB7XG4gICAgICAgIHNjcmlwdC5lbmFibGVkID0gZW5hYmxlO1xuICAgICAgICBoYXNDaGFuZ2VzID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaGFzQ2hhbmdlcykge1xuICAgICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNoYXJhY3RlclJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5paH5Lu25aS55YaF6ISa5pys55qE5pW05L2T5ZCv55So54q25oCBXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHJldHVybnMgJ2FsbCcgLSDlhajpg6jlkK/nlKgsICdub25lJyAtIOWFqOmDqOemgeeUqFxuICAgKi9cbiAgZ2V0Rm9sZGVyU2NyaXB0c1N0YXRlKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiAnYWxsJyB8ICdub25lJyB7XG4gICAgY29uc3Qgc2NyaXB0cyA9IHRoaXMuZ2V0Rm9sZGVyU2NyaXB0cyhmb2xkZXJJZCwgdHlwZSk7XG5cbiAgICBpZiAoc2NyaXB0cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiAnbm9uZSc7XG4gICAgfVxuXG4gICAgY29uc3QgZW5hYmxlZENvdW50ID0gc2NyaXB0cy5maWx0ZXIoc2NyaXB0ID0+IHNjcmlwdC5lbmFibGVkKS5sZW5ndGg7XG5cbiAgICBpZiAoZW5hYmxlZENvdW50ID09PSAwKSB7XG4gICAgICByZXR1cm4gJ25vbmUnO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJ2FsbCc7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICog5LuO6ISa5pys5YWB6K645YiX6KGo5Lit5Yig6Zmk6KeS6ImyXG4gKiBAcGFyYW0gcGFyYW0wXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwdXJnZUVtYmVkZGVkU2NyaXB0cyh7IGNoYXJhY3RlciB9OiB7IGNoYXJhY3RlcjogYW55IH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgYXZhdGFyID0gY2hhcmFjdGVyPy5jaGFyYWN0ZXI/LmF2YXRhcjtcbiAgY29uc3QgY2hhcmFjdGVyc1dpdGhTY3JpcHRzID0gZ2V0U2V0dGluZ1ZhbHVlKCdzY3JpcHQuY2hhcmFjdGVyc193aXRoX3NjcmlwdHMnKSB8fCBbXTtcbiAgaWYgKGF2YXRhcikge1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGBBbGVydFNjcmlwdF8ke2F2YXRhcn1gKTtcbiAgICBpZiAoY2hhcmFjdGVyc1dpdGhTY3JpcHRzPy5pbmNsdWRlcyhhdmF0YXIpKSB7XG4gICAgICBjb25zdCBpbmRleCA9IGNoYXJhY3RlcnNXaXRoU2NyaXB0cy5pbmRleE9mKGF2YXRhcik7XG4gICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIGNoYXJhY3RlcnNXaXRoU2NyaXB0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdzY3JpcHQuY2hhcmFjdGVyc193aXRoX3NjcmlwdHMnLCBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/script_repository/data.ts\n")},"./src/component/script_repository/events.ts":
/*!***************************************************!*\
  !*** ./src/component/script_repository/events.ts ***!
  \***************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EventBus: () => (/* binding */ EventBus),\n/* harmony export */   ScriptRepositoryEventType: () => (/* binding */ ScriptRepositoryEventType),\n/* harmony export */   scriptEvents: () => (/* binding */ scriptEvents)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n/**\n * \n */\nvar ScriptRepositoryEventType;\n(function (ScriptRepositoryEventType) {\n    ScriptRepositoryEventType["SCRIPT_TOGGLE"] = "script_toggle";\n    ScriptRepositoryEventType["SCRIPT_RUN"] = "script_run";\n    ScriptRepositoryEventType["SCRIPT_STOP"] = "script_stop";\n    ScriptRepositoryEventType["SCRIPT_CREATE"] = "script_create";\n    ScriptRepositoryEventType["SCRIPT_UPDATE"] = "script_update";\n    ScriptRepositoryEventType["SCRIPT_DELETE"] = "script_delete";\n    ScriptRepositoryEventType["SCRIPT_MOVE"] = "script_move";\n    ScriptRepositoryEventType["SCRIPT_EDIT"] = "script_edit";\n    ScriptRepositoryEventType["FOLDER_CREATE"] = "folder_create";\n    ScriptRepositoryEventType["FOLDER_EDIT"] = "folder_edit";\n    ScriptRepositoryEventType["FOLDER_DELETE"] = "folder_delete";\n    ScriptRepositoryEventType["FOLDER_MOVE"] = "folder_move";\n    ScriptRepositoryEventType["FOLDER_SCRIPTS_TOGGLE"] = "folder_scripts_toggle";\n    ScriptRepositoryEventType["TYPE_TOGGLE"] = "type_toggle";\n    ScriptRepositoryEventType["BUTTON_ADD"] = "button_add";\n    ScriptRepositoryEventType["BUTTON_REMOVE"] = "button_remove";\n    ScriptRepositoryEventType["SCRIPT_IMPORT"] = "script_import";\n    ScriptRepositoryEventType["SCRIPT_EXPORT"] = "script_export";\n    //VARIABLE_EDIT = \'variable_edit\',\n    ScriptRepositoryEventType["ORDER_CHANGED"] = "order_changed";\n    ScriptRepositoryEventType["UI_REFRESH"] = "ui_refresh";\n    ScriptRepositoryEventType["UI_LOADED"] = "ui_loaded";\n})(ScriptRepositoryEventType || (ScriptRepositoryEventType = {}));\n\n/**\n * \n */\nclass EventBus {\n    static instance;\n    EVENT_NAMESPACE = \'script_repository_\';\n    activeListeners = new Map();\n    constructor() { }\n    /**\n     * \n     */\n    static getInstance() {\n        if (!EventBus.instance) {\n            EventBus.instance = new EventBus();\n        }\n        return EventBus.instance;\n    }\n    /**\n     * \n     * @param eventType \n     * @returns \n     */\n    getNamespacedEvent(eventType) {\n        return `${this.EVENT_NAMESPACE}${eventType}`;\n    }\n    /**\n     * \n     * @param eventType \n     * @param listener \n     */\n    on(eventType, listener) {\n        if (!this.activeListeners.has(eventType)) {\n            this.activeListeners.set(eventType, new Set());\n        }\n        this.activeListeners.get(eventType)?.add(listener);\n        const namespacedEvent = this.getNamespacedEvent(eventType);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(namespacedEvent, listener);\n    }\n    /**\n     * \n     * @param eventType \n     * @param listener \n     */\n    off(eventType, listener) {\n        const namespacedEvent = this.getNamespacedEvent(eventType);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(namespacedEvent, listener);\n        const listeners = this.activeListeners.get(eventType);\n        if (listeners) {\n            listeners.delete(listener);\n            if (listeners.size === 0) {\n                this.activeListeners.delete(eventType);\n            }\n        }\n    }\n    /**\n     * \n     * @param eventType \n     * @param data \n     */\n    emit(eventType, data) {\n        const namespacedEvent = this.getNamespacedEvent(eventType);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(namespacedEvent, data);\n    }\n    /**\n     * \n     */\n    clear() {\n        this.activeListeners.forEach((listeners, eventType) => {\n            const namespacedEvent = this.getNamespacedEvent(eventType);\n            listeners.forEach(listener => {\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(namespacedEvent, listener);\n            });\n        });\n        this.activeListeners.clear();\n    }\n    /**\n     * \n     */\n    static destroyInstance() {\n        if (EventBus.instance) {\n            EventBus.instance.clear();\n            EventBus.instance = undefined;\n        }\n    }\n}\nconst scriptEvents = EventBus.getInstance();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2V2ZW50cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0dBRUc7QUFDSCxJQUFZLHlCQThCWDtBQTlCRCxXQUFZLHlCQUF5QjtJQUNuQyw0REFBK0I7SUFDL0Isc0RBQXlCO0lBQ3pCLHdEQUEyQjtJQUMzQiw0REFBK0I7SUFDL0IsNERBQStCO0lBQy9CLDREQUErQjtJQUMvQix3REFBMkI7SUFDM0Isd0RBQTJCO0lBRTNCLDREQUErQjtJQUMvQix3REFBMkI7SUFDM0IsNERBQStCO0lBQy9CLHdEQUEyQjtJQUMzQiw0RUFBK0M7SUFFL0Msd0RBQTJCO0lBRTNCLHNEQUF5QjtJQUN6Qiw0REFBK0I7SUFFL0IsNERBQStCO0lBQy9CLDREQUErQjtJQUUvQixrQ0FBa0M7SUFFbEMsNERBQStCO0lBRS9CLHNEQUF5QjtJQUN6QixvREFBdUI7QUFDekIsQ0FBQyxFQTlCVyx5QkFBeUIsS0FBekIseUJBQXlCLFFBOEJwQztBQU9pRDtBQUVsRDs7R0FFRztBQUNJLE1BQU0sUUFBUTtJQUNYLE1BQU0sQ0FBQyxRQUFRLENBQVc7SUFDakIsZUFBZSxHQUFHLG9CQUFvQixDQUFDO0lBQ2hELGVBQWUsR0FBdUQsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUV4RixnQkFBdUIsQ0FBQztJQUV4Qjs7T0FFRztJQUNJLE1BQU0sQ0FBQyxXQUFXO1FBQ3ZCLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDdkIsUUFBUSxDQUFDLFFBQVEsR0FBRyxJQUFJLFFBQVEsRUFBRSxDQUFDO1FBQ3JDLENBQUM7UUFDRCxPQUFPLFFBQVEsQ0FBQyxRQUFRLENBQUM7SUFDM0IsQ0FBQztJQUVEOzs7O09BSUc7SUFDSyxrQkFBa0IsQ0FBQyxTQUFvQztRQUM3RCxPQUFPLEdBQUcsSUFBSSxDQUFDLGVBQWUsR0FBRyxTQUFTLEVBQUUsQ0FBQztJQUMvQyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLEVBQUUsQ0FBQyxTQUFvQyxFQUFFLFFBQXVCO1FBQ3JFLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDO1lBQ3pDLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxJQUFJLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDakQsQ0FBQztRQUNELElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUVuRCxNQUFNLGVBQWUsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDM0QsNERBQVcsQ0FBQyxFQUFFLENBQUMsZUFBZSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksR0FBRyxDQUFDLFNBQW9DLEVBQUUsUUFBdUI7UUFDdEUsTUFBTSxlQUFlLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzNELDREQUFXLENBQUMsY0FBYyxDQUFDLGVBQWUsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUV0RCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN0RCxJQUFJLFNBQVMsRUFBRSxDQUFDO1lBQ2QsU0FBUyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUMzQixJQUFJLFNBQVMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxFQUFFLENBQUM7Z0JBQ3pCLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxJQUFJLENBQUMsU0FBb0MsRUFBRSxJQUFVO1FBQzFELE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMzRCw0REFBVyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDMUMsQ0FBQztJQUVEOztPQUVHO0lBQ0ksS0FBSztRQUNWLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxFQUFFO1lBQ3BELE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUMzRCxTQUFTLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFO2dCQUMzQiw0REFBVyxDQUFDLGNBQWMsQ0FBQyxlQUFlLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDeEQsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDL0IsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLGVBQWU7UUFDM0IsSUFBSSxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDdEIsUUFBUSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUMxQixRQUFRLENBQUMsUUFBUSxHQUFHLFNBQWdDLENBQUM7UUFDdkQsQ0FBQztJQUNILENBQUM7Q0FDRjtBQUVNLE1BQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvZXZlbnRzLnRzP2I3ZjIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDohJrmnKzku5PlupPkuovku7bnsbvlnotcbiAqL1xuZXhwb3J0IGVudW0gU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSB7XG4gIFNDUklQVF9UT0dHTEUgPSAnc2NyaXB0X3RvZ2dsZScsXG4gIFNDUklQVF9SVU4gPSAnc2NyaXB0X3J1bicsXG4gIFNDUklQVF9TVE9QID0gJ3NjcmlwdF9zdG9wJyxcbiAgU0NSSVBUX0NSRUFURSA9ICdzY3JpcHRfY3JlYXRlJyxcbiAgU0NSSVBUX1VQREFURSA9ICdzY3JpcHRfdXBkYXRlJyxcbiAgU0NSSVBUX0RFTEVURSA9ICdzY3JpcHRfZGVsZXRlJyxcbiAgU0NSSVBUX01PVkUgPSAnc2NyaXB0X21vdmUnLFxuICBTQ1JJUFRfRURJVCA9ICdzY3JpcHRfZWRpdCcsXG5cbiAgRk9MREVSX0NSRUFURSA9ICdmb2xkZXJfY3JlYXRlJyxcbiAgRk9MREVSX0VESVQgPSAnZm9sZGVyX2VkaXQnLFxuICBGT0xERVJfREVMRVRFID0gJ2ZvbGRlcl9kZWxldGUnLFxuICBGT0xERVJfTU9WRSA9ICdmb2xkZXJfbW92ZScsXG4gIEZPTERFUl9TQ1JJUFRTX1RPR0dMRSA9ICdmb2xkZXJfc2NyaXB0c190b2dnbGUnLFxuXG4gIFRZUEVfVE9HR0xFID0gJ3R5cGVfdG9nZ2xlJyxcblxuICBCVVRUT05fQUREID0gJ2J1dHRvbl9hZGQnLFxuICBCVVRUT05fUkVNT1ZFID0gJ2J1dHRvbl9yZW1vdmUnLFxuXG4gIFNDUklQVF9JTVBPUlQgPSAnc2NyaXB0X2ltcG9ydCcsXG4gIFNDUklQVF9FWFBPUlQgPSAnc2NyaXB0X2V4cG9ydCcsXG5cbiAgLy9WQVJJQUJMRV9FRElUID0gJ3ZhcmlhYmxlX2VkaXQnLFxuXG4gIE9SREVSX0NIQU5HRUQgPSAnb3JkZXJfY2hhbmdlZCcsXG5cbiAgVUlfUkVGUkVTSCA9ICd1aV9yZWZyZXNoJyxcbiAgVUlfTE9BREVEID0gJ3VpX2xvYWRlZCcsXG59XG5cbi8qKlxuICog5LqL5Lu255uR5ZCs5Zmo57G75Z6LXG4gKi9cbmV4cG9ydCB0eXBlIEV2ZW50TGlzdGVuZXIgPSAoZGF0YTogYW55KSA9PiB2b2lkO1xuXG5pbXBvcnQgeyBldmVudFNvdXJjZSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG4vKipcbiAqIOS6i+S7tuaAu+e6v+exu++8jOeUqOS6jue7hOS7tumXtOmAmuS/oVxuICovXG5leHBvcnQgY2xhc3MgRXZlbnRCdXMge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogRXZlbnRCdXM7XG4gIHByaXZhdGUgcmVhZG9ubHkgRVZFTlRfTkFNRVNQQUNFID0gJ3NjcmlwdF9yZXBvc2l0b3J5Xyc7XG4gIHByaXZhdGUgYWN0aXZlTGlzdGVuZXJzOiBNYXA8U2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSwgU2V0PEV2ZW50TGlzdGVuZXI+PiA9IG5ldyBNYXAoKTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cblxuICAvKipcbiAgICog6I635Y+W5LqL5Lu25oC757q/5a6e5L6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IEV2ZW50QnVzIHtcbiAgICBpZiAoIUV2ZW50QnVzLmluc3RhbmNlKSB7XG4gICAgICBFdmVudEJ1cy5pbnN0YW5jZSA9IG5ldyBFdmVudEJ1cygpO1xuICAgIH1cbiAgICByZXR1cm4gRXZlbnRCdXMuaW5zdGFuY2U7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5bim5ZG95ZCN56m66Ze055qE5LqL5Lu25ZCN56ewXG4gICAqIEBwYXJhbSBldmVudFR5cGUg5LqL5Lu257G75Z6LXG4gICAqIEByZXR1cm5zIOW4puWRveWQjeepuumXtOeahOS6i+S7tuWQjeensFxuICAgKi9cbiAgcHJpdmF0ZSBnZXROYW1lc3BhY2VkRXZlbnQoZXZlbnRUeXBlOiBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYCR7dGhpcy5FVkVOVF9OQU1FU1BBQ0V9JHtldmVudFR5cGV9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiDmt7vliqDkuovku7bnm5HlkKzlmahcbiAgICogQHBhcmFtIGV2ZW50VHlwZSDkuovku7bnsbvlnotcbiAgICogQHBhcmFtIGxpc3RlbmVyIOebkeWQrOWZqOWHveaVsFxuICAgKi9cbiAgcHVibGljIG9uKGV2ZW50VHlwZTogU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSwgbGlzdGVuZXI6IEV2ZW50TGlzdGVuZXIpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYWN0aXZlTGlzdGVuZXJzLmhhcyhldmVudFR5cGUpKSB7XG4gICAgICB0aGlzLmFjdGl2ZUxpc3RlbmVycy5zZXQoZXZlbnRUeXBlLCBuZXcgU2V0KCkpO1xuICAgIH1cbiAgICB0aGlzLmFjdGl2ZUxpc3RlbmVycy5nZXQoZXZlbnRUeXBlKT8uYWRkKGxpc3RlbmVyKTtcblxuICAgIGNvbnN0IG5hbWVzcGFjZWRFdmVudCA9IHRoaXMuZ2V0TmFtZXNwYWNlZEV2ZW50KGV2ZW50VHlwZSk7XG4gICAgZXZlbnRTb3VyY2Uub24obmFtZXNwYWNlZEV2ZW50LCBsaXN0ZW5lcik7XG4gIH1cblxuICAvKipcbiAgICog56e76Zmk5LqL5Lu255uR5ZCs5ZmoXG4gICAqIEBwYXJhbSBldmVudFR5cGUg5LqL5Lu257G75Z6LXG4gICAqIEBwYXJhbSBsaXN0ZW5lciDnm5HlkKzlmajlh73mlbBcbiAgICovXG4gIHB1YmxpYyBvZmYoZXZlbnRUeXBlOiBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLCBsaXN0ZW5lcjogRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuICAgIGNvbnN0IG5hbWVzcGFjZWRFdmVudCA9IHRoaXMuZ2V0TmFtZXNwYWNlZEV2ZW50KGV2ZW50VHlwZSk7XG4gICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIobmFtZXNwYWNlZEV2ZW50LCBsaXN0ZW5lcik7XG5cbiAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLmFjdGl2ZUxpc3RlbmVycy5nZXQoZXZlbnRUeXBlKTtcbiAgICBpZiAobGlzdGVuZXJzKSB7XG4gICAgICBsaXN0ZW5lcnMuZGVsZXRlKGxpc3RlbmVyKTtcbiAgICAgIGlmIChsaXN0ZW5lcnMuc2l6ZSA9PT0gMCkge1xuICAgICAgICB0aGlzLmFjdGl2ZUxpc3RlbmVycy5kZWxldGUoZXZlbnRUeXBlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6Kem5Y+R5LqL5Lu2XG4gICAqIEBwYXJhbSBldmVudFR5cGUg5LqL5Lu257G75Z6LXG4gICAqIEBwYXJhbSBkYXRhIOS6i+S7tuaVsOaNrlxuICAgKi9cbiAgcHVibGljIGVtaXQoZXZlbnRUeXBlOiBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLCBkYXRhPzogYW55KTogdm9pZCB7XG4gICAgY29uc3QgbmFtZXNwYWNlZEV2ZW50ID0gdGhpcy5nZXROYW1lc3BhY2VkRXZlbnQoZXZlbnRUeXBlKTtcbiAgICBldmVudFNvdXJjZS5lbWl0KG5hbWVzcGFjZWRFdmVudCwgZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICog5riF56m65omA5pyJ5LqL5Lu255uR5ZCs5ZmoXG4gICAqL1xuICBwdWJsaWMgY2xlYXIoKTogdm9pZCB7XG4gICAgdGhpcy5hY3RpdmVMaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXJzLCBldmVudFR5cGUpID0+IHtcbiAgICAgIGNvbnN0IG5hbWVzcGFjZWRFdmVudCA9IHRoaXMuZ2V0TmFtZXNwYWNlZEV2ZW50KGV2ZW50VHlwZSk7XG4gICAgICBsaXN0ZW5lcnMuZm9yRWFjaChsaXN0ZW5lciA9PiB7XG4gICAgICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKG5hbWVzcGFjZWRFdmVudCwgbGlzdGVuZXIpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5hY3RpdmVMaXN0ZW5lcnMuY2xlYXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDplIDmr4Hkuovku7bmgLvnur/lrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZGVzdHJveUluc3RhbmNlKCk6IHZvaWQge1xuICAgIGlmIChFdmVudEJ1cy5pbnN0YW5jZSkge1xuICAgICAgRXZlbnRCdXMuaW5zdGFuY2UuY2xlYXIoKTtcbiAgICAgIEV2ZW50QnVzLmluc3RhbmNlID0gdW5kZWZpbmVkIGFzIHVua25vd24gYXMgRXZlbnRCdXM7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBzY3JpcHRFdmVudHMgPSBFdmVudEJ1cy5nZXRJbnN0YW5jZSgpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/script_repository/events.ts\n')},"./src/component/script_repository/index.ts":
/*!**************************************************!*\
  !*** ./src/component/script_repository/index.ts ***!
  \**************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ScriptRepositoryApp: () => (/* binding */ ScriptRepositoryApp),\n/* harmony export */   ScriptType: () => (/* reexport safe */ _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType),\n/* harmony export */   buildScriptRepository: () => (/* binding */ buildScriptRepository),\n/* harmony export */   buildScriptRepositoryOnExtension: () => (/* binding */ buildScriptRepositoryOnExtension),\n/* harmony export */   destroyScriptRepositoryOnExtension: () => (/* binding */ destroyScriptRepositoryOnExtension),\n/* harmony export */   removeScriptRepository: () => (/* binding */ removeScriptRepository)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/data */ \"./src/component/script_repository/data.ts\");\n/* harmony import */ var _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/events */ \"./src/component/script_repository/events.ts\");\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/script_repository/ui_controller */ \"./src/component/script_repository/ui_controller.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _component_script_repository_button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/component/script_repository/button */ \"./src/component/script_repository/button.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n\n\n\n\n\n\n\n\n\n\nconst load_events = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.event_types.CHAT_CHANGED];\nconst delete_events = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.event_types.CHARACTER_DELETED];\n/**\n *  - \n * ScriptManagerUIManager\n */\nclass ScriptRepositoryApp {\n    static instance;\n    scriptManager;\n    uiManager;\n    initialized = false;\n    constructor() {\n        this.scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_2__.ScriptManager.getInstance();\n        this.uiManager = _component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_4__.UIController.getInstance();\n        this.registerEvents();\n    }\n    /**\n     * \n     */\n    static getInstance() {\n        if (!ScriptRepositoryApp.instance) {\n            ScriptRepositoryApp.instance = new ScriptRepositoryApp();\n        }\n        return ScriptRepositoryApp.instance;\n    }\n    /**\n     * \n     */\n    static destroyInstance() {\n        if (ScriptRepositoryApp.instance) {\n            ScriptRepositoryApp.instance.cleanup();\n            ScriptRepositoryApp.instance = undefined;\n            _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_2__.ScriptManager.destroyInstance();\n            _component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_4__.UIController.destroyInstance();\n            _component_script_repository_data__WEBPACK_IMPORTED_MODULE_0__.ScriptData.destroyInstance();\n            (0,_component_script_repository_button__WEBPACK_IMPORTED_MODULE_6__.unbindQrEnabledChangeListener)();\n        }\n    }\n    /**\n     * \n     */\n    async initialize() {\n        if (this.initialized) {\n            return;\n        }\n        try {\n            await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.loadFileToDocument)(`/scripts/extensions/${_util_extension_variables__WEBPACK_IMPORTED_MODULE_5__.extensionFolderPath}/src/component/script_repository/public/style.css`, 'css');\n            await this.uiManager.initialize();\n            this.initialized = true;\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            this.initialized = false;\n        }\n    }\n    /**\n     * \n     */\n    registerEvents() {\n        load_events.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.eventSource.on(eventType, this.refreshCharacterRepository.bind(this));\n        });\n        delete_events.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.eventSource.on(eventType, (character) => (0,_component_script_repository_data__WEBPACK_IMPORTED_MODULE_0__.purgeEmbeddedScripts)({ character }));\n        });\n    }\n    /**\n     * \n     */\n    async refreshCharacterRepository() {\n        if (!this.initialized) {\n            return;\n        }\n        const previousCharacterScripts = [];\n        $(`#character-script-list`)\n            .find('.script-item')\n            .each((_index, element) => {\n            const $element = $(element);\n            const scriptId = $element.attr('id');\n            if (scriptId) {\n                const script = this.scriptManager.getScriptById(scriptId);\n                if (script) {\n                    previousCharacterScripts.push(script);\n                }\n            }\n        });\n        this.scriptManager.stopScriptsByType(previousCharacterScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        const scriptData = _component_script_repository_data__WEBPACK_IMPORTED_MODULE_0__.ScriptData.getInstance();\n        const globalScripts = this.scriptManager.getGlobalScripts();\n        const characterScripts = this.scriptManager.getCharacterScripts();\n        this.scriptManager.refreshCharacterScriptEnabledState();\n        console.info('[ScriptManager] ');\n        if (_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.this_chid && characterScripts.length > 0) {\n            await this.uiManager.checkEmbeddedScripts(_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.this_chid);\n        }\n        const conflictScripts = characterScripts.filter(charScript => globalScripts.some(globalScript => globalScript.id === charScript.id));\n        if (conflictScripts.length > 0) {\n            console.info(`[ScriptManager] ${conflictScripts.length}ID`);\n            for (const charScript of conflictScripts) {\n                const globalScript = globalScripts.find(gs => gs.id === charScript.id);\n                const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(` \"${globalScript.name}\" `, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.TEXT, '', {\n                    okButton: '',\n                    cancelButton: '',\n                });\n                charScript.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.uuidv4)();\n                if (result) {\n                    if (globalScript.enabled) {\n                        await this.scriptManager.stopScript(globalScript, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n                        globalScript.enabled = false;\n                        console.info(`[ScriptManager] : ${globalScript.name}`);\n                        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.UI_REFRESH, {\n                            action: 'script_toggle',\n                            script: globalScript,\n                            type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL,\n                            enable: false,\n                        });\n                        scriptData.saveGlobalScripts(globalScripts);\n                    }\n                }\n                else if (charScript.enabled) {\n                    charScript.enabled = false;\n                    await scriptData.saveCharacterScripts(characterScripts);\n                    console.info(`[ScriptManager] : ${charScript.name}`);\n                }\n            }\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.UI_REFRESH, { action: 'refresh_charact_scripts' });\n        (0,_component_script_repository_button__WEBPACK_IMPORTED_MODULE_6__.checkQrEnabledStatusAndAddButton)();\n        (0,_component_script_repository_button__WEBPACK_IMPORTED_MODULE_6__.bindQrEnabledChangeListener)();\n        await this.scriptManager.runScriptsByType(characterScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n    }\n    /**\n     * \n     */\n    async cleanup() {\n        try {\n            load_events.forEach(eventType => {\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.eventSource.removeListener(eventType, this.refreshCharacterRepository.bind(this));\n            });\n            await this.scriptManager.cleanup();\n            this.uiManager.cleanup();\n            this.initialized = false;\n            console.info('[ScriptManager] ');\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n        }\n    }\n}\n/**\n * \n */\nasync function buildScriptRepository() {\n    const app = ScriptRepositoryApp.getInstance();\n    await app.initialize();\n}\n/**\n * \n */\nasync function removeScriptRepository() {\n    ScriptRepositoryApp.destroyInstance();\n}\n/**\n * \n */\nasync function buildScriptRepositoryOnExtension() {\n    await buildScriptRepository();\n}\n/**\n * \n */\nfunction destroyScriptRepositoryOnExtension() {\n    removeScriptRepository();\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0Y7QUFDUztBQUNmO0FBQ1A7QUFDRTtBQUNWO0FBTW5CO0FBQzRCO0FBQ0E7QUFDRjtBQUN4RSxNQUFNLFdBQVcsR0FBRyxDQUFDLDREQUFXLENBQUMsWUFBWSxDQUFVLENBQUM7QUFDeEQsTUFBTSxhQUFhLEdBQUcsQ0FBQyw0REFBVyxDQUFDLGlCQUFpQixDQUFVLENBQUM7QUFFL0Q7OztHQUdHO0FBQ0ksTUFBTSxtQkFBbUI7SUFDdEIsTUFBTSxDQUFDLFFBQVEsQ0FBc0I7SUFDckMsYUFBYSxDQUFnQjtJQUM3QixTQUFTLENBQWU7SUFDeEIsV0FBVyxHQUFZLEtBQUssQ0FBQztJQUVyQztRQUNFLElBQUksQ0FBQyxhQUFhLEdBQUcseUZBQWEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNqRCxJQUFJLENBQUMsU0FBUyxHQUFHLG9GQUFZLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFNUMsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3hCLENBQUM7SUFFRDs7T0FFRztJQUNJLE1BQU0sQ0FBQyxXQUFXO1FBQ3ZCLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUNsQyxtQkFBbUIsQ0FBQyxRQUFRLEdBQUcsSUFBSSxtQkFBbUIsRUFBRSxDQUFDO1FBQzNELENBQUM7UUFDRCxPQUFPLG1CQUFtQixDQUFDLFFBQVEsQ0FBQztJQUN0QyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsZUFBZTtRQUMzQixJQUFJLG1CQUFtQixDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQ2pDLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUN2QyxtQkFBbUIsQ0FBQyxRQUFRLEdBQUcsU0FBMkMsQ0FBQztZQUMzRSx5RkFBYSxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQ2hDLG9GQUFZLENBQUMs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LElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUM7WUFFekIsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDekIsT0FBTyxDQUFDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1FBQ3ZDLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNoRCxDQUFDO0lBQ0gsQ0FBQztDQUNGO0FBRUQ7O0dBRUc7QUFDSSxLQUFLLFVBQVUscUJBQXFCO0lBQ3pDLE1BQU0sR0FBRyxHQUFHLG1CQUFtQixDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQzlDLE1BQU0sR0FBRyxDQUFDLFVBQVUsRUFBRSxDQUFDO0FBQ3pCLENBQUM7QUFFRDs7R0FFRztBQUNJLEtBQUssVUFBVSxzQkFBc0I7SUFDMUMsbUJBQW1CLENBQUMsZUFBZSxFQUFFLENBQUM7QUFDeEMsQ0FBQztBQUVEOztHQUVHO0FBQ0ksS0FBSyxVQUFVLGdDQUFnQztJQUNwRCxNQUFNLHFCQUFxQixFQUFFLENBQUM7QUFDaEMsQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyxrQ0FBa0M7SUFDaEQsc0JBQXNCLEVBQUUsQ0FBQztBQUMzQixDQUFDO0FBRXFCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9pbmRleC50cz8wMWEzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHB1cmdlRW1iZWRkZWRTY3JpcHRzLCBTY3JpcHREYXRhIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvZGF0YSc7XG5pbXBvcnQgeyBzY3JpcHRFdmVudHMsIFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9ldmVudHMnO1xuaW1wb3J0IHsgU2NyaXB0TWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyJztcbmltcG9ydCB7IFNjcmlwdCwgU2NyaXB0VHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3R5cGVzJztcbmltcG9ydCB7IFVJQ29udHJvbGxlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3VpX2NvbnRyb2xsZXInO1xuaW1wb3J0IHsgZXh0ZW5zaW9uRm9sZGVyUGF0aCB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHtcbiAgYmluZFFyRW5hYmxlZENoYW5nZUxpc3RlbmVyLFxuICBjaGVja1FyRW5hYmxlZFN0YXR1c0FuZEFkZEJ1dHRvbixcbiAgdW5iaW5kUXJFbmFibGVkQ2hhbmdlTGlzdGVuZXIsXG59IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2J1dHRvbic7XG5pbXBvcnQgeyBldmVudF90eXBlcywgZXZlbnRTb3VyY2UsIHRoaXNfY2hpZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgY2FsbEdlbmVyaWNQb3B1cCwgUE9QVVBfVFlQRSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3BvcHVwJztcbmltcG9ydCB7IGxvYWRGaWxlVG9Eb2N1bWVudCwgdXVpZHY0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuY29uc3QgbG9hZF9ldmVudHMgPSBbZXZlbnRfdHlwZXMuQ0hBVF9DSEFOR0VEXSBhcyBjb25zdDtcbmNvbnN0IGRlbGV0ZV9ldmVudHMgPSBbZXZlbnRfdHlwZXMuQ0hBUkFDVEVSX0RFTEVURURdIGFzIGNvbnN0O1xuXG4vKipcbiAqIOiEmuacrOS7k+W6k+W6lOeUqCAtIOS9v+eUqOS6i+S7tumpseWKqOaetuaehFxuICog6LSf6LSj5pW05ZCIU2NyaXB0TWFuYWdlcuWSjFVJTWFuYWdlcu+8jOaPkOS+m+e7n+S4gOeahOaOpeWPo1xuICovXG5leHBvcnQgY2xhc3MgU2NyaXB0UmVwb3NpdG9yeUFwcCB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBTY3JpcHRSZXBvc2l0b3J5QXBwO1xuICBwcml2YXRlIHNjcmlwdE1hbmFnZXI6IFNjcmlwdE1hbmFnZXI7XG4gIHByaXZhdGUgdWlNYW5hZ2VyOiBVSUNvbnRyb2xsZXI7XG4gIHByaXZhdGUgaW5pdGlhbGl6ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc2NyaXB0TWFuYWdlciA9IFNjcmlwdE1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICB0aGlzLnVpTWFuYWdlciA9IFVJQ29udHJvbGxlci5nZXRJbnN0YW5jZSgpO1xuXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluW6lOeUqOWunuS+i1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBTY3JpcHRSZXBvc2l0b3J5QXBwIHtcbiAgICBpZiAoIVNjcmlwdFJlcG9zaXRvcnlBcHAuaW5zdGFuY2UpIHtcbiAgICAgIFNjcmlwdFJlcG9zaXRvcnlBcHAuaW5zdGFuY2UgPSBuZXcgU2NyaXB0UmVwb3NpdG9yeUFwcCgpO1xuICAgIH1cbiAgICByZXR1cm4gU2NyaXB0UmVwb3NpdG9yeUFwcC5pbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDplIDmr4HlupTnlKjlrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZGVzdHJveUluc3RhbmNlKCk6IHZvaWQge1xuICAgIGlmIChTY3JpcHRSZXBvc2l0b3J5QXBwLmluc3RhbmNlKSB7XG4gICAgICBTY3JpcHRSZXBvc2l0b3J5QXBwLmluc3RhbmNlLmNsZWFudXAoKTtcbiAgICAgIFNjcmlwdFJlcG9zaXRvcnlBcHAuaW5zdGFuY2UgPSB1bmRlZmluZWQgYXMgdW5rbm93biBhcyBTY3JpcHRSZXBvc2l0b3J5QXBwO1xuICAgICAgU2NyaXB0TWFuYWdlci5kZXN0cm95SW5zdGFuY2UoKTtcbiAgICAgIFVJQ29udHJvbGxlci5kZXN0cm95SW5zdGFuY2UoKTtcbiAgICAgIFNjcmlwdERhdGEuZGVzdHJveUluc3RhbmNlKCk7XG4gICAgICB1bmJpbmRRckVuYWJsZWRDaGFuZ2VMaXN0ZW5lcigpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJblupTnlKhcbiAgICovXG4gIHB1YmxpYyBhc3luYyBpbml0aWFsaXplKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGxvYWRGaWxlVG9Eb2N1bWVudChcbiAgICAgICAgYC9zY3JpcHRzL2V4dGVuc2lvbnMvJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3B1YmxpYy9zdHlsZS5jc3NgLFxuICAgICAgICAnY3NzJyxcbiAgICAgICk7XG4gICAgICBhd2FpdCB0aGlzLnVpTWFuYWdlci5pbml0aWFsaXplKCk7XG4gICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOWIneWni+WMluWksei0pTonLCBlcnJvcik7XG4gICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOazqOWGjOS6i+S7tuebkeWQrFxuICAgKi9cbiAgcHJpdmF0ZSByZWdpc3RlckV2ZW50cygpOiB2b2lkIHtcbiAgICBsb2FkX2V2ZW50cy5mb3JFYWNoKGV2ZW50VHlwZSA9PiB7XG4gICAgICBldmVudFNvdXJjZS5vbihldmVudFR5cGUsIHRoaXMucmVmcmVzaENoYXJhY3RlclJlcG9zaXRvcnkuYmluZCh0aGlzKSk7XG4gICAgfSk7XG5cbiAgICBkZWxldGVfZXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICAgIGV2ZW50U291cmNlLm9uKGV2ZW50VHlwZSwgKGNoYXJhY3RlcjogYW55KSA9PiBwdXJnZUVtYmVkZGVkU2NyaXB0cyh7IGNoYXJhY3RlciB9KSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5Yi35paw6KeS6Imy6ISa5pys5bqTXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJlZnJlc2hDaGFyYWN0ZXJSZXBvc2l0b3J5KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBwcmV2aW91c0NoYXJhY3RlclNjcmlwdHM6IFNjcmlwdFtdID0gW107XG4gICAgJChgI2NoYXJhY3Rlci1zY3JpcHQtbGlzdGApXG4gICAgICAuZmluZCgnLnNjcmlwdC1pdGVtJylcbiAgICAgIC5lYWNoKChfaW5kZXgsIGVsZW1lbnQpID0+IHtcbiAgICAgICAgY29uc3QgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuICAgICAgICBjb25zdCBzY3JpcHRJZCA9ICRlbGVtZW50LmF0dHIoJ2lkJyk7XG4gICAgICAgIGlmIChzY3JpcHRJZCkge1xuICAgICAgICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRTY3JpcHRCeUlkKHNjcmlwdElkKTtcbiAgICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgICBwcmV2aW91c0NoYXJhY3RlclNjcmlwdHMucHVzaChzY3JpcHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgdGhpcy5zY3JpcHRNYW5hZ2VyLnN0b3BTY3JpcHRzQnlUeXBlKHByZXZpb3VzQ2hhcmFjdGVyU2NyaXB0cywgU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuXG4gICAgY29uc3Qgc2NyaXB0RGF0YSA9IFNjcmlwdERhdGEuZ2V0SW5zdGFuY2UoKTtcbiAgICBjb25zdCBnbG9iYWxTY3JpcHRzID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFNjcmlwdHMoKTtcbiAgICBjb25zdCBjaGFyYWN0ZXJTY3JpcHRzID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclNjcmlwdHMoKTtcblxuICAgIHRoaXMuc2NyaXB0TWFuYWdlci5yZWZyZXNoQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZFN0YXRlKCk7XG5cbiAgICBjb25zb2xlLmluZm8oJ1tTY3JpcHRNYW5hZ2VyXSDliLfmlrDop5LoibLohJrmnKzlupMnKTtcblxuICAgIGlmICh0aGlzX2NoaWQgJiYgY2hhcmFjdGVyU2NyaXB0cy5sZW5ndGggPiAwKSB7XG4gICAgICBhd2FpdCB0aGlzLnVpTWFuYWdlci5jaGVja0VtYmVkZGVkU2NyaXB0cyh0aGlzX2NoaWQpO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbmZsaWN0U2NyaXB0cyA9IGNoYXJhY3RlclNjcmlwdHMuZmlsdGVyKGNoYXJTY3JpcHQgPT5cbiAgICAgIGdsb2JhbFNjcmlwdHMuc29tZShnbG9iYWxTY3JpcHQgPT4gZ2xvYmFsU2NyaXB0LmlkID09PSBjaGFyU2NyaXB0LmlkKSxcbiAgICApO1xuXG4gICAgaWYgKGNvbmZsaWN0U2NyaXB0cy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLmluZm8oYFtTY3JpcHRNYW5hZ2VyXSDlj5HnjrAke2NvbmZsaWN0U2NyaXB0cy5sZW5ndGh95Liq6ISa5pysSUTlhrLnqoFgKTtcblxuICAgICAgZm9yIChjb25zdCBjaGFyU2NyaXB0IG9mIGNvbmZsaWN0U2NyaXB0cykge1xuICAgICAgICBjb25zdCBnbG9iYWxTY3JpcHQgPSBnbG9iYWxTY3JpcHRzLmZpbmQoZ3MgPT4gZ3MuaWQgPT09IGNoYXJTY3JpcHQuaWQpITtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKFxuICAgICAgICAgIGDlhajlsYDohJrmnKzkuK3lt7LlrZjlnKggXCIke2dsb2JhbFNjcmlwdC5uYW1lfVwiIOiEmuacrO+8jOaYr+WQpuWFs+mXreWGsueqgeiEmuacrO+8n2AsXG4gICAgICAgICAgUE9QVVBfVFlQRS5URVhULFxuICAgICAgICAgICcnLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIG9rQnV0dG9uOiAn5YWz6Zet5YWo5bGAJyxcbiAgICAgICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WFs+mXreWxgOmDqCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcblxuICAgICAgICBjaGFyU2NyaXB0LmlkID0gdXVpZHY0KCk7XG5cbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgIGlmIChnbG9iYWxTY3JpcHQuZW5hYmxlZCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLnN0b3BTY3JpcHQoZ2xvYmFsU2NyaXB0LCBTY3JpcHRUeXBlLkdMT0JBTCk7XG4gICAgICAgICAgICBnbG9iYWxTY3JpcHQuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc29sZS5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g5YWz6Zet5YWo5bGA6ISa5pysOiAke2dsb2JhbFNjcmlwdC5uYW1lfWApO1xuICAgICAgICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICAgICAgICAgIGFjdGlvbjogJ3NjcmlwdF90b2dnbGUnLFxuICAgICAgICAgICAgICBzY3JpcHQ6IGdsb2JhbFNjcmlwdCxcbiAgICAgICAgICAgICAgdHlwZTogU2NyaXB0VHlwZS5HTE9CQUwsXG4gICAgICAgICAgICAgIGVuYWJsZTogZmFsc2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNjcmlwdERhdGEuc2F2ZUdsb2JhbFNjcmlwdHMoZ2xvYmFsU2NyaXB0cyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGNoYXJTY3JpcHQuZW5hYmxlZCkge1xuICAgICAgICAgIGNoYXJTY3JpcHQuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgIGF3YWl0IHNjcmlwdERhdGEuc2F2ZUNoYXJhY3RlclNjcmlwdHMoY2hhcmFjdGVyU2NyaXB0cyk7XG4gICAgICAgICAgY29uc29sZS5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g5YWz6Zet5bGA6YOo6ISa5pysOiAke2NoYXJTY3JpcHQubmFtZX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwgeyBhY3Rpb246ICdyZWZyZXNoX2NoYXJhY3Rfc2NyaXB0cycgfSk7XG4gICAgY2hlY2tRckVuYWJsZWRTdGF0dXNBbmRBZGRCdXR0b24oKTtcbiAgICBiaW5kUXJFbmFibGVkQ2hhbmdlTGlzdGVuZXIoKTtcblxuICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5ydW5TY3JpcHRzQnlUeXBlKGNoYXJhY3RlclNjcmlwdHMsIFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbotYTmupBcbiAgICovXG4gIHB1YmxpYyBhc3luYyBjbGVhbnVwKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBsb2FkX2V2ZW50cy5mb3JFYWNoKGV2ZW50VHlwZSA9PiB7XG4gICAgICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50VHlwZSwgdGhpcy5yZWZyZXNoQ2hhcmFjdGVyUmVwb3NpdG9yeS5iaW5kKHRoaXMpKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIuY2xlYW51cCgpO1xuICAgICAgdGhpcy51aU1hbmFnZXIuY2xlYW51cCgpO1xuXG4gICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICBjb25zb2xlLmluZm8oJ1tTY3JpcHRNYW5hZ2VyXSDmuIXnkIblrozmiJAnKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOa4heeQhuWksei0pTonLCBlcnJvcik7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICog5p6E5bu66ISa5pys5bqT5bqU55SoXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZFNjcmlwdFJlcG9zaXRvcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGFwcCA9IFNjcmlwdFJlcG9zaXRvcnlBcHAuZ2V0SW5zdGFuY2UoKTtcbiAgYXdhaXQgYXBwLmluaXRpYWxpemUoKTtcbn1cblxuLyoqXG4gKiDnp7vpmaTohJrmnKzlupPlupTnlKhcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVNjcmlwdFJlcG9zaXRvcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gIFNjcmlwdFJlcG9zaXRvcnlBcHAuZGVzdHJveUluc3RhbmNlKCk7XG59XG5cbi8qKlxuICog5omp5bGV5byA5ZCv5pe25p6E5bu66ISa5pys5bqTXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZFNjcmlwdFJlcG9zaXRvcnlPbkV4dGVuc2lvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgYnVpbGRTY3JpcHRSZXBvc2l0b3J5KCk7XG59XG5cbi8qKlxuICog5omp5bGV5YWz6Zet5pe26ZSA5q+B6ISa5pys5bqTXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXN0cm95U2NyaXB0UmVwb3NpdG9yeU9uRXh0ZW5zaW9uKCk6IHZvaWQge1xuICByZW1vdmVTY3JpcHRSZXBvc2l0b3J5KCk7XG59XG5cbmV4cG9ydCB7IFNjcmlwdFR5cGUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/script_repository/index.ts\n")},"./src/component/script_repository/script_controller.ts":
/*!**************************************************************!*\
  !*** ./src/component/script_repository/script_controller.ts ***!
  \**************************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ScriptManager: () => (/* binding */ ScriptManager)\n/* harmony export */ });\n/* harmony import */ var _component_message_iframe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/message_iframe */ \"./src/component/message_iframe/index.ts\");\n/* harmony import */ var _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/data */ \"./src/component/script_repository/data.ts\");\n/* harmony import */ var _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/script_repository/events */ \"./src/component/script_repository/events.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _third_party_html__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/third_party.html */ \"./src/third_party.html\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n\n\n\n\n\n\n\n\n\nclass ScriptExecutor {\n    /**\n     * \n     * @param script \n     * @param type \n     */\n    async runScript(script, type) {\n        const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '' : '';\n        try {\n            const iframeElement = $('iframe').filter((_index, element) => $(element).attr('script-id') === script.id)[0];\n            if (iframeElement) {\n                await (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_0__.destroyIframe)(iframeElement);\n            }\n            const htmlContent = this.createScriptHtml(script);\n            const $iframe = $('<iframe>', {\n                style: 'display: none;',\n                id: `tavern-helper-script-${script.name}`,\n                srcdoc: htmlContent,\n                'script-id': script.id,\n            });\n            $iframe.on('load', () => {\n                console.info(`[ScriptManager] ${typeName}[\"${script.name}\"]`);\n            });\n            $('body').append($iframe);\n        }\n        catch (error) {\n            console.error(`[ScriptManager] ${typeName}:[\"${script.name}\"]`, error);\n            toastr.error(`${typeName}:[\"${script.name}\"]`);\n            throw error;\n        }\n    }\n    /**\n     * iframe\n     * @param script \n     * @param type \n     */\n    async stopScript(script, type) {\n        const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '' : '';\n        const iframeElement = $('iframe').filter((_index, element) => $(element).attr('script-id') === script.id)[0];\n        if (iframeElement) {\n            await (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_0__.destroyIframe)(iframeElement);\n            console.info(`[ScriptManager] ${typeName}[\"${script.name}\"]`);\n        }\n    }\n    /**\n     * HTML\n     * @param script \n     * @returns HTML\n     */\n    createScriptHtml(script) {\n        return `\n      <html>\n      <head>\n        ${_third_party_html__WEBPACK_IMPORTED_MODULE_5__[\"default\"]}\n        <script>\n          (function ($) {\n            var original$ = $;\n            window.$ = function (selector, context) {\n              if (context === undefined || context === null) {\n                if (window.parent && window.parent.document) {\n                  context = window.parent.document;\n                } else {\n                  console.warn(' window.parent.document iframe  document ');\n                  context = window.document;\n                }\n              }\n              return original$(selector, context);\n            };\n          })(jQuery);\n\n          SillyTavern = window.parent.SillyTavern.getContext();\n          TavernHelper = window.parent.TavernHelper;\n          for (const key in TavernHelper) {\n            window[key] = TavernHelper[key];\n          }\n        <\/script>\n        <script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_4__.script_url.get('iframe_client')}\"><\/script>\n      </head>\n      <body>\n        <script type=\"module\">\n          ${script.content}\n        <\/script>\n      </body>\n      </html>\n    `;\n    }\n    /**\n     * iframe\n     */\n    async clearAllScriptsIframe() {\n        const $iframes = $('iframe[id^=\"tavern-helper-script-\"]');\n        for (const iframe of $iframes) {\n            await (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_0__.destroyIframe)(iframe);\n        }\n    }\n}\nclass ScriptManager {\n    static instance;\n    scriptData;\n    executor;\n    constructor() {\n        this.scriptData = _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__.ScriptData.getInstance();\n        this.executor = new ScriptExecutor();\n        this.registerEventListeners();\n    }\n    /**\n     * \n     */\n    static getInstance() {\n        if (!ScriptManager.instance) {\n            ScriptManager.instance = new ScriptManager();\n        }\n        return ScriptManager.instance;\n    }\n    /**\n     * \n     */\n    static destroyInstance() {\n        if (ScriptManager.instance) {\n            ScriptManager.instance = undefined;\n        }\n    }\n    /**\n     * \n     */\n    registerEventListeners() {\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_TOGGLE, async (data) => {\n            const { script, type, enable, userInput = true } = data;\n            await this.toggleScript(script, type, enable, userInput);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.TYPE_TOGGLE, async (data) => {\n            const { type, enable, userInput = true } = data;\n            await this.toggleScriptType(type, enable, userInput);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_IMPORT, async (data) => {\n            const { file, type } = data;\n            await this.importScript(file, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_DELETE, async (data) => {\n            const { scriptId, type } = data;\n            await this.deleteScript(scriptId, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_CREATE, async (data) => {\n            const { script, type } = data;\n            await this.createScript(script, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_UPDATE, async (data) => {\n            const { script, type } = data;\n            await this.updateScript(script, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_MOVE, async (data) => {\n            const { script, fromType } = data;\n            await this.moveScript(script, fromType);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_MOVE, async (data) => {\n            const { folderId, fromType } = data;\n            await this.moveFolder(folderId, fromType);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.ORDER_CHANGED, async (data) => {\n            const { data: orderData, type } = data;\n            await this.saveOrder(orderData, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_LOADED, async () => {\n            if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.getSettingValue)('enabled_extension')) {\n                return;\n            }\n            const globalScripts = this.scriptData.getGlobalScripts();\n            const characterScripts = this.scriptData.getCharacterScripts();\n            if (this.scriptData.isGlobalScriptEnabled) {\n                await this.runScriptsByType(globalScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n            }\n            else {\n                console.info('[ScriptManager] ');\n            }\n            if (this.scriptData.isCharacterScriptEnabled) {\n                await this.runScriptsByType(characterScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n            }\n            else {\n                console.info('[ScriptManager] ');\n            }\n        });\n    }\n    /**\n     * \n     * @param script \n     * @param type \n     * @param enable \n     * @param userInput \n     */\n    async toggleScript(script, type, enable, userInput = true) {\n        if (userInput) {\n            script.enabled = enable;\n            await this.scriptData.saveScript(script, type);\n        }\n        try {\n            if (enable) {\n                if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && !this.scriptData.isGlobalScriptEnabled) {\n                    console.info(`[script_manager] [\"${script.name}\"]`);\n                    return;\n                }\n                if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && !this.scriptData.isCharacterScriptEnabled) {\n                    console.info(`[script_manager] [\"${script.name}\"]`);\n                    return;\n                }\n                await this.runScript(script, type);\n            }\n            else {\n                await this.stopScript(script, type);\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                action: 'script_toggle',\n                script,\n                type,\n                enable,\n            });\n        }\n        catch (error) {\n            console.error(`[ScriptManager] : ${script.name}`, error);\n            toastr.error(`: ${script.name}`);\n        }\n    }\n    /**\n     * \n     * @param type \n     * @param enable \n     * @param userInput \n     */\n    async toggleScriptType(type, enable, userInput = true) {\n        if (userInput) {\n            await this.scriptData.updateScriptTypeEnableState(type, enable);\n        }\n        try {\n            const scripts = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.scriptData.getGlobalScripts() : this.scriptData.getCharacterScripts();\n            if (enable) {\n                await this.runScriptsByType(scripts, type);\n            }\n            else {\n                await this.stopScriptsByType(scripts, type);\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                action: 'type_toggle',\n                type,\n                enable,\n            });\n        }\n        catch (error) {\n            console.error(`[ScriptManager] : ${type}`, error);\n            toastr.error(`: ${type}`);\n        }\n    }\n    /**\n     * \n     * @param script \n     * @param type \n     */\n    async runScript(script, type) {\n        if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.getSettingValue)('enabled_extension')) {\n            toastr.error('[ScriptManager] ');\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && !this.scriptData.isGlobalScriptEnabled) {\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && !this.scriptData.isCharacterScriptEnabled) {\n            return;\n        }\n        await this.executor.runScript(script, type);\n        if (script.buttons && script.buttons.length > 0) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_ADD, { script });\n        }\n    }\n    /**\n     * \n     * @param script \n     * @param type \n     */\n    async stopScript(script, type) {\n        await this.executor.stopScript(script, type);\n        if (script.buttons && script.buttons.length > 0) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n        }\n    }\n    /**\n     * \n     * @param scripts \n     * @param type \n     */\n    async runScriptsByType(scripts, type) {\n        if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.getSettingValue)('enabled_extension')) {\n            toastr.error('[ScriptManager] ');\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && !this.scriptData.isGlobalScriptEnabled) {\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && !this.scriptData.isCharacterScriptEnabled) {\n            return;\n        }\n        const enabledScripts = scripts.filter(script => script.enabled);\n        for (const script of enabledScripts) {\n            await this.executor.runScript(script, type);\n            if (script.buttons && script.buttons.length > 0) {\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_ADD, { script });\n            }\n        }\n    }\n    /**\n     * \n     * @param scripts \n     * @param type \n     */\n    async stopScriptsByType(scripts, type) {\n        const enabledScripts = scripts.filter(script => script.enabled);\n        for (const script of enabledScripts) {\n            await this.executor.stopScript(script, type);\n            if (script.buttons && script.buttons.length > 0) {\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n            }\n        }\n    }\n    /**\n     * \n     * @param file \n     * @param type \n     */\n    async importScript(file, type) {\n        try {\n            if (file.name.toLowerCase().endsWith('.zip')) {\n                await this.importFromZip(file, type);\n            }\n            else if (file.name.toLowerCase().endsWith('.json')) {\n                const content = await this.readFileAsText(file);\n                const importData = JSON.parse(content);\n                if (Array.isArray(importData)) {\n                    await this.importMultipleItems(importData, type);\n                }\n                else {\n                    await this.importSingleScript(importData, type);\n                }\n            }\n            else {\n                throw new Error(' .json  .zip ');\n            }\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            toastr.error(`: ${error instanceof Error ? error.message : ''}`);\n        }\n    }\n    /**\n     * ZIP\n     * @param file ZIP\n     * @param type \n     */\n    async importFromZip(file, type) {\n        //@ts-ignore\n        if (!window.JSZip) {\n            console.log('import jszip');\n            await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @sillytavern/lib/jszip.min.js */ \"@sillytavern/lib/jszip.min.js\"));\n        }\n        //@ts-ignore\n        const zip = new JSZip();\n        const zipContent = await zip.loadAsync(file);\n        let importedScripts = 0;\n        let importedFolders = 0;\n        const folders = new Set();\n        const rootScripts = [];\n        for (const fileName in zipContent.files) {\n            const file = zipContent.files[fileName];\n            if (!file.dir && fileName.endsWith('.json')) {\n                const pathParts = fileName.split('/');\n                if (pathParts.length === 1) {\n                    rootScripts.push(fileName);\n                }\n                else if (pathParts.length === 2) {\n                    folders.add(pathParts[0]);\n                }\n            }\n        }\n        for (const fileName of rootScripts) {\n            const file = zipContent.files[fileName];\n            const scriptContent = await file.async('string');\n            const scriptData = JSON.parse(scriptContent);\n            if (scriptData.name && 'content' in scriptData) {\n                const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                    ...scriptData,\n                    enabled: false,\n                });\n                await this.handleScriptImport(script, type);\n                importedScripts++;\n            }\n        }\n        for (const folderName of folders) {\n            const folderScriptCount = await this.importFolderFromZipNew(zipContent, folderName, type);\n            importedScripts += folderScriptCount;\n            importedFolders++;\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? 'refresh_global_scripts' : 'refresh_charact_scripts',\n        });\n        toastr.success(` ${importedScripts}  ${importedFolders} `);\n    }\n    /**\n     * ZIP\n     * @param zipContent ZIP\n     * @param folderName \n     * @param type \n     * @returns \n     */\n    async importFolderFromZipNew(zipContent, folderName, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptData.getGlobalRepositoryItems()\n            : this.scriptData.getCharacterRepositoryItems();\n        let finalFolderName = folderName;\n        let counter = 1;\n        while (repository.some(item => item.type === 'folder' && item.name === finalFolderName)) {\n            finalFolderName = `${folderName}_${counter}`;\n            counter++;\n        }\n        const folderId = await this.scriptData.createFolder(finalFolderName, type);\n        let folderScriptCount = 0;\n        for (const fileName in zipContent.files) {\n            const file = zipContent.files[fileName];\n            if (!file.dir && fileName.startsWith(`${folderName}/`) && fileName.endsWith('.json')) {\n                const scriptContent = await file.async('string');\n                const scriptData = JSON.parse(scriptContent);\n                if (scriptData.name && 'content' in scriptData) {\n                    const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                        ...scriptData,\n                        enabled: false,\n                    });\n                    await this.handleScriptImport(script, type);\n                    await this.scriptData.moveScriptToFolder(script.id, folderId, type);\n                    folderScriptCount++;\n                }\n            }\n        }\n        return folderScriptCount;\n    }\n    /**\n     * \n     * @param scriptData \n     * @param type \n     */\n    async importSingleScript(scriptData, type) {\n        if (!scriptData.name || !('content' in scriptData)) {\n            throw new Error('');\n        }\n        const scriptToImport = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n            ...scriptData,\n            enabled: false,\n        });\n        await this.handleScriptImport(scriptToImport, type);\n        toastr.success(` '${scriptToImport.name}' `);\n    }\n    /**\n     * \n     * @param items \n     * @param type \n     */\n    async importMultipleItems(items, type) {\n        let importedCount = 0;\n        let folderCount = 0;\n        let scriptCount = 0;\n        for (const item of items) {\n            if (item.type === 'folder') {\n                await this.importFolder(item, type);\n                folderCount++;\n                importedCount++;\n            }\n            else if (item.type === 'script') {\n                const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                    ...item.value,\n                    enabled: false,\n                });\n                await this.handleScriptImport(script, type);\n                scriptCount++;\n                importedCount++;\n            }\n            else if (item.name && 'content' in item) {\n                const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                    ...item,\n                    enabled: false,\n                });\n                await this.handleScriptImport(script, type);\n                scriptCount++;\n                importedCount++;\n            }\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? 'refresh_global_scripts' : 'refresh_charact_scripts',\n        });\n        toastr.success(``);\n    }\n    /**\n     * \n     * @param folderData \n     * @param type \n     */\n    async importFolder(folderData, type) {\n        if (!folderData.name || !Array.isArray(folderData.value)) {\n            throw new Error('');\n        }\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptData.getGlobalRepositoryItems()\n            : this.scriptData.getCharacterRepositoryItems();\n        let folderName = folderData.name;\n        let counter = 1;\n        while (repository.some(item => item.type === 'folder' && item.name === folderName)) {\n            folderName = `${folderData.name}_${counter}`;\n            counter++;\n        }\n        const folderId = await this.scriptData.createFolder(folderName, type);\n        for (const scriptData of folderData.value) {\n            const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                ...scriptData,\n                enabled: false,\n            });\n            await this.handleScriptImport(script, type);\n            await this.scriptData.moveScriptToFolder(script.id, folderId, type);\n        }\n    }\n    /**\n     * \n     * @param script \n     * @param type \n     */\n    async handleScriptImport(script, type) {\n        const globalScripts = this.scriptData.getGlobalScripts();\n        const characterScripts = this.scriptData.getCharacterScripts();\n        const conflictInGlobal = globalScripts.find(s => s.id === script.id);\n        const conflictInCharacter = characterScripts.find(s => s.id === script.id);\n        let existingScript;\n        let conflictType;\n        if (conflictInGlobal) {\n            existingScript = conflictInGlobal;\n            conflictType = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL;\n        }\n        else if (conflictInCharacter) {\n            existingScript = conflictInCharacter;\n            conflictType = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER;\n        }\n        if (existingScript && conflictType) {\n            const action = await this.handleScriptIdConflict(script, existingScript, type, 'import');\n            switch (action) {\n                case 'new':\n                    script.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__.uuidv4)();\n                    await this.createScript(script, type);\n                    break;\n                case 'override':\n                    await this.deleteScript(existingScript.id, conflictType);\n                    await this.createScript(script, type);\n                    break;\n                case 'cancel':\n                    return;\n            }\n        }\n        else {\n            await this.createScript(script, type);\n        }\n    }\n    /**\n     *  - Promise\n     * @param file \n     * @returns \n     */\n    readFileAsText(file) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = e => resolve(e.target?.result);\n            reader.onerror = e => reject(e);\n            reader.readAsText(file);\n        });\n    }\n    /**\n     * \n     * @param script \n     * @param type \n     */\n    async createScript(script, type) {\n        await this.scriptData.saveScript(script, type);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_create',\n            script,\n            type,\n        });\n    }\n    /**\n     * \n     * @param script \n     * @param type \n     */\n    async updateScript(script, type) {\n        await this.scriptData.saveScript(script, type);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_update',\n            script,\n            type,\n        });\n    }\n    /**\n     *  - \n     * @param repositoryItems \n     * @param type \n     */\n    async saveOrder(repositoryItems, type) {\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL) {\n            await this.scriptData.saveGlobalRepositoryItems(repositoryItems);\n        }\n        else {\n            await this.scriptData.saveCharacterRepositoryItems(repositoryItems);\n        }\n        this.scriptData.loadScripts();\n    }\n    /**\n     * @deprecated  saveOrder \n     * \n     * @param scripts \n     * @param type \n     */\n    async saveScriptsOrder(scripts, type) {\n        console.warn('[ScriptManager] saveScriptsOrder  saveOrder ');\n        const repositoryItems = scripts.map(script => ({\n            type: 'script',\n            value: script,\n        }));\n        await this.saveOrder(repositoryItems, type);\n    }\n    /**\n     * @deprecated  saveOrder \n     * \n     * @param repositoryItems \n     * @param type \n     */\n    async saveRepositoryItemsOrder(repositoryItems, type) {\n        console.warn('[ScriptManager] saveRepositoryItemsOrder  saveOrder ');\n        await this.saveOrder(repositoryItems, type);\n    }\n    /**\n     * \n     * @param scriptId ID\n     * @param type \n     */\n    async deleteScript(scriptId, type) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            throw new Error('[ScriptManager] ');\n        }\n        await this.stopScript(script, type);\n        await this.scriptData.deleteScript(scriptId, type);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_delete',\n            scriptId,\n            type,\n        });\n    }\n    /**\n     * \n     * @param script \n     * @param fromType \n     */\n    async moveScript(script, fromType) {\n        await this.stopScript(script, fromType);\n        const targetType = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getOppositeScriptType)(fromType);\n        const existingScriptInTarget = this.scriptData.getScriptById(script.id);\n        const existingScriptType = existingScriptInTarget ? this.scriptData.getScriptType(existingScriptInTarget) : null;\n        if (existingScriptInTarget && existingScriptType === targetType) {\n            const action = await this.handleScriptIdConflict(script, existingScriptInTarget, targetType, 'move');\n            switch (action) {\n                case 'new':\n                    script.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__.uuidv4)();\n                    break;\n                case 'override':\n                    await this.deleteScript(existingScriptInTarget.id, targetType);\n                    break;\n                case 'cancel':\n                    return;\n            }\n        }\n        await this.scriptData.moveItemToOtherType({ type: 'script', id: script.id, value: script }, fromType);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_move',\n            script,\n            fromType,\n            targetType,\n        });\n        if (script.enabled &&\n            ((targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && this.scriptData.isGlobalScriptEnabled) ||\n                (targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && this.scriptData.isCharacterScriptEnabled))) {\n            await this.runScript(script, targetType);\n        }\n    }\n    /**\n     * \n     */\n    refreshCharacterScriptData() {\n        this.scriptData.getCharacterScripts();\n    }\n    /**\n     * \n     */\n    getGlobalScripts() {\n        return this.scriptData.getGlobalScripts();\n    }\n    /**\n     * \n     */\n    getCharacterScripts() {\n        return this.scriptData.getCharacterScripts();\n    }\n    /**\n     * \n     */\n    refreshCharacterScriptEnabledState() {\n        this.scriptData.refreshCharacterScriptEnabledState();\n    }\n    /**\n     * \n     */\n    get isGlobalScriptEnabled() {\n        return this.scriptData.isGlobalScriptEnabled;\n    }\n    /**\n     * \n     */\n    get isCharacterScriptEnabled() {\n        return this.scriptData.isCharacterScriptEnabled;\n    }\n    /**\n     * ID\n     * @param id ID\n     */\n    getScriptById(id) {\n        return this.scriptData.getScriptById(id);\n    }\n    /**\n     * \n     */\n    getGlobalRepositoryItems() {\n        return this.scriptData.getGlobalRepositoryItems();\n    }\n    /**\n     * \n     */\n    getCharacterRepositoryItems() {\n        return this.scriptData.getCharacterRepositoryItems();\n    }\n    /**\n     * \n     */\n    async createFolder(name, type, icon, color) {\n        return await this.scriptData.createFolder(name, type, icon, color);\n    }\n    /**\n     * \n     */\n    async editFolder(folderId, newName, type, newIcon, newColor) {\n        await this.scriptData.editFolder(folderId, newName, type, newIcon, newColor);\n    }\n    /**\n     * \n     */\n    async deleteFolder(folderId, type) {\n        await this.scriptData.deleteFolder(folderId, type);\n    }\n    /**\n     * \n     */\n    async moveScriptToFolder(scriptId, targetFolderId, type) {\n        await this.scriptData.moveScriptToFolder(scriptId, targetFolderId, type);\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param fromType \n     */\n    async moveFolder(folderId, fromType) {\n        const targetType = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getOppositeScriptType)(fromType);\n        await this.scriptData.moveItemToOtherType({ type: 'folder', id: folderId }, fromType);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'folder_move',\n            folderId,\n            fromType,\n            targetType,\n        });\n    }\n    /**\n     * \n     */\n    getFolderScripts(folderId, type) {\n        return this.scriptData.getFolderScripts(folderId, type);\n    }\n    /**\n     * \n     */\n    getRootScripts(type) {\n        return this.scriptData.getRootScripts(type);\n    }\n    /**\n     * \n     */\n    getFolders(type) {\n        return this.scriptData.getFolders(type);\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     * @param enable \n     */\n    async toggleFolderScripts(folderId, type, enable) {\n        try {\n            await this.scriptData.toggleFolderScripts(folderId, type, enable);\n            const scripts = this.scriptData.getFolderScripts(folderId, type);\n            const isTypeEnabled = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.scriptData.isGlobalScriptEnabled : this.scriptData.isCharacterScriptEnabled;\n            if (isTypeEnabled) {\n                for (const script of scripts) {\n                    if (enable && script.enabled) {\n                        await this.runScript(script, type);\n                    }\n                    else if (!enable) {\n                        await this.stopScript(script, type);\n                    }\n                }\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                action: 'folder_scripts_toggle',\n                folderId,\n                type,\n                enable,\n            });\n        }\n        catch (error) {\n            console.error(`[ScriptManager] : ${folderId}`, error);\n            toastr.error(``);\n        }\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     */\n    getFolderScriptsState(folderId, type) {\n        return this.scriptData.getFolderScriptsState(folderId, type);\n    }\n    /**\n     * \n     * @param scriptId ID\n     * @returns data\n     */\n    getScriptVariables(scriptId) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            console.warn(`[ScriptManager] : ${scriptId}`);\n            return {};\n        }\n        return script.data || {};\n    }\n    /**\n     * \n     * @param scriptId ID\n     * @param variables \n     * @param type \n     * @returns \n     */\n    async updateScriptVariables(scriptId, variables, type) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            console.warn(`[ScriptManager] : ${scriptId}`);\n            return false;\n        }\n        script.data = variables;\n        await this.scriptData.saveScript(script, type);\n        console.info(`[ScriptManager] : ${script.name}`);\n        return true;\n    }\n    /**\n     * \n     * @param type \n     * @returns \n     */\n    getAllScriptVariables(type) {\n        const scripts = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.scriptData.getGlobalScripts() : this.scriptData.getCharacterScripts();\n        const variablesMap = new Map();\n        scripts.forEach(script => {\n            if (script.data && Object.keys(script.data).length > 0) {\n                variablesMap.set(script.id, script.data);\n            }\n        });\n        return variablesMap;\n    }\n    /**\n     * \n     */\n    async cleanup() {\n        await this.executor.clearAllScriptsIframe();\n    }\n    /**\n     * ID\n     * @param script \n     * @param existingScript \n     * @param targetType \n     * @param operationType 'import' - , 'move' - \n     * @returns 'new' - ID, 'override' - , 'cancel' - \n     */\n    async handleScriptIdConflict(script, existingScript, targetType, operationType = 'import') {\n        const existingScriptType = this.scriptData.getScriptType(existingScript);\n        const existingTypeText = existingScriptType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '' : '';\n        const targetTypeText = targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '' : '';\n        let message;\n        if (operationType === 'import') {\n            message = ` '${script.name}' ${existingTypeText} '${existingScript.name}' id `;\n        }\n        else {\n            message = `${targetTypeText} '${script.name}'  '${existingScript.name}' id `;\n        }\n        const input = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_7__.callGenericPopup)(message, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_7__.POPUP_TYPE.TEXT, '', {\n            okButton: '',\n            cancelButton: '',\n            customButtons: [''],\n        });\n        let action = 'cancel';\n        switch (input) {\n            case 0:\n                action = 'cancel';\n                break;\n            case 1:\n                action = 'override';\n                break;\n            case 2:\n                action = 'new';\n                break;\n        }\n        return action;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBMkQ7QUFDSztBQUMrQjtBQU9sRDtBQUNIO0FBQ0c7QUFDZ0I7QUFDYTtBQUN0QjtBQUVwRCxNQUFNLGNBQWM7SUFDbEI7Ozs7T0FJRztJQUNILEtBQUssQ0FBQyxTQUFTLENBQUMsTUFBYyxFQUFFLElBQWdCO1FBQzlDLE1BQU0sUUFBUSxHQUFHLElBQUksS0FBSywwRUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7UUFFMUQsSUFBSSxDQUFDO1lBQ0gsTUFBTSxhQUFhLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FDdEMsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLE1BQU0sQ0FBQyxFQUFFLENBQ2hFLENBQUMsQ0FBQyxDQUFrQixDQUFDO1lBRXRCLElBQUksYUFBYSxFQUFFLENBQUM7Z0JBQ2xCLE1BQU0sd0VBQWEsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUNyQyxDQUFDO1lBRUQsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRWxELE1BQU0sT0FBTyxHQUFHLENBQUMsQ0FBQyxVQUFVLEVBQUU7Z0JBQzVCLEtBQUssRUFBRSxnQkFBZ0I7Z0JBQ3ZCLEVBQUUsRUFBRSx3QkFBd0IsTUFBTSxDQUFDLElBQUksRUFBRTtnQkFDekMsTUFBTSxFQUFFLFdBQVc7Z0JBQ25CLFdBQVcsRUFBRSxNQUFNLENBQUMsRUFBRTthQUN2QixDQUFDLENBQUM7WUFFSCxPQUFPLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUU7Z0JBQ3RCLE9BQU8sQ0FBQyxJQUFJLENBQUMscUJB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LEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQztZQUM5QixNQUFNLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3hDLENBQUMsQ0FBQyxDQUFDO1FBRUgsNkVBQVksQ0FBQyxFQUFFLENBQUMsMEZBQXlCLENBQUMsYUFBYSxFQUFFLEtBQUssRUFBQyxJQUFJLEVBQUMsRUFBRTtZQUNwRSxNQUFNLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQztZQUM5QixNQUFNLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3hDLENBQUMsQ0FBQyxDQUFDO1FBRUgsNkVBQVksQ0FBQyxFQUFFLENBQUMsMEZBQXlCLENBQUMsV0FBVyxFQUFFLEtBQUssRUFBQyxJQUFJLEVBQUMsRUFBRTtZQUNsRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxHQUFHLElBQUksQ0FBQztZQUNsQyxNQUFNLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQzFDLENBQUMsQ0FBQyxDQUFDO1FBRUgsNkVBQVksQ0FBQyxFQUFFLENBQUMsMEZBQXlCLENBQUMsV0FBVyxFQUFFLEtBQUssRUFBQyxJQUFJLEVBQUMsRUFBRTtZQUNsRSxNQUFNLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxHQUFHLElBQUksQ0FBQztZQUNwQyxNQUFNLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQzVDLENBQUMsQ0FBQyxDQUFDO1FBRUgsNkVBQVksQ0FBQyxFQUFFLENBQUMsMEZBQXlCLENBQUMsYUFBYSxFQUFFLEtBQUssRUFBQyxJQUFJLEVBQUMsRUFBRTtZQUNwRSxNQUFNLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsR0FBRyxJQUFJLENBQUM7WUFDdkMsTUFBTSxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsRUFBRSxJQUFJ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QUN4RyxDQUFDO1FBRUQsTUFBTSxLQUFLLEdBQUcsTUFBTSw0RUFBZ0IsQ0FBQyxPQUFPLEVBQUUsa0VBQVUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxFQUFFO1lBQ2pFLFFBQVEsRUFBRSxPQUFPO1lBQ2pCLFlBQVksRUFBRSxJQUFJO1lBQ2xCLGFBQWEsRUFBRSxDQUFDLE1BQU0sQ0FBQztTQUN4QixDQUFDLENBQUM7UUFFSCxJQUFJLE1BQU0sR0FBa0MsUUFBUSxDQUFDO1FBRXJELFFBQVEsS0FBSyxFQUFFLENBQUM7WUFDZCxLQUFLLENBQUM7Z0JBQ0osTUFBTSxHQUFHLFFBQVEsQ0FBQztnQkFDbEIsTUFBTTtZQUNSLEtBQUssQ0FBQztnQkFDSixNQUFNLEdBQUcsVUFBVSxDQUFDO2dCQUNwQixNQUFNO1lBQ1IsS0FBSyxDQUFDO2dCQUNKLE1BQU0sR0FBRyxLQUFLLENBQUM7Z0JBQ2YsTUFBTTtRQUNWLENBQUM7UUFFRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyLnRzP2ZlMGMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVzdHJveUlmcmFtZSB9IGZyb20gJ0AvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lJztcbmltcG9ydCB7IFNjcmlwdERhdGEgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9kYXRhJztcbmltcG9ydCB7IHNjcmlwdEV2ZW50cywgU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2V2ZW50cyc7XG5pbXBvcnQge1xuICBnZXRPcHBvc2l0ZVNjcmlwdFR5cGUsXG4gIElGcmFtZUVsZW1lbnQsXG4gIFNjcmlwdCxcbiAgU2NyaXB0UmVwb3NpdG9yeUl0ZW0sXG4gIFNjcmlwdFR5cGUsXG59IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3R5cGVzJztcbmltcG9ydCB7IHNjcmlwdF91cmwgfSBmcm9tICdAL3NjcmlwdF91cmwnO1xuaW1wb3J0IHRoaXJkX3BhcnR5IGZyb20gJ0AvdGhpcmRfcGFydHkuaHRtbCc7XG5pbXBvcnQgeyBnZXRTZXR0aW5nVmFsdWUgfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5pbXBvcnQgeyBjYWxsR2VuZXJpY1BvcHVwLCBQT1BVUF9UWVBFIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG9wdXAnO1xuaW1wb3J0IHsgdXVpZHY0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuXG5jbGFzcyBTY3JpcHRFeGVjdXRvciB7XG4gIC8qKlxuICAgKiDliJvlu7rlubbov5DooYzljZXkuKrohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBhc3luYyBydW5TY3JpcHQoc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB0eXBlTmFtZSA9IHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJ+WFqOWxgCcgOiAn5bGA6YOoJztcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBpZnJhbWVFbGVtZW50ID0gJCgnaWZyYW1lJykuZmlsdGVyKFxuICAgICAgICAoX2luZGV4LCBlbGVtZW50KSA9PiAkKGVsZW1lbnQpLmF0dHIoJ3NjcmlwdC1pZCcpID09PSBzY3JpcHQuaWQsXG4gICAgICApWzBdIGFzIElGcmFtZUVsZW1lbnQ7XG5cbiAgICAgIGlmIChpZnJhbWVFbGVtZW50KSB7XG4gICAgICAgIGF3YWl0IGRlc3Ryb3lJZnJhbWUoaWZyYW1lRWxlbWVudCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGh0bWxDb250ZW50ID0gdGhpcy5jcmVhdGVTY3JpcHRIdG1sKHNjcmlwdCk7XG5cbiAgICAgIGNvbnN0ICRpZnJhbWUgPSAkKCc8aWZyYW1lPicsIHtcbiAgICAgICAgc3R5bGU6ICdkaXNwbGF5OiBub25lOycsXG4gICAgICAgIGlkOiBgdGF2ZXJuLWhlbHBlci1zY3JpcHQtJHtzY3JpcHQubmFtZX1gLFxuICAgICAgICBzcmNkb2M6IGh0bWxDb250ZW50LFxuICAgICAgICAnc2NyaXB0LWlkJzogc2NyaXB0LmlkLFxuICAgICAgfSk7XG5cbiAgICAgICRpZnJhbWUub24oJ2xvYWQnLCAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuaW5mbyhgW1NjcmlwdE1hbmFnZXJdIOWQr+eUqCR7dHlwZU5hbWV96ISa5pysW1wiJHtzY3JpcHQubmFtZX1cIl1gKTtcbiAgICAgIH0pO1xuXG4gICAgICAkKCdib2R5JykuYXBwZW5kKCRpZnJhbWUpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0gJHt0eXBlTmFtZX3ohJrmnKzlkK/nlKjlpLHotKU6W1wiJHtzY3JpcHQubmFtZX1cIl1gLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYCR7dHlwZU5hbWV96ISa5pys5ZCv55So5aSx6LSlOltcIiR7c2NyaXB0Lm5hbWV9XCJdYCk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5YGc5q2i5Y2V5Liq6ISa5pys77yM5bm26ZSA5q+BaWZyYW1lXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgYXN5bmMgc3RvcFNjcmlwdChzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHR5cGVOYW1lID0gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAn5YWo5bGAJyA6ICflsYDpg6gnO1xuXG4gICAgY29uc3QgaWZyYW1lRWxlbWVudCA9ICQoJ2lmcmFtZScpLmZpbHRlcihcbiAgICAgIChfaW5kZXgsIGVsZW1lbnQpID0+ICQoZWxlbWVudCkuYXR0cignc2NyaXB0LWlkJykgPT09IHNjcmlwdC5pZCxcbiAgICApWzBdIGFzIElGcmFtZUVsZW1lbnQ7XG5cbiAgICBpZiAoaWZyYW1lRWxlbWVudCkge1xuICAgICAgYXdhaXQgZGVzdHJveUlmcmFtZShpZnJhbWVFbGVtZW50KTtcbiAgICAgIGNvbnNvbGUuaW5mbyhgW1NjcmlwdE1hbmFnZXJdIOemgeeUqCR7dHlwZU5hbWV96ISa5pysW1wiJHtzY3JpcHQubmFtZX1cIl1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu66L+Q6KGM6ISa5pys55qESFRNTOWGheWuuVxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrOWvueixoVxuICAgKiBAcmV0dXJucyBIVE1M5YaF5a65XG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZVNjcmlwdEh0bWwoc2NyaXB0OiBTY3JpcHQpOiBzdHJpbmcge1xuICAgIHJldHVybiBgXG4gICAgICA8aHRtbD5cbiAgICAgIDxoZWFkPlxuICAgICAgICAke3RoaXJkX3BhcnR5fVxuICAgICAgICA8c2NyaXB0PlxuICAgICAgICAgIChmdW5jdGlvbiAoJCkge1xuICAgICAgICAgICAgdmFyIG9yaWdpbmFsJCA9ICQ7XG4gICAgICAgICAgICB3aW5kb3cuJCA9IGZ1bmN0aW9uIChzZWxlY3RvciwgY29udGV4dCkge1xuICAgICAgICAgICAgICBpZiAoY29udGV4dCA9PT0gdW5kZWZpbmVkIHx8IGNvbnRleHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LnBhcmVudCAmJiB3aW5kb3cucGFyZW50LmRvY3VtZW50KSB7XG4gICAgICAgICAgICAgICAgICBjb250ZXh0ID0gd2luZG93LnBhcmVudC5kb2N1bWVudDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCfml6Dms5Xorr/pl64gd2luZG93LnBhcmVudC5kb2N1bWVudO+8jOWwhuS9v+eUqOW9k+WJjSBpZnJhbWUg55qEIGRvY3VtZW50IOS9nOS4uuS4iuS4i+aWh+OAgicpO1xuICAgICAgICAgICAgICAgICAgY29udGV4dCA9IHdpbmRvdy5kb2N1bWVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsJChzZWxlY3RvciwgY29udGV4dCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0pKGpRdWVyeSk7XG5cbiAgICAgICAgICBTaWxseVRhdmVybiA9IHdpbmRvdy5wYXJlbnQuU2lsbHlUYXZlcm4uZ2V0Q29udGV4dCgpO1xuICAgICAgICAgIFRhdmVybkhlbHBlciA9IHdpbmRvdy5wYXJlbnQuVGF2ZXJuSGVscGVyO1xuICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIFRhdmVybkhlbHBlcikge1xuICAgICAgICAgICAgd2luZG93W2tleV0gPSBUYXZlcm5IZWxwZXJba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgIDwvc2NyaXB0PlxuICAgICAgICA8c2NyaXB0IHNyYz1cIiR7c2NyaXB0X3VybC5nZXQoJ2lmcmFtZV9jbGllbnQnKX1cIj48L3NjcmlwdD5cbiAgICAgIDwvaGVhZD5cbiAgICAgIDxib2R5PlxuICAgICAgICA8c2NyaXB0IHR5cGU9XCJtb2R1bGVcIj5cbiAgICAgICAgICAke3NjcmlwdC5jb250ZW50fVxuICAgICAgICA8L3NjcmlwdD5cbiAgICAgIDwvYm9keT5cbiAgICAgIDwvaHRtbD5cbiAgICBgO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4heeQhuaJgOacieiEmuacrGlmcmFtZVxuICAgKi9cbiAgYXN5bmMgY2xlYXJBbGxTY3JpcHRzSWZyYW1lKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0ICRpZnJhbWVzID0gJCgnaWZyYW1lW2lkXj1cInRhdmVybi1oZWxwZXItc2NyaXB0LVwiXScpO1xuICAgIGZvciAoY29uc3QgaWZyYW1lIG9mICRpZnJhbWVzKSB7XG4gICAgICBhd2FpdCBkZXN0cm95SWZyYW1lKGlmcmFtZSBhcyBJRnJhbWVFbGVtZW50KTtcbiAgICB9XG4gIH1cbn1cblxuXG5leHBvcnQgY2xhc3MgU2NyaXB0TWFuYWdlciB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBTY3JpcHRNYW5hZ2VyO1xuICBwcml2YXRlIHNjcmlwdERhdGE6IFNjcmlwdERhdGE7XG4gIHByaXZhdGUgZXhlY3V0b3I6IFNjcmlwdEV4ZWN1dG9yO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zY3JpcHREYXRhID0gU2NyaXB0RGF0YS5nZXRJbnN0YW5jZSgpO1xuICAgIHRoaXMuZXhlY3V0b3IgPSBuZXcgU2NyaXB0RXhlY3V0b3IoKTtcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bohJrmnKznrqHnkIblmajlrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogU2NyaXB0TWFuYWdlciB7XG4gICAgaWYgKCFTY3JpcHRNYW5hZ2VyLmluc3RhbmNlKSB7XG4gICAgICBTY3JpcHRNYW5hZ2VyLmluc3RhbmNlID0gbmV3IFNjcmlwdE1hbmFnZXIoKTtcbiAgICB9XG4gICAgcmV0dXJuIFNjcmlwdE1hbmFnZXIuaW5zdGFuY2U7XG4gIH1cblxuICAvKipcbiAgICog6ZSA5q+B6ISa5pys566h55CG5Zmo5a6e5L6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGRlc3Ryb3lJbnN0YW5jZSgpOiB2b2lkIHtcbiAgICBpZiAoU2NyaXB0TWFuYWdlci5pbnN0YW5jZSkge1xuICAgICAgU2NyaXB0TWFuYWdlci5pbnN0YW5jZSA9IHVuZGVmaW5lZCBhcyB1bmtub3duIGFzIFNjcmlwdE1hbmFnZXI7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOazqOWGjOS6i+S7tuebkeWQrOWZqFxuICAgKi9cbiAgcHJpdmF0ZSByZWdpc3RlckV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9UT0dHTEUsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyBzY3JpcHQsIHR5cGUsIGVuYWJsZSwgdXNlcklucHV0ID0gdHJ1ZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMudG9nZ2xlU2NyaXB0KHNjcmlwdCwgdHlwZSwgZW5hYmxlLCB1c2VySW5wdXQpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVFlQRV9UT0dHTEUsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyB0eXBlLCBlbmFibGUsIHVzZXJJbnB1dCA9IHRydWUgfSA9IGRhdGE7XG4gICAgICBhd2FpdCB0aGlzLnRvZ2dsZVNjcmlwdFR5cGUodHlwZSwgZW5hYmxlLCB1c2VySW5wdXQpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0lNUE9SVCwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IGZpbGUsIHR5cGUgfSA9IGRhdGE7XG4gICAgICBhd2FpdCB0aGlzLmltcG9ydFNjcmlwdChmaWxlLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9ERUxFVEUsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyBzY3JpcHRJZCwgdHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMuZGVsZXRlU2NyaXB0KHNjcmlwdElkLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9DUkVBVEUsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyBzY3JpcHQsIHR5cGUgfSA9IGRhdGE7XG4gICAgICBhd2FpdCB0aGlzLmNyZWF0ZVNjcmlwdChzY3JpcHQsIHR5cGUpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX1VQREFURSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHNjcmlwdCwgdHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMudXBkYXRlU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfTU9WRSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHNjcmlwdCwgZnJvbVR5cGUgfSA9IGRhdGE7XG4gICAgICBhd2FpdCB0aGlzLm1vdmVTY3JpcHQoc2NyaXB0LCBmcm9tVHlwZSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5GT0xERVJfTU9WRSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IGZvbGRlcklkLCBmcm9tVHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMubW92ZUZvbGRlcihmb2xkZXJJZCwgZnJvbVR5cGUpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuT1JERVJfQ0hBTkdFRCwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IGRhdGE6IG9yZGVyRGF0YSwgdHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZU9yZGVyKG9yZGVyRGF0YSwgdHlwZSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9MT0FERUQsIGFzeW5jICgpID0+IHtcbiAgICAgIGlmICghZ2V0U2V0dGluZ1ZhbHVlKCdlbmFibGVkX2V4dGVuc2lvbicpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZ2xvYmFsU2NyaXB0cyA9IHRoaXMuc2NyaXB0RGF0YS5nZXRHbG9iYWxTY3JpcHRzKCk7XG4gICAgICBjb25zdCBjaGFyYWN0ZXJTY3JpcHRzID0gdGhpcy5zY3JpcHREYXRhLmdldENoYXJhY3RlclNjcmlwdHMoKTtcblxuICAgICAgaWYgKHRoaXMuc2NyaXB0RGF0YS5pc0dsb2JhbFNjcmlwdEVuYWJsZWQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5ydW5TY3JpcHRzQnlUeXBlKGdsb2JhbFNjcmlwdHMsIFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuaW5mbygnW1NjcmlwdE1hbmFnZXJdIOWFqOWxgOiEmuacrOexu+Wei+acquWQr+eUqO+8jOi3s+i/h+i/kOihjOWFqOWxgOiEmuacrCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5zY3JpcHREYXRhLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCkge1xuICAgICAgICBhd2FpdCB0aGlzLnJ1blNjcmlwdHNCeVR5cGUoY2hhcmFjdGVyU2NyaXB0cywgU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5pbmZvKCdbU2NyaXB0TWFuYWdlcl0g6KeS6Imy6ISa5pys57G75Z6L5pyq5ZCv55So77yM6Lez6L+H6L+Q6KGM6KeS6Imy6ISa5pysJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5YiH5o2i6ISa5pys5ZCv55So54q25oCBXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKiBAcGFyYW0gdXNlcklucHV0IOaYr+WQpueUseeUqOaIt+i+k+WFpVxuICAgKi9cbiAgcHVibGljIGFzeW5jIHRvZ2dsZVNjcmlwdChcbiAgICBzY3JpcHQ6IFNjcmlwdCxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgIGVuYWJsZTogYm9vbGVhbixcbiAgICB1c2VySW5wdXQ6IGJvb2xlYW4gPSB0cnVlLFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodXNlcklucHV0KSB7XG4gICAgICBzY3JpcHQuZW5hYmxlZCA9IGVuYWJsZTtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5zYXZlU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGlmIChlbmFibGUpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMICYmICF0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkKSB7XG4gICAgICAgICAgY29uc29sZS5pbmZvKGBbc2NyaXB0X21hbmFnZXJdIOWFqOWxgOiEmuacrOexu+Wei+acquWQr+eUqO+8jOi3s+i/h+WQr+eUqOiEmuacrFtcIiR7c2NyaXB0Lm5hbWV9XCJdYCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkNIQVJBQ1RFUiAmJiAhdGhpcy5zY3JpcHREYXRhLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCkge1xuICAgICAgICAgIGNvbnNvbGUuaW5mbyhgW3NjcmlwdF9tYW5hZ2VyXSDop5LoibLohJrmnKznsbvlnovmnKrlkK/nlKjvvIzot7Pov4flkK/nlKjohJrmnKxbXCIke3NjcmlwdC5uYW1lfVwiXWApO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMucnVuU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhd2FpdCB0aGlzLnN0b3BTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICAgIH1cblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICAgIGFjdGlvbjogJ3NjcmlwdF90b2dnbGUnLFxuICAgICAgICBzY3JpcHQsXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGVuYWJsZSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0g5YiH5o2i6ISa5pys54q25oCB5aSx6LSlOiAke3NjcmlwdC5uYW1lfWAsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5YiH5o2i6ISa5pys54q25oCB5aSx6LSlOiAke3NjcmlwdC5uYW1lfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliIfmjaLohJrmnKznsbvlnovlkK/nlKjnirbmgIFcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55SoXG4gICAqIEBwYXJhbSB1c2VySW5wdXQg5piv5ZCm55Sx55So5oi36L6T5YWlXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdG9nZ2xlU2NyaXB0VHlwZSh0eXBlOiBTY3JpcHRUeXBlLCBlbmFibGU6IGJvb2xlYW4sIHVzZXJJbnB1dDogYm9vbGVhbiA9IHRydWUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodXNlcklucHV0KSB7XG4gICAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEudXBkYXRlU2NyaXB0VHlwZUVuYWJsZVN0YXRlKHR5cGUsIGVuYWJsZSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNjcmlwdHMgPVxuICAgICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuc2NyaXB0RGF0YS5nZXRHbG9iYWxTY3JpcHRzKCkgOiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuXG4gICAgICBpZiAoZW5hYmxlKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucnVuU2NyaXB0c0J5VHlwZShzY3JpcHRzLCB0eXBlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc3RvcFNjcmlwdHNCeVR5cGUoc2NyaXB0cywgdHlwZSk7XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgICBhY3Rpb246ICd0eXBlX3RvZ2dsZScsXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGVuYWJsZSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0g5YiH5o2i6ISa5pys57G75Z6L54q25oCB5aSx6LSlOiAke3R5cGV9YCwgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDliIfmjaLohJrmnKznsbvlnovnirbmgIHlpLHotKU6ICR7dHlwZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6L+Q6KGM5Y2V5Liq6ISa5pysXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIHJ1blNjcmlwdChzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghZ2V0U2V0dGluZ1ZhbHVlKCdlbmFibGVkX2V4dGVuc2lvbicpKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmianlsZXmnKrlkK/nlKgnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgJiYgIXRoaXMuc2NyaXB0RGF0YS5pc0dsb2JhbFNjcmlwdEVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuQ0hBUkFDVEVSICYmICF0aGlzLnNjcmlwdERhdGEuaXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy5leGVjdXRvci5ydW5TY3JpcHQoc2NyaXB0LCB0eXBlKTtcblxuICAgIGlmIChzY3JpcHQuYnV0dG9ucyAmJiBzY3JpcHQuYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkJVVFRPTl9BREQsIHsgc2NyaXB0IH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlgZzmraLljZXkuKrohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc3RvcFNjcmlwdChzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMuZXhlY3V0b3Iuc3RvcFNjcmlwdChzY3JpcHQsIHR5cGUpO1xuXG4gICAgaWYgKHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX1JFTU9WRSwgeyBzY3JpcHRJZDogc2NyaXB0LmlkIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDov5DooYzmjIflrprnsbvlnovnmoTmiYDmnInohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdHMg6ISa5pys5YiX6KGoXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIHJ1blNjcmlwdHNCeVR5cGUoc2NyaXB0czogU2NyaXB0W10sIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIWdldFNldHRpbmdWYWx1ZSgnZW5hYmxlZF9leHRlbnNpb24nKSkge1xuICAgICAgdG9hc3RyLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g6YWS6aaG5Yqp5omL5pyq5ZCv55So77yM5peg5rOV6L+Q6KGM6ISa5pysJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMICYmICF0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkNIQVJBQ1RFUiAmJiAhdGhpcy5zY3JpcHREYXRhLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGVuYWJsZWRTY3JpcHRzID0gc2NyaXB0cy5maWx0ZXIoc2NyaXB0ID0+IHNjcmlwdC5lbmFibGVkKTtcblxuICAgIGZvciAoY29uc3Qgc2NyaXB0IG9mIGVuYWJsZWRTY3JpcHRzKSB7XG4gICAgICBhd2FpdCB0aGlzLmV4ZWN1dG9yLnJ1blNjcmlwdChzY3JpcHQsIHR5cGUpO1xuXG4gICAgICBpZiAoc2NyaXB0LmJ1dHRvbnMgJiYgc2NyaXB0LmJ1dHRvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkJVVFRPTl9BREQsIHsgc2NyaXB0IH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlgZzmraLmjIflrprnsbvlnovnmoTmiYDmnInohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdHMg6ISa5pys5YiX6KGoXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIHN0b3BTY3JpcHRzQnlUeXBlKHNjcmlwdHM6IFNjcmlwdFtdLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZW5hYmxlZFNjcmlwdHMgPSBzY3JpcHRzLmZpbHRlcihzY3JpcHQgPT4gc2NyaXB0LmVuYWJsZWQpO1xuXG4gICAgZm9yIChjb25zdCBzY3JpcHQgb2YgZW5hYmxlZFNjcmlwdHMpIHtcbiAgICAgIGF3YWl0IHRoaXMuZXhlY3V0b3Iuc3RvcFNjcmlwdChzY3JpcHQsIHR5cGUpO1xuXG4gICAgICBpZiAoc2NyaXB0LmJ1dHRvbnMgJiYgc2NyaXB0LmJ1dHRvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkJVVFRPTl9SRU1PVkUsIHsgc2NyaXB0SWQ6IHNjcmlwdC5pZCB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5a+85YWl6ISa5pys5oiW5paH5Lu25aS5XG4gICAqIEBwYXJhbSBmaWxlIOiEmuacrOaWh+S7tuaIluaWh+S7tuWkueWvvOWHuuaWh+S7tlxuICAgKiBAcGFyYW0gdHlwZSDlr7zlhaXnm67moIfnsbvlnotcbiAgICovXG4gIHB1YmxpYyBhc3luYyBpbXBvcnRTY3JpcHQoZmlsZTogRmlsZSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoZmlsZS5uYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoJy56aXAnKSkge1xuICAgICAgICBhd2FpdCB0aGlzLmltcG9ydEZyb21aaXAoZmlsZSwgdHlwZSk7XG4gICAgICB9IGVsc2UgaWYgKGZpbGUubmFtZS50b0xvd2VyQ2FzZSgpLmVuZHNXaXRoKCcuanNvbicpKSB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnJlYWRGaWxlQXNUZXh0KGZpbGUpO1xuICAgICAgICBjb25zdCBpbXBvcnREYXRhID0gSlNPTi5wYXJzZShjb250ZW50KTtcblxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpbXBvcnREYXRhKSkge1xuICAgICAgICAgIGF3YWl0IHRoaXMuaW1wb3J0TXVsdGlwbGVJdGVtcyhpbXBvcnREYXRhLCB0eXBlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLmltcG9ydFNpbmdsZVNjcmlwdChpbXBvcnREYXRhLCB0eXBlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfkuI3mlK/mjIHnmoTmlofku7bmoLzlvI/vvIzor7fpgInmi6kgLmpzb24g5oiWIC56aXAg5paH5Lu2Jyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDlr7zlhaXlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDlr7zlhaXlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn5peg5pWI55qE5paH5Lu25qC85byPJ31gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5LuOWklQ5paH5Lu25a+85YWlXG4gICAqIEBwYXJhbSBmaWxlIFpJUOaWh+S7tlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW1wb3J0RnJvbVppcChmaWxlOiBGaWxlLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy9AdHMtaWdub3JlXG4gICAgaWYgKCF3aW5kb3cuSlNaaXApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdpbXBvcnQganN6aXAnKTtcbiAgICAgIGF3YWl0IGltcG9ydCgnQHNpbGx5dGF2ZXJuL2xpYi9qc3ppcC5taW4uanMnKTtcbiAgICB9XG4gICAgLy9AdHMtaWdub3JlXG4gICAgY29uc3QgemlwID0gbmV3IEpTWmlwKCk7XG4gICAgY29uc3QgemlwQ29udGVudCA9IGF3YWl0IHppcC5sb2FkQXN5bmMoZmlsZSk7XG5cbiAgICBsZXQgaW1wb3J0ZWRTY3JpcHRzID0gMDtcbiAgICBsZXQgaW1wb3J0ZWRGb2xkZXJzID0gMDtcblxuICAgIGNvbnN0IGZvbGRlcnMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICBjb25zdCByb290U2NyaXB0czogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBmb3IgKGNvbnN0IGZpbGVOYW1lIGluIHppcENvbnRlbnQuZmlsZXMpIHtcbiAgICAgIGNvbnN0IGZpbGUgPSB6aXBDb250ZW50LmZpbGVzW2ZpbGVOYW1lXTtcblxuICAgICAgaWYgKCFmaWxlLmRpciAmJiBmaWxlTmFtZS5lbmRzV2l0aCgnLmpzb24nKSkge1xuICAgICAgICBjb25zdCBwYXRoUGFydHMgPSBmaWxlTmFtZS5zcGxpdCgnLycpO1xuXG4gICAgICAgIGlmIChwYXRoUGFydHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgcm9vdFNjcmlwdHMucHVzaChmaWxlTmFtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAocGF0aFBhcnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgIGZvbGRlcnMuYWRkKHBhdGhQYXJ0c1swXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAgICAgZm9yIChjb25zdCBmaWxlTmFtZSBvZiByb290U2NyaXB0cykge1xuICAgICAgY29uc3QgZmlsZSA9IHppcENvbnRlbnQuZmlsZXNbZmlsZU5hbWVdO1xuICAgICAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGF3YWl0IGZpbGUuYXN5bmMoJ3N0cmluZycpO1xuICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IEpTT04ucGFyc2Uoc2NyaXB0Q29udGVudCk7XG5cbiAgICAgIGlmIChzY3JpcHREYXRhLm5hbWUgJiYgJ2NvbnRlbnQnIGluIHNjcmlwdERhdGEpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0ID0gbmV3IFNjcmlwdCh7XG4gICAgICAgICAgLi4uc2NyaXB0RGF0YSxcbiAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlU2NyaXB0SW1wb3J0KHNjcmlwdCwgdHlwZSk7XG4gICAgICAgIGltcG9ydGVkU2NyaXB0cysrO1xuICAgICAgfVxuICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IGZvbGRlck5hbWUgb2YgZm9sZGVycykge1xuICAgICAgY29uc3QgZm9sZGVyU2NyaXB0Q291bnQgPSBhd2FpdCB0aGlzLmltcG9ydEZvbGRlckZyb21aaXBOZXcoemlwQ29udGVudCwgZm9sZGVyTmFtZSwgdHlwZSk7XG4gICAgICBpbXBvcnRlZFNjcmlwdHMgKz0gZm9sZGVyU2NyaXB0Q291bnQ7XG4gICAgICBpbXBvcnRlZEZvbGRlcnMrKztcbiAgICB9XG5cbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHtcbiAgICAgIGFjdGlvbjogdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAncmVmcmVzaF9nbG9iYWxfc2NyaXB0cycgOiAncmVmcmVzaF9jaGFyYWN0X3NjcmlwdHMnLFxuICAgIH0pO1xuXG4gICAgdG9hc3RyLnN1Y2Nlc3MoYOaIkOWKn+WvvOWFpSAke2ltcG9ydGVkU2NyaXB0c30g5Liq6ISa5pys5ZKMICR7aW1wb3J0ZWRGb2xkZXJzfSDkuKrmlofku7blpLlgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDku45aSVDkuK3lr7zlhaXmlofku7blpLlcbiAgICogQHBhcmFtIHppcENvbnRlbnQgWklQ5YaF5a65XG4gICAqIEBwYXJhbSBmb2xkZXJOYW1lIOaWh+S7tuWkueWQjeensFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHJldHVybnMg5a+85YWl55qE6ISa5pys5pWw6YePXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGltcG9ydEZvbGRlckZyb21aaXBOZXcoemlwQ29udGVudDogYW55LCBmb2xkZXJOYW1lOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdERhdGEuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgOiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBsZXQgZmluYWxGb2xkZXJOYW1lID0gZm9sZGVyTmFtZTtcbiAgICBsZXQgY291bnRlciA9IDE7XG4gICAgd2hpbGUgKHJlcG9zaXRvcnkuc29tZShpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5uYW1lID09PSBmaW5hbEZvbGRlck5hbWUpKSB7XG4gICAgICBmaW5hbEZvbGRlck5hbWUgPSBgJHtmb2xkZXJOYW1lfV8ke2NvdW50ZXJ9YDtcbiAgICAgIGNvdW50ZXIrKztcbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXJJZCA9IGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5jcmVhdGVGb2xkZXIoZmluYWxGb2xkZXJOYW1lLCB0eXBlKTtcbiAgICBsZXQgZm9sZGVyU2NyaXB0Q291bnQgPSAwO1xuXG4gICAgZm9yIChjb25zdCBmaWxlTmFtZSBpbiB6aXBDb250ZW50LmZpbGVzKSB7XG4gICAgICBjb25zdCBmaWxlID0gemlwQ29udGVudC5maWxlc1tmaWxlTmFtZV07XG5cbiAgICAgIGlmICghZmlsZS5kaXIgJiYgZmlsZU5hbWUuc3RhcnRzV2l0aChgJHtmb2xkZXJOYW1lfS9gKSAmJiBmaWxlTmFtZS5lbmRzV2l0aCgnLmpzb24nKSkge1xuICAgICAgICBjb25zdCBzY3JpcHRDb250ZW50ID0gYXdhaXQgZmlsZS5hc3luYygnc3RyaW5nJyk7XG4gICAgICAgIGNvbnN0IHNjcmlwdERhdGEgPSBKU09OLnBhcnNlKHNjcmlwdENvbnRlbnQpO1xuXG4gICAgICAgIGlmIChzY3JpcHREYXRhLm5hbWUgJiYgJ2NvbnRlbnQnIGluIHNjcmlwdERhdGEpIHtcbiAgICAgICAgICBjb25zdCBzY3JpcHQgPSBuZXcgU2NyaXB0KHtcbiAgICAgICAgICAgIC4uLnNjcmlwdERhdGEsXG4gICAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdEltcG9ydChzY3JpcHQsIHR5cGUpO1xuICAgICAgICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5tb3ZlU2NyaXB0VG9Gb2xkZXIoc2NyaXB0LmlkLCBmb2xkZXJJZCwgdHlwZSk7XG4gICAgICAgICAgZm9sZGVyU2NyaXB0Q291bnQrKztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmb2xkZXJTY3JpcHRDb3VudDtcbiAgfVxuXG4gIC8qKlxuICAgKiDlr7zlhaXljZXkuKrohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdERhdGEg6ISa5pys5pWw5o2uXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBpbXBvcnRTaW5nbGVTY3JpcHQoc2NyaXB0RGF0YTogYW55LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCFzY3JpcHREYXRhLm5hbWUgfHwgISgnY29udGVudCcgaW4gc2NyaXB0RGF0YSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcign5peg5pWI55qE6ISa5pys5pWw5o2uJyk7XG4gICAgfVxuXG4gICAgY29uc3Qgc2NyaXB0VG9JbXBvcnQgPSBuZXcgU2NyaXB0KHtcbiAgICAgIC4uLnNjcmlwdERhdGEsXG4gICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICB9KTtcblxuICAgIGF3YWl0IHRoaXMuaGFuZGxlU2NyaXB0SW1wb3J0KHNjcmlwdFRvSW1wb3J0LCB0eXBlKTtcblxuICAgIHRvYXN0ci5zdWNjZXNzKGDohJrmnKwgJyR7c2NyaXB0VG9JbXBvcnQubmFtZX0nIOWvvOWFpeaIkOWKn+OAgmApO1xuICB9XG5cbiAgLyoqXG4gICAqIOWvvOWFpeWkmuS4qumhueebru+8iOiEmuacrOaIluaWh+S7tuWkue+8iVxuICAgKiBAcGFyYW0gaXRlbXMg6aG555uu5pWw57uEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBpbXBvcnRNdWx0aXBsZUl0ZW1zKGl0ZW1zOiBhbnlbXSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGxldCBpbXBvcnRlZENvdW50ID0gMDtcbiAgICBsZXQgZm9sZGVyQ291bnQgPSAwO1xuICAgIGxldCBzY3JpcHRDb3VudCA9IDA7XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdmb2xkZXInKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuaW1wb3J0Rm9sZGVyKGl0ZW0sIHR5cGUpO1xuICAgICAgICBmb2xkZXJDb3VudCsrO1xuICAgICAgICBpbXBvcnRlZENvdW50Kys7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ3NjcmlwdCcpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0ID0gbmV3IFNjcmlwdCh7XG4gICAgICAgICAgLi4uaXRlbS52YWx1ZSxcbiAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlU2NyaXB0SW1wb3J0KHNjcmlwdCwgdHlwZSk7XG4gICAgICAgIHNjcmlwdENvdW50Kys7XG4gICAgICAgIGltcG9ydGVkQ291bnQrKztcbiAgICAgIH0gZWxzZSBpZiAoaXRlbS5uYW1lICYmICdjb250ZW50JyBpbiBpdGVtKSB7XG4gICAgICAgIGNvbnN0IHNjcmlwdCA9IG5ldyBTY3JpcHQoe1xuICAgICAgICAgIC4uLml0ZW0sXG4gICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdEltcG9ydChzY3JpcHQsIHR5cGUpO1xuICAgICAgICBzY3JpcHRDb3VudCsrO1xuICAgICAgICBpbXBvcnRlZENvdW50Kys7XG4gICAgICB9XG4gICAgfVxuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICBhY3Rpb246IHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJ3JlZnJlc2hfZ2xvYmFsX3NjcmlwdHMnIDogJ3JlZnJlc2hfY2hhcmFjdF9zY3JpcHRzJyxcbiAgICB9KTtcblxuICAgIHRvYXN0ci5zdWNjZXNzKGDlr7zlhaXmiJDlip9gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlr7zlhaXmlofku7blpLlcbiAgICogQHBhcmFtIGZvbGRlckRhdGEg5paH5Lu25aS55pWw5o2uXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBpbXBvcnRGb2xkZXIoZm9sZGVyRGF0YTogYW55LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCFmb2xkZXJEYXRhLm5hbWUgfHwgIUFycmF5LmlzQXJyYXkoZm9sZGVyRGF0YS52YWx1ZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcign5peg5pWI55qE5paH5Lu25aS55pWw5o2uJyk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTFxuICAgICAgICA/IHRoaXMuc2NyaXB0RGF0YS5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICA6IHRoaXMuc2NyaXB0RGF0YS5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGxldCBmb2xkZXJOYW1lID0gZm9sZGVyRGF0YS5uYW1lO1xuICAgIGxldCBjb3VudGVyID0gMTtcbiAgICB3aGlsZSAocmVwb3NpdG9yeS5zb21lKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLm5hbWUgPT09IGZvbGRlck5hbWUpKSB7XG4gICAgICBmb2xkZXJOYW1lID0gYCR7Zm9sZGVyRGF0YS5uYW1lfV8ke2NvdW50ZXJ9YDtcbiAgICAgIGNvdW50ZXIrKztcbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXJJZCA9IGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5jcmVhdGVGb2xkZXIoZm9sZGVyTmFtZSwgdHlwZSk7XG5cbiAgICBmb3IgKGNvbnN0IHNjcmlwdERhdGEgb2YgZm9sZGVyRGF0YS52YWx1ZSkge1xuICAgICAgY29uc3Qgc2NyaXB0ID0gbmV3IFNjcmlwdCh7XG4gICAgICAgIC4uLnNjcmlwdERhdGEsXG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgICBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdEltcG9ydChzY3JpcHQsIHR5cGUpO1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLm1vdmVTY3JpcHRUb0ZvbGRlcihzY3JpcHQuaWQsIGZvbGRlcklkLCB0eXBlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG6ISa5pys5a+85YWl5Yay56qBXG4gICAqIEBwYXJhbSBzY3JpcHQg6KaB5a+85YWl55qE6ISa5pysXG4gICAqIEBwYXJhbSB0eXBlIOebruagh+exu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVTY3JpcHRJbXBvcnQoc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBnbG9iYWxTY3JpcHRzID0gdGhpcy5zY3JpcHREYXRhLmdldEdsb2JhbFNjcmlwdHMoKTtcbiAgICBjb25zdCBjaGFyYWN0ZXJTY3JpcHRzID0gdGhpcy5zY3JpcHREYXRhLmdldENoYXJhY3RlclNjcmlwdHMoKTtcblxuICAgIGNvbnN0IGNvbmZsaWN0SW5HbG9iYWwgPSBnbG9iYWxTY3JpcHRzLmZpbmQocyA9PiBzLmlkID09PSBzY3JpcHQuaWQpO1xuICAgIGNvbnN0IGNvbmZsaWN0SW5DaGFyYWN0ZXIgPSBjaGFyYWN0ZXJTY3JpcHRzLmZpbmQocyA9PiBzLmlkID09PSBzY3JpcHQuaWQpO1xuXG4gICAgbGV0IGV4aXN0aW5nU2NyaXB0OiBTY3JpcHQgfCB1bmRlZmluZWQ7XG4gICAgbGV0IGNvbmZsaWN0VHlwZTogU2NyaXB0VHlwZSB8IHVuZGVmaW5lZDtcblxuICAgIGlmIChjb25mbGljdEluR2xvYmFsKSB7XG4gICAgICBleGlzdGluZ1NjcmlwdCA9IGNvbmZsaWN0SW5HbG9iYWw7XG4gICAgICBjb25mbGljdFR5cGUgPSBTY3JpcHRUeXBlLkdMT0JBTDtcbiAgICB9IGVsc2UgaWYgKGNvbmZsaWN0SW5DaGFyYWN0ZXIpIHtcbiAgICAgIGV4aXN0aW5nU2NyaXB0ID0gY29uZmxpY3RJbkNoYXJhY3RlcjtcbiAgICAgIGNvbmZsaWN0VHlwZSA9IFNjcmlwdFR5cGUuQ0hBUkFDVEVSO1xuICAgIH1cblxuICAgIGlmIChleGlzdGluZ1NjcmlwdCAmJiBjb25mbGljdFR5cGUpIHtcbiAgICAgIGNvbnN0IGFjdGlvbiA9IGF3YWl0IHRoaXMuaGFuZGxlU2NyaXB0SWRDb25mbGljdChzY3JpcHQsIGV4aXN0aW5nU2NyaXB0LCB0eXBlLCAnaW1wb3J0Jyk7XG5cbiAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgIGNhc2UgJ25ldyc6XG4gICAgICAgICAgc2NyaXB0LmlkID0gdXVpZHY0KCk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnb3ZlcnJpZGUnOlxuICAgICAgICAgIGF3YWl0IHRoaXMuZGVsZXRlU2NyaXB0KGV4aXN0aW5nU2NyaXB0LmlkLCBjb25mbGljdFR5cGUpO1xuICAgICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NhbmNlbCc6XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLmNyZWF0ZVNjcmlwdChzY3JpcHQsIHR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDor7vlj5bmlofku7blhoXlrrnkuLrmlofmnKwgLSDkvb/nlKhQcm9taXNl5Luj5pu/5Zue6LCDXG4gICAqIEBwYXJhbSBmaWxlIOaWh+S7tuWvueixoVxuICAgKiBAcmV0dXJucyDmlofku7blhoXlrrlcbiAgICovXG4gIHByaXZhdGUgcmVhZEZpbGVBc1RleHQoZmlsZTogRmlsZSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICByZWFkZXIub25sb2FkID0gZSA9PiByZXNvbHZlKGUudGFyZ2V0Py5yZXN1bHQgYXMgc3RyaW5nKTtcbiAgICAgIHJlYWRlci5vbmVycm9yID0gZSA9PiByZWplY3QoZSk7XG4gICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rmlrDohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgY3JlYXRlU2NyaXB0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHtcbiAgICAgIGFjdGlvbjogJ3NjcmlwdF9jcmVhdGUnLFxuICAgICAgc2NyaXB0LFxuICAgICAgdHlwZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDnjrDmnInohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdXBkYXRlU2NyaXB0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHtcbiAgICAgIGFjdGlvbjogJ3NjcmlwdF91cGRhdGUnLFxuICAgICAgc2NyaXB0LFxuICAgICAgdHlwZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnu5/kuIDkv53lrZjmjpLluo/mlrnms5UgLSDkv53lrZjku5PlupPpobnmjpLluo9cbiAgICogQHBhcmFtIHJlcG9zaXRvcnlJdGVtcyDku5PlupPpobnmlbDnu4TvvIjljIXlkKvmlofku7blpLnlkozohJrmnKznmoTmt7flkIjnu5PmnoTvvIlcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2F2ZU9yZGVyKHJlcG9zaXRvcnlJdGVtczogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeUl0ZW1zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeUl0ZW1zKTtcbiAgICB9XG5cbiAgICB0aGlzLnNjcmlwdERhdGEubG9hZFNjcmlwdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZCDkvb/nlKjnu5/kuIDnmoQgc2F2ZU9yZGVyIOaWueazleabv+S7o1xuICAgKiDkv53lrZjohJrmnKzmjpLluo9cbiAgICogQHBhcmFtIHNjcmlwdHMg6ISa5pys5pWw57uEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIHNhdmVTY3JpcHRzT3JkZXIoc2NyaXB0czogU2NyaXB0W10sIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLndhcm4oJ1tTY3JpcHRNYW5hZ2VyXSBzYXZlU2NyaXB0c09yZGVyIOW3suW6n+W8g++8jOivt+S9v+eUqCBzYXZlT3JkZXIg5pa55rOVJyk7XG5cbiAgICBjb25zdCByZXBvc2l0b3J5SXRlbXM6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10gPSBzY3JpcHRzLm1hcChzY3JpcHQgPT4gKHtcbiAgICAgIHR5cGU6ICdzY3JpcHQnIGFzIGNvbnN0LFxuICAgICAgdmFsdWU6IHNjcmlwdCxcbiAgICB9KSk7XG5cbiAgICBhd2FpdCB0aGlzLnNhdmVPcmRlcihyZXBvc2l0b3J5SXRlbXMsIHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkIOS9v+eUqOe7n+S4gOeahCBzYXZlT3JkZXIg5pa55rOV5pu/5LujXG4gICAqIOS/neWtmOS7k+W6k+mhueaOkuW6j++8iOWMheWQq+aWh+S7tuWkueWSjOiEmuacrOeahOa3t+WQiOaOkuW6j++8iVxuICAgKiBAcGFyYW0gcmVwb3NpdG9yeUl0ZW1zIOS7k+W6k+mhueaVsOe7hFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzYXZlUmVwb3NpdG9yeUl0ZW1zT3JkZXIocmVwb3NpdG9yeUl0ZW1zOiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS53YXJuKCdbU2NyaXB0TWFuYWdlcl0gc2F2ZVJlcG9zaXRvcnlJdGVtc09yZGVyIOW3suW6n+W8g++8jOivt+S9v+eUqCBzYXZlT3JkZXIg5pa55rOVJyk7XG4gICAgYXdhaXQgdGhpcy5zYXZlT3JkZXIocmVwb3NpdG9yeUl0ZW1zLCB0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliKDpmaTohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGRlbGV0ZVNjcmlwdChzY3JpcHRJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuICAgIGlmICghc2NyaXB0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDohJrmnKzkuI3lrZjlnKgnKTtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLnN0b3BTY3JpcHQoc2NyaXB0LCB0eXBlKTtcblxuICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5kZWxldGVTY3JpcHQoc2NyaXB0SWQsIHR5cGUpO1xuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICBhY3Rpb246ICdzY3JpcHRfZGVsZXRlJyxcbiAgICAgIHNjcmlwdElkLFxuICAgICAgdHlwZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnp7vliqjohJrmnKzliLDlj6bkuIDkuKrnsbvlnotcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIGZyb21UeXBlIOa6kOexu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIG1vdmVTY3JpcHQoc2NyaXB0OiBTY3JpcHQsIGZyb21UeXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5zdG9wU2NyaXB0KHNjcmlwdCwgZnJvbVR5cGUpO1xuXG4gICAgY29uc3QgdGFyZ2V0VHlwZSA9IGdldE9wcG9zaXRlU2NyaXB0VHlwZShmcm9tVHlwZSk7XG5cbiAgICBjb25zdCBleGlzdGluZ1NjcmlwdEluVGFyZ2V0ID0gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoc2NyaXB0LmlkKTtcbiAgICBjb25zdCBleGlzdGluZ1NjcmlwdFR5cGUgPSBleGlzdGluZ1NjcmlwdEluVGFyZ2V0ID8gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdFR5cGUoZXhpc3RpbmdTY3JpcHRJblRhcmdldCkgOiBudWxsO1xuXG4gICAgaWYgKGV4aXN0aW5nU2NyaXB0SW5UYXJnZXQgJiYgZXhpc3RpbmdTY3JpcHRUeXBlID09PSB0YXJnZXRUeXBlKSB7XG4gICAgICBjb25zdCBhY3Rpb24gPSBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdElkQ29uZmxpY3Qoc2NyaXB0LCBleGlzdGluZ1NjcmlwdEluVGFyZ2V0LCB0YXJnZXRUeXBlLCAnbW92ZScpO1xuXG4gICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICBjYXNlICduZXcnOlxuICAgICAgICAgIHNjcmlwdC5pZCA9IHV1aWR2NCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdvdmVycmlkZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVTY3JpcHQoZXhpc3RpbmdTY3JpcHRJblRhcmdldC5pZCwgdGFyZ2V0VHlwZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NhbmNlbCc6XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5tb3ZlSXRlbVRvT3RoZXJUeXBlKHsgdHlwZTogJ3NjcmlwdCcsIGlkOiBzY3JpcHQuaWQsIHZhbHVlOiBzY3JpcHQgfSwgZnJvbVR5cGUpO1xuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICBhY3Rpb246ICdzY3JpcHRfbW92ZScsXG4gICAgICBzY3JpcHQsXG4gICAgICBmcm9tVHlwZSxcbiAgICAgIHRhcmdldFR5cGUsXG4gICAgfSk7XG5cbiAgICBpZiAoXG4gICAgICBzY3JpcHQuZW5hYmxlZCAmJlxuICAgICAgKCh0YXJnZXRUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCAmJiB0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkKSB8fFxuICAgICAgICAodGFyZ2V0VHlwZSA9PT0gU2NyaXB0VHlwZS5DSEFSQUNURVIgJiYgdGhpcy5zY3JpcHREYXRhLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCkpXG4gICAgKSB7XG4gICAgICBhd2FpdCB0aGlzLnJ1blNjcmlwdChzY3JpcHQsIHRhcmdldFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliLfmlrDop5LoibLohJrmnKzmlbDmja5cbiAgICovXG4gIHB1YmxpYyByZWZyZXNoQ2hhcmFjdGVyU2NyaXB0RGF0YSgpOiB2b2lkIHtcbiAgICB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWFqOWxgOiEmuacrFxuICAgKi9cbiAgcHVibGljIGdldEdsb2JhbFNjcmlwdHMoKTogU2NyaXB0W10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0R2xvYmFsU2NyaXB0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuiEmuacrFxuICAgKi9cbiAgcHVibGljIGdldENoYXJhY3RlclNjcmlwdHMoKTogU2NyaXB0W10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIt+aWsOinkuiJsuiEmuacrOWQr+eUqOeKtuaAgVxuICAgKi9cbiAgcHVibGljIHJlZnJlc2hDaGFyYWN0ZXJTY3JpcHRFbmFibGVkU3RhdGUoKTogdm9pZCB7XG4gICAgdGhpcy5zY3JpcHREYXRhLnJlZnJlc2hDaGFyYWN0ZXJTY3JpcHRFbmFibGVkU3RhdGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blhajlsYDohJrmnKzlkK/nlKjnirbmgIFcbiAgICovXG4gIHB1YmxpYyBnZXQgaXNHbG9iYWxTY3JpcHRFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuiEmuacrOWQr+eUqOeKtuaAgVxuICAgKi9cbiAgcHVibGljIGdldCBpc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuc2NyaXB0RGF0YS5pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQ7XG4gIH1cblxuICAvKipcbiAgICog5qC55o2uSUTojrflj5bohJrmnKxcbiAgICogQHBhcmFtIGlkIOiEmuacrElEXG4gICAqL1xuICBwdWJsaWMgZ2V0U2NyaXB0QnlJZChpZDogc3RyaW5nKTogU2NyaXB0IHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWFqOWxgOiEmuacrOS7k+W6k+mhue+8iOWMheWQq+aWh+S7tuWkuee7k+aehO+8iVxuICAgKi9cbiAgcHVibGljIGdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpOiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuiEmuacrOS7k+W6k+mhue+8iOWMheWQq+aWh+S7tuWkuee7k+aehO+8iVxuICAgKi9cbiAgcHVibGljIGdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpOiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uuaWh+S7tuWkuVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNyZWF0ZUZvbGRlcihuYW1lOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUsIGljb24/OiBzdHJpbmcsIGNvbG9yPzogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5zY3JpcHREYXRhLmNyZWF0ZUZvbGRlcihuYW1lLCB0eXBlLCBpY29uLCBjb2xvcik7XG4gIH1cblxuICAvKipcbiAgICog6YeN5ZG95ZCN5paH5Lu25aS5XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZWRpdEZvbGRlcihcbiAgICBmb2xkZXJJZDogc3RyaW5nLFxuICAgIG5ld05hbWU6IHN0cmluZyxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgIG5ld0ljb24/OiBzdHJpbmcsXG4gICAgbmV3Q29sb3I/OiBzdHJpbmcsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5lZGl0Rm9sZGVyKGZvbGRlcklkLCBuZXdOYW1lLCB0eXBlLCBuZXdJY29uLCBuZXdDb2xvcik7XG4gIH1cblxuICAvKipcbiAgICog5Yig6Zmk5paH5Lu25aS5XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZGVsZXRlRm9sZGVyKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEuZGVsZXRlRm9sZGVyKGZvbGRlcklkLCB0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlsIbohJrmnKznp7vliqjliLDmlofku7blpLlcbiAgICovXG4gIHB1YmxpYyBhc3luYyBtb3ZlU2NyaXB0VG9Gb2xkZXIoc2NyaXB0SWQ6IHN0cmluZywgdGFyZ2V0Rm9sZGVySWQ6IHN0cmluZyB8IG51bGwsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEubW92ZVNjcmlwdFRvRm9sZGVyKHNjcmlwdElkLCB0YXJnZXRGb2xkZXJJZCwgdHlwZSk7XG4gIH1cblxuICAvKipcbiAgICog5bCG5paH5Lu25aS556e75Yqo5Yiw5YW25LuW57G75Z6LXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gZnJvbVR5cGUg5rqQ57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgbW92ZUZvbGRlcihmb2xkZXJJZDogc3RyaW5nLCBmcm9tVHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHRhcmdldFR5cGUgPSBnZXRPcHBvc2l0ZVNjcmlwdFR5cGUoZnJvbVR5cGUpO1xuXG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLm1vdmVJdGVtVG9PdGhlclR5cGUoeyB0eXBlOiAnZm9sZGVyJywgaWQ6IGZvbGRlcklkIH0sIGZyb21UeXBlKTtcblxuICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgYWN0aW9uOiAnZm9sZGVyX21vdmUnLFxuICAgICAgZm9sZGVySWQsXG4gICAgICBmcm9tVHlwZSxcbiAgICAgIHRhcmdldFR5cGUsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5paH5Lu25aS55Lit55qE6ISa5pysXG4gICAqL1xuICBwdWJsaWMgZ2V0Rm9sZGVyU2NyaXB0cyhmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogU2NyaXB0W10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0Rm9sZGVyU2NyaXB0cyhmb2xkZXJJZCwgdHlwZSk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5qC557qn5Yir55qE6ISa5pysXG4gICAqL1xuICBwdWJsaWMgZ2V0Um9vdFNjcmlwdHModHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFtdIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldFJvb3RTY3JpcHRzKHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieaWh+S7tuWkuVxuICAgKi9cbiAgcHVibGljIGdldEZvbGRlcnModHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0Rm9sZGVycyh0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmibnph4/liIfmjaLmlofku7blpLnlhoXmiYDmnInohJrmnKznmoTlkK/nlKjnirbmgIFcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgcHVibGljIGFzeW5jIHRvZ2dsZUZvbGRlclNjcmlwdHMoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgZW5hYmxlOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS50b2dnbGVGb2xkZXJTY3JpcHRzKGZvbGRlcklkLCB0eXBlLCBlbmFibGUpO1xuXG4gICAgICBjb25zdCBzY3JpcHRzID0gdGhpcy5zY3JpcHREYXRhLmdldEZvbGRlclNjcmlwdHMoZm9sZGVySWQsIHR5cGUpO1xuXG4gICAgICBjb25zdCBpc1R5cGVFbmFibGVkID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkIDogdGhpcy5zY3JpcHREYXRhLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZDtcblxuICAgICAgaWYgKGlzVHlwZUVuYWJsZWQpIHtcbiAgICAgICAgZm9yIChjb25zdCBzY3JpcHQgb2Ygc2NyaXB0cykge1xuICAgICAgICAgIGlmIChlbmFibGUgJiYgc2NyaXB0LmVuYWJsZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucnVuU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgICAgICAgfSBlbHNlIGlmICghZW5hYmxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnN0b3BTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICAgIGFjdGlvbjogJ2ZvbGRlcl9zY3JpcHRzX3RvZ2dsZScsXG4gICAgICAgIGZvbGRlcklkLFxuICAgICAgICB0eXBlLFxuICAgICAgICBlbmFibGUsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgW1NjcmlwdE1hbmFnZXJdIOaJuemHj+WIh+aNouaWh+S7tuWkueiEmuacrOeKtuaAgeWksei0pTogJHtmb2xkZXJJZH1gLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOaJuemHj+WIh+aNouaWh+S7tuWkueiEmuacrOeKtuaAgeWksei0pWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmlofku7blpLnlhoXohJrmnKznmoTmlbTkvZPlkK/nlKjnirbmgIFcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHVibGljIGdldEZvbGRlclNjcmlwdHNTdGF0ZShmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogJ2FsbCcgfCAnbm9uZScge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0Rm9sZGVyU2NyaXB0c1N0YXRlKGZvbGRlcklkLCB0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmjIflrprohJrmnKznmoTlj5jph4/mlbDmja5cbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqIEByZXR1cm5zIOiEmuacrOeahGRhdGHlrZfmrrXvvIzlpoLmnpzohJrmnKzkuI3lrZjlnKjov5Tlm57nqbrlr7nosaFcbiAgICovXG4gIHB1YmxpYyBnZXRTY3JpcHRWYXJpYWJsZXMoc2NyaXB0SWQ6IHN0cmluZyk6IHsgW2tleTogc3RyaW5nXTogYW55IH0ge1xuICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuc2NyaXB0RGF0YS5nZXRTY3JpcHRCeUlkKHNjcmlwdElkKTtcbiAgICBpZiAoIXNjcmlwdCkge1xuICAgICAgY29uc29sZS53YXJuKGBbU2NyaXB0TWFuYWdlcl0g6ISa5pys5LiN5a2Y5ZyoOiAke3NjcmlwdElkfWApO1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICByZXR1cm4gc2NyaXB0LmRhdGEgfHwge307XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5oyH5a6a6ISa5pys55qE5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBzY3JpcHRJZCDohJrmnKxJRFxuICAgKiBAcGFyYW0gdmFyaWFibGVzIOaWsOeahOWPmOmHj+aVsOaNrlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHJldHVybnMg5piv5ZCm5pu05paw5oiQ5YqfXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdXBkYXRlU2NyaXB0VmFyaWFibGVzKFxuICAgIHNjcmlwdElkOiBzdHJpbmcsXG4gICAgdmFyaWFibGVzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9LFxuICAgIHR5cGU6IFNjcmlwdFR5cGUsXG4gICk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuc2NyaXB0RGF0YS5nZXRTY3JpcHRCeUlkKHNjcmlwdElkKTtcbiAgICBpZiAoIXNjcmlwdCkge1xuICAgICAgY29uc29sZS53YXJuKGBbU2NyaXB0TWFuYWdlcl0g6ISa5pys5LiN5a2Y5ZyoOiAke3NjcmlwdElkfWApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHNjcmlwdC5kYXRhID0gdmFyaWFibGVzO1xuICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5zYXZlU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG5cbiAgICBjb25zb2xlLmluZm8oYFtTY3JpcHRNYW5hZ2VyXSDlt7Lmm7TmlrDohJrmnKzlj5jph486ICR7c2NyaXB0Lm5hbWV9YCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5omA5pyJ6ISa5pys55qE5Y+Y6YeP5pWw5o2u77yI55So5LqO6LCD6K+V5ZKM566h55CG77yJXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcmV0dXJucyDmiYDmnInohJrmnKznmoTlj5jph4/mlbDmja7mmKDlsIRcbiAgICovXG4gIHB1YmxpYyBnZXRBbGxTY3JpcHRWYXJpYWJsZXModHlwZTogU2NyaXB0VHlwZSk6IE1hcDxzdHJpbmcsIHsgW2tleTogc3RyaW5nXTogYW55IH0+IHtcbiAgICBjb25zdCBzY3JpcHRzID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gdGhpcy5zY3JpcHREYXRhLmdldEdsb2JhbFNjcmlwdHMoKSA6IHRoaXMuc2NyaXB0RGF0YS5nZXRDaGFyYWN0ZXJTY3JpcHRzKCk7XG5cbiAgICBjb25zdCB2YXJpYWJsZXNNYXAgPSBuZXcgTWFwPHN0cmluZywgeyBba2V5OiBzdHJpbmddOiBhbnkgfT4oKTtcblxuICAgIHNjcmlwdHMuZm9yRWFjaChzY3JpcHQgPT4ge1xuICAgICAgaWYgKHNjcmlwdC5kYXRhICYmIE9iamVjdC5rZXlzKHNjcmlwdC5kYXRhKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHZhcmlhYmxlc01hcC5zZXQoc2NyaXB0LmlkLCBzY3JpcHQuZGF0YSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdmFyaWFibGVzTWFwO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4heeQhuaJgOaciei1hOa6kFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNsZWFudXAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5leGVjdXRvci5jbGVhckFsbFNjcmlwdHNJZnJhbWUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbohJrmnKxJROWGsueqgVxuICAgKiBAcGFyYW0gc2NyaXB0IOimgeWkhOeQhueahOiEmuacrFxuICAgKiBAcGFyYW0gZXhpc3RpbmdTY3JpcHQg5bey5a2Y5Zyo55qE6ISa5pysXG4gICAqIEBwYXJhbSB0YXJnZXRUeXBlIOebruagh+exu+Wei1xuICAgKiBAcGFyYW0gb3BlcmF0aW9uVHlwZSDmk43kvZznsbvlnovvvJonaW1wb3J0JyAtIOWvvOWFpSwgJ21vdmUnIC0g56e75YqoXG4gICAqIEByZXR1cm5zIOWkhOeQhue7k+aenO+8miduZXcnIC0g5L2/55So5pawSUQsICdvdmVycmlkZScgLSDopobnm5blt7LmnInohJrmnKwsICdjYW5jZWwnIC0g5Y+W5raI5pON5L2cXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaGFuZGxlU2NyaXB0SWRDb25mbGljdChcbiAgICBzY3JpcHQ6IFNjcmlwdCxcbiAgICBleGlzdGluZ1NjcmlwdDogU2NyaXB0LFxuICAgIHRhcmdldFR5cGU6IFNjcmlwdFR5cGUsXG4gICAgb3BlcmF0aW9uVHlwZTogJ2ltcG9ydCcgfCAnbW92ZScgPSAnaW1wb3J0JyxcbiAgKTogUHJvbWlzZTwnbmV3JyB8ICdvdmVycmlkZScgfCAnY2FuY2VsJz4ge1xuICAgIGNvbnN0IGV4aXN0aW5nU2NyaXB0VHlwZSA9IHRoaXMuc2NyaXB0RGF0YS5nZXRTY3JpcHRUeXBlKGV4aXN0aW5nU2NyaXB0KTtcbiAgICBjb25zdCBleGlzdGluZ1R5cGVUZXh0ID0gZXhpc3RpbmdTY3JpcHRUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/ICflhajlsYDohJrmnKwnIDogJ+inkuiJsuiEmuacrCc7XG4gICAgY29uc3QgdGFyZ2V0VHlwZVRleHQgPSB0YXJnZXRUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/ICflhajlsYDohJrmnKwnIDogJ+inkuiJsuiEmuacrCc7XG5cbiAgICBsZXQgbWVzc2FnZTogc3RyaW5nO1xuICAgIGlmIChvcGVyYXRpb25UeXBlID09PSAnaW1wb3J0Jykge1xuICAgICAgbWVzc2FnZSA9IGDopoHlr7zlhaXnmoTohJrmnKwgJyR7c2NyaXB0Lm5hbWV9JyDkuI4ke2V4aXN0aW5nVHlwZVRleHR95bqT5Lit55qEICcke2V4aXN0aW5nU2NyaXB0Lm5hbWV9JyBpZCDnm7jlkIzvvIzmmK/lkKbopoHnu6fnu63mk43kvZzvvJ9gO1xuICAgIH0gZWxzZSB7XG4gICAgICBtZXNzYWdlID0gYOimgeenu+WKqOWIsCR7dGFyZ2V0VHlwZVRleHR95bqT55qE6ISa5pysICcke3NjcmlwdC5uYW1lfScg5LiO55uu5qCH5bqT5Lit55qEICcke2V4aXN0aW5nU2NyaXB0Lm5hbWV9JyBpZCDnm7jlkIzvvIzmmK/lkKbopoHnu6fnu63mk43kvZzvvJ9gO1xuICAgIH1cblxuICAgIGNvbnN0IGlucHV0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChtZXNzYWdlLCBQT1BVUF9UWVBFLlRFWFQsICcnLCB7XG4gICAgICBva0J1dHRvbjogJ+imhuebluWOn+iEmuacrCcsXG4gICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgICAgY3VzdG9tQnV0dG9uczogWyfmlrDlu7rohJrmnKwnXSxcbiAgICB9KTtcblxuICAgIGxldCBhY3Rpb246ICduZXcnIHwgJ292ZXJyaWRlJyB8ICdjYW5jZWwnID0gJ2NhbmNlbCc7XG5cbiAgICBzd2l0Y2ggKGlucHV0KSB7XG4gICAgICBjYXNlIDA6XG4gICAgICAgIGFjdGlvbiA9ICdjYW5jZWwnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgYWN0aW9uID0gJ292ZXJyaWRlJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGFjdGlvbiA9ICduZXcnO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gYWN0aW9uO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/script_repository/script_controller.ts\n")},"./src/component/script_repository/types.ts":
/*!**************************************************!*\
  !*** ./src/component/script_repository/types.ts ***!
  \**************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Script: () => (/* binding */ Script),\n/* harmony export */   ScriptType: () => (/* binding */ ScriptType),\n/* harmony export */   defaultScriptSettings: () => (/* binding */ defaultScriptSettings),\n/* harmony export */   extractScriptsFromRepository: () => (/* binding */ extractScriptsFromRepository),\n/* harmony export */   getBatchControlsSelector: () => (/* binding */ getBatchControlsSelector),\n/* harmony export */   getOppositeScriptType: () => (/* binding */ getOppositeScriptType),\n/* harmony export */   getScriptListSelector: () => (/* binding */ getScriptListSelector),\n/* harmony export */   getScriptToggleSelector: () => (/* binding */ getScriptToggleSelector),\n/* harmony export */   isScript: () => (/* binding */ isScript),\n/* harmony export */   isScriptRepositoryItem: () => (/* binding */ isScriptRepositoryItem),\n/* harmony export */   migrateScriptsToRepositoryItems: () => (/* binding */ migrateScriptsToRepositoryItems)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n\nclass Script {\n    id;\n    name;\n    content;\n    info;\n    buttons;\n    data;\n    enabled;\n    constructor(data) {\n        this.id = data?.id && data.id.trim() !== '' ? data.id : (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_0__.uuidv4)();\n        this.name = data?.name || '';\n        this.content = data?.content || '';\n        this.info = data?.info || '';\n        this.enabled = data?.enabled || false;\n        this.buttons = data?.buttons || [];\n        this.data = data?.data || {};\n    }\n}\nvar ScriptType;\n(function (ScriptType) {\n    ScriptType[\"GLOBAL\"] = \"global\";\n    ScriptType[\"CHARACTER\"] = \"character\";\n})(ScriptType || (ScriptType = {}));\nconst defaultScriptSettings = {\n    global_script_enabled: true,\n    scriptsRepository: [],\n    characters_with_scripts: [],\n};\nfunction isScriptRepositoryItem(item) {\n    return item && typeof item === 'object' && 'type' in item && 'value' in item;\n}\nfunction isScript(item) {\n    return item && typeof item === 'object' && 'id' in item && 'name' in item && 'content' in item;\n}\nfunction migrateScriptsToRepositoryItems(scripts) {\n    return scripts.map(script => ({\n        type: 'script',\n        value: script,\n    }));\n}\nfunction extractScriptsFromRepository(repository) {\n    const scripts = [];\n    for (const item of repository) {\n        if (isScript(item)) {\n            scripts.push(item);\n        }\n        else if (isScriptRepositoryItem(item)) {\n            if (item.type === 'script') {\n                scripts.push(item.value);\n            }\n            else if (item.type === 'folder') {\n                const folderScripts = item.value;\n                scripts.push(...folderScripts);\n            }\n        }\n    }\n    return scripts;\n}\n/**\n * <->\n * @param type \n * @returns \n */\nfunction getOppositeScriptType(type) {\n    return type === ScriptType.GLOBAL ? ScriptType.CHARACTER : ScriptType.GLOBAL;\n}\n/**\n * \n * @param type \n * @returns \n */\nfunction getScriptListSelector(type) {\n    return type === ScriptType.GLOBAL ? '#global-script-list' : '#character-script-list';\n}\n/**\n * \n * @param type \n * @returns \n */\nfunction getBatchControlsSelector(type) {\n    return type === ScriptType.GLOBAL ? '#global-batch-controls' : '#character-batch-controls';\n}\n/**\n * \n * @param type \n * @returns \n */\nfunction getScriptToggleSelector(type) {\n    return type === ScriptType.GLOBAL ? '#global-script-enable-toggle' : '#character-script-enable-toggle';\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3R5cGVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFvRDtBQUU3QyxNQUFNLE1BQU07SUFDakIsRUFBRSxDQUFTO0lBQ1gsSUFBSSxDQUFTO0lBQ2IsT0FBTyxDQUFTO0lBQ2hCLElBQUksQ0FBUztJQUNiLE9BQU8sQ0FBdUM7SUFDOUMsSUFBSSxDQUFrQztJQUN0QyxPQUFPLENBQVU7SUFFakIsWUFBWSxJQUFzQjtRQUNoQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksRUFBRSxFQUFFLElBQUksSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLGtFQUFNLEVBQUUsQ0FBQztRQUNqRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDO1FBQzdCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxFQUFFLE9BQU8sSUFBSSxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksRUFBRSxPQUFPLElBQUksS0FBSyxDQUFDO1FBQ3RDLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxFQUFFLE9BQU8sSUFBSSxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQUMvQixDQUFDO0NBQ0Y7QUFZRCxJQUFZLFVBR1g7QUFIRCxXQUFZLFVBQVU7SUFDcEIsK0JBQWlCO0lBQ2pCLHFDQUF1QjtBQUN6QixDQUFDLEVBSFcsVUFBVSxLQUFWLFVBQVUsUUFHckI7QUFFTSxNQUFNLHFCQUFxQixHQUFHO0lBQ25DLHFCQUFxQixFQUFFLElBQUk7SUFDM0IsaUJBQWlCLEVBQUUsRUFBdUM7SUFDMUQsdUJBQXVCLEVBQUUsRUFBYztDQUN4QyxDQUFDO0FBT0ssU0FBUyxzQkFBc0IsQ0FBQyxJQUFTO0lBQzlDLE9BQU8sSUFBSSxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsSUFBSSxNQUFNLElBQUksSUFBSSxJQUFJLE9BQU8sSUFBSSxJQUFJLENBQUM7QUFDL0UsQ0FBQztBQUVNLFNBQVMsUUFBUSxDQUFDLElBQVM7SUFDaEMsT0FBTyxJQUFJLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUksTUFBTSxJQUFJLElBQUksSUFBSSxTQUFTLElBQUksSUFBSSxDQUFDO0FBQ2pHLENBQUM7QUFFTSxTQUFTLCtCQUErQixDQUFDLE9BQWlCO0lBQy9ELE9BQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDNUIsSUFBSSxFQUFFLFFBQVE7UUFDZCxLQUFLLEVBQUUsTUFBTTtLQUNkLENBQUMsQ0FBQyxDQUFDO0FBQ04sQ0FBQztBQUVNLFNBQVMsNEJBQTRCLENBQUMsVUFBNkM7SUFDeEYsTUFBTSxPQUFPLEdBQWEsRUFBRSxDQUFDO0lBRTdCLEtBQUssTUFBTSxJQUFJLElBQUksVUFBVSxFQUFFLENBQUM7UUFDOUIsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztZQUNuQixPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JCLENBQUM7YUFBTSxJQUFJLHNCQUFzQixDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7WUFDeEMsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsRUFBRSxDQUFDO2dCQUMzQixPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFlLENBQUMsQ0FBQztZQUNyQyxDQUFDO2lCQUFNLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLEVBQUUsQ0FBQztnQkFDbEMsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLEtBQWlCLENBQUM7Z0JBQzdDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxhQUFhLENBQUMsQ0FBQztZQUNqQyxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUM7SUFFRCxPQUFPLE9BQU8sQ0FBQztBQUNqQixDQUFDO0FBRUQ7Ozs7R0FJRztBQUNJLFNBQVMscUJBQXFCLENBQUMsSUFBZ0I7SUFDcEQsT0FBTyxJQUFJLEtBQUssVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQztBQUMvRSxDQUFDO0FBRUQ7Ozs7R0FJRztBQUNJLFNBQVMscUJBQXFCLENBQUMsSUFBZ0I7SUFDcEQsT0FBTyxJQUFJLEtBQUssVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLHdCQUF3QixDQUFDO0FBQ3ZGLENBQUM7QUFFRDs7OztHQUlHO0FBQ0ksU0FBUyx3QkFBd0IsQ0FBQyxJQUFnQjtJQUN2RCxPQUFPLElBQUksS0FBSyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLENBQUMsMkJBQTJCLENBQUM7QUFDN0YsQ0FBQztBQUVEOzs7O0dBSUc7QUFDSSxTQUFTLHVCQUF1QixDQUFDLElBQWdCO0lBQ3RELE9BQU8sSUFBSSxLQUFLLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLDhCQUE4QixDQUFDLENBQUMsQ0FBQyxpQ0FBaUMsQ0FBQztBQUN6RyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS90eXBlcy50cz8zOTNiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFNjcmlwdCB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICBpbmZvOiBzdHJpbmc7XG4gIGJ1dHRvbnM6IHsgbmFtZTogc3RyaW5nOyB2aXNpYmxlOiBib29sZWFuIH1bXTtcbiAgZGF0YTogeyBbdmFyaWFibGVOYW1lOiBzdHJpbmddOiBhbnkgfTtcbiAgZW5hYmxlZDogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3RvcihkYXRhPzogUGFydGlhbDxTY3JpcHQ+KSB7XG4gICAgdGhpcy5pZCA9IGRhdGE/LmlkICYmIGRhdGEuaWQudHJpbSgpICE9PSAnJyA/IGRhdGEuaWQgOiB1dWlkdjQoKTtcbiAgICB0aGlzLm5hbWUgPSBkYXRhPy5uYW1lIHx8ICcnO1xuICAgIHRoaXMuY29udGVudCA9IGRhdGE/LmNvbnRlbnQgfHwgJyc7XG4gICAgdGhpcy5pbmZvID0gZGF0YT8uaW5mbyB8fCAnJztcbiAgICB0aGlzLmVuYWJsZWQgPSBkYXRhPy5lbmFibGVkIHx8IGZhbHNlO1xuICAgIHRoaXMuYnV0dG9ucyA9IGRhdGE/LmJ1dHRvbnMgfHwgW107XG4gICAgdGhpcy5kYXRhID0gZGF0YT8uZGF0YSB8fCB7fTtcbiAgfVxufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NyaXB0UmVwb3NpdG9yeUl0ZW0ge1xuICB0eXBlOiAnZm9sZGVyJyB8ICdzY3JpcHQnO1xuICBpZD86IHN0cmluZztcbiAgbmFtZT86IHN0cmluZztcbiAgaWNvbj86IHN0cmluZztcbiAgY29sb3I/OiBzdHJpbmc7XG4gIHZhbHVlOiBTY3JpcHRbXSB8IFNjcmlwdDtcbn1cblxuZXhwb3J0IGVudW0gU2NyaXB0VHlwZSB7XG4gIEdMT0JBTCA9ICdnbG9iYWwnLFxuICBDSEFSQUNURVIgPSAnY2hhcmFjdGVyJyxcbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRTY3JpcHRTZXR0aW5ncyA9IHtcbiAgZ2xvYmFsX3NjcmlwdF9lbmFibGVkOiB0cnVlLFxuICBzY3JpcHRzUmVwb3NpdG9yeTogW10gYXMgKFNjcmlwdCB8IFNjcmlwdFJlcG9zaXRvcnlJdGVtKVtdLFxuICBjaGFyYWN0ZXJzX3dpdGhfc2NyaXB0czogW10gYXMgc3RyaW5nW10sXG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIElGcmFtZUVsZW1lbnQgZXh0ZW5kcyBIVE1MSUZyYW1lRWxlbWVudCB7XG4gIGNsZWFudXA6ICgpID0+IHZvaWQ7XG4gIFtwcm9wOiBzdHJpbmddOiBhbnk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NjcmlwdFJlcG9zaXRvcnlJdGVtKGl0ZW06IGFueSk6IGl0ZW0gaXMgU2NyaXB0UmVwb3NpdG9yeUl0ZW0ge1xuICByZXR1cm4gaXRlbSAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgJ3R5cGUnIGluIGl0ZW0gJiYgJ3ZhbHVlJyBpbiBpdGVtO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTY3JpcHQoaXRlbTogYW55KTogaXRlbSBpcyBTY3JpcHQge1xuICByZXR1cm4gaXRlbSAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgJ2lkJyBpbiBpdGVtICYmICduYW1lJyBpbiBpdGVtICYmICdjb250ZW50JyBpbiBpdGVtO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWlncmF0ZVNjcmlwdHNUb1JlcG9zaXRvcnlJdGVtcyhzY3JpcHRzOiBTY3JpcHRbXSk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10ge1xuICByZXR1cm4gc2NyaXB0cy5tYXAoc2NyaXB0ID0+ICh7XG4gICAgdHlwZTogJ3NjcmlwdCcsXG4gICAgdmFsdWU6IHNjcmlwdCxcbiAgfSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdFNjcmlwdHNGcm9tUmVwb3NpdG9yeShyZXBvc2l0b3J5OiAoU2NyaXB0IHwgU2NyaXB0UmVwb3NpdG9yeUl0ZW0pW10pOiBTY3JpcHRbXSB7XG4gIGNvbnN0IHNjcmlwdHM6IFNjcmlwdFtdID0gW107XG5cbiAgZm9yIChjb25zdCBpdGVtIG9mIHJlcG9zaXRvcnkpIHtcbiAgICBpZiAoaXNTY3JpcHQoaXRlbSkpIHtcbiAgICAgIHNjcmlwdHMucHVzaChpdGVtKTtcbiAgICB9IGVsc2UgaWYgKGlzU2NyaXB0UmVwb3NpdG9yeUl0ZW0oaXRlbSkpIHtcbiAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnKSB7XG4gICAgICAgIHNjcmlwdHMucHVzaChpdGVtLnZhbHVlIGFzIFNjcmlwdCk7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3QgZm9sZGVyU2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIHNjcmlwdHMucHVzaCguLi5mb2xkZXJTY3JpcHRzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gc2NyaXB0cztcbn1cblxuLyoqXG4gKiDojrflj5bnm7jlr7nnmoTohJrmnKznsbvlnovvvIjlhajlsYA8LT7op5LoibLvvIlcbiAqIEBwYXJhbSB0eXBlIOW9k+WJjeiEmuacrOexu+Wei1xuICogQHJldHVybnMg55u45a+555qE6ISa5pys57G75Z6LXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRPcHBvc2l0ZVNjcmlwdFR5cGUodHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFR5cGUge1xuICByZXR1cm4gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyBTY3JpcHRUeXBlLkNIQVJBQ1RFUiA6IFNjcmlwdFR5cGUuR0xPQkFMO1xufVxuXG4vKipcbiAqIOiOt+WPluiEmuacrOWIl+ihqOWuueWZqOeahOmAieaLqeWZqFxuICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gKiBAcmV0dXJucyDlrrnlmajpgInmi6nlmajlrZfnrKbkuLJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlOiBTY3JpcHRUeXBlKTogc3RyaW5nIHtcbiAgcmV0dXJuIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJyNnbG9iYWwtc2NyaXB0LWxpc3QnIDogJyNjaGFyYWN0ZXItc2NyaXB0LWxpc3QnO1xufVxuXG4vKipcbiAqIOiOt+WPluaJuemHj+aOp+WItuWZqOeahOmAieaLqeWZqFxuICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gKiBAcmV0dXJucyDmibnph4/mjqfliLblmajpgInmi6nlmajlrZfnrKbkuLJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEJhdGNoQ29udHJvbHNTZWxlY3Rvcih0eXBlOiBTY3JpcHRUeXBlKTogc3RyaW5nIHtcbiAgcmV0dXJuIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJyNnbG9iYWwtYmF0Y2gtY29udHJvbHMnIDogJyNjaGFyYWN0ZXItYmF0Y2gtY29udHJvbHMnO1xufVxuXG4vKipcbiAqIOiOt+WPluiEmuacrOexu+Wei+WIh+aNouWZqOeahOmAieaLqeWZqFxuICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gKiBAcmV0dXJucyDliIfmjaLlmajpgInmi6nlmajlrZfnrKbkuLJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNjcmlwdFRvZ2dsZVNlbGVjdG9yKHR5cGU6IFNjcmlwdFR5cGUpOiBzdHJpbmcge1xuICByZXR1cm4gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAnI2dsb2JhbC1zY3JpcHQtZW5hYmxlLXRvZ2dsZScgOiAnI2NoYXJhY3Rlci1zY3JpcHQtZW5hYmxlLXRvZ2dsZSc7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/script_repository/types.ts\n")},"./src/component/script_repository/ui_controller.ts":
/*!**********************************************************!*\
  !*** ./src/component/script_repository/ui_controller.ts ***!
  \**********************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UIController: () => (/* binding */ UIController)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/button */ \"./src/component/script_repository/button.ts\");\n/* harmony import */ var _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/events */ \"./src/component/script_repository/events.ts\");\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _util_render_markdown__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/util/render_markdown */ \"./src/util/render_markdown.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n\n\n\n\n\n\n\n\n\n\nclass UIController {\n    static instance;\n    scriptManager;\n    buttonManager;\n    templatePath;\n    baseTemplate = null;\n    defaultScriptTemplate = null;\n    folderTemplate = null;\n    batchModeGlobal = false;\n    batchModeCharacter = false;\n    constructor() {\n        this.scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_2__.ScriptManager.getInstance();\n        this.buttonManager = new _component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__.ButtonManager();\n        this.templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.extensionFolderPath}/src/component/script_repository/public`;\n    }\n    /**\n     * UI\n     */\n    static getInstance() {\n        if (!UIController.instance) {\n            UIController.instance = new UIController();\n        }\n        return UIController.instance;\n    }\n    /**\n     * UI\n     */\n    static destroyInstance() {\n        if (UIController.instance) {\n            UIController.instance.cleanup();\n            UIController.instance = undefined;\n        }\n    }\n    /**\n     * \n     */\n    cleanup() {\n        this.buttonManager.clearButtons();\n        this.baseTemplate = null;\n        this.defaultScriptTemplate = null;\n        this.folderTemplate = null;\n    }\n    /**\n     * UI\n     */\n    async initialize() {\n        await this.initializeTemplates();\n        this.setupScriptRepositoryEvents();\n        this.registerEventListeners();\n        await this.renderScriptLists();\n        (0,_component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__.initScriptButton)();\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.UI_LOADED);\n    }\n    /**\n     * \n     */\n    async initializeTemplates() {\n        this.baseTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'script_item_template', {\n            scriptName: '',\n            id: '',\n            moveTo: '',\n            faIcon: '',\n        }));\n        this.defaultScriptTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'script_default_repository', {\n            scriptName: '',\n            id: '',\n        }));\n        this.folderTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'folder_template', {\n            folderId: '',\n            folderName: '',\n            folderIcon: 'fa-folder',\n            folderColor: document.documentElement.style.getPropertyValue('--SmartThemeBodyColor'),\n        }));\n    }\n    /**\n     * \n     */\n    setupScriptRepositoryEvents() {\n        $('#global-script-enable-toggle')\n            .prop('checked', this.scriptManager.isGlobalScriptEnabled)\n            .on('click', (event) => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL,\n                enable: event.target.checked,\n                userInput: true,\n            });\n        });\n        $('#character-script-enable-toggle')\n            .prop('checked', this.scriptManager.isCharacterScriptEnabled)\n            .on('click', (event) => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER,\n                enable: event.target.checked,\n                userInput: true,\n            });\n        });\n        $('#create-script').on('click', async () => {\n            await this.showCreateScriptDialog();\n        });\n        $('#import-script-file').on('change', async function () {\n            let target = 'global';\n            const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(`${_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.extensionFolderPath}/src/component/script_repository/public`, 'script_target_selector', {\n                title: ':',\n                prefix: 'script-import',\n                globalLabel: '',\n                characterLabel: '',\n            }));\n            template.find('#script-import-target-global').on('input', () => (target = 'global'));\n            template.find('#script-import-target-character').on('input', () => (target = 'character'));\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '',\n                cancelButton: '',\n            });\n            if (result) {\n                const inputElement = this instanceof HTMLInputElement && this;\n                if (inputElement && inputElement.files) {\n                    for (const file of inputElement.files) {\n                        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_IMPORT, {\n                            file,\n                            type: target === 'global' ? _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL : _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER,\n                        });\n                    }\n                    inputElement.value = '';\n                }\n            }\n        });\n        $('#import-script').on('click', function () {\n            $('#import-script-file').trigger('click');\n        });\n        $('#create-folder').on('click', () => {\n            this.showCreateFolderDialog();\n        });\n        $('#default-script').on('click', () => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.UI_REFRESH, { action: 'load_default_scripts' });\n        });\n        $('#extensions_settings').css('min-width', '0');\n        this.setupSearchEvents();\n        this.setupBatchOperationEvents();\n    }\n    /**\n     * \n     */\n    registerEventListeners() {\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.UI_REFRESH, async (data) => {\n            const { action } = data;\n            switch (action) {\n                case 'script_toggle':\n                    await this.refreshScriptState(data.script, data.enable);\n                    this.updateParentFolderToggle(data.script.id, data.type);\n                    break;\n                case 'type_toggle':\n                    await this.refreshTypeState(data.type, data.enable);\n                    break;\n                case 'script_import':\n                    await this.addScriptToContainer(data.script, data.type);\n                    break;\n                case 'script_create':\n                    await this.addScriptToContainer(data.script, data.type);\n                    break;\n                case 'script_update':\n                    this.updateScriptUI(data.script, data.type);\n                    break;\n                case 'script_delete':\n                    this.removeScriptElement(data.scriptId);\n                    break;\n                case 'script_move':\n                    this.handleScriptMoved(data.script, data.fromType, data.targetType);\n                    break;\n                case 'folder_move':\n                    await this.renderScriptLists();\n                    break;\n                case 'folder_scripts_toggle':\n                    this.updateFolderAndScriptsUI(data.folderId, data.type, data.enable);\n                    break;\n                case 'load_default_scripts':\n                    await this.loadDefaultScriptsRepository();\n                    break;\n                case 'refresh_global_scripts':\n                    await this.refreshScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n                    break;\n                case 'refresh_charact_scripts':\n                    await this.refreshScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n                    break;\n                default:\n                    console.warn(`[ScriptManager] UI: ${action}`);\n            }\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.BUTTON_ADD, data => {\n            const { script } = data;\n            this.addButton(script);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.BUTTON_REMOVE, data => {\n            const { scriptId } = data;\n            this.buttonManager.removeButtonsByScriptId(scriptId);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_EDIT, async (data) => {\n            const { type, scriptId } = data;\n            await this.openScriptEditor(type, scriptId);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_CREATE, async (data) => {\n            const { name, type, icon, color } = data;\n            await this.handleFolderCreate(name, type, icon, color);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_EDIT, async (data) => {\n            const { folderId, newName, type, newIcon, newColor } = data;\n            await this.handleFolderEdit(folderId, newName, type, newIcon, newColor);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_DELETE, async (data) => {\n            const { folderId, type } = data;\n            await this.handleFolderDelete(folderId, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_SCRIPTS_TOGGLE, async (data) => {\n            const { folderId, type, enable } = data;\n            await this.handleFolderScriptsToggle(folderId, type, enable);\n        });\n    }\n    /**\n     * \n     * @param script \n     */\n    addButton(script) {\n        if (script.buttons && script.buttons.length > 0) {\n            this.buttonManager.addButtonsForScript(script);\n        }\n    }\n    /**\n     * \n     */\n    async renderScriptLists() {\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        await this.renderRepository(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        await this.renderRepository(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n    }\n    /**\n     * \n     * @param type \n     */\n    async renderRepository(type) {\n        const repositoryItems = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        if (repositoryItems.length > 0) {\n            for (const item of repositoryItems) {\n                if (item.type === 'folder') {\n                    await this.renderFolder(item, type);\n                }\n                else {\n                    await this.addScriptToContainer(item.value, type);\n                }\n            }\n        }\n        else {\n            this.showEmptyScriptListTip(type);\n        }\n        this.setupDraggable(type);\n    }\n    /**\n     * \n     * @param type \n     */\n    clearScriptList(type) {\n        $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type)).empty();\n    }\n    /**\n     * \n     * @param type \n     */\n    async refreshScriptList(type) {\n        this.clearScriptList(type);\n        await this.renderRepository(type);\n        const isEnabled = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptManager.isGlobalScriptEnabled\n            : this.scriptManager.isCharacterScriptEnabled;\n        const toggleSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptToggleSelector)(type);\n        $(toggleSelector).prop('checked', isEnabled);\n    }\n    /**\n     * \n     * @param type \n     */\n    showEmptyScriptListTip(type) {\n        const container = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        if (container.find('small').length === 0) {\n            container.append('<small></small>');\n        }\n    }\n    /**\n     * \n     * @param script \n     * @param enable \n     */\n    async refreshScriptState(script, enable) {\n        const $script = $(`#${script.id}`);\n        if ($script.length > 0) {\n            if (enable) {\n                $script.find('.script-toggle').addClass('enabled');\n                $script.find('.script-toggle i.fa-toggle-off').hide();\n                $script.find('.script-toggle i.fa-toggle-on').show();\n            }\n            else {\n                $script.find('.script-toggle').removeClass('enabled');\n                $script.find('.script-toggle i.fa-toggle-off').show();\n                $script.find('.script-toggle i.fa-toggle-on').hide();\n            }\n        }\n    }\n    /**\n     * \n     * @param type \n     * @param enable \n     */\n    async refreshTypeState(type, enable) {\n        const $toggle = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptToggleSelector)(type));\n        $toggle.prop('checked', enable);\n    }\n    /**\n     * UI\n     * @param folderId ID\n     * @param type \n     * @param enable \n     */\n    updateFolderAndScriptsUI(folderId, type, enable) {\n        const $folder = $(`#${folderId}`);\n        if ($folder.length > 0) {\n            this.updateFolderToggleState($folder, folderId, type);\n            const $folderContent = $folder.find('.folder-content');\n            $folderContent.find('.script-item').each((_, element) => {\n                const $script = $(element);\n                const $toggle = $script.find('.script-toggle');\n                if (enable) {\n                    $toggle.addClass('enabled');\n                    $toggle.find('i.fa-toggle-off').hide();\n                    $toggle.find('i.fa-toggle-on').show();\n                }\n                else {\n                    $toggle.removeClass('enabled');\n                    $toggle.find('i.fa-toggle-off').show();\n                    $toggle.find('i.fa-toggle-on').hide();\n                }\n            });\n        }\n    }\n    /**\n     * UI\n     * @param script \n     * @param type \n     */\n    updateScriptUI(script, type) {\n        const $existingScript = $(`#${CSS.escape(script.id)}`);\n        if ($existingScript.length === 0) {\n            this.addScriptToContainer(script, type);\n            return;\n        }\n        $existingScript.find('.script-item-name').text(script.name);\n        const $toggle = $existingScript.find('.script-toggle');\n        if (script.enabled) {\n            $toggle.addClass('enabled');\n            $toggle.find('i.fa-toggle-off').hide();\n            $toggle.find('i.fa-toggle-on').show();\n        }\n        else {\n            $toggle.removeClass('enabled');\n            $toggle.find('i.fa-toggle-off').show();\n            $toggle.find('i.fa-toggle-on').hide();\n        }\n        const $moveButton = $existingScript.find('.script-storage-location');\n        $moveButton.removeClass('move-to-character move-to-global');\n        $moveButton.addClass(type === 'global' ? 'move-to-character' : 'move-to-global');\n        const $moveIcon = $moveButton.find('i');\n        $moveIcon.removeClass('fa-arrow-down fa-arrow-up');\n        $moveIcon.addClass(type === 'global' ? 'fa-arrow-down' : 'fa-arrow-up');\n        this.rebindScriptEvents($existingScript, script, type);\n    }\n    /**\n     * \n     * @param $scriptElement DOM\n     * @param script \n     * @param type \n     */\n    rebindScriptEvents($scriptElement, script, type) {\n        $scriptElement.find('.script-toggle').off('click.scriptToggle');\n        $scriptElement.find('.script-info').off('click.scriptInfo');\n        $scriptElement.find('.edit-script').off('click.scriptEdit');\n        $scriptElement.find('.script-storage-location').off('click.scriptMove');\n        $scriptElement.find('.export-script').off('click.scriptExport');\n        $scriptElement.find('.delete-script').off('click.scriptDelete');\n        const $toggleButton = $scriptElement.find('.script-toggle');\n        $toggleButton.on('click.scriptToggle', function () {\n            const isEnabled = $(this).hasClass('enabled');\n            const newState = !isEnabled;\n            if (newState) {\n                $(this).addClass('enabled');\n                $(this).find('i.fa-toggle-off').hide();\n                $(this).find('i.fa-toggle-on').show();\n            }\n            else {\n                $(this).removeClass('enabled');\n                $(this).find('i.fa-toggle-off').show();\n                $(this).find('i.fa-toggle-on').hide();\n            }\n            script.enabled = newState;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_TOGGLE, {\n                script,\n                type,\n                enable: newState,\n                userInput: true,\n            });\n        });\n        $scriptElement.find('.script-info').on('click.scriptInfo', () => {\n            const scriptInfo = script.info || '';\n            const htmlText = (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_5__.renderMarkdown)(scriptInfo);\n            (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(htmlText, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.DISPLAY, undefined, { wide: true });\n        });\n        $scriptElement.find('.edit-script').on('click.scriptEdit', e => {\n            e.preventDefault();\n            e.stopPropagation();\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_EDIT, { type, scriptId: script.id });\n        });\n        $scriptElement.find('.script-storage-location').on('click.scriptMove', () => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_MOVE, { script, fromType: type });\n        });\n        $scriptElement.find('.export-script').on('click.scriptExport', async () => {\n            const fileName = `${script.name.replace(/[\\s.<>:\"/\\\\|?*\\x00-\\x1F\\x7F]/g, '_').toLowerCase()}.json`;\n            const scriptData = await this.checkScriptDataAndGetExportData(script);\n            if (scriptData === null) {\n                return;\n            }\n            const fileData = JSON.stringify(scriptData, null, 2);\n            (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.download)(fileData, fileName, 'application/json');\n        });\n        $scriptElement.find('.delete-script').on('click.scriptDelete', async () => {\n            const confirm = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)('', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM);\n            if (!confirm) {\n                return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_DELETE, { scriptId: script.id, type });\n            $scriptElement.remove();\n        });\n    }\n    /**\n     * \n     * @param scriptId ID\n     */\n    removeScriptElement(scriptId) {\n        $(`#${scriptId}`).remove();\n    }\n    /**\n     * \n     * @param script \n     * @param fromType \n     * @param targetType \n     */\n    handleScriptMoved(script, fromType, targetType) {\n        $(`#${script.id}`).remove();\n        const sourceList = fromType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? $('#global-script-list') : $('#character-script-list');\n        if (sourceList.children().length === 0) {\n            this.showEmptyScriptListTip(fromType);\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_import',\n            script,\n            type: targetType,\n        });\n    }\n    /**\n     * \n     * @param script \n     * @param type \n     */\n    async addScriptToContainer(script, type) {\n        const $scriptElement = await this.createScriptElement(script, type);\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        const $emptyTip = list.find('small');\n        if ($emptyTip.length > 0) {\n            $emptyTip.remove();\n        }\n        list.append($scriptElement);\n    }\n    /**\n     * \n     * @param type \n     */\n    setupDraggable(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        list.sortable({\n            delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.getSortableDelay)(),\n            items: '.script-item, .script-folder',\n            handle: '.drag-handle',\n            cursor: 'move',\n            tolerance: 'pointer',\n            placeholder: 'sortable-placeholder',\n            connectWith: '.folder-content',\n            stop: async (_event) => {\n                await this.handleDragStop(type);\n            },\n        });\n        this.setupFolderDropZones(type);\n    }\n    /**\n     * \n     * @param type \n     */\n    setupFolderDraggable(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        list.find('.folder-content').sortable({\n            delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.getSortableDelay)(),\n            items: '.script-item',\n            handle: '.drag-handle',\n            cursor: 'move',\n            tolerance: 'pointer',\n            placeholder: 'sortable-placeholder',\n            connectWith: `${(0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type)}, .folder-content`,\n            stop: async (_event) => {\n                await this.handleDragStop(type);\n            },\n        });\n    }\n    /**\n     * \n     * @param type \n     */\n    setupFolderDropZones(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        list.find('.script-folder').each((_, folderElement) => {\n            this.setupSingleFolderDropZone($(folderElement), type);\n        });\n    }\n    /**\n     * \n     * @param $folder jQuery\n     * @param type \n     */\n    setupSingleFolderDropZone($folder, type) {\n        const $folderContent = $folder.find('.folder-content');\n        $folder.off('.dragdrop');\n        $folder.on('dragover dragenter dragleave drop', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            return false;\n        });\n        $folder.droppable({\n            accept: '.script-item[data-script-repository=\"true\"]',\n            tolerance: 'pointer',\n            greedy: true,\n            over: (_event, ui) => {\n                if (!ui.draggable.hasClass('script-item') || !ui.draggable.attr('data-script-repository'))\n                    return;\n                const isFromSameFolder = ui.draggable.closest('.script-folder').attr('id') === $folder.attr('id');\n                if (isFromSameFolder)\n                    return;\n                $folder.addClass('folder-drag-target');\n                if (!$folderContent.is(':visible')) {\n                    $folderContent.slideDown(200);\n                    $folder.find('.folder-toggle').addClass('expanded');\n                }\n            },\n            out: (_event, ui) => {\n                if (!ui.draggable.hasClass('script-item') || !ui.draggable.attr('data-script-repository'))\n                    return;\n                const isFromSameFolder = ui.draggable.closest('.script-folder').attr('id') === $folder.attr('id');\n                if (isFromSameFolder)\n                    return;\n                $folder.removeClass('folder-drag-target');\n            },\n            drop: async (event, ui) => {\n                if (event.originalEvent) {\n                    event.originalEvent.preventDefault();\n                    event.originalEvent.stopPropagation();\n                }\n                event.preventDefault();\n                event.stopImmediatePropagation();\n                if (!ui.draggable.hasClass('script-item') || !ui.draggable.attr('data-script-repository'))\n                    return;\n                const scriptId = ui.draggable.attr('id');\n                const folderId = $folder.attr('id');\n                const isFromSameFolder = ui.draggable.closest('.script-folder').attr('id') === folderId;\n                if (isFromSameFolder) {\n                    $folder.removeClass('folder-drag-target');\n                    return false;\n                }\n                if (scriptId && folderId) {\n                    try {\n                        const success = await this.handleScriptDropToFolder(scriptId, folderId, type, ui.draggable);\n                        if (!success) {\n                            $folder.removeClass('folder-drag-target');\n                            setTimeout(async () => {\n                                await this.renderScriptLists();\n                            }, 100);\n                            return false;\n                        }\n                    }\n                    catch (error) {\n                        console.error('[ScriptManager] :', error);\n                        toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n                        $folder.removeClass('folder-drag-target');\n                        setTimeout(async () => {\n                            await this.renderScriptLists();\n                        }, 100);\n                        return false;\n                    }\n                }\n                $folder.removeClass('folder-drag-target');\n                return false;\n            },\n        });\n    }\n    /**\n     * \n     * @param scriptId ID\n     * @param folderId ID\n     * @param type \n     * @param $draggedElement \n     * @returns \n     */\n    async handleScriptDropToFolder(scriptId, folderId, type, $draggedElement) {\n        try {\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n            if (folder) {\n                const scripts = folder.value;\n                const scriptExists = scripts.some(script => script.id === scriptId);\n                if (scriptExists) {\n                    toastr.info('');\n                    return false;\n                }\n            }\n            await this.scriptManager.moveScriptToFolder(scriptId, folderId, type);\n            const $targetFolder = $(`#${folderId}`);\n            const $folderContent = $targetFolder.find('.folder-content');\n            if (!$folderContent.is(':visible')) {\n                $folderContent.show();\n                $targetFolder.find('.folder-toggle').addClass('expanded');\n            }\n            $draggedElement.detach().prependTo($folderContent);\n            return true;\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            throw error;\n        }\n    }\n    /**\n     * \n     * @param ui jQuery UI \n     * @param type \n     */\n    async handleDragStop(type) {\n        try {\n            const repositoryItems = await this.buildRepositoryFromDOM(type);\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.ORDER_CHANGED, {\n                data: repositoryItems,\n                type,\n            });\n        }\n        catch (error) {\n            console.error('[ScriptManager] handleDragStop: :', error);\n        }\n    }\n    /**\n     * DOM\n     * @param type \n     */\n    async buildRepositoryFromDOM(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        const repository = [];\n        for (const element of list.children().get()) {\n            const $element = $(element);\n            if ($element.hasClass('script-folder')) {\n                const folderId = $element.attr('id');\n                const folderName = $element.find('.folder-name').text();\n                const folderIcon = $element\n                    .find('.folder-icon i')\n                    .attr('class')\n                    ?.split(' ')\n                    .find(cls => cls.startsWith('fa-')) || 'fa-folder';\n                const folderColor = $element.find('.folder-icon').css('color') ||\n                    document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n                const scripts = [];\n                const $folderContent = $element.find('.folder-content');\n                for (const scriptElement of $folderContent.children('.script-item').get()) {\n                    const scriptId = $(scriptElement).attr('id');\n                    const script = this.scriptManager.getScriptById(scriptId);\n                    if (script) {\n                        scripts.push(script);\n                    }\n                }\n                repository.push({\n                    type: 'folder',\n                    id: folderId,\n                    name: folderName,\n                    icon: folderIcon,\n                    color: folderColor,\n                    value: scripts,\n                });\n            }\n            else if ($element.hasClass('script-item')) {\n                const scriptId = $element.attr('id');\n                const script = this.scriptManager.getScriptById(scriptId);\n                if (script) {\n                    repository.push({\n                        type: 'script',\n                        value: script,\n                    });\n                }\n            }\n        }\n        return repository;\n    }\n    /**\n     * \n     * @param script \n     */\n    async cloneDefaultScriptTemplate(script) {\n        if (!this.defaultScriptTemplate) {\n            await this.initializeTemplates();\n        }\n        const scriptHtml = this.defaultScriptTemplate.clone();\n        const tempId = `default_lib_${script.id}`;\n        scriptHtml.attr('id', tempId);\n        scriptHtml.find('.script-item-name').text(script.name);\n        scriptHtml.find('.script-info').on('click', () => {\n            const htmlText = (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_5__.renderMarkdown)(script.info);\n            (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(htmlText, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.DISPLAY, undefined, { wide: true });\n        });\n        scriptHtml.find('.add-script').on('click', async () => {\n            let target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL;\n            const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'script_target_selector', {\n                title: ':',\n                prefix: 'script-add',\n                globalLabel: '',\n                characterLabel: '',\n            }));\n            template.find('#script-add-target-global').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL));\n            template.find('#script-add-target-character').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER));\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '',\n                cancelButton: '',\n            });\n            if (!result) {\n                return;\n            }\n            const newScript = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({ ...script, enabled: false });\n            let action = 'new';\n            const existing_script = this.scriptManager.getScriptById(script.id);\n            if (existing_script) {\n                const input = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(` '${script.name}'  '${existing_script.name}' id `, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.TEXT, '', {\n                    okButton: '',\n                    cancelButton: '',\n                    customButtons: [''],\n                });\n                switch (input) {\n                    case 0:\n                        action = 'cancel';\n                        break;\n                    case 1:\n                        action = 'override';\n                        break;\n                    case 2:\n                        action = 'new';\n                        break;\n                }\n            }\n            switch (action) {\n                case 'new':\n                    if (existing_script) {\n                        newScript.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.uuidv4)();\n                    }\n                    break;\n                case 'override':\n                    {\n                        if (!existing_script) {\n                            return;\n                        }\n                        $(`#${existing_script.id}`).remove();\n                        if (existing_script.enabled) {\n                            await this.scriptManager.stopScript(existing_script, target);\n                            this.buttonManager.removeButtonsByScriptId(existing_script.id);\n                        }\n                    }\n                    break;\n                case 'cancel':\n                    return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_CREATE, { script: newScript, type: target });\n            toastr.success(`\"${newScript.name}\"${target === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '' : ''}`);\n        });\n        return scriptHtml;\n    }\n    /**\n     * \n     * \n     */\n    createDefaultScriptContainer() {\n        return $('<div class=\"default-script-repository-container\"></div>');\n    }\n    /**\n     * \n     */\n    async loadDefaultScriptsRepository() {\n        const createDefaultScripts = (await __webpack_require__.e(/*! import() */ \"src_component_script_repository_builtin_scripts_ts\").then(__webpack_require__.bind(__webpack_require__, /*! ./builtin_scripts */ \"./src/component/script_repository/builtin_scripts.ts\"))).createDefaultScripts;\n        const container = this.createDefaultScriptContainer();\n        const defaultScripts = await createDefaultScripts();\n        for (const script of defaultScripts) {\n            if (!script)\n                continue;\n            const scriptHtml = await this.cloneDefaultScriptTemplate(script);\n            container.append(scriptHtml);\n        }\n        await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(container, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.DISPLAY, '', { wide: true });\n    }\n    /**\n     * \n     * @param type \n     * @param scriptId ID\n     */\n    async openScriptEditor(type, scriptId) {\n        const $editorHtml = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'script_editor'));\n        let script;\n        this.updateVariableListVisibility($editorHtml);\n        if (scriptId) {\n            script = this.scriptManager.getScriptById(scriptId);\n            if (script) {\n                $editorHtml.find('#script-name-input').val(script.name);\n                $editorHtml.find('#script-content-textarea').val(script.content);\n                $editorHtml.find('#script-info-textarea').val(script.info);\n                if (script.data && Object.keys(script.data).length > 0) {\n                    this.loadVariablesToEditor($editorHtml, script.data);\n                }\n                if (script.buttons && script.buttons.length > 0) {\n                    script.buttons.forEach((button, buttonIndex) => {\n                        const $buttonHtml = $(`\n              <div class=\"button-item\" id=\"button-${buttonIndex}\">\n                <span class=\"drag-handle menu-handle\"></span>\n                <input type=\"checkbox\" id=\"checkbox-button-${buttonIndex}\" class=\"button-visible\" ${button.visible ? 'checked' : ''}>\n                <input class=\"text_pole button-name\" type=\"text\" id=\"text-button-${buttonIndex}\" value=\"${button.name}\" placeholder=\"\">\n                <div class=\"delete-button menu_button interactable\" data-index=\"${buttonIndex}\">\n                  <i class=\"fa-solid fa-trash\"></i>\n                </div>\n              </div>\n            `);\n                        $editorHtml.find('.button-list').append($buttonHtml);\n                    });\n                }\n            }\n        }\n        $editorHtml.find('#add-variable-trigger').on('click', () => {\n            this.addVariableToEditor($editorHtml);\n        });\n        $editorHtml.find('#add-button-trigger').on('click', () => {\n            const buttonIndex = $editorHtml.find('.button-list .button-item').length;\n            const buttonId = `button-${buttonIndex}`;\n            const $buttonContent = $(`<div class=\"button-item\" id=\"${buttonId}\">\n        <span class=\"drag-handle menu-handle\"></span>\n        <input type=\"checkbox\" id=\"checkbox-${buttonId}\" class=\"button-visible\" checked>\n        <input class=\"text_pole button-name\" type=\"text\" id=\"text-${buttonId}\" placeholder=\"\">\n        <div class=\"delete-button menu_button interactable\" data-index=\"${buttonIndex}\">\n          <i class=\"fa-solid fa-trash\"></i>\n        </div>\n      </div>`);\n            $editorHtml.find('.button-list').append($buttonContent);\n        });\n        $editorHtml.find('#script-button-content .button-list').sortable({\n            handle: '.drag-handle',\n            items: '.button-item',\n        });\n        $editorHtml.on('click', '.delete-button', (e) => {\n            $(e.currentTarget).closest('.button-item').remove();\n        });\n        $editorHtml.on('click', '.delete-variable', (e) => {\n            $(e.currentTarget).closest('.variable-item').remove();\n            this.updateVariableListVisibility($editorHtml);\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)($editorHtml, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n            wide: true,\n            okButton: '',\n            cancelButton: '',\n        });\n        if (!result) {\n            return;\n        }\n        const scriptName = String($editorHtml.find('#script-name-input').val());\n        const scriptContent = String($editorHtml.find('#script-content-textarea').val());\n        const scriptInfo = String($editorHtml.find('#script-info-textarea').val());\n        const variableData = this.collectVariablesFromEditor($editorHtml);\n        const buttons = [];\n        $editorHtml.find('.button-list .button-item').each(function () {\n            const buttonName = $(this).find('.button-name').val();\n            const visible = $(this).find('.button-visible').prop('checked');\n            if (buttonName && buttonName.trim() !== '') {\n                buttons.push({ name: buttonName, visible });\n            }\n        });\n        if (!script) {\n            script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                id: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.uuidv4)(),\n                name: scriptName,\n                content: scriptContent,\n                info: scriptInfo,\n                enabled: false,\n                buttons,\n                data: variableData,\n            });\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_CREATE, { script, type });\n        }\n        else {\n            const wasEnabled = script.enabled;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n            script.name = scriptName;\n            script.content = scriptContent;\n            script.info = scriptInfo;\n            script.buttons = buttons;\n            script.data = variableData;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_UPDATE, { script, type });\n            if (wasEnabled) {\n                try {\n                    await this.scriptManager.stopScript(script, type);\n                    await this.scriptManager.runScript(script, type);\n                }\n                catch (error) {\n                    console.error(`[ScriptManager] : ${script.name}`, error);\n                    toastr.error(`: ${script.name}`);\n                }\n            }\n        }\n    }\n    /**\n     * \n     * @param $editorHtml HTML\n     * @param data \n     */\n    loadVariablesToEditor($editorHtml, data) {\n        const $variableList = $editorHtml.find('#variable-list');\n        for (const [key, value] of Object.entries(data)) {\n            const $variableItem = this.createVariableItem(key, value);\n            $variableList.append($variableItem);\n        }\n        this.updateVariableListVisibility($editorHtml);\n    }\n    /**\n     * \n     * @param $editorHtml HTML\n     */\n    addVariableToEditor($editorHtml) {\n        const $variableList = $editorHtml.find('#variable-list');\n        const $variableItem = this.createVariableItem('', '');\n        $variableList.append($variableItem);\n        this.updateVariableListVisibility($editorHtml);\n    }\n    /**\n     * \n     * @param $editorHtml HTML\n     */\n    updateVariableListVisibility($editorHtml) {\n        const $variableList = $editorHtml.find('#variable-list');\n        const variableCount = $variableList.find('.variable-item').length;\n        if (variableCount === 0) {\n            $variableList.hide();\n        }\n        else {\n            $variableList.show();\n        }\n    }\n    /**\n     * \n     * @param key \n     * @param value \n     * @returns JQuery\n     */\n    createVariableItem(key, value) {\n        const valueStr = typeof value === 'string' ? value : JSON.stringify(value);\n        const $variableItem = $(`\n      <div class=\"variable-item flex-container flexFlowColumn width100p\">\n        <div class=\"flex flexFlowColumn\">\n        <div class=\"flex-container alignitemscenter spaceBetween wide100p\">\n          <div>:</div>\n          <div class=\"menu_button interactable delete-variable\" title=\"\">\n            <i class=\"fa-solid fa-trash\"></i>\n          </div>\n          </div>\n          <input type=\"text\" class=\"text_pole variable-key\" value=\"${this.escapeHtml(key)}\" placeholder=\"\">\n        </div>\n        <div class=\"flex flexFlowColumn\" style=\"align-items: flex-start;\">\n          <div>:</div>\n          <textarea class=\"text_pole variable-value\" style=\"min-height: 12px;\" rows=\"1\" placeholder=\"\">${this.escapeHtml(valueStr)}</textarea>\n        </div>\n      <hr>\n      </div>\n    `);\n        return $variableItem;\n    }\n    /**\n     * \n     * @param $editorHtml HTML\n     * @returns \n     */\n    collectVariablesFromEditor($editorHtml) {\n        const variables = {};\n        $editorHtml.find('#variable-list .variable-item').each(function () {\n            const key = $(this).find('.variable-key').val();\n            const valueStr = $(this).find('.variable-value').val();\n            if (key && key.trim() !== '') {\n                let value;\n                try {\n                    value = JSON.parse(valueStr);\n                }\n                catch {\n                    value = valueStr;\n                }\n                variables[key.trim()] = value;\n            }\n        });\n        return variables;\n    }\n    /**\n     * HTML\n     * @param text \n     * @returns \n     */\n    escapeHtml(text) {\n        const div = document.createElement('div');\n        div.textContent = text;\n        return div.innerHTML;\n    }\n    /**\n     * \n     * @param characterId id\n     * @param enableableScripts \n     */\n    async checkEmbeddedScripts(characterId) {\n        const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('script.characters_with_scripts') || [];\n        const avatar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_6__.characters[characterId]?.avatar;\n        if (charactersWithScripts.includes(avatar)) {\n            return;\n        }\n        const checkKey = `AlertScript_${avatar}`;\n        if (!localStorage.getItem(checkKey)) {\n            localStorage.setItem(checkKey, 'true');\n            const template = await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(`${_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.extensionFolderPath}/src/component/script_repository/public`, 'script_allow_popup');\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '',\n                cancelButton: '',\n            });\n            if (result) {\n                if (avatar && !charactersWithScripts.includes(avatar)) {\n                    charactersWithScripts.push(avatar);\n                    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.saveSettingValue)('script.characters_with_scripts', charactersWithScripts);\n                }\n                $('#character-script-enable-toggle').prop('checked', true);\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                    type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER,\n                    enable: true,\n                    userInput: false,\n                });\n            }\n            else {\n                $('#character-script-enable-toggle').prop('checked', false);\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                    type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER,\n                    enable: false,\n                    userInput: false,\n                });\n            }\n        }\n    }\n    /**\n     * \n     * @param folderItem \n     * @param type \n     */\n    async renderFolder(folderItem, type) {\n        const container = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        if (!this.folderTemplate) {\n            await this.initializeTemplates();\n        }\n        const folderId = folderItem.id;\n        const folderName = folderItem.name;\n        const folderIcon = folderItem.icon || 'fa-folder';\n        const folderColor = folderItem.color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n        const moveIcon = type === 'global' ? 'fa-arrow-down' : 'fa-arrow-up';\n        const moveClass = type === 'global' ? 'move-to-character' : 'move-to-global';\n        const moveTitle = type === 'global' ? '' : '';\n        const folderHtml = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'folder_template', {\n            folderId,\n            folderName,\n            folderIcon,\n            folderColor,\n            moveIcon,\n            moveClass,\n            moveTitle,\n        }));\n        this.bindFolderEvents(folderHtml, folderId, folderColor, type);\n        const scripts = folderItem.value;\n        const folderContent = folderHtml.find('.folder-content');\n        for (const script of scripts) {\n            const scriptElement = await this.createScriptElement(script, type);\n            folderContent.append(scriptElement);\n        }\n        container.append(folderHtml);\n        this.setupFolderDraggable(type);\n        this.setupSingleFolderDropZone(folderHtml, type);\n    }\n    /**\n     * \n     * @param folderHtml HTML\n     * @param folderId ID\n     * @param folderColor \n     * @param type \n     */\n    bindFolderEvents(folderHtml, folderId, folderColor, type) {\n        folderHtml.find('.folder-header').on('click', e => {\n            if ($(e.target).closest('.folder-control').length > 0)\n                return;\n            if ($(e.target).closest('.folder-checkbox').length > 0 || $(e.target).hasClass('folder-checkbox'))\n                return;\n            const content = folderHtml.find('.folder-content');\n            const toggle = folderHtml.find('.folder-toggle');\n            if (content.is(':visible')) {\n                content.slideUp();\n                toggle.removeClass('expanded');\n            }\n            else {\n                content.slideDown();\n                toggle.addClass('expanded');\n            }\n        });\n        const $folderToggle = folderHtml.find('.folder-script-toggle');\n        $folderToggle.on('click', e => {\n            e.stopPropagation();\n            const isEnabled = $folderToggle.hasClass('enabled');\n            const newState = !isEnabled;\n            if (newState) {\n                $folderToggle.addClass('enabled');\n                $folderToggle.find('i.fa-toggle-off').hide();\n                $folderToggle.find('i.fa-toggle-on').show();\n            }\n            else {\n                $folderToggle.removeClass('enabled');\n                $folderToggle.find('i.fa-toggle-off').show();\n                $folderToggle.find('i.fa-toggle-on').hide();\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_SCRIPTS_TOGGLE, {\n                folderId,\n                type,\n                enable: newState,\n            });\n        });\n        folderHtml.find('.folder-edit').on('click', e => {\n            e.stopPropagation();\n            this.showEditFolderDialog(folderId, type);\n        });\n        folderHtml.find('.folder-export').on('click', e => {\n            e.stopPropagation();\n            this.exportFolder(folderId, type);\n        });\n        folderHtml.find('.folder-move').on('click', e => {\n            e.stopPropagation();\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_MOVE, {\n                folderId,\n                fromType: type,\n            });\n        });\n        folderHtml.find('.folder-delete').on('click', e => {\n            e.stopPropagation();\n            this.showDeleteFolderDialog(folderId, type);\n        });\n        folderHtml.find('.folder-icon').css('color', folderColor);\n        this.updateFolderToggleState(folderHtml, folderId, type);\n    }\n    /**\n     * UI\n     * @param folderHtml HTML\n     * @param folderId ID\n     * @param type \n     */\n    updateFolderToggleState(folderHtml, folderId, type) {\n        const state = this.scriptManager.getFolderScriptsState(folderId, type);\n        const $folderToggle = folderHtml.find('.folder-script-toggle');\n        $folderToggle.removeClass('enabled');\n        if (state === 'all') {\n            $folderToggle.addClass('enabled');\n            $folderToggle.find('i.fa-toggle-off').hide();\n            $folderToggle.find('i.fa-toggle-on').show();\n        }\n        else {\n            $folderToggle.find('i.fa-toggle-off').show();\n            $folderToggle.find('i.fa-toggle-on').hide();\n        }\n    }\n    /**\n     * \n     * @param scriptId ID\n     * @param type \n     */\n    updateParentFolderToggle(scriptId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        for (const item of repository) {\n            if (item.type === 'folder') {\n                const scripts = item.value;\n                const hasScript = scripts.some(script => script.id === scriptId);\n                if (hasScript) {\n                    const $folder = $(`#${item.id}`);\n                    if ($folder.length > 0) {\n                        this.updateFolderToggleState($folder, item.id, type);\n                    }\n                    break;\n                }\n            }\n        }\n    }\n    /**\n     * \n     * @param script \n     * @param type \n     */\n    async createScriptElement(script, type) {\n        if (!this.baseTemplate) {\n            await this.initializeTemplates();\n        }\n        const scriptHtml = this.baseTemplate.clone();\n        scriptHtml.attr('id', script.id);\n        scriptHtml.attr('data-script-repository', 'true');\n        scriptHtml.find('.script-item-name').text(script.name);\n        scriptHtml.find('.script-storage-location').addClass(type === 'global' ? 'move-to-character' : 'move-to-global');\n        scriptHtml.find('.script-storage-location i').addClass(type === 'global' ? 'fa-arrow-down' : 'fa-arrow-up');\n        const $toggleButton = scriptHtml.find('.script-toggle');\n        if (script.enabled) {\n            $toggleButton.addClass('enabled');\n            $toggleButton.find('i.fa-toggle-off').hide();\n            $toggleButton.find('i.fa-toggle-on').show();\n        }\n        else {\n            $toggleButton.removeClass('enabled');\n            $toggleButton.find('i.fa-toggle-off').show();\n            $toggleButton.find('i.fa-toggle-on').hide();\n        }\n        this.bindScriptEvents(scriptHtml, script, type);\n        return scriptHtml;\n    }\n    /**\n     * data\n     * @param script \n     * @returns enablednull\n     */\n    async checkScriptDataAndGetExportData(script) {\n        const { enabled, ...scriptData } = script;\n        const hasData = script.data && Object.keys(script.data).length > 0;\n        if (hasData) {\n            try {\n                const choice = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(` \"${script.name}\" API-KEY`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.TEXT, '', {\n                    okButton: '',\n                    cancelButton: '',\n                    customButtons: [''],\n                });\n                switch (choice) {\n                    case 0:\n                        return null;\n                    case 1:\n                        return scriptData;\n                    case 2:\n                        return { ...scriptData, data: {} };\n                    default:\n                        return null;\n                }\n            }\n            catch (error) {\n                console.error('[ScriptManager] :', error);\n                return scriptData;\n            }\n        }\n        return scriptData;\n    }\n    /**\n     * \n     * @param scriptHtml HTML\n     * @param script \n     * @param type \n     */\n    bindScriptEvents(scriptHtml, script, type) {\n        const $toggleButton = scriptHtml.find('.script-toggle');\n        $toggleButton.on('click.scriptToggle', function () {\n            const isEnabled = $(this).hasClass('enabled');\n            const newState = !isEnabled;\n            if (newState) {\n                $(this).addClass('enabled');\n                $(this).find('i.fa-toggle-off').hide();\n                $(this).find('i.fa-toggle-on').show();\n            }\n            else {\n                $(this).removeClass('enabled');\n                $(this).find('i.fa-toggle-off').show();\n                $(this).find('i.fa-toggle-on').hide();\n            }\n            script.enabled = newState;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_TOGGLE, {\n                script,\n                type,\n                enable: newState,\n                userInput: true,\n            });\n        });\n        scriptHtml.find('.script-info').on('click.scriptInfo', () => {\n            const scriptInfo = script.info || '';\n            const htmlText = (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_5__.renderMarkdown)(scriptInfo);\n            (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(htmlText, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.DISPLAY, undefined, { wide: true });\n        });\n        scriptHtml.find('.edit-script').on('click.scriptEdit', e => {\n            e.preventDefault();\n            e.stopPropagation();\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_EDIT, { type, scriptId: script.id });\n        });\n        scriptHtml.find('.script-storage-location').on('click.scriptMove', () => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_MOVE, { script, fromType: type });\n        });\n        scriptHtml.find('.export-script').on('click.scriptExport', async () => {\n            const fileName = `${script.name.replace(/[\\s.<>:\"/\\\\|?*\\x00-\\x1F\\x7F]/g, '_').toLowerCase()}.json`;\n            const scriptData = await this.checkScriptDataAndGetExportData(script);\n            if (scriptData === null) {\n                return;\n            }\n            const fileData = JSON.stringify(scriptData, null, 2);\n            (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.download)(fileData, fileName, 'application/json');\n        });\n        scriptHtml.find('.delete-script').on('click.scriptDelete', async () => {\n            const confirm = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)('', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM);\n            if (!confirm) {\n                return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_DELETE, { scriptId: script.id, type });\n            scriptHtml.remove();\n        });\n    }\n    /**\n     * \n     */\n    async showCreateScriptDialog() {\n        let target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL;\n        const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'script_target_selector', {\n            title: ':',\n            prefix: 'script-create',\n            globalLabel: '',\n            characterLabel: '',\n        }));\n        template.find('#script-create-target-global').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL));\n        template.find('#script-create-target-character').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER));\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '',\n            cancelButton: '',\n        });\n        if (result) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_EDIT, {\n                type: target,\n            });\n        }\n    }\n    /**\n     * \n     */\n    async showCreateFolderDialog() {\n        const defaultColor = document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n        const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'folder_create', { defaultColor }, false));\n        let folderColor;\n        template.find('#folder-icon-preview').on('click', async () => {\n            try {\n                const selectedIcon = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.showFontAwesomePicker)();\n                if (selectedIcon && selectedIcon.trim() !== '') {\n                    template.find('#folder-icon-preview').removeClass().addClass(`fa ${selectedIcon}`);\n                    template.find('#folder-icon-value').val(selectedIcon);\n                }\n            }\n            catch (error) {\n                console.error('[ScriptManager] :', error);\n            }\n        });\n        template.find('#folder-color-picker').on('change', evt => {\n            // @ts-ignore\n            folderColor = evt.detail?.rgba;\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '',\n            cancelButton: '',\n        });\n        if (!result) {\n            return;\n        }\n        const folderName = template.find('#folder-name-input').val();\n        const folderIcon = template.find('#folder-icon-value').val();\n        const selectedType = template.find('#folder-target-global').prop('checked')\n            ? _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            : _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER;\n        if (!folderName || folderName.trim() === '') {\n            toastr.error('');\n            return;\n        }\n        try {\n            const existingFolders = selectedType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folderExists = existingFolders.some(item => item.type === 'folder' && item.name === folderName.trim());\n            if (folderExists) {\n                toastr.error(`${selectedType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '' : ''} \"${folderName.trim()}\" `);\n                return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_CREATE, {\n                name: folderName.trim(),\n                type: selectedType,\n                icon: folderIcon,\n                color: folderColor,\n            });\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     */\n    async showEditFolderDialog(folderId, type) {\n        const currentName = $(`#${folderId} .folder-name`).text();\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        const currentIcon = folder?.icon || 'fa-folder';\n        const currentColorRgba = folder?.color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n        let newColor;\n        const template = $(`\n      <div class=\"folder-edit-dialog\">\n      <h3></h3>\n      <div class=\"flex-container flexFlowColumn wide100p padding10 justifyLeft\">\n        <div>\n          <h4>:</h4>\n          <input type=\"text\" id=\"folder-name-input\" class=\"text_pole\" value=\"${currentName}\" />\n        </div>\n        <div>\n          <h4>:</h4>\n          <div class=\"flex\" style=\"gap: 20px; margin: 5px 0; width: 100%;\">\n            <div class=\"flex alignItemsCenter\">\n            <label></label>\n            <toolcool-color-picker id=\"folder-color-picker\" color=\"${currentColorRgba}\"></toolcool-color-picker>\n            </div>  \n            <div class=\"flex-container alignItemsCenter\">\n             <label></label>\n              <i id=\"folder-icon-preview\" class=\"fa ${currentIcon} marginRight10\" style=\"cursor: pointer; font-size: 12px; padding: 4px; border: 1px solid #ccc; border-radius: 4px;\" title=\"\"></i>\n              <input type=\"hidden\" id=\"folder-icon-value\" value=\"${currentIcon}\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    `);\n        template.find('#folder-icon-preview').on('click', async () => {\n            try {\n                const selectedIcon = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.showFontAwesomePicker)();\n                if (selectedIcon && selectedIcon.trim() !== '') {\n                    template.find('#folder-icon-preview').removeClass().addClass(`fa ${selectedIcon}`);\n                    template.find('#folder-icon-value').val(selectedIcon);\n                }\n            }\n            catch (error) {\n                console.error('[ScriptManager] :', error);\n            }\n        });\n        template.find('#folder-color-picker').on('change', evt => {\n            // @ts-ignore\n            newColor = evt.detail?.rgba;\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '',\n            cancelButton: '',\n        });\n        if (!result) {\n            return;\n        }\n        const newName = template.find('#folder-name-input').val();\n        const newIcon = template.find('#folder-icon-value').val();\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_EDIT, {\n            folderId,\n            newName: newName?.trim() || currentName,\n            type,\n            newIcon: newIcon,\n            newColor: newColor,\n        });\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     */\n    async exportFolder(folderId, type) {\n        try {\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n            if (!folder) {\n                toastr.error('');\n                return;\n            }\n            //@ts-ignore\n            if (!window.JSZip) {\n                await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @sillytavern/lib/jszip.min.js */ \"@sillytavern/lib/jszip.min.js\"));\n            }\n            //@ts-ignore\n            const zip = new JSZip();\n            const folderName = folder.name || 'folder';\n            const sanitizedFolderName = folderName.replace(/[<>:\"/\\\\|?*]/g, '_');\n            if (Array.isArray(folder.value)) {\n                let cancelExport = false;\n                for (const script of folder.value) {\n                    const scriptData = await this.checkScriptDataAndGetExportData(script);\n                    if (scriptData === null) {\n                        cancelExport = true;\n                        break;\n                    }\n                    const scriptFileName = `${script.name.replace(/[<>:\"/\\\\|?*]/g, '_')}.json`;\n                    zip.file(`${sanitizedFolderName}/${scriptFileName}`, JSON.stringify(scriptData, null, 2));\n                }\n                if (cancelExport) {\n                    return;\n                }\n            }\n            const zipBlob = await zip.generateAsync({ type: 'blob' });\n            const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');\n            const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? 'global' : 'character';\n            const filename = `folder_${sanitizedFolderName}_${typeName}_${timestamp}.zip`;\n            const url = URL.createObjectURL(zipBlob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = filename;\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n            toastr.success(` \"${folder.name}\" `);\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     */\n    async showDeleteFolderDialog(folderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        const folderName = folder?.name || '';\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(` \"${folderName}\" `, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', { okButton: '', cancelButton: '' });\n        if (result) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_DELETE, {\n                folderId,\n                type,\n            });\n        }\n    }\n    /**\n     * \n     */\n    setupSearchEvents() {\n        const searchInput = $('#script-search-input');\n        searchInput.on('input', event => {\n            const query = event.target.value.trim();\n            if (query) {\n                this.performSearch(query);\n            }\n            else {\n                this.clearSearch();\n            }\n        });\n        searchInput.on('keypress', event => {\n            if (event.which === 13) {\n                const query = searchInput.val();\n                if (query && query.trim()) {\n                    this.performSearch(query.trim());\n                }\n            }\n        });\n    }\n    /**\n     * \n     * @param query \n     */\n    performSearch(query) {\n        if (!query) {\n            this.clearSearch();\n            return;\n        }\n        const globalScripts = this.scriptManager.getGlobalScripts();\n        const characterScripts = this.scriptManager.getCharacterScripts();\n        const globalMatches = this.searchScripts(globalScripts, query);\n        const characterMatches = this.searchScripts(characterScripts, query);\n        this.displaySearchResults(globalMatches, characterMatches);\n    }\n    /**\n     * \n     * @param scripts \n     * @param query \n     * @returns \n     */\n    searchScripts(scripts, query) {\n        const lowerQuery = query.toLowerCase();\n        return scripts.filter(script => script.name.toLowerCase().includes(lowerQuery));\n    }\n    /**\n     * \n     * @param globalMatches \n     * @param characterMatches \n     */\n    async displaySearchResults(globalMatches, characterMatches) {\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        const globalContainer = $('#global-script-list');\n        if (globalMatches.length > 0) {\n            for (const script of globalMatches) {\n                await this.addScriptToContainer(script, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n            }\n        }\n        else {\n            globalContainer.append('<small></small>');\n        }\n        const characterContainer = $('#character-script-list');\n        if (characterMatches.length > 0) {\n            for (const script of characterMatches) {\n                await this.addScriptToContainer(script, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n            }\n        }\n        else {\n            characterContainer.append('<small></small>');\n        }\n    }\n    /**\n     * \n     */\n    clearSearch() {\n        this.renderScriptLists();\n    }\n    /**\n     * \n     */\n    setupBatchOperationEvents() {\n        $('#global-batch-manager').on('click', () => {\n            this.toggleBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        });\n        $('#character-batch-manager').on('click', () => {\n            this.toggleBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        });\n        $('#global-batch-delete').on('click', () => {\n            this.performBatchDelete(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        });\n        $('#global-batch-export').on('click', () => {\n            this.performBatchExport(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        });\n        $('#global-batch-move').on('click', () => {\n            this.performBatchMove(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        });\n        $('#global-batch-cancel').on('click', () => {\n            this.exitBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        });\n        $('#character-batch-delete').on('click', () => {\n            this.performBatchDelete(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        });\n        $('#character-batch-export').on('click', () => {\n            this.performBatchExport(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        });\n        $('#character-batch-move').on('click', () => {\n            this.performBatchMove(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        });\n        $('#character-batch-cancel').on('click', () => {\n            this.exitBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        });\n    }\n    /**\n     * \n     * @param type \n     */\n    toggleBatchMode(type) {\n        const isBatchMode = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.batchModeGlobal : this.batchModeCharacter;\n        if (isBatchMode) {\n            this.exitBatchMode(type);\n        }\n        else {\n            this.enterBatchMode(type);\n        }\n    }\n    /**\n     * \n     * @param type \n     */\n    enterBatchMode(type) {\n        const listSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type);\n        const controlsSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getBatchControlsSelector)(type);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL) {\n            this.batchModeGlobal = true;\n        }\n        else {\n            this.batchModeCharacter = true;\n        }\n        $(controlsSelector).show();\n        const $list = $(listSelector);\n        $list.find('.script-item').each((_, element) => {\n            const $element = $(element);\n            $element.addClass('batch-mode');\n            $element.find('.script-checkbox').show();\n            $element.find('.drag-handle').hide();\n            $element.find('.script-item-control').hide();\n            $element\n                .find('.script-checkbox')\n                .off('change.batch')\n                .on('change.batch', () => {\n                this.handleCheckboxChange($element);\n            });\n        });\n        $list.find('.script-folder').each((_, element) => {\n            const $element = $(element);\n            $element.addClass('batch-mode');\n            $element.find('.folder-checkbox').show();\n            $element.find('.drag-handle').hide();\n            $element.find('.folder-control .folder-script-toggle').hide();\n            $element.find('.folder-control .folder-edit').hide();\n            $element.find('.folder-control .folder-export').hide();\n            $element.find('.folder-control .folder-move').hide();\n            $element.find('.folder-control .folder-delete').hide();\n            $element\n                .find('.folder-checkbox')\n                .off('change.batch')\n                .on('change.batch', () => {\n                this.handleCheckboxChange($element);\n            });\n        });\n    }\n    /**\n     * \n     * @param type \n     */\n    exitBatchMode(type) {\n        const listSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type);\n        const controlsSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getBatchControlsSelector)(type);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL) {\n            this.batchModeGlobal = false;\n        }\n        else {\n            this.batchModeCharacter = false;\n        }\n        $(controlsSelector).hide();\n        const $list = $(listSelector);\n        $list.find('.script-item, .script-folder').each((_, element) => {\n            const $element = $(element);\n            $element.removeClass('batch-mode selected');\n            $element.find('.script-checkbox, .folder-checkbox').hide().prop('checked', false);\n            $element.find('.script-item-control').show();\n            $element.find('.drag-handle').show();\n            $element.find('.script-controls').show();\n            $element.find('.folder-control .folder-script-toggle').show();\n            $element.find('.folder-control .folder-edit').show();\n            $element.find('.folder-control .folder-export').show();\n            $element.find('.folder-control .folder-move').show();\n            $element.find('.folder-control .folder-delete').show();\n            $element.find('.script-checkbox, .folder-checkbox').off('change.batch');\n        });\n    }\n    /**\n     * css\n     * @param $element jQuery\n     */\n    handleCheckboxChange($element) {\n        const isChecked = $element.find('.script-checkbox, .folder-checkbox').prop('checked');\n        if (isChecked) {\n            $element.addClass('selected');\n        }\n        else {\n            $element.removeClass('selected');\n        }\n    }\n    /**\n     * \n     * @param type \n     * @returns IDID\n     */\n    getSelectedItems(type) {\n        const listSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type);\n        const scriptIds = [];\n        const folderIds = [];\n        $(listSelector)\n            .find('.script-item.selected')\n            .each((_, element) => {\n            const id = $(element).attr('id');\n            if (id)\n                scriptIds.push(id);\n        });\n        $(listSelector)\n            .find('.script-folder.selected')\n            .each((_, element) => {\n            const id = $(element).attr('id');\n            if (id)\n                folderIds.push(id);\n        });\n        return { scriptIds, folderIds };\n    }\n    /**\n     * \n     * @param type \n     */\n    async performBatchDelete(type) {\n        const { scriptIds, folderIds } = this.getSelectedItems(type);\n        if (scriptIds.length === 0 && folderIds.length === 0) {\n            toastr.warning('');\n            return;\n        }\n        const totalCount = scriptIds.length + folderIds.length;\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(` ${totalCount} `, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', { okButton: '', cancelButton: '' });\n        if (!result)\n            return;\n        try {\n            for (const scriptId of scriptIds) {\n                await this.scriptManager.deleteScript(scriptId, type);\n            }\n            for (const folderId of folderIds) {\n                await this.handleFolderDelete(folderId, type, true);\n            }\n            toastr.success(` ${totalCount} `);\n            this.exitBatchMode(type);\n            await this.renderScriptLists();\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * \n     * @param type \n     */\n    async performBatchExport(type) {\n        const { scriptIds, folderIds } = this.getSelectedItems(type);\n        if (scriptIds.length === 0 && folderIds.length === 0) {\n            toastr.warning('');\n            return;\n        }\n        try {\n            //@ts-ignore\n            if (!window.JSZip) {\n                await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @sillytavern/lib/jszip.min.js */ \"@sillytavern/lib/jszip.min.js\"));\n            }\n            //@ts-ignore\n            const zip = new JSZip();\n            let exportedCount = 0;\n            let cancelExport = false;\n            for (const scriptId of scriptIds) {\n                const script = this.scriptManager.getScriptById(scriptId);\n                if (script) {\n                    const scriptData = await this.checkScriptDataAndGetExportData(script);\n                    if (scriptData === null) {\n                        cancelExport = true;\n                        break;\n                    }\n                    const scriptFileName = `${script.name.replace(/[<>:\"/\\\\|?*]/g, '_')}.json`;\n                    zip.file(scriptFileName, JSON.stringify(scriptData, null, 2));\n                    exportedCount++;\n                }\n            }\n            if (cancelExport) {\n                return;\n            }\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            for (const folderId of folderIds) {\n                const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n                if (folder) {\n                    const folderName = folder.name || 'folder';\n                    const sanitizedFolderName = folderName.replace(/[<>:\"/\\\\|?*]/g, '_');\n                    if (Array.isArray(folder.value)) {\n                        for (const script of folder.value) {\n                            const scriptData = await this.checkScriptDataAndGetExportData(script);\n                            if (scriptData === null) {\n                                cancelExport = true;\n                                break;\n                            }\n                            const scriptFileName = `${script.name.replace(/[<>:\"/\\\\|?*]/g, '_')}.json`;\n                            zip.file(`${sanitizedFolderName}/${scriptFileName}`, JSON.stringify(scriptData, null, 2));\n                        }\n                        if (cancelExport) {\n                            break;\n                        }\n                    }\n                    exportedCount++;\n                }\n            }\n            if (cancelExport) {\n                return;\n            }\n            if (exportedCount === 0) {\n                toastr.error('');\n                return;\n            }\n            const zipBlob = await zip.generateAsync({ type: 'blob' });\n            const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');\n            const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? 'global' : 'character';\n            const filename = `batch_export_${typeName}_${timestamp}.zip`;\n            const url = URL.createObjectURL(zipBlob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = filename;\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n            toastr.success(` ${exportedCount} `);\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * \n     * @param type \n     */\n    async performBatchMove(type) {\n        const { scriptIds, folderIds } = this.getSelectedItems(type);\n        if (folderIds.length > 0) {\n            toastr.error('');\n            return;\n        }\n        if (scriptIds.length === 0) {\n            toastr.warning('');\n            return;\n        }\n        try {\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folders = repository.filter(item => item.type === 'folder');\n            if (folders.length === 0) {\n                toastr.error('');\n                return;\n            }\n            const folderOptions = folders.map(folder => `<option value=\"${folder.id}\">${folder.name}</option>`).join('');\n            const template = $(`\n        <div>\n          <p></p>\n          <select id=\"target-folder-select\" class=\"text_pole\" style=\"width: 100%;\">\n            <option value=\"\"></option>\n            ${folderOptions}\n          </select>\n        </div>\n      `);\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '',\n                cancelButton: '',\n            });\n            if (!result)\n                return;\n            const targetFolderId = template.find('#target-folder-select').val() || null;\n            for (const scriptId of scriptIds) {\n                await this.scriptManager.moveScriptToFolder(scriptId, targetFolderId, type);\n            }\n            const targetName = targetFolderId ? folders.find(f => f.id === targetFolderId)?.name || '' : '';\n            toastr.success(` ${scriptIds.length} \"${targetName}\"`);\n            this.exitBatchMode(type);\n            await this.renderScriptLists();\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * \n     * @param name \n     * @param type \n     * @param icon \n     */\n    async handleFolderCreate(name, type, icon, color) {\n        try {\n            await this.scriptManager.createFolder(name, type, icon, color);\n            await this.renderScriptLists();\n            toastr.success(` \"${name}\" `);\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param newName \n     * @param type \n     * @param newIcon \n     * @param newColor \n     */\n    async handleFolderEdit(folderId, newName, type, newIcon, newColor) {\n        try {\n            await this.scriptManager.editFolder(folderId, newName, type, newIcon, newColor);\n            if (newName) {\n                $(`#${folderId} .folder-name`).text(newName);\n            }\n            if (newIcon) {\n                $(`#${folderId} .folder-icon`).removeClass().addClass(`fa ${newIcon} folder-icon marginLeft5`);\n            }\n            if (newColor) {\n                $(`#${folderId} .folder-icon`).css('color', newColor);\n                $(`#${folderId} .folder-header`).css('border-left-color', newColor);\n            }\n            toastr.success(``);\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     * @param skipUIRefresh UI\n     */\n    async handleFolderDelete(folderId, type, skipUIRefresh = false) {\n        try {\n            await this.scriptManager.deleteFolder(folderId, type);\n            if (!skipUIRefresh) {\n                await this.renderScriptLists();\n                toastr.success('');\n            }\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            if (!skipUIRefresh) {\n                toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n            }\n            throw error;\n        }\n    }\n    /**\n     * \n     * @param folderId ID\n     * @param type \n     * @param enable \n     */\n    async handleFolderScriptsToggle(folderId, type, enable) {\n        try {\n            await this.scriptManager.toggleFolderScripts(folderId, type, enable);\n            this.updateFolderAndScriptsUI(folderId, type, enable);\n        }\n        catch (error) {\n            console.error('[ScriptManager] :', error);\n            toastr.error(`: ${error instanceof Error ? error.message : ''}`);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3VpX2NvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBdUY7QUFDUTtBQUNmO0FBUW5DO0FBQ3VEO0FBQzVDO0FBQ1A7QUFDOEI7QUFDTDtBQUM2QjtBQUVoRyxNQUFNLFlBQVk7SUFDZixNQUFNLENBQUMsUUFBUSxDQUFlO0lBRTlCLGFBQWEsQ0FBZ0I7SUFDN0IsYUFBYSxDQUFnQjtJQUU3QixZQUFZLENBQVM7SUFDckIsWUFBWSxHQUErQixJQUFJLENBQUM7SUFDaEQscUJBQXFCLEdBQStCLElBQUksQ0FBQztJQUN6RCxjQUFjLEdBQStCLElBQUksQ0FBQztJQUVsRCxlQUFlLEdBQVksS0FBSyxDQUFDO0lBQ2pDLGtCQUFrQixHQUFZLEtBQUssQ0FBQztJQUU1QztRQUNFLElBQUksQ0FBQyxhQUFhLEdBQUcseUZBQWEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNqRCxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksOEVBQWEsRUFBRSxDQUFDO1FBQ3pDLElBQUksQ0FBQyxZQUFZLEdBQUcsR0FBRywwRUFBbUIseUNBQXlDLENBQUM7SUFDdEYsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLFdBQVc7UUFDdkIsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMzQixZQUFZLENBQUMsUUFBUSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDN0MsQ0FBQztRQUNELE9BQU8sWUFBWSxDQUFDLFFBQVEsQ0FBQztJQUMvQixDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsZUFBZTtRQUMzQixJQUFJLFlBQVksQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMxQixZQUFZLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ2hDLFlBQVksQ0FBQyxRQUFRLEdBQUcsU0FBb0MsQ0FBQztRQUMvRCxDQUFDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ks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O1FBQ2QsQ0FBQztJQUNILENBQUM7SUFFRDs7Ozs7T0FLRztJQUNLLEtBQUssQ0FBQyx5QkFBeUIsQ0FBQyxRQUFnQixFQUFFLElBQWdCLEVBQUUsTUFBZTtRQUN6RixJQUFJLENBQUM7WUFDSCxNQUFNLElBQUksQ0FBQyxhQUFhLENBQUMsbUJBQW1CLENBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztZQUNyRSxJQUFJLENBQUMsd0JBQXdCLENBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztRQUN4RCxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE9BQU8sQ0FBQyxLQUFLLENBQUMsZ0NBQWdDLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDdkQsTUFBTSxDQUFDLEtBQUssQ0FBQyxlQUFlLEtBQUssWUFBWSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDakYsQ0FBQztJQUNILENBQUM7Q0FDRiIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvdWlfY29udHJvbGxlci50cz84MDZhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJ1dHRvbk1hbmFnZXIsIGluaXRTY3JpcHRCdXR0b24gfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9idXR0b24nO1xuaW1wb3J0IHsgc2NyaXB0RXZlbnRzLCBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvZXZlbnRzJztcbmltcG9ydCB7IFNjcmlwdE1hbmFnZXIgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9zY3JpcHRfY29udHJvbGxlcic7XG5pbXBvcnQge1xuICBnZXRCYXRjaENvbnRyb2xzU2VsZWN0b3IsXG4gIGdldFNjcmlwdExpc3RTZWxlY3RvcixcbiAgZ2V0U2NyaXB0VG9nZ2xlU2VsZWN0b3IsXG4gIFNjcmlwdCxcbiAgU2NyaXB0UmVwb3NpdG9yeUl0ZW0sXG4gIFNjcmlwdFR5cGUsXG59IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3R5cGVzJztcbmltcG9ydCB7IGV4dGVuc2lvbkZvbGRlclBhdGgsIGdldFNldHRpbmdWYWx1ZSwgc2F2ZVNldHRpbmdWYWx1ZSB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcbmltcG9ydCB7IHJlbmRlck1hcmtkb3duIH0gZnJvbSAnQC91dGlsL3JlbmRlcl9tYXJrZG93bic7XG5pbXBvcnQgeyBjaGFyYWN0ZXJzIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyBjYWxsR2VuZXJpY1BvcHVwLCBQT1BVUF9UWVBFIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG9wdXAnO1xuaW1wb3J0IHsgZG93bmxvYWQsIGdldFNvcnRhYmxlRGVsYXksIHNob3dGb250QXdlc29tZVBpY2tlciwgdXVpZHY0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVUlDb250cm9sbGVyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFVJQ29udHJvbGxlcjtcblxuICBwcml2YXRlIHNjcmlwdE1hbmFnZXI6IFNjcmlwdE1hbmFnZXI7XG4gIHByaXZhdGUgYnV0dG9uTWFuYWdlcjogQnV0dG9uTWFuYWdlcjtcblxuICBwcml2YXRlIHRlbXBsYXRlUGF0aDogc3RyaW5nO1xuICBwcml2YXRlIGJhc2VUZW1wbGF0ZTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGRlZmF1bHRTY3JpcHRUZW1wbGF0ZTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGZvbGRlclRlbXBsYXRlOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHwgbnVsbCA9IG51bGw7XG5cbiAgcHJpdmF0ZSBiYXRjaE1vZGVHbG9iYWw6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBiYXRjaE1vZGVDaGFyYWN0ZXI6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc2NyaXB0TWFuYWdlciA9IFNjcmlwdE1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICB0aGlzLmJ1dHRvbk1hbmFnZXIgPSBuZXcgQnV0dG9uTWFuYWdlcigpO1xuICAgIHRoaXMudGVtcGxhdGVQYXRoID0gYCR7ZXh0ZW5zaW9uRm9sZGVyUGF0aH0vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9wdWJsaWNgO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPllVJ5o6n5Yi25Zmo5a6e5L6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IFVJQ29udHJvbGxlciB7XG4gICAgaWYgKCFVSUNvbnRyb2xsZXIuaW5zdGFuY2UpIHtcbiAgICAgIFVJQ29udHJvbGxlci5pbnN0YW5jZSA9IG5ldyBVSUNvbnRyb2xsZXIoKTtcbiAgICB9XG4gICAgcmV0dXJuIFVJQ29udHJvbGxlci5pbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDplIDmr4FVSeaOp+WItuWZqOWunuS+i1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBkZXN0cm95SW5zdGFuY2UoKTogdm9pZCB7XG4gICAgaWYgKFVJQ29udHJvbGxlci5pbnN0YW5jZSkge1xuICAgICAgVUlDb250cm9sbGVyLmluc3RhbmNlLmNsZWFudXAoKTtcbiAgICAgIFVJQ29udHJvbGxlci5pbnN0YW5jZSA9IHVuZGVmaW5lZCBhcyB1bmtub3duIGFzIFVJQ29udHJvbGxlcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5riF55CG6LWE5rqQXG4gICAqL1xuICBwdWJsaWMgY2xlYW51cCgpOiB2b2lkIHtcbiAgICB0aGlzLmJ1dHRvbk1hbmFnZXIuY2xlYXJCdXR0b25zKCk7XG4gICAgdGhpcy5iYXNlVGVtcGxhdGUgPSBudWxsO1xuICAgIHRoaXMuZGVmYXVsdFNjcmlwdFRlbXBsYXRlID0gbnVsbDtcbiAgICB0aGlzLmZvbGRlclRlbXBsYXRlID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJZVSVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGluaXRpYWxpemUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5pbml0aWFsaXplVGVtcGxhdGVzKCk7XG5cbiAgICB0aGlzLnNldHVwU2NyaXB0UmVwb3NpdG9yeUV2ZW50cygpO1xuXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICBhd2FpdCB0aGlzLnJlbmRlclNjcmlwdExpc3RzKCk7XG5cbiAgICBpbml0U2NyaXB0QnV0dG9uKCk7XG5cbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX0xPQURFRCk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5qih5p2/XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVUZW1wbGF0ZXMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5iYXNlVGVtcGxhdGUgPSAkKFxuICAgICAgYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyh0aGlzLnRlbXBsYXRlUGF0aCwgJ3NjcmlwdF9pdGVtX3RlbXBsYXRlJywge1xuICAgICAgICBzY3JpcHROYW1lOiAnJyxcbiAgICAgICAgaWQ6ICcnLFxuICAgICAgICBtb3ZlVG86ICcnLFxuICAgICAgICBmYUljb246ICcnLFxuICAgICAgfSksXG4gICAgKTtcblxuICAgIHRoaXMuZGVmYXVsdFNjcmlwdFRlbXBsYXRlID0gJChcbiAgICAgIGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmModGhpcy50ZW1wbGF0ZVBhdGgsICdzY3JpcHRfZGVmYXVsdF9yZXBvc2l0b3J5Jywge1xuICAgICAgICBzY3JpcHROYW1lOiAnJyxcbiAgICAgICAgaWQ6ICcnLFxuICAgICAgfSksXG4gICAgKTtcblxuICAgIHRoaXMuZm9sZGVyVGVtcGxhdGUgPSAkKFxuICAgICAgYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyh0aGlzLnRlbXBsYXRlUGF0aCwgJ2ZvbGRlcl90ZW1wbGF0ZScsIHtcbiAgICAgICAgZm9sZGVySWQ6ICcnLFxuICAgICAgICBmb2xkZXJOYW1lOiAnJyxcbiAgICAgICAgZm9sZGVySWNvbjogJ2ZhLWZvbGRlcicsXG4gICAgICAgIGZvbGRlckNvbG9yOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLS1TbWFydFRoZW1lQm9keUNvbG9yJyksXG4gICAgICB9KSxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIneWni+WMluiEmuacrOW6k+eVjOmdouS6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cFNjcmlwdFJlcG9zaXRvcnlFdmVudHMoKTogdm9pZCB7XG4gICAgJCgnI2dsb2JhbC1zY3JpcHQtZW5hYmxlLXRvZ2dsZScpXG4gICAgICAucHJvcCgnY2hlY2tlZCcsIHRoaXMuc2NyaXB0TWFuYWdlci5pc0dsb2JhbFNjcmlwdEVuYWJsZWQpXG4gICAgICAub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4ge1xuICAgICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlRZUEVfVE9HR0xFLCB7XG4gICAgICAgICAgdHlwZTogU2NyaXB0VHlwZS5HTE9CQUwsXG4gICAgICAgICAgZW5hYmxlOiBldmVudC50YXJnZXQuY2hlY2tlZCxcbiAgICAgICAgICB1c2VySW5wdXQ6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAkKCcjY2hhcmFjdGVyLXNjcmlwdC1lbmFibGUtdG9nZ2xlJylcbiAgICAgIC5wcm9wKCdjaGVja2VkJywgdGhpcy5zY3JpcHRNYW5hZ2VyLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZClcbiAgICAgIC5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiB7XG4gICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVFlQRV9UT0dHTEUsIHtcbiAgICAgICAgICB0eXBlOiBTY3JpcHRUeXBlLkNIQVJBQ1RFUixcbiAgICAgICAgICBlbmFibGU6IGV2ZW50LnRhcmdldC5jaGVja2VkLFxuICAgICAgICAgIHVzZXJJbnB1dDogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICQoJyNjcmVhdGUtc2NyaXB0Jykub24oJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgdGhpcy5zaG93Q3JlYXRlU2NyaXB0RGlhbG9nKCk7XG4gICAgfSk7XG5cbiAgICAkKCcjaW1wb3J0LXNjcmlwdC1maWxlJykub24oJ2NoYW5nZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB0YXJnZXQgPSAnZ2xvYmFsJztcbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gJChcbiAgICAgICAgYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhcbiAgICAgICAgICBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3B1YmxpY2AsXG4gICAgICAgICAgJ3NjcmlwdF90YXJnZXRfc2VsZWN0b3InLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5a+85YWl5YiwOicsXG4gICAgICAgICAgICBwcmVmaXg6ICdzY3JpcHQtaW1wb3J0JyxcbiAgICAgICAgICAgIGdsb2JhbExhYmVsOiAn5YWo5bGA6ISa5pysJyxcbiAgICAgICAgICAgIGNoYXJhY3RlckxhYmVsOiAn5bGA6YOo6ISa5pysJyxcbiAgICAgICAgICB9LFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICAgIHRlbXBsYXRlLmZpbmQoJyNzY3JpcHQtaW1wb3J0LXRhcmdldC1nbG9iYWwnKS5vbignaW5wdXQnLCAoKSA9PiAodGFyZ2V0ID0gJ2dsb2JhbCcpKTtcbiAgICAgIHRlbXBsYXRlLmZpbmQoJyNzY3JpcHQtaW1wb3J0LXRhcmdldC1jaGFyYWN0ZXInKS5vbignaW5wdXQnLCAoKSA9PiAodGFyZ2V0ID0gJ2NoYXJhY3RlcicpKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAodGVtcGxhdGUsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICAgICAgb2tCdXR0b246ICfnoa7orqQnLFxuICAgICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgY29uc3QgaW5wdXRFbGVtZW50ID0gdGhpcyBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQgJiYgdGhpcztcbiAgICAgICAgaWYgKGlucHV0RWxlbWVudCAmJiBpbnB1dEVsZW1lbnQuZmlsZXMpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgaW5wdXRFbGVtZW50LmZpbGVzKSB7XG4gICAgICAgICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9JTVBPUlQsIHtcbiAgICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgICAgdHlwZTogdGFyZ2V0ID09PSAnZ2xvYmFsJyA/IFNjcmlwdFR5cGUuR0xPQkFMIDogU2NyaXB0VHlwZS5DSEFSQUNURVIsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgICQoJyNpbXBvcnQtc2NyaXB0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgJCgnI2ltcG9ydC1zY3JpcHQtZmlsZScpLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgfSk7XG5cbiAgICAkKCcjY3JlYXRlLWZvbGRlcicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc2hvd0NyZWF0ZUZvbGRlckRpYWxvZygpO1xuICAgIH0pO1xuXG4gICAgJCgnI2RlZmF1bHQtc2NyaXB0Jykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7IGFjdGlvbjogJ2xvYWRfZGVmYXVsdF9zY3JpcHRzJyB9KTtcbiAgICB9KTtcblxuICAgICQoJyNleHRlbnNpb25zX3NldHRpbmdzJykuY3NzKCdtaW4td2lkdGgnLCAnMCcpO1xuXG4gICAgdGhpcy5zZXR1cFNlYXJjaEV2ZW50cygpO1xuXG4gICAgdGhpcy5zZXR1cEJhdGNoT3BlcmF0aW9uRXZlbnRzKCk7XG4gIH1cblxuICAvKipcbiAgICog5rOo5YaM5LqL5Lu255uR5ZCs5ZmoXG4gICAqL1xuICBwcml2YXRlIHJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IGFjdGlvbiB9ID0gZGF0YTtcblxuICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgY2FzZSAnc2NyaXB0X3RvZ2dsZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoU2NyaXB0U3RhdGUoZGF0YS5zY3JpcHQsIGRhdGEuZW5hYmxlKTtcbiAgICAgICAgICB0aGlzLnVwZGF0ZVBhcmVudEZvbGRlclRvZ2dsZShkYXRhLnNjcmlwdC5pZCwgZGF0YS50eXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAndHlwZV90b2dnbGUnOlxuICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaFR5cGVTdGF0ZShkYXRhLnR5cGUsIGRhdGEuZW5hYmxlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2NyaXB0X2ltcG9ydCc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGRTY3JpcHRUb0NvbnRhaW5lcihkYXRhLnNjcmlwdCwgZGF0YS50eXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2NyaXB0X2NyZWF0ZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGRTY3JpcHRUb0NvbnRhaW5lcihkYXRhLnNjcmlwdCwgZGF0YS50eXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2NyaXB0X3VwZGF0ZSc6XG4gICAgICAgICAgdGhpcy51cGRhdGVTY3JpcHRVSShkYXRhLnNjcmlwdCwgZGF0YS50eXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2NyaXB0X2RlbGV0ZSc6XG4gICAgICAgICAgdGhpcy5yZW1vdmVTY3JpcHRFbGVtZW50KGRhdGEuc2NyaXB0SWQpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzY3JpcHRfbW92ZSc6XG4gICAgICAgICAgdGhpcy5oYW5kbGVTY3JpcHRNb3ZlZChkYXRhLnNjcmlwdCwgZGF0YS5mcm9tVHlwZSwgZGF0YS50YXJnZXRUeXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZm9sZGVyX21vdmUnOlxuICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyU2NyaXB0TGlzdHMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZm9sZGVyX3NjcmlwdHNfdG9nZ2xlJzpcbiAgICAgICAgICB0aGlzLnVwZGF0ZUZvbGRlckFuZFNjcmlwdHNVSShkYXRhLmZvbGRlcklkLCBkYXRhLnR5cGUsIGRhdGEuZW5hYmxlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnbG9hZF9kZWZhdWx0X3NjcmlwdHMnOlxuICAgICAgICAgIGF3YWl0IHRoaXMubG9hZERlZmF1bHRTY3JpcHRzUmVwb3NpdG9yeSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdyZWZyZXNoX2dsb2JhbF9zY3JpcHRzJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlZnJlc2hTY3JpcHRMaXN0KFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAncmVmcmVzaF9jaGFyYWN0X3NjcmlwdHMnOlxuICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaFNjcmlwdExpc3QoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGNvbnNvbGUud2FybihgW1NjcmlwdE1hbmFnZXJdIOacquWkhOeQhueahFVJ5Yi35paw5LqL5Lu2OiAke2FjdGlvbn1gKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkJVVFRPTl9BREQsIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyBzY3JpcHQgfSA9IGRhdGE7XG4gICAgICB0aGlzLmFkZEJ1dHRvbihzY3JpcHQpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX1JFTU9WRSwgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHNjcmlwdElkIH0gPSBkYXRhO1xuICAgICAgdGhpcy5idXR0b25NYW5hZ2VyLnJlbW92ZUJ1dHRvbnNCeVNjcmlwdElkKHNjcmlwdElkKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9FRElULCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgdHlwZSwgc2NyaXB0SWQgfSA9IGRhdGE7XG4gICAgICBhd2FpdCB0aGlzLm9wZW5TY3JpcHRFZGl0b3IodHlwZSwgc2NyaXB0SWQpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX0NSRUFURSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IG5hbWUsIHR5cGUsIGljb24sIGNvbG9yIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5oYW5kbGVGb2xkZXJDcmVhdGUobmFtZSwgdHlwZSwgaWNvbiwgY29sb3IpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX0VESVQsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyBmb2xkZXJJZCwgbmV3TmFtZSwgdHlwZSwgbmV3SWNvbiwgbmV3Q29sb3IgfSA9IGRhdGE7XG4gICAgICBhd2FpdCB0aGlzLmhhbmRsZUZvbGRlckVkaXQoZm9sZGVySWQsIG5ld05hbWUsIHR5cGUsIG5ld0ljb24sIG5ld0NvbG9yKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkZPTERFUl9ERUxFVEUsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyBmb2xkZXJJZCwgdHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMuaGFuZGxlRm9sZGVyRGVsZXRlKGZvbGRlcklkLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkZPTERFUl9TQ1JJUFRTX1RPR0dMRSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IGZvbGRlcklkLCB0eXBlLCBlbmFibGUgfSA9IGRhdGE7XG4gICAgICBhd2FpdCB0aGlzLmhhbmRsZUZvbGRlclNjcmlwdHNUb2dnbGUoZm9sZGVySWQsIHR5cGUsIGVuYWJsZSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5re75Yqg5oyJ6ZKuXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqL1xuICBwcml2YXRlIGFkZEJ1dHRvbihzY3JpcHQ6IFNjcmlwdCk6IHZvaWQge1xuICAgIGlmIChzY3JpcHQuYnV0dG9ucyAmJiBzY3JpcHQuYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmJ1dHRvbk1hbmFnZXIuYWRkQnV0dG9uc0ZvclNjcmlwdChzY3JpcHQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuLLmn5PohJrmnKzliJfooahcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVuZGVyU2NyaXB0TGlzdHMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5jbGVhclNjcmlwdExpc3QoU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgIHRoaXMuY2xlYXJTY3JpcHRMaXN0KFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcblxuICAgIGF3YWl0IHRoaXMucmVuZGVyUmVwb3NpdG9yeShTY3JpcHRUeXBlLkdMT0JBTCk7XG5cbiAgICBhd2FpdCB0aGlzLnJlbmRlclJlcG9zaXRvcnkoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4suafk+aMh+Wumuexu+Wei+eahOiEmuacrOS7k+W6k1xuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVuZGVyUmVwb3NpdG9yeSh0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVwb3NpdG9yeUl0ZW1zID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICAgID8gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpXG4gICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgaWYgKHJlcG9zaXRvcnlJdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgcmVwb3NpdG9yeUl0ZW1zKSB7XG4gICAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdmb2xkZXInKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJGb2xkZXIoaXRlbSwgdHlwZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGRTY3JpcHRUb0NvbnRhaW5lcihpdGVtLnZhbHVlIGFzIFNjcmlwdCwgdHlwZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zaG93RW1wdHlTY3JpcHRMaXN0VGlwKHR5cGUpO1xuICAgIH1cblxuICAgIHRoaXMuc2V0dXBEcmFnZ2FibGUodHlwZSk7XG4gIH1cblxuICAvKipcbiAgICog5riF6Zmk5oyH5a6a57G75Z6L55qE6ISa5pys5YiX6KGoXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBjbGVhclNjcmlwdExpc3QodHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgICQoZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpKS5lbXB0eSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIt+aWsOaMh+Wumuexu+Wei+eahOiEmuacrOWIl+ihqFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaFNjcmlwdExpc3QodHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuY2xlYXJTY3JpcHRMaXN0KHR5cGUpO1xuXG4gICAgYXdhaXQgdGhpcy5yZW5kZXJSZXBvc2l0b3J5KHR5cGUpO1xuXG4gICAgY29uc3QgaXNFbmFibGVkID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICAgID8gdGhpcy5zY3JpcHRNYW5hZ2VyLmlzR2xvYmFsU2NyaXB0RW5hYmxlZFxuICAgICAgICA6IHRoaXMuc2NyaXB0TWFuYWdlci5pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQ7XG4gICAgY29uc3QgdG9nZ2xlU2VsZWN0b3IgPSBnZXRTY3JpcHRUb2dnbGVTZWxlY3Rvcih0eXBlKTtcbiAgICAkKHRvZ2dsZVNlbGVjdG9yKS5wcm9wKCdjaGVja2VkJywgaXNFbmFibGVkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrnqbrohJrmnKzliJfooajmj5DnpLpcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIHNob3dFbXB0eVNjcmlwdExpc3RUaXAodHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9ICQoZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpKTtcbiAgICBpZiAoY29udGFpbmVyLmZpbmQoJ3NtYWxsJykubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb250YWluZXIuYXBwZW5kKCc8c21hbGw+5pqC5peg6ISa5pysPC9zbWFsbD4nKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yi35paw6ISa5pys54q25oCBXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55SoXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJlZnJlc2hTY3JpcHRTdGF0ZShzY3JpcHQ6IFNjcmlwdCwgZW5hYmxlOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgJHNjcmlwdCA9ICQoYCMke3NjcmlwdC5pZH1gKTtcbiAgICBpZiAoJHNjcmlwdC5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoZW5hYmxlKSB7XG4gICAgICAgICRzY3JpcHQuZmluZCgnLnNjcmlwdC10b2dnbGUnKS5hZGRDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgICAkc2NyaXB0LmZpbmQoJy5zY3JpcHQtdG9nZ2xlIGkuZmEtdG9nZ2xlLW9mZicpLmhpZGUoKTtcbiAgICAgICAgJHNjcmlwdC5maW5kKCcuc2NyaXB0LXRvZ2dsZSBpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzY3JpcHQuZmluZCgnLnNjcmlwdC10b2dnbGUnKS5yZW1vdmVDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgICAkc2NyaXB0LmZpbmQoJy5zY3JpcHQtdG9nZ2xlIGkuZmEtdG9nZ2xlLW9mZicpLnNob3coKTtcbiAgICAgICAgJHNjcmlwdC5maW5kKCcuc2NyaXB0LXRvZ2dsZSBpLmZhLXRvZ2dsZS1vbicpLmhpZGUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yi35paw6ISa5pys57G75Z6L54q25oCBXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyByZWZyZXNoVHlwZVN0YXRlKHR5cGU6IFNjcmlwdFR5cGUsIGVuYWJsZTogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0ICR0b2dnbGUgPSAkKGdldFNjcmlwdFRvZ2dsZVNlbGVjdG9yKHR5cGUpKTtcbiAgICAkdG9nZ2xlLnByb3AoJ2NoZWNrZWQnLCBlbmFibGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOaWh+S7tuWkueWPiuWFtuWGhemDqOiEmuacrOeahFVJ54q25oCBXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHBhcmFtIGVuYWJsZSDmmK/lkKblkK/nlKhcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlRm9sZGVyQW5kU2NyaXB0c1VJKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUsIGVuYWJsZTogYm9vbGVhbik6IHZvaWQge1xuICAgIGNvbnN0ICRmb2xkZXIgPSAkKGAjJHtmb2xkZXJJZH1gKTtcbiAgICBpZiAoJGZvbGRlci5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLnVwZGF0ZUZvbGRlclRvZ2dsZVN0YXRlKCRmb2xkZXIsIGZvbGRlcklkLCB0eXBlKTtcblxuICAgICAgY29uc3QgJGZvbGRlckNvbnRlbnQgPSAkZm9sZGVyLmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuICAgICAgJGZvbGRlckNvbnRlbnQuZmluZCgnLnNjcmlwdC1pdGVtJykuZWFjaCgoXywgZWxlbWVudCkgPT4ge1xuICAgICAgICBjb25zdCAkc2NyaXB0ID0gJChlbGVtZW50KTtcbiAgICAgICAgY29uc3QgJHRvZ2dsZSA9ICRzY3JpcHQuZmluZCgnLnNjcmlwdC10b2dnbGUnKTtcblxuICAgICAgICBpZiAoZW5hYmxlKSB7XG4gICAgICAgICAgJHRvZ2dsZS5hZGRDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgICAgICR0b2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgICAgICR0b2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb24nKS5zaG93KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJHRvZ2dsZS5yZW1vdmVDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgICAgICR0b2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuc2hvdygpO1xuICAgICAgICAgICR0b2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb24nKS5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlop7ph4/mm7TmlrDohJrmnKxVSVxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrOWvueixoVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlU2NyaXB0VUkoc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCAkZXhpc3RpbmdTY3JpcHQgPSAkKGAjJHtDU1MuZXNjYXBlKHNjcmlwdC5pZCl9YCk7XG5cbiAgICBpZiAoJGV4aXN0aW5nU2NyaXB0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5hZGRTY3JpcHRUb0NvbnRhaW5lcihzY3JpcHQsIHR5cGUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgICRleGlzdGluZ1NjcmlwdC5maW5kKCcuc2NyaXB0LWl0ZW0tbmFtZScpLnRleHQoc2NyaXB0Lm5hbWUpO1xuXG4gICAgY29uc3QgJHRvZ2dsZSA9ICRleGlzdGluZ1NjcmlwdC5maW5kKCcuc2NyaXB0LXRvZ2dsZScpO1xuICAgIGlmIChzY3JpcHQuZW5hYmxlZCkge1xuICAgICAgJHRvZ2dsZS5hZGRDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgJHRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5oaWRlKCk7XG4gICAgICAkdG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuc2hvdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkdG9nZ2xlLnJlbW92ZUNsYXNzKCdlbmFibGVkJyk7XG4gICAgICAkdG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9mZicpLnNob3coKTtcbiAgICAgICR0b2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb24nKS5oaWRlKCk7XG4gICAgfVxuXG4gICAgY29uc3QgJG1vdmVCdXR0b24gPSAkZXhpc3RpbmdTY3JpcHQuZmluZCgnLnNjcmlwdC1zdG9yYWdlLWxvY2F0aW9uJyk7XG4gICAgJG1vdmVCdXR0b24ucmVtb3ZlQ2xhc3MoJ21vdmUtdG8tY2hhcmFjdGVyIG1vdmUtdG8tZ2xvYmFsJyk7XG4gICAgJG1vdmVCdXR0b24uYWRkQ2xhc3ModHlwZSA9PT0gJ2dsb2JhbCcgPyAnbW92ZS10by1jaGFyYWN0ZXInIDogJ21vdmUtdG8tZ2xvYmFsJyk7XG5cbiAgICBjb25zdCAkbW92ZUljb24gPSAkbW92ZUJ1dHRvbi5maW5kKCdpJyk7XG4gICAgJG1vdmVJY29uLnJlbW92ZUNsYXNzKCdmYS1hcnJvdy1kb3duIGZhLWFycm93LXVwJyk7XG4gICAgJG1vdmVJY29uLmFkZENsYXNzKHR5cGUgPT09ICdnbG9iYWwnID8gJ2ZhLWFycm93LWRvd24nIDogJ2ZhLWFycm93LXVwJyk7XG5cbiAgICB0aGlzLnJlYmluZFNjcmlwdEV2ZW50cygkZXhpc3RpbmdTY3JpcHQsIHNjcmlwdCwgdHlwZSk7XG4gIH1cblxuICAvKipcbiAgICog6YeN5paw57uR5a6a6ISa5pys5LqL5Lu2XG4gICAqIEBwYXJhbSAkc2NyaXB0RWxlbWVudCDohJrmnKxET03lhYPntKBcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKzlr7nosaFcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIHJlYmluZFNjcmlwdEV2ZW50cygkc2NyaXB0RWxlbWVudDogSlF1ZXJ5PEhUTUxFbGVtZW50Piwgc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuc2NyaXB0LXRvZ2dsZScpLm9mZignY2xpY2suc2NyaXB0VG9nZ2xlJyk7XG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLnNjcmlwdC1pbmZvJykub2ZmKCdjbGljay5zY3JpcHRJbmZvJyk7XG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLmVkaXQtc2NyaXB0Jykub2ZmKCdjbGljay5zY3JpcHRFZGl0Jyk7XG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLnNjcmlwdC1zdG9yYWdlLWxvY2F0aW9uJykub2ZmKCdjbGljay5zY3JpcHRNb3ZlJyk7XG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLmV4cG9ydC1zY3JpcHQnKS5vZmYoJ2NsaWNrLnNjcmlwdEV4cG9ydCcpO1xuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5kZWxldGUtc2NyaXB0Jykub2ZmKCdjbGljay5zY3JpcHREZWxldGUnKTtcblxuICAgIGNvbnN0ICR0b2dnbGVCdXR0b24gPSAkc2NyaXB0RWxlbWVudC5maW5kKCcuc2NyaXB0LXRvZ2dsZScpO1xuICAgICR0b2dnbGVCdXR0b24ub24oJ2NsaWNrLnNjcmlwdFRvZ2dsZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGlzRW5hYmxlZCA9ICQodGhpcykuaGFzQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgIGNvbnN0IG5ld1N0YXRlID0gIWlzRW5hYmxlZDtcblxuICAgICAgaWYgKG5ld1N0YXRlKSB7XG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICAgJCh0aGlzKS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5oaWRlKCk7XG4gICAgICAgICQodGhpcykuZmluZCgnaS5mYS10b2dnbGUtb24nKS5zaG93KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICQodGhpcykuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuc2hvdygpO1xuICAgICAgICAkKHRoaXMpLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgICAgfVxuXG4gICAgICBzY3JpcHQuZW5hYmxlZCA9IG5ld1N0YXRlO1xuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9UT0dHTEUsIHtcbiAgICAgICAgc2NyaXB0LFxuICAgICAgICB0eXBlLFxuICAgICAgICBlbmFibGU6IG5ld1N0YXRlLFxuICAgICAgICB1c2VySW5wdXQ6IHRydWUsXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5zY3JpcHQtaW5mbycpLm9uKCdjbGljay5zY3JpcHRJbmZvJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2NyaXB0SW5mbyA9IHNjcmlwdC5pbmZvIHx8ICcnO1xuICAgICAgY29uc3QgaHRtbFRleHQgPSByZW5kZXJNYXJrZG93bihzY3JpcHRJbmZvKTtcbiAgICAgIGNhbGxHZW5lcmljUG9wdXAoaHRtbFRleHQsIFBPUFVQX1RZUEUuRElTUExBWSwgdW5kZWZpbmVkLCB7IHdpZGU6IHRydWUgfSk7XG4gICAgfSk7XG5cbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuZWRpdC1zY3JpcHQnKS5vbignY2xpY2suc2NyaXB0RWRpdCcsIGUgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0VESVQsIHsgdHlwZSwgc2NyaXB0SWQ6IHNjcmlwdC5pZCB9KTtcbiAgICB9KTtcblxuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5zY3JpcHQtc3RvcmFnZS1sb2NhdGlvbicpLm9uKCdjbGljay5zY3JpcHRNb3ZlJywgKCkgPT4ge1xuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfTU9WRSwgeyBzY3JpcHQsIGZyb21UeXBlOiB0eXBlIH0pO1xuICAgIH0pO1xuXG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLmV4cG9ydC1zY3JpcHQnKS5vbignY2xpY2suc2NyaXB0RXhwb3J0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZmlsZU5hbWUgPSBgJHtzY3JpcHQubmFtZS5yZXBsYWNlKC9bXFxzLjw+OlwiL1xcXFx8PypcXHgwMC1cXHgxRlxceDdGXS9nLCAnXycpLnRvTG93ZXJDYXNlKCl9Lmpzb25gO1xuICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IGF3YWl0IHRoaXMuY2hlY2tTY3JpcHREYXRhQW5kR2V0RXhwb3J0RGF0YShzY3JpcHQpO1xuXG4gICAgICBpZiAoc2NyaXB0RGF0YSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZpbGVEYXRhID0gSlNPTi5zdHJpbmdpZnkoc2NyaXB0RGF0YSwgbnVsbCwgMik7XG4gICAgICBkb3dubG9hZChmaWxlRGF0YSwgZmlsZU5hbWUsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgfSk7XG5cbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuZGVsZXRlLXNjcmlwdCcpLm9uKCdjbGljay5zY3JpcHREZWxldGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb25maXJtID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCgn56Gu5a6a6KaB5Yig6Zmk6L+Z5Liq6ISa5pys5ZCX77yfJywgUE9QVVBfVFlQRS5DT05GSVJNKTtcblxuICAgICAgaWYgKCFjb25maXJtKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfREVMRVRFLCB7IHNjcmlwdElkOiBzY3JpcHQuaWQsIHR5cGUgfSk7XG4gICAgICAkc2NyaXB0RWxlbWVudC5yZW1vdmUoKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnp7vpmaTohJrmnKzlhYPntKBcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqL1xuICBwcml2YXRlIHJlbW92ZVNjcmlwdEVsZW1lbnQoc2NyaXB0SWQ6IHN0cmluZyk6IHZvaWQge1xuICAgICQoYCMke3NjcmlwdElkfWApLnJlbW92ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuiEmuacrOenu+WKqFxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKiBAcGFyYW0gZnJvbVR5cGUg5rqQ57G75Z6LXG4gICAqIEBwYXJhbSB0YXJnZXRUeXBlIOebruagh+exu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVTY3JpcHRNb3ZlZChzY3JpcHQ6IFNjcmlwdCwgZnJvbVR5cGU6IFNjcmlwdFR5cGUsIHRhcmdldFR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICAkKGAjJHtzY3JpcHQuaWR9YCkucmVtb3ZlKCk7XG5cbiAgICBjb25zdCBzb3VyY2VMaXN0ID0gZnJvbVR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJCgnI2dsb2JhbC1zY3JpcHQtbGlzdCcpIDogJCgnI2NoYXJhY3Rlci1zY3JpcHQtbGlzdCcpO1xuICAgIGlmIChzb3VyY2VMaXN0LmNoaWxkcmVuKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aGlzLnNob3dFbXB0eVNjcmlwdExpc3RUaXAoZnJvbVR5cGUpO1xuICAgIH1cblxuICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgYWN0aW9uOiAnc2NyaXB0X2ltcG9ydCcsXG4gICAgICBzY3JpcHQsXG4gICAgICB0eXBlOiB0YXJnZXRUeXBlLFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWQkeWuueWZqOa3u+WKoOiEmuacrOWFg+e0oFxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgYWRkU2NyaXB0VG9Db250YWluZXIoc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCAkc2NyaXB0RWxlbWVudCA9IGF3YWl0IHRoaXMuY3JlYXRlU2NyaXB0RWxlbWVudChzY3JpcHQsIHR5cGUpO1xuICAgIGNvbnN0IGxpc3QgPSAkKGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKSk7XG5cbiAgICBjb25zdCAkZW1wdHlUaXAgPSBsaXN0LmZpbmQoJ3NtYWxsJyk7XG4gICAgaWYgKCRlbXB0eVRpcC5sZW5ndGggPiAwKSB7XG4gICAgICAkZW1wdHlUaXAucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgbGlzdC5hcHBlbmQoJHNjcmlwdEVsZW1lbnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruiEmuacrOaLluaLveaOkuW6j1xuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgc2V0dXBEcmFnZ2FibGUodHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgIGNvbnN0IGxpc3QgPSAkKGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKSk7XG5cbiAgICBsaXN0LnNvcnRhYmxlKHtcbiAgICAgIGRlbGF5OiBnZXRTb3J0YWJsZURlbGF5KCksXG4gICAgICBpdGVtczogJy5zY3JpcHQtaXRlbSwgLnNjcmlwdC1mb2xkZXInLFxuICAgICAgaGFuZGxlOiAnLmRyYWctaGFuZGxlJyxcbiAgICAgIGN1cnNvcjogJ21vdmUnLFxuICAgICAgdG9sZXJhbmNlOiAncG9pbnRlcicsXG4gICAgICBwbGFjZWhvbGRlcjogJ3NvcnRhYmxlLXBsYWNlaG9sZGVyJyxcbiAgICAgIGNvbm5lY3RXaXRoOiAnLmZvbGRlci1jb250ZW50JyxcblxuICAgICAgc3RvcDogYXN5bmMgX2V2ZW50ID0+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVEcmFnU3RvcCh0eXBlKTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICB0aGlzLnNldHVwRm9sZGVyRHJvcFpvbmVzKHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruaWh+S7tuWkueaLluaLveWKn+iDvVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgc2V0dXBGb2xkZXJEcmFnZ2FibGUodHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgIGNvbnN0IGxpc3QgPSAkKGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKSk7XG5cbiAgICBsaXN0LmZpbmQoJy5mb2xkZXItY29udGVudCcpLnNvcnRhYmxlKHtcbiAgICAgIGRlbGF5OiBnZXRTb3J0YWJsZURlbGF5KCksXG4gICAgICBpdGVtczogJy5zY3JpcHQtaXRlbScsXG4gICAgICBoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuICAgICAgY3Vyc29yOiAnbW92ZScsXG4gICAgICB0b2xlcmFuY2U6ICdwb2ludGVyJyxcbiAgICAgIHBsYWNlaG9sZGVyOiAnc29ydGFibGUtcGxhY2Vob2xkZXInLFxuICAgICAgY29ubmVjdFdpdGg6IGAke2dldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKX0sIC5mb2xkZXItY29udGVudGAsXG4gICAgICBzdG9wOiBhc3luYyBfZXZlbnQgPT4ge1xuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZURyYWdTdG9wKHR5cGUpO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7mlofku7blpLnmi5bmi73mjqXmlLbljLrln59cbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIHNldHVwRm9sZGVyRHJvcFpvbmVzKHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCBsaXN0ID0gJChnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSkpO1xuXG4gICAgbGlzdC5maW5kKCcuc2NyaXB0LWZvbGRlcicpLmVhY2goKF8sIGZvbGRlckVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuc2V0dXBTaW5nbGVGb2xkZXJEcm9wWm9uZSgkKGZvbGRlckVsZW1lbnQpLCB0eXBlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkuLrljZXkuKrmlofku7blpLnorr7nva7mi5bmi73mjqXmlLbljLrln59cbiAgICogQHBhcmFtICRmb2xkZXIg5paH5Lu25aS5alF1ZXJ55a+56LGhXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cFNpbmdsZUZvbGRlckRyb3Bab25lKCRmb2xkZXI6IEpRdWVyeTxIVE1MRWxlbWVudD4sIHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCAkZm9sZGVyQ29udGVudCA9ICRmb2xkZXIuZmluZCgnLmZvbGRlci1jb250ZW50Jyk7XG5cbiAgICAkZm9sZGVyLm9mZignLmRyYWdkcm9wJyk7XG5cbiAgICAkZm9sZGVyLm9uKCdkcmFnb3ZlciBkcmFnZW50ZXIgZHJhZ2xlYXZlIGRyb3AnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgICRmb2xkZXIuZHJvcHBhYmxlKHtcbiAgICAgIGFjY2VwdDogJy5zY3JpcHQtaXRlbVtkYXRhLXNjcmlwdC1yZXBvc2l0b3J5PVwidHJ1ZVwiXScsXG4gICAgICB0b2xlcmFuY2U6ICdwb2ludGVyJyxcbiAgICAgIGdyZWVkeTogdHJ1ZSxcbiAgICAgIG92ZXI6IChfZXZlbnQsIHVpKSA9PiB7XG4gICAgICAgIGlmICghdWkuZHJhZ2dhYmxlLmhhc0NsYXNzKCdzY3JpcHQtaXRlbScpIHx8ICF1aS5kcmFnZ2FibGUuYXR0cignZGF0YS1zY3JpcHQtcmVwb3NpdG9yeScpKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgaXNGcm9tU2FtZUZvbGRlciA9IHVpLmRyYWdnYWJsZS5jbG9zZXN0KCcuc2NyaXB0LWZvbGRlcicpLmF0dHIoJ2lkJykgPT09ICRmb2xkZXIuYXR0cignaWQnKTtcbiAgICAgICAgaWYgKGlzRnJvbVNhbWVGb2xkZXIpIHJldHVybjtcblxuICAgICAgICAkZm9sZGVyLmFkZENsYXNzKCdmb2xkZXItZHJhZy10YXJnZXQnKTtcblxuICAgICAgICBpZiAoISRmb2xkZXJDb250ZW50LmlzKCc6dmlzaWJsZScpKSB7XG4gICAgICAgICAgJGZvbGRlckNvbnRlbnQuc2xpZGVEb3duKDIwMCk7XG4gICAgICAgICAgJGZvbGRlci5maW5kKCcuZm9sZGVyLXRvZ2dsZScpLmFkZENsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb3V0OiAoX2V2ZW50LCB1aSkgPT4ge1xuICAgICAgICBpZiAoIXVpLmRyYWdnYWJsZS5oYXNDbGFzcygnc2NyaXB0LWl0ZW0nKSB8fCAhdWkuZHJhZ2dhYmxlLmF0dHIoJ2RhdGEtc2NyaXB0LXJlcG9zaXRvcnknKSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGlzRnJvbVNhbWVGb2xkZXIgPSB1aS5kcmFnZ2FibGUuY2xvc2VzdCgnLnNjcmlwdC1mb2xkZXInKS5hdHRyKCdpZCcpID09PSAkZm9sZGVyLmF0dHIoJ2lkJyk7XG4gICAgICAgIGlmIChpc0Zyb21TYW1lRm9sZGVyKSByZXR1cm47XG5cbiAgICAgICAgJGZvbGRlci5yZW1vdmVDbGFzcygnZm9sZGVyLWRyYWctdGFyZ2V0Jyk7XG4gICAgICB9LFxuICAgICAgZHJvcDogYXN5bmMgKGV2ZW50LCB1aSkgPT4ge1xuICAgICAgICBpZiAoZXZlbnQub3JpZ2luYWxFdmVudCkge1xuICAgICAgICAgIGV2ZW50Lm9yaWdpbmFsRXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIGlmICghdWkuZHJhZ2dhYmxlLmhhc0NsYXNzKCdzY3JpcHQtaXRlbScpIHx8ICF1aS5kcmFnZ2FibGUuYXR0cignZGF0YS1zY3JpcHQtcmVwb3NpdG9yeScpKSByZXR1cm47XG5cbiAgICAgICAgY29uc3Qgc2NyaXB0SWQgPSB1aS5kcmFnZ2FibGUuYXR0cignaWQnKTtcbiAgICAgICAgY29uc3QgZm9sZGVySWQgPSAkZm9sZGVyLmF0dHIoJ2lkJyk7XG5cbiAgICAgICAgY29uc3QgaXNGcm9tU2FtZUZvbGRlciA9IHVpLmRyYWdnYWJsZS5jbG9zZXN0KCcuc2NyaXB0LWZvbGRlcicpLmF0dHIoJ2lkJykgPT09IGZvbGRlcklkO1xuICAgICAgICBpZiAoaXNGcm9tU2FtZUZvbGRlcikge1xuICAgICAgICAgICRmb2xkZXIucmVtb3ZlQ2xhc3MoJ2ZvbGRlci1kcmFnLXRhcmdldCcpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzY3JpcHRJZCAmJiBmb2xkZXJJZCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgdGhpcy5oYW5kbGVTY3JpcHREcm9wVG9Gb2xkZXIoc2NyaXB0SWQsIGZvbGRlcklkLCB0eXBlLCB1aS5kcmFnZ2FibGUpO1xuXG4gICAgICAgICAgICBpZiAoIXN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgJGZvbGRlci5yZW1vdmVDbGFzcygnZm9sZGVyLWRyYWctdGFyZ2V0Jyk7XG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyU2NyaXB0TGlzdHMoKTtcbiAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5ouW5ou96ISa5pys5Yiw5paH5Lu25aS55aSx6LSlOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRvYXN0ci5lcnJvcihg56e75Yqo6ISa5pys5aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcblxuICAgICAgICAgICAgJGZvbGRlci5yZW1vdmVDbGFzcygnZm9sZGVyLWRyYWctdGFyZ2V0Jyk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAkZm9sZGVyLnJlbW92ZUNsYXNzKCdmb2xkZXItZHJhZy10YXJnZXQnKTtcblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuiEmuacrOaLluaLveWIsOaWh+S7tuWkueeahOS6i+S7tlxuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gJGRyYWdnZWRFbGVtZW50IOaLluaLveeahOWFg+e0oFxuICAgKiBAcmV0dXJucyDmmK/lkKbmiJDlip/np7vliqjohJrmnKxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlU2NyaXB0RHJvcFRvRm9sZGVyKFxuICAgIHNjcmlwdElkOiBzdHJpbmcsXG4gICAgZm9sZGVySWQ6IHN0cmluZyxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgICRkcmFnZ2VkRWxlbWVudDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTFxuICAgICAgICAgID8gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpXG4gICAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICAgIGNvbnN0IGZvbGRlciA9IHJlcG9zaXRvcnkuZmluZChpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5pZCA9PT0gZm9sZGVySWQpO1xuICAgICAgaWYgKGZvbGRlcikge1xuICAgICAgICBjb25zdCBzY3JpcHRzID0gZm9sZGVyLnZhbHVlIGFzIFNjcmlwdFtdO1xuICAgICAgICBjb25zdCBzY3JpcHRFeGlzdHMgPSBzY3JpcHRzLnNvbWUoc2NyaXB0ID0+IHNjcmlwdC5pZCA9PT0gc2NyaXB0SWQpO1xuXG4gICAgICAgIGlmIChzY3JpcHRFeGlzdHMpIHtcbiAgICAgICAgICB0b2FzdHIuaW5mbygn6ISa5pys5bey57uP5Zyo6K+l5paH5Lu25aS55LitJyk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5tb3ZlU2NyaXB0VG9Gb2xkZXIoc2NyaXB0SWQsIGZvbGRlcklkLCB0eXBlKTtcblxuICAgICAgY29uc3QgJHRhcmdldEZvbGRlciA9ICQoYCMke2ZvbGRlcklkfWApO1xuICAgICAgY29uc3QgJGZvbGRlckNvbnRlbnQgPSAkdGFyZ2V0Rm9sZGVyLmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuXG4gICAgICBpZiAoISRmb2xkZXJDb250ZW50LmlzKCc6dmlzaWJsZScpKSB7XG4gICAgICAgICRmb2xkZXJDb250ZW50LnNob3coKTtcbiAgICAgICAgJHRhcmdldEZvbGRlci5maW5kKCcuZm9sZGVyLXRvZ2dsZScpLmFkZENsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgfVxuXG4gICAgICAkZHJhZ2dlZEVsZW1lbnQuZGV0YWNoKCkucHJlcGVuZFRvKCRmb2xkZXJDb250ZW50KTtcblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDnp7vliqjohJrmnKzliLDmlofku7blpLnlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuaLluaLvee7k+adn+S6i+S7tlxuICAgKiBAcGFyYW0gdWkgalF1ZXJ5IFVJIOaLluaLveS6i+S7tuWvueixoVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlRHJhZ1N0b3AodHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXBvc2l0b3J5SXRlbXMgPSBhd2FpdCB0aGlzLmJ1aWxkUmVwb3NpdG9yeUZyb21ET00odHlwZSk7XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuT1JERVJfQ0hBTkdFRCwge1xuICAgICAgICBkYXRhOiByZXBvc2l0b3J5SXRlbXMsXG4gICAgICAgIHR5cGUsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1NjcmlwdE1hbmFnZXJdIGhhbmRsZURyYWdTdG9wOiDlpITnkIbmi5bmi73nu5PmnZ/lpLHotKU6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICog5LuORE9N5p6E5bu65LuT5bqT57uT5p6EXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBidWlsZFJlcG9zaXRvcnlGcm9tRE9NKHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPFNjcmlwdFJlcG9zaXRvcnlJdGVtW10+IHtcbiAgICBjb25zdCBsaXN0ID0gJChnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSkpO1xuICAgIGNvbnN0IHJlcG9zaXRvcnk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBsaXN0LmNoaWxkcmVuKCkuZ2V0KCkpIHtcbiAgICAgIGNvbnN0ICRlbGVtZW50ID0gJChlbGVtZW50KTtcblxuICAgICAgaWYgKCRlbGVtZW50Lmhhc0NsYXNzKCdzY3JpcHQtZm9sZGVyJykpIHtcbiAgICAgICAgY29uc3QgZm9sZGVySWQgPSAkZWxlbWVudC5hdHRyKCdpZCcpITtcbiAgICAgICAgY29uc3QgZm9sZGVyTmFtZSA9ICRlbGVtZW50LmZpbmQoJy5mb2xkZXItbmFtZScpLnRleHQoKTtcbiAgICAgICAgY29uc3QgZm9sZGVySWNvbiA9XG4gICAgICAgICAgJGVsZW1lbnRcbiAgICAgICAgICAgIC5maW5kKCcuZm9sZGVyLWljb24gaScpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnKVxuICAgICAgICAgICAgPy5zcGxpdCgnICcpXG4gICAgICAgICAgICAuZmluZChjbHMgPT4gY2xzLnN0YXJ0c1dpdGgoJ2ZhLScpKSB8fCAnZmEtZm9sZGVyJztcbiAgICAgICAgY29uc3QgZm9sZGVyQ29sb3IgPVxuICAgICAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItaWNvbicpLmNzcygnY29sb3InKSB8fFxuICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLVNtYXJ0VGhlbWVCb2R5Q29sb3InKTtcblxuICAgICAgICBjb25zdCBzY3JpcHRzOiBTY3JpcHRbXSA9IFtdO1xuICAgICAgICBjb25zdCAkZm9sZGVyQ29udGVudCA9ICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuXG4gICAgICAgIGZvciAoY29uc3Qgc2NyaXB0RWxlbWVudCBvZiAkZm9sZGVyQ29udGVudC5jaGlsZHJlbignLnNjcmlwdC1pdGVtJykuZ2V0KCkpIHtcbiAgICAgICAgICBjb25zdCBzY3JpcHRJZCA9ICQoc2NyaXB0RWxlbWVudCkuYXR0cignaWQnKSE7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuICAgICAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgICAgIHNjcmlwdHMucHVzaChzY3JpcHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgdHlwZTogJ2ZvbGRlcicsXG4gICAgICAgICAgaWQ6IGZvbGRlcklkLFxuICAgICAgICAgIG5hbWU6IGZvbGRlck5hbWUsXG4gICAgICAgICAgaWNvbjogZm9sZGVySWNvbixcbiAgICAgICAgICBjb2xvcjogZm9sZGVyQ29sb3IsXG4gICAgICAgICAgdmFsdWU6IHNjcmlwdHMsXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmICgkZWxlbWVudC5oYXNDbGFzcygnc2NyaXB0LWl0ZW0nKSkge1xuICAgICAgICBjb25zdCBzY3JpcHRJZCA9ICRlbGVtZW50LmF0dHIoJ2lkJykhO1xuICAgICAgICBjb25zdCBzY3JpcHQgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0U2NyaXB0QnlJZChzY3JpcHRJZCk7XG4gICAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgICByZXBvc2l0b3J5LnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ3NjcmlwdCcsXG4gICAgICAgICAgICB2YWx1ZTogc2NyaXB0LFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlcG9zaXRvcnk7XG4gIH1cblxuICAvKipcbiAgICog5YWL6ZqG6buY6K6k6ISa5pys5qih5p2/XG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNsb25lRGVmYXVsdFNjcmlwdFRlbXBsYXRlKHNjcmlwdDogU2NyaXB0KTogUHJvbWlzZTxKUXVlcnk8SFRNTEVsZW1lbnQ+PiB7XG4gICAgaWYgKCF0aGlzLmRlZmF1bHRTY3JpcHRUZW1wbGF0ZSkge1xuICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplVGVtcGxhdGVzKCk7XG4gICAgfVxuXG4gICAgY29uc3Qgc2NyaXB0SHRtbCA9IHRoaXMuZGVmYXVsdFNjcmlwdFRlbXBsYXRlIS5jbG9uZSgpO1xuXG4gICAgY29uc3QgdGVtcElkID0gYGRlZmF1bHRfbGliXyR7c2NyaXB0LmlkfWA7XG4gICAgc2NyaXB0SHRtbC5hdHRyKCdpZCcsIHRlbXBJZCk7XG5cbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5zY3JpcHQtaXRlbS1uYW1lJykudGV4dChzY3JpcHQubmFtZSk7XG4gICAgc2NyaXB0SHRtbC5maW5kKCcuc2NyaXB0LWluZm8nKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCBodG1sVGV4dCA9IHJlbmRlck1hcmtkb3duKHNjcmlwdC5pbmZvKTtcbiAgICAgIGNhbGxHZW5lcmljUG9wdXAoaHRtbFRleHQsIFBPUFVQX1RZUEUuRElTUExBWSwgdW5kZWZpbmVkLCB7IHdpZGU6IHRydWUgfSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5hZGQtc2NyaXB0Jykub24oJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHRhcmdldDogU2NyaXB0VHlwZSA9IFNjcmlwdFR5cGUuR0xPQkFMO1xuICAgICAgY29uc3QgdGVtcGxhdGUgPSAkKFxuICAgICAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnc2NyaXB0X3RhcmdldF9zZWxlY3RvcicsIHtcbiAgICAgICAgICB0aXRsZTogJ+a3u+WKoOWIsDonLFxuICAgICAgICAgIHByZWZpeDogJ3NjcmlwdC1hZGQnLFxuICAgICAgICAgIGdsb2JhbExhYmVsOiAn5YWo5bGA6ISa5pys5bqTJyxcbiAgICAgICAgICBjaGFyYWN0ZXJMYWJlbDogJ+inkuiJsuiEmuacrOW6kycsXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICAgIHRlbXBsYXRlLmZpbmQoJyNzY3JpcHQtYWRkLXRhcmdldC1nbG9iYWwnKS5vbignaW5wdXQnLCAoKSA9PiAodGFyZ2V0ID0gU2NyaXB0VHlwZS5HTE9CQUwpKTtcbiAgICAgIHRlbXBsYXRlLmZpbmQoJyNzY3JpcHQtYWRkLXRhcmdldC1jaGFyYWN0ZXInKS5vbignaW5wdXQnLCAoKSA9PiAodGFyZ2V0ID0gU2NyaXB0VHlwZS5DSEFSQUNURVIpKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAodGVtcGxhdGUsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICAgICAgb2tCdXR0b246ICfnoa7orqQnLFxuICAgICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgbmV3U2NyaXB0ID0gbmV3IFNjcmlwdCh7IC4uLnNjcmlwdCwgZW5hYmxlZDogZmFsc2UgfSk7XG5cbiAgICAgIGxldCBhY3Rpb246ICduZXcnIHwgJ292ZXJyaWRlJyB8ICdjYW5jZWwnID0gJ25ldyc7XG5cbiAgICAgIGNvbnN0IGV4aXN0aW5nX3NjcmlwdCA9IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRTY3JpcHRCeUlkKHNjcmlwdC5pZCk7XG4gICAgICBpZiAoZXhpc3Rpbmdfc2NyaXB0KSB7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChcbiAgICAgICAgICBg6KaB5a+85YWl55qE6ISa5pysICcke3NjcmlwdC5uYW1lfScg5LiO6ISa5pys5bqT5Lit55qEICcke2V4aXN0aW5nX3NjcmlwdC5uYW1lfScgaWQg55u45ZCM77yM5piv5ZCm6KaB5a+85YWl77yfYCxcbiAgICAgICAgICBQT1BVUF9UWVBFLlRFWFQsXG4gICAgICAgICAgJycsXG4gICAgICAgICAge1xuICAgICAgICAgICAgb2tCdXR0b246ICfopobnm5bljp/ohJrmnKwnLFxuICAgICAgICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICAgICAgICAgIGN1c3RvbUJ1dHRvbnM6IFsn5paw5bu66ISa5pysJ10sXG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcblxuICAgICAgICBzd2l0Y2ggKGlucHV0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgYWN0aW9uID0gJ2NhbmNlbCc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBhY3Rpb24gPSAnb3ZlcnJpZGUnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgYWN0aW9uID0gJ25ldyc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICBjYXNlICduZXcnOlxuICAgICAgICAgIGlmIChleGlzdGluZ19zY3JpcHQpIHtcbiAgICAgICAgICAgIG5ld1NjcmlwdC5pZCA9IHV1aWR2NCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnb3ZlcnJpZGUnOlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlmICghZXhpc3Rpbmdfc2NyaXB0KSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJChgIyR7ZXhpc3Rpbmdfc2NyaXB0LmlkfWApLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICBpZiAoZXhpc3Rpbmdfc2NyaXB0LmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLnN0b3BTY3JpcHQoZXhpc3Rpbmdfc2NyaXB0LCB0YXJnZXQpO1xuICAgICAgICAgICAgICB0aGlzLmJ1dHRvbk1hbmFnZXIucmVtb3ZlQnV0dG9uc0J5U2NyaXB0SWQoZXhpc3Rpbmdfc2NyaXB0LmlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NhbmNlbCc6XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9DUkVBVEUsIHsgc2NyaXB0OiBuZXdTY3JpcHQsIHR5cGU6IHRhcmdldCB9KTtcblxuICAgICAgdG9hc3RyLnN1Y2Nlc3MoYOiEmuacrFwiJHtuZXdTY3JpcHQubmFtZX1cIuW3sua3u+WKoOWIsCR7dGFyZ2V0ID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/ICflhajlsYAnIDogJ+inkuiJsid96ISa5pys5bqTYCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2NyaXB0SHRtbDtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rpu5jorqTohJrmnKzlupPlrrnlmahcbiAgICog6YG/5YWN6YeN5aSN5riy5p+T5qih5p2/XG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZURlZmF1bHRTY3JpcHRDb250YWluZXIoKTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB7XG4gICAgcmV0dXJuICQoJzxkaXYgY2xhc3M9XCJkZWZhdWx0LXNjcmlwdC1yZXBvc2l0b3J5LWNvbnRhaW5lclwiPjwvZGl2PicpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWKoOi9vem7mOiupOiEmuacrOW6k1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBsb2FkRGVmYXVsdFNjcmlwdHNSZXBvc2l0b3J5KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNyZWF0ZURlZmF1bHRTY3JpcHRzID0gKGF3YWl0IGltcG9ydCgnLi9idWlsdGluX3NjcmlwdHMnKSkuY3JlYXRlRGVmYXVsdFNjcmlwdHM7XG4gICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jcmVhdGVEZWZhdWx0U2NyaXB0Q29udGFpbmVyKCk7XG5cbiAgICBjb25zdCBkZWZhdWx0U2NyaXB0cyA9IGF3YWl0IGNyZWF0ZURlZmF1bHRTY3JpcHRzKCk7XG4gICAgZm9yIChjb25zdCBzY3JpcHQgb2YgZGVmYXVsdFNjcmlwdHMpIHtcbiAgICAgIGlmICghc2NyaXB0KSBjb250aW51ZTtcbiAgICAgIGNvbnN0IHNjcmlwdEh0bWwgPSBhd2FpdCB0aGlzLmNsb25lRGVmYXVsdFNjcmlwdFRlbXBsYXRlKHNjcmlwdCk7XG4gICAgICBjb250YWluZXIuYXBwZW5kKHNjcmlwdEh0bWwpO1xuICAgIH1cblxuICAgIGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoY29udGFpbmVyLCBQT1BVUF9UWVBFLkRJU1BMQVksICcnLCB7IHdpZGU6IHRydWUgfSk7XG4gIH1cblxuICAvKipcbiAgICog5omT5byA6ISa5pys57yW6L6R5ZmoXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgb3BlblNjcmlwdEVkaXRvcih0eXBlOiBTY3JpcHRUeXBlLCBzY3JpcHRJZD86IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0ICRlZGl0b3JIdG1sID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnc2NyaXB0X2VkaXRvcicpKTtcbiAgICBsZXQgc2NyaXB0OiBTY3JpcHQgfCB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLnVwZGF0ZVZhcmlhYmxlTGlzdFZpc2liaWxpdHkoJGVkaXRvckh0bWwpO1xuXG4gICAgaWYgKHNjcmlwdElkKSB7XG4gICAgICBzY3JpcHQgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0U2NyaXB0QnlJZChzY3JpcHRJZCk7XG5cbiAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgJGVkaXRvckh0bWwuZmluZCgnI3NjcmlwdC1uYW1lLWlucHV0JykudmFsKHNjcmlwdC5uYW1lKTtcbiAgICAgICAgJGVkaXRvckh0bWwuZmluZCgnI3NjcmlwdC1jb250ZW50LXRleHRhcmVhJykudmFsKHNjcmlwdC5jb250ZW50KTtcbiAgICAgICAgJGVkaXRvckh0bWwuZmluZCgnI3NjcmlwdC1pbmZvLXRleHRhcmVhJykudmFsKHNjcmlwdC5pbmZvKTtcblxuICAgICAgICBpZiAoc2NyaXB0LmRhdGEgJiYgT2JqZWN0LmtleXMoc2NyaXB0LmRhdGEpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0aGlzLmxvYWRWYXJpYWJsZXNUb0VkaXRvcigkZWRpdG9ySHRtbCwgc2NyaXB0LmRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBzY3JpcHQuYnV0dG9ucy5mb3JFYWNoKChidXR0b24sIGJ1dHRvbkluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCAkYnV0dG9uSHRtbCA9ICQoYFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYnV0dG9uLWl0ZW1cIiBpZD1cImJ1dHRvbi0ke2J1dHRvbkluZGV4fVwiPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZHJhZy1oYW5kbGUgbWVudS1oYW5kbGVcIj7imLA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwiY2hlY2tib3gtYnV0dG9uLSR7YnV0dG9uSW5kZXh9XCIgY2xhc3M9XCJidXR0b24tdmlzaWJsZVwiICR7XG4gICAgICAgICAgICAgIGJ1dHRvbi52aXNpYmxlID8gJ2NoZWNrZWQnIDogJydcbiAgICAgICAgICAgIH0+XG4gICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwidGV4dF9wb2xlIGJ1dHRvbi1uYW1lXCIgdHlwZT1cInRleHRcIiBpZD1cInRleHQtYnV0dG9uLSR7YnV0dG9uSW5kZXh9XCIgdmFsdWU9XCIke1xuICAgICAgICAgICAgICBidXR0b24ubmFtZVxuICAgICAgICAgICAgfVwiIHBsYWNlaG9sZGVyPVwi5oyJ6ZKu5ZCN56ewXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRlbGV0ZS1idXR0b24gbWVudV9idXR0b24gaW50ZXJhY3RhYmxlXCIgZGF0YS1pbmRleD1cIiR7YnV0dG9uSW5kZXh9XCI+XG4gICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhLXNvbGlkIGZhLXRyYXNoXCI+PC9pPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIGApO1xuXG4gICAgICAgICAgICAkZWRpdG9ySHRtbC5maW5kKCcuYnV0dG9uLWxpc3QnKS5hcHBlbmQoJGJ1dHRvbkh0bWwpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgJGVkaXRvckh0bWwuZmluZCgnI2FkZC12YXJpYWJsZS10cmlnZ2VyJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5hZGRWYXJpYWJsZVRvRWRpdG9yKCRlZGl0b3JIdG1sKTtcbiAgICB9KTtcblxuICAgICRlZGl0b3JIdG1sLmZpbmQoJyNhZGQtYnV0dG9uLXRyaWdnZXInKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCBidXR0b25JbmRleCA9ICRlZGl0b3JIdG1sLmZpbmQoJy5idXR0b24tbGlzdCAuYnV0dG9uLWl0ZW0nKS5sZW5ndGg7XG4gICAgICBjb25zdCBidXR0b25JZCA9IGBidXR0b24tJHtidXR0b25JbmRleH1gO1xuICAgICAgY29uc3QgJGJ1dHRvbkNvbnRlbnQgPSAkKGA8ZGl2IGNsYXNzPVwiYnV0dG9uLWl0ZW1cIiBpZD1cIiR7YnV0dG9uSWR9XCI+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwiZHJhZy1oYW5kbGUgbWVudS1oYW5kbGVcIj7imLA8L3NwYW4+XG4gICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cImNoZWNrYm94LSR7YnV0dG9uSWR9XCIgY2xhc3M9XCJidXR0b24tdmlzaWJsZVwiIGNoZWNrZWQ+XG4gICAgICAgIDxpbnB1dCBjbGFzcz1cInRleHRfcG9sZSBidXR0b24tbmFtZVwiIHR5cGU9XCJ0ZXh0XCIgaWQ9XCJ0ZXh0LSR7YnV0dG9uSWR9XCIgcGxhY2Vob2xkZXI9XCLmjInpkq7lkI3np7BcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImRlbGV0ZS1idXR0b24gbWVudV9idXR0b24gaW50ZXJhY3RhYmxlXCIgZGF0YS1pbmRleD1cIiR7YnV0dG9uSW5kZXh9XCI+XG4gICAgICAgICAgPGkgY2xhc3M9XCJmYS1zb2xpZCBmYS10cmFzaFwiPjwvaT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5gKTtcbiAgICAgICRlZGl0b3JIdG1sLmZpbmQoJy5idXR0b24tbGlzdCcpLmFwcGVuZCgkYnV0dG9uQ29udGVudCk7XG4gICAgfSk7XG5cbiAgICAkZWRpdG9ySHRtbC5maW5kKCcjc2NyaXB0LWJ1dHRvbi1jb250ZW50IC5idXR0b24tbGlzdCcpLnNvcnRhYmxlKHtcbiAgICAgIGhhbmRsZTogJy5kcmFnLWhhbmRsZScsXG4gICAgICBpdGVtczogJy5idXR0b24taXRlbScsXG4gICAgfSk7XG5cbiAgICAkZWRpdG9ySHRtbC5vbignY2xpY2snLCAnLmRlbGV0ZS1idXR0b24nLCAoZTogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IHtcbiAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KCcuYnV0dG9uLWl0ZW0nKS5yZW1vdmUoKTtcbiAgICB9KTtcblxuICAgICRlZGl0b3JIdG1sLm9uKCdjbGljaycsICcuZGVsZXRlLXZhcmlhYmxlJywgKGU6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiB7XG4gICAgICAkKGUuY3VycmVudFRhcmdldCkuY2xvc2VzdCgnLnZhcmlhYmxlLWl0ZW0nKS5yZW1vdmUoKTtcbiAgICAgIHRoaXMudXBkYXRlVmFyaWFibGVMaXN0VmlzaWJpbGl0eSgkZWRpdG9ySHRtbCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKCRlZGl0b3JIdG1sLCBQT1BVUF9UWVBFLkNPTkZJUk0sICcnLCB7XG4gICAgICB3aWRlOiB0cnVlLFxuICAgICAgb2tCdXR0b246ICfkv53lrZgnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICB9KTtcblxuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgc2NyaXB0TmFtZSA9IFN0cmluZygkZWRpdG9ySHRtbC5maW5kKCcjc2NyaXB0LW5hbWUtaW5wdXQnKS52YWwoKSk7XG4gICAgY29uc3Qgc2NyaXB0Q29udGVudCA9IFN0cmluZygkZWRpdG9ySHRtbC5maW5kKCcjc2NyaXB0LWNvbnRlbnQtdGV4dGFyZWEnKS52YWwoKSk7XG4gICAgY29uc3Qgc2NyaXB0SW5mbyA9IFN0cmluZygkZWRpdG9ySHRtbC5maW5kKCcjc2NyaXB0LWluZm8tdGV4dGFyZWEnKS52YWwoKSk7XG5cbiAgICBjb25zdCB2YXJpYWJsZURhdGEgPSB0aGlzLmNvbGxlY3RWYXJpYWJsZXNGcm9tRWRpdG9yKCRlZGl0b3JIdG1sKTtcblxuICAgIGNvbnN0IGJ1dHRvbnM6IHsgbmFtZTogc3RyaW5nOyB2aXNpYmxlOiBib29sZWFuIH1bXSA9IFtdO1xuICAgICRlZGl0b3JIdG1sLmZpbmQoJy5idXR0b24tbGlzdCAuYnV0dG9uLWl0ZW0nKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGJ1dHRvbk5hbWUgPSAkKHRoaXMpLmZpbmQoJy5idXR0b24tbmFtZScpLnZhbCgpIGFzIHN0cmluZztcbiAgICAgIGNvbnN0IHZpc2libGUgPSAkKHRoaXMpLmZpbmQoJy5idXR0b24tdmlzaWJsZScpLnByb3AoJ2NoZWNrZWQnKSBhcyBib29sZWFuO1xuICAgICAgaWYgKGJ1dHRvbk5hbWUgJiYgYnV0dG9uTmFtZS50cmltKCkgIT09ICcnKSB7XG4gICAgICAgIGJ1dHRvbnMucHVzaCh7IG5hbWU6IGJ1dHRvbk5hbWUsIHZpc2libGUgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAoIXNjcmlwdCkge1xuICAgICAgc2NyaXB0ID0gbmV3IFNjcmlwdCh7XG4gICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgbmFtZTogc2NyaXB0TmFtZSxcbiAgICAgICAgY29udGVudDogc2NyaXB0Q29udGVudCxcbiAgICAgICAgaW5mbzogc2NyaXB0SW5mbyxcbiAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgIGJ1dHRvbnMsXG4gICAgICAgIGRhdGE6IHZhcmlhYmxlRGF0YSxcbiAgICAgIH0pO1xuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9DUkVBVEUsIHsgc2NyaXB0LCB0eXBlIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB3YXNFbmFibGVkID0gc2NyaXB0LmVuYWJsZWQ7XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX1JFTU9WRSwgeyBzY3JpcHRJZDogc2NyaXB0LmlkIH0pO1xuXG4gICAgICBzY3JpcHQubmFtZSA9IHNjcmlwdE5hbWU7XG4gICAgICBzY3JpcHQuY29udGVudCA9IHNjcmlwdENvbnRlbnQ7XG4gICAgICBzY3JpcHQuaW5mbyA9IHNjcmlwdEluZm87XG4gICAgICBzY3JpcHQuYnV0dG9ucyA9IGJ1dHRvbnM7XG4gICAgICBzY3JpcHQuZGF0YSA9IHZhcmlhYmxlRGF0YTtcblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfVVBEQVRFLCB7IHNjcmlwdCwgdHlwZSB9KTtcblxuICAgICAgaWYgKHdhc0VuYWJsZWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIuc3RvcFNjcmlwdChzY3JpcHQsIHR5cGUpO1xuICAgICAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5ydW5TY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0g6YeN5ZCv6ISa5pys5aSx6LSlOiAke3NjcmlwdC5uYW1lfWAsIGVycm9yKTtcbiAgICAgICAgICB0b2FzdHIuZXJyb3IoYOmHjeWQr+iEmuacrOWksei0pTogJHtzY3JpcHQubmFtZX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlsIblj5jph4/mlbDmja7liqDovb3liLDnvJbovpHlmajkuK1cbiAgICogQHBhcmFtICRlZGl0b3JIdG1sIOe8lui+keWZqEhUTUzlhYPntKBcbiAgICogQHBhcmFtIGRhdGEg5Y+Y6YeP5pWw5o2uXG4gICAqL1xuICBwcml2YXRlIGxvYWRWYXJpYWJsZXNUb0VkaXRvcigkZWRpdG9ySHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgZGF0YTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSk6IHZvaWQge1xuICAgIGNvbnN0ICR2YXJpYWJsZUxpc3QgPSAkZWRpdG9ySHRtbC5maW5kKCcjdmFyaWFibGUtbGlzdCcpO1xuXG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0YSkpIHtcbiAgICAgIGNvbnN0ICR2YXJpYWJsZUl0ZW0gPSB0aGlzLmNyZWF0ZVZhcmlhYmxlSXRlbShrZXksIHZhbHVlKTtcbiAgICAgICR2YXJpYWJsZUxpc3QuYXBwZW5kKCR2YXJpYWJsZUl0ZW0pO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlVmFyaWFibGVMaXN0VmlzaWJpbGl0eSgkZWRpdG9ySHRtbCk7XG4gIH1cblxuICAvKipcbiAgICog5re75Yqg5paw5Y+Y6YeP5Yiw57yW6L6R5ZmoXG4gICAqIEBwYXJhbSAkZWRpdG9ySHRtbCDnvJbovpHlmahIVE1M5YWD57SgXG4gICAqL1xuICBwcml2YXRlIGFkZFZhcmlhYmxlVG9FZGl0b3IoJGVkaXRvckh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICBjb25zdCAkdmFyaWFibGVMaXN0ID0gJGVkaXRvckh0bWwuZmluZCgnI3ZhcmlhYmxlLWxpc3QnKTtcbiAgICBjb25zdCAkdmFyaWFibGVJdGVtID0gdGhpcy5jcmVhdGVWYXJpYWJsZUl0ZW0oJycsICcnKTtcbiAgICAkdmFyaWFibGVMaXN0LmFwcGVuZCgkdmFyaWFibGVJdGVtKTtcblxuICAgIHRoaXMudXBkYXRlVmFyaWFibGVMaXN0VmlzaWJpbGl0eSgkZWRpdG9ySHRtbCk7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5Y+Y6YeP5YiX6KGo55qE5Y+v6KeB5oCnXG4gICAqIEBwYXJhbSAkZWRpdG9ySHRtbCDnvJbovpHlmahIVE1M5YWD57SgXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZVZhcmlhYmxlTGlzdFZpc2liaWxpdHkoJGVkaXRvckh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICBjb25zdCAkdmFyaWFibGVMaXN0ID0gJGVkaXRvckh0bWwuZmluZCgnI3ZhcmlhYmxlLWxpc3QnKTtcbiAgICBjb25zdCB2YXJpYWJsZUNvdW50ID0gJHZhcmlhYmxlTGlzdC5maW5kKCcudmFyaWFibGUtaXRlbScpLmxlbmd0aDtcblxuICAgIGlmICh2YXJpYWJsZUNvdW50ID09PSAwKSB7XG4gICAgICAkdmFyaWFibGVMaXN0LmhpZGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJHZhcmlhYmxlTGlzdC5zaG93KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uuWPmOmHj+mhueWFg+e0oFxuICAgKiBAcGFyYW0ga2V5IOWPmOmHj+mUrlxuICAgKiBAcGFyYW0gdmFsdWUg5Y+Y6YeP5YC8XG4gICAqIEByZXR1cm5zIEpRdWVyeeWFg+e0oFxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVWYXJpYWJsZUl0ZW0oa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnkpOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHtcbiAgICBjb25zdCB2YWx1ZVN0ciA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyB2YWx1ZSA6IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcblxuICAgIGNvbnN0ICR2YXJpYWJsZUl0ZW0gPSAkKGBcbiAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1pdGVtIGZsZXgtY29udGFpbmVyIGZsZXhGbG93Q29sdW1uIHdpZHRoMTAwcFwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleCBmbGV4Rmxvd0NvbHVtblwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleC1jb250YWluZXIgYWxpZ25pdGVtc2NlbnRlciBzcGFjZUJldHdlZW4gd2lkZTEwMHBcIj5cbiAgICAgICAgICA8ZGl2PuWQjeensDo8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVudV9idXR0b24gaW50ZXJhY3RhYmxlIGRlbGV0ZS12YXJpYWJsZVwiIHRpdGxlPVwi5Yig6Zmk5Y+Y6YePXCI+XG4gICAgICAgICAgICA8aSBjbGFzcz1cImZhLXNvbGlkIGZhLXRyYXNoXCI+PC9pPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwidGV4dF9wb2xlIHZhcmlhYmxlLWtleVwiIHZhbHVlPVwiJHt0aGlzLmVzY2FwZUh0bWwoa2V5KX1cIiBwbGFjZWhvbGRlcj1cIuWPmOmHj+WQjVwiPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImZsZXggZmxleEZsb3dDb2x1bW5cIiBzdHlsZT1cImFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1wiPlxuICAgICAgICAgIDxkaXY+5YC8OjwvZGl2PlxuICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz1cInRleHRfcG9sZSB2YXJpYWJsZS12YWx1ZVwiIHN0eWxlPVwibWluLWhlaWdodDogMTJweDtcIiByb3dzPVwiMVwiIHBsYWNlaG9sZGVyPVwi5Y+Y6YeP5YC8XCI+JHt0aGlzLmVzY2FwZUh0bWwoXG4gICAgICAgICAgICB2YWx1ZVN0cixcbiAgICAgICAgICApfTwvdGV4dGFyZWE+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPGhyPlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICByZXR1cm4gJHZhcmlhYmxlSXRlbTtcbiAgfVxuXG4gIC8qKlxuICAgKiDku47nvJbovpHlmajmlLbpm4blj5jph4/mlbDmja5cbiAgICogQHBhcmFtICRlZGl0b3JIdG1sIOe8lui+keWZqEhUTUzlhYPntKBcbiAgICogQHJldHVybnMg5Y+Y6YeP5pWw5o2u5a+56LGhXG4gICAqL1xuICBwcml2YXRlIGNvbGxlY3RWYXJpYWJsZXNGcm9tRWRpdG9yKCRlZGl0b3JIdG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB7XG4gICAgY29uc3QgdmFyaWFibGVzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0ge307XG5cbiAgICAkZWRpdG9ySHRtbC5maW5kKCcjdmFyaWFibGUtbGlzdCAudmFyaWFibGUtaXRlbScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3Qga2V5ID0gJCh0aGlzKS5maW5kKCcudmFyaWFibGUta2V5JykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgY29uc3QgdmFsdWVTdHIgPSAkKHRoaXMpLmZpbmQoJy52YXJpYWJsZS12YWx1ZScpLnZhbCgpIGFzIHN0cmluZztcblxuICAgICAgaWYgKGtleSAmJiBrZXkudHJpbSgpICE9PSAnJykge1xuICAgICAgICBsZXQgdmFsdWU6IGFueTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UodmFsdWVTdHIpO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICB2YWx1ZSA9IHZhbHVlU3RyO1xuICAgICAgICB9XG4gICAgICAgIHZhcmlhYmxlc1trZXkudHJpbSgpXSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHZhcmlhYmxlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBIVE1M6L2s5LmJ6L6F5Yqp5Ye95pWwXG4gICAqIEBwYXJhbSB0ZXh0IOimgei9rOS5ieeahOaWh+acrFxuICAgKiBAcmV0dXJucyDovazkuYnlkI7nmoTmlofmnKxcbiAgICovXG4gIHByaXZhdGUgZXNjYXBlSHRtbCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGRpdi50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgcmV0dXJuIGRpdi5pbm5lckhUTUw7XG4gIH1cblxuICAvKipcbiAgICog5qOA5p+l6KeS6Imy5Lit55qE5bWM5YWl5byP6ISa5pysXG4gICAqIEBwYXJhbSBjaGFyYWN0ZXJJZCDop5LoibJpZFxuICAgKiBAcGFyYW0gZW5hYmxlYWJsZVNjcmlwdHMg5Y+v5ZCv55So55qE6ISa5pys5YiX6KGoXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgY2hlY2tFbWJlZGRlZFNjcmlwdHMoY2hhcmFjdGVySWQ6IGFueSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNoYXJhY3RlcnNXaXRoU2NyaXB0cyA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJykgfHwgW107XG4gICAgY29uc3QgYXZhdGFyID0gY2hhcmFjdGVyc1tjaGFyYWN0ZXJJZF0/LmF2YXRhcjtcbiAgICBpZiAoY2hhcmFjdGVyc1dpdGhTY3JpcHRzLmluY2x1ZGVzKGF2YXRhcikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgY2hlY2tLZXkgPSBgQWxlcnRTY3JpcHRfJHthdmF0YXJ9YDtcbiAgICBpZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKGNoZWNrS2V5KSkge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY2hlY2tLZXksICd0cnVlJyk7XG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoXG4gICAgICAgIGAke2V4dGVuc2lvbkZvbGRlclBhdGh9L3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvcHVibGljYCxcbiAgICAgICAgJ3NjcmlwdF9hbGxvd19wb3B1cCcsXG4gICAgICApO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgICBva0J1dHRvbjogJ+ehruiupCcsXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICBpZiAoYXZhdGFyICYmICFjaGFyYWN0ZXJzV2l0aFNjcmlwdHMuaW5jbHVkZXMoYXZhdGFyKSkge1xuICAgICAgICAgIGNoYXJhY3RlcnNXaXRoU2NyaXB0cy5wdXNoKGF2YXRhcik7XG4gICAgICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJywgY2hhcmFjdGVyc1dpdGhTY3JpcHRzKTtcbiAgICAgICAgfVxuXG4gICAgICAgICQoJyNjaGFyYWN0ZXItc2NyaXB0LWVuYWJsZS10b2dnbGUnKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG5cbiAgICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5UWVBFX1RPR0dMRSwge1xuICAgICAgICAgIHR5cGU6IFNjcmlwdFR5cGUuQ0hBUkFDVEVSLFxuICAgICAgICAgIGVuYWJsZTogdHJ1ZSxcbiAgICAgICAgICB1c2VySW5wdXQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQoJyNjaGFyYWN0ZXItc2NyaXB0LWVuYWJsZS10b2dnbGUnKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuXG4gICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVFlQRV9UT0dHTEUsIHtcbiAgICAgICAgICB0eXBlOiBTY3JpcHRUeXBlLkNIQVJBQ1RFUixcbiAgICAgICAgICBlbmFibGU6IGZhbHNlLFxuICAgICAgICAgIHVzZXJJbnB1dDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuLLmn5PljZXkuKrmlofku7blpLlcbiAgICogQHBhcmFtIGZvbGRlckl0ZW0g5paH5Lu25aS56aG5XG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyByZW5kZXJGb2xkZXIoZm9sZGVySXRlbTogU2NyaXB0UmVwb3NpdG9yeUl0ZW0sIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250YWluZXIgPSAkKGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKSk7XG4gICAgaWYgKCF0aGlzLmZvbGRlclRlbXBsYXRlKSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVUZW1wbGF0ZXMoKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXJJZCA9IGZvbGRlckl0ZW0uaWQhO1xuICAgIGNvbnN0IGZvbGRlck5hbWUgPSBmb2xkZXJJdGVtLm5hbWUhO1xuICAgIGNvbnN0IGZvbGRlckljb24gPSBmb2xkZXJJdGVtLmljb24gfHwgJ2ZhLWZvbGRlcic7XG4gICAgY29uc3QgZm9sZGVyQ29sb3IgPSBmb2xkZXJJdGVtLmNvbG9yIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLVNtYXJ0VGhlbWVCb2R5Q29sb3InKTtcblxuICAgIGNvbnN0IG1vdmVJY29uID0gdHlwZSA9PT0gJ2dsb2JhbCcgPyAnZmEtYXJyb3ctZG93bicgOiAnZmEtYXJyb3ctdXAnO1xuICAgIGNvbnN0IG1vdmVDbGFzcyA9IHR5cGUgPT09ICdnbG9iYWwnID8gJ21vdmUtdG8tY2hhcmFjdGVyJyA6ICdtb3ZlLXRvLWdsb2JhbCc7XG4gICAgY29uc3QgbW92ZVRpdGxlID0gdHlwZSA9PT0gJ2dsb2JhbCcgPyAn56e75Yqo5Yiw6KeS6Imy6ISa5pys5bqTJyA6ICfnp7vliqjliLDlhajlsYDohJrmnKzlupMnO1xuXG4gICAgY29uc3QgZm9sZGVySHRtbCA9ICQoXG4gICAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnZm9sZGVyX3RlbXBsYXRlJywge1xuICAgICAgICBmb2xkZXJJZCxcbiAgICAgICAgZm9sZGVyTmFtZSxcbiAgICAgICAgZm9sZGVySWNvbixcbiAgICAgICAgZm9sZGVyQ29sb3IsXG4gICAgICAgIG1vdmVJY29uLFxuICAgICAgICBtb3ZlQ2xhc3MsXG4gICAgICAgIG1vdmVUaXRsZSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICB0aGlzLmJpbmRGb2xkZXJFdmVudHMoZm9sZGVySHRtbCwgZm9sZGVySWQsIGZvbGRlckNvbG9yLCB0eXBlKTtcblxuICAgIGNvbnN0IHNjcmlwdHMgPSBmb2xkZXJJdGVtLnZhbHVlIGFzIFNjcmlwdFtdO1xuICAgIGNvbnN0IGZvbGRlckNvbnRlbnQgPSBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuICAgIGZvciAoY29uc3Qgc2NyaXB0IG9mIHNjcmlwdHMpIHtcbiAgICAgIGNvbnN0IHNjcmlwdEVsZW1lbnQgPSBhd2FpdCB0aGlzLmNyZWF0ZVNjcmlwdEVsZW1lbnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgIGZvbGRlckNvbnRlbnQuYXBwZW5kKHNjcmlwdEVsZW1lbnQpO1xuICAgIH1cblxuICAgIGNvbnRhaW5lci5hcHBlbmQoZm9sZGVySHRtbCk7XG5cbiAgICB0aGlzLnNldHVwRm9sZGVyRHJhZ2dhYmxlKHR5cGUpO1xuXG4gICAgdGhpcy5zZXR1cFNpbmdsZUZvbGRlckRyb3Bab25lKGZvbGRlckh0bWwsIHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOe7keWumuaWh+S7tuWkueebuOWFs+S6i+S7tuWSjOiuvue9ruWbvuagh+minOiJslxuICAgKiBAcGFyYW0gZm9sZGVySHRtbCDmlofku7blpLlIVE1M5YWD57SgXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gZm9sZGVyQ29sb3Ig5paH5Lu25aS56aKc6ImyXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBiaW5kRm9sZGVyRXZlbnRzKFxuICAgIGZvbGRlckh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4sXG4gICAgZm9sZGVySWQ6IHN0cmluZyxcbiAgICBmb2xkZXJDb2xvcjogc3RyaW5nLFxuICAgIHR5cGU6IFNjcmlwdFR5cGUsXG4gICk6IHZvaWQge1xuICAgIGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1oZWFkZXInKS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGlmICgkKGUudGFyZ2V0KS5jbG9zZXN0KCcuZm9sZGVyLWNvbnRyb2wnKS5sZW5ndGggPiAwKSByZXR1cm47XG4gICAgICBpZiAoJChlLnRhcmdldCkuY2xvc2VzdCgnLmZvbGRlci1jaGVja2JveCcpLmxlbmd0aCA+IDAgfHwgJChlLnRhcmdldCkuaGFzQ2xhc3MoJ2ZvbGRlci1jaGVja2JveCcpKSByZXR1cm47XG5cbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuICAgICAgY29uc3QgdG9nZ2xlID0gZm9sZGVySHRtbC5maW5kKCcuZm9sZGVyLXRvZ2dsZScpO1xuXG4gICAgICBpZiAoY29udGVudC5pcygnOnZpc2libGUnKSkge1xuICAgICAgICBjb250ZW50LnNsaWRlVXAoKTtcbiAgICAgICAgdG9nZ2xlLnJlbW92ZUNsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29udGVudC5zbGlkZURvd24oKTtcbiAgICAgICAgdG9nZ2xlLmFkZENsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgJGZvbGRlclRvZ2dsZSA9IGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1zY3JpcHQtdG9nZ2xlJyk7XG4gICAgJGZvbGRlclRvZ2dsZS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgIGNvbnN0IGlzRW5hYmxlZCA9ICRmb2xkZXJUb2dnbGUuaGFzQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgIGNvbnN0IG5ld1N0YXRlID0gIWlzRW5hYmxlZDtcblxuICAgICAgaWYgKG5ld1N0YXRlKSB7XG4gICAgICAgICRmb2xkZXJUb2dnbGUuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICAgJGZvbGRlclRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5oaWRlKCk7XG4gICAgICAgICRmb2xkZXJUb2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb24nKS5zaG93KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkZm9sZGVyVG9nZ2xlLnJlbW92ZUNsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICRmb2xkZXJUb2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuc2hvdygpO1xuICAgICAgICAkZm9sZGVyVG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgICAgfVxuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkZPTERFUl9TQ1JJUFRTX1RPR0dMRSwge1xuICAgICAgICBmb2xkZXJJZCxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgZW5hYmxlOiBuZXdTdGF0ZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZm9sZGVySHRtbC5maW5kKCcuZm9sZGVyLWVkaXQnKS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLnNob3dFZGl0Rm9sZGVyRGlhbG9nKGZvbGRlcklkLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1leHBvcnQnKS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLmV4cG9ydEZvbGRlcihmb2xkZXJJZCwgdHlwZSk7XG4gICAgfSk7XG5cbiAgICBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItbW92ZScpLm9uKCdjbGljaycsIGUgPT4ge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX01PVkUsIHtcbiAgICAgICAgZm9sZGVySWQsXG4gICAgICAgIGZyb21UeXBlOiB0eXBlLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItZGVsZXRlJykub24oJ2NsaWNrJywgZSA9PiB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgdGhpcy5zaG93RGVsZXRlRm9sZGVyRGlhbG9nKGZvbGRlcklkLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1pY29uJykuY3NzKCdjb2xvcicsIGZvbGRlckNvbG9yKTtcblxuICAgIHRoaXMudXBkYXRlRm9sZGVyVG9nZ2xlU3RhdGUoZm9sZGVySHRtbCwgZm9sZGVySWQsIHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOaWh+S7tuWkueW8gOWFs+eahFVJ54q25oCBXG4gICAqIEBwYXJhbSBmb2xkZXJIdG1sIOaWh+S7tuWkuUhUTUzlhYPntKBcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVGb2xkZXJUb2dnbGVTdGF0ZShmb2xkZXJIdG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Rm9sZGVyU2NyaXB0c1N0YXRlKGZvbGRlcklkLCB0eXBlKTtcbiAgICBjb25zdCAkZm9sZGVyVG9nZ2xlID0gZm9sZGVySHRtbC5maW5kKCcuZm9sZGVyLXNjcmlwdC10b2dnbGUnKTtcblxuICAgICRmb2xkZXJUb2dnbGUucmVtb3ZlQ2xhc3MoJ2VuYWJsZWQnKTtcblxuICAgIGlmIChzdGF0ZSA9PT0gJ2FsbCcpIHtcbiAgICAgICRmb2xkZXJUb2dnbGUuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICRmb2xkZXJUb2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgJGZvbGRlclRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGZvbGRlclRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAkZm9sZGVyVG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDljIXlkKvmjIflrprohJrmnKznmoTmlofku7blpLnlvIDlhbPnirbmgIFcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVQYXJlbnRGb2xkZXJUb2dnbGUoc2NyaXB0SWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgcmVwb3NpdG9yeSkge1xuICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIGNvbnN0IGhhc1NjcmlwdCA9IHNjcmlwdHMuc29tZShzY3JpcHQgPT4gc2NyaXB0LmlkID09PSBzY3JpcHRJZCk7XG5cbiAgICAgICAgaWYgKGhhc1NjcmlwdCkge1xuICAgICAgICAgIGNvbnN0ICRmb2xkZXIgPSAkKGAjJHtpdGVtLmlkfWApO1xuICAgICAgICAgIGlmICgkZm9sZGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRm9sZGVyVG9nZ2xlU3RhdGUoJGZvbGRlciwgaXRlbS5pZCEsIHR5cGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rohJrmnKzlhYPntKBcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNyZWF0ZVNjcmlwdEVsZW1lbnQoc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPEpRdWVyeTxIVE1MRWxlbWVudD4+IHtcbiAgICBpZiAoIXRoaXMuYmFzZVRlbXBsYXRlKSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVUZW1wbGF0ZXMoKTtcbiAgICB9XG5cbiAgICBjb25zdCBzY3JpcHRIdG1sID0gdGhpcy5iYXNlVGVtcGxhdGUhLmNsb25lKCk7XG5cbiAgICBzY3JpcHRIdG1sLmF0dHIoJ2lkJywgc2NyaXB0LmlkKTtcbiAgICBzY3JpcHRIdG1sLmF0dHIoJ2RhdGEtc2NyaXB0LXJlcG9zaXRvcnknLCAndHJ1ZScpO1xuICAgIHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC1pdGVtLW5hbWUnKS50ZXh0KHNjcmlwdC5uYW1lKTtcbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5zY3JpcHQtc3RvcmFnZS1sb2NhdGlvbicpLmFkZENsYXNzKHR5cGUgPT09ICdnbG9iYWwnID8gJ21vdmUtdG8tY2hhcmFjdGVyJyA6ICdtb3ZlLXRvLWdsb2JhbCcpO1xuICAgIHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC1zdG9yYWdlLWxvY2F0aW9uIGknKS5hZGRDbGFzcyh0eXBlID09PSAnZ2xvYmFsJyA/ICdmYS1hcnJvdy1kb3duJyA6ICdmYS1hcnJvdy11cCcpO1xuXG4gICAgY29uc3QgJHRvZ2dsZUJ1dHRvbiA9IHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC10b2dnbGUnKTtcbiAgICBpZiAoc2NyaXB0LmVuYWJsZWQpIHtcbiAgICAgICR0b2dnbGVCdXR0b24uYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICR0b2dnbGVCdXR0b24uZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgJHRvZ2dsZUJ1dHRvbi5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJHRvZ2dsZUJ1dHRvbi5yZW1vdmVDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgJHRvZ2dsZUJ1dHRvbi5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAkdG9nZ2xlQnV0dG9uLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgIH1cblxuICAgIHRoaXMuYmluZFNjcmlwdEV2ZW50cyhzY3JpcHRIdG1sLCBzY3JpcHQsIHR5cGUpO1xuXG4gICAgcmV0dXJuIHNjcmlwdEh0bWw7XG4gIH1cblxuICAvKipcbiAgICog5qOA5p+l6ISa5pysZGF0YeW5tuivoumXrueUqOaIt+WmguS9leWkhOeQhlxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrOWvueixoVxuICAgKiBAcmV0dXJucyDlpITnkIblkI7nmoTohJrmnKzmlbDmja7vvIjkuI3ljIXlkKtlbmFibGVk5a2X5q6177yJ77yM5aaC5p6c55So5oi35Y+W5raI5YiZ6L+U5ZuebnVsbFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjaGVja1NjcmlwdERhdGFBbmRHZXRFeHBvcnREYXRhKHNjcmlwdDogU2NyaXB0KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IGVuYWJsZWQsIC4uLnNjcmlwdERhdGEgfSA9IHNjcmlwdDtcblxuICAgIGNvbnN0IGhhc0RhdGEgPSBzY3JpcHQuZGF0YSAmJiBPYmplY3Qua2V5cyhzY3JpcHQuZGF0YSkubGVuZ3RoID4gMDtcblxuICAgIGlmIChoYXNEYXRhKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBjaG9pY2UgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKFxuICAgICAgICAgIGDohJrmnKwgXCIke3NjcmlwdC5uYW1lfVwiIOWMheWQq+aVsOaNru+8jOWvvOWHuuaXtuWmguS9leWkhOeQhu+8n+WmguaciUFQSS1LRVnnrYnmlY/mhJ/mlbDmja7vvIzms6jmhI/muIXpmaRgLFxuICAgICAgICAgIFBPUFVQX1RZUEUuVEVYVCxcbiAgICAgICAgICAnJyxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBva0J1dHRvbjogJ+ebtOaOpeWvvOWHuu+8iOWMheWQq+aVsOaNru+8iScsXG4gICAgICAgICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgICAgICAgICAgY3VzdG9tQnV0dG9uczogWyfmuIXpmaTmlbDmja7lkI7lr7zlh7onXSxcbiAgICAgICAgICB9LFxuICAgICAgICApO1xuXG4gICAgICAgIHN3aXRjaCAoY2hvaWNlKSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIHNjcmlwdERhdGE7XG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmV0dXJuIHsgLi4uc2NyaXB0RGF0YSwgZGF0YToge30gfTtcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDlr7zlh7rohJrmnKzmlbDmja7pgInmi6nlr7nor53moYblh7rplJk6JywgZXJyb3IpO1xuICAgICAgICByZXR1cm4gc2NyaXB0RGF0YTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc2NyaXB0RGF0YTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnu5HlrprohJrmnKznm7jlhbPkuovku7ZcbiAgICogQHBhcmFtIHNjcmlwdEh0bWwg6ISa5pysSFRNTOWFg+e0oFxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrOWvueixoVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYmluZFNjcmlwdEV2ZW50cyhzY3JpcHRIdG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgIGNvbnN0ICR0b2dnbGVCdXR0b24gPSBzY3JpcHRIdG1sLmZpbmQoJy5zY3JpcHQtdG9nZ2xlJyk7XG4gICAgJHRvZ2dsZUJ1dHRvbi5vbignY2xpY2suc2NyaXB0VG9nZ2xlJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgaXNFbmFibGVkID0gJCh0aGlzKS5oYXNDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgY29uc3QgbmV3U3RhdGUgPSAhaXNFbmFibGVkO1xuXG4gICAgICBpZiAobmV3U3RhdGUpIHtcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgICAkKHRoaXMpLmZpbmQoJ2kuZmEtdG9nZ2xlLW9mZicpLmhpZGUoKTtcbiAgICAgICAgJCh0aGlzKS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICAgJCh0aGlzKS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAgICQodGhpcykuZmluZCgnaS5mYS10b2dnbGUtb24nKS5oaWRlKCk7XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdC5lbmFibGVkID0gbmV3U3RhdGU7XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX1RPR0dMRSwge1xuICAgICAgICBzY3JpcHQsXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGVuYWJsZTogbmV3U3RhdGUsXG4gICAgICAgIHVzZXJJbnB1dDogdHJ1ZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0SHRtbC5maW5kKCcuc2NyaXB0LWluZm8nKS5vbignY2xpY2suc2NyaXB0SW5mbycsICgpID0+IHtcbiAgICAgIGNvbnN0IHNjcmlwdEluZm8gPSBzY3JpcHQuaW5mbyB8fCAnJztcbiAgICAgIGNvbnN0IGh0bWxUZXh0ID0gcmVuZGVyTWFya2Rvd24oc2NyaXB0SW5mbyk7XG4gICAgICBjYWxsR2VuZXJpY1BvcHVwKGh0bWxUZXh0LCBQT1BVUF9UWVBFLkRJU1BMQVksIHVuZGVmaW5lZCwgeyB3aWRlOiB0cnVlIH0pO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0SHRtbC5maW5kKCcuZWRpdC1zY3JpcHQnKS5vbignY2xpY2suc2NyaXB0RWRpdCcsIGUgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0VESVQsIHsgdHlwZSwgc2NyaXB0SWQ6IHNjcmlwdC5pZCB9KTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC1zdG9yYWdlLWxvY2F0aW9uJykub24oJ2NsaWNrLnNjcmlwdE1vdmUnLCAoKSA9PiB7XG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9NT1ZFLCB7IHNjcmlwdCwgZnJvbVR5cGU6IHR5cGUgfSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5leHBvcnQtc2NyaXB0Jykub24oJ2NsaWNrLnNjcmlwdEV4cG9ydCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbGVOYW1lID0gYCR7c2NyaXB0Lm5hbWUucmVwbGFjZSgvW1xccy48PjpcIi9cXFxcfD8qXFx4MDAtXFx4MUZcXHg3Rl0vZywgJ18nKS50b0xvd2VyQ2FzZSgpfS5qc29uYDtcbiAgICAgIGNvbnN0IHNjcmlwdERhdGEgPSBhd2FpdCB0aGlzLmNoZWNrU2NyaXB0RGF0YUFuZEdldEV4cG9ydERhdGEoc2NyaXB0KTtcblxuICAgICAgaWYgKHNjcmlwdERhdGEgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBmaWxlRGF0YSA9IEpTT04uc3RyaW5naWZ5KHNjcmlwdERhdGEsIG51bGwsIDIpO1xuICAgICAgZG93bmxvYWQoZmlsZURhdGEsIGZpbGVOYW1lLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0SHRtbC5maW5kKCcuZGVsZXRlLXNjcmlwdCcpLm9uKCdjbGljay5zY3JpcHREZWxldGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb25maXJtID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCgn56Gu5a6a6KaB5Yig6Zmk6L+Z5Liq6ISa5pys5ZCX77yfJywgUE9QVVBfVFlQRS5DT05GSVJNKTtcblxuICAgICAgaWYgKCFjb25maXJtKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfREVMRVRFLCB7IHNjcmlwdElkOiBzY3JpcHQuaWQsIHR5cGUgfSk7XG4gICAgICBzY3JpcHRIdG1sLnJlbW92ZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuaWsOW7uuiEmuacrOWvueivneahhlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBzaG93Q3JlYXRlU2NyaXB0RGlhbG9nKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGxldCB0YXJnZXQ6IFNjcmlwdFR5cGUgPSBTY3JpcHRUeXBlLkdMT0JBTDtcbiAgICBjb25zdCB0ZW1wbGF0ZSA9ICQoXG4gICAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnc2NyaXB0X3RhcmdldF9zZWxlY3RvcicsIHtcbiAgICAgICAgdGl0bGU6ICfmlrDlu7rohJrmnKzliLA6JyxcbiAgICAgICAgcHJlZml4OiAnc2NyaXB0LWNyZWF0ZScsXG4gICAgICAgIGdsb2JhbExhYmVsOiAn5YWo5bGA6ISa5pys5bqTJyxcbiAgICAgICAgY2hhcmFjdGVyTGFiZWw6ICfop5LoibLohJrmnKzlupMnLFxuICAgICAgfSksXG4gICAgKTtcbiAgICB0ZW1wbGF0ZS5maW5kKCcjc2NyaXB0LWNyZWF0ZS10YXJnZXQtZ2xvYmFsJykub24oJ2lucHV0JywgKCkgPT4gKHRhcmdldCA9IFNjcmlwdFR5cGUuR0xPQkFMKSk7XG4gICAgdGVtcGxhdGUuZmluZCgnI3NjcmlwdC1jcmVhdGUtdGFyZ2V0LWNoYXJhY3RlcicpLm9uKCdpbnB1dCcsICgpID0+ICh0YXJnZXQgPSBTY3JpcHRUeXBlLkNIQVJBQ1RFUikpO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgb2tCdXR0b246ICfnoa7orqQnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICB9KTtcblxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0VESVQsIHtcbiAgICAgICAgdHlwZTogdGFyZ2V0LFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuWIm+W7uuaWh+S7tuWkueWvueivneahhlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBzaG93Q3JlYXRlRm9sZGVyRGlhbG9nKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGRlZmF1bHRDb2xvciA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLVNtYXJ0VGhlbWVCb2R5Q29sb3InKTtcbiAgICBjb25zdCB0ZW1wbGF0ZSA9ICQoYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyh0aGlzLnRlbXBsYXRlUGF0aCwgJ2ZvbGRlcl9jcmVhdGUnLCB7IGRlZmF1bHRDb2xvciB9LCBmYWxzZSkpO1xuXG4gICAgbGV0IGZvbGRlckNvbG9yO1xuXG4gICAgdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1pY29uLXByZXZpZXcnKS5vbignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBzZWxlY3RlZEljb24gPSBhd2FpdCBzaG93Rm9udEF3ZXNvbWVQaWNrZXIoKTtcbiAgICAgICAgaWYgKHNlbGVjdGVkSWNvbiAmJiBzZWxlY3RlZEljb24udHJpbSgpICE9PSAnJykge1xuICAgICAgICAgIHRlbXBsYXRlLmZpbmQoJyNmb2xkZXItaWNvbi1wcmV2aWV3JykucmVtb3ZlQ2xhc3MoKS5hZGRDbGFzcyhgZmEgJHtzZWxlY3RlZEljb259YCk7XG4gICAgICAgICAgdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1pY29uLXZhbHVlJykudmFsKHNlbGVjdGVkSWNvbik7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDlm77moIfpgInmi6nlpLHotKU6JywgZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1jb2xvci1waWNrZXInKS5vbignY2hhbmdlJywgZXZ0ID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGZvbGRlckNvbG9yID0gZXZ0LmRldGFpbD8ucmdiYTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAodGVtcGxhdGUsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICAgIG9rQnV0dG9uOiAn5Yib5bu6JyxcbiAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGZvbGRlck5hbWUgPSB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLW5hbWUtaW5wdXQnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgY29uc3QgZm9sZGVySWNvbiA9IHRlbXBsYXRlLmZpbmQoJyNmb2xkZXItaWNvbi12YWx1ZScpLnZhbCgpIGFzIHN0cmluZztcbiAgICBjb25zdCBzZWxlY3RlZFR5cGUgPSB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLXRhcmdldC1nbG9iYWwnKS5wcm9wKCdjaGVja2VkJylcbiAgICAgID8gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgIDogU2NyaXB0VHlwZS5DSEFSQUNURVI7XG5cbiAgICBpZiAoIWZvbGRlck5hbWUgfHwgZm9sZGVyTmFtZS50cmltKCkgPT09ICcnKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoJ+ivt+i+k+WFpeaWh+S7tuWkueWQjeensCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBleGlzdGluZ0ZvbGRlcnMgPVxuICAgICAgICBzZWxlY3RlZFR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgICA6IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgICAgY29uc3QgZm9sZGVyRXhpc3RzID0gZXhpc3RpbmdGb2xkZXJzLnNvbWUoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0ubmFtZSA9PT0gZm9sZGVyTmFtZS50cmltKCkpO1xuXG4gICAgICBpZiAoZm9sZGVyRXhpc3RzKSB7XG4gICAgICAgIHRvYXN0ci5lcnJvcihcbiAgICAgICAgICBgJHtzZWxlY3RlZFR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJ+WFqOWxgCcgOiAn6KeS6ImyJ33ohJrmnKzlupPkuK3lt7LlrZjlnKjlkI3kuLogXCIke2ZvbGRlck5hbWUudHJpbSgpfVwiIOeahOaWh+S7tuWkuWAsXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5GT0xERVJfQ1JFQVRFLCB7XG4gICAgICAgIG5hbWU6IGZvbGRlck5hbWUudHJpbSgpLFxuICAgICAgICB0eXBlOiBzZWxlY3RlZFR5cGUsXG4gICAgICAgIGljb246IGZvbGRlckljb24sXG4gICAgICAgIGNvbG9yOiBmb2xkZXJDb2xvcixcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Yib5bu65paH5Lu25aS55aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5Yib5bu65paH5Lu25aS55aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pi+56S657yW6L6R5paH5Lu25aS55a+56K+d5qGGXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgc2hvd0VkaXRGb2xkZXJEaWFsb2coZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGN1cnJlbnROYW1lID0gJChgIyR7Zm9sZGVySWR9IC5mb2xkZXItbmFtZWApLnRleHQoKTtcblxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG4gICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgY29uc3QgY3VycmVudEljb24gPSBmb2xkZXI/Lmljb24gfHwgJ2ZhLWZvbGRlcic7XG4gICAgY29uc3QgY3VycmVudENvbG9yUmdiYSA9IGZvbGRlcj8uY29sb3IgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy0tU21hcnRUaGVtZUJvZHlDb2xvcicpO1xuICAgIGxldCBuZXdDb2xvcjtcblxuICAgIGNvbnN0IHRlbXBsYXRlID0gJChgXG4gICAgICA8ZGl2IGNsYXNzPVwiZm9sZGVyLWVkaXQtZGlhbG9nXCI+XG4gICAgICA8aDM+57yW6L6R5paH5Lu25aS5PC9oMz5cbiAgICAgIDxkaXYgY2xhc3M9XCJmbGV4LWNvbnRhaW5lciBmbGV4Rmxvd0NvbHVtbiB3aWRlMTAwcCBwYWRkaW5nMTAganVzdGlmeUxlZnRcIj5cbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8aDQ+5paH5Lu25aS55ZCN56ewOjwvaDQ+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCJmb2xkZXItbmFtZS1pbnB1dFwiIGNsYXNzPVwidGV4dF9wb2xlXCIgdmFsdWU9XCIke2N1cnJlbnROYW1lfVwiIC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxoND7mlofku7blpLnlm77moIc6PC9oND5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleFwiIHN0eWxlPVwiZ2FwOiAyMHB4OyBtYXJnaW46IDVweCAwOyB3aWR0aDogMTAwJTtcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4IGFsaWduSXRlbXNDZW50ZXJcIj5cbiAgICAgICAgICAgIDxsYWJlbD7pgInmi6npopzoibI8L2xhYmVsPlxuICAgICAgICAgICAgPHRvb2xjb29sLWNvbG9yLXBpY2tlciBpZD1cImZvbGRlci1jb2xvci1waWNrZXJcIiBjb2xvcj1cIiR7Y3VycmVudENvbG9yUmdiYX1cIj48L3Rvb2xjb29sLWNvbG9yLXBpY2tlcj5cbiAgICAgICAgICAgIDwvZGl2PiAgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleC1jb250YWluZXIgYWxpZ25JdGVtc0NlbnRlclwiPlxuICAgICAgICAgICAgIDxsYWJlbD7pgInmi6nlm77moIc8L2xhYmVsPlxuICAgICAgICAgICAgICA8aSBpZD1cImZvbGRlci1pY29uLXByZXZpZXdcIiBjbGFzcz1cImZhICR7Y3VycmVudEljb259IG1hcmdpblJpZ2h0MTBcIiBzdHlsZT1cImN1cnNvcjogcG9pbnRlcjsgZm9udC1zaXplOiAxMnB4OyBwYWRkaW5nOiA0cHg7IGJvcmRlcjogMXB4IHNvbGlkICNjY2M7IGJvcmRlci1yYWRpdXM6IDRweDtcIiB0aXRsZT1cIueCueWHu+mAieaLqeWbvuagh1wiPjwvaT5cbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBpZD1cImZvbGRlci1pY29uLXZhbHVlXCIgdmFsdWU9XCIke2N1cnJlbnRJY29ufVwiIC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcblxuICAgIHRlbXBsYXRlLmZpbmQoJyNmb2xkZXItaWNvbi1wcmV2aWV3Jykub24oJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRJY29uID0gYXdhaXQgc2hvd0ZvbnRBd2Vzb21lUGlja2VyKCk7XG4gICAgICAgIGlmIChzZWxlY3RlZEljb24gJiYgc2VsZWN0ZWRJY29uLnRyaW0oKSAhPT0gJycpIHtcbiAgICAgICAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tcHJldmlldycpLnJlbW92ZUNsYXNzKCkuYWRkQ2xhc3MoYGZhICR7c2VsZWN0ZWRJY29ufWApO1xuICAgICAgICAgIHRlbXBsYXRlLmZpbmQoJyNmb2xkZXItaWNvbi12YWx1ZScpLnZhbChzZWxlY3RlZEljb24pO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Zu+5qCH6YCJ5oup5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWNvbG9yLXBpY2tlcicpLm9uKCdjaGFuZ2UnLCBldnQgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgbmV3Q29sb3IgPSBldnQuZGV0YWlsPy5yZ2JhO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgb2tCdXR0b246ICfkv53lrZgnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICB9KTtcblxuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgbmV3TmFtZSA9IHRlbXBsYXRlLmZpbmQoJyNmb2xkZXItbmFtZS1pbnB1dCcpLnZhbCgpIGFzIHN0cmluZztcbiAgICBjb25zdCBuZXdJY29uID0gdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1pY29uLXZhbHVlJykudmFsKCkgYXMgc3RyaW5nO1xuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5GT0xERVJfRURJVCwge1xuICAgICAgZm9sZGVySWQsXG4gICAgICBuZXdOYW1lOiBuZXdOYW1lPy50cmltKCkgfHwgY3VycmVudE5hbWUsXG4gICAgICB0eXBlLFxuICAgICAgbmV3SWNvbjogbmV3SWNvbixcbiAgICAgIG5ld0NvbG9yOiBuZXdDb2xvcixcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlr7zlh7rmlofku7blpLnkuLrljovnvKnljIVcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBleHBvcnRGb2xkZXIoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgICBjb25zdCBmb2xkZXIgPSByZXBvc2l0b3J5LmZpbmQoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0uaWQgPT09IGZvbGRlcklkKTtcblxuICAgICAgaWYgKCFmb2xkZXIpIHtcbiAgICAgICAgdG9hc3RyLmVycm9yKCfmnKrmib7liLDmjIflrprnmoTmlofku7blpLknKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy9AdHMtaWdub3JlXG4gICAgICBpZiAoIXdpbmRvdy5KU1ppcCkge1xuICAgICAgICBhd2FpdCBpbXBvcnQoJ0BzaWxseXRhdmVybi9saWIvanN6aXAubWluLmpzJyk7XG4gICAgICB9XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIGNvbnN0IHppcCA9IG5ldyBKU1ppcCgpO1xuXG4gICAgICBjb25zdCBmb2xkZXJOYW1lID0gZm9sZGVyLm5hbWUgfHwgJ2ZvbGRlcic7XG4gICAgICBjb25zdCBzYW5pdGl6ZWRGb2xkZXJOYW1lID0gZm9sZGVyTmFtZS5yZXBsYWNlKC9bPD46XCIvXFxcXHw/Kl0vZywgJ18nKTtcblxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZm9sZGVyLnZhbHVlKSkge1xuICAgICAgICBsZXQgY2FuY2VsRXhwb3J0ID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChjb25zdCBzY3JpcHQgb2YgZm9sZGVyLnZhbHVlKSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IGF3YWl0IHRoaXMuY2hlY2tTY3JpcHREYXRhQW5kR2V0RXhwb3J0RGF0YShzY3JpcHQpO1xuXG4gICAgICAgICAgaWYgKHNjcmlwdERhdGEgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGNhbmNlbEV4cG9ydCA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBzY3JpcHRGaWxlTmFtZSA9IGAke3NjcmlwdC5uYW1lLnJlcGxhY2UoL1s8PjpcIi9cXFxcfD8qXS9nLCAnXycpfS5qc29uYDtcbiAgICAgICAgICB6aXAuZmlsZShgJHtzYW5pdGl6ZWRGb2xkZXJOYW1lfS8ke3NjcmlwdEZpbGVOYW1lfWAsIEpTT04uc3RyaW5naWZ5KHNjcmlwdERhdGEsIG51bGwsIDIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjYW5jZWxFeHBvcnQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgemlwQmxvYiA9IGF3YWl0IHppcC5nZW5lcmF0ZUFzeW5jKHsgdHlwZTogJ2Jsb2InIH0pO1xuXG4gICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTkpLnJlcGxhY2UoLzovZywgJy0nKTtcbiAgICAgIGNvbnN0IHR5cGVOYW1lID0gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAnZ2xvYmFsJyA6ICdjaGFyYWN0ZXInO1xuICAgICAgY29uc3QgZmlsZW5hbWUgPSBgZm9sZGVyXyR7c2FuaXRpemVkRm9sZGVyTmFtZX1fJHt0eXBlTmFtZX1fJHt0aW1lc3RhbXB9LnppcGA7XG5cbiAgICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoemlwQmxvYik7XG4gICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgYS5ocmVmID0gdXJsO1xuICAgICAgYS5kb3dubG9hZCA9IGZpbGVuYW1lO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTtcbiAgICAgIGEuY2xpY2soKTtcbiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYSk7XG4gICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG5cbiAgICAgIHRvYXN0ci5zdWNjZXNzKGDmlofku7blpLkgXCIke2ZvbGRlci5uYW1lfVwiIOWvvOWHuuaIkOWKn2ApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5a+85Ye65paH5Lu25aS55aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5a+85Ye65paH5Lu25aS55aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65Yig6Zmk5paH5Lu25aS556Gu6K6k5a+56K+d5qGGXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgc2hvd0RlbGV0ZUZvbGRlckRpYWxvZyhmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTFxuICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICA6IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGNvbnN0IGZvbGRlciA9IHJlcG9zaXRvcnkuZmluZChpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5pZCA9PT0gZm9sZGVySWQpO1xuICAgIGNvbnN0IGZvbGRlck5hbWUgPSBmb2xkZXI/Lm5hbWUgfHwgJ+acquefpeaWh+S7tuWkuSc7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKFxuICAgICAgYOehruWumuimgeWIoOmZpOaWh+S7tuWkuSBcIiR7Zm9sZGVyTmFtZX1cIiDlj4rlhbbkuK3nmoTmiYDmnInohJrmnKzlkJfvvJ/mraTmk43kvZzkuI3lj6/mkqTplIDjgIJgLFxuICAgICAgUE9QVVBfVFlQRS5DT05GSVJNLFxuICAgICAgJycsXG4gICAgICB7IG9rQnV0dG9uOiAn5Yig6ZmkJywgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyB9LFxuICAgICk7XG5cbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkZPTERFUl9ERUxFVEUsIHtcbiAgICAgICAgZm9sZGVySWQsXG4gICAgICAgIHR5cGUsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6K6+572u5pCc57Si5Yqf6IO95LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIHNldHVwU2VhcmNoRXZlbnRzKCk6IHZvaWQge1xuICAgIGNvbnN0IHNlYXJjaElucHV0ID0gJCgnI3NjcmlwdC1zZWFyY2gtaW5wdXQnKTtcblxuICAgIHNlYXJjaElucHV0Lm9uKCdpbnB1dCcsIGV2ZW50ID0+IHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gKGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZS50cmltKCk7XG4gICAgICBpZiAocXVlcnkpIHtcbiAgICAgICAgdGhpcy5wZXJmb3JtU2VhcmNoKHF1ZXJ5KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY2xlYXJTZWFyY2goKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHNlYXJjaElucHV0Lm9uKCdrZXlwcmVzcycsIGV2ZW50ID0+IHtcbiAgICAgIGlmIChldmVudC53aGljaCA9PT0gMTMpIHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSBzZWFyY2hJbnB1dC52YWwoKSBhcyBzdHJpbmc7XG4gICAgICAgIGlmIChxdWVyeSAmJiBxdWVyeS50cmltKCkpIHtcbiAgICAgICAgICB0aGlzLnBlcmZvcm1TZWFyY2gocXVlcnkudHJpbSgpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaJp+ihjOaQnOe0olxuICAgKiBAcGFyYW0gcXVlcnkg5pCc57Si5YWz6ZSu6K+NXG4gICAqL1xuICBwcml2YXRlIHBlcmZvcm1TZWFyY2gocXVlcnk6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICghcXVlcnkpIHtcbiAgICAgIHRoaXMuY2xlYXJTZWFyY2goKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBnbG9iYWxTY3JpcHRzID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFNjcmlwdHMoKTtcbiAgICBjb25zdCBjaGFyYWN0ZXJTY3JpcHRzID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclNjcmlwdHMoKTtcblxuICAgIGNvbnN0IGdsb2JhbE1hdGNoZXMgPSB0aGlzLnNlYXJjaFNjcmlwdHMoZ2xvYmFsU2NyaXB0cywgcXVlcnkpO1xuICAgIGNvbnN0IGNoYXJhY3Rlck1hdGNoZXMgPSB0aGlzLnNlYXJjaFNjcmlwdHMoY2hhcmFjdGVyU2NyaXB0cywgcXVlcnkpO1xuXG4gICAgdGhpcy5kaXNwbGF5U2VhcmNoUmVzdWx0cyhnbG9iYWxNYXRjaGVzLCBjaGFyYWN0ZXJNYXRjaGVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlnKjohJrmnKzmlbDnu4TkuK3mkJzntKLljLnphY3nmoTohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdHMg6ISa5pys5pWw57uEXG4gICAqIEBwYXJhbSBxdWVyeSDmkJzntKLlhbPplK7or41cbiAgICogQHJldHVybnMg5Yy56YWN55qE6ISa5pys5pWw57uEXG4gICAqL1xuICBwcml2YXRlIHNlYXJjaFNjcmlwdHMoc2NyaXB0czogU2NyaXB0W10sIHF1ZXJ5OiBzdHJpbmcpOiBTY3JpcHRbXSB7XG4gICAgY29uc3QgbG93ZXJRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuIHNjcmlwdHMuZmlsdGVyKHNjcmlwdCA9PiBzY3JpcHQubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrmkJzntKLnu5PmnpxcbiAgICogQHBhcmFtIGdsb2JhbE1hdGNoZXMg5YWo5bGA6ISa5pys5Yy56YWN57uT5p6cXG4gICAqIEBwYXJhbSBjaGFyYWN0ZXJNYXRjaGVzIOinkuiJsuiEmuacrOWMuemFjee7k+aenFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBkaXNwbGF5U2VhcmNoUmVzdWx0cyhnbG9iYWxNYXRjaGVzOiBTY3JpcHRbXSwgY2hhcmFjdGVyTWF0Y2hlczogU2NyaXB0W10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLmNsZWFyU2NyaXB0TGlzdChTY3JpcHRUeXBlLkdMT0JBTCk7XG4gICAgdGhpcy5jbGVhclNjcmlwdExpc3QoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuXG4gICAgY29uc3QgZ2xvYmFsQ29udGFpbmVyID0gJCgnI2dsb2JhbC1zY3JpcHQtbGlzdCcpO1xuICAgIGlmIChnbG9iYWxNYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAoY29uc3Qgc2NyaXB0IG9mIGdsb2JhbE1hdGNoZXMpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5hZGRTY3JpcHRUb0NvbnRhaW5lcihzY3JpcHQsIFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZ2xvYmFsQ29udGFpbmVyLmFwcGVuZCgnPHNtYWxsPuaXoOWMuemFjeeahOWFqOWxgOiEmuacrDwvc21hbGw+Jyk7XG4gICAgfVxuXG4gICAgY29uc3QgY2hhcmFjdGVyQ29udGFpbmVyID0gJCgnI2NoYXJhY3Rlci1zY3JpcHQtbGlzdCcpO1xuICAgIGlmIChjaGFyYWN0ZXJNYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAoY29uc3Qgc2NyaXB0IG9mIGNoYXJhY3Rlck1hdGNoZXMpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5hZGRTY3JpcHRUb0NvbnRhaW5lcihzY3JpcHQsIFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY2hhcmFjdGVyQ29udGFpbmVyLmFwcGVuZCgnPHNtYWxsPuaXoOWMuemFjeeahOinkuiJsuiEmuacrDwvc21hbGw+Jyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOa4hemZpOaQnOe0oue7k+aenO+8jOaBouWkjeato+W4uOaYvuekulxuICAgKi9cbiAgcHJpdmF0ZSBjbGVhclNlYXJjaCgpOiB2b2lkIHtcbiAgICB0aGlzLnJlbmRlclNjcmlwdExpc3RzKCk7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u5om56YeP5pON5L2c5LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIHNldHVwQmF0Y2hPcGVyYXRpb25FdmVudHMoKTogdm9pZCB7XG4gICAgJCgnI2dsb2JhbC1iYXRjaC1tYW5hZ2VyJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy50b2dnbGVCYXRjaE1vZGUoU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgIH0pO1xuXG4gICAgJCgnI2NoYXJhY3Rlci1iYXRjaC1tYW5hZ2VyJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy50b2dnbGVCYXRjaE1vZGUoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgIH0pO1xuXG4gICAgJCgnI2dsb2JhbC1iYXRjaC1kZWxldGUnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnBlcmZvcm1CYXRjaERlbGV0ZShTY3JpcHRUeXBlLkdMT0JBTCk7XG4gICAgfSk7XG5cbiAgICAkKCcjZ2xvYmFsLWJhdGNoLWV4cG9ydCcpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMucGVyZm9ybUJhdGNoRXhwb3J0KFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICB9KTtcblxuICAgICQoJyNnbG9iYWwtYmF0Y2gtbW92ZScpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMucGVyZm9ybUJhdGNoTW92ZShTY3JpcHRUeXBlLkdMT0JBTCk7XG4gICAgfSk7XG5cbiAgICAkKCcjZ2xvYmFsLWJhdGNoLWNhbmNlbCcpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuZXhpdEJhdGNoTW9kZShTY3JpcHRUeXBlLkdMT0JBTCk7XG4gICAgfSk7XG5cbiAgICAkKCcjY2hhcmFjdGVyLWJhdGNoLWRlbGV0ZScpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMucGVyZm9ybUJhdGNoRGVsZXRlKFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcbiAgICB9KTtcblxuICAgICQoJyNjaGFyYWN0ZXItYmF0Y2gtZXhwb3J0Jykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5wZXJmb3JtQmF0Y2hFeHBvcnQoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgIH0pO1xuXG4gICAgJCgnI2NoYXJhY3Rlci1iYXRjaC1tb3ZlJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5wZXJmb3JtQmF0Y2hNb3ZlKFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcbiAgICB9KTtcblxuICAgICQoJyNjaGFyYWN0ZXItYmF0Y2gtY2FuY2VsJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5leGl0QmF0Y2hNb2RlKFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliIfmjaLmibnph4/mqKHlvI9cbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIHRvZ2dsZUJhdGNoTW9kZSh0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgaXNCYXRjaE1vZGUgPSB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuYmF0Y2hNb2RlR2xvYmFsIDogdGhpcy5iYXRjaE1vZGVDaGFyYWN0ZXI7XG5cbiAgICBpZiAoaXNCYXRjaE1vZGUpIHtcbiAgICAgIHRoaXMuZXhpdEJhdGNoTW9kZSh0eXBlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbnRlckJhdGNoTW9kZSh0eXBlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6L+b5YWl5om56YeP5qih5byPXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBlbnRlckJhdGNoTW9kZSh0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgbGlzdFNlbGVjdG9yID0gZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpO1xuICAgIGNvbnN0IGNvbnRyb2xzU2VsZWN0b3IgPSBnZXRCYXRjaENvbnRyb2xzU2VsZWN0b3IodHlwZSk7XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIHRoaXMuYmF0Y2hNb2RlR2xvYmFsID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5iYXRjaE1vZGVDaGFyYWN0ZXIgPSB0cnVlO1xuICAgIH1cblxuICAgICQoY29udHJvbHNTZWxlY3Rvcikuc2hvdygpO1xuXG4gICAgY29uc3QgJGxpc3QgPSAkKGxpc3RTZWxlY3Rvcik7XG5cbiAgICAkbGlzdC5maW5kKCcuc2NyaXB0LWl0ZW0nKS5lYWNoKChfLCBlbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCAkZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICAkZWxlbWVudC5hZGRDbGFzcygnYmF0Y2gtbW9kZScpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLnNjcmlwdC1jaGVja2JveCcpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5kcmFnLWhhbmRsZScpLmhpZGUoKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5zY3JpcHQtaXRlbS1jb250cm9sJykuaGlkZSgpO1xuXG4gICAgICAkZWxlbWVudFxuICAgICAgICAuZmluZCgnLnNjcmlwdC1jaGVja2JveCcpXG4gICAgICAgIC5vZmYoJ2NoYW5nZS5iYXRjaCcpXG4gICAgICAgIC5vbignY2hhbmdlLmJhdGNoJywgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuaGFuZGxlQ2hlY2tib3hDaGFuZ2UoJGVsZW1lbnQpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgICRsaXN0LmZpbmQoJy5zY3JpcHQtZm9sZGVyJykuZWFjaCgoXywgZWxlbWVudCkgPT4ge1xuICAgICAgY29uc3QgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuICAgICAgJGVsZW1lbnQuYWRkQ2xhc3MoJ2JhdGNoLW1vZGUnKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY2hlY2tib3gnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZHJhZy1oYW5kbGUnKS5oaWRlKCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRyb2wgLmZvbGRlci1zY3JpcHQtdG9nZ2xlJykuaGlkZSgpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jb250cm9sIC5mb2xkZXItZWRpdCcpLmhpZGUoKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLWV4cG9ydCcpLmhpZGUoKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLW1vdmUnKS5oaWRlKCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRyb2wgLmZvbGRlci1kZWxldGUnKS5oaWRlKCk7XG5cbiAgICAgICRlbGVtZW50XG4gICAgICAgIC5maW5kKCcuZm9sZGVyLWNoZWNrYm94JylcbiAgICAgICAgLm9mZignY2hhbmdlLmJhdGNoJylcbiAgICAgICAgLm9uKCdjaGFuZ2UuYmF0Y2gnLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5oYW5kbGVDaGVja2JveENoYW5nZSgkZWxlbWVudCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOmAgOWHuuaJuemHj+aooeW8j1xuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgZXhpdEJhdGNoTW9kZSh0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgbGlzdFNlbGVjdG9yID0gZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpO1xuICAgIGNvbnN0IGNvbnRyb2xzU2VsZWN0b3IgPSBnZXRCYXRjaENvbnRyb2xzU2VsZWN0b3IodHlwZSk7XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIHRoaXMuYmF0Y2hNb2RlR2xvYmFsID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYmF0Y2hNb2RlQ2hhcmFjdGVyID0gZmFsc2U7XG4gICAgfVxuXG4gICAgJChjb250cm9sc1NlbGVjdG9yKS5oaWRlKCk7XG5cbiAgICBjb25zdCAkbGlzdCA9ICQobGlzdFNlbGVjdG9yKTtcblxuICAgICRsaXN0LmZpbmQoJy5zY3JpcHQtaXRlbSwgLnNjcmlwdC1mb2xkZXInKS5lYWNoKChfLCBlbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCAkZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICAkZWxlbWVudC5yZW1vdmVDbGFzcygnYmF0Y2gtbW9kZSBzZWxlY3RlZCcpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLnNjcmlwdC1jaGVja2JveCwgLmZvbGRlci1jaGVja2JveCcpLmhpZGUoKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLnNjcmlwdC1pdGVtLWNvbnRyb2wnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZHJhZy1oYW5kbGUnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuc2NyaXB0LWNvbnRyb2xzJykuc2hvdygpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jb250cm9sIC5mb2xkZXItc2NyaXB0LXRvZ2dsZScpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLWVkaXQnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRyb2wgLmZvbGRlci1leHBvcnQnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRyb2wgLmZvbGRlci1tb3ZlJykuc2hvdygpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jb250cm9sIC5mb2xkZXItZGVsZXRlJykuc2hvdygpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLnNjcmlwdC1jaGVja2JveCwgLmZvbGRlci1jaGVja2JveCcpLm9mZignY2hhbmdlLmJhdGNoJyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5aSN6YCJ5qGG54q25oCB5Y+Y5YyW5pe25re75Yqg6YCJ5Lit54q25oCBY3NzXG4gICAqIEBwYXJhbSAkZWxlbWVudCDlhYPntKBqUXVlcnnlr7nosaFcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlQ2hlY2tib3hDaGFuZ2UoJGVsZW1lbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICBjb25zdCBpc0NoZWNrZWQgPSAkZWxlbWVudC5maW5kKCcuc2NyaXB0LWNoZWNrYm94LCAuZm9sZGVyLWNoZWNrYm94JykucHJvcCgnY2hlY2tlZCcpO1xuXG4gICAgaWYgKGlzQ2hlY2tlZCkge1xuICAgICAgJGVsZW1lbnQuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICRlbGVtZW50LnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bpgInkuK3nmoTpobnnm65cbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEByZXR1cm5zIOmAieS4reeahOiEmuacrElE5ZKM5paH5Lu25aS5SUTmlbDnu4RcbiAgICovXG4gIHByaXZhdGUgZ2V0U2VsZWN0ZWRJdGVtcyh0eXBlOiBTY3JpcHRUeXBlKTogeyBzY3JpcHRJZHM6IHN0cmluZ1tdOyBmb2xkZXJJZHM6IHN0cmluZ1tdIH0ge1xuICAgIGNvbnN0IGxpc3RTZWxlY3RvciA9IGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKTtcbiAgICBjb25zdCBzY3JpcHRJZHM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgZm9sZGVySWRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgJChsaXN0U2VsZWN0b3IpXG4gICAgICAuZmluZCgnLnNjcmlwdC1pdGVtLnNlbGVjdGVkJylcbiAgICAgIC5lYWNoKChfLCBlbGVtZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gJChlbGVtZW50KS5hdHRyKCdpZCcpO1xuICAgICAgICBpZiAoaWQpIHNjcmlwdElkcy5wdXNoKGlkKTtcbiAgICAgIH0pO1xuXG4gICAgJChsaXN0U2VsZWN0b3IpXG4gICAgICAuZmluZCgnLnNjcmlwdC1mb2xkZXIuc2VsZWN0ZWQnKVxuICAgICAgLmVhY2goKF8sIGVsZW1lbnQpID0+IHtcbiAgICAgICAgY29uc3QgaWQgPSAkKGVsZW1lbnQpLmF0dHIoJ2lkJyk7XG4gICAgICAgIGlmIChpZCkgZm9sZGVySWRzLnB1c2goaWQpO1xuICAgICAgfSk7XG5cbiAgICByZXR1cm4geyBzY3JpcHRJZHMsIGZvbGRlcklkcyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIOaJp+ihjOaJuemHj+WIoOmZpFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcGVyZm9ybUJhdGNoRGVsZXRlKHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IHNjcmlwdElkcywgZm9sZGVySWRzIH0gPSB0aGlzLmdldFNlbGVjdGVkSXRlbXModHlwZSk7XG5cbiAgICBpZiAoc2NyaXB0SWRzLmxlbmd0aCA9PT0gMCAmJiBmb2xkZXJJZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0b2FzdHIud2FybmluZygn6K+36Iez5bCR6YCJ5oup5LiA5Liq6aG555uu6L+b6KGM5Yig6ZmkJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgdG90YWxDb3VudCA9IHNjcmlwdElkcy5sZW5ndGggKyBmb2xkZXJJZHMubGVuZ3RoO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoXG4gICAgICBg56Gu5a6a6KaB5Yig6Zmk6YCJ5Lit55qEICR7dG90YWxDb3VudH0g5Liq6aG555uu5ZCX77yf5q2k5pON5L2c5LiN5Y+v5pKk6ZSA44CCYCxcbiAgICAgIFBPUFVQX1RZUEUuQ09ORklSTSxcbiAgICAgICcnLFxuICAgICAgeyBva0J1dHRvbjogJ+WIoOmZpCcsIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcgfSxcbiAgICApO1xuXG4gICAgaWYgKCFyZXN1bHQpIHJldHVybjtcblxuICAgIHRyeSB7XG4gICAgICBmb3IgKGNvbnN0IHNjcmlwdElkIG9mIHNjcmlwdElkcykge1xuICAgICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIuZGVsZXRlU2NyaXB0KHNjcmlwdElkLCB0eXBlKTtcbiAgICAgIH1cblxuICAgICAgZm9yIChjb25zdCBmb2xkZXJJZCBvZiBmb2xkZXJJZHMpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVGb2xkZXJEZWxldGUoZm9sZGVySWQsIHR5cGUsIHRydWUpO1xuICAgICAgfVxuXG4gICAgICB0b2FzdHIuc3VjY2Vzcyhg5oiQ5Yqf5Yig6ZmkICR7dG90YWxDb3VudH0g5Liq6aG555uuYCk7XG5cbiAgICAgIHRoaXMuZXhpdEJhdGNoTW9kZSh0eXBlKTtcbiAgICAgIGF3YWl0IHRoaXMucmVuZGVyU2NyaXB0TGlzdHMoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOaJuemHj+WIoOmZpOWksei0pTonLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOaJuemHj+WIoOmZpOWksei0pTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaJp+ihjOaJuemHj+WvvOWHulxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcGVyZm9ybUJhdGNoRXhwb3J0KHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IHNjcmlwdElkcywgZm9sZGVySWRzIH0gPSB0aGlzLmdldFNlbGVjdGVkSXRlbXModHlwZSk7XG5cbiAgICBpZiAoc2NyaXB0SWRzLmxlbmd0aCA9PT0gMCAmJiBmb2xkZXJJZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0b2FzdHIud2FybmluZygn6K+36Iez5bCR6YCJ5oup5LiA5Liq6aG555uu6L+b6KGM5a+85Ye6Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgaWYgKCF3aW5kb3cuSlNaaXApIHtcbiAgICAgICAgYXdhaXQgaW1wb3J0KCdAc2lsbHl0YXZlcm4vbGliL2pzemlwLm1pbi5qcycpO1xuICAgICAgfVxuICAgICAgLy9AdHMtaWdub3JlXG4gICAgICBjb25zdCB6aXAgPSBuZXcgSlNaaXAoKTtcbiAgICAgIGxldCBleHBvcnRlZENvdW50ID0gMDtcblxuICAgICAgbGV0IGNhbmNlbEV4cG9ydCA9IGZhbHNlO1xuXG4gICAgICBmb3IgKGNvbnN0IHNjcmlwdElkIG9mIHNjcmlwdElkcykge1xuICAgICAgICBjb25zdCBzY3JpcHQgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0U2NyaXB0QnlJZChzY3JpcHRJZCk7XG4gICAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgICBjb25zdCBzY3JpcHREYXRhID0gYXdhaXQgdGhpcy5jaGVja1NjcmlwdERhdGFBbmRHZXRFeHBvcnREYXRhKHNjcmlwdCk7XG5cbiAgICAgICAgICBpZiAoc2NyaXB0RGF0YSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgY2FuY2VsRXhwb3J0ID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHNjcmlwdEZpbGVOYW1lID0gYCR7c2NyaXB0Lm5hbWUucmVwbGFjZSgvWzw+OlwiL1xcXFx8PypdL2csICdfJyl9Lmpzb25gO1xuICAgICAgICAgIHppcC5maWxlKHNjcmlwdEZpbGVOYW1lLCBKU09OLnN0cmluZ2lmeShzY3JpcHREYXRhLCBudWxsLCAyKSk7XG4gICAgICAgICAgZXhwb3J0ZWRDb3VudCsrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChjYW5jZWxFeHBvcnQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgICBmb3IgKGNvbnN0IGZvbGRlcklkIG9mIGZvbGRlcklkcykge1xuICAgICAgICBjb25zdCBmb2xkZXIgPSByZXBvc2l0b3J5LmZpbmQoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0uaWQgPT09IGZvbGRlcklkKTtcbiAgICAgICAgaWYgKGZvbGRlcikge1xuICAgICAgICAgIGNvbnN0IGZvbGRlck5hbWUgPSBmb2xkZXIubmFtZSB8fCAnZm9sZGVyJztcbiAgICAgICAgICBjb25zdCBzYW5pdGl6ZWRGb2xkZXJOYW1lID0gZm9sZGVyTmFtZS5yZXBsYWNlKC9bPD46XCIvXFxcXHw/Kl0vZywgJ18nKTtcblxuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGZvbGRlci52YWx1ZSkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgc2NyaXB0IG9mIGZvbGRlci52YWx1ZSkge1xuICAgICAgICAgICAgICBjb25zdCBzY3JpcHREYXRhID0gYXdhaXQgdGhpcy5jaGVja1NjcmlwdERhdGFBbmRHZXRFeHBvcnREYXRhKHNjcmlwdCk7XG5cbiAgICAgICAgICAgICAgaWYgKHNjcmlwdERhdGEgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjYW5jZWxFeHBvcnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgY29uc3Qgc2NyaXB0RmlsZU5hbWUgPSBgJHtzY3JpcHQubmFtZS5yZXBsYWNlKC9bPD46XCIvXFxcXHw/Kl0vZywgJ18nKX0uanNvbmA7XG4gICAgICAgICAgICAgIHppcC5maWxlKGAke3Nhbml0aXplZEZvbGRlck5hbWV9LyR7c2NyaXB0RmlsZU5hbWV9YCwgSlNPTi5zdHJpbmdpZnkoc2NyaXB0RGF0YSwgbnVsbCwgMikpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY2FuY2VsRXhwb3J0KSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBleHBvcnRlZENvdW50Kys7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGNhbmNlbEV4cG9ydCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChleHBvcnRlZENvdW50ID09PSAwKSB7XG4gICAgICAgIHRvYXN0ci5lcnJvcign5rKh5pyJ5om+5Yiw5pyJ5pWI55qE5a+85Ye65pWw5o2uJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgemlwQmxvYiA9IGF3YWl0IHppcC5nZW5lcmF0ZUFzeW5jKHsgdHlwZTogJ2Jsb2InIH0pO1xuXG4gICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTkpLnJlcGxhY2UoLzovZywgJy0nKTtcbiAgICAgIGNvbnN0IHR5cGVOYW1lID0gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAnZ2xvYmFsJyA6ICdjaGFyYWN0ZXInO1xuICAgICAgY29uc3QgZmlsZW5hbWUgPSBgYmF0Y2hfZXhwb3J0XyR7dHlwZU5hbWV9XyR7dGltZXN0YW1wfS56aXBgO1xuXG4gICAgICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHppcEJsb2IpO1xuICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgIGEuaHJlZiA9IHVybDtcbiAgICAgIGEuZG93bmxvYWQgPSBmaWxlbmFtZTtcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7XG4gICAgICBhLmNsaWNrKCk7XG4gICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGEpO1xuICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpO1xuXG4gICAgICB0b2FzdHIuc3VjY2Vzcyhg5oiQ5Yqf5a+85Ye6ICR7ZXhwb3J0ZWRDb3VudH0g5Liq6aG555uuYCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmibnph4/lr7zlh7rlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDmibnph4/lr7zlh7rlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmiafooYzmibnph4/np7vliqjliLDmlofku7blpLlcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1CYXRjaE1vdmUodHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgc2NyaXB0SWRzLCBmb2xkZXJJZHMgfSA9IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtcyh0eXBlKTtcblxuICAgIGlmIChmb2xkZXJJZHMubGVuZ3RoID4gMCkge1xuICAgICAgdG9hc3RyLmVycm9yKCfkuI3og73np7vliqjmlofku7blpLnvvIzor7flj6rpgInmi6nohJrmnKzov5vooYznp7vliqjmk43kvZwnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoc2NyaXB0SWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdG9hc3RyLndhcm5pbmcoJ+ivt+iHs+WwkemAieaLqeS4gOS4quiEmuacrOi/m+ihjOenu+WKqCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgICBjb25zdCBmb2xkZXJzID0gcmVwb3NpdG9yeS5maWx0ZXIoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInKTtcblxuICAgICAgaWYgKGZvbGRlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRvYXN0ci5lcnJvcign5rKh5pyJ5Y+v55So55qE5paH5Lu25aS577yM6K+35YWI5Yib5bu65LiA5Liq5paH5Lu25aS5Jyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZm9sZGVyT3B0aW9ucyA9IGZvbGRlcnMubWFwKGZvbGRlciA9PiBgPG9wdGlvbiB2YWx1ZT1cIiR7Zm9sZGVyLmlkfVwiPiR7Zm9sZGVyLm5hbWV9PC9vcHRpb24+YCkuam9pbignJyk7XG5cbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gJChgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPHA+6YCJ5oup6KaB56e75Yqo5Yiw55qE5paH5Lu25aS577yaPC9wPlxuICAgICAgICAgIDxzZWxlY3QgaWQ9XCJ0YXJnZXQtZm9sZGVyLXNlbGVjdFwiIGNsYXNzPVwidGV4dF9wb2xlXCIgc3R5bGU9XCJ3aWR0aDogMTAwJTtcIj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJcIj7moLnnm67lvZU8L29wdGlvbj5cbiAgICAgICAgICAgICR7Zm9sZGVyT3B0aW9uc31cbiAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgICBva0J1dHRvbjogJ+enu+WKqCcsXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXN1bHQpIHJldHVybjtcblxuICAgICAgY29uc3QgdGFyZ2V0Rm9sZGVySWQgPSAodGVtcGxhdGUuZmluZCgnI3RhcmdldC1mb2xkZXItc2VsZWN0JykudmFsKCkgYXMgc3RyaW5nKSB8fCBudWxsO1xuXG4gICAgICBmb3IgKGNvbnN0IHNjcmlwdElkIG9mIHNjcmlwdElkcykge1xuICAgICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIubW92ZVNjcmlwdFRvRm9sZGVyKHNjcmlwdElkLCB0YXJnZXRGb2xkZXJJZCwgdHlwZSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRhcmdldE5hbWUgPSB0YXJnZXRGb2xkZXJJZCA/IGZvbGRlcnMuZmluZChmID0+IGYuaWQgPT09IHRhcmdldEZvbGRlcklkKT8ubmFtZSB8fCAn5pyq55+l5paH5Lu25aS5JyA6ICfmoLnnm67lvZUnO1xuXG4gICAgICB0b2FzdHIuc3VjY2Vzcyhg5oiQ5Yqf5bCGICR7c2NyaXB0SWRzLmxlbmd0aH0g5Liq6ISa5pys56e75Yqo5YiwXCIke3RhcmdldE5hbWV9XCJgKTtcblxuICAgICAgdGhpcy5leGl0QmF0Y2hNb2RlKHR5cGUpO1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5om56YeP56e75Yqo5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5om56YeP56e75Yqo5aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5paH5Lu25aS55Yib5bu65LqL5Lu2XG4gICAqIEBwYXJhbSBuYW1lIOaWh+S7tuWkueWQjeensFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHBhcmFtIGljb24g5paH5Lu25aS55Zu+5qCHXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZUZvbGRlckNyZWF0ZShuYW1lOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUsIGljb24/OiBzdHJpbmcsIGNvbG9yPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5jcmVhdGVGb2xkZXIobmFtZSwgdHlwZSwgaWNvbiwgY29sb3IpO1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgICAgdG9hc3RyLnN1Y2Nlc3MoYOaWh+S7tuWkuSBcIiR7bmFtZX1cIiDliJvlu7rmiJDlip9gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOWIm+W7uuaWh+S7tuWkueWksei0pTonLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOWIm+W7uuaWh+S7tuWkueWksei0pTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuaWh+S7tuWkuee8lui+keS6i+S7tlxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIG5ld05hbWUg5paw5ZCN56ewXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gbmV3SWNvbiDmlrDlm77moIdcbiAgICogQHBhcmFtIG5ld0NvbG9yIOaWsOminOiJslxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVGb2xkZXJFZGl0KFxuICAgIGZvbGRlcklkOiBzdHJpbmcsXG4gICAgbmV3TmFtZTogc3RyaW5nLFxuICAgIHR5cGU6IFNjcmlwdFR5cGUsXG4gICAgbmV3SWNvbj86IHN0cmluZyxcbiAgICBuZXdDb2xvcj86IHN0cmluZyxcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5lZGl0Rm9sZGVyKGZvbGRlcklkLCBuZXdOYW1lLCB0eXBlLCBuZXdJY29uLCBuZXdDb2xvcik7XG5cbiAgICAgIGlmIChuZXdOYW1lKSB7XG4gICAgICAgICQoYCMke2ZvbGRlcklkfSAuZm9sZGVyLW5hbWVgKS50ZXh0KG5ld05hbWUpO1xuICAgICAgfVxuXG4gICAgICBpZiAobmV3SWNvbikge1xuICAgICAgICAkKGAjJHtmb2xkZXJJZH0gLmZvbGRlci1pY29uYCkucmVtb3ZlQ2xhc3MoKS5hZGRDbGFzcyhgZmEgJHtuZXdJY29ufSBmb2xkZXItaWNvbiBtYXJnaW5MZWZ0NWApO1xuICAgICAgfVxuXG4gICAgICBpZiAobmV3Q29sb3IpIHtcbiAgICAgICAgJChgIyR7Zm9sZGVySWR9IC5mb2xkZXItaWNvbmApLmNzcygnY29sb3InLCBuZXdDb2xvcik7XG4gICAgICAgICQoYCMke2ZvbGRlcklkfSAuZm9sZGVyLWhlYWRlcmApLmNzcygnYm9yZGVyLWxlZnQtY29sb3InLCBuZXdDb2xvcik7XG4gICAgICB9XG5cbiAgICAgIHRvYXN0ci5zdWNjZXNzKGDmlofku7blpLnmm7TmlrDmiJDlip9gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOabtOaWsOaWh+S7tuWkueWksei0pTonLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOabtOaWsOaWh+S7tuWkueWksei0pTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuaWh+S7tuWkueWIoOmZpOS6i+S7tlxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBza2lwVUlSZWZyZXNoIOaYr+WQpui3s+i/h1VJ5Yi35paw77yI55So5LqO5om56YeP5pON5L2c77yJXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZUZvbGRlckRlbGV0ZShmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlLCBza2lwVUlSZWZyZXNoOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLmRlbGV0ZUZvbGRlcihmb2xkZXJJZCwgdHlwZSk7XG4gICAgICBpZiAoIXNraXBVSVJlZnJlc2gpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgICAgICB0b2FzdHIuc3VjY2Vzcygn5paH5Lu25aS55Yig6Zmk5oiQ5YqfJyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDliKDpmaTmlofku7blpLnlpLHotKU6JywgZXJyb3IpO1xuICAgICAgaWYgKCFza2lwVUlSZWZyZXNoKSB7XG4gICAgICAgIHRvYXN0ci5lcnJvcihg5Yig6Zmk5paH5Lu25aS55aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmlofku7blpLnohJrmnKzmibnph4/lvIDlhbNcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVGb2xkZXJTY3JpcHRzVG9nZ2xlKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUsIGVuYWJsZTogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIudG9nZ2xlRm9sZGVyU2NyaXB0cyhmb2xkZXJJZCwgdHlwZSwgZW5hYmxlKTtcbiAgICAgIHRoaXMudXBkYXRlRm9sZGVyQW5kU2NyaXB0c1VJKGZvbGRlcklkLCB0eXBlLCBlbmFibGUpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5om56YeP5YiH5o2i5paH5Lu25aS56ISa5pys54q25oCB5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5om56YeP5YiH5o2i6ISa5pys54q25oCB5aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ+acquefpemUmeivryd9YCk7XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/script_repository/ui_controller.ts\n")},"./src/component/toastr.ts":
/*!*********************************!*\
  !*** ./src/component/toastr.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initializeToastr: () => (/* binding */ initializeToastr)\n/* harmony export */ });\nfunction initializeToastr() {\n    globalThis.toastr = toastr;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3RvYXN0ci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBSU8sU0FBUyxnQkFBZ0I7SUFDOUIsVUFBVSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7QUFDN0IsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvdG9hc3RyLnRzPzg3YzYiXSwic291cmNlc0NvbnRlbnQiOlsiZGVjbGFyZSBuYW1lc3BhY2UgZ2xvYmFsVGhpcyB7XG4gIGxldCB0b2FzdHI6IHR5cGVvZiBpbXBvcnQoJ3RvYXN0cicpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZVRvYXN0cigpIHtcbiAgZ2xvYmFsVGhpcy50b2FzdHIgPSB0b2FzdHI7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/toastr.ts\n")},"./src/component/variable_manager/card.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/card.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableCardFactory: () => (/* binding */ VariableCardFactory)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n\n\nclass VariableCardFactory {\n    defaultTypeDialogCallback;\n    /**\n     * \n     * @param defaultTypeDialogCallback \n     */\n    constructor(defaultTypeDialogCallback) {\n        this.defaultTypeDialogCallback = defaultTypeDialogCallback;\n        this.setupGlobalEventDelegation();\n    }\n    /**\n     * \n     */\n    setupGlobalEventDelegation() {\n        $(document).on('click', '.variable-action-btn.object-save-btn', event => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $nestedCard = $button.closest('.variable-card');\n            const $parentCard = this.findTopLevelCard($nestedCard);\n            if ($parentCard) {\n                this.saveNestedCardValue($parentCard);\n            }\n        });\n        $(document).on('click', '.variable-action-btn.object-delete-btn', event => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $nestedCard = $button.closest('.variable-card');\n            const $parentCard = this.findTopLevelCard($nestedCard);\n            if ($parentCard) {\n                this.deleteNestedCardValue($parentCard, $nestedCard);\n            }\n        });\n        $(document).on('click', '.variable-action-btn.add-nested-key-btn', async (event) => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $card = $button.closest('.variable-card');\n            const dialogCallback = this.defaultTypeDialogCallback;\n            if (dialogCallback) {\n                await dialogCallback((dataType) => {\n                    this.addObjectKey($card, dataType, this.defaultTypeDialogCallback);\n                });\n            }\n            else {\n                console.error('');\n                toastr.error('');\n            }\n        });\n        $(document).on('click', '.variable-action-btn.add-key-btn', async (event) => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $card = $button.closest('.variable-card');\n            const dialogCallback = this.defaultTypeDialogCallback;\n            if (dialogCallback) {\n                await dialogCallback((dataType) => {\n                    this.addObjectKey($card, dataType, this.defaultTypeDialogCallback);\n                });\n            }\n            else {\n                console.error('');\n                toastr.error('');\n            }\n        });\n    }\n    /**\n     * \n     * @param variable \n     * @param isNested \n     * @param showTypeDialogCallback \n     * @returns jQuery\n     */\n    createCard(variable, isNested, showTypeDialogCallback) {\n        let card;\n        const { name, value, dataType, id } = variable;\n        card = $(`\n      <div class=\"variable-card\" data-type=\"${dataType}\" data-variable-id=\"${id}\">\n        <div class=\"variable-card-header\">\n          <div class=\"variable-title-container\">\n            <i></i>\n            <input type=\"text\" class=\"variable-title\" value=\"${name}\" placeholder=\"\">\n          </div>\n          <div class=\"variable-actions\">\n            <button class=\"variable-action-btn save-btn\" title=\"\">\n              <i class=\"fa-regular fa-save\"></i>\n            </button>\n            <button class=\"variable-action-btn delete-btn\" title=\"\">\n              <i class=\"fa-regular fa-trash-can\"></i>\n            </button>\n          </div>\n        </div>\n        <div class=\"variable-card-content\">\n        </div>\n      </div>\n    `);\n        if (isNested) {\n            card.removeAttr('data-variable-id');\n            card\n                .find('.variable-action-btn.save-btn')\n                .removeClass('save-btn')\n                .addClass('object-save-btn')\n                .end()\n                .find('.variable-action-btn.delete-btn')\n                .removeClass('delete-btn')\n                .addClass('object-delete-btn');\n        }\n        switch (dataType) {\n            case 'array':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-solid fa-list')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`<div class=\"list-items-container\"></div><button class=\"add-list-item\"><i class=\"fa-solid fa-plus\"></i> </button>`);\n                this.populateArrayItems(card, value);\n                {\n                    const listContainer = card.find('.list-items-container');\n                    listContainer.sortable({\n                        delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__.getSortableDelay)(),\n                        handle: '.drag-handle',\n                    });\n                }\n                break;\n            case 'object':\n                card.find('.variable-title-container i').addClass('fa-regular fa-code');\n                this.setupObjectCard(card, variable, isNested, showTypeDialogCallback);\n                break;\n            case 'boolean':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-regular fa-toggle-on')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`\n              <div class=\"boolean-input-container\">\n                <div class=\"boolean-buttons-container\">\n                  <button class=\"boolean-btn ${value ? 'active' : ''}\" data-value=\"true\">True</button>\n                  <button class=\"boolean-btn ${!value ? 'active' : ''}\" data-value=\"false\">False</button>\n                </div>\n              </div>\n            `)\n                    .find('.boolean-btn')\n                    .on('click', function () {\n                    card.find('.boolean-btn').removeClass('active');\n                    $(this).addClass('active');\n                });\n                break;\n            case 'number':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-solid fa-hashtag')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`<input type=\"number\" class=\"number-input variable-content-input\" value=\"${value}\" step=\"any\">`);\n                break;\n            case 'string':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-solid fa-font')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`<textarea class=\"string-input variable-content-input\" placeholder=\"\">${value}</textarea>`);\n                break;\n        }\n        return card;\n    }\n    /**\n     * \n     * @param card \n     * @returns \n     */\n    getVariableFromCard(card) {\n        const id = card.attr('data-variable-id') || '';\n        const name = card.find('.variable-title').val();\n        const dataType = card.attr('data-type');\n        const value = this.extractValueFromCard(card, dataType);\n        return {\n            id,\n            name,\n            dataType,\n            value,\n        };\n    }\n    /**\n     * \n     * @param card \n     * @param dataType \n     * @returns \n     */\n    extractValueFromCard(card, dataType) {\n        switch (dataType) {\n            case 'string':\n                return card.find('.string-input').val();\n            case 'number': {\n                const numberValue = card.find('.number-input').val();\n                return numberValue ? parseFloat(numberValue) : 0;\n            }\n            case 'boolean':\n                return card.find('.boolean-btn.active').attr('data-value') === 'true';\n            case 'array': {\n                const arrayItems = [];\n                card.find('.list-item').each((_, elem) => {\n                    const $listItem = $(elem);\n                    const itemValue = $listItem.find('.variable-content-input').val();\n                    try {\n                        arrayItems.push(JSON.parse(itemValue));\n                    }\n                    catch {\n                        arrayItems.push(itemValue);\n                    }\n                });\n                return arrayItems;\n            }\n            case 'object': {\n                const viewMode = card.attr('data-view-mode') || 'card';\n                if (viewMode === 'card') {\n                    const extracted = this.extractObjectFromNestedCards(card);\n                    return extracted;\n                }\n                const jsonValue = card.find('.json-input').val();\n                if (jsonValue && jsonValue.trim()) {\n                    try {\n                        const parsed = JSON.parse(jsonValue);\n                        return parsed;\n                    }\n                    catch (e) {\n                        console.error('JSON:', e);\n                        toastr.error('JSON');\n                        return {};\n                    }\n                }\n                else {\n                    const extracted = this.extractObjectFromNestedCards(card);\n                    return extracted;\n                }\n            }\n            default:\n                return card.find('.variable-content-input').val();\n        }\n    }\n    /**\n     * \n     * @param card \n     * @returns \n     */\n    extractObjectFromNestedCards(card) {\n        const result = {};\n        let $container = card.find('> .variable-card-content > .object-card-view > .nested-cards-container');\n        if ($container.length === 0) {\n            $container = card.find('> .variable-card-content > .nested-object-container > .nested-cards-container');\n        }\n        if ($container.length === 0) {\n            $container = card.find('.nested-cards-container').first();\n        }\n        $container.children('.variable-card').each((_index, element) => {\n            const $nestedCard = $(element);\n            const key = $nestedCard.find('.variable-title').val();\n            const nestedDataType = $nestedCard.attr('data-type');\n            console.log('[VariableManager] :', {\n                index: _index,\n                key: key,\n                dataType: nestedDataType,\n                cardHtml: $nestedCard[0].outerHTML.substring(0, 200) + '...'\n            });\n            if (key) {\n                const nestedValue = this.extractValueFromCard($nestedCard, nestedDataType);\n                result[key] = nestedValue;\n            }\n            else {\n                console.warn('[VariableManager] :', _index);\n            }\n        });\n        console.log('[VariableManager] :', result);\n        return result;\n    }\n    /**\n     * \n     * @param card jQuery\n     * @param variable \n     * @param showTypeDialogCallback \n     */\n    renderObjectCardView(card, variable, showTypeDialogCallback) {\n        const $container = card.find('.nested-cards-container');\n        $container.empty();\n        if (!variable.value || typeof variable.value !== 'object') {\n            return;\n        }\n        Object.entries(variable.value).forEach(([key, propertyValue]) => {\n            const dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(propertyValue);\n            const propertyVariable = {\n                name: key,\n                dataType: dataType,\n                value: propertyValue,\n                id: '',\n            };\n            const nestedCard = this.createCard(propertyVariable, true, showTypeDialogCallback);\n            $container.append(nestedCard);\n        });\n    }\n    /**\n     * \n     * @param parentCard \n     */\n    saveNestedCardValue(parentCard) {\n        this.syncCardViewToJsonInput(parentCard);\n        const topLevelCard = this.findTopLevelCard(parentCard);\n        if (topLevelCard) {\n            topLevelCard.trigger('nested-card:changed');\n        }\n    }\n    /**\n     * \n     * @param card \n     * @returns data-variable-idnull\n     */\n    findTopLevelCard(card) {\n        if (card.attr('data-variable-id')) {\n            return card;\n        }\n        const cardWithId = card.closest('[data-variable-id]');\n        return cardWithId.length > 0 ? cardWithId : null;\n    }\n    /**\n     * \n     * @param parentCard \n     * @param nestedCard \n     */\n    deleteNestedCardValue(parentCard, nestedCard) {\n        nestedCard.remove();\n        this.syncCardViewToJsonInput(parentCard);\n        const topLevelCard = this.findTopLevelCard(parentCard);\n        if (topLevelCard) {\n            topLevelCard.trigger('nested-card:changed');\n        }\n    }\n    /**\n     * \n     * @param card \n     * @param dataType \n     * @param showTypeDialogCallback \n     */\n    addObjectKey(card, newDataType, showTypeDialogCallback) {\n        const defaultValue = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.getDefaultValueForType(newDataType);\n        const existingKeys = new Set();\n        const $targetCard = card.closest('.variable-card');\n        $targetCard\n            .find('.nested-cards-container')\n            .first()\n            .children('.variable-card')\n            .each((_, element) => {\n            const key = $(element).find('.variable-title').val();\n            if (key) {\n                existingKeys.add(key);\n            }\n        });\n        const newKey = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.generateUniqueKey(existingKeys);\n        const newVariable = {\n            name: newKey,\n            dataType: newDataType,\n            value: defaultValue,\n            id: '',\n        };\n        const newNestedCard = this.createCard(newVariable, true, showTypeDialogCallback);\n        const $targetCardHeader = $targetCard.find('.variable-card-header').first();\n        const $targetCardContent = $targetCardHeader.siblings('.variable-card-content').first();\n        const $container = $targetCardContent.find('.nested-cards-container').first();\n        $container.prepend(newNestedCard);\n        newNestedCard.find('.variable-title').focus().select();\n        const topLevelCard = this.findTopLevelCard($targetCard);\n        if (topLevelCard && topLevelCard.is($targetCard)) {\n            this.syncCardViewToJsonInput($targetCard);\n        }\n    }\n    /**\n     * \n     * @param card \n     * @param variable \n     * @param isNested \n     * @param showTypeDialogCallback \n     */\n    setupObjectCard(card, variable, isNested, showTypeDialogCallback) {\n        if (isNested) {\n            card.find('.variable-card-content').append(`\n        <div class=\"nested-object-container\">\n          <div class=\"nested-cards-container\"></div>\n        </div>\n      `);\n            card.find('.variable-actions .object-save-btn').before(`\n        <button class=\"variable-action-btn add-nested-key-btn\" title=\"\">\n          <i class=\"fa-regular fa-plus\"></i>\n        </button>\n      `);\n        }\n        else {\n            card.find('.variable-card-content').append(`\n        <textarea class=\"json-input variable-content-input\" placeholder=\"JSON\" style=\"display: none;\"></textarea>\n            <div class=\"object-card-view\">\n              <div class=\"nested-cards-container\"></div>\n            </div>\n      `);\n            card.find('.variable-actions .save-btn').before(`\n        <button class=\"variable-action-btn toggle-view-btn\" title=\"JSON\">\n          <i class=\"fa-regular fa-list\"></i>\n        </button>\n        <button class=\"variable-action-btn add-key-btn\" title=\"\">\n          <i class=\"fa-regular fa-plus\"></i>\n        </button>\n      `);\n            card.find('.json-input').val(JSON.stringify(variable.value, null, 2)).end().attr('data-view-mode', 'card');\n            card.find('.json-input').on('blur change', () => {\n                const currentMode = card.attr('data-view-mode') || 'card';\n                if (currentMode === 'card') {\n                    this.syncJsonInputToCardView(card, showTypeDialogCallback);\n                }\n            });\n            card.find('.toggle-view-btn').on('click', () => {\n                const $card = card;\n                const currentMode = $card.attr('data-view-mode') || 'card';\n                const newMode = currentMode === 'json' ? 'card' : 'json';\n                $card.attr('data-view-mode', newMode);\n                if (newMode === 'json') {\n                    $card\n                        .find('.toggle-view-btn i')\n                        .removeClass('fa-list')\n                        .addClass('fa-eye')\n                        .end()\n                        .attr('title', '');\n                    $card.find('.variable-action-btn.add-key-btn').hide();\n                    $card.find('.json-input').show().end().find('.object-card-view').hide();\n                    this.syncCardViewToJsonInput($card);\n                }\n                else {\n                    $card\n                        .find('.toggle-view-btn i')\n                        .removeClass('fa-eye')\n                        .addClass('fa-list')\n                        .end()\n                        .attr('title', 'JSON');\n                    $card.find('.variable-action-btn.add-key-btn').show();\n                    $card.find('.json-input').hide().end().find('.object-card-view').show();\n                    this.syncJsonInputToCardView($card, showTypeDialogCallback);\n                }\n            });\n        }\n        try {\n            this.renderObjectCardView(card, variable, showTypeDialogCallback);\n        }\n        catch (e) {\n            console.error(':', e);\n            toastr.error('');\n        }\n    }\n    /**\n     * JSON\n     * @param card \n     */\n    syncCardViewToJsonInput(card) {\n        const objectValue = this.extractObjectFromNestedCards(card);\n        card.find('.json-input').val(JSON.stringify(objectValue, null, 2));\n    }\n    /**\n     * JSON\n     * @param card \n     * @param showTypeDialogCallback \n     */\n    syncJsonInputToCardView(card, showTypeDialogCallback) {\n        try {\n            const jsonValue = card.find('.json-input').val();\n            if (jsonValue && jsonValue.trim()) {\n                const objectValue = JSON.parse(jsonValue);\n                const tempVariable = {\n                    id: card.attr('data-variable-id') || '',\n                    name: card.find('.variable-title').val(),\n                    dataType: 'object',\n                    value: objectValue,\n                };\n                this.renderObjectCardView(card, tempVariable, showTypeDialogCallback);\n            }\n        }\n        catch (parseError) {\n            console.error('JSON:', parseError);\n            toastr.error('JSON');\n        }\n    }\n    /**\n     * \n     * @param card \n     * @param items \n     */\n    populateArrayItems(card, items) {\n        if (!items || items.length === 0) {\n            return;\n        }\n        const listContainer = card.find('.list-items-container');\n        listContainer.empty();\n        items.forEach(item => {\n            const displayValue = typeof item === 'object' ? JSON.stringify(item) : String(item);\n            const listItem = $(`\n        <div class=\"list-item\">\n          <span class=\"drag-handle\"></span>\n          <textarea class=\"variable-content-input\">${displayValue}</textarea>\n          <button class=\"list-item-delete\"><i class=\"fa-solid fa-times\"></i></button>\n        </div>\n      `);\n            listContainer.append(listItem);\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RztJQUNLLGtCQUFrQixDQUFDLElBQXlCLEVBQUUsS0FBWTtRQUNoRSxJQUFJLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDakMsT0FBTztRQUNULENBQUM7UUFFRCxNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLENBQUM7UUFDekQsYUFBYSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBRXRCLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDbkIsTUFBTSxZQUFZLEdBQUcsT0FBTyxJQUFJLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDcEYsTUFBTSxRQUFRLEdBQUcsQ0FBQyxDQUFDOzs7cURBRzRCLFlBQVk7OztPQUcxRCxDQUFDLENBQUM7WUFDSCxhQUFhLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2pDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL2NhcmQudHM/MjQ2OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYXJpYWJsZURhdGFUeXBlLCBWYXJpYWJsZUl0ZW0gfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3R5cGVzJztcbmltcG9ydCB7IFZhcmlhYmxlTWFuYWdlclV0aWwgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3V0aWwnO1xuaW1wb3J0IHsgZ2V0U29ydGFibGVEZWxheSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuZGVjbGFyZSBjb25zdCB0b2FzdHI6IGFueTtcblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlQ2FyZEZhY3Rvcnkge1xuICBwcml2YXRlIGRlZmF1bHRUeXBlRGlhbG9nQ2FsbGJhY2s/OiAoY2FsbGJhY2s6IChkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSkgPT4gdm9pZCkgPT4gUHJvbWlzZTx2b2lkPjtcblxuICAvKipcbiAgICog5p6E6YCg5Ye95pWwXG4gICAqIEBwYXJhbSBkZWZhdWx0VHlwZURpYWxvZ0NhbGxiYWNrIOm7mOiupOeahOexu+Wei+mAieaLqeWvueivneahhuWbnuiwg+WHveaVsFxuICAgKi9cbiAgY29uc3RydWN0b3IoZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjaz86IChjYWxsYmFjazogKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKSA9PiB2b2lkKSA9PiBQcm9taXNlPHZvaWQ+KSB7XG4gICAgdGhpcy5kZWZhdWx0VHlwZURpYWxvZ0NhbGxiYWNrID0gZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjaztcbiAgICB0aGlzLnNldHVwR2xvYmFsRXZlbnREZWxlZ2F0aW9uKCk7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u5YWo5bGA5LqL5Lu25aeU5omYXG4gICAqL1xuICBwcml2YXRlIHNldHVwR2xvYmFsRXZlbnREZWxlZ2F0aW9uKCk6IHZvaWQge1xuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudmFyaWFibGUtYWN0aW9uLWJ0bi5vYmplY3Qtc2F2ZS1idG4nLCBldmVudCA9PiB7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICBjb25zdCAkYnV0dG9uID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgIGNvbnN0ICRuZXN0ZWRDYXJkID0gJGJ1dHRvbi5jbG9zZXN0KCcudmFyaWFibGUtY2FyZCcpO1xuXG4gICAgICBjb25zdCAkcGFyZW50Q2FyZCA9IHRoaXMuZmluZFRvcExldmVsQ2FyZCgkbmVzdGVkQ2FyZCk7XG5cbiAgICAgIGlmICgkcGFyZW50Q2FyZCkge1xuICAgICAgICB0aGlzLnNhdmVOZXN0ZWRDYXJkVmFsdWUoJHBhcmVudENhcmQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy52YXJpYWJsZS1hY3Rpb24tYnRuLm9iamVjdC1kZWxldGUtYnRuJywgZXZlbnQgPT4ge1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblxuICAgICAgY29uc3QgJGJ1dHRvbiA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgICBjb25zdCAkbmVzdGVkQ2FyZCA9ICRidXR0b24uY2xvc2VzdCgnLnZhcmlhYmxlLWNhcmQnKTtcblxuICAgICAgY29uc3QgJHBhcmVudENhcmQgPSB0aGlzLmZpbmRUb3BMZXZlbENhcmQoJG5lc3RlZENhcmQpO1xuXG4gICAgICBpZiAoJHBhcmVudENhcmQpIHtcbiAgICAgICAgdGhpcy5kZWxldGVOZXN0ZWRDYXJkVmFsdWUoJHBhcmVudENhcmQsICRuZXN0ZWRDYXJkKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudmFyaWFibGUtYWN0aW9uLWJ0bi5hZGQtbmVzdGVkLWtleS1idG4nLCBhc3luYyBldmVudCA9PiB7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICBjb25zdCAkYnV0dG9uID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgIGNvbnN0ICRjYXJkID0gJGJ1dHRvbi5jbG9zZXN0KCcudmFyaWFibGUtY2FyZCcpO1xuXG4gICAgICBjb25zdCBkaWFsb2dDYWxsYmFjayA9IHRoaXMuZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjaztcbiAgICAgIGlmIChkaWFsb2dDYWxsYmFjaykge1xuICAgICAgICBhd2FpdCBkaWFsb2dDYWxsYmFjaygoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHtcbiAgICAgICAgICB0aGlzLmFkZE9iamVjdEtleSgkY2FyZCwgZGF0YVR5cGUsIHRoaXMuZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjayk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign5re75Yqg5Y2h54mH5Ye66ZSZJyk7XG4gICAgICAgIHRvYXN0ci5lcnJvcign5re75Yqg5Y2h54mH5Ye66ZSZJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnZhcmlhYmxlLWFjdGlvbi1idG4uYWRkLWtleS1idG4nLCBhc3luYyBldmVudCA9PiB7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICBjb25zdCAkYnV0dG9uID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgIGNvbnN0ICRjYXJkID0gJGJ1dHRvbi5jbG9zZXN0KCcudmFyaWFibGUtY2FyZCcpO1xuXG4gICAgICBjb25zdCBkaWFsb2dDYWxsYmFjayA9IHRoaXMuZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjaztcbiAgICAgIGlmIChkaWFsb2dDYWxsYmFjaykge1xuICAgICAgICBhd2FpdCBkaWFsb2dDYWxsYmFjaygoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHtcbiAgICAgICAgICB0aGlzLmFkZE9iamVjdEtleSgkY2FyZCwgZGF0YVR5cGUsIHRoaXMuZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjayk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign5pyq5o+Q5L6b57G75Z6L6YCJ5oup5a+56K+d5qGG5Zue6LCD5Ye95pWwJyk7XG4gICAgICAgIHRvYXN0ci5lcnJvcign5pyq5o+Q5L6b57G75Z6L6YCJ5oup5a+56K+d5qGG5Zue6LCD5Ye95pWwJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu65Y+Y6YeP5Y2h54mHXG4gICAqIEBwYXJhbSB2YXJpYWJsZSDlj5jph49cbiAgICogQHBhcmFtIGlzTmVzdGVkIOaYr+WQpuS4uuW1jOWll+WNoeeJh1xuICAgKiBAcGFyYW0gc2hvd1R5cGVEaWFsb2dDYWxsYmFjayDmmL7npLrnsbvlnovpgInmi6nlr7nor53moYbnmoTlm57osIPlh73mlbDvvIjku4XnlKjkuo7lr7nosaHnsbvlnovvvIlcbiAgICogQHJldHVybnMg5Y+Y6YeP5Y2h54mHalF1ZXJ55a+56LGhXG4gICAqL1xuICBwdWJsaWMgY3JlYXRlQ2FyZChcbiAgICB2YXJpYWJsZTogVmFyaWFibGVJdGVtLFxuICAgIGlzTmVzdGVkPzogYm9vbGVhbixcbiAgICBzaG93VHlwZURpYWxvZ0NhbGxiYWNrPzogKGNhbGxiYWNrOiAoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHZvaWQpID0+IFByb21pc2U8dm9pZD4sXG4gICk6IEpRdWVyeTxIVE1MRWxlbWVudD4ge1xuICAgIGxldCBjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+O1xuICAgIGNvbnN0IHsgbmFtZSwgdmFsdWUsIGRhdGFUeXBlLCBpZCB9ID0gdmFyaWFibGU7XG4gICAgY2FyZCA9ICQoYFxuICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLWNhcmRcIiBkYXRhLXR5cGU9XCIke2RhdGFUeXBlfVwiIGRhdGEtdmFyaWFibGUtaWQ9XCIke2lkfVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidmFyaWFibGUtY2FyZC1oZWFkZXJcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwidmFyaWFibGUtdGl0bGUtY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8aT48L2k+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cInZhcmlhYmxlLXRpdGxlXCIgdmFsdWU9XCIke25hbWV9XCIgcGxhY2Vob2xkZXI9XCLlj5jph4/lkI3np7BcIj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwidmFyaWFibGUtYWN0aW9uc1wiPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInZhcmlhYmxlLWFjdGlvbi1idG4gc2F2ZS1idG5cIiB0aXRsZT1cIuS/neWtmFwiPlxuICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtc2F2ZVwiPjwvaT5cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInZhcmlhYmxlLWFjdGlvbi1idG4gZGVsZXRlLWJ0blwiIHRpdGxlPVwi5Yig6ZmkXCI+XG4gICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmEtcmVndWxhciBmYS10cmFzaC1jYW5cIj48L2k+XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1jYXJkLWNvbnRlbnRcIj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcblxuICAgIGlmIChpc05lc3RlZCkge1xuICAgICAgY2FyZC5yZW1vdmVBdHRyKCdkYXRhLXZhcmlhYmxlLWlkJyk7XG4gICAgICBjYXJkXG4gICAgICAgIC5maW5kKCcudmFyaWFibGUtYWN0aW9uLWJ0bi5zYXZlLWJ0bicpXG4gICAgICAgIC5yZW1vdmVDbGFzcygnc2F2ZS1idG4nKVxuICAgICAgICAuYWRkQ2xhc3MoJ29iamVjdC1zYXZlLWJ0bicpXG4gICAgICAgIC5lbmQoKVxuICAgICAgICAuZmluZCgnLnZhcmlhYmxlLWFjdGlvbi1idG4uZGVsZXRlLWJ0bicpXG4gICAgICAgIC5yZW1vdmVDbGFzcygnZGVsZXRlLWJ0bicpXG4gICAgICAgIC5hZGRDbGFzcygnb2JqZWN0LWRlbGV0ZS1idG4nKTtcbiAgICB9XG5cbiAgICBzd2l0Y2ggKGRhdGFUeXBlKSB7XG4gICAgICBjYXNlICdhcnJheSc6XG4gICAgICAgIGNhcmRcbiAgICAgICAgICAuZmluZCgnLnZhcmlhYmxlLXRpdGxlLWNvbnRhaW5lciBpJylcbiAgICAgICAgICAuYWRkQ2xhc3MoJ2ZhLXNvbGlkIGZhLWxpc3QnKVxuICAgICAgICAgIC5lbmQoKVxuICAgICAgICAgIC5maW5kKCcudmFyaWFibGUtY2FyZC1jb250ZW50JylcbiAgICAgICAgICAuYXBwZW5kKFxuICAgICAgICAgICAgYDxkaXYgY2xhc3M9XCJsaXN0LWl0ZW1zLWNvbnRhaW5lclwiPjwvZGl2PjxidXR0b24gY2xhc3M9XCJhZGQtbGlzdC1pdGVtXCI+PGkgY2xhc3M9XCJmYS1zb2xpZCBmYS1wbHVzXCI+PC9pPiDmt7vliqDpobnnm648L2J1dHRvbj5gLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5wb3B1bGF0ZUFycmF5SXRlbXMoY2FyZCwgdmFsdWUpO1xuXG4gICAgICAgIHtcbiAgICAgICAgICBjb25zdCBsaXN0Q29udGFpbmVyID0gY2FyZC5maW5kKCcubGlzdC1pdGVtcy1jb250YWluZXInKTtcbiAgICAgICAgICBsaXN0Q29udGFpbmVyLnNvcnRhYmxlKHtcbiAgICAgICAgICAgIGRlbGF5OiBnZXRTb3J0YWJsZURlbGF5KCksXG4gICAgICAgICAgICBoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtdGl0bGUtY29udGFpbmVyIGknKS5hZGRDbGFzcygnZmEtcmVndWxhciBmYS1jb2RlJyk7XG4gICAgICAgIHRoaXMuc2V0dXBPYmplY3RDYXJkKGNhcmQsIHZhcmlhYmxlLCBpc05lc3RlZCwgc2hvd1R5cGVEaWFsb2dDYWxsYmFjayk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICAgIGNhcmRcbiAgICAgICAgICAuZmluZCgnLnZhcmlhYmxlLXRpdGxlLWNvbnRhaW5lciBpJylcbiAgICAgICAgICAuYWRkQ2xhc3MoJ2ZhLXJlZ3VsYXIgZmEtdG9nZ2xlLW9uJylcbiAgICAgICAgICAuZW5kKClcbiAgICAgICAgICAuZmluZCgnLnZhcmlhYmxlLWNhcmQtY29udGVudCcpXG4gICAgICAgICAgLmFwcGVuZChcbiAgICAgICAgICAgIGBcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJvb2xlYW4taW5wdXQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJvb2xlYW4tYnV0dG9ucy1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJib29sZWFuLWJ0biAke3ZhbHVlID8gJ2FjdGl2ZScgOiAnJ31cIiBkYXRhLXZhbHVlPVwidHJ1ZVwiPlRydWU8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJib29sZWFuLWJ0biAkeyF2YWx1ZSA/ICdhY3RpdmUnIDogJyd9XCIgZGF0YS12YWx1ZT1cImZhbHNlXCI+RmFsc2U8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICBgLFxuICAgICAgICAgIClcbiAgICAgICAgICAuZmluZCgnLmJvb2xlYW4tYnRuJylcbiAgICAgICAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2FyZC5maW5kKCcuYm9vbGVhbi1idG4nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICBjYXJkXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS10aXRsZS1jb250YWluZXIgaScpXG4gICAgICAgICAgLmFkZENsYXNzKCdmYS1zb2xpZCBmYS1oYXNodGFnJylcbiAgICAgICAgICAuZW5kKClcbiAgICAgICAgICAuZmluZCgnLnZhcmlhYmxlLWNhcmQtY29udGVudCcpXG4gICAgICAgICAgLmFwcGVuZChgPGlucHV0IHR5cGU9XCJudW1iZXJcIiBjbGFzcz1cIm51bWJlci1pbnB1dCB2YXJpYWJsZS1jb250ZW50LWlucHV0XCIgdmFsdWU9XCIke3ZhbHVlfVwiIHN0ZXA9XCJhbnlcIj5gKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICBjYXJkXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS10aXRsZS1jb250YWluZXIgaScpXG4gICAgICAgICAgLmFkZENsYXNzKCdmYS1zb2xpZCBmYS1mb250JylcbiAgICAgICAgICAuZW5kKClcbiAgICAgICAgICAuZmluZCgnLnZhcmlhYmxlLWNhcmQtY29udGVudCcpXG4gICAgICAgICAgLmFwcGVuZChcbiAgICAgICAgICAgIGA8dGV4dGFyZWEgY2xhc3M9XCJzdHJpbmctaW5wdXQgdmFyaWFibGUtY29udGVudC1pbnB1dFwiIHBsYWNlaG9sZGVyPVwi6L6T5YWl5a2X56ym5Liy5YC8XCI+JHt2YWx1ZX08L3RleHRhcmVhPmAsXG4gICAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJldHVybiBjYXJkO1xuICB9XG5cbiAgLyoqXG4gICAqIOS7juWNoeeJh+iOt+WPluWPmOmHj+S/oeaBr1xuICAgKiBAcGFyYW0gY2FyZCDlj5jph4/ljaHniYdcbiAgICogQHJldHVybnMg5Y+Y6YeP5L+h5oGvXG4gICAqL1xuICBwdWJsaWMgZ2V0VmFyaWFibGVGcm9tQ2FyZChjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogVmFyaWFibGVJdGVtIHwgbnVsbCB7XG4gICAgY29uc3QgaWQgPSBjYXJkLmF0dHIoJ2RhdGEtdmFyaWFibGUtaWQnKSB8fCAnJztcbiAgICBjb25zdCBuYW1lID0gY2FyZC5maW5kKCcudmFyaWFibGUtdGl0bGUnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgY29uc3QgZGF0YVR5cGUgPSBjYXJkLmF0dHIoJ2RhdGEtdHlwZScpIGFzIFZhcmlhYmxlRGF0YVR5cGU7XG4gICAgY29uc3QgdmFsdWUgPSB0aGlzLmV4dHJhY3RWYWx1ZUZyb21DYXJkKGNhcmQsIGRhdGFUeXBlKTtcblxuICAgIHJldHVybiB7XG4gICAgICBpZCxcbiAgICAgIG5hbWUsXG4gICAgICBkYXRhVHlwZSxcbiAgICAgIHZhbHVlLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICog5LuO5Y2h54mH5o+Q5Y+W5YC877yI57uf5LiA5aSE55CG5omA5pyJ57G75Z6L55qE5Y2h54mH5YC85o+Q5Y+W77yJXG4gICAqIEBwYXJhbSBjYXJkIOWNoeeJh1xuICAgKiBAcGFyYW0gZGF0YVR5cGUg5pWw5o2u57G75Z6LXG4gICAqIEByZXR1cm5zIOaPkOWPlueahOWAvFxuICAgKi9cbiAgcHJpdmF0ZSBleHRyYWN0VmFsdWVGcm9tQ2FyZChjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSk6IGFueSB7XG4gICAgc3dpdGNoIChkYXRhVHlwZSkge1xuICAgICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgICAgcmV0dXJuIGNhcmQuZmluZCgnLnN0cmluZy1pbnB1dCcpLnZhbCgpIGFzIHN0cmluZztcbiAgICAgIGNhc2UgJ251bWJlcic6IHtcbiAgICAgICAgY29uc3QgbnVtYmVyVmFsdWUgPSBjYXJkLmZpbmQoJy5udW1iZXItaW5wdXQnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICAgIHJldHVybiBudW1iZXJWYWx1ZSA/IHBhcnNlRmxvYXQobnVtYmVyVmFsdWUpIDogMDtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICByZXR1cm4gY2FyZC5maW5kKCcuYm9vbGVhbi1idG4uYWN0aXZlJykuYXR0cignZGF0YS12YWx1ZScpID09PSAndHJ1ZSc7XG4gICAgICBjYXNlICdhcnJheSc6IHtcbiAgICAgICAgY29uc3QgYXJyYXlJdGVtczogYW55W10gPSBbXTtcbiAgICAgICAgY2FyZC5maW5kKCcubGlzdC1pdGVtJykuZWFjaCgoXywgZWxlbSkgPT4ge1xuICAgICAgICAgIGNvbnN0ICRsaXN0SXRlbSA9ICQoZWxlbSk7XG5cbiAgICAgICAgICBjb25zdCBpdGVtVmFsdWUgPSAkbGlzdEl0ZW0uZmluZCgnLnZhcmlhYmxlLWNvbnRlbnQtaW5wdXQnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGFycmF5SXRlbXMucHVzaChKU09OLnBhcnNlKGl0ZW1WYWx1ZSkpO1xuICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgYXJyYXlJdGVtcy5wdXNoKGl0ZW1WYWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGFycmF5SXRlbXM7XG4gICAgICB9XG4gICAgICBjYXNlICdvYmplY3QnOiB7XG4gICAgICAgIGNvbnN0IHZpZXdNb2RlID0gY2FyZC5hdHRyKCdkYXRhLXZpZXctbW9kZScpIHx8ICdjYXJkJztcblxuICAgICAgICBpZiAodmlld01vZGUgPT09ICdjYXJkJykge1xuICAgICAgICAgIGNvbnN0IGV4dHJhY3RlZCA9IHRoaXMuZXh0cmFjdE9iamVjdEZyb21OZXN0ZWRDYXJkcyhjYXJkKTtcbiAgICAgICAgICByZXR1cm4gZXh0cmFjdGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QganNvblZhbHVlID0gY2FyZC5maW5kKCcuanNvbi1pbnB1dCcpLnZhbCgpIGFzIHN0cmluZztcblxuICAgICAgICBpZiAoanNvblZhbHVlICYmIGpzb25WYWx1ZS50cmltKCkpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShqc29uVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlZDtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdKU09O6Kej5p6Q6ZSZ6K+vOicsIGUpO1xuICAgICAgICAgICAgdG9hc3RyLmVycm9yKCdKU09O6Kej5p6Q6ZSZ6K+vJyk7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGV4dHJhY3RlZCA9IHRoaXMuZXh0cmFjdE9iamVjdEZyb21OZXN0ZWRDYXJkcyhjYXJkKTtcbiAgICAgICAgICByZXR1cm4gZXh0cmFjdGVkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gY2FyZC5maW5kKCcudmFyaWFibGUtY29udGVudC1pbnB1dCcpLnZhbCgpIGFzIHN0cmluZztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5LuO5bWM5aWX5Y2h54mH5o+Q5Y+W5a+56LGh5YC8XG4gICAqIEBwYXJhbSBjYXJkIOWvueixoeWNoeeJh1xuICAgKiBAcmV0dXJucyDmj5Dlj5bnmoTlr7nosaHlgLxcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdE9iamVjdEZyb21OZXN0ZWRDYXJkcyhjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogUmVjb3JkPHN0cmluZywgYW55PiB7XG4gICAgY29uc3QgcmVzdWx0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG5cbiAgICBsZXQgJGNvbnRhaW5lciA9IGNhcmQuZmluZCgnPiAudmFyaWFibGUtY2FyZC1jb250ZW50ID4gLm9iamVjdC1jYXJkLXZpZXcgPiAubmVzdGVkLWNhcmRzLWNvbnRhaW5lcicpO1xuXG4gICAgaWYgKCRjb250YWluZXIubGVuZ3RoID09PSAwKSB7XG4gICAgICAkY29udGFpbmVyID0gY2FyZC5maW5kKCc+IC52YXJpYWJsZS1jYXJkLWNvbnRlbnQgPiAubmVzdGVkLW9iamVjdC1jb250YWluZXIgPiAubmVzdGVkLWNhcmRzLWNvbnRhaW5lcicpO1xuICAgIH1cblxuICAgIGlmICgkY29udGFpbmVyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgJGNvbnRhaW5lciA9IGNhcmQuZmluZCgnLm5lc3RlZC1jYXJkcy1jb250YWluZXInKS5maXJzdCgpO1xuICAgIH1cblxuICAgICRjb250YWluZXIuY2hpbGRyZW4oJy52YXJpYWJsZS1jYXJkJykuZWFjaCgoX2luZGV4LCBlbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCAkbmVzdGVkQ2FyZCA9ICQoZWxlbWVudCk7XG4gICAgICBjb25zdCBrZXkgPSAkbmVzdGVkQ2FyZC5maW5kKCcudmFyaWFibGUtdGl0bGUnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICBjb25zdCBuZXN0ZWREYXRhVHlwZSA9ICRuZXN0ZWRDYXJkLmF0dHIoJ2RhdGEtdHlwZScpIGFzIFZhcmlhYmxlRGF0YVR5cGU7XG5cbiAgICAgIGNvbnNvbGUubG9nKCdbVmFyaWFibGVNYW5hZ2VyXSDlpITnkIbltYzlpZfljaHniYc6Jywge1xuICAgICAgICBpbmRleDogX2luZGV4LFxuICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgZGF0YVR5cGU6IG5lc3RlZERhdGFUeXBlLFxuICAgICAgICBjYXJkSHRtbDogJG5lc3RlZENhcmRbMF0ub3V0ZXJIVE1MLnN1YnN0cmluZygwLCAyMDApICsgJy4uLidcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoa2V5KSB7XG4gICAgICAgIGNvbnN0IG5lc3RlZFZhbHVlID0gdGhpcy5leHRyYWN0VmFsdWVGcm9tQ2FyZCgkbmVzdGVkQ2FyZCwgbmVzdGVkRGF0YVR5cGUpO1xuICAgICAgICByZXN1bHRba2V5XSA9IG5lc3RlZFZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdbVmFyaWFibGVNYW5hZ2VyXSDot7Pov4fnqbrplK7nmoTltYzlpZfljaHniYc6JywgX2luZGV4KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKCdbVmFyaWFibGVNYW5hZ2VyXSDmnIDnu4jmj5Dlj5bnu5Pmnpw6JywgcmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIOa4suafk+WvueixoeWNoeeJh+eahOWNoeeJh+inhuWbvlxuICAgKiBAcGFyYW0gY2FyZCDlr7nosaHljaHniYdqUXVlcnnlr7nosaFcbiAgICogQHBhcmFtIHZhcmlhYmxlIOWvueixoeWPmOmHj1xuICAgKiBAcGFyYW0gc2hvd1R5cGVEaWFsb2dDYWxsYmFjayDmmL7npLrnsbvlnovpgInmi6nlr7nor53moYbnmoTlm57osIPlh73mlbBcbiAgICovXG4gIHByaXZhdGUgcmVuZGVyT2JqZWN0Q2FyZFZpZXcoXG4gICAgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgICB2YXJpYWJsZTogVmFyaWFibGVJdGVtLFxuICAgIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2s/OiAoY2FsbGJhY2s6IChkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSkgPT4gdm9pZCkgPT4gUHJvbWlzZTx2b2lkPixcbiAgKTogdm9pZCB7XG4gICAgY29uc3QgJGNvbnRhaW5lciA9IGNhcmQuZmluZCgnLm5lc3RlZC1jYXJkcy1jb250YWluZXInKTtcbiAgICAkY29udGFpbmVyLmVtcHR5KCk7XG5cbiAgICBpZiAoIXZhcmlhYmxlLnZhbHVlIHx8IHR5cGVvZiB2YXJpYWJsZS52YWx1ZSAhPT0gJ29iamVjdCcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBPYmplY3QuZW50cmllcyh2YXJpYWJsZS52YWx1ZSkuZm9yRWFjaCgoW2tleSwgcHJvcGVydHlWYWx1ZV0pID0+IHtcbiAgICAgIGNvbnN0IGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlID0gVmFyaWFibGVNYW5hZ2VyVXRpbC5pbmZlckRhdGFUeXBlKHByb3BlcnR5VmFsdWUpO1xuXG4gICAgICBjb25zdCBwcm9wZXJ0eVZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICAgIG5hbWU6IGtleSxcbiAgICAgICAgZGF0YVR5cGU6IGRhdGFUeXBlLFxuICAgICAgICB2YWx1ZTogcHJvcGVydHlWYWx1ZSxcbiAgICAgICAgaWQ6ICcnLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgbmVzdGVkQ2FyZCA9IHRoaXMuY3JlYXRlQ2FyZChwcm9wZXJ0eVZhcmlhYmxlLCB0cnVlLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcblxuICAgICAgJGNvbnRhaW5lci5hcHBlbmQobmVzdGVkQ2FyZCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog6Kem5Y+R5bWM5aWX5Y2h54mH5L+d5a2Y5LqL5Lu2XG4gICAqIEBwYXJhbSBwYXJlbnRDYXJkIOeItue6p+WNoeeJh1xuICAgKi9cbiAgcHJpdmF0ZSBzYXZlTmVzdGVkQ2FyZFZhbHVlKHBhcmVudENhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICB0aGlzLnN5bmNDYXJkVmlld1RvSnNvbklucHV0KHBhcmVudENhcmQpO1xuXG4gICAgY29uc3QgdG9wTGV2ZWxDYXJkID0gdGhpcy5maW5kVG9wTGV2ZWxDYXJkKHBhcmVudENhcmQpO1xuICAgIGlmICh0b3BMZXZlbENhcmQpIHtcbiAgICAgIHRvcExldmVsQ2FyZC50cmlnZ2VyKCduZXN0ZWQtY2FyZDpjaGFuZ2VkJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaJvuWIsOmhtue6p+WvueixoeWNoeeJh1xuICAgKiBAcGFyYW0gY2FyZCDlvZPliY3ljaHniYdcbiAgICogQHJldHVybnMg5YW35pyJZGF0YS12YXJpYWJsZS1pZOWxnuaAp+eahOWNoeeJh+aIlm51bGxcbiAgICovXG4gIHByaXZhdGUgZmluZFRvcExldmVsQ2FyZChjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB8IG51bGwge1xuICAgIGlmIChjYXJkLmF0dHIoJ2RhdGEtdmFyaWFibGUtaWQnKSkge1xuICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgfVxuXG4gICAgY29uc3QgY2FyZFdpdGhJZCA9IGNhcmQuY2xvc2VzdCgnW2RhdGEtdmFyaWFibGUtaWRdJyk7XG4gICAgcmV0dXJuIGNhcmRXaXRoSWQubGVuZ3RoID4gMCA/IGNhcmRXaXRoSWQgOiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIoOmZpOW1jOWll+WNoeeJh1xuICAgKiBAcGFyYW0gcGFyZW50Q2FyZCDniLbnuqfljaHniYdcbiAgICogQHBhcmFtIG5lc3RlZENhcmQg5bWM5aWX5Y2h54mHXG4gICAqL1xuICBwcml2YXRlIGRlbGV0ZU5lc3RlZENhcmRWYWx1ZShwYXJlbnRDYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBuZXN0ZWRDYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogdm9pZCB7XG4gICAgbmVzdGVkQ2FyZC5yZW1vdmUoKTtcblxuICAgIHRoaXMuc3luY0NhcmRWaWV3VG9Kc29uSW5wdXQocGFyZW50Q2FyZCk7XG5cbiAgICBjb25zdCB0b3BMZXZlbENhcmQgPSB0aGlzLmZpbmRUb3BMZXZlbENhcmQocGFyZW50Q2FyZCk7XG4gICAgaWYgKHRvcExldmVsQ2FyZCkge1xuICAgICAgdG9wTGV2ZWxDYXJkLnRyaWdnZXIoJ25lc3RlZC1jYXJkOmNoYW5nZWQnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Li65a+56LGh5Y2h54mH5re75Yqg5paw55qE6ZSu5YC85a+577yI57uf5LiA5aSE55CG6aG257qn5ZKM5bWM5aWX5a+56LGh5Y2h54mH77yJXG4gICAqIEBwYXJhbSBjYXJkIOWvueixoeWNoeeJh++8iOmhtue6p+aIluW1jOWll++8iVxuICAgKiBAcGFyYW0gZGF0YVR5cGUg5paw6ZSu5YC85a+555qE5pWw5o2u57G75Z6LXG4gICAqIEBwYXJhbSBzaG93VHlwZURpYWxvZ0NhbGxiYWNrIOaYvuekuuexu+Wei+mAieaLqeWvueivneahhueahOWbnuiwg+WHveaVsFxuICAgKi9cbiAgcHJpdmF0ZSBhZGRPYmplY3RLZXkoXG4gICAgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgICBuZXdEYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSxcbiAgICBzaG93VHlwZURpYWxvZ0NhbGxiYWNrPzogKGNhbGxiYWNrOiAoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHZvaWQpID0+IFByb21pc2U8dm9pZD4sXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IFZhcmlhYmxlTWFuYWdlclV0aWwuZ2V0RGVmYXVsdFZhbHVlRm9yVHlwZShuZXdEYXRhVHlwZSk7XG4gICAgY29uc3QgZXhpc3RpbmdLZXlzID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgICBjb25zdCAkdGFyZ2V0Q2FyZCA9IGNhcmQuY2xvc2VzdCgnLnZhcmlhYmxlLWNhcmQnKTtcbiAgICAkdGFyZ2V0Q2FyZFxuICAgICAgLmZpbmQoJy5uZXN0ZWQtY2FyZHMtY29udGFpbmVyJylcbiAgICAgIC5maXJzdCgpXG4gICAgICAuY2hpbGRyZW4oJy52YXJpYWJsZS1jYXJkJylcbiAgICAgIC5lYWNoKChfLCBlbGVtZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGtleSA9ICQoZWxlbWVudCkuZmluZCgnLnZhcmlhYmxlLXRpdGxlJykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgZXhpc3RpbmdLZXlzLmFkZChrZXkpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIGNvbnN0IG5ld0tleSA9IFZhcmlhYmxlTWFuYWdlclV0aWwuZ2VuZXJhdGVVbmlxdWVLZXkoZXhpc3RpbmdLZXlzKTtcblxuICAgIGNvbnN0IG5ld1ZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICBuYW1lOiBuZXdLZXksXG4gICAgICBkYXRhVHlwZTogbmV3RGF0YVR5cGUsXG4gICAgICB2YWx1ZTogZGVmYXVsdFZhbHVlLFxuICAgICAgaWQ6ICcnLFxuICAgIH07XG5cbiAgICBjb25zdCBuZXdOZXN0ZWRDYXJkID0gdGhpcy5jcmVhdGVDYXJkKG5ld1ZhcmlhYmxlLCB0cnVlLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcblxuICAgIGNvbnN0ICR0YXJnZXRDYXJkSGVhZGVyID0gJHRhcmdldENhcmQuZmluZCgnLnZhcmlhYmxlLWNhcmQtaGVhZGVyJykuZmlyc3QoKTtcbiAgICBjb25zdCAkdGFyZ2V0Q2FyZENvbnRlbnQgPSAkdGFyZ2V0Q2FyZEhlYWRlci5zaWJsaW5ncygnLnZhcmlhYmxlLWNhcmQtY29udGVudCcpLmZpcnN0KCk7XG4gICAgY29uc3QgJGNvbnRhaW5lciA9ICR0YXJnZXRDYXJkQ29udGVudC5maW5kKCcubmVzdGVkLWNhcmRzLWNvbnRhaW5lcicpLmZpcnN0KCk7XG5cbiAgICAkY29udGFpbmVyLnByZXBlbmQobmV3TmVzdGVkQ2FyZCk7XG5cbiAgICBuZXdOZXN0ZWRDYXJkLmZpbmQoJy52YXJpYWJsZS10aXRsZScpLmZvY3VzKCkuc2VsZWN0KCk7XG5cbiAgICBjb25zdCB0b3BMZXZlbENhcmQgPSB0aGlzLmZpbmRUb3BMZXZlbENhcmQoJHRhcmdldENhcmQpO1xuICAgIGlmICh0b3BMZXZlbENhcmQgJiYgdG9wTGV2ZWxDYXJkLmlzKCR0YXJnZXRDYXJkKSkge1xuICAgICAgdGhpcy5zeW5jQ2FyZFZpZXdUb0pzb25JbnB1dCgkdGFyZ2V0Q2FyZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruWvueixoeWNoeeJh++8iOe7n+S4gOWkhOeQhuW1jOWll+WSjOmdnuW1jOWll+WvueixoeWNoeeJh++8iVxuICAgKiBAcGFyYW0gY2FyZCDlr7nosaHljaHniYdcbiAgICogQHBhcmFtIHZhcmlhYmxlIOWPmOmHj+WvueixoVxuICAgKiBAcGFyYW0gaXNOZXN0ZWQg5piv5ZCm5Li65bWM5aWX5Y2h54mHXG4gICAqIEBwYXJhbSBzaG93VHlwZURpYWxvZ0NhbGxiYWNrIOaYvuekuuexu+Wei+mAieaLqeWvueivneahhueahOWbnuiwg+WHveaVsFxuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cE9iamVjdENhcmQoXG4gICAgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgICB2YXJpYWJsZTogVmFyaWFibGVJdGVtLFxuICAgIGlzTmVzdGVkPzogYm9vbGVhbixcbiAgICBzaG93VHlwZURpYWxvZ0NhbGxiYWNrPzogKGNhbGxiYWNrOiAoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHZvaWQpID0+IFByb21pc2U8dm9pZD4sXG4gICk6IHZvaWQge1xuICAgIGlmIChpc05lc3RlZCkge1xuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtY2FyZC1jb250ZW50JykuYXBwZW5kKGBcbiAgICAgICAgPGRpdiBjbGFzcz1cIm5lc3RlZC1vYmplY3QtY29udGFpbmVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm5lc3RlZC1jYXJkcy1jb250YWluZXJcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9ucyAub2JqZWN0LXNhdmUtYnRuJykuYmVmb3JlKGBcbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cInZhcmlhYmxlLWFjdGlvbi1idG4gYWRkLW5lc3RlZC1rZXktYnRuXCIgdGl0bGU9XCLmt7vliqDplK7lgLzlr7lcIj5cbiAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtcGx1c1wiPjwvaT5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICBgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtY2FyZC1jb250ZW50JykuYXBwZW5kKGBcbiAgICAgICAgPHRleHRhcmVhIGNsYXNzPVwianNvbi1pbnB1dCB2YXJpYWJsZS1jb250ZW50LWlucHV0XCIgcGxhY2Vob2xkZXI9XCLovpPlhaVKU09O5a+56LGhXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPjwvdGV4dGFyZWE+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwib2JqZWN0LWNhcmQtdmlld1wiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibmVzdGVkLWNhcmRzLWNvbnRhaW5lclwiPjwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9ucyAuc2F2ZS1idG4nKS5iZWZvcmUoYFxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwidmFyaWFibGUtYWN0aW9uLWJ0biB0b2dnbGUtdmlldy1idG5cIiB0aXRsZT1cIuWIh+aNouWIsEpTT07op4blm75cIj5cbiAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtbGlzdFwiPjwvaT5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDxidXR0b24gY2xhc3M9XCJ2YXJpYWJsZS1hY3Rpb24tYnRuIGFkZC1rZXktYnRuXCIgdGl0bGU9XCLmt7vliqDplK7lgLzlr7lcIj5cbiAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtcGx1c1wiPjwvaT5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICBgKTtcblxuICAgICAgY2FyZC5maW5kKCcuanNvbi1pbnB1dCcpLnZhbChKU09OLnN0cmluZ2lmeSh2YXJpYWJsZS52YWx1ZSwgbnVsbCwgMikpLmVuZCgpLmF0dHIoJ2RhdGEtdmlldy1tb2RlJywgJ2NhcmQnKTtcblxuICAgICAgY2FyZC5maW5kKCcuanNvbi1pbnB1dCcpLm9uKCdibHVyIGNoYW5nZScsICgpID0+IHtcbiAgICAgICAgY29uc3QgY3VycmVudE1vZGUgPSBjYXJkLmF0dHIoJ2RhdGEtdmlldy1tb2RlJykgfHwgJ2NhcmQnO1xuXG4gICAgICAgIGlmIChjdXJyZW50TW9kZSA9PT0gJ2NhcmQnKSB7XG4gICAgICAgICAgdGhpcy5zeW5jSnNvbklucHV0VG9DYXJkVmlldyhjYXJkLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNhcmQuZmluZCgnLnRvZ2dsZS12aWV3LWJ0bicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29uc3QgJGNhcmQgPSBjYXJkO1xuICAgICAgICBjb25zdCBjdXJyZW50TW9kZSA9ICRjYXJkLmF0dHIoJ2RhdGEtdmlldy1tb2RlJykgfHwgJ2NhcmQnO1xuXG4gICAgICAgIGNvbnN0IG5ld01vZGUgPSBjdXJyZW50TW9kZSA9PT0gJ2pzb24nID8gJ2NhcmQnIDogJ2pzb24nO1xuICAgICAgICAkY2FyZC5hdHRyKCdkYXRhLXZpZXctbW9kZScsIG5ld01vZGUpO1xuXG4gICAgICAgIGlmIChuZXdNb2RlID09PSAnanNvbicpIHtcbiAgICAgICAgICAkY2FyZFxuICAgICAgICAgICAgLmZpbmQoJy50b2dnbGUtdmlldy1idG4gaScpXG4gICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2ZhLWxpc3QnKVxuICAgICAgICAgICAgLmFkZENsYXNzKCdmYS1leWUnKVxuICAgICAgICAgICAgLmVuZCgpXG4gICAgICAgICAgICAuYXR0cigndGl0bGUnLCAn5YiH5o2i5Yiw5Y2h54mH6KeG5Zu+Jyk7XG4gICAgICAgICAgJGNhcmQuZmluZCgnLnZhcmlhYmxlLWFjdGlvbi1idG4uYWRkLWtleS1idG4nKS5oaWRlKCk7XG5cbiAgICAgICAgICAkY2FyZC5maW5kKCcuanNvbi1pbnB1dCcpLnNob3coKS5lbmQoKS5maW5kKCcub2JqZWN0LWNhcmQtdmlldycpLmhpZGUoKTtcblxuICAgICAgICAgIHRoaXMuc3luY0NhcmRWaWV3VG9Kc29uSW5wdXQoJGNhcmQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRjYXJkXG4gICAgICAgICAgICAuZmluZCgnLnRvZ2dsZS12aWV3LWJ0biBpJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnZmEtZXllJylcbiAgICAgICAgICAgIC5hZGRDbGFzcygnZmEtbGlzdCcpXG4gICAgICAgICAgICAuZW5kKClcbiAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsICfliIfmjaLliLBKU09O6KeG5Zu+Jyk7XG4gICAgICAgICAgJGNhcmQuZmluZCgnLnZhcmlhYmxlLWFjdGlvbi1idG4uYWRkLWtleS1idG4nKS5zaG93KCk7XG5cbiAgICAgICAgICAkY2FyZC5maW5kKCcuanNvbi1pbnB1dCcpLmhpZGUoKS5lbmQoKS5maW5kKCcub2JqZWN0LWNhcmQtdmlldycpLnNob3coKTtcblxuICAgICAgICAgIHRoaXMuc3luY0pzb25JbnB1dFRvQ2FyZFZpZXcoJGNhcmQsIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgdGhpcy5yZW5kZXJPYmplY3RDYXJkVmlldyhjYXJkLCB2YXJpYWJsZSwgc2hvd1R5cGVEaWFsb2dDYWxsYmFjayk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcign5riy5p+T5Yid5aeL5a+56LGh5Y2h54mH6KeG5Zu+6ZSZ6K+vOicsIGUpO1xuICAgICAgdG9hc3RyLmVycm9yKCfmuLLmn5Plr7nosaHljaHniYfop4blm77plJnor68nKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5ZCM5q2l5Y2h54mH6KeG5Zu+5YiwSlNPTui+k+WFpeahhlxuICAgKiBAcGFyYW0gY2FyZCDlr7nosaHljaHniYdcbiAgICovXG4gIHByaXZhdGUgc3luY0NhcmRWaWV3VG9Kc29uSW5wdXQoY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IHZvaWQge1xuICAgIGNvbnN0IG9iamVjdFZhbHVlID0gdGhpcy5leHRyYWN0T2JqZWN0RnJvbU5lc3RlZENhcmRzKGNhcmQpO1xuICAgIGNhcmQuZmluZCgnLmpzb24taW5wdXQnKS52YWwoSlNPTi5zdHJpbmdpZnkob2JqZWN0VmFsdWUsIG51bGwsIDIpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlkIzmraVKU09O6L6T5YWl5qGG5Yiw5Y2h54mH6KeG5Zu+XG4gICAqIEBwYXJhbSBjYXJkIOWvueixoeWNoeeJh1xuICAgKiBAcGFyYW0gc2hvd1R5cGVEaWFsb2dDYWxsYmFjayDmmL7npLrnsbvlnovpgInmi6nlr7nor53moYbnmoTlm57osIPlh73mlbBcbiAgICovXG4gIHByaXZhdGUgc3luY0pzb25JbnB1dFRvQ2FyZFZpZXcoXG4gICAgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgICBzaG93VHlwZURpYWxvZ0NhbGxiYWNrPzogKGNhbGxiYWNrOiAoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHZvaWQpID0+IFByb21pc2U8dm9pZD4sXG4gICk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBqc29uVmFsdWUgPSBjYXJkLmZpbmQoJy5qc29uLWlucHV0JykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgaWYgKGpzb25WYWx1ZSAmJiBqc29uVmFsdWUudHJpbSgpKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdFZhbHVlID0gSlNPTi5wYXJzZShqc29uVmFsdWUpO1xuICAgICAgICBjb25zdCB0ZW1wVmFyaWFibGU6IFZhcmlhYmxlSXRlbSA9IHtcbiAgICAgICAgICBpZDogY2FyZC5hdHRyKCdkYXRhLXZhcmlhYmxlLWlkJykgfHwgJycsXG4gICAgICAgICAgbmFtZTogY2FyZC5maW5kKCcudmFyaWFibGUtdGl0bGUnKS52YWwoKSBhcyBzdHJpbmcsXG4gICAgICAgICAgZGF0YVR5cGU6ICdvYmplY3QnLFxuICAgICAgICAgIHZhbHVlOiBvYmplY3RWYWx1ZSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZW5kZXJPYmplY3RDYXJkVmlldyhjYXJkLCB0ZW1wVmFyaWFibGUsIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2spO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT07op6PmnpDplJnor686JywgcGFyc2VFcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoJ0pTT07moLzlvI/plJnor6/vvIzml6Dms5XlkIzmraXliLDljaHniYfop4blm74nKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu65pWw57uE6aG577yI5omA5pyJ6aG56YO95pi+56S65Li65a2X56ym5Liy6L6T5YWl5qGG77yJXG4gICAqIEBwYXJhbSBjYXJkIOaVsOe7hOWNoeeJh1xuICAgKiBAcGFyYW0gaXRlbXMg5pWw57uE6aG5XG4gICAqL1xuICBwcml2YXRlIHBvcHVsYXRlQXJyYXlJdGVtcyhjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBpdGVtczogYW55W10pOiB2b2lkIHtcbiAgICBpZiAoIWl0ZW1zIHx8IGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBjYXJkLmZpbmQoJy5saXN0LWl0ZW1zLWNvbnRhaW5lcicpO1xuICAgIGxpc3RDb250YWluZXIuZW1wdHkoKTtcblxuICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICBjb25zdCBkaXNwbGF5VmFsdWUgPSB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgPyBKU09OLnN0cmluZ2lmeShpdGVtKSA6IFN0cmluZyhpdGVtKTtcbiAgICAgIGNvbnN0IGxpc3RJdGVtID0gJChgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJsaXN0LWl0ZW1cIj5cbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImRyYWctaGFuZGxlXCI+4piwPC9zcGFuPlxuICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz1cInZhcmlhYmxlLWNvbnRlbnQtaW5wdXRcIj4ke2Rpc3BsYXlWYWx1ZX08L3RleHRhcmVhPlxuICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJsaXN0LWl0ZW0tZGVsZXRlXCI+PGkgY2xhc3M9XCJmYS1zb2xpZCBmYS10aW1lc1wiPjwvaT48L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcbiAgICAgIGxpc3RDb250YWluZXIuYXBwZW5kKGxpc3RJdGVtKTtcbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/card.ts\n")},"./src/component/variable_manager/controller.ts":
/*!******************************************************!*\
  !*** ./src/component/variable_manager/controller.ts ***!
  \******************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableController: () => (/* binding */ VariableController)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n\nclass VariableController {\n    /**\n     * \n     */\n    model;\n    /**\n     * \n     */\n    view;\n    /**\n     * \n     */\n    syncService;\n    /**\n     * \n     */\n    cardFactory;\n    /**\n     * \n     * @param model \n     * @param view \n     * @param syncService \n     * @param cardFactory \n     */\n    constructor(model, view, syncService, cardFactory) {\n        this.model = model;\n        this.view = view;\n        this.syncService = syncService;\n        this.cardFactory = cardFactory;\n    }\n    /**\n     * \n     * @param container UI\n     */\n    async init(container) {\n        this.view.initUI();\n        this.bindEvents(container);\n        await this.syncService.initCurrentType();\n        await this.syncService.setCurrentType('global');\n        await this.loadVariables('global');\n    }\n    /**\n     * UI\n     * @param container UI\n     */\n    bindEvents(container) {\n        container.find('.tab-item').on('click', this.handleTabChange.bind(this));\n        container.on('click', '.add-list-item', this.handleAddListItem.bind(this));\n        container.on('click', '.list-item-delete', this.handleDeleteListItem.bind(this));\n        container.on('click', '.delete-btn', this.handleDeleteVariableCard.bind(this));\n        container.on('click', '.save-btn', this.handleSaveVariableCard.bind(this));\n        container.on('click', '#add-variable', this.handleAddVariable.bind(this));\n        container.on('click', '#clear-all', this.handleClearAll.bind(this));\n        container.on('click', '#filter-icon', this.handleFilterIconClick.bind(this));\n        container.on('change', '.filter-checkbox', this.handleFilterOptionChange.bind(this));\n        container.on('input', '#variable-search', this.handleVariableSearch.bind(this));\n        container.on('click', '#floor-filter-btn', this.handleFloorRangeFilter.bind(this));\n        container.on('nested-card:changed', '.variable-card', this.handleNestedCardChanged.bind(this));\n    }\n    /**\n     * \n     * @param type \n     */\n    async loadVariables(type) {\n        const variables = await this.model.loadFromTavern(type);\n        if (variables.length === 0) {\n            toastr.warning(`${type}`);\n            return;\n        }\n        if (type === 'message') {\n            this.view.container.find('#floor-filter-container').show();\n            const [minFloor, maxFloor] = this.model.getFloorRange();\n            this.view.updateFloorRangeInputs(minFloor, maxFloor);\n        }\n        else {\n            this.view.container.find('#floor-filter-container').hide();\n        }\n        this.view.refreshVariableCards(type, variables);\n        this.applyFilters();\n    }\n    /**\n     * \n     * @param event \n     */\n    async handleTabChange(event) {\n        const target = $(event.currentTarget);\n        const tabId = target.attr('id');\n        if (!tabId)\n            return;\n        const type = tabId.replace('-tab', '');\n        const currentType = this.model.getActiveVariableType();\n        if (type === currentType)\n            return;\n        this.view.setActiveTab(type);\n        await this.syncService.setCurrentType(type);\n        await this.loadVariables(type);\n    }\n    /**\n     * \n     * @param event \n     */\n    handleAddListItem(event) {\n        const button = $(event.currentTarget);\n        const listContainer = button.siblings('.list-items-container');\n        const newItem = $(`\n      <div class=\"list-item\">\n        <span class=\"drag-handle\"></span>\n        <textarea class=\"variable-content-input\" placeholder=\"\"></textarea>\n        <button class=\"list-item-delete\"><i class=\"fa-solid fa-times\"></i></button>\n      </div>\n    `);\n        listContainer.append(newItem);\n        newItem.find('textarea').focus();\n    }\n    /**\n     * \n     * @param event \n     */\n    handleDeleteListItem(event) {\n        const button = $(event.currentTarget);\n        const listItem = button.closest('.list-item');\n        listItem.css({\n            'background-color': 'rgba(255, 0, 0, 0.2)',\n            transition: 'all 0.3s ease',\n        });\n        setTimeout(() => {\n            listItem.css({\n                transform: 'scale(0.9)',\n                opacity: '0.7',\n            });\n            setTimeout(() => {\n                listItem.remove();\n            }, 200);\n        }, 50);\n    }\n    /**\n     * \n     * @param event \n     */\n    async handleDeleteVariableCard(event) {\n        const button = $(event.currentTarget);\n        const card = button.closest('.variable-card');\n        const variable_id = card.attr('data-variable-id') || '';\n        const type = this.model.getActiveVariableType();\n        if (button.hasClass('object-delete-btn')) {\n            return;\n        }\n        this.view.showConfirmDialog(``, async (confirmed) => {\n            if (confirmed) {\n                try {\n                    const isRemoved = this.model.removeFromMap(variable_id);\n                    if (isRemoved) {\n                        await this.model.saveAllVariables(type);\n                        this.view.removeVariableCard(variable_id);\n                    }\n                }\n                catch (error) {\n                    console.error(`[VariableManager] :`, error);\n                }\n            }\n        });\n    }\n    /**\n     * \n     */\n    async handleAddVariable() {\n        const type = this.model.getActiveVariableType();\n        this.view.showAddVariableDialog((dataType, floorId) => {\n            this.view.addNewVariableCard(type, dataType, floorId);\n            this.applyFilters();\n        });\n    }\n    /**\n     * \n     * @param event \n     */\n    async handleSaveVariableCard(event) {\n        const button = $(event.currentTarget);\n        const card = button.closest('.variable-card');\n        const type = this.model.getActiveVariableType();\n        const dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(this.cardFactory.getVariableFromCard(card));\n        if (dataType == 'object') {\n            this.syncObjectCardData(card);\n        }\n        let message_id = undefined;\n        if (type === 'message') {\n            const floorIdStr = card.attr('data-floor-id');\n            if (floorIdStr) {\n                message_id = parseInt(floorIdStr);\n            }\n        }\n        let newVariable = {\n            name: this.view.getVariableCardName(card),\n            value: this.cardFactory.getVariableFromCard(card)?.value,\n            dataType: dataType,\n            id: card.attr('data-variable-id') || '',\n            ...(message_id !== undefined && { message_id }),\n        };\n        if (newVariable.name == undefined || newVariable.name.trim() === '') {\n            toastr.error('');\n            return;\n        }\n        const sameNameVariables = this.model.getVariablesByName(newVariable.name);\n        const otherSameNameVariables = sameNameVariables.filter(v => v.id !== newVariable.id);\n        if (otherSameNameVariables.length > 0) {\n            toastr.error('');\n            return;\n        }\n        try {\n            if (newVariable.id && this.model.getVariableById(newVariable.id)) {\n                this.model.updateInMap(newVariable.id, newVariable.name, newVariable.value, message_id);\n            }\n            else {\n                const addedVariable = this.model.addToMap(newVariable.name, newVariable.value, message_id);\n                newVariable.id = addedVariable.id;\n                card.attr('data-variable-id', newVariable.id);\n            }\n            if (type === 'message' && message_id !== undefined) {\n                await this.model.saveAllVariables(type, message_id);\n            }\n            else {\n                await this.model.saveAllVariables(type);\n            }\n            this.view.addAnimation(card, 'variable-changed', () => { });\n        }\n        catch (error) {\n            console.error(`[VariableManager] :`, error);\n            toastr.error(`: ${error instanceof Error ? error.message : ''}`);\n        }\n    }\n    /**\n     * \n     */\n    async handleClearAll() {\n        const type = this.model.getActiveVariableType();\n        this.view.showConfirmDialog(`${this.getVariableTypeName(type)}`, async (confirmed) => {\n            if (confirmed) {\n                try {\n                    await this.model.clearAllVariables(type);\n                    const container = this.view.container.find(`#${type}-content .variable-list`);\n                    container.empty();\n                    if (type == 'message') {\n                        const floorContainer = this.view.container.find(`#${type}-content .floor-variables-container`);\n                        floorContainer.empty();\n                    }\n                    toastr.success(`${this.getVariableTypeName(type)}`);\n                }\n                catch (error) {\n                    console.error(`[VariableManager] ${type}:`, error);\n                    toastr.error(`${this.getVariableTypeName(type)}: ${error.message || ''}`);\n                }\n            }\n        });\n    }\n    /**\n     * \n     */\n    handleFilterIconClick() {\n        const $filterOptions = this.view.container.find('.filter-options');\n        $filterOptions.toggle();\n    }\n    /**\n     * \n     * @param event \n     */\n    handleFilterOptionChange(event) {\n        const $checkbox = $(event.currentTarget);\n        const type = $checkbox.data('type');\n        const isChecked = $checkbox.is(':checked');\n        this.model.updateFilterState(type, isChecked);\n        this.applyFilters();\n    }\n    /**\n     * \n     * @param event \n     */\n    handleVariableSearch(event) {\n        const keyword = $(event.currentTarget).val();\n        this.model.updateSearchKeyword(keyword);\n        this.applyFilters();\n    }\n    /**\n     * \n     */\n    applyFilters() {\n        const filterState = this.model.getFilterState();\n        const searchKeyword = this.model.getSearchKeyword();\n        this.view.applyClientSideFilters(filterState, searchKeyword);\n    }\n    /**\n     * \n     */\n    handleFloorRangeFilter() {\n        const $minInput = this.view.container.find('#floor-min');\n        const $maxInput = this.view.container.find('#floor-max');\n        const minVal = $minInput.val();\n        const maxVal = $maxInput.val();\n        const min = minVal.trim() ? parseInt(minVal, 10) : null;\n        const max = maxVal.trim() ? parseInt(maxVal, 10) : null;\n        if ((minVal.trim() && isNaN(min)) || (maxVal.trim() && isNaN(max))) {\n            this.view.showFloorFilterError('');\n            return;\n        }\n        if (min !== null && min < 0) {\n            this.view.showFloorFilterError('0');\n            return;\n        }\n        if (max !== null && max < 0) {\n            this.view.showFloorFilterError('0');\n            return;\n        }\n        if (min !== null && max !== null && min > max) {\n            this.view.showFloorFilterError('');\n            return;\n        }\n        if (min === null && max === null) {\n            this.view.showFloorFilterError('');\n            return;\n        }\n        this.view.hideFloorFilterError();\n        const effectiveMin = min ?? 0;\n        const effectiveMax = max ?? 9999;\n        this.applyFloorRangeAndReload(effectiveMin, effectiveMax);\n    }\n    /**\n     * \n     * @param min \n     * @param max \n     */\n    async applyFloorRangeAndReload(min, max) {\n        try {\n            this.model.updateFloorRange(min, max);\n            this.view.updateFloorRangeInputs(min, max);\n            await this.loadVariables('message');\n        }\n        catch (error) {\n            console.error(`[VariableManager] :`, error);\n        }\n    }\n    /**\n     * \n     */\n    cleanup() {\n        try {\n            this.syncService.cleanup();\n        }\n        catch (error) {\n            console.error(`[VariableManager] :`, error);\n        }\n    }\n    /**\n     * \n     * @param card \n     */\n    syncObjectCardData(card) {\n        const currentMode = card.attr('data-view-mode') || 'card';\n        if (currentMode === 'card') {\n            const objectValue = this.cardFactory.getVariableFromCard(card);\n            card.find('.json-input').val(JSON.stringify(objectValue?.value, null, 2));\n        }\n    }\n    /**\n     * \n     * @param event \n     */\n    async handleNestedCardChanged(event) {\n        const card = $(event.currentTarget);\n        const saveBtn = card.find('.variable-action-btn.save-btn');\n        if (saveBtn.length > 0) {\n            saveBtn.trigger('click');\n        }\n    }\n    /**\n     * \n     * @param type \n     * @returns \n     */\n    getVariableTypeName(type) {\n        switch (type) {\n            case 'global':\n                return '';\n            case 'character':\n                return '';\n            case 'chat':\n                return '';\n            case 'message':\n                return '';\n            default:\n                return type;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvY29udHJvbGxlci50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUl3RTtBQUdqRSxNQUFNLGtCQUFrQjtJQUM3Qjs7T0FFRztJQUNLLEtBQUssQ0FBZ0I7SUFFN0I7O09BRUc7SUFDSyxJQUFJLENBQWU7SUFFM0I7O09BRUc7SUFDSyxXQUFXLENBQXNCO0lBRXpDOztPQUVHO0lBQ0ssV0FBVyxDQUFzQjtJQUV6Qzs7Ozs7O09BTUc7SUFDSCxZQUNFLEtBQW9CLEVBQ3BCLElBQWtCLEVBQ2xCLFdBQWdDLEVBQ2hDLFdBQWdDO1FBRWhDLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ25CLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO1FBQy9CLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO0lBQ2pDLENBQUM7SUFFRDs7O09BR0c7SUFDSSxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQThCO1FBQzlDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDbkIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMzQixNQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDekMsTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNoRCxNQUFNLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVEOzs7T0FHRztJQUNLLFVBQVUsQ0FBQyxTQUE4QjtRQUMvQyxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN6RSxTQUFTLENBQUMsRUFBRSxDQUFDLE9B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M0QsSUFBSSxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQ3ZCLE9BQU8sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDM0IsQ0FBQztJQUNILENBQUM7SUFFRDs7OztPQUlHO0lBQ0ssbUJBQW1CLENBQUMsSUFBa0I7UUFDNUMsUUFBUSxJQUFJLEVBQUUsQ0FBQztZQUNiLEtBQUssUUFBUTtnQkFDWCxPQUFPLElBQUksQ0FBQztZQUNkLEtBQUssV0FBVztnQkFDZCxPQUFPLElBQUksQ0FBQztZQUNkLEtBQUssTUFBTTtnQkFDVCxPQUFPLElBQUksQ0FBQztZQUNkLEtBQUssU0FBUztnQkFDWixPQUFPLElBQUksQ0FBQztZQUNkO2dCQUNFLE9BQU8sSUFBSSxDQUFDO1FBQ2hCLENBQUM7SUFDSCxDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvY29udHJvbGxlci50cz9mZjE4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZhcmlhYmxlQ2FyZEZhY3RvcnkgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL2NhcmQnO1xuaW1wb3J0IHsgVmFyaWFibGVNb2RlbCB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvbW9kZWwnO1xuaW1wb3J0IHsgVmFyaWFibGVTeW5jU2VydmljZSB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvc3luYyc7XG5pbXBvcnQgeyBWYXJpYWJsZURhdGFUeXBlLCBWYXJpYWJsZUl0ZW0sIFZhcmlhYmxlVHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdHlwZXMnO1xuaW1wb3J0IHsgVmFyaWFibGVNYW5hZ2VyVXRpbCB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbCc7XG5pbXBvcnQgeyBWYXJpYWJsZVZpZXcgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3ZpZXcnO1xuXG5leHBvcnQgY2xhc3MgVmFyaWFibGVDb250cm9sbGVyIHtcbiAgLyoqXG4gICAqIOWPmOmHj+aVsOaNruaooeWei1xuICAgKi9cbiAgcHJpdmF0ZSBtb2RlbDogVmFyaWFibGVNb2RlbDtcblxuICAvKipcbiAgICog5Y+Y6YeP6KeG5Zu+XG4gICAqL1xuICBwcml2YXRlIHZpZXc6IFZhcmlhYmxlVmlldztcblxuICAvKipcbiAgICog5Y+Y6YeP5ZCM5q2l5pyN5YqhXG4gICAqL1xuICBwcml2YXRlIHN5bmNTZXJ2aWNlOiBWYXJpYWJsZVN5bmNTZXJ2aWNlO1xuXG4gIC8qKlxuICAgKiDlj5jph4/ljaHniYflt6XljoJcbiAgICovXG4gIHByaXZhdGUgY2FyZEZhY3Rvcnk6IFZhcmlhYmxlQ2FyZEZhY3Rvcnk7XG5cbiAgLyoqXG4gICAqIOaehOmAoOWHveaVsFxuICAgKiBAcGFyYW0gbW9kZWwg5pWw5o2u5qih5Z6LXG4gICAqIEBwYXJhbSB2aWV3IOinhuWbvlxuICAgKiBAcGFyYW0gc3luY1NlcnZpY2Ug5ZCM5q2l5pyN5YqhXG4gICAqIEBwYXJhbSBjYXJkRmFjdG9yeSDljaHniYflt6XljoJcbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIG1vZGVsOiBWYXJpYWJsZU1vZGVsLFxuICAgIHZpZXc6IFZhcmlhYmxlVmlldyxcbiAgICBzeW5jU2VydmljZTogVmFyaWFibGVTeW5jU2VydmljZSxcbiAgICBjYXJkRmFjdG9yeTogVmFyaWFibGVDYXJkRmFjdG9yeSxcbiAgKSB7XG4gICAgdGhpcy5tb2RlbCA9IG1vZGVsO1xuICAgIHRoaXMudmlldyA9IHZpZXc7XG4gICAgdGhpcy5zeW5jU2VydmljZSA9IHN5bmNTZXJ2aWNlO1xuICAgIHRoaXMuY2FyZEZhY3RvcnkgPSBjYXJkRmFjdG9yeTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJbmjqfliLblmahcbiAgICogQHBhcmFtIGNvbnRhaW5lciBVSeWuueWZqFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGluaXQoY29udGFpbmVyOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy52aWV3LmluaXRVSSgpO1xuICAgIHRoaXMuYmluZEV2ZW50cyhjb250YWluZXIpO1xuICAgIGF3YWl0IHRoaXMuc3luY1NlcnZpY2UuaW5pdEN1cnJlbnRUeXBlKCk7XG4gICAgYXdhaXQgdGhpcy5zeW5jU2VydmljZS5zZXRDdXJyZW50VHlwZSgnZ2xvYmFsJyk7XG4gICAgYXdhaXQgdGhpcy5sb2FkVmFyaWFibGVzKCdnbG9iYWwnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnu5HlrppVSeS6i+S7tlxuICAgKiBAcGFyYW0gY29udGFpbmVyIFVJ5a655ZmoXG4gICAqL1xuICBwcml2YXRlIGJpbmRFdmVudHMoY29udGFpbmVyOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogdm9pZCB7XG4gICAgY29udGFpbmVyLmZpbmQoJy50YWItaXRlbScpLm9uKCdjbGljaycsIHRoaXMuaGFuZGxlVGFiQ2hhbmdlLmJpbmQodGhpcykpO1xuICAgIGNvbnRhaW5lci5vbignY2xpY2snLCAnLmFkZC1saXN0LWl0ZW0nLCB0aGlzLmhhbmRsZUFkZExpc3RJdGVtLmJpbmQodGhpcykpO1xuICAgIGNvbnRhaW5lci5vbignY2xpY2snLCAnLmxpc3QtaXRlbS1kZWxldGUnLCB0aGlzLmhhbmRsZURlbGV0ZUxpc3RJdGVtLmJpbmQodGhpcykpO1xuICAgIGNvbnRhaW5lci5vbignY2xpY2snLCAnLmRlbGV0ZS1idG4nLCB0aGlzLmhhbmRsZURlbGV0ZVZhcmlhYmxlQ2FyZC5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJy5zYXZlLWJ0bicsIHRoaXMuaGFuZGxlU2F2ZVZhcmlhYmxlQ2FyZC5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJyNhZGQtdmFyaWFibGUnLCB0aGlzLmhhbmRsZUFkZFZhcmlhYmxlLmJpbmQodGhpcykpO1xuICAgIGNvbnRhaW5lci5vbignY2xpY2snLCAnI2NsZWFyLWFsbCcsIHRoaXMuaGFuZGxlQ2xlYXJBbGwuYmluZCh0aGlzKSk7XG4gICAgY29udGFpbmVyLm9uKCdjbGljaycsICcjZmlsdGVyLWljb24nLCB0aGlzLmhhbmRsZUZpbHRlckljb25DbGljay5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NoYW5nZScsICcuZmlsdGVyLWNoZWNrYm94JywgdGhpcy5oYW5kbGVGaWx0ZXJPcHRpb25DaGFuZ2UuYmluZCh0aGlzKSk7XG4gICAgY29udGFpbmVyLm9uKCdpbnB1dCcsICcjdmFyaWFibGUtc2VhcmNoJywgdGhpcy5oYW5kbGVWYXJpYWJsZVNlYXJjaC5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJyNmbG9vci1maWx0ZXItYnRuJywgdGhpcy5oYW5kbGVGbG9vclJhbmdlRmlsdGVyLmJpbmQodGhpcykpO1xuICAgIGNvbnRhaW5lci5vbignbmVzdGVkLWNhcmQ6Y2hhbmdlZCcsICcudmFyaWFibGUtY2FyZCcsIHRoaXMuaGFuZGxlTmVzdGVkQ2FyZENoYW5nZWQuYmluZCh0aGlzKSk7XG4gIH1cblxuICAvKipcbiAgICog5Yqg6L295Y+Y6YePXG4gICAqIEBwYXJhbSB0eXBlIOWPmOmHj+exu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGxvYWRWYXJpYWJsZXModHlwZTogVmFyaWFibGVUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgdmFyaWFibGVzID0gYXdhaXQgdGhpcy5tb2RlbC5sb2FkRnJvbVRhdmVybih0eXBlKTtcblxuICAgIGlmICh2YXJpYWJsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0b2FzdHIud2FybmluZyhgJHt0eXBlfeWPmOmHj+S4uuepumApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScpIHtcbiAgICAgIHRoaXMudmlldy5jb250YWluZXIuZmluZCgnI2Zsb29yLWZpbHRlci1jb250YWluZXInKS5zaG93KCk7XG4gICAgICBjb25zdCBbbWluRmxvb3IsIG1heEZsb29yXSA9IHRoaXMubW9kZWwuZ2V0Rmxvb3JSYW5nZSgpO1xuICAgICAgdGhpcy52aWV3LnVwZGF0ZUZsb29yUmFuZ2VJbnB1dHMobWluRmxvb3IsIG1heEZsb29yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy52aWV3LmNvbnRhaW5lci5maW5kKCcjZmxvb3ItZmlsdGVyLWNvbnRhaW5lcicpLmhpZGUoKTtcbiAgICB9XG5cbiAgICB0aGlzLnZpZXcucmVmcmVzaFZhcmlhYmxlQ2FyZHModHlwZSwgdmFyaWFibGVzKTtcblxuICAgIHRoaXMuYXBwbHlGaWx0ZXJzKCk7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5qCH562+6aG15YiH5o2iXG4gICAqIEBwYXJhbSBldmVudCDngrnlh7vkuovku7ZcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlVGFiQ2hhbmdlKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHRhcmdldCA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgY29uc3QgdGFiSWQgPSB0YXJnZXQuYXR0cignaWQnKTtcblxuICAgIGlmICghdGFiSWQpIHJldHVybjtcblxuICAgIGNvbnN0IHR5cGUgPSB0YWJJZC5yZXBsYWNlKCctdGFiJywgJycpIGFzIFZhcmlhYmxlVHlwZTtcbiAgICBjb25zdCBjdXJyZW50VHlwZSA9IHRoaXMubW9kZWwuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG5cbiAgICBpZiAodHlwZSA9PT0gY3VycmVudFR5cGUpIHJldHVybjtcblxuICAgIHRoaXMudmlldy5zZXRBY3RpdmVUYWIodHlwZSk7XG5cbiAgICBhd2FpdCB0aGlzLnN5bmNTZXJ2aWNlLnNldEN1cnJlbnRUeXBlKHR5cGUpO1xuICAgIGF3YWl0IHRoaXMubG9hZFZhcmlhYmxlcyh0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmt7vliqDliJfooajpoblcbiAgICogQHBhcmFtIGV2ZW50IOeCueWHu+S6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVBZGRMaXN0SXRlbShldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBidXR0b24gPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBidXR0b24uc2libGluZ3MoJy5saXN0LWl0ZW1zLWNvbnRhaW5lcicpO1xuXG4gICAgY29uc3QgbmV3SXRlbSA9ICQoYFxuICAgICAgPGRpdiBjbGFzcz1cImxpc3QtaXRlbVwiPlxuICAgICAgICA8c3BhbiBjbGFzcz1cImRyYWctaGFuZGxlXCI+4piwPC9zcGFuPlxuICAgICAgICA8dGV4dGFyZWEgY2xhc3M9XCJ2YXJpYWJsZS1jb250ZW50LWlucHV0XCIgcGxhY2Vob2xkZXI9XCLovpPlhaXlj5jph4/lhoXlrrlcIj48L3RleHRhcmVhPlxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwibGlzdC1pdGVtLWRlbGV0ZVwiPjxpIGNsYXNzPVwiZmEtc29saWQgZmEtdGltZXNcIj48L2k+PC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcblxuICAgIGxpc3RDb250YWluZXIuYXBwZW5kKG5ld0l0ZW0pO1xuICAgIG5ld0l0ZW0uZmluZCgndGV4dGFyZWEnKS5mb2N1cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuWIoOmZpOWIl+ihqOmhuVxuICAgKiBAcGFyYW0gZXZlbnQg54K55Ye75LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIGhhbmRsZURlbGV0ZUxpc3RJdGVtKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGJ1dHRvbiA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgY29uc3QgbGlzdEl0ZW0gPSBidXR0b24uY2xvc2VzdCgnLmxpc3QtaXRlbScpO1xuXG4gICAgbGlzdEl0ZW0uY3NzKHtcbiAgICAgICdiYWNrZ3JvdW5kLWNvbG9yJzogJ3JnYmEoMjU1LCAwLCAwLCAwLjIpJyxcbiAgICAgIHRyYW5zaXRpb246ICdhbGwgMC4zcyBlYXNlJyxcbiAgICB9KTtcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgbGlzdEl0ZW0uY3NzKHtcbiAgICAgICAgdHJhbnNmb3JtOiAnc2NhbGUoMC45KScsXG4gICAgICAgIG9wYWNpdHk6ICcwLjcnLFxuICAgICAgfSk7XG5cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBsaXN0SXRlbS5yZW1vdmUoKTtcbiAgICAgIH0sIDIwMCk7XG4gICAgfSwgNTApO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuWIoOmZpOWPmOmHj+WNoeeJh1xuICAgKiBAcGFyYW0gZXZlbnQg54K55Ye75LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZURlbGV0ZVZhcmlhYmxlQ2FyZChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBidXR0b24gPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IGNhcmQgPSBidXR0b24uY2xvc2VzdCgnLnZhcmlhYmxlLWNhcmQnKTtcbiAgICBjb25zdCB2YXJpYWJsZV9pZCA9IGNhcmQuYXR0cignZGF0YS12YXJpYWJsZS1pZCcpIHx8ICcnO1xuXG4gICAgY29uc3QgdHlwZSA9IHRoaXMubW9kZWwuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG5cbiAgICBpZiAoYnV0dG9uLmhhc0NsYXNzKCdvYmplY3QtZGVsZXRlLWJ0bicpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy52aWV3LnNob3dDb25maXJtRGlhbG9nKGDnoa7lrpropoHliKDpmaTlj5jph4/lkJfvvJ/mraTmk43kvZzml6Dms5XmkqTplIDjgIJgLCBhc3luYyBjb25maXJtZWQgPT4ge1xuICAgICAgaWYgKGNvbmZpcm1lZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGlzUmVtb3ZlZCA9IHRoaXMubW9kZWwucmVtb3ZlRnJvbU1hcCh2YXJpYWJsZV9pZCk7XG4gICAgICAgICAgaWYgKGlzUmVtb3ZlZCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5tb2RlbC5zYXZlQWxsVmFyaWFibGVzKHR5cGUpO1xuICAgICAgICAgICAgdGhpcy52aWV3LnJlbW92ZVZhcmlhYmxlQ2FyZCh2YXJpYWJsZV9pZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOWIoOmZpOWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmt7vliqDlj5jph49cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlQWRkVmFyaWFibGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgdHlwZSA9IHRoaXMubW9kZWwuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG4gICAgdGhpcy52aWV3LnNob3dBZGRWYXJpYWJsZURpYWxvZygoZGF0YVR5cGUsIGZsb29ySWQpID0+IHtcbiAgICAgIHRoaXMudmlldy5hZGROZXdWYXJpYWJsZUNhcmQodHlwZSwgZGF0YVR5cGUsIGZsb29ySWQpO1xuICAgICAgdGhpcy5hcHBseUZpbHRlcnMoKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbkv53lrZjlj5jph4/ljaHniYdcbiAgICogQHBhcmFtIGV2ZW50IOeCueWHu+S6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVTYXZlVmFyaWFibGVDYXJkKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGJ1dHRvbiA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgY29uc3QgY2FyZCA9IGJ1dHRvbi5jbG9zZXN0KCcudmFyaWFibGUtY2FyZCcpO1xuICAgIGNvbnN0IHR5cGUgPSB0aGlzLm1vZGVsLmdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpO1xuICAgIGNvbnN0IGRhdGFUeXBlID0gVmFyaWFibGVNYW5hZ2VyVXRpbC5pbmZlckRhdGFUeXBlKHRoaXMuY2FyZEZhY3RvcnkuZ2V0VmFyaWFibGVGcm9tQ2FyZChjYXJkKSk7XG5cbiAgICBpZiAoZGF0YVR5cGUgPT0gJ29iamVjdCcpIHtcbiAgICAgIHRoaXMuc3luY09iamVjdENhcmREYXRhKGNhcmQpO1xuICAgIH1cblxuICAgIGxldCBtZXNzYWdlX2lkOiBudW1iZXIgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgaWYgKHR5cGUgPT09ICdtZXNzYWdlJykge1xuICAgICAgY29uc3QgZmxvb3JJZFN0ciA9IGNhcmQuYXR0cignZGF0YS1mbG9vci1pZCcpO1xuICAgICAgaWYgKGZsb29ySWRTdHIpIHtcbiAgICAgICAgbWVzc2FnZV9pZCA9IHBhcnNlSW50KGZsb29ySWRTdHIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBuZXdWYXJpYWJsZTogVmFyaWFibGVJdGVtID0ge1xuICAgICAgbmFtZTogdGhpcy52aWV3LmdldFZhcmlhYmxlQ2FyZE5hbWUoY2FyZCksXG4gICAgICB2YWx1ZTogdGhpcy5jYXJkRmFjdG9yeS5nZXRWYXJpYWJsZUZyb21DYXJkKGNhcmQpPy52YWx1ZSxcbiAgICAgIGRhdGFUeXBlOiBkYXRhVHlwZSxcbiAgICAgIGlkOiBjYXJkLmF0dHIoJ2RhdGEtdmFyaWFibGUtaWQnKSB8fCAnJyxcbiAgICAgIC4uLihtZXNzYWdlX2lkICE9PSB1bmRlZmluZWQgJiYgeyBtZXNzYWdlX2lkIH0pLFxuICAgIH07XG5cbiAgICBpZiAobmV3VmFyaWFibGUubmFtZSA9PSB1bmRlZmluZWQgfHwgbmV3VmFyaWFibGUubmFtZS50cmltKCkgPT09ICcnKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoJ+WPmOmHj+WQjeS4jeiDveS4uuepuicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHNhbWVOYW1lVmFyaWFibGVzID0gdGhpcy5tb2RlbC5nZXRWYXJpYWJsZXNCeU5hbWUobmV3VmFyaWFibGUubmFtZSk7XG4gICAgY29uc3Qgb3RoZXJTYW1lTmFtZVZhcmlhYmxlcyA9IHNhbWVOYW1lVmFyaWFibGVzLmZpbHRlcih2ID0+IHYuaWQgIT09IG5ld1ZhcmlhYmxlLmlkKTtcbiAgICBpZiAob3RoZXJTYW1lTmFtZVZhcmlhYmxlcy5sZW5ndGggPiAwKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoJ+WPmOmHj+WQjemHjeWkjScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBpZiAobmV3VmFyaWFibGUuaWQgJiYgdGhpcy5tb2RlbC5nZXRWYXJpYWJsZUJ5SWQobmV3VmFyaWFibGUuaWQpKSB7XG4gICAgICAgIHRoaXMubW9kZWwudXBkYXRlSW5NYXAobmV3VmFyaWFibGUuaWQsIG5ld1ZhcmlhYmxlLm5hbWUsIG5ld1ZhcmlhYmxlLnZhbHVlLCBtZXNzYWdlX2lkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGFkZGVkVmFyaWFibGUgPSB0aGlzLm1vZGVsLmFkZFRvTWFwKG5ld1ZhcmlhYmxlLm5hbWUsIG5ld1ZhcmlhYmxlLnZhbHVlLCBtZXNzYWdlX2lkKTtcbiAgICAgICAgbmV3VmFyaWFibGUuaWQgPSBhZGRlZFZhcmlhYmxlLmlkO1xuICAgICAgICBjYXJkLmF0dHIoJ2RhdGEtdmFyaWFibGUtaWQnLCBuZXdWYXJpYWJsZS5pZCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScgJiYgbWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubW9kZWwuc2F2ZUFsbFZhcmlhYmxlcyh0eXBlLCBtZXNzYWdlX2lkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHRoaXMubW9kZWwuc2F2ZUFsbFZhcmlhYmxlcyh0eXBlKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy52aWV3LmFkZEFuaW1hdGlvbihjYXJkLCAndmFyaWFibGUtY2hhbmdlZCcsICgpID0+IHt9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl0g5L+d5a2Y5Y+Y6YeP5aSx6LSlOmAsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5L+d5a2Y5Y+Y6YeP5aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ+acquefpemUmeivryd9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhua4hemZpOaJgOacieWPmOmHj1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVDbGVhckFsbCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB0eXBlID0gdGhpcy5tb2RlbC5nZXRBY3RpdmVWYXJpYWJsZVR5cGUoKTtcblxuICAgIHRoaXMudmlldy5zaG93Q29uZmlybURpYWxvZyhcbiAgICAgIGDnoa7lrpropoHmuIXpmaTmiYDmnIkke3RoaXMuZ2V0VmFyaWFibGVUeXBlTmFtZSh0eXBlKX3lj5jph4/lkJfvvJ/mraTmk43kvZzkuI3lj6/mkqTplIDjgIJgLFxuICAgICAgYXN5bmMgY29uZmlybWVkID0+IHtcbiAgICAgICAgaWYgKGNvbmZpcm1lZCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLm1vZGVsLmNsZWFyQWxsVmFyaWFibGVzKHR5cGUpO1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy52aWV3LmNvbnRhaW5lci5maW5kKGAjJHt0eXBlfS1jb250ZW50IC52YXJpYWJsZS1saXN0YCk7XG4gICAgICAgICAgICBjb250YWluZXIuZW1wdHkoKTtcbiAgICAgICAgICAgIGlmICh0eXBlID09ICdtZXNzYWdlJykge1xuICAgICAgICAgICAgICBjb25zdCBmbG9vckNvbnRhaW5lciA9IHRoaXMudmlldy5jb250YWluZXIuZmluZChgIyR7dHlwZX0tY29udGVudCAuZmxvb3ItdmFyaWFibGVzLWNvbnRhaW5lcmApO1xuICAgICAgICAgICAgICBmbG9vckNvbnRhaW5lci5lbXB0eSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoYOW3sua4hemZpOaJgOaciSR7dGhpcy5nZXRWYXJpYWJsZVR5cGVOYW1lKHR5cGUpfeWPmOmHj2ApO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOa4hemZpCR7dHlwZX3lj5jph4/lpLHotKU6YCwgZXJyb3IpO1xuICAgICAgICAgICAgdG9hc3RyLmVycm9yKGDmuIXpmaQke3RoaXMuZ2V0VmFyaWFibGVUeXBlTmFtZSh0eXBlKX3lj5jph4/ml7blh7rplJk6ICR7ZXJyb3IubWVzc2FnZSB8fCAn5pyq55+l6ZSZ6K+vJ31gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbnrZvpgInlm77moIfngrnlh7tcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlRmlsdGVySWNvbkNsaWNrKCk6IHZvaWQge1xuICAgIGNvbnN0ICRmaWx0ZXJPcHRpb25zID0gdGhpcy52aWV3LmNvbnRhaW5lci5maW5kKCcuZmlsdGVyLW9wdGlvbnMnKTtcbiAgICAkZmlsdGVyT3B0aW9ucy50b2dnbGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbnrZvpgInpgInpobnlj5jmm7RcbiAgICogQHBhcmFtIGV2ZW50IOWPmOabtOS6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVGaWx0ZXJPcHRpb25DaGFuZ2UoZXZlbnQ6IEpRdWVyeS5DaGFuZ2VFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0ICRjaGVja2JveCA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgY29uc3QgdHlwZSA9ICRjaGVja2JveC5kYXRhKCd0eXBlJykgYXMgVmFyaWFibGVEYXRhVHlwZTtcbiAgICBjb25zdCBpc0NoZWNrZWQgPSAkY2hlY2tib3guaXMoJzpjaGVja2VkJyk7XG5cbiAgICB0aGlzLm1vZGVsLnVwZGF0ZUZpbHRlclN0YXRlKHR5cGUsIGlzQ2hlY2tlZCk7XG4gICAgdGhpcy5hcHBseUZpbHRlcnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIblj5jph4/mkJzntKJcbiAgICogQHBhcmFtIGV2ZW50IOi+k+WFpeS6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVWYXJpYWJsZVNlYXJjaChldmVudDogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50KTogdm9pZCB7XG4gICAgY29uc3Qga2V5d29yZCA9ICQoZXZlbnQuY3VycmVudFRhcmdldCkudmFsKCkgYXMgc3RyaW5nO1xuICAgIHRoaXMubW9kZWwudXBkYXRlU2VhcmNoS2V5d29yZChrZXl3b3JkKTtcbiAgICB0aGlzLmFwcGx5RmlsdGVycygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOW6lOeUqOetm+mAiVxuICAgKi9cbiAgcHJpdmF0ZSBhcHBseUZpbHRlcnMoKTogdm9pZCB7XG4gICAgY29uc3QgZmlsdGVyU3RhdGUgPSB0aGlzLm1vZGVsLmdldEZpbHRlclN0YXRlKCk7XG4gICAgY29uc3Qgc2VhcmNoS2V5d29yZCA9IHRoaXMubW9kZWwuZ2V0U2VhcmNoS2V5d29yZCgpO1xuXG4gICAgdGhpcy52aWV3LmFwcGx5Q2xpZW50U2lkZUZpbHRlcnMoZmlsdGVyU3RhdGUsIHNlYXJjaEtleXdvcmQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhualvOWxguiMg+WbtOetm+mAiVxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVGbG9vclJhbmdlRmlsdGVyKCk6IHZvaWQge1xuICAgIGNvbnN0ICRtaW5JbnB1dCA9IHRoaXMudmlldy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1pbicpO1xuICAgIGNvbnN0ICRtYXhJbnB1dCA9IHRoaXMudmlldy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1heCcpO1xuXG4gICAgY29uc3QgbWluVmFsID0gJG1pbklucHV0LnZhbCgpIGFzIHN0cmluZztcbiAgICBjb25zdCBtYXhWYWwgPSAkbWF4SW5wdXQudmFsKCkgYXMgc3RyaW5nO1xuXG4gICAgY29uc3QgbWluID0gbWluVmFsLnRyaW0oKSA/IHBhcnNlSW50KG1pblZhbCwgMTApIDogbnVsbDtcbiAgICBjb25zdCBtYXggPSBtYXhWYWwudHJpbSgpID8gcGFyc2VJbnQobWF4VmFsLCAxMCkgOiBudWxsO1xuXG4gICAgaWYgKChtaW5WYWwudHJpbSgpICYmIGlzTmFOKG1pbiEpKSB8fCAobWF4VmFsLnRyaW0oKSAmJiBpc05hTihtYXghKSkpIHtcbiAgICAgIHRoaXMudmlldy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign6K+36L6T5YWl5pyJ5pWI55qE5pWw5a2XJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKG1pbiAhPT0gbnVsbCAmJiBtaW4gPCAwKSB7XG4gICAgICB0aGlzLnZpZXcuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+acgOWwj+alvOWxguS4jeiDveWwj+S6jjAnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAobWF4ICE9PSBudWxsICYmIG1heCA8IDApIHtcbiAgICAgIHRoaXMudmlldy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign5pyA5aSn5qW85bGC5LiN6IO95bCP5LqOMCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChtaW4gIT09IG51bGwgJiYgbWF4ICE9PSBudWxsICYmIG1pbiA+IG1heCkge1xuICAgICAgdGhpcy52aWV3LnNob3dGbG9vckZpbHRlckVycm9yKCfmnIDlsI/lgLzkuI3og73lpKfkuo7mnIDlpKflgLwnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAobWluID09PSBudWxsICYmIG1heCA9PT0gbnVsbCkge1xuICAgICAgdGhpcy52aWV3LnNob3dGbG9vckZpbHRlckVycm9yKCfor7foh7PlsJHorr7nva7mnIDlsI/mpbzlsYLmiJbmnIDlpKfmpbzlsYInKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnZpZXcuaGlkZUZsb29yRmlsdGVyRXJyb3IoKTtcblxuICAgIGNvbnN0IGVmZmVjdGl2ZU1pbiA9IG1pbiA/PyAwO1xuICAgIGNvbnN0IGVmZmVjdGl2ZU1heCA9IG1heCA/PyA5OTk5O1xuXG4gICAgdGhpcy5hcHBseUZsb29yUmFuZ2VBbmRSZWxvYWQoZWZmZWN0aXZlTWluLCBlZmZlY3RpdmVNYXgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOW6lOeUqOalvOWxguiMg+WbtOW5tumHjeaWsOWKoOi9veWPmOmHj1xuICAgKiBAcGFyYW0gbWluIOacgOWwj+alvOWxglxuICAgKiBAcGFyYW0gbWF4IOacgOWkp+alvOWxglxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhcHBseUZsb29yUmFuZ2VBbmRSZWxvYWQobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMubW9kZWwudXBkYXRlRmxvb3JSYW5nZShtaW4sIG1heCk7XG4gICAgICB0aGlzLnZpZXcudXBkYXRlRmxvb3JSYW5nZUlucHV0cyhtaW4sIG1heCk7XG4gICAgICBhd2FpdCB0aGlzLmxvYWRWYXJpYWJsZXMoJ21lc3NhZ2UnKTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBbVmFyaWFibGVNYW5hZ2VyXSDlupTnlKjmpbzlsYLojIPlm7Tlubbph43mlrDliqDovb3lj5jph4/lpLHotKU6YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbotYTmupBcbiAgICovXG4gIHB1YmxpYyBjbGVhbnVwKCk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLnN5bmNTZXJ2aWNlLmNsZWFudXAoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl0g5riF55CG6LWE5rqQ5aSx6LSlOmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5ZCM5q2l5a+56LGh5Y2h54mH55qE6KeG5Zu+5pWw5o2uXG4gICAqIEBwYXJhbSBjYXJkIOWPmOmHj+WNoeeJh1xuICAgKi9cbiAgcHJpdmF0ZSBzeW5jT2JqZWN0Q2FyZERhdGEoY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IHZvaWQge1xuICAgIGNvbnN0IGN1cnJlbnRNb2RlID0gY2FyZC5hdHRyKCdkYXRhLXZpZXctbW9kZScpIHx8ICdjYXJkJztcblxuICAgIGlmIChjdXJyZW50TW9kZSA9PT0gJ2NhcmQnKSB7XG4gICAgICBjb25zdCBvYmplY3RWYWx1ZSA9IHRoaXMuY2FyZEZhY3RvcnkuZ2V0VmFyaWFibGVGcm9tQ2FyZChjYXJkKTtcbiAgICAgIGNhcmQuZmluZCgnLmpzb24taW5wdXQnKS52YWwoSlNPTi5zdHJpbmdpZnkob2JqZWN0VmFsdWU/LnZhbHVlLCBudWxsLCAyKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuW1jOWll+WNoeeJh+WPmOabtOS6i+S7tlxuICAgKiBAcGFyYW0gZXZlbnQg5LqL5Lu25a+56LGhXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZU5lc3RlZENhcmRDaGFuZ2VkKGV2ZW50OiBKUXVlcnkuVHJpZ2dlcmVkRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjYXJkID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcblxuICAgIGNvbnN0IHNhdmVCdG4gPSBjYXJkLmZpbmQoJy52YXJpYWJsZS1hY3Rpb24tYnRuLnNhdmUtYnRuJyk7XG4gICAgaWYgKHNhdmVCdG4ubGVuZ3RoID4gMCkge1xuICAgICAgc2F2ZUJ0bi50cmlnZ2VyKCdjbGljaycpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blj5jph4/nsbvlnovnmoTkuK3mloflkI3np7BcbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LXG4gICAqIEByZXR1cm5zIOS4reaWh+WQjeensFxuICAgKi9cbiAgcHJpdmF0ZSBnZXRWYXJpYWJsZVR5cGVOYW1lKHR5cGU6IFZhcmlhYmxlVHlwZSk6IHN0cmluZyB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdnbG9iYWwnOlxuICAgICAgICByZXR1cm4gJ+WFqOWxgCc7XG4gICAgICBjYXNlICdjaGFyYWN0ZXInOlxuICAgICAgICByZXR1cm4gJ+inkuiJsic7XG4gICAgICBjYXNlICdjaGF0JzpcbiAgICAgICAgcmV0dXJuICfogYrlpKknO1xuICAgICAgY2FzZSAnbWVzc2FnZSc6XG4gICAgICAgIHJldHVybiAn5raI5oGvJztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB0eXBlO1xuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/controller.ts\n")},"./src/component/variable_manager/index.ts":
/*!*************************************************!*\
  !*** ./src/component/variable_manager/index.ts ***!
  \*************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initVariableManager: () => (/* binding */ initVariableManager),\n/* harmony export */   openVariableManager: () => (/* binding */ openVariableManager)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ "@sillytavern/scripts/extensions");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/utils */ "@sillytavern/scripts/utils");\n/* harmony import */ var _component_variable_manager_controller__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/variable_manager/controller */ "./src/component/variable_manager/controller.ts");\n/* harmony import */ var _component_variable_manager_model__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/variable_manager/model */ "./src/component/variable_manager/model.ts");\n/* harmony import */ var _component_variable_manager_sync__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/variable_manager/sync */ "./src/component/variable_manager/sync.ts");\n/* harmony import */ var _component_variable_manager_view__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/variable_manager/view */ "./src/component/variable_manager/view.ts");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/util/extension_variables */ "./src/util/extension_variables.ts");\n\n\n\n\n\n\n\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.extensionFolderPath}/src/component/variable_manager/public`;\nlet variableView = null;\nlet variableController = null;\nlet variableModel = null;\nlet syncService = null;\n/**\n * \n */\nasync function openVariableManager() {\n    await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__.loadFileToDocument)(`/scripts/extensions/${templatePath}/style.css`, \'css\');\n    const $variableManagerContainer = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_0__.renderExtensionTemplateAsync)(`${templatePath}`, \'index\'));\n    variableModel = new _component_variable_manager_model__WEBPACK_IMPORTED_MODULE_3__.VariableModel();\n    variableView = new _component_variable_manager_view__WEBPACK_IMPORTED_MODULE_5__.VariableView($variableManagerContainer);\n    syncService = new _component_variable_manager_sync__WEBPACK_IMPORTED_MODULE_4__.VariableSyncService(variableView, variableModel);\n    variableController = new _component_variable_manager_controller__WEBPACK_IMPORTED_MODULE_2__.VariableController(variableModel, variableView, syncService, variableView.cardFactory);\n    variableView.setController(variableController);\n    await variableController.init($variableManagerContainer);\n    if (variableView) {\n        variableView.render();\n    }\n    else {\n        console.error(\'[VariableManager] \');\n    }\n}\n/**\n * \n */\nfunction addVariableManagerQuickButton() {\n    const buttonHtml = $(`\n  <div id="tavern-helper-variable-container" class="list-group-item flex-container flexGap5 interactable">\n      <div class="fa-solid fa-square-root-variable extensionsMenuExtensionButton" /></div>\n      <span id="tavern-helper-variable-text"></span>\n  </div>`);\n    buttonHtml.css(\'display\', \'flex\');\n    $(\'#extensionsMenu\').append(buttonHtml);\n    $(\'#tavern-helper-variable-container\').on(\'click\', async function () {\n        await openVariableManager();\n    });\n}\nfunction initVariableManager() {\n    addVariableManagerQuickButton();\n    const $button = $(\'#open-variable-manager\');\n    if ($button.length) {\n        $button.on(\'click\', async () => {\n            await openVariableManager();\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQStFO0FBQ2Y7QUFFYTtBQUNWO0FBQ0s7QUFDUDtBQUNBO0FBRWpFLE1BQU0sWUFBWSxHQUFHLEdBQUcsMEVBQW1CLHdDQUF3QyxDQUFDO0FBRXBGLElBQUksWUFBWSxHQUF3QixJQUFJLENBQUM7QUFDN0MsSUFBSSxrQkFBa0IsR0FBOEIsSUFBSSxDQUFDO0FBQ3pELElBQUksYUFBYSxHQUF5QixJQUFJLENBQUM7QUFDL0MsSUFBSSxXQUFXLEdBQStCLElBQUksQ0FBQztBQUVuRDs7R0FFRztBQUNJLEtBQUssVUFBVSxtQkFBbUI7SUFDdkMsTUFBTSw4RUFBa0IsQ0FBQyx1QkFBdUIsWUFBWSxZQUFZLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFFakYsTUFBTSx5QkFBeUIsR0FBRyxDQUFDLENBQUMsTUFBTSw2RkFBNEIsQ0FBQyxHQUFHLFlBQVksRUFBRSxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7SUFFcEcsYUFBYSxHQUFHLElBQUksNEVBQWEsRUFBRSxDQUFDO0lBQ3BDLFlBQVksR0FBRyxJQUFJLDBFQUFZLENBQUMseUJBQXlCLENBQUMsQ0FBQztJQUUzRCxXQUFXLEdBQUcsSUFBSSxpRkFBbUIsQ0FBQyxZQUFZLEVBQUUsYUFBYSxDQUFDLENBQUM7SUFFbkUsa0JBQWtCLEdBQUcsSUFBSSxzRkFBa0IsQ0FBQyxhQUFhLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxZQUFZLENBQUMsV0FBVyxDQUFDLENBQUM7SUFFaEgsWUFBWSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0lBRS9DLE1BQU0sa0JBQWtCLENBQUMsSUFBSSxDQUFDLHlCQUF5QixDQUFDLENBQUM7SUFDekQsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNqQixZQUFZLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDeEIsQ0FBQztTQUFNLENBQUM7UUFDTixPQUFPLENBQUMsS0FBSyxDQUFDLDZCQUE2QixDQUFDLENBQUM7SUFDL0MsQ0FBQztBQUNILENBQUM7QUFFRDs7R0FFRztBQUNILFNBQVMsNkJBQTZCO0lBQ3BDLE1BQU0sVUFBVSxHQUFHLENBQUMsQ0FBQzs7OztTQUlkLENBQUMsQ0FBQztJQUNULFVBQVUsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ2xDLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN4QyxDQUFDLENBQUMsbUNBQW1DLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLEtBQUs7UUFDdEQsTUFBTSxtQkFBbUIsRUFBRSxDQUFDO0lBQzlCLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQUdNLFNBQVMsbUJBQW1CO0lBQ2pDLDZCQUE2QixFQUFFLENBQUM7SUFDaEMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLHdCQUF3QixDQUFDLENBQUM7SUFDNUMsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDbkIsT0FBTyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDN0IsTUFBTSxtQkFBbUIsRUFBRSxDQUFDO1FBQzlCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvaW5kZXgudHM/MzRjZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyBsb2FkRmlsZVRvRG9jdW1lbnQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy91dGlscyc7XG5cbmltcG9ydCB7IFZhcmlhYmxlQ29udHJvbGxlciB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvY29udHJvbGxlcic7XG5pbXBvcnQgeyBWYXJpYWJsZU1vZGVsIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9tb2RlbCc7XG5pbXBvcnQgeyBWYXJpYWJsZVN5bmNTZXJ2aWNlIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9zeW5jJztcbmltcG9ydCB7IFZhcmlhYmxlVmlldyB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdmlldyc7XG5pbXBvcnQgeyBleHRlbnNpb25Gb2xkZXJQYXRoIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuXG5jb25zdCB0ZW1wbGF0ZVBhdGggPSBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvcHVibGljYDtcblxubGV0IHZhcmlhYmxlVmlldzogVmFyaWFibGVWaWV3IHwgbnVsbCA9IG51bGw7XG5sZXQgdmFyaWFibGVDb250cm9sbGVyOiBWYXJpYWJsZUNvbnRyb2xsZXIgfCBudWxsID0gbnVsbDtcbmxldCB2YXJpYWJsZU1vZGVsOiBWYXJpYWJsZU1vZGVsIHwgbnVsbCA9IG51bGw7XG5sZXQgc3luY1NlcnZpY2U6IFZhcmlhYmxlU3luY1NlcnZpY2UgfCBudWxsID0gbnVsbDtcblxuLyoqXG4gKiDliJ3lp4vljJblj5jph4/nrqHnkIblmahcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5WYXJpYWJsZU1hbmFnZXIoKSB7XG4gIGF3YWl0IGxvYWRGaWxlVG9Eb2N1bWVudChgL3NjcmlwdHMvZXh0ZW5zaW9ucy8ke3RlbXBsYXRlUGF0aH0vc3R5bGUuY3NzYCwgJ2NzcycpO1xuXG4gIGNvbnN0ICR2YXJpYWJsZU1hbmFnZXJDb250YWluZXIgPSAkKGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoYCR7dGVtcGxhdGVQYXRofWAsICdpbmRleCcpKTtcblxuICB2YXJpYWJsZU1vZGVsID0gbmV3IFZhcmlhYmxlTW9kZWwoKTtcbiAgdmFyaWFibGVWaWV3ID0gbmV3IFZhcmlhYmxlVmlldygkdmFyaWFibGVNYW5hZ2VyQ29udGFpbmVyKTtcblxuICBzeW5jU2VydmljZSA9IG5ldyBWYXJpYWJsZVN5bmNTZXJ2aWNlKHZhcmlhYmxlVmlldywgdmFyaWFibGVNb2RlbCk7XG5cbiAgdmFyaWFibGVDb250cm9sbGVyID0gbmV3IFZhcmlhYmxlQ29udHJvbGxlcih2YXJpYWJsZU1vZGVsLCB2YXJpYWJsZVZpZXcsIHN5bmNTZXJ2aWNlLCB2YXJpYWJsZVZpZXcuY2FyZEZhY3RvcnkpO1xuXG4gIHZhcmlhYmxlVmlldy5zZXRDb250cm9sbGVyKHZhcmlhYmxlQ29udHJvbGxlcik7XG5cbiAgYXdhaXQgdmFyaWFibGVDb250cm9sbGVyLmluaXQoJHZhcmlhYmxlTWFuYWdlckNvbnRhaW5lcik7XG4gIGlmICh2YXJpYWJsZVZpZXcpIHtcbiAgICB2YXJpYWJsZVZpZXcucmVuZGVyKCk7XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS5lcnJvcignW1ZhcmlhYmxlTWFuYWdlcl0g5Y+Y6YeP566h55CG5Zmo5pyq5Yid5aeL5YyWJyk7XG4gIH1cbn1cblxuLyoqXG4gKiDmt7vliqDlj5jph4/nrqHnkIblv6vpgJ/mjInpkq5cbiAqL1xuZnVuY3Rpb24gYWRkVmFyaWFibGVNYW5hZ2VyUXVpY2tCdXR0b24oKSB7XG4gIGNvbnN0IGJ1dHRvbkh0bWwgPSAkKGBcbiAgPGRpdiBpZD1cInRhdmVybi1oZWxwZXItdmFyaWFibGUtY29udGFpbmVyXCIgY2xhc3M9XCJsaXN0LWdyb3VwLWl0ZW0gZmxleC1jb250YWluZXIgZmxleEdhcDUgaW50ZXJhY3RhYmxlXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiZmEtc29saWQgZmEtc3F1YXJlLXJvb3QtdmFyaWFibGUgZXh0ZW5zaW9uc01lbnVFeHRlbnNpb25CdXR0b25cIiAvPjwvZGl2PlxuICAgICAgPHNwYW4gaWQ9XCJ0YXZlcm4taGVscGVyLXZhcmlhYmxlLXRleHRcIj7lj5jph4/nrqHnkIblmag8L3NwYW4+XG4gIDwvZGl2PmApO1xuICBidXR0b25IdG1sLmNzcygnZGlzcGxheScsICdmbGV4Jyk7XG4gICQoJyNleHRlbnNpb25zTWVudScpLmFwcGVuZChidXR0b25IdG1sKTtcbiAgJCgnI3RhdmVybi1oZWxwZXItdmFyaWFibGUtY29udGFpbmVyJykub24oJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGF3YWl0IG9wZW5WYXJpYWJsZU1hbmFnZXIoKTtcbiAgfSk7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRWYXJpYWJsZU1hbmFnZXIoKSB7XG4gIGFkZFZhcmlhYmxlTWFuYWdlclF1aWNrQnV0dG9uKCk7XG4gIGNvbnN0ICRidXR0b24gPSAkKCcjb3Blbi12YXJpYWJsZS1tYW5hZ2VyJyk7XG4gIGlmICgkYnV0dG9uLmxlbmd0aCkge1xuICAgICRidXR0b24ub24oJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgb3BlblZhcmlhYmxlTWFuYWdlcigpO1xuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/variable_manager/index.ts\n')},"./src/component/variable_manager/model.ts":
/*!*************************************************!*\
  !*** ./src/component/variable_manager/model.ts ***!
  \*************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableModel: () => (/* binding */ VariableModel)\n/* harmony export */ });\n/* harmony import */ var _function_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/function/variables */ \"./src/function/variables.ts\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n\n\n\nclass VariableModel {\n    currentVariables = null;\n    variableIdMap = new Map();\n    activeVariableType = 'global';\n    filterState = {\n        string: true,\n        array: true,\n        boolean: true,\n        number: true,\n        object: true,\n    };\n    searchKeyword = '';\n    floorMinRange = null;\n    floorMaxRange = null;\n    constructor() { }\n    /**\n     * ID\n     * @param name \n     * @param value \n     * @param message_id IDmessage\n     * @returns ID\n     */\n    createVariableItem(name, value, message_id) {\n        const id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__.uuidv4)();\n        const variable_item = {\n            name,\n            value,\n            dataType: _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_2__.VariableManagerUtil.inferDataType(value),\n            id,\n            ...(message_id !== undefined && { message_id }),\n        };\n        this.variableIdMap.set(id, variable_item);\n        return variable_item;\n    }\n    // ========== Map ==========\n    /**\n     * map (  map)\n     */\n    getCurrentMapVariables() {\n        return this.currentVariables ? [...this.currentVariables] : [];\n    }\n    /**\n     * map (  map)\n     */\n    addToMap(name, value, message_id) {\n        const variable = this.createVariableItem(name, value, message_id);\n        if (!this.currentVariables) {\n            this.currentVariables = [];\n        }\n        this.currentVariables.push(variable);\n        return variable;\n    }\n    /**\n     * map (  map)\n     */\n    removeFromMap(id) {\n        if (!this.currentVariables)\n            return false;\n        const index = this.currentVariables.findIndex(v => v.id === id);\n        if (index >= 0) {\n            this.currentVariables.splice(index, 1);\n            this.variableIdMap.delete(id);\n            return true;\n        }\n        return false;\n    }\n    /**\n     * map (  map)\n     */\n    updateInMap(id, newName, newValue, newMessageId) {\n        if (!this.currentVariables)\n            return false;\n        const variable = this.currentVariables.find(v => v.id === id);\n        if (variable) {\n            variable.name = newName;\n            variable.value = newValue;\n            variable.dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_2__.VariableManagerUtil.inferDataType(newValue);\n            if (newMessageId !== undefined) {\n                variable.message_id = newMessageId;\n            }\n            this.variableIdMap.set(id, variable);\n            return true;\n        }\n        return false;\n    }\n    /**\n     * ID\n     */\n    clearVariableIdMap() {\n        this.variableIdMap.clear();\n    }\n    /**\n     * ID\n     * @param id ID\n     * @returns  {name, value}  undefined\n     */\n    getVariableById(id) {\n        return this.variableIdMap.get(id);\n    }\n    // ========== Map ==========\n    /**\n     * VariableItem\n     * @param tavernVariables \n     * @param message_id IDmessage\n     * @returns VariableItem\n     * @description ID\n     */\n    convertTavernVariablesToItems(tavernVariables, message_id) {\n        return Object.entries(tavernVariables).map(([name, value]) => {\n            return this.createVariableItem(name, value, message_id);\n        });\n    }\n    /**\n     * VariableItemTavernVariables\n     * @param variables VariableItem\n     * @param message_id message_id\n     * @returns TavernVariables\n     */\n    convertItemsToTavernVariables(variables, message_id) {\n        const result = {};\n        for (const variable of variables) {\n            // message_id\n            if (message_id !== undefined) {\n                if (variable.message_id === message_id) {\n                    result[variable.name] = variable.value;\n                }\n            }\n            else {\n                // message_id\n                result[variable.name] = variable.value;\n            }\n        }\n        return result;\n    }\n    /**\n     * \n     * @param type (global/character/chat/message)\n     * @returns \n     */\n    async loadFromTavern(type) {\n        this.clearVariableIdMap();\n        try {\n            this.activeVariableType = type;\n            if (type === 'message') {\n                this.currentVariables = [];\n                // \n                const [minFloor, maxFloor] = this.getFloorRange();\n                // \n                if (minFloor !== null || maxFloor !== null) {\n                    const effectiveMinFloor = minFloor ?? 0;\n                    const effectiveMaxFloor = maxFloor ?? minFloor ?? 0;\n                    // \n                    for (let floor = effectiveMinFloor; floor <= effectiveMaxFloor; floor++) {\n                        try {\n                            const floorVars = this.getFloorVariables(floor);\n                            // message_id\n                            const floorVariableItems = this.convertTavernVariablesToItems(floorVars, floor);\n                            this.currentVariables.push(...floorVariableItems);\n                        }\n                        catch (error) {\n                            console.warn(`[VariableModel] ${floor}:`, error);\n                            // \n                        }\n                    }\n                }\n            }\n            else {\n                const variables = (0,_function_variables__WEBPACK_IMPORTED_MODULE_0__.getVariables)({ type });\n                this.currentVariables = this.convertTavernVariablesToItems(variables);\n            }\n            return this.currentVariables;\n        }\n        catch (error) {\n            console.error(`[VariableManager] ${type}:`, error);\n            return [];\n        }\n    }\n    /**\n     * \n     * @param type (global/character/chat/message)\n     * @param message_id ID(message)\n     */\n    async saveAllVariables(type, message_id) {\n        if (!this.currentVariables) {\n            console.warn('[VariableModel] ');\n            return;\n        }\n        if (type === 'message') {\n            const [minFloor, maxFloor] = this.getFloorRange();\n            if (minFloor === null || maxFloor === null) {\n                console.warn('[VariableModel] message: ');\n                return;\n            }\n            // message_id\n            if (message_id !== undefined && message_id >= minFloor && message_id <= maxFloor) {\n                const variablesForFloor = this.currentVariables.filter(v => v.message_id === message_id);\n                const tavernVariables = this.convertItemsToTavernVariables(variablesForFloor, message_id);\n                try {\n                    await (0,_function_variables__WEBPACK_IMPORTED_MODULE_0__.replaceVariables)(tavernVariables, { type: 'message', message_id });\n                    console.log(`[VariableManager] ${message_id}`);\n                }\n                catch (error) {\n                    console.error(`[VariableManager] ${message_id}:`, error);\n                }\n            }\n            else {\n                // \n                for (let floor = minFloor; floor <= maxFloor; floor++) {\n                    const variablesForFloor = this.currentVariables.filter(v => v.message_id === floor);\n                    const tavernVariables = this.convertItemsToTavernVariables(variablesForFloor, floor);\n                    try {\n                        await (0,_function_variables__WEBPACK_IMPORTED_MODULE_0__.replaceVariables)(tavernVariables, { type: 'message', message_id: floor });\n                    }\n                    catch (error) {\n                        console.error(`[VariableManager] ${floor}:`, error);\n                    }\n                }\n            }\n        }\n        else {\n            // global/character/chat\n            const tavernVariables = this.convertItemsToTavernVariables(this.currentVariables);\n            await (0,_function_variables__WEBPACK_IMPORTED_MODULE_0__.replaceVariables)(tavernVariables, { type });\n        }\n        console.log(`[VariableManager] `);\n    }\n    /**\n     * \n     * @returns \n     */\n    getActiveVariableType() {\n        return this.activeVariableType;\n    }\n    /**\n     * \n     * @param type (global/character/chat/message)\n     * @param name \n     * @param items \n     * @param variable_id ID(ID)\n     */\n    async updateListOrder(type, name, items, variable_id) {\n        if (type === this.activeVariableType && this.currentVariables) {\n            const variable = this.currentVariables.find(variable => variable.name === name);\n            if (variable && Array.isArray(variable.value)) {\n                variable.value = items;\n                // ID\n                if (variable_id) {\n                    const varInfo = this.variableIdMap.get(variable_id);\n                    if (varInfo) {\n                        varInfo.value = items;\n                        // message_id\n                        this.variableIdMap.set(variable_id, varInfo);\n                    }\n                }\n                // \n                await this.saveAllVariables(type, variable.message_id);\n            }\n        }\n    }\n    /**\n     * \n     * @param type (global/character/chat/message)\n     */\n    async clearAllVariables(type) {\n        if (type === this.activeVariableType) {\n            this.currentVariables = [];\n            this.clearVariableIdMap();\n        }\n        // \n        if (type === 'message') {\n            const [minFloor, maxFloor] = this.getFloorRange();\n            if (minFloor === null || maxFloor === null) {\n                console.warn('[VariableModel] message: ');\n                return;\n            }\n            // \n            for (let floor = minFloor; floor <= maxFloor; floor++) {\n                try {\n                    const emptyVariables = {};\n                    await (0,_function_variables__WEBPACK_IMPORTED_MODULE_0__.replaceVariables)(emptyVariables, { type: 'message', message_id: floor });\n                }\n                catch (error) {\n                    console.error(`[VariableModel] ${floor}:`, error);\n                }\n            }\n        }\n        else {\n            // \n            const emptyVariables = {};\n            await (0,_function_variables__WEBPACK_IMPORTED_MODULE_0__.replaceVariables)(emptyVariables, { type });\n        }\n    }\n    /**\n     * \n     * @param type \n     * @param checked \n     */\n    updateFilterState(type, checked) {\n        this.filterState[type] = checked;\n    }\n    /**\n     * \n     * @returns \n     */\n    getFilterState() {\n        return this.filterState;\n    }\n    /**\n     * \n     * @param keyword \n     */\n    updateSearchKeyword(keyword) {\n        this.searchKeyword = keyword;\n    }\n    /**\n     * \n     * @returns \n     */\n    getSearchKeyword() {\n        return this.searchKeyword;\n    }\n    /**\n     * \n     * @param min \n     * @param max \n     */\n    updateFloorRange(min, max) {\n        // 0\n        if (min !== null) {\n            min = Math.max(0, min);\n        }\n        if (max !== null) {\n            max = Math.max(0, max);\n        }\n        // \n        if (min !== null && max !== null && min > max) {\n            [min, max] = [max, min];\n        }\n        this.floorMinRange = min;\n        this.floorMaxRange = max;\n        // \n        if (this.activeVariableType === 'message') {\n            this.currentVariables = null;\n        }\n    }\n    /**\n     * \n     * @returns  [min, max]\n     */\n    getFloorRange() {\n        return [this.floorMinRange, this.floorMaxRange];\n    }\n    /**\n     * \n     * @param messageId ID\n     * @returns \n     */\n    getFloorVariables(messageId) {\n        try {\n            const variables = (0,_function_variables__WEBPACK_IMPORTED_MODULE_0__.getVariables)({ type: 'message', message_id: messageId });\n            return variables || {};\n        }\n        catch (error) {\n            console.error(`${messageId}:`, error);\n            return {};\n        }\n    }\n    /**\n     *  ID\n     * @param name \n     * @param message_id IDmessage\n     * @returns IDundefined\n     */\n    findVariableId(name, message_id) {\n        for (const id of this.variableIdMap.keys()) {\n            const varInfo = this.variableIdMap.get(id);\n            if (varInfo && varInfo.name === name) {\n                // message_id\n                if (message_id !== undefined) {\n                    if (varInfo.message_id === message_id) {\n                        return id;\n                    }\n                }\n                else {\n                    // message_id\n                    return id;\n                }\n            }\n        }\n        return undefined;\n    }\n    /**\n     * \n     * @param message_id ID\n     * @returns \n     */\n    getVariablesByMessageId(message_id) {\n        if (!this.currentVariables)\n            return [];\n        return this.currentVariables.filter(variable => variable.message_id === message_id);\n    }\n    /**\n     * message_idmessage\n     * @returns message_id\n     */\n    getVariablesWithoutMessageId() {\n        if (!this.currentVariables)\n            return [];\n        return this.currentVariables.filter(variable => variable.message_id === undefined);\n    }\n    /**\n     * \n     * @param name \n     * @returns \n     */\n    getVariablesByName(name) {\n        if (!this.currentVariables)\n            return [];\n        return this.currentVariables.filter(variable => variable.name === name);\n    }\n    /**\n     * \n     * @param name \n     * @param message_id IDmessage\n     * @returns undefined\n     */\n    findVariableByName(name, message_id) {\n        if (!this.currentVariables)\n            return undefined;\n        for (const variable of this.currentVariables) {\n            if (variable.name === name) {\n                if (message_id !== undefined) {\n                    if (variable.message_id === message_id) {\n                        return variable;\n                    }\n                }\n                else {\n                    return variable;\n                }\n            }\n        }\n        return undefined;\n    }\n    /**\n     * \n     * @param added \n     * @param removedIds ID\n     * @param updated \n     */\n    syncCurrentVariables(added, removedIds, updated) {\n        if (!this.currentVariables) {\n            this.currentVariables = [];\n        }\n        // \n        removedIds.forEach(id => {\n            const index = this.currentVariables.findIndex(v => v.id === id);\n            if (index >= 0) {\n                this.currentVariables.splice(index, 1);\n                this.variableIdMap.delete(id);\n            }\n        });\n        // \n        added.forEach(variable => {\n            this.currentVariables.push(variable);\n            this.variableIdMap.set(variable.id, variable);\n        });\n        // \n        updated.forEach(updatedVariable => {\n            const index = this.currentVariables.findIndex(v => v.id === updatedVariable.id);\n            if (index >= 0) {\n                this.currentVariables[index] = updatedVariable;\n                this.variableIdMap.set(updatedVariable.id, updatedVariable);\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvbW9kZWwudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUNzRTtBQUNsQjtBQUNvQjtBQUVqRSxNQUFNLGFBQWE7SUFDaEIsZ0JBQWdCLEdBQTBCLElBQUksQ0FBQztJQUMvQyxhQUFhLEdBQThCLElBQUksR0FBRyxFQUFFLENBQUM7SUFFckQsa0JBQWtCLEdBQWlCLFFBQVEsQ0FBQztJQUU1QyxXQUFXLEdBQXNDO1FBQ3ZELE1BQU0sRUFBRSxJQUFJO1FBQ1osS0FBSyxFQUFFLElBQUk7UUFDWCxPQUFPLEVBQUUsSUFBSTtRQUNiLE1BQU0sRUFBRSxJQUFJO1FBQ1osTUFBTSxFQUFFLElBQUk7S0FDYixDQUFDO0lBRU0sYUFBYSxHQUFXLEVBQUUsQ0FBQztJQUUzQixhQUFhLEdBQWtCLElBQUksQ0FBQztJQUNwQyxhQUFhLEdBQWtCLElBQUksQ0FBQztJQUU1QyxnQkFBZSxDQUFDO0lBRWhCOzs7Ozs7T0FNRztJQUNJLGtCQUFrQixDQUFDLElBQVksRUFBRSxLQUFVLEVBQUUsVUFBbUI7UUFDckUsTUFBTSxFQUFFLEdBQUcsa0VBQU0sRUFBRSxDQUFDO1FBQ3BCLE1BQU0sYUFBYSxHQUFpQjtZQUNsQyxJQUFJO1lBQ0osS0FBSztZQUNMLFFBQVEsRUFBRSxpRkFBbUIsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDO1lBQ2xELEVBQUU7WUFDRixHQUFHLENBQUMsVUFBVSxLQUFLLFNBQVMsSUFBSSxFQUFFLFVBQVUsRUFBRSxDQUFDO1NBQ2hELENBQUM7UUFDRixJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFDMUMsT0FBTyxhQUFhLENBQUM7SUFDdkIsQ0FBQztJQUVELG9DQUFvQztJQUVwQzs7T0FFRztJQUNJLHNCQUFzQjtRQUMzQixPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7SUFDakUsQ0FBQztJQUVEOztPQUVHO0lBQ0ksUUFBUSxDQUFDLElBQVksRUFBRSxLQUFVLEVBQUUsVUFBbUI7UUFDM0QsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFDbEUsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQzNCLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7UUFDN0IsQ0FBQztRQUNELElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDckMsT0FBTyxRQUFRLENBQUM7SUFDbEIsQ0FBQztJQUVEOztPQUVHO0lBQ0ksYUFBYSxDQUFDLEVBQVU7UUFDN0IsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0I7WUFBRSxPQUFPLEtBQUssQ0FBQztRQUN6QyxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUNoRSxJQUFJLEtBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQztZQUNmLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3ZDLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzlCLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVEOztPQUVHO0lBQ0ksV0FBVyxDQUFDLEVBQVUsRUFBRSxPQUFlLEVBQUUsUUFBYSxFQUFFLFlBQXFCO1FBQ2xGLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCO1lBQUUsT0FBTyxLQUFLLENBQUM7UUFDekMsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7UUFDOUQsSUFBSSxRQUFRLEVBQUUsQ0FBQztZQUNiLFFBQVEsQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDO1lBQ3hCLFFBQVEsQ0FBQyxLQUFLLEdBQUcsUUFBUSxDQUFDO1lBQzFCLFFBQVEsQ0FBQyxRQUFRLEdBQUcsaUZBQW1CLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ2hFLElBQUksWUFBWSxLQUFLLFNBQVMsRUFBRSxDQUFDO2dCQUMvQixRQUFRLENBQUMsVUFBVSxHQUFHLFlBQVksQ0FBQztZQUNyQyxDQUFDO1lBQ0QsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBQ3JDLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVEOztPQUVHO0lBQ0ksa0JBQWtCO1FBQ3ZCLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDN0IsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxlQUFlLENBQUMsRUFBVTtRQUMvQixPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFRCxvQ0FBb0M7SUFFcEM7Ozs7OztPQU1HO0lBQ0ksNkJBQTZCLENBQUMsZUFBZ0MsRUFBRSxVQUFtQjtRQUN4RixPQUFPLE1BQU0sQ0FBQyxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLEVBQUUsRUFBRTtZQUMzRCxPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBQzFELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksNkJBQTZCLENBQUMsU0FBeUIsRUFBRSxVQUFtQjtRQUNqRixNQUFNLE1BQU0sR0FBb0IsRUFBRSxDQUFDO1FBRW5DLEtBQUssTUFBTSxRQUFRLElBQUksU0FBUyxFQUFFLENBQUM7WUFDakMsMkJBQTJCO1lBQzNCLElBQUksVUFBVSxLQUFLLFNBQVMsRUFBRSxDQUFDO2dCQUM3QixJQUFJLFFBQVEsQ0FBQyxVQUFVLEtBQUssVUFBVSxFQUFFLENBQUM7b0JBQ3ZDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQztnQkFDekMsQ0FBQztZQUNILENBQUM7aUJBQU0sQ0FBQztnQkFDTiwwQkFBMEI7Z0JBQzFCLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQztZQUN6QyxDQUFDO1FBQ0gsQ0FBQztRQUVELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksS0FBSyxDQUFDLGNBQWMsQ0FBQyxJQUFrQjtRQUM1QyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztRQUUxQixJQUFJLENBQUM7WUFDSCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDO1lBRS9CLElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRSxDQUFDO2dCQUN2QixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO2dCQUUzQixXQUFXO2dCQUNYLE1BQU0sQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLEdBQUcsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO2dCQUVsRCxpQkFBaUI7Z0JBQ2pCLElBQUksUUFBUSxLQUFLLElBQUksSUFBSSxRQUFRLEtBQUssSUFBSSxFQUFFLENBQUM7b0JBQzNDLE1BQU0saUJBQWlCLEdBQUcsUUFBUSxJQUFJLENBQUMsQ0FBQztvQkFDeEMsTUFBTSxpQkFBaUIsR0FBRyxRQUFRLElBQUksUUFBUSxJQUFJLENBQUMsQ0FBQztvQkFFcEQsaUJBQWlCO29CQUNqQixLQUFLLElBQUksS0FBSyxHQUFHLGlCQUFpQixFQUFFLEtBQUssSUFBSSxpQkFBaUIsRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDO3dCQUN4RSxJQUFJLENBQUM7NEJBQ0gsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDOzRCQUNoRCx5QkFBeUI7NEJBQ3pCLE1BQU0sa0JBQWtCLEdBQUcsSUFBSSxDQUFDLDZCQUE2QixDQUFDLFNBQVMsRUFBRSxLQUFLLENBQUMsQ0FBQzs0QkFDaEYsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxHQUFHLGtCQUFrQixDQUFDLENBQUM7d0JBQ3BELENBQUM7d0JBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQzs0QkFDZixPQUFPLENBQUMsSUFBSSxDQUFDLHNCQUFzQixLQUFLLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQzs0QkFDekQsV0FBVzt3QkFDYixDQUFDO29CQUNILENBQUM7Z0JBQ0gsQ0FBQztZQUNILENBQUM7aUJBQU0sQ0FBQztnQkFDTixNQUFNLFNBQVMsR0FBRyxpRUFBWSxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQW9CLENBQUM7Z0JBQzVELElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsNkJBQTZCLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDeEUsQ0FBQztZQUVELE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDO1FBQy9CLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsSUFBSSxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDekQsT0FBTyxFQUFFLENBQUM7UUFDWixDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxLQUFLLENBQUMsZ0JBQWdCLENBQUMsSUFBa0IsRUFBRSxVQUFtQjtRQUNuRSxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDM0IsT0FBTyxDQUFDLElBQUksQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1lBQzlDLE9BQU87UUFDVCxDQUFDO1FBRUQsSUFBSSxJQUFJLEtBQUssU0FBUyxFQUFFLENBQUM7WUFDdkIsTUFBTSxDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUMsR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7WUFFbEQsSUFBSSxRQUFRLEtBQUssSUFBSSxJQUFJLFFBQVEsS0FBSyxJQUFJLEVBQUUsQ0FBQztnQkFDM0MsT0FBTyxDQUFDLElBQUksQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO2dCQUMxRCxPQUFPO1lBQ1QsQ0FBQztZQUVELDZCQUE2QjtZQUM3QixJQUFJLFVBQVUsS0FBSyxTQUFTLElBQUksVUFBVSxJQUFJLFFBQVEsSUFBSSxVQUFVLElBQUksUUFBUSxFQUFFLENBQUM7Z0JBQ2pGLE1BQU0saUJBQWlCLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLEtBQUssVUFBVSxDQUFDLENBQUM7Z0JBQ3pGLE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyxpQkFBaUIsRUFBRSxVQUFVLENBQUMsQ0FBQztnQkFFMUYsSUFBSSxDQUFDO29CQUNILE1BQU0scUVBQWdCLENBQUMsZUFBZSxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxDQUFDO29CQUN6RSxPQUFPLENBQUMsR0FBRyxDQUFDLDBCQUEwQixVQUFVLEtBQUssQ0FBQyxDQUFDO2dCQUN6RCxDQUFDO2dCQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7b0JBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQyx3QkFBd0IsVUFBVSxRQUFRLEVBQUUsS0FBSyxDQUFDLENBQUM7Z0JBQ25FLENBQUM7WUFDSCxDQUFDO2lCQUFNLENBQUM7Z0JBQ04sbUJBQW1CO2dCQUNuQixLQUFLLElBQUksS0FBSyxHQUFHLFFBQVEsRUFBRSxLQUFLLElBQUksUUFBUSxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUM7b0JBQ3RELE1BQU0saUJBQWlCLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLEtBQUssS0FBSyxDQUFDLENBQUM7b0JBQ3BGLE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyxpQkFBaUIsRUFBRSxLQUFLLENBQUMsQ0FBQztvQkFFckYsSUFBSSxDQUFDO3dCQUNILE1BQU0scUVBQWdCLENBQUMsZUFBZSxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztvQkFDbEYsQ0FBQztvQkFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO3dCQUNmLE9BQU8sQ0FBQyxLQUFLLENBQUMsd0JBQXdCLEtBQUssUUFBUSxFQUFFLEtBQUssQ0FBQyxDQUFDO29CQUM5RCxDQUFDO2dCQUNILENBQUM7WUFDSCxDQUFDO1FBQ0gsQ0FBQzthQUFNLENBQUM7WUFDTix1Q0FBdUM7WUFDdkMsTUFBTSxlQUFlLEdBQUcsSUFBSSxDQUFDLDZCQUE2QixDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ2xGLE1BQU0scUVBQWdCLENBQUMsZUFBZSxFQUFFLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUNwRCxDQUFDO1FBRUQsT0FBTyxDQUFDLEdBQUcsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0lBQzFDLENBQUM7SUFFRDs7O09BR0c7SUFDSSxxQkFBcUI7UUFDMUIsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUM7SUFDakMsQ0FBQztJQUVEOzs7Ozs7T0FNRztJQUNJLEtBQUssQ0FBQyxlQUFlLENBQUMsSUFBa0IsRUFBRSxJQUFZLEVBQUUsS0FBZSxFQUFFLFdBQW9CO1FBQ2xHLElBQUksSUFBSSxLQUFLLElBQUksQ0FBQyxrQkFBa0IsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUM5RCxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksS0FBSyxJQUFJLENBQUMsQ0FBQztZQUNoRixJQUFJLFFBQVEsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO2dCQUM5QyxRQUFRLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztnQkFFdkIsaUJBQWlCO2dCQUNqQixJQUFJLFdBQVcsRUFBRSxDQUFDO29CQUNoQixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztvQkFDcEQsSUFBSSxPQUFPLEVBQUUsQ0FBQzt3QkFDWixPQUFPLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQzt3QkFDdEIsb0JBQW9CO3dCQUNwQixJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLENBQUM7b0JBQy9DLENBQUM7Z0JBQ0gsQ0FBQztnQkFFRCxhQUFhO2dCQUNiLE1BQU0sSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDekQsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksS0FBSyxDQUFDLGlCQUFpQixDQUFDLElBQWtCO1FBQy9DLElBQUksSUFBSSxLQUFLLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBQ3JDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFDNUIsQ0FBQztRQUVELGVBQWU7UUFDZixJQUFJLElBQUksS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUN2QixNQUFNLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxHQUFHLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztZQUVsRCxJQUFJLFFBQVEsS0FBSyxJQUFJLElBQUksUUFBUSxLQUFLLElBQUksRUFBRSxDQUFDO2dCQUMzQyxPQUFPLENBQUMsSUFBSSxDQUFDLDJDQUEyQyxDQUFDLENBQUM7Z0JBQzFELE9BQU87WUFDVCxDQUFDO1lBRUQsU0FBUztZQUNULEtBQUssSUFBSSxLQUFLLEdBQUcsUUFBUSxFQUFFLEtBQUssSUFBSSxRQUFRLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQztnQkFDdEQsSUFBSSxDQUFDO29CQUNILE1BQU0sY0FBYyxHQUFvQixFQUFFLENBQUM7b0JBQzNDLE1BQU0scUVBQWdCLENBQUMsY0FBYyxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztnQkFDakYsQ0FBQztnQkFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO29CQUNmLE9BQU8sQ0FBQyxLQUFLLENBQUMsc0JBQXNCLEtBQUssUUFBUSxFQUFFLEtBQUssQ0FBQyxDQUFDO2dCQUM1RCxDQUFDO1lBQ0gsQ0FBQztRQUNILENBQUM7YUFBTSxDQUFDO1lBQ04saUJBQWlCO1lBQ2pCLE1BQU0sY0FBYyxHQUFvQixFQUFFLENBQUM7WUFDM0MsTUFBTSxxRUFBZ0IsQ0FBQyxjQUFjLEVBQUUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ25ELENBQUM7SUFDSCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLGlCQUFpQixDQUFDLElBQXNCLEVBQUUsT0FBZ0I7UUFDL0QsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxPQUFPLENBQUM7SUFDbkMsQ0FBQztJQUVEOzs7T0FHRztJQUNJLGNBQWM7UUFDbkIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzFCLENBQUM7SUFFRDs7O09BR0c7SUFDSSxtQkFBbUIsQ0FBQyxPQUFlO1FBQ3hDLElBQUksQ0FBQyxhQUFhLEdBQUcsT0FBTyxDQUFDO0lBQy9CLENBQUM7SUFFRDs7O09BR0c7SUFDSSxnQkFBZ0I7UUFDckIsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDO0lBQzVCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksZ0JBQWdCLENBQUMsR0FBa0IsRUFBRSxHQUFrQjtRQUM1RCxZQUFZO1FBQ1osSUFBSSxHQUFHLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDakIsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ3pCLENBQUM7UUFDRCxJQUFJLEdBQUcsS0FBSyxJQUFJLEVBQUUsQ0FBQztZQUNqQixHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDekIsQ0FBQztRQUVELDBCQUEwQjtRQUMxQixJQUFJLEdBQUcsS0FBSyxJQUFJLElBQUksR0FBRyxLQUFLLElBQUksSUFBSSxHQUFHLEdBQUcsR0FBRyxFQUFFLENBQUM7WUFDOUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDMUIsQ0FBQztRQUVELElBQUksQ0FBQyxhQUFhLEdBQUcsR0FBRyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxhQUFhLEdBQUcsR0FBRyxDQUFDO1FBRXpCLGNBQWM7UUFDZCxJQUFJLElBQUksQ0FBQyxrQkFBa0IsS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUMxQyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDO1FBQy9CLENBQUM7SUFDSCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksYUFBYTtRQUNsQixPQUFPLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDbEQsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxpQkFBaUIsQ0FBQyxTQUFpQjtRQUN4QyxJQUFJLENBQUM7WUFDSCxNQUFNLFNBQVMsR0FBRyxpRUFBWSxDQUFDLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLENBQW9CLENBQUM7WUFDOUYsT0FBTyxTQUFTLElBQUksRUFBRSxDQUFDO1FBQ3pCLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNLFNBQVMsUUFBUSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzlDLE9BQU8sRUFBRSxDQUFDO1FBQ1osQ0FBQztJQUNILENBQUM7SUFFRDs7Ozs7T0FLRztJQUNJLGNBQWMsQ0FBQyxJQUFZLEVBQUUsVUFBbUI7UUFDckQsS0FBSyxNQUFNLEVBQUUsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUM7WUFDM0MsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDM0MsSUFBSSxPQUFPLElBQUksT0FBTyxDQUFDLElBQUksS0FBSyxJQUFJLEVBQUUsQ0FBQztnQkFDckMseUJBQXlCO2dCQUN6QixJQUFJLFVBQVUsS0FBSyxTQUFTLEVBQUUsQ0FBQztvQkFDN0IsSUFBSSxPQUFPLENBQUMsVUFBVSxLQUFLLFVBQVUsRUFBRSxDQUFDO3dCQUN0QyxPQUFPLEVBQUUsQ0FBQztvQkFDWixDQUFDO2dCQUNILENBQUM7cUJBQU0sQ0FBQztvQkFDTiw4QkFBOEI7b0JBQzlCLE9BQU8sRUFBRSxDQUFDO2dCQUNaLENBQUM7WUFDSCxDQUFDO1FBQ0gsQ0FBQztRQUNELE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksdUJBQXVCLENBQUMsVUFBa0I7UUFDL0MsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0I7WUFBRSxPQUFPLEVBQUUsQ0FBQztRQUN0QyxPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsVUFBVSxLQUFLLFVBQVUsQ0FBQyxDQUFDO0lBQ3RGLENBQUM7SUFFRDs7O09BR0c7SUFDSSw0QkFBNEI7UUFDakMsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0I7WUFBRSxPQUFPLEVBQUUsQ0FBQztRQUN0QyxPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsVUFBVSxLQUFLLFNBQVMsQ0FBQyxDQUFDO0lBQ3JGLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksa0JBQWtCLENBQUMsSUFBWTtRQUNwQyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQjtZQUFFLE9BQU8sRUFBRSxDQUFDO1FBQ3RDLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEtBQUssSUFBSSxDQUFDLENBQUM7SUFDMUUsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksa0JBQWtCLENBQUMsSUFBWSxFQUFFLFVBQW1CO1FBQ3pELElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCO1lBQUUsT0FBTyxTQUFTLENBQUM7UUFFN0MsS0FBSyxNQUFNLFFBQVEsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUM3QyxJQUFJLFFBQVEsQ0FBQyxJQUFJLEtBQUssSUFBSSxFQUFFLENBQUM7Z0JBQzNCLElBQUksVUFBVSxLQUFLLFNBQVMsRUFBRSxDQUFDO29CQUM3QixJQUFJLFFBQVEsQ0FBQyxVQUFVLEtBQUssVUFBVSxFQUFFLENBQUM7d0JBQ3ZDLE9BQU8sUUFBUSxDQUFDO29CQUNsQixDQUFDO2dCQUNILENBQUM7cUJBQU0sQ0FBQztvQkFDTixPQUFPLFFBQVEsQ0FBQztnQkFDbEIsQ0FBQztZQUNILENBQUM7UUFDSCxDQUFDO1FBQ0QsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksb0JBQW9CLENBQUMsS0FBcUIsRUFBRSxVQUFvQixFQUFFLE9BQXVCO1FBQzlGLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUMzQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO1FBQzdCLENBQUM7UUFFRCxPQUFPO1FBQ1AsVUFBVSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsRUFBRTtZQUN0QixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsZ0JBQWlCLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztZQUNqRSxJQUFJLEtBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQztnQkFDZixJQUFJLENBQUMsZ0JBQWlCLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDeEMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDaEMsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTztRQUNQLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDdkIsSUFBSSxDQUFDLGdCQUFpQixDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN0QyxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTztRQUNQLE9BQU8sQ0FBQyxPQUFPLENBQUMsZUFBZSxDQUFDLEVBQUU7WUFDaEMsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLGdCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssZUFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ2pGLElBQUksS0FBSyxJQUFJLENBQUMsRUFBRSxDQUFDO2dCQUNmLElBQUksQ0FBQyxnQkFBaUIsQ0FBQyxLQUFLLENBQUMsR0FBRyxlQUFlLENBQUM7Z0JBQ2hELElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxFQUFFLEVBQUUsZUFBZSxDQUFDLENBQUM7WUFDOUQsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL21vZGVsLnRzP2I5NjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGF2ZXJuVmFyaWFibGVzLCBWYXJpYWJsZURhdGFUeXBlLCBWYXJpYWJsZUl0ZW0sIFZhcmlhYmxlVHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdHlwZXMnO1xuaW1wb3J0IHsgZ2V0VmFyaWFibGVzLCByZXBsYWNlVmFyaWFibGVzIH0gZnJvbSAnQC9mdW5jdGlvbi92YXJpYWJsZXMnO1xuaW1wb3J0IHsgdXVpZHY0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuaW1wb3J0IHsgVmFyaWFibGVNYW5hZ2VyVXRpbCB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbCc7XG5cbmV4cG9ydCBjbGFzcyBWYXJpYWJsZU1vZGVsIHtcbiAgcHJpdmF0ZSBjdXJyZW50VmFyaWFibGVzOiBWYXJpYWJsZUl0ZW1bXSB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHZhcmlhYmxlSWRNYXA6IE1hcDxzdHJpbmcsIFZhcmlhYmxlSXRlbT4gPSBuZXcgTWFwKCk7XG5cbiAgcHJpdmF0ZSBhY3RpdmVWYXJpYWJsZVR5cGU6IFZhcmlhYmxlVHlwZSA9ICdnbG9iYWwnO1xuXG4gIHByaXZhdGUgZmlsdGVyU3RhdGU6IFJlY29yZDxWYXJpYWJsZURhdGFUeXBlLCBib29sZWFuPiA9IHtcbiAgICBzdHJpbmc6IHRydWUsXG4gICAgYXJyYXk6IHRydWUsXG4gICAgYm9vbGVhbjogdHJ1ZSxcbiAgICBudW1iZXI6IHRydWUsXG4gICAgb2JqZWN0OiB0cnVlLFxuICB9O1xuXG4gIHByaXZhdGUgc2VhcmNoS2V5d29yZDogc3RyaW5nID0gJyc7XG5cbiAgcHJpdmF0ZSBmbG9vck1pblJhbmdlOiBudW1iZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBmbG9vck1heFJhbmdlOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcigpIHt9XG5cbiAgLyoqXG4gICAqIOS4uuWPmOmHj+WIm+W7uuWUr+S4gElE5bm25bu656uL5pig5bCE5YWz57O7XG4gICAqIEBwYXJhbSBuYW1lIOWPmOmHj+WQjeensFxuICAgKiBAcGFyYW0gdmFsdWUg5Y+Y6YeP5YC8XG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOa2iOaBr0lE77yI5Y+v6YCJ77yM5LuF55So5LqObWVzc2FnZeexu+Wei+WPmOmHj++8iVxuICAgKiBAcmV0dXJucyDnlJ/miJDnmoTllK/kuIBJRFxuICAgKi9cbiAgcHVibGljIGNyZWF0ZVZhcmlhYmxlSXRlbShuYW1lOiBzdHJpbmcsIHZhbHVlOiBhbnksIG1lc3NhZ2VfaWQ/OiBudW1iZXIpOiBWYXJpYWJsZUl0ZW0ge1xuICAgIGNvbnN0IGlkID0gdXVpZHY0KCk7XG4gICAgY29uc3QgdmFyaWFibGVfaXRlbTogVmFyaWFibGVJdGVtID0ge1xuICAgICAgbmFtZSxcbiAgICAgIHZhbHVlLFxuICAgICAgZGF0YVR5cGU6IFZhcmlhYmxlTWFuYWdlclV0aWwuaW5mZXJEYXRhVHlwZSh2YWx1ZSksXG4gICAgICBpZCxcbiAgICAgIC4uLihtZXNzYWdlX2lkICE9PSB1bmRlZmluZWQgJiYgeyBtZXNzYWdlX2lkIH0pLFxuICAgIH07XG4gICAgdGhpcy52YXJpYWJsZUlkTWFwLnNldChpZCwgdmFyaWFibGVfaXRlbSk7XG4gICAgcmV0dXJuIHZhcmlhYmxlX2l0ZW07XG4gIH1cblxuICAvLyA9PT09PT09PT09IOWJjeerr+WSjE1hcOS5i+mXtOeahOWtmOWPliA9PT09PT09PT09XG5cbiAgLyoqXG4gICAqIOiOt+WPluW9k+WJjW1hcOS4reeahOaJgOacieWPmOmHjyAo5YmN56uvIOKGkCBtYXApXG4gICAqL1xuICBwdWJsaWMgZ2V0Q3VycmVudE1hcFZhcmlhYmxlcygpOiBWYXJpYWJsZUl0ZW1bXSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFZhcmlhYmxlcyA/IFsuLi50aGlzLmN1cnJlbnRWYXJpYWJsZXNdIDogW107XG4gIH1cblxuICAvKipcbiAgICog5ZCRbWFw5Lit5re75Yqg5Y+Y6YePICjliY3nq68g4oaSIG1hcClcbiAgICovXG4gIHB1YmxpYyBhZGRUb01hcChuYW1lOiBzdHJpbmcsIHZhbHVlOiBhbnksIG1lc3NhZ2VfaWQ/OiBudW1iZXIpOiBWYXJpYWJsZUl0ZW0ge1xuICAgIGNvbnN0IHZhcmlhYmxlID0gdGhpcy5jcmVhdGVWYXJpYWJsZUl0ZW0obmFtZSwgdmFsdWUsIG1lc3NhZ2VfaWQpO1xuICAgIGlmICghdGhpcy5jdXJyZW50VmFyaWFibGVzKSB7XG4gICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMgPSBbXTtcbiAgICB9XG4gICAgdGhpcy5jdXJyZW50VmFyaWFibGVzLnB1c2godmFyaWFibGUpO1xuICAgIHJldHVybiB2YXJpYWJsZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDku45tYXDkuK3np7vpmaTlj5jph48gKOWJjeerryDihpIgbWFwKVxuICAgKi9cbiAgcHVibGljIHJlbW92ZUZyb21NYXAoaWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGlmICghdGhpcy5jdXJyZW50VmFyaWFibGVzKSByZXR1cm4gZmFsc2U7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmN1cnJlbnRWYXJpYWJsZXMuZmluZEluZGV4KHYgPT4gdi5pZCA9PT0gaWQpO1xuICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIHRoaXMudmFyaWFibGVJZE1hcC5kZWxldGUoaWQpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlnKhtYXDkuK3mm7TmlrDlj5jph48gKOWJjeerryDihpIgbWFwKVxuICAgKi9cbiAgcHVibGljIHVwZGF0ZUluTWFwKGlkOiBzdHJpbmcsIG5ld05hbWU6IHN0cmluZywgbmV3VmFsdWU6IGFueSwgbmV3TWVzc2FnZUlkPzogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRWYXJpYWJsZXMpIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCB2YXJpYWJsZSA9IHRoaXMuY3VycmVudFZhcmlhYmxlcy5maW5kKHYgPT4gdi5pZCA9PT0gaWQpO1xuICAgIGlmICh2YXJpYWJsZSkge1xuICAgICAgdmFyaWFibGUubmFtZSA9IG5ld05hbWU7XG4gICAgICB2YXJpYWJsZS52YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgdmFyaWFibGUuZGF0YVR5cGUgPSBWYXJpYWJsZU1hbmFnZXJVdGlsLmluZmVyRGF0YVR5cGUobmV3VmFsdWUpO1xuICAgICAgaWYgKG5ld01lc3NhZ2VJZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhcmlhYmxlLm1lc3NhZ2VfaWQgPSBuZXdNZXNzYWdlSWQ7XG4gICAgICB9XG4gICAgICB0aGlzLnZhcmlhYmxlSWRNYXAuc2V0KGlkLCB2YXJpYWJsZSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4hemZpOaJgOacieWPmOmHj0lE5pig5bCEXG4gICAqL1xuICBwdWJsaWMgY2xlYXJWYXJpYWJsZUlkTWFwKCk6IHZvaWQge1xuICAgIHRoaXMudmFyaWFibGVJZE1hcC5jbGVhcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIOmAmui/h0lE6I635Y+W5Y+Y6YeP5L+h5oGvXG4gICAqIEBwYXJhbSBpZCDlj5jph49JRFxuICAgKiBAcmV0dXJucyDlj5jph4/kv6Hmga/lr7nosaEge25hbWUsIHZhbHVlfSDmiJYgdW5kZWZpbmVkXG4gICAqL1xuICBwdWJsaWMgZ2V0VmFyaWFibGVCeUlkKGlkOiBzdHJpbmcpOiBWYXJpYWJsZUl0ZW0gfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLnZhcmlhYmxlSWRNYXAuZ2V0KGlkKTtcbiAgfVxuXG4gIC8vID09PT09PT09PT0g6YWS6aaG5ZKMTWFw5LmL6Ze055qE5a2Y5Y+WID09PT09PT09PT1cblxuICAvKipcbiAgICog5bCG6YWS6aaG5Y+Y6YeP6L2s5o2i5Li6VmFyaWFibGVJdGVt5pWw57uEXG4gICAqIEBwYXJhbSB0YXZlcm5WYXJpYWJsZXMg5LuO6YWS6aaG6I635Y+W55qE5Y6f5aeL5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOa2iOaBr0lE77yI5Y+v6YCJ77yM5LuF55So5LqObWVzc2FnZeexu+Wei+WPmOmHj++8iVxuICAgKiBAcmV0dXJucyDovazmjaLlkI7nmoRWYXJpYWJsZUl0ZW3mlbDnu4RcbiAgICogQGRlc2NyaXB0aW9uIOiHquWKqOaOqOaWreavj+S4quWPmOmHj+eahOaVsOaNruexu+Wei+W5tuWIhumFjeWUr+S4gElEXG4gICAqL1xuICBwdWJsaWMgY29udmVydFRhdmVyblZhcmlhYmxlc1RvSXRlbXModGF2ZXJuVmFyaWFibGVzOiBUYXZlcm5WYXJpYWJsZXMsIG1lc3NhZ2VfaWQ/OiBudW1iZXIpOiBWYXJpYWJsZUl0ZW1bXSB7XG4gICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHRhdmVyblZhcmlhYmxlcykubWFwKChbbmFtZSwgdmFsdWVdKSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVWYXJpYWJsZUl0ZW0obmFtZSwgdmFsdWUsIG1lc3NhZ2VfaWQpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWwhlZhcmlhYmxlSXRlbeaVsOe7hOi9rOaNouS4ulRhdmVyblZhcmlhYmxlc+WvueixoVxuICAgKiBAcGFyYW0gdmFyaWFibGVzIFZhcmlhYmxlSXRlbeaVsOe7hFxuICAgKiBAcGFyYW0gbWVzc2FnZV9pZCDlj6/pgInnmoRtZXNzYWdlX2lk562b6YCJ5p2h5Lu2XG4gICAqIEByZXR1cm5zIFRhdmVyblZhcmlhYmxlc+WvueixoVxuICAgKi9cbiAgcHVibGljIGNvbnZlcnRJdGVtc1RvVGF2ZXJuVmFyaWFibGVzKHZhcmlhYmxlczogVmFyaWFibGVJdGVtW10sIG1lc3NhZ2VfaWQ/OiBudW1iZXIpOiBUYXZlcm5WYXJpYWJsZXMge1xuICAgIGNvbnN0IHJlc3VsdDogVGF2ZXJuVmFyaWFibGVzID0ge307XG5cbiAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHZhcmlhYmxlcykge1xuICAgICAgLy8g5aaC5p6c5oyH5a6a5LqGbWVzc2FnZV9pZO+8jOWPqui9rOaNouWMuemFjeeahOWPmOmHj1xuICAgICAgaWYgKG1lc3NhZ2VfaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAodmFyaWFibGUubWVzc2FnZV9pZCA9PT0gbWVzc2FnZV9pZCkge1xuICAgICAgICAgIHJlc3VsdFt2YXJpYWJsZS5uYW1lXSA9IHZhcmlhYmxlLnZhbHVlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyDlpoLmnpzmsqHmnInmjIflrpptZXNzYWdlX2lk77yM6L2s5o2i5omA5pyJ5Y+Y6YePXG4gICAgICAgIHJlc3VsdFt2YXJpYWJsZS5uYW1lXSA9IHZhcmlhYmxlLnZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICog5Yqg6L295oyH5a6a57G75Z6L55qE5Y+Y6YePXG4gICAqIEBwYXJhbSB0eXBlIOWPmOmHj+exu+WeiyhnbG9iYWwvY2hhcmFjdGVyL2NoYXQvbWVzc2FnZSlcbiAgICogQHJldHVybnMg5Yqg6L2955qE5Y+Y6YeP5pWw5o2uXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgbG9hZEZyb21UYXZlcm4odHlwZTogVmFyaWFibGVUeXBlKTogUHJvbWlzZTxWYXJpYWJsZUl0ZW1bXT4ge1xuICAgIHRoaXMuY2xlYXJWYXJpYWJsZUlkTWFwKCk7XG5cbiAgICB0cnkge1xuICAgICAgdGhpcy5hY3RpdmVWYXJpYWJsZVR5cGUgPSB0eXBlO1xuXG4gICAgICBpZiAodHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcyA9IFtdO1xuXG4gICAgICAgIC8vIOiOt+WPluW9k+WJjealvOWxguiMg+WbtFxuICAgICAgICBjb25zdCBbbWluRmxvb3IsIG1heEZsb29yXSA9IHRoaXMuZ2V0Rmxvb3JSYW5nZSgpO1xuXG4gICAgICAgIC8vIOehruS/neiHs+WwkeacieS4gOS4quacieaViOeahOalvOWxguiMg+WbtFxuICAgICAgICBpZiAobWluRmxvb3IgIT09IG51bGwgfHwgbWF4Rmxvb3IgIT09IG51bGwpIHtcbiAgICAgICAgICBjb25zdCBlZmZlY3RpdmVNaW5GbG9vciA9IG1pbkZsb29yID8/IDA7XG4gICAgICAgICAgY29uc3QgZWZmZWN0aXZlTWF4Rmxvb3IgPSBtYXhGbG9vciA/PyBtaW5GbG9vciA/PyAwO1xuXG4gICAgICAgICAgLy8g6YGN5Y6G5q+P5Liq5qW85bGC77yM5Yqg6L295ZCE6Ieq55qE5Y+Y6YePXG4gICAgICAgICAgZm9yIChsZXQgZmxvb3IgPSBlZmZlY3RpdmVNaW5GbG9vcjsgZmxvb3IgPD0gZWZmZWN0aXZlTWF4Rmxvb3I7IGZsb29yKyspIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IGZsb29yVmFycyA9IHRoaXMuZ2V0Rmxvb3JWYXJpYWJsZXMoZmxvb3IpO1xuICAgICAgICAgICAgICAvLyDkuLrmr4/kuKrmpbzlsYLnmoTlj5jph4/mt7vliqBtZXNzYWdlX2lk5qCH6K+GXG4gICAgICAgICAgICAgIGNvbnN0IGZsb29yVmFyaWFibGVJdGVtcyA9IHRoaXMuY29udmVydFRhdmVyblZhcmlhYmxlc1RvSXRlbXMoZmxvb3JWYXJzLCBmbG9vcik7XG4gICAgICAgICAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcy5wdXNoKC4uLmZsb29yVmFyaWFibGVJdGVtcyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFtWYXJpYWJsZU1vZGVsXSDliqDovb3nrKwke2Zsb29yfeWxguWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICAgICAgICAgIC8vIOe7p+e7reWKoOi9veWFtuS7lualvOWxglxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgdmFyaWFibGVzID0gZ2V0VmFyaWFibGVzKHsgdHlwZSB9KSBhcyBUYXZlcm5WYXJpYWJsZXM7XG4gICAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcyA9IHRoaXMuY29udmVydFRhdmVyblZhcmlhYmxlc1RvSXRlbXModmFyaWFibGVzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFZhcmlhYmxlcztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl0g5Yqg6L29JHt0eXBlfeWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOaJgOacieWPmOmHj+WIsOmFkummhlxuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnosoZ2xvYmFsL2NoYXJhY3Rlci9jaGF0L21lc3NhZ2UpXG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOa2iOaBr0lEKOS7heeUqOS6jm1lc3NhZ2XnsbvlnovvvIzlj6/pgInvvIzlpoLmnpzmjIflrprliJnlj6rkv53lrZjliLDor6XmpbzlsYIpXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2F2ZUFsbFZhcmlhYmxlcyh0eXBlOiBWYXJpYWJsZVR5cGUsIG1lc3NhZ2VfaWQ/OiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykge1xuICAgICAgY29uc29sZS53YXJuKCdbVmFyaWFibGVNb2RlbF0g5b2T5YmN5rKh5pyJ5Y+Y6YeP5pWw5o2u77yM6Lez6L+H5L+d5a2YJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHR5cGUgPT09ICdtZXNzYWdlJykge1xuICAgICAgY29uc3QgW21pbkZsb29yLCBtYXhGbG9vcl0gPSB0aGlzLmdldEZsb29yUmFuZ2UoKTtcblxuICAgICAgaWYgKG1pbkZsb29yID09PSBudWxsIHx8IG1heEZsb29yID09PSBudWxsKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignW1ZhcmlhYmxlTW9kZWxdIOS/neWtmG1lc3NhZ2Xlj5jph4/lpLHotKU6IOacquiuvue9ruacieaViOeahOalvOWxguiMg+WbtCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIOWmguaenOaMh+WumuS6hueJueWumueahG1lc3NhZ2VfaWTvvIzlj6rkv53lrZjliLDor6XmpbzlsYJcbiAgICAgIGlmIChtZXNzYWdlX2lkICE9PSB1bmRlZmluZWQgJiYgbWVzc2FnZV9pZCA+PSBtaW5GbG9vciAmJiBtZXNzYWdlX2lkIDw9IG1heEZsb29yKSB7XG4gICAgICAgIGNvbnN0IHZhcmlhYmxlc0ZvckZsb29yID0gdGhpcy5jdXJyZW50VmFyaWFibGVzLmZpbHRlcih2ID0+IHYubWVzc2FnZV9pZCA9PT0gbWVzc2FnZV9pZCk7XG4gICAgICAgIGNvbnN0IHRhdmVyblZhcmlhYmxlcyA9IHRoaXMuY29udmVydEl0ZW1zVG9UYXZlcm5WYXJpYWJsZXModmFyaWFibGVzRm9yRmxvb3IsIG1lc3NhZ2VfaWQpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgcmVwbGFjZVZhcmlhYmxlcyh0YXZlcm5WYXJpYWJsZXMsIHsgdHlwZTogJ21lc3NhZ2UnLCBtZXNzYWdlX2lkIH0pO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBbVmFyaWFibGVNYW5hZ2VyXSDmiJDlip/kv53lrZjnrKwke21lc3NhZ2VfaWR95bGC5Y+Y6YePYCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl0g5L+d5a2Y56ysJHttZXNzYWdlX2lkfeWxguWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOWvueS6jua2iOaBr+exu+Wei++8jOaMiealvOWxguWIhue7hOS/neWtmOWPmOmHj1xuICAgICAgICBmb3IgKGxldCBmbG9vciA9IG1pbkZsb29yOyBmbG9vciA8PSBtYXhGbG9vcjsgZmxvb3IrKykge1xuICAgICAgICAgIGNvbnN0IHZhcmlhYmxlc0ZvckZsb29yID0gdGhpcy5jdXJyZW50VmFyaWFibGVzLmZpbHRlcih2ID0+IHYubWVzc2FnZV9pZCA9PT0gZmxvb3IpO1xuICAgICAgICAgIGNvbnN0IHRhdmVyblZhcmlhYmxlcyA9IHRoaXMuY29udmVydEl0ZW1zVG9UYXZlcm5WYXJpYWJsZXModmFyaWFibGVzRm9yRmxvb3IsIGZsb29yKTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCByZXBsYWNlVmFyaWFibGVzKHRhdmVyblZhcmlhYmxlcywgeyB0eXBlOiAnbWVzc2FnZScsIG1lc3NhZ2VfaWQ6IGZsb29yIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBbVmFyaWFibGVNYW5hZ2VyXSDkv53lrZjnrKwke2Zsb29yfeWxguWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIOWvueS6juWFtuS7luexu+Wei++8iGdsb2JhbC9jaGFyYWN0ZXIvY2hhdO+8ie+8jOaehOW7uuWPmOmHj+WvueixoVxuICAgICAgY29uc3QgdGF2ZXJuVmFyaWFibGVzID0gdGhpcy5jb252ZXJ0SXRlbXNUb1RhdmVyblZhcmlhYmxlcyh0aGlzLmN1cnJlbnRWYXJpYWJsZXMpO1xuICAgICAgYXdhaXQgcmVwbGFjZVZhcmlhYmxlcyh0YXZlcm5WYXJpYWJsZXMsIHsgdHlwZSB9KTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhgW1ZhcmlhYmxlTWFuYWdlcl0g5L+d5a2Y5Y+Y6YeP5oiQ5YqfYCk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5b2T5YmN5rS75Yqo55qE5Y+Y6YeP57G75Z6LXG4gICAqIEByZXR1cm5zIOWPmOmHj+exu+Wei1xuICAgKi9cbiAgcHVibGljIGdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpOiBWYXJpYWJsZVR5cGUge1xuICAgIHJldHVybiB0aGlzLmFjdGl2ZVZhcmlhYmxlVHlwZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDliJfooajlj5jph4/nmoTpobrluo9cbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LKGdsb2JhbC9jaGFyYWN0ZXIvY2hhdC9tZXNzYWdlKVxuICAgKiBAcGFyYW0gbmFtZSDlj5jph4/lkI3np7BcbiAgICogQHBhcmFtIGl0ZW1zIOaWsOeahOWIl+ihqOmhuuW6j1xuICAgKiBAcGFyYW0gdmFyaWFibGVfaWQg5Y+Y6YePSUQo5Y+v6YCJ77yM5aaC5p6c5o+Q5L6b5YiZ5ZCM5pe25pu05pawSUTmmKDlsIQpXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdXBkYXRlTGlzdE9yZGVyKHR5cGU6IFZhcmlhYmxlVHlwZSwgbmFtZTogc3RyaW5nLCBpdGVtczogc3RyaW5nW10sIHZhcmlhYmxlX2lkPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHR5cGUgPT09IHRoaXMuYWN0aXZlVmFyaWFibGVUeXBlICYmIHRoaXMuY3VycmVudFZhcmlhYmxlcykge1xuICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLmN1cnJlbnRWYXJpYWJsZXMuZmluZCh2YXJpYWJsZSA9PiB2YXJpYWJsZS5uYW1lID09PSBuYW1lKTtcbiAgICAgIGlmICh2YXJpYWJsZSAmJiBBcnJheS5pc0FycmF5KHZhcmlhYmxlLnZhbHVlKSkge1xuICAgICAgICB2YXJpYWJsZS52YWx1ZSA9IGl0ZW1zO1xuXG4gICAgICAgIC8vIOWmguaenOaPkOS+m+S6huWPmOmHj0lE77yM5pu05paw5pig5bCEXG4gICAgICAgIGlmICh2YXJpYWJsZV9pZCkge1xuICAgICAgICAgIGNvbnN0IHZhckluZm8gPSB0aGlzLnZhcmlhYmxlSWRNYXAuZ2V0KHZhcmlhYmxlX2lkKTtcbiAgICAgICAgICBpZiAodmFySW5mbykge1xuICAgICAgICAgICAgdmFySW5mby52YWx1ZSA9IGl0ZW1zO1xuICAgICAgICAgICAgLy8g5L+d5oyB5Y+Y6YeP55qEbWVzc2FnZV9pZOS4jeWPmFxuICAgICAgICAgICAgdGhpcy52YXJpYWJsZUlkTWFwLnNldCh2YXJpYWJsZV9pZCwgdmFySW5mbyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8g5L2/55So5a6M5YWo6KaG55uW5qih5byP5L+d5a2YXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUFsbFZhcmlhYmxlcyh0eXBlLCB2YXJpYWJsZS5tZXNzYWdlX2lkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5riF6Zmk5omA5pyJ5Y+Y6YePXG4gICAqIEBwYXJhbSB0eXBlIOWPmOmHj+exu+WeiyhnbG9iYWwvY2hhcmFjdGVyL2NoYXQvbWVzc2FnZSlcbiAgICovXG4gIHB1YmxpYyBhc3luYyBjbGVhckFsbFZhcmlhYmxlcyh0eXBlOiBWYXJpYWJsZVR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodHlwZSA9PT0gdGhpcy5hY3RpdmVWYXJpYWJsZVR5cGUpIHtcbiAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcyA9IFtdO1xuICAgICAgdGhpcy5jbGVhclZhcmlhYmxlSWRNYXAoKTtcbiAgICB9XG5cbiAgICAvLyDmtojmga/nsbvlnovlj5jph4/pnIDopoHpgJDlsYLmuIXpmaRcbiAgICBpZiAodHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICBjb25zdCBbbWluRmxvb3IsIG1heEZsb29yXSA9IHRoaXMuZ2V0Rmxvb3JSYW5nZSgpO1xuXG4gICAgICBpZiAobWluRmxvb3IgPT09IG51bGwgfHwgbWF4Rmxvb3IgPT09IG51bGwpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdbVmFyaWFibGVNb2RlbF0g5riF6ZmkbWVzc2FnZeWPmOmHj+Wksei0pTog5pyq6K6+572u5pyJ5pWI55qE5qW85bGC6IyD5Zu0Jyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8g6YCQ5bGC5riF6Zmk5Y+Y6YePXG4gICAgICBmb3IgKGxldCBmbG9vciA9IG1pbkZsb29yOyBmbG9vciA8PSBtYXhGbG9vcjsgZmxvb3IrKykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGVtcHR5VmFyaWFibGVzOiBUYXZlcm5WYXJpYWJsZXMgPSB7fTtcbiAgICAgICAgICBhd2FpdCByZXBsYWNlVmFyaWFibGVzKGVtcHR5VmFyaWFibGVzLCB7IHR5cGU6ICdtZXNzYWdlJywgbWVzc2FnZV9pZDogZmxvb3IgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihgW1ZhcmlhYmxlTW9kZWxdIOa4hemZpOesrCR7Zmxvb3J95bGC5Y+Y6YeP5aSx6LSlOmAsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyDlhbbku5bnsbvlnovlj5jph4/nm7TmjqXmm7/mjaLkuLrnqbrlr7nosaFcbiAgICAgIGNvbnN0IGVtcHR5VmFyaWFibGVzOiBUYXZlcm5WYXJpYWJsZXMgPSB7fTtcbiAgICAgIGF3YWl0IHJlcGxhY2VWYXJpYWJsZXMoZW1wdHlWYXJpYWJsZXMsIHsgdHlwZSB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pu05paw562b6YCJ54q25oCBXG4gICAqIEBwYXJhbSB0eXBlIOaVsOaNruexu+Wei1xuICAgKiBAcGFyYW0gY2hlY2tlZCDmmK/lkKbpgInkuK1cbiAgICovXG4gIHB1YmxpYyB1cGRhdGVGaWx0ZXJTdGF0ZSh0eXBlOiBWYXJpYWJsZURhdGFUeXBlLCBjaGVja2VkOiBib29sZWFuKTogdm9pZCB7XG4gICAgdGhpcy5maWx0ZXJTdGF0ZVt0eXBlXSA9IGNoZWNrZWQ7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W562b6YCJ54q25oCBXG4gICAqIEByZXR1cm5zIOetm+mAieeKtuaAgVxuICAgKi9cbiAgcHVibGljIGdldEZpbHRlclN0YXRlKCk6IFJlY29yZDxWYXJpYWJsZURhdGFUeXBlLCBib29sZWFuPiB7XG4gICAgcmV0dXJuIHRoaXMuZmlsdGVyU3RhdGU7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5pCc57Si5YWz6ZSu6K+NXG4gICAqIEBwYXJhbSBrZXl3b3JkIOWFs+mUruivjVxuICAgKi9cbiAgcHVibGljIHVwZGF0ZVNlYXJjaEtleXdvcmQoa2V5d29yZDogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5zZWFyY2hLZXl3b3JkID0ga2V5d29yZDtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmkJzntKLlhbPplK7or41cbiAgICogQHJldHVybnMg5pCc57Si5YWz6ZSu6K+NXG4gICAqL1xuICBwdWJsaWMgZ2V0U2VhcmNoS2V5d29yZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnNlYXJjaEtleXdvcmQ7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5qW85bGC6IyD5Zu0562b6YCJXG4gICAqIEBwYXJhbSBtaW4g5pyA5bCP5qW85bGCXG4gICAqIEBwYXJhbSBtYXgg5pyA5aSn5qW85bGCXG4gICAqL1xuICBwdWJsaWMgdXBkYXRlRmxvb3JSYW5nZShtaW46IG51bWJlciB8IG51bGwsIG1heDogbnVtYmVyIHwgbnVsbCk6IHZvaWQge1xuICAgIC8vIOmqjOivgealvOWxguS4jeiDveWwj+S6jjBcbiAgICBpZiAobWluICE9PSBudWxsKSB7XG4gICAgICBtaW4gPSBNYXRoLm1heCgwLCBtaW4pO1xuICAgIH1cbiAgICBpZiAobWF4ICE9PSBudWxsKSB7XG4gICAgICBtYXggPSBNYXRoLm1heCgwLCBtYXgpO1xuICAgIH1cblxuICAgIC8vIOWmguaenOiuvue9ruS6huiMg+WbtOS9huaYr+acgOWwj+WAvOWkp+S6juacgOWkp+WAvO+8jOWImeS6pOaNouWug+S7rFxuICAgIGlmIChtaW4gIT09IG51bGwgJiYgbWF4ICE9PSBudWxsICYmIG1pbiA+IG1heCkge1xuICAgICAgW21pbiwgbWF4XSA9IFttYXgsIG1pbl07XG4gICAgfVxuXG4gICAgdGhpcy5mbG9vck1pblJhbmdlID0gbWluO1xuICAgIHRoaXMuZmxvb3JNYXhSYW5nZSA9IG1heDtcblxuICAgIC8vIOa4hemZpOe8k+WtmO+8jOW8uuWItumHjeaWsOWKoOi9vVxuICAgIGlmICh0aGlzLmFjdGl2ZVZhcmlhYmxlVHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blvZPliY3mpbzlsYLojIPlm7TnrZvpgIlcbiAgICogQHJldHVybnMg5b2T5YmN5qW85bGC6IyD5Zu0IFttaW4sIG1heF1cbiAgICovXG4gIHB1YmxpYyBnZXRGbG9vclJhbmdlKCk6IFtudW1iZXIgfCBudWxsLCBudW1iZXIgfCBudWxsXSB7XG4gICAgcmV0dXJuIFt0aGlzLmZsb29yTWluUmFuZ2UsIHRoaXMuZmxvb3JNYXhSYW5nZV07XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W54m55a6a5qW85bGC55qE5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBtZXNzYWdlSWQg5raI5oGvSURcbiAgICogQHJldHVybnMg5qW85bGC5Y+Y6YeP5pWw5o2u5a+56LGhXG4gICAqL1xuICBwdWJsaWMgZ2V0Rmxvb3JWYXJpYWJsZXMobWVzc2FnZUlkOiBudW1iZXIpOiBUYXZlcm5WYXJpYWJsZXMge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB2YXJpYWJsZXMgPSBnZXRWYXJpYWJsZXMoeyB0eXBlOiAnbWVzc2FnZScsIG1lc3NhZ2VfaWQ6IG1lc3NhZ2VJZCB9KSBhcyBUYXZlcm5WYXJpYWJsZXM7XG4gICAgICByZXR1cm4gdmFyaWFibGVzIHx8IHt9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDojrflj5bnrKwke21lc3NhZ2VJZH3lsYLlj5jph4/lpLHotKU6YCwgZXJyb3IpO1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmn6Xmib7lj5jph4/lr7nlupTnmoQgSURcbiAgICogQHBhcmFtIG5hbWUg5Y+Y6YeP5ZCN56ewXG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOa2iOaBr0lE77yI5Y+v6YCJ77yM55So5LqO57K+56Gu5Yy56YWNbWVzc2FnZeexu+Wei+WPmOmHj++8iVxuICAgKiBAcmV0dXJucyDmib7liLDnmoTlj5jph49JRO+8jOWmguaenOS4jeWtmOWcqOWImei/lOWbnnVuZGVmaW5lZFxuICAgKi9cbiAgcHVibGljIGZpbmRWYXJpYWJsZUlkKG5hbWU6IHN0cmluZywgbWVzc2FnZV9pZD86IG51bWJlcik6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgZm9yIChjb25zdCBpZCBvZiB0aGlzLnZhcmlhYmxlSWRNYXAua2V5cygpKSB7XG4gICAgICBjb25zdCB2YXJJbmZvID0gdGhpcy52YXJpYWJsZUlkTWFwLmdldChpZCk7XG4gICAgICBpZiAodmFySW5mbyAmJiB2YXJJbmZvLm5hbWUgPT09IG5hbWUpIHtcbiAgICAgICAgLy8g5aaC5p6c5oyH5a6a5LqGbWVzc2FnZV9pZO+8jOmcgOimgeeyvuehruWMuemFjVxuICAgICAgICBpZiAobWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgaWYgKHZhckluZm8ubWVzc2FnZV9pZCA9PT0gbWVzc2FnZV9pZCkge1xuICAgICAgICAgICAgcmV0dXJuIGlkO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyDlpoLmnpzmsqHmnInmjIflrpptZXNzYWdlX2lk77yM6L+U5Zue56ys5LiA5Liq5Yy56YWN55qE5Y+Y6YePXG4gICAgICAgICAgcmV0dXJuIGlkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5oyH5a6a5qW85bGC55qE5Y+Y6YeP5YiX6KGoXG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOa2iOaBr0lEXG4gICAqIEByZXR1cm5zIOWxnuS6juivpealvOWxgueahOWPmOmHj+WIl+ihqFxuICAgKi9cbiAgcHVibGljIGdldFZhcmlhYmxlc0J5TWVzc2FnZUlkKG1lc3NhZ2VfaWQ6IG51bWJlcik6IFZhcmlhYmxlSXRlbVtdIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykgcmV0dXJuIFtdO1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYXJpYWJsZXMuZmlsdGVyKHZhcmlhYmxlID0+IHZhcmlhYmxlLm1lc3NhZ2VfaWQgPT09IG1lc3NhZ2VfaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieayoeaciW1lc3NhZ2VfaWTnmoTlj5jph4/vvIjpgJrluLjmmK/pnZ5tZXNzYWdl57G75Z6L55qE5Y+Y6YeP77yJXG4gICAqIEByZXR1cm5zIOayoeaciW1lc3NhZ2VfaWTnmoTlj5jph4/liJfooahcbiAgICovXG4gIHB1YmxpYyBnZXRWYXJpYWJsZXNXaXRob3V0TWVzc2FnZUlkKCk6IFZhcmlhYmxlSXRlbVtdIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykgcmV0dXJuIFtdO1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYXJpYWJsZXMuZmlsdGVyKHZhcmlhYmxlID0+IHZhcmlhYmxlLm1lc3NhZ2VfaWQgPT09IHVuZGVmaW5lZCk7XG4gIH1cblxuICAvKipcbiAgICog5qC55o2u5Y+Y6YeP5ZCN6I635Y+W5omA5pyJ5ZCM5ZCN5Y+Y6YePXG4gICAqIEBwYXJhbSBuYW1lIOWPmOmHj+WQjeensFxuICAgKiBAcmV0dXJucyDlkIzlkI3lj5jph4/liJfooahcbiAgICovXG4gIHB1YmxpYyBnZXRWYXJpYWJsZXNCeU5hbWUobmFtZTogc3RyaW5nKTogVmFyaWFibGVJdGVtW10ge1xuICAgIGlmICghdGhpcy5jdXJyZW50VmFyaWFibGVzKSByZXR1cm4gW107XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFZhcmlhYmxlcy5maWx0ZXIodmFyaWFibGUgPT4gdmFyaWFibGUubmFtZSA9PT0gbmFtZSk7XG4gIH1cblxuICAvKipcbiAgICog6YCa6L+H5Y+Y6YeP5ZCN5p+l5om+5Y+Y6YePXG4gICAqIEBwYXJhbSBuYW1lIOWPmOmHj+WQjeensFxuICAgKiBAcGFyYW0gbWVzc2FnZV9pZCDmtojmga9JRO+8iOWPr+mAie+8jOeUqOS6jueyvuehruWMuemFjW1lc3NhZ2Xnsbvlnovlj5jph4/vvIlcbiAgICogQHJldHVybnMg5om+5Yiw55qE5Y+Y6YeP77yM5aaC5p6c5LiN5a2Y5Zyo5YiZ6L+U5ZuedW5kZWZpbmVkXG4gICAqL1xuICBwdWJsaWMgZmluZFZhcmlhYmxlQnlOYW1lKG5hbWU6IHN0cmluZywgbWVzc2FnZV9pZD86IG51bWJlcik6IFZhcmlhYmxlSXRlbSB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRWYXJpYWJsZXMpIHJldHVybiB1bmRlZmluZWQ7XG5cbiAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHRoaXMuY3VycmVudFZhcmlhYmxlcykge1xuICAgICAgaWYgKHZhcmlhYmxlLm5hbWUgPT09IG5hbWUpIHtcbiAgICAgICAgaWYgKG1lc3NhZ2VfaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGlmICh2YXJpYWJsZS5tZXNzYWdlX2lkID09PSBtZXNzYWdlX2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFyaWFibGU7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB2YXJpYWJsZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIOWQjOatpeW9k+WJjeWPmOmHj+WIl+ihqO+8jOagueaNruWklumDqOWPmOWMlui/m+ihjOWinumHj+abtOaWsFxuICAgKiBAcGFyYW0gYWRkZWQg5paw5aKe55qE5Y+Y6YePXG4gICAqIEBwYXJhbSByZW1vdmVkSWRzIOimgeWIoOmZpOeahOWPmOmHj0lE5YiX6KGoXG4gICAqIEBwYXJhbSB1cGRhdGVkIOimgeabtOaWsOeahOWPmOmHj1xuICAgKi9cbiAgcHVibGljIHN5bmNDdXJyZW50VmFyaWFibGVzKGFkZGVkOiBWYXJpYWJsZUl0ZW1bXSwgcmVtb3ZlZElkczogc3RyaW5nW10sIHVwZGF0ZWQ6IFZhcmlhYmxlSXRlbVtdKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRWYXJpYWJsZXMpIHtcbiAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcyA9IFtdO1xuICAgIH1cblxuICAgIC8vIOWkhOeQhuWIoOmZpFxuICAgIHJlbW92ZWRJZHMuZm9yRWFjaChpZCA9PiB7XG4gICAgICBjb25zdCBpbmRleCA9IHRoaXMuY3VycmVudFZhcmlhYmxlcyEuZmluZEluZGV4KHYgPT4gdi5pZCA9PT0gaWQpO1xuICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgdGhpcy5jdXJyZW50VmFyaWFibGVzIS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB0aGlzLnZhcmlhYmxlSWRNYXAuZGVsZXRlKGlkKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIOWkhOeQhuaWsOWinlxuICAgIGFkZGVkLmZvckVhY2godmFyaWFibGUgPT4ge1xuICAgICAgdGhpcy5jdXJyZW50VmFyaWFibGVzIS5wdXNoKHZhcmlhYmxlKTtcbiAgICAgIHRoaXMudmFyaWFibGVJZE1hcC5zZXQodmFyaWFibGUuaWQsIHZhcmlhYmxlKTtcbiAgICB9KTtcblxuICAgIC8vIOWkhOeQhuabtOaWsFxuICAgIHVwZGF0ZWQuZm9yRWFjaCh1cGRhdGVkVmFyaWFibGUgPT4ge1xuICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmN1cnJlbnRWYXJpYWJsZXMhLmZpbmRJbmRleCh2ID0+IHYuaWQgPT09IHVwZGF0ZWRWYXJpYWJsZS5pZCk7XG4gICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMhW2luZGV4XSA9IHVwZGF0ZWRWYXJpYWJsZTtcbiAgICAgICAgdGhpcy52YXJpYWJsZUlkTWFwLnNldCh1cGRhdGVkVmFyaWFibGUuaWQsIHVwZGF0ZWRWYXJpYWJsZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/variable_manager/model.ts\n")},"./src/component/variable_manager/sync.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/sync.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableSyncService: () => (/* binding */ VariableSyncService)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _function_variables__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/function/variables */ \"./src/function/variables.ts\");\n\n\n\nconst VARIABLE_EVENTS = {\n    GLOBAL: 'settings_updated',\n    CHARACTER: 'character_variables_changed',\n    MESSAGE: 'message_variables_changed',\n    CHAT: '',\n};\nconst CHAT_POLLING_INTERVAL = 2000;\nclass VariableSyncService {\n    domUpdater;\n    model;\n    currentType = null;\n    _boundListeners = {\n        global: { bound: false, handler: this._handleVariableUpdate.bind(this, 'global') },\n        character: { bound: false, handler: this._handleVariableUpdate.bind(this, 'character') },\n        chat: { bound: false, handler: this._handleVariableUpdate.bind(this, 'chat') },\n        message: { bound: false, handler: this._handleVariableUpdate.bind(this, 'message') },\n    };\n    _chatPollingInterval = null;\n    /**\n     * @param domUpdater DOM\n     * @param model \n     */\n    constructor(domUpdater, model) {\n        this.domUpdater = domUpdater;\n        this.model = model;\n    }\n    async cleanup() {\n        this._unbindAllEventListeners();\n        this._stopChatPolling();\n        this.currentType = null;\n    }\n    /**\n     * \n     */\n    async initCurrentType() {\n        this.currentType = 'global';\n        this._activateCurrentListeners();\n    }\n    /**\n     * \n     * @param type \n     */\n    async setCurrentType(type) {\n        if (this.currentType !== type) {\n            this._deactivateCurrentListeners();\n            this.currentType = type;\n            this._activateCurrentListeners();\n        }\n    }\n    /**\n     * \n     */\n    reactivateListeners() {\n        this._deactivateCurrentListeners();\n        this._activateCurrentListeners();\n    }\n    /**\n     * \n     */\n    deactivateListeners() {\n        this._deactivateCurrentListeners();\n    }\n    /**\n     * \n     * @private\n     */\n    _activateCurrentListeners() {\n        if (this.currentType) {\n            if (this.currentType === 'chat') {\n                this._startChatPolling();\n            }\n            else {\n                this._bindVariableListener(this.currentType);\n            }\n        }\n    }\n    /**\n     * \n     * @private\n     */\n    _deactivateCurrentListeners() {\n        this._unbindAllEventListeners();\n        this._stopChatPolling();\n    }\n    /**\n     * \n     * @param type \n     * @private\n     */\n    _bindVariableListener(type) {\n        if (type === 'chat')\n            return;\n        const eventName = VARIABLE_EVENTS[type.toUpperCase()];\n        const listenerStatus = this._boundListeners[type];\n        if (!listenerStatus.bound && eventName) {\n            try {\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(eventName, listenerStatus.handler);\n                this._boundListeners[type].bound = true;\n                console.info(`[VariableManager]${type}`);\n            }\n            catch (error) {\n                console.error(`[VariableManager]${type}:`, error);\n                this._boundListeners[type].bound = false;\n            }\n        }\n    }\n    /**\n     * \n     * @private\n     */\n    _unbindAllEventListeners() {\n        for (const type of Object.keys(this._boundListeners)) {\n            if (type === 'chat')\n                continue;\n            const eventName = VARIABLE_EVENTS[type.toUpperCase()];\n            const listenerStatus = this._boundListeners[type];\n            if (listenerStatus.bound && eventName) {\n                try {\n                    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(eventName, listenerStatus.handler);\n                    this._boundListeners[type].bound = false;\n                }\n                catch (error) {\n                    console.error(`[VariableManager]${type}:`, error);\n                    this._boundListeners[type].bound = false;\n                }\n            }\n        }\n    }\n    /**\n     * \n     * @private\n     */\n    _startChatPolling() {\n        this._stopChatPolling();\n        if (this.currentType === 'chat') {\n            try {\n                this._chatPollingInterval = window.setInterval(async () => {\n                    await this._handleVariableUpdate('chat');\n                }, CHAT_POLLING_INTERVAL);\n            }\n            catch (error) {\n                console.error('[VariableManager]:', error);\n                this._chatPollingInterval = null;\n            }\n        }\n    }\n    /**\n     * \n     * @private\n     */\n    _stopChatPolling() {\n        if (this._chatPollingInterval !== null) {\n            try {\n                window.clearInterval(this._chatPollingInterval);\n                this._chatPollingInterval = null;\n            }\n            catch (error) {\n                console.error('[VariableManager]:', error);\n            }\n        }\n    }\n    /**\n     * \n     * \n     * @param type \n     * @param data \n     * @private\n     */\n    async _handleVariableUpdate(type, data) {\n        if (!this.currentType || this.currentType !== type) {\n            return;\n        }\n        try {\n            let newTavernVariables;\n            let messageId;\n            if ((type === 'character' || type === 'message') && data && data.variables) {\n                newTavernVariables = data.variables;\n                messageId = data.message_id;\n            }\n            else {\n                newTavernVariables = (0,_function_variables__WEBPACK_IMPORTED_MODULE_2__.getVariables)({ type });\n            }\n            const oldVariables = this.model.getCurrentMapVariables();\n            const { added, removed, updated } = this._compareTavernVariables(oldVariables, newTavernVariables, messageId);\n            this._processDiff(added, removed, updated, newTavernVariables, messageId);\n        }\n        catch (error) {\n            console.error(`[VariableManager]${type}:`, error);\n        }\n    }\n    /**\n     *  TavernVariables \n     * @param oldVariables \n     * @param newVars \n     * @param messageId ID\n     * @returns \n     * @private\n     */\n    _compareTavernVariables(oldVariables, newVars, messageId) {\n        const oldVarsMap = new Map();\n        oldVariables.forEach(variable => {\n            if (messageId !== undefined) {\n                if (variable.message_id === messageId) {\n                    oldVarsMap.set(variable.name, variable.value);\n                }\n            }\n            else {\n                if (variable.message_id === undefined) {\n                    oldVarsMap.set(variable.name, variable.value);\n                }\n            }\n        });\n        const oldKeys = new Set(oldVarsMap.keys());\n        const newKeys = new Set(Object.keys(newVars));\n        const added = [...newKeys].filter(key => !oldKeys.has(key));\n        const removed = [...oldKeys].filter(key => !newKeys.has(key));\n        const updated = [...newKeys].filter(key => oldKeys.has(key) && !_.isEqual(oldVarsMap.get(key), newVars[key]));\n        return { added, removed, updated };\n    }\n    /**\n     *  DOM \n     * @param added \n     * @param removed \n     * @param updated \n     * @param newTavernVariables \n     * @param messageId ID\n     * @private\n     */\n    _processDiff(added, removed, updated, newTavernVariables, messageId) {\n        const addedVariables = [];\n        const removedIds = [];\n        const updatedVariables = [];\n        added.forEach(name => {\n            const variable = this.model.createVariableItem(name, newTavernVariables[name], messageId);\n            this.domUpdater.addVariableCard(variable);\n            addedVariables.push(variable);\n        });\n        removed.forEach(name => {\n            const variable = this.model.findVariableByName(name, messageId);\n            if (variable) {\n                this.domUpdater.removeVariableCard(variable.id);\n                removedIds.push(variable.id);\n            }\n        });\n        updated.forEach(name => {\n            const variable = this.model.findVariableByName(name, messageId);\n            if (variable) {\n                variable.value = newTavernVariables[name];\n                variable.dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_1__.VariableManagerUtil.inferDataType(variable.value);\n                this.domUpdater.updateVariableCard(variable);\n                updatedVariables.push(variable);\n            }\n        });\n        this.model.syncCurrentVariables(addedVariables, removedIds, updatedVariables);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvc3luYy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWtEO0FBSXNCO0FBQ3BCO0FBRXBELE1BQU0sZUFBZSxHQUEyQjtJQUM5QyxNQUFNLEVBQUUsa0JBQWtCO0lBQzFCLFNBQVMsRUFBRSw2QkFBNkI7SUFDeEMsT0FBTyxFQUFFLDJCQUEyQjtJQUNwQyxJQUFJLEVBQUUsRUFBRTtDQUNULENBQUM7QUFFRixNQUFNLHFCQUFxQixHQUFHLElBQUksQ0FBQztBQWE1QixNQUFNLG1CQUFtQjtJQUN0QixVQUFVLENBQWM7SUFDeEIsS0FBSyxDQUFnQjtJQUNyQixXQUFXLEdBQXdCLElBQUksQ0FBQztJQUN4QyxlQUFlLEdBQXlDO1FBQzlELE1BQU0sRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQyxFQUFFO1FBQ2xGLFNBQVMsRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLFdBQVcsQ0FBQyxFQUFFO1FBQ3hGLElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxFQUFFO1FBQzlFLE9BQU8sRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxFQUFFO0tBQ3JGLENBQUM7SUFFTSxvQkFBb0IsR0FBa0IsSUFBSSxDQUFDO0lBRW5EOzs7T0FHRztJQUNILFlBQVksVUFBdUIsRUFBRSxLQUFvQjtRQUN2RCxJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztRQUM3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QVEsQ0FBQyxDQUFDO1FBQ2hDLENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNyQixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztZQUNoRSxJQUFJLFFBQVEsRUFBRSxDQUFDO2dCQUNiLElBQUksQ0FBQyxVQUFVLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUNoRCxVQUFVLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUMvQixDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7UUFFSCxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3JCLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsa0JBQWtCLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ2hFLElBQUksUUFBUSxFQUFFLENBQUM7Z0JBQ2IsUUFBUSxDQUFDLEtBQUssR0FBRyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDMUMsUUFBUSxDQUFDLFFBQVEsR0FBRyxpRkFBbUIsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUN0RSxJQUFJLENBQUMsVUFBVSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUM3QyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDbEMsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxjQUFjLEVBQUUsVUFBVSxFQUFFLGdCQUFnQixDQUFDLENBQUM7SUFDaEYsQ0FBQztDQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3N5bmMudHM/NjdlYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBldmVudFNvdXJjZSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG5pbXBvcnQgeyBWYXJpYWJsZU1vZGVsIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9tb2RlbCc7XG5pbXBvcnQgeyBWYXJpYWJsZUl0ZW0sIFZhcmlhYmxlVHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdHlwZXMnO1xuaW1wb3J0IHsgVmFyaWFibGVNYW5hZ2VyVXRpbCB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbCc7XG5pbXBvcnQgeyBnZXRWYXJpYWJsZXMgfSBmcm9tICdAL2Z1bmN0aW9uL3ZhcmlhYmxlcyc7XG5cbmNvbnN0IFZBUklBQkxFX0VWRU5UUzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgR0xPQkFMOiAnc2V0dGluZ3NfdXBkYXRlZCcsXG4gIENIQVJBQ1RFUjogJ2NoYXJhY3Rlcl92YXJpYWJsZXNfY2hhbmdlZCcsXG4gIE1FU1NBR0U6ICdtZXNzYWdlX3ZhcmlhYmxlc19jaGFuZ2VkJyxcbiAgQ0hBVDogJycsXG59O1xuXG5jb25zdCBDSEFUX1BPTExJTkdfSU5URVJWQUwgPSAyMDAwO1xuXG5leHBvcnQgaW50ZXJmYWNlIElEb21VcGRhdGVyIHtcbiAgYWRkVmFyaWFibGVDYXJkKHZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0pOiB2b2lkO1xuICByZW1vdmVWYXJpYWJsZUNhcmQodmFyaWFibGVfaWQ6IHN0cmluZyk6IHZvaWQ7XG4gIHVwZGF0ZVZhcmlhYmxlQ2FyZCh2YXJpYWJsZTogVmFyaWFibGVJdGVtKTogdm9pZDtcbn1cblxuaW50ZXJmYWNlIExpc3RlbmVyU3RhdHVzIHtcbiAgYm91bmQ6IGJvb2xlYW47XG4gIGhhbmRsZXI6ICguLi5hcmdzOiBhbnlbXSkgPT4gUHJvbWlzZTx2b2lkPjtcbn1cblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlU3luY1NlcnZpY2Uge1xuICBwcml2YXRlIGRvbVVwZGF0ZXI6IElEb21VcGRhdGVyO1xuICBwcml2YXRlIG1vZGVsOiBWYXJpYWJsZU1vZGVsO1xuICBwcml2YXRlIGN1cnJlbnRUeXBlOiBWYXJpYWJsZVR5cGUgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBfYm91bmRMaXN0ZW5lcnM6IFJlY29yZDxWYXJpYWJsZVR5cGUsIExpc3RlbmVyU3RhdHVzPiA9IHtcbiAgICBnbG9iYWw6IHsgYm91bmQ6IGZhbHNlLCBoYW5kbGVyOiB0aGlzLl9oYW5kbGVWYXJpYWJsZVVwZGF0ZS5iaW5kKHRoaXMsICdnbG9iYWwnKSB9LFxuICAgIGNoYXJhY3RlcjogeyBib3VuZDogZmFsc2UsIGhhbmRsZXI6IHRoaXMuX2hhbmRsZVZhcmlhYmxlVXBkYXRlLmJpbmQodGhpcywgJ2NoYXJhY3RlcicpIH0sXG4gICAgY2hhdDogeyBib3VuZDogZmFsc2UsIGhhbmRsZXI6IHRoaXMuX2hhbmRsZVZhcmlhYmxlVXBkYXRlLmJpbmQodGhpcywgJ2NoYXQnKSB9LFxuICAgIG1lc3NhZ2U6IHsgYm91bmQ6IGZhbHNlLCBoYW5kbGVyOiB0aGlzLl9oYW5kbGVWYXJpYWJsZVVwZGF0ZS5iaW5kKHRoaXMsICdtZXNzYWdlJykgfSxcbiAgfTtcblxuICBwcml2YXRlIF9jaGF0UG9sbGluZ0ludGVydmFsOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICAvKipcbiAgICogQHBhcmFtIGRvbVVwZGF0ZXIgRE9N5pu05paw5ZmoXG4gICAqIEBwYXJhbSBtb2RlbCDlj5jph4/mlbDmja7mqKHlnotcbiAgICovXG4gIGNvbnN0cnVjdG9yKGRvbVVwZGF0ZXI6IElEb21VcGRhdGVyLCBtb2RlbDogVmFyaWFibGVNb2RlbCkge1xuICAgIHRoaXMuZG9tVXBkYXRlciA9IGRvbVVwZGF0ZXI7XG4gICAgdGhpcy5tb2RlbCA9IG1vZGVsO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGNsZWFudXAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5fdW5iaW5kQWxsRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9zdG9wQ2hhdFBvbGxpbmcoKTtcbiAgICB0aGlzLmN1cnJlbnRUeXBlID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJblvZPliY3nsbvlnotcbiAgICovXG4gIHB1YmxpYyBhc3luYyBpbml0Q3VycmVudFR5cGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5jdXJyZW50VHlwZSA9ICdnbG9iYWwnO1xuICAgIHRoaXMuX2FjdGl2YXRlQ3VycmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruW9k+WJjeWPmOmHj+exu+Wei++8jOW5tuebuOW6lOWcsOWIneWni+WMluebkeWQrOWZqOaIlui9ruivolxuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnotcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzZXRDdXJyZW50VHlwZSh0eXBlOiBWYXJpYWJsZVR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5jdXJyZW50VHlwZSAhPT0gdHlwZSkge1xuICAgICAgdGhpcy5fZGVhY3RpdmF0ZUN1cnJlbnRMaXN0ZW5lcnMoKTtcbiAgICAgIHRoaXMuY3VycmVudFR5cGUgPSB0eXBlO1xuICAgICAgdGhpcy5fYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOmHjeaWsOa/gOa0u+W9k+WJjeexu+Wei+eahOebkeWQrOWZqO+8iOeUqOS6juagh+etvumhtemHjeaWsOa/gOa0u+etieWcuuaZr++8iVxuICAgKi9cbiAgcHVibGljIHJlYWN0aXZhdGVMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgdGhpcy5fZGVhY3RpdmF0ZUN1cnJlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9hY3RpdmF0ZUN1cnJlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlgZznlKjlvZPliY3nmoTkuovku7bnm5HlkKzlmajmiJbova7or6JcbiAgICovXG4gIHB1YmxpYyBkZWFjdGl2YXRlTGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIHRoaXMuX2RlYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICAvKipcbiAgICog5r+A5rS75b2T5YmN57G75Z6L55qE55uR5ZCs5Zmo5oiW6L2u6K+iXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIF9hY3RpdmF0ZUN1cnJlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY3VycmVudFR5cGUpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRUeXBlID09PSAnY2hhdCcpIHtcbiAgICAgICAgdGhpcy5fc3RhcnRDaGF0UG9sbGluZygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fYmluZFZhcmlhYmxlTGlzdGVuZXIodGhpcy5jdXJyZW50VHlwZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWBnOeUqOW9k+WJjeeahOebkeWQrOWZqOaIlui9ruivolxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfZGVhY3RpdmF0ZUN1cnJlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgdGhpcy5fdW5iaW5kQWxsRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9zdG9wQ2hhdFBvbGxpbmcoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnu5/kuIDnmoTlj5jph4/nm5HlkKzlmajnu5Hlrprmlrnms5VcbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIF9iaW5kVmFyaWFibGVMaXN0ZW5lcih0eXBlOiBWYXJpYWJsZVR5cGUpOiB2b2lkIHtcbiAgICBpZiAodHlwZSA9PT0gJ2NoYXQnKSByZXR1cm47XG5cbiAgICBjb25zdCBldmVudE5hbWUgPSBWQVJJQUJMRV9FVkVOVFNbdHlwZS50b1VwcGVyQ2FzZSgpXTtcbiAgICBjb25zdCBsaXN0ZW5lclN0YXR1cyA9IHRoaXMuX2JvdW5kTGlzdGVuZXJzW3R5cGVdO1xuXG4gICAgaWYgKCFsaXN0ZW5lclN0YXR1cy5ib3VuZCAmJiBldmVudE5hbWUpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGV2ZW50U291cmNlLm9uKGV2ZW50TmFtZSwgbGlzdGVuZXJTdGF0dXMuaGFuZGxlcik7XG4gICAgICAgIHRoaXMuX2JvdW5kTGlzdGVuZXJzW3R5cGVdLmJvdW5kID0gdHJ1ZTtcbiAgICAgICAgY29uc29sZS5pbmZvKGBbVmFyaWFibGVNYW5hZ2VyXe+8muW8gOWni+WQjOatpeebkeWQrCR7dHlwZX3lj5jph49gKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJd77ya57uR5a6aJHt0eXBlfeWPmOmHj+S6i+S7tuebkeWQrOWZqOaXtuWHuumUmTpgLCBlcnJvcik7XG4gICAgICAgIHRoaXMuX2JvdW5kTGlzdGVuZXJzW3R5cGVdLmJvdW5kID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOino+e7keaJgOacieS6i+S7tuebkeWQrOWZqFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfdW5iaW5kQWxsRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgZm9yIChjb25zdCB0eXBlIG9mIE9iamVjdC5rZXlzKHRoaXMuX2JvdW5kTGlzdGVuZXJzKSBhcyBWYXJpYWJsZVR5cGVbXSkge1xuICAgICAgaWYgKHR5cGUgPT09ICdjaGF0JykgY29udGludWU7XG5cbiAgICAgIGNvbnN0IGV2ZW50TmFtZSA9IFZBUklBQkxFX0VWRU5UU1t0eXBlLnRvVXBwZXJDYXNlKCldO1xuICAgICAgY29uc3QgbGlzdGVuZXJTdGF0dXMgPSB0aGlzLl9ib3VuZExpc3RlbmVyc1t0eXBlXTtcblxuICAgICAgaWYgKGxpc3RlbmVyU3RhdHVzLmJvdW5kICYmIGV2ZW50TmFtZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50TmFtZSwgbGlzdGVuZXJTdGF0dXMuaGFuZGxlcik7XG4gICAgICAgICAgdGhpcy5fYm91bmRMaXN0ZW5lcnNbdHlwZV0uYm91bmQgPSBmYWxzZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBbVmFyaWFibGVNYW5hZ2VyXe+8muino+e7kSR7dHlwZX3lj5jph4/kuovku7bnm5HlkKzlmajml7blh7rplJk6YCwgZXJyb3IpO1xuICAgICAgICAgIHRoaXMuX2JvdW5kTGlzdGVuZXJzW3R5cGVdLmJvdW5kID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5ZCv5Yqo6IGK5aSp5Y+Y6YeP55qE6L2u6K+iXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIF9zdGFydENoYXRQb2xsaW5nKCk6IHZvaWQge1xuICAgIHRoaXMuX3N0b3BDaGF0UG9sbGluZygpO1xuXG4gICAgaWYgKHRoaXMuY3VycmVudFR5cGUgPT09ICdjaGF0Jykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5fY2hhdFBvbGxpbmdJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5faGFuZGxlVmFyaWFibGVVcGRhdGUoJ2NoYXQnKTtcbiAgICAgICAgfSwgQ0hBVF9QT0xMSU5HX0lOVEVSVkFMKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tWYXJpYWJsZU1hbmFnZXJd77ya5ZCv5Yqo6IGK5aSp5Y+Y6YeP6L2u6K+i5pe25Ye66ZSZOicsIGVycm9yKTtcbiAgICAgICAgdGhpcy5fY2hhdFBvbGxpbmdJbnRlcnZhbCA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWBnOatouiBiuWkqeWPmOmHj+eahOi9ruivolxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfc3RvcENoYXRQb2xsaW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9jaGF0UG9sbGluZ0ludGVydmFsICE9PSBudWxsKSB7XG4gICAgICB0cnkge1xuICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLl9jaGF0UG9sbGluZ0ludGVydmFsKTtcbiAgICAgICAgdGhpcy5fY2hhdFBvbGxpbmdJbnRlcnZhbCA9IG51bGw7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbVmFyaWFibGVNYW5hZ2VyXe+8muWBnOatouiBiuWkqeWPmOmHj+i9ruivouaXtuWHuumUmTonLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOe7n+S4gOeahOWPmOmHj+abtOaWsOWkhOeQhuaWueazlVxuICAgKiDpgILnlKjkuo7miYDmnInlj5jph4/nsbvlnovvvIjlhajlsYDjgIHop5LoibLjgIHogYrlpKnjgIHmtojmga/vvIlcbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LXG4gICAqIEBwYXJhbSBkYXRhIOWPr+mAieeahOS6i+S7tuaVsOaNrlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBfaGFuZGxlVmFyaWFibGVVcGRhdGUodHlwZTogVmFyaWFibGVUeXBlLCBkYXRhPzogYW55KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRUeXBlIHx8IHRoaXMuY3VycmVudFR5cGUgIT09IHR5cGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgbGV0IG5ld1RhdmVyblZhcmlhYmxlczogUmVjb3JkPHN0cmluZywgYW55PjtcbiAgICAgIGxldCBtZXNzYWdlSWQ6IG51bWJlciB8IHVuZGVmaW5lZDtcblxuICAgICAgaWYgKCh0eXBlID09PSAnY2hhcmFjdGVyJyB8fCB0eXBlID09PSAnbWVzc2FnZScpICYmIGRhdGEgJiYgZGF0YS52YXJpYWJsZXMpIHtcbiAgICAgICAgbmV3VGF2ZXJuVmFyaWFibGVzID0gZGF0YS52YXJpYWJsZXM7XG4gICAgICAgIG1lc3NhZ2VJZCA9IGRhdGEubWVzc2FnZV9pZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld1RhdmVyblZhcmlhYmxlcyA9IGdldFZhcmlhYmxlcyh7IHR5cGUgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG9sZFZhcmlhYmxlcyA9IHRoaXMubW9kZWwuZ2V0Q3VycmVudE1hcFZhcmlhYmxlcygpO1xuXG4gICAgICBjb25zdCB7IGFkZGVkLCByZW1vdmVkLCB1cGRhdGVkIH0gPSB0aGlzLl9jb21wYXJlVGF2ZXJuVmFyaWFibGVzKG9sZFZhcmlhYmxlcywgbmV3VGF2ZXJuVmFyaWFibGVzLCBtZXNzYWdlSWQpO1xuXG4gICAgICB0aGlzLl9wcm9jZXNzRGlmZihhZGRlZCwgcmVtb3ZlZCwgdXBkYXRlZCwgbmV3VGF2ZXJuVmFyaWFibGVzLCBtZXNzYWdlSWQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBbVmFyaWFibGVNYW5hZ2VyXe+8muWkhOeQhiR7dHlwZX3lj5jph4/mm7TmlrDml7blh7rplJk6YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmr5TovoPlvZPliY3lj5jph4/kuI7mlrDnmoQgVGF2ZXJuVmFyaWFibGVzIOWvueixoVxuICAgKiBAcGFyYW0gb2xkVmFyaWFibGVzIOW9k+WJjeeahOWPmOmHj+WIl+ihqFxuICAgKiBAcGFyYW0gbmV3VmFycyDmlrDnmoTlj5jph4/lr7nosaFcbiAgICogQHBhcmFtIG1lc3NhZ2VJZCDmtojmga9JRFxuICAgKiBAcmV0dXJucyDljIXlkKvlt7Lmt7vliqDjgIHlt7LliKDpmaTjgIHlt7Lmm7TmlrDlj5jph4/lkI3nmoTlr7nosaFcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByaXZhdGUgX2NvbXBhcmVUYXZlcm5WYXJpYWJsZXMoXG4gICAgb2xkVmFyaWFibGVzOiBWYXJpYWJsZUl0ZW1bXSxcbiAgICBuZXdWYXJzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxuICAgIG1lc3NhZ2VJZD86IG51bWJlcixcbiAgKTogeyBhZGRlZDogc3RyaW5nW107IHJlbW92ZWQ6IHN0cmluZ1tdOyB1cGRhdGVkOiBzdHJpbmdbXSB9IHtcbiAgICBjb25zdCBvbGRWYXJzTWFwID0gbmV3IE1hcDxzdHJpbmcsIGFueT4oKTtcblxuICAgIG9sZFZhcmlhYmxlcy5mb3JFYWNoKHZhcmlhYmxlID0+IHtcbiAgICAgIGlmIChtZXNzYWdlSWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAodmFyaWFibGUubWVzc2FnZV9pZCA9PT0gbWVzc2FnZUlkKSB7XG4gICAgICAgICAgb2xkVmFyc01hcC5zZXQodmFyaWFibGUubmFtZSwgdmFyaWFibGUudmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodmFyaWFibGUubWVzc2FnZV9pZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgb2xkVmFyc01hcC5zZXQodmFyaWFibGUubmFtZSwgdmFyaWFibGUudmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBvbGRLZXlzID0gbmV3IFNldChvbGRWYXJzTWFwLmtleXMoKSk7XG4gICAgY29uc3QgbmV3S2V5cyA9IG5ldyBTZXQoT2JqZWN0LmtleXMobmV3VmFycykpO1xuXG4gICAgY29uc3QgYWRkZWQgPSBbLi4ubmV3S2V5c10uZmlsdGVyKGtleSA9PiAhb2xkS2V5cy5oYXMoa2V5KSk7XG4gICAgY29uc3QgcmVtb3ZlZCA9IFsuLi5vbGRLZXlzXS5maWx0ZXIoa2V5ID0+ICFuZXdLZXlzLmhhcyhrZXkpKTtcbiAgICBjb25zdCB1cGRhdGVkID0gWy4uLm5ld0tleXNdLmZpbHRlcihrZXkgPT4gb2xkS2V5cy5oYXMoa2V5KSAmJiAhXy5pc0VxdWFsKG9sZFZhcnNNYXAuZ2V0KGtleSksIG5ld1ZhcnNba2V5XSkpO1xuXG4gICAgcmV0dXJuIHsgYWRkZWQsIHJlbW92ZWQsIHVwZGF0ZWQgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIblj5jph4/lt67lvILvvIzmm7TmlrAgRE9NIOWSjOaooeWei1xuICAgKiBAcGFyYW0gYWRkZWQg5paw5aKe55qE5Y+Y6YeP5ZCN5YiX6KGoXG4gICAqIEBwYXJhbSByZW1vdmVkIOWIoOmZpOeahOWPmOmHj+WQjeWIl+ihqFxuICAgKiBAcGFyYW0gdXBkYXRlZCDmm7TmlrDnmoTlj5jph4/lkI3liJfooahcbiAgICogQHBhcmFtIG5ld1RhdmVyblZhcmlhYmxlcyDmlrDnmoTlj5jph4/mlbDmja5cbiAgICogQHBhcmFtIG1lc3NhZ2VJZCDmtojmga9JRFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfcHJvY2Vzc0RpZmYoXG4gICAgYWRkZWQ6IHN0cmluZ1tdLFxuICAgIHJlbW92ZWQ6IHN0cmluZ1tdLFxuICAgIHVwZGF0ZWQ6IHN0cmluZ1tdLFxuICAgIG5ld1RhdmVyblZhcmlhYmxlczogUmVjb3JkPHN0cmluZywgYW55PixcbiAgICBtZXNzYWdlSWQ/OiBudW1iZXIsXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGFkZGVkVmFyaWFibGVzOiBWYXJpYWJsZUl0ZW1bXSA9IFtdO1xuICAgIGNvbnN0IHJlbW92ZWRJZHM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgdXBkYXRlZFZhcmlhYmxlczogVmFyaWFibGVJdGVtW10gPSBbXTtcblxuICAgIGFkZGVkLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICBjb25zdCB2YXJpYWJsZSA9IHRoaXMubW9kZWwuY3JlYXRlVmFyaWFibGVJdGVtKG5hbWUsIG5ld1RhdmVyblZhcmlhYmxlc1tuYW1lXSwgbWVzc2FnZUlkKTtcbiAgICAgIHRoaXMuZG9tVXBkYXRlci5hZGRWYXJpYWJsZUNhcmQodmFyaWFibGUpO1xuICAgICAgYWRkZWRWYXJpYWJsZXMucHVzaCh2YXJpYWJsZSk7XG4gICAgfSk7XG5cbiAgICByZW1vdmVkLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICBjb25zdCB2YXJpYWJsZSA9IHRoaXMubW9kZWwuZmluZFZhcmlhYmxlQnlOYW1lKG5hbWUsIG1lc3NhZ2VJZCk7XG4gICAgICBpZiAodmFyaWFibGUpIHtcbiAgICAgICAgdGhpcy5kb21VcGRhdGVyLnJlbW92ZVZhcmlhYmxlQ2FyZCh2YXJpYWJsZS5pZCk7XG4gICAgICAgIHJlbW92ZWRJZHMucHVzaCh2YXJpYWJsZS5pZCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB1cGRhdGVkLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICBjb25zdCB2YXJpYWJsZSA9IHRoaXMubW9kZWwuZmluZFZhcmlhYmxlQnlOYW1lKG5hbWUsIG1lc3NhZ2VJZCk7XG4gICAgICBpZiAodmFyaWFibGUpIHtcbiAgICAgICAgdmFyaWFibGUudmFsdWUgPSBuZXdUYXZlcm5WYXJpYWJsZXNbbmFtZV07XG4gICAgICAgIHZhcmlhYmxlLmRhdGFUeXBlID0gVmFyaWFibGVNYW5hZ2VyVXRpbC5pbmZlckRhdGFUeXBlKHZhcmlhYmxlLnZhbHVlKTtcbiAgICAgICAgdGhpcy5kb21VcGRhdGVyLnVwZGF0ZVZhcmlhYmxlQ2FyZCh2YXJpYWJsZSk7XG4gICAgICAgIHVwZGF0ZWRWYXJpYWJsZXMucHVzaCh2YXJpYWJsZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLm1vZGVsLnN5bmNDdXJyZW50VmFyaWFibGVzKGFkZGVkVmFyaWFibGVzLCByZW1vdmVkSWRzLCB1cGRhdGVkVmFyaWFibGVzKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/sync.ts\n")},"./src/component/variable_manager/util.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/util.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableManagerUtil: () => (/* binding */ VariableManagerUtil)\n/* harmony export */ });\n/**\n * \n */\nclass VariableManagerUtil {\n    /**\n     * \n     * @param value \n     * @returns \n     */\n    static inferDataType(value) {\n        if (Array.isArray(value)) {\n            return 'array';\n        }\n        else if (typeof value === 'boolean') {\n            return 'boolean';\n        }\n        else if (typeof value === 'number') {\n            return 'number';\n        }\n        else if (typeof value === 'object' && value !== null) {\n            return 'object';\n        }\n        return 'string';\n    }\n    /**\n     * \n     * @param dataType \n     * @returns \n     */\n    static getDefaultValueForType(dataType) {\n        switch (dataType) {\n            case 'string':\n                return '';\n            case 'number':\n                return 0;\n            case 'boolean':\n                return false;\n            case 'array':\n                return [];\n            case 'object':\n                return {};\n            default:\n                return '';\n        }\n    }\n    /**\n     * \n     * @param existingKeys \n     * @param baseName  'newKey'\n     * @returns \n     */\n    static generateUniqueKey(existingKeys, baseName = 'newKey') {\n        let newKey = baseName;\n        let counter = 1;\n        while (existingKeys.has(newKey)) {\n            newKey = `${baseName}${counter}`;\n            counter++;\n        }\n        return newKey;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBRUE7O0dBRUc7QUFDSSxNQUFNLG1CQUFtQjtJQUM5Qjs7OztPQUlHO0lBQ0ksTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFVO1FBQ3BDLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQ3pCLE9BQU8sT0FBTyxDQUFDO1FBQ2pCLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFNBQVMsRUFBRSxDQUFDO1lBQ3RDLE9BQU8sU0FBUyxDQUFDO1FBQ25CLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRSxDQUFDO1lBQ3JDLE9BQU8sUUFBUSxDQUFDO1FBQ2xCLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsSUFBSSxLQUFLLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDdkQsT0FBTyxRQUFRLENBQUM7UUFDbEIsQ0FBQztRQUNELE9BQU8sUUFBUSxDQUFDO0lBQ2xCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksTUFBTSxDQUFDLHNCQUFzQixDQUFDLFFBQTBCO1FBQzdELFFBQVEsUUFBUSxFQUFFLENBQUM7WUFDakIsS0FBSyxRQUFRO2dCQUNYLE9BQU8sRUFBRSxDQUFDO1lBQ1osS0FBSyxRQUFRO2dCQUNYLE9BQU8sQ0FBQyxDQUFDO1lBQ1gsS0FBSyxTQUFTO2dCQUNaLE9BQU8sS0FBSyxDQUFDO1lBQ2YsS0FBSyxPQUFPO2dCQUNWLE9BQU8sRUFBRSxDQUFDO1lBQ1osS0FBSyxRQUFRO2dCQUNYLE9BQU8sRUFBRSxDQUFDO1lBQ1o7Z0JBQ0UsT0FBTyxFQUFFLENBQUM7UUFDZCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLGlCQUFpQixDQUFDLFlBQXlCLEVBQUUsV0FBbUIsUUFBUTtRQUNwRixJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUM7UUFDdEIsSUFBSSxPQUFPLEdBQUcsQ0FBQyxDQUFDO1FBQ2hCLE9BQU8sWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO1lBQ2hDLE1BQU0sR0FBRyxHQUFHLFFBQVEsR0FBRyxPQUFPLEVBQUUsQ0FBQztZQUNqQyxPQUFPLEVBQUUsQ0FBQztRQUNaLENBQUM7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbC50cz81ZWQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZhcmlhYmxlRGF0YVR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3R5cGVzJztcblxuLyoqXG4gKiDlj5jph4/nrqHnkIblmajpgJrnlKjlt6XlhbfnsbtcbiAqL1xuZXhwb3J0IGNsYXNzIFZhcmlhYmxlTWFuYWdlclV0aWwge1xuICAvKipcbiAgICog5LuO5YC85o6o5pat5Y+Y6YeP5pWw5o2u57G75Z6LXG4gICAqIEBwYXJhbSB2YWx1ZSDopoHmjqjmlq3nsbvlnovnmoTlgLxcbiAgICogQHJldHVybnMg5o6o5pat5Ye655qE5Y+Y6YeP5pWw5o2u57G75Z6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGluZmVyRGF0YVR5cGUodmFsdWU6IGFueSk6IFZhcmlhYmxlRGF0YVR5cGUge1xuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgcmV0dXJuICdhcnJheSc7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJykge1xuICAgICAgcmV0dXJuICdib29sZWFuJztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiAnbnVtYmVyJztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiAnb2JqZWN0JztcbiAgICB9XG4gICAgcmV0dXJuICdzdHJpbmcnO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaVsOaNruexu+Wei+eahOm7mOiupOWAvFxuICAgKiBAcGFyYW0gZGF0YVR5cGUg5pWw5o2u57G75Z6LXG4gICAqIEByZXR1cm5zIOm7mOiupOWAvFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZXREZWZhdWx0VmFsdWVGb3JUeXBlKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKTogYW55IHtcbiAgICBzd2l0Y2ggKGRhdGFUeXBlKSB7XG4gICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICByZXR1cm4gJyc7XG4gICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICByZXR1cm4gMDtcbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICBjYXNlICdhcnJheSc6XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgIHJldHVybiB7fTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog55Sf5oiQ5ZSv5LiA55qE6ZSu5ZCNXG4gICAqIEBwYXJhbSBleGlzdGluZ0tleXMg5bey5a2Y5Zyo55qE6ZSu5ZCN6ZuG5ZCIXG4gICAqIEBwYXJhbSBiYXNlTmFtZSDln7rnoYDplK7lkI3vvIzpu5jorqTkuLogJ25ld0tleSdcbiAgICogQHJldHVybnMg5ZSv5LiA6ZSu5ZCNXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdlbmVyYXRlVW5pcXVlS2V5KGV4aXN0aW5nS2V5czogU2V0PHN0cmluZz4sIGJhc2VOYW1lOiBzdHJpbmcgPSAnbmV3S2V5Jyk6IHN0cmluZyB7XG4gICAgbGV0IG5ld0tleSA9IGJhc2VOYW1lO1xuICAgIGxldCBjb3VudGVyID0gMTtcbiAgICB3aGlsZSAoZXhpc3RpbmdLZXlzLmhhcyhuZXdLZXkpKSB7XG4gICAgICBuZXdLZXkgPSBgJHtiYXNlTmFtZX0ke2NvdW50ZXJ9YDtcbiAgICAgIGNvdW50ZXIrKztcbiAgICB9XG4gICAgcmV0dXJuIG5ld0tleTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/util.ts\n")},"./src/component/variable_manager/view.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/view.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableView: () => (/* binding */ VariableView)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/RossAscends-mods */ \"@sillytavern/scripts/RossAscends-mods\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var _component_variable_manager_card__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/variable_manager/card */ \"./src/component/variable_manager/card.ts\");\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _function_util__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/function/util */ \"./src/function/util.ts\");\n\n\n\n\n\n\nclass VariableView {\n    /**\n     * \n     */\n    static MIN_DIALOG_WIDTH = 300;\n    /**\n     * \n     */\n    static MIN_DIALOG_HEIGHT = 250;\n    /**\n     * UI\n     */\n    container;\n    /**\n     * \n     */\n    cardFactory;\n    /**\n     * \n     */\n    dialog = null;\n    /**\n     * \n     */\n    controller = null;\n    /**\n     * @param container \n     */\n    constructor(container) {\n        this.container = container;\n        this.cardFactory = new _component_variable_manager_card__WEBPACK_IMPORTED_MODULE_3__.VariableCardFactory(this.showVariableTypeDialog.bind(this));\n    }\n    /**\n     * \n     * @param controller \n     */\n    setController(controller) {\n        this.controller = controller;\n    }\n    /**\n     * UI\n     */\n    initUI() {\n        this.container.find('#global-tab').addClass('active');\n        this.container.find('#global-content').addClass('active');\n        // \n        this.container.find('#floor-filter-container').hide();\n        this.initSortable();\n        this.initFloorFilter();\n    }\n    /**\n     * \n     */\n    initSortable() {\n        this.container.find('.list-items-container').sortable({\n            delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__.getSortableDelay)(),\n            handle: '.drag-handle',\n            stop: function (_event, ui) {\n                const listContainer = $(ui.item).closest('.list-items-container');\n                const items = [];\n                listContainer.find('.variable-content-input').each(function () {\n                    items.push($(this).val());\n                });\n                const processedItems = _.uniqBy(items, item => item.trim().toLowerCase());\n                if (!_.isEqual(items, processedItems)) {\n                    listContainer.empty();\n                    processedItems.forEach(item => {\n                        const itemHtml = `\n              <div class=\"list-item\">\n                <span class=\"drag-handle\"></span>\n                <textarea class=\"variable-content-input\">${item}</textarea>\n                <button class=\"list-item-delete\"><i class=\"fa-solid fa-times\"></i></button>\n              </div>\n            `;\n                        listContainer.append(itemHtml);\n                    });\n                }\n                listContainer.trigger('sortupdate');\n            },\n        });\n    }\n    /**\n     * \n     */\n    initFloorFilter() {\n        this.container.find('#floor-filter-btn').on('click', () => {\n            const minInput = this.container.find('#floor-min').val();\n            const maxInput = this.container.find('#floor-max').val();\n            // \n            const minVal = minInput.trim() ? parseInt(minInput, 10) : null;\n            const maxVal = maxInput.trim() ? parseInt(maxInput, 10) : null;\n            // \n            if ((minInput.trim() && isNaN(minVal)) || (maxInput.trim() && isNaN(maxVal))) {\n                this.showFloorFilterError('');\n                return;\n            }\n            // 0\n            if (minVal !== null && minVal < 0) {\n                this.showFloorFilterError('0');\n                return;\n            }\n            if (maxVal !== null && maxVal < 0) {\n                this.showFloorFilterError('0');\n                return;\n            }\n            // \n            if (minVal !== null && maxVal !== null && maxVal < minVal) {\n                this.showFloorFilterError('');\n                return;\n            }\n            // \n            if (minVal === null && maxVal === null) {\n                this.showFloorFilterError('');\n                return;\n            }\n            this.hideFloorFilterError();\n        });\n        this.container.find('#floor-min, #floor-max').on('input', () => {\n            const minInput = this.container.find('#floor-min').val();\n            const maxInput = this.container.find('#floor-max').val();\n            const minVal = minInput.trim() ? parseInt(minInput, 10) : null;\n            const maxVal = maxInput.trim() ? parseInt(maxInput, 10) : null;\n            // 0\n            if (minVal !== null && minVal < 0) {\n                this.showFloorFilterError('0');\n                return;\n            }\n            if (maxVal !== null && maxVal < 0) {\n                this.showFloorFilterError('0');\n                return;\n            }\n            // \n            if (minVal !== null && maxVal !== null && !isNaN(minVal) && !isNaN(maxVal) && maxVal < minVal) {\n                this.showFloorFilterError('');\n            }\n            else {\n                this.hideFloorFilterError();\n            }\n        });\n    }\n    /**\n     * \n     * @param message \n     */\n    showFloorFilterError(message) {\n        const $errorEl = this.container.find('#floor-filter-error');\n        $errorEl.text(message).show();\n    }\n    /**\n     * \n     */\n    hideFloorFilterError() {\n        this.container.find('#floor-filter-error').hide();\n    }\n    /**\n     * \n     * @param min \n     * @param max \n     */\n    updateFloorRangeInputs(min, max) {\n        this.container.find('#floor-min').val(min !== null ? min.toString() : '');\n        this.container.find('#floor-max').val(max !== null ? max.toString() : '');\n        this.hideFloorFilterError();\n    }\n    /**\n     * \n     * @returns \n     */\n    getActiveVariableType() {\n        return this.container.find('.tab-item.active').attr('id')?.replace('-tab', '') || 'chat';\n    }\n    /**\n     * \n     * @param type \n     */\n    setActiveTab(type) {\n        this.container.find('.tab-item').removeClass('active');\n        this.container.find('.tab-content').removeClass('active');\n        this.container.find(`#${type}-tab`).addClass('active');\n        this.container.find(`#${type}-content`).addClass('active');\n        const $floorFilterContainer = this.container.find('#floor-filter-container');\n        if (type === 'message') {\n            $floorFilterContainer.show();\n            const [minFloor, maxFloor] = this.getFloorRange();\n            // \n            if (minFloor === null && maxFloor === null) {\n                const lastMessageId = (0,_function_util__WEBPACK_IMPORTED_MODULE_5__.getLastMessageId)();\n                const newMinFloor = Math.max(0, lastMessageId - 4);\n                const newMaxFloor = lastMessageId;\n                this.controller.model.updateFloorRange(newMinFloor, newMaxFloor);\n                this.updateFloorRangeInputs(newMinFloor, newMaxFloor);\n            }\n        }\n        else {\n            $floorFilterContainer.hide();\n        }\n    }\n    getFloorRange() {\n        const minVal = this.container.find('#floor-min').val();\n        const maxVal = this.container.find('#floor-max').val();\n        let minFloor = minVal && minVal.trim() ? parseInt(minVal, 10) : null;\n        let maxFloor = maxVal && maxVal.trim() ? parseInt(maxVal, 10) : null;\n        // 0\n        if (minFloor !== null) {\n            minFloor = Math.max(0, minFloor);\n        }\n        if (maxFloor !== null) {\n            maxFloor = Math.max(0, maxFloor);\n        }\n        return [\n            minFloor !== null && !isNaN(minFloor) ? minFloor : null,\n            maxFloor !== null && !isNaN(maxFloor) ? maxFloor : null,\n        ];\n    }\n    /**\n     * \n     * @param type \n     * @param variables \n     */\n    refreshVariableCards(type, variables) {\n        // \n        this.container.find('.variable-type-label').text(`${type}`);\n        // \n        const activeContent = this.container.find(`#${type}-content`);\n        const $variableList = activeContent.find('.variable-list');\n        const scrollTop = $variableList.scrollTop() || 0;\n        $variableList.empty();\n        if (variables.length === 0) {\n            $variableList.html('<div class=\"empty-state\"><p></p></div>');\n            return;\n        }\n        // \n        if (type === 'message') {\n            this.renderMessageVariablesByFloor($variableList, variables);\n            $variableList.scrollTop(scrollTop);\n        }\n        else {\n            for (const variable of variables) {\n                const card = this.cardFactory.createCard(variable);\n                $variableList.append(card);\n            }\n            $variableList.scrollTop(scrollTop);\n        }\n    }\n    /**\n     * \n     * @param filterState \n     * @param searchKeyword \n     */\n    applyClientSideFilters(filterState, searchKeyword) {\n        const activeType = this.getActiveVariableType();\n        const $variableCards = this.container.find(`#${activeType}-content .variable-card`);\n        let visibleCount = 0;\n        $variableCards.each((_, card) => {\n            const $card = $(card);\n            const cardType = $card.attr('data-type');\n            const cardName = $card.find('.variable-title').val() || '';\n            const typeVisible = filterState[cardType];\n            const keywordVisible = !searchKeyword || cardName.toLowerCase().includes(searchKeyword.toLowerCase());\n            if (typeVisible && keywordVisible) {\n                $card.show();\n                visibleCount++;\n            }\n            else {\n                $card.hide();\n            }\n        });\n        // \n        this.updateFilterEmptyState(activeType, visibleCount);\n    }\n    /**\n     * \n     * @param type \n     * @param visibleCount \n     */\n    updateFilterEmptyState(type, visibleCount) {\n        const $variableList = this.container.find(`#${type}-content .variable-list`);\n        const $existingEmptyState = $variableList.find('.filter-empty-state');\n        if (visibleCount === 0) {\n            // \n            const totalCards = $variableList.find('.variable-card').length;\n            if (totalCards > 0) {\n                if ($existingEmptyState.length === 0) {\n                    $variableList.append('<div class=\"filter-empty-state\"><p></p></div>');\n                }\n            }\n        }\n        else {\n            $existingEmptyState.remove();\n        }\n    }\n    /**\n     * message\n     * @param container \n     * @param variables \n     */\n    renderMessageVariablesByFloor(container, variables) {\n        // \n        const floorGroups = new Map();\n        for (const variable of variables) {\n            if (variable.message_id !== undefined) {\n                if (!floorGroups.has(variable.message_id)) {\n                    floorGroups.set(variable.message_id, []);\n                }\n                floorGroups.get(variable.message_id).push(variable);\n            }\n        }\n        const sortedFloors = Array.from(floorGroups.keys()).sort((a, b) => b - a); // \n        for (let i = 0; i < sortedFloors.length; i++) {\n            const floor = sortedFloors[i];\n            const floorVariables = floorGroups.get(floor);\n            const isExpanded = i === 0; // \n            const $panel = this.createFloorPanel(floor, isExpanded);\n            const $panelBody = $panel.find('.floor-panel-body');\n            for (const variable of floorVariables) {\n                const card = this.cardFactory.createCard(variable);\n                card.attr('data-floor-id', floor.toString());\n                $panelBody.append(card);\n            }\n            container.append($panel);\n        }\n    }\n    /**\n     * \n     * @param floor \n     * @param isExpanded \n     * @returns jQuery\n     */\n    createFloorPanel(floor, isExpanded) {\n        const titleContent = `# ${floor} `;\n        const $panel = $(`\n      <div class=\"floor-panel\" data-floor=\"${floor}\">\n        <div class=\"floor-panel-header flex spaceBetween alignItemsCenter\">\n          <div class=\"floor-panel-title\">${titleContent}</div>\n          <div class=\"floor-panel-icon ${isExpanded ? 'expanded' : ''}\">\n            <i class=\"fa-solid fa-chevron-down\"></i>\n          </div>\n        </div>\n        <div class=\"floor-panel-body ${isExpanded ? 'expanded' : ''}\"></div>\n      </div>\n    `);\n        $panel.find('.floor-panel-header').on('click', function () {\n            const $this = $(this);\n            const $icon = $this.find('.floor-panel-icon');\n            const $body = $this.closest('.floor-panel').find('.floor-panel-body');\n            $icon.toggleClass('expanded');\n            $body.toggleClass('expanded');\n        });\n        return $panel;\n    }\n    /**\n     * \n     * @param type \n     * @param dataType \n     * @param floorId ID(message)\n     */\n    addNewVariableCard(type, dataType, floorId) {\n        const $content = this.container.find(`#${type}-content`).find('.variable-list');\n        $content.find('.empty-state').remove();\n        const defaultVariable = {\n            name: 'new_variable',\n            value: _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_4__.VariableManagerUtil.getDefaultValueForType(dataType),\n            dataType: dataType,\n            id: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__.uuidv4)(),\n        };\n        const newCard = this.cardFactory.createCard(defaultVariable);\n        newCard.attr('data-type', dataType);\n        if (type === 'message' && floorId !== undefined) {\n            this.addCardToFloorPanel($content, newCard, floorId);\n        }\n        else {\n            $content.prepend(newCard);\n            this.addAnimation(newCard, 'variable-added', () => { });\n        }\n    }\n    /**\n     * \n     * @param content \n     * @param card \n     * @param floorId ID\n     */\n    addCardToFloorPanel(content, card, floorId) {\n        let $floorPanel = content.find(`.floor-panel[data-floor=\"${floorId}\"]`);\n        if ($floorPanel.length === 0) {\n            const $panel = this.createFloorPanel(floorId, true);\n            this.insertFloorPanelInOrder(content, $panel, floorId);\n            $floorPanel = $panel;\n        }\n        const $panelBody = $floorPanel.find('.floor-panel-body');\n        if (!$panelBody.hasClass('expanded')) {\n            $floorPanel.find('.floor-panel-icon').addClass('expanded');\n            $panelBody.addClass('expanded');\n        }\n        card.attr('data-floor-id', floorId.toString());\n        $panelBody.prepend(card);\n        this.addAnimation(card, 'variable-added', () => { });\n    }\n    /**\n     * \n     * @param content \n     * @param panel \n     * @param floorId ID\n     */\n    insertFloorPanelInOrder(content, panel, floorId) {\n        let inserted = false;\n        content.find('.floor-panel').each(function () {\n            const existingFloor = parseInt($(this).attr('data-floor') || '0');\n            if (floorId > existingFloor) {\n                $(this).before(panel);\n                inserted = true;\n                return false;\n            }\n            return undefined;\n        });\n        if (!inserted) {\n            content.prepend(panel);\n        }\n    }\n    /**\n     * \n     * @param card \n     * @returns \n     */\n    getVariableFromCard(card) {\n        return this.cardFactory.getVariableFromCard(card);\n    }\n    /**\n     * \n     * @param card \n     * @returns \n     */\n    getVariableCardName(card) {\n        const variable = this.getVariableFromCard(card);\n        return variable?.name || '';\n    }\n    /**\n     * \n     * @param callback \n     */\n    async showAddVariableDialog(callback) {\n        const currentType = this.getActiveVariableType();\n        if (currentType === 'message') {\n            await this.showFloorInputDialog(async (floorId) => {\n                if (floorId === null)\n                    return;\n                await this.showVariableTypeDialog(dataType => {\n                    callback(dataType, floorId);\n                });\n            });\n            return;\n        }\n        await this.showVariableTypeDialog(dataType => {\n            callback(dataType);\n        });\n    }\n    /**\n     * \n     * @param callback \n     */\n    async showFloorInputDialog(callback) {\n        const content = $(`\n      <div>\n        <h3></h3>\n        <div class=\"floor-input-dialog\">\n          <input type=\"number\" id=\"floor-input\" min=\"0\" placeholder=\"\" />\n          <div id=\"floor-input-error\" class=\"floor-filter-error\" style=\"display: none\"></div>\n        </div>\n      </div>\n    `);\n        const $inputField = content.find('#floor-input');\n        const $errorMsg = content.find('#floor-input-error');\n        const lastMessageId = (0,_function_util__WEBPACK_IMPORTED_MODULE_5__.getLastMessageId)();\n        if (lastMessageId >= 0) {\n            $inputField.val(lastMessageId);\n        }\n        // \n        $inputField.on('input', function () {\n            const value = parseInt($(this).val(), 10);\n            if ($(this).val() && (isNaN(value) || value < 0)) {\n                $errorMsg.text('0').show();\n            }\n            else {\n                $errorMsg.hide();\n            }\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_0__.callGenericPopup)(content, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_0__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '',\n            cancelButton: '',\n        });\n        if (!result) {\n            callback(null);\n            return;\n        }\n        const inputValue = $inputField.val();\n        const floorId = parseInt(inputValue, 10);\n        if (!inputValue.trim() || isNaN(floorId)) {\n            $errorMsg.text('').show();\n            setTimeout(() => this.showFloorInputDialog(callback), 100);\n            return;\n        }\n        if (floorId < 0) {\n            $errorMsg.text('0').show();\n            setTimeout(() => this.showFloorInputDialog(callback), 100);\n            return;\n        }\n        callback(floorId);\n    }\n    /**\n     * \n     * @param callback \n     * @param floorId ID(message)\n     */\n    async showVariableTypeDialog(callback) {\n        const content = $(`\n      <div>\n        <h3></h3>\n        <div class=\"variable-type-options\">\n          <div data-type=\"string\"><i class=\"fa-regular fa-font\"></i> </div>\n          <div data-type=\"number\"><i class=\"fa-regular fa-hashtag\"></i> </div>\n          <div data-type=\"boolean\"><i class=\"fa-regular fa-toggle-on\"></i> </div>\n          <div data-type=\"array\"><i class=\"fa-regular fa-list\"></i> </div>\n          <div data-type=\"object\"><i class=\"fa-regular fa-code\"></i> </div>\n        </div>\n      </div>\n    `);\n        content.find('.variable-type-options div').on('click', function () {\n            const dataType = $(this).attr('data-type');\n            callback(dataType);\n            $('.popup').find('.popup-button-close').trigger('click');\n        });\n        await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_0__.callGenericPopup)(content, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_0__.POPUP_TYPE.DISPLAY);\n    }\n    /**\n     * \n     * @param message \n     * @param callback \n     */\n    async showConfirmDialog(message, callback) {\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_0__.callGenericPopup)(message, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_0__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '',\n            cancelButton: '',\n        });\n        callback(!!result);\n    }\n    /**\n     * \n     * \n     */\n    render() {\n        this.unrender();\n        this.dialog = $(`\n      <div class=\"variable-manager-dialog\">\n        <div class=\"dialog-header\">\n          <div class=\"dialog-title\"></div>\n          <div class=\"dialog-controls\">\n            <button class=\"dialog-toggle-btn\" title=\"/\"><i class=\"fa-solid fa-chevron-up\"></i></button>\n            <button class=\"dialog-close-btn\"><i class=\"fa-solid fa-times\"></i></button>\n          </div>\n        </div>\n        <div class=\"dialog-content\"></div>\n        <div class=\"dialog-resize-handle\"></div>\n      </div>\n    `);\n        this.dialog.find('.dialog-content').append(this.container);\n        this.dialog.find('.dialog-close-btn').on('click', () => {\n            this.unrender();\n        });\n        this.dialog.find('.dialog-toggle-btn').on('click', () => {\n            const $content = this.dialog.find('.dialog-content');\n            const $toggleBtn = this.dialog.find('.dialog-toggle-btn i');\n            $content.slideToggle(300, () => {\n                if ($content.is(':visible')) {\n                    $toggleBtn.removeClass('fa-chevron-down').addClass('fa-chevron-up');\n                    this.dialog.find('.dialog-resize-handle').show();\n                }\n                else {\n                    $toggleBtn.removeClass('fa-chevron-up').addClass('fa-chevron-down');\n                    this.dialog.find('.dialog-resize-handle').hide();\n                }\n            });\n            this.dialog.toggleClass('content-collapsed');\n        });\n        $('body').append(this.dialog);\n        this.initDraggableDialog();\n        this.centerDialog();\n        this.container.show();\n    }\n    /**\n     * \n     */\n    unrender() {\n        if (this.dialog) {\n            this.container.detach();\n            this.dialog.remove();\n            this.dialog = null;\n            if (this.controller) {\n                this.controller.cleanup();\n            }\n        }\n    }\n    /**\n     * \n     */\n    initDraggableDialog() {\n        if (!this.dialog)\n            return;\n        const isMobileDevice = (0,_sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_1__.isMobile)();\n        this.dialog.draggable({\n            handle: '.dialog-header',\n            containment: 'window',\n            start: () => {\n                this.dialog?.addClass('dragging');\n            },\n            stop: () => {\n                this.dialog?.removeClass('dragging');\n            },\n        });\n        this.dialog.resizable({\n            // \n            handles: isMobileDevice ? 'se' : 'n,e,s,w,ne,se,sw,nw',\n            minHeight: VariableView.MIN_DIALOG_HEIGHT,\n            minWidth: VariableView.MIN_DIALOG_WIDTH,\n            start: () => {\n                this.dialog?.addClass('resizing');\n            },\n            stop: () => {\n                this.dialog?.removeClass('resizing');\n            },\n        });\n        this.dialog.find('.dialog-resize-handle').toggle(isMobileDevice);\n    }\n    /**\n     * \n     */\n    centerDialog() {\n        if (!this.dialog)\n            return;\n        const windowWidth = $(window).width() || 0;\n        const windowHeight = $(window).height() || 0;\n        const dialogWidth = this.dialog.outerWidth() || VariableView.MIN_DIALOG_WIDTH;\n        const dialogHeight = this.dialog.outerHeight() || VariableView.MIN_DIALOG_HEIGHT;\n        const left = Math.max(0, (windowWidth - dialogWidth) / 2);\n        const top = Math.max(0, (windowHeight - dialogHeight) / 2);\n        this.dialog.css({\n            left: `${left}px`,\n            top: `${top}px`,\n            position: 'fixed',\n        });\n    }\n    addVariableCard(variable) {\n        try {\n            const newCard = this.cardFactory.createCard(variable);\n            newCard.attr('data-type', variable.dataType);\n            const activeType = this.getActiveVariableType();\n            const $variableList = this.container.find(`#${activeType}-content .variable-list`);\n            if (activeType === 'message' && variable.message_id !== undefined) {\n                this.addCardToFloorPanel($variableList, newCard, variable.message_id);\n            }\n            else {\n                $variableList.find('.empty-state').remove();\n                $variableList.append(newCard);\n                this.addAnimation(newCard, 'variable-added', () => { });\n            }\n        }\n        catch (error) {\n            console.error(`[VariableManager] \"${variable.name}\":`, error);\n        }\n    }\n    /**\n     * \n     * @param variable_id ID\n     */\n    removeVariableCard(variable_id) {\n        try {\n            if (!variable_id) {\n                console.warn(`[VariableManager] ID`);\n                return;\n            }\n            const $card = this.container.find(`.variable-card[data-variable-id=\"${variable_id}\"]`);\n            if ($card.length === 0) {\n                console.warn(`[VariableManager] ID\"${variable_id}\"`);\n                return;\n            }\n            this.addAnimation($card, 'variable-deleted', () => {\n                $card.remove();\n                this.checkAndShowEmptyState();\n            });\n        }\n        catch (error) {\n            console.error(`[VariableManager] :`, error);\n        }\n    }\n    /**\n     * \n     */\n    checkAndShowEmptyState() {\n        const activeType = this.getActiveVariableType();\n        const $variableList = this.container.find(`#${activeType}-content .variable-list`);\n        if ($variableList.find('.variable-card').length === 0) {\n            $variableList.html('<div class=\"empty-state\"><p></p></div>');\n        }\n    }\n    /**\n     * \n     * @param variable \n     */\n    updateVariableCard(variable) {\n        try {\n            const $card = this.container.find(`.variable-card[data-variable-id=\"${variable.id}\"]`);\n            if ($card.length === 0) {\n                console.warn(`[VariableManager] ID\"${variable.id}\"`);\n                return;\n            }\n            // \n            const newCard = this.cardFactory.createCard(variable);\n            newCard.attr('data-type', variable.dataType);\n            if (variable.message_id !== undefined) {\n                newCard.attr('data-floor-id', variable.message_id.toString());\n            }\n            $card.replaceWith(newCard);\n            this.addAnimation(newCard, 'variable-changed', () => { });\n        }\n        catch (error) {\n            console.error(`[VariableManager] :`, error);\n        }\n    }\n    /**\n     * \n     * @param callback \n     */\n    async showKeyNameInputDialog(callback) {\n        const content = $(`\n      <div>\n        <h3></h3>\n        <div class=\"key-input-dialog\">\n          <input type=\"text\" id=\"key-input\" placeholder=\"\" />\n          <div id=\"key-input-error\" class=\"input-error\" style=\"display: none\"></div>\n        </div>\n      </div>\n    `);\n        const $inputField = content.find('#key-input');\n        const $errorMsg = content.find('#key-input-error');\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_0__.callGenericPopup)(content, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_0__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '',\n            cancelButton: '',\n        });\n        if (!result) {\n            callback(null);\n            return;\n        }\n        const keyName = $inputField.val();\n        if (!keyName || keyName.trim() === '') {\n            $errorMsg.show();\n            setTimeout(() => this.showKeyNameInputDialog(callback), 10);\n            return;\n        }\n        callback(keyName.trim());\n    }\n    /**\n     * \n     * @param element \n     * @param animationClass CSS\n     * @param callback \n     */\n    addAnimation(element, animationClass, callback) {\n        const namespace = `animation.${animationClass}`;\n        element.addClass(animationClass);\n        void element[0].offsetHeight;\n        element.off(`animationend.${namespace}`);\n        element.on(`animationend.${namespace}`, function () {\n            $(this).off(`animationend.${namespace}`);\n            $(this).removeClass(animationClass);\n            callback();\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdmlldy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQTBFO0FBQ1Q7QUFDSztBQUVFO0FBR0E7QUFDckI7QUFNNUMsTUFBTSxZQUFZO0lBQ3ZCOztPQUVHO0lBQ0ssTUFBTSxDQUFVLGdCQUFnQixHQUFHLEdBQUcsQ0FBQztJQUUvQzs7T0FFRztJQUNLLE1BQU0sQ0FBVSxpQkFBaUIsR0FBRyxHQUFHLENBQUM7SUFFaEQ7O09BRUc7SUFDSSxTQUFTLENBQXNCO0lBRXRDOztPQUVHO0lBQ0ksV0FBVyxDQUFzQjtJQUV4Qzs7T0FFRztJQUNLLE1BQU0sR0FBK0IsSUFBSSxDQUFDO0lBRWxEOztPQUVHO0lBQ0ssVUFBVSxHQUF1QixJQUFJLENBQUM7SUFFOUM7O09BRUc7SUFDSCxZQUFZLFNBQThCO1FBQ3hDLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxpRkFBbUIsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDckYsQ0FBQztJQUVEOzs7T0FHRztJQUNJLGFBQWEsQ0FBQyxVQUF1QjtRQUMxQyxJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztJQUMvQixDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNO1FBQ1gsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3RELElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTFELDRCQUE0QjtRQUM1QixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO1FBRXRELElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztR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O1FBQ2IsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3ZpZXcudHM/NWRiNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQT1BVUF9UWVBFLCBjYWxsR2VuZXJpY1BvcHVwIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG9wdXAnO1xuaW1wb3J0IHsgaXNNb2JpbGUgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9Sb3NzQXNjZW5kcy1tb2RzJztcbmltcG9ydCB7IGdldFNvcnRhYmxlRGVsYXksIHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuaW1wb3J0IHsgVmFyaWFibGVDYXJkRmFjdG9yeSB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvY2FyZCc7XG5pbXBvcnQgeyBJRG9tVXBkYXRlciB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvc3luYyc7XG5pbXBvcnQgeyBWYXJpYWJsZURhdGFUeXBlLCBWYXJpYWJsZUl0ZW0sIFZhcmlhYmxlVHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdHlwZXMnO1xuaW1wb3J0IHsgVmFyaWFibGVNYW5hZ2VyVXRpbCB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbCc7XG5pbXBvcnQgeyBnZXRMYXN0TWVzc2FnZUlkIH0gZnJvbSAnQC9mdW5jdGlvbi91dGlsJztcblxuZXhwb3J0IGludGVyZmFjZSBJQ29udHJvbGxlciB7XG4gIGNsZWFudXAoKTogdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlVmlldyBpbXBsZW1lbnRzIElEb21VcGRhdGVyIHtcbiAgLyoqXG4gICAqIOacgOWwj+a1rueql+WuveW6pu+8iOWDj+e0oO+8iVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTUlOX0RJQUxPR19XSURUSCA9IDMwMDtcblxuICAvKipcbiAgICog5pyA5bCP5rWu56qX6auY5bqm77yI5YOP57Sg77yJXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBNSU5fRElBTE9HX0hFSUdIVCA9IDI1MDtcblxuICAvKipcbiAgICogVUnlrrnlmahcbiAgICovXG4gIHB1YmxpYyBjb250YWluZXI6IEpRdWVyeTxIVE1MRWxlbWVudD47XG5cbiAgLyoqXG4gICAqIOWPmOmHj+WNoeeJh1xuICAgKi9cbiAgcHVibGljIGNhcmRGYWN0b3J5OiBWYXJpYWJsZUNhcmRGYWN0b3J5O1xuXG4gIC8qKlxuICAgKiDmta7nqpflhYPntKBcbiAgICovXG4gIHByaXZhdGUgZGlhbG9nOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHwgbnVsbCA9IG51bGw7XG5cbiAgLyoqXG4gICAqIOaOp+WItuWZqOW8leeUqFxuICAgKi9cbiAgcHJpdmF0ZSBjb250cm9sbGVyOiBJQ29udHJvbGxlciB8IG51bGwgPSBudWxsO1xuXG4gIC8qKlxuICAgKiBAcGFyYW0gY29udGFpbmVyIOWPmOmHj+euoeeQhuWZqOWuueWZqFxuICAgKi9cbiAgY29uc3RydWN0b3IoY29udGFpbmVyOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KSB7XG4gICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgdGhpcy5jYXJkRmFjdG9yeSA9IG5ldyBWYXJpYWJsZUNhcmRGYWN0b3J5KHRoaXMuc2hvd1ZhcmlhYmxlVHlwZURpYWxvZy5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7mjqfliLblmajlvJXnlKhcbiAgICogQHBhcmFtIGNvbnRyb2xsZXIg5Y+Y6YeP5o6n5Yi25ZmoXG4gICAqL1xuICBwdWJsaWMgc2V0Q29udHJvbGxlcihjb250cm9sbGVyOiBJQ29udHJvbGxlcik6IHZvaWQge1xuICAgIHRoaXMuY29udHJvbGxlciA9IGNvbnRyb2xsZXI7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyWVUlcbiAgICovXG4gIHB1YmxpYyBpbml0VUkoKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnI2dsb2JhbC10YWInKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnI2dsb2JhbC1jb250ZW50JykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgLy8g5Yid5aeL5YyW5pe26ZqQ6JeP5qW85bGC562b6YCJ5o6n5Lu277yI5LuF5Zyo5raI5oGv5qCH562+6aG15pe25omN5pi+56S677yJXG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLWZpbHRlci1jb250YWluZXInKS5oaWRlKCk7XG5cbiAgICB0aGlzLmluaXRTb3J0YWJsZSgpO1xuICAgIHRoaXMuaW5pdEZsb29yRmlsdGVyKCk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5Y+v5o6S5bqP5Yqf6IO9XG4gICAqL1xuICBwcml2YXRlIGluaXRTb3J0YWJsZSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcubGlzdC1pdGVtcy1jb250YWluZXInKS5zb3J0YWJsZSh7XG4gICAgICBkZWxheTogZ2V0U29ydGFibGVEZWxheSgpLFxuICAgICAgaGFuZGxlOiAnLmRyYWctaGFuZGxlJyxcbiAgICAgIHN0b3A6IGZ1bmN0aW9uIChfZXZlbnQsIHVpKSB7XG4gICAgICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSAkKHVpLml0ZW0pLmNsb3Nlc3QoJy5saXN0LWl0ZW1zLWNvbnRhaW5lcicpO1xuXG4gICAgICAgIGNvbnN0IGl0ZW1zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBsaXN0Q29udGFpbmVyLmZpbmQoJy52YXJpYWJsZS1jb250ZW50LWlucHV0JykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaXRlbXMucHVzaCgkKHRoaXMpLnZhbCgpIGFzIHN0cmluZyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHByb2Nlc3NlZEl0ZW1zID0gXy51bmlxQnkoaXRlbXMsIGl0ZW0gPT4gaXRlbS50cmltKCkudG9Mb3dlckNhc2UoKSk7XG5cbiAgICAgICAgaWYgKCFfLmlzRXF1YWwoaXRlbXMsIHByb2Nlc3NlZEl0ZW1zKSkge1xuICAgICAgICAgIGxpc3RDb250YWluZXIuZW1wdHkoKTtcbiAgICAgICAgICBwcm9jZXNzZWRJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgY29uc3QgaXRlbUh0bWwgPSBgXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaXN0LWl0ZW1cIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImRyYWctaGFuZGxlXCI+4piwPC9zcGFuPlxuICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz1cInZhcmlhYmxlLWNvbnRlbnQtaW5wdXRcIj4ke2l0ZW19PC90ZXh0YXJlYT5cbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwibGlzdC1pdGVtLWRlbGV0ZVwiPjxpIGNsYXNzPVwiZmEtc29saWQgZmEtdGltZXNcIj48L2k+PC9idXR0b24+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIGxpc3RDb250YWluZXIuYXBwZW5kKGl0ZW1IdG1sKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxpc3RDb250YWluZXIudHJpZ2dlcignc29ydHVwZGF0ZScpO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJbmpbzlsYLnrZvpgInlip/og71cbiAgICovXG4gIHByaXZhdGUgaW5pdEZsb29yRmlsdGVyKCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1maWx0ZXItYnRuJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWluSW5wdXQgPSB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItbWluJykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgY29uc3QgbWF4SW5wdXQgPSB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItbWF4JykudmFsKCkgYXMgc3RyaW5nO1xuXG4gICAgICAvLyDlhYHorrjnqbrlgLzvvIzkvYblpoLmnpzmnInlgLzlsLHlv4XpobvmmK/mnInmlYjmlbDlrZdcbiAgICAgIGNvbnN0IG1pblZhbCA9IG1pbklucHV0LnRyaW0oKSA/IHBhcnNlSW50KG1pbklucHV0LCAxMCkgOiBudWxsO1xuICAgICAgY29uc3QgbWF4VmFsID0gbWF4SW5wdXQudHJpbSgpID8gcGFyc2VJbnQobWF4SW5wdXQsIDEwKSA6IG51bGw7XG5cbiAgICAgIC8vIOmqjOivgeaVsOWtl+acieaViOaAp1xuICAgICAgaWYgKChtaW5JbnB1dC50cmltKCkgJiYgaXNOYU4obWluVmFsISkpIHx8IChtYXhJbnB1dC50cmltKCkgJiYgaXNOYU4obWF4VmFsISkpKSB7XG4gICAgICAgIHRoaXMuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+ivt+i+k+WFpeacieaViOeahOalvOWxguaVsOWAvCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIOmqjOivgealvOWxguS4jeiDveWwj+S6jjBcbiAgICAgIGlmIChtaW5WYWwgIT09IG51bGwgJiYgbWluVmFsIDwgMCkge1xuICAgICAgICB0aGlzLnNob3dGbG9vckZpbHRlckVycm9yKCfmnIDlsI/mpbzlsYLkuI3og73lsI/kuo4wJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKG1heFZhbCAhPT0gbnVsbCAmJiBtYXhWYWwgPCAwKSB7XG4gICAgICAgIHRoaXMuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+acgOWkp+alvOWxguS4jeiDveWwj+S6jjAnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDpqozor4HojIPlm7TpgLvovpHvvJrlj6rmnInlvZPkuKTkuKrlgLzpg73lrZjlnKjml7bmiY3mr5TovoPlpKflsI9cbiAgICAgIGlmIChtaW5WYWwgIT09IG51bGwgJiYgbWF4VmFsICE9PSBudWxsICYmIG1heFZhbCA8IG1pblZhbCkge1xuICAgICAgICB0aGlzLnNob3dGbG9vckZpbHRlckVycm9yKCfmnIDlpKfmpbzlsYLkuI3og73lsI/kuo7mnIDlsI/mpbzlsYInKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDoh7PlsJHpnIDopoHorr7nva7kuIDkuKrlgLxcbiAgICAgIGlmIChtaW5WYWwgPT09IG51bGwgJiYgbWF4VmFsID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+ivt+iHs+Wwkeiuvue9ruacgOWwj+alvOWxguaIluacgOWkp+alvOWxgicpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaGlkZUZsb29yRmlsdGVyRXJyb3IoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1taW4sICNmbG9vci1tYXgnKS5vbignaW5wdXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtaW5JbnB1dCA9IHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1taW4nKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICBjb25zdCBtYXhJbnB1dCA9IHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1tYXgnKS52YWwoKSBhcyBzdHJpbmc7XG5cbiAgICAgIGNvbnN0IG1pblZhbCA9IG1pbklucHV0LnRyaW0oKSA/IHBhcnNlSW50KG1pbklucHV0LCAxMCkgOiBudWxsO1xuICAgICAgY29uc3QgbWF4VmFsID0gbWF4SW5wdXQudHJpbSgpID8gcGFyc2VJbnQobWF4SW5wdXQsIDEwKSA6IG51bGw7XG5cbiAgICAgIC8vIOWunuaXtumqjOivgealvOWxguS4jeiDveWwj+S6jjBcbiAgICAgIGlmIChtaW5WYWwgIT09IG51bGwgJiYgbWluVmFsIDwgMCkge1xuICAgICAgICB0aGlzLnNob3dGbG9vckZpbHRlckVycm9yKCfmnIDlsI/mpbzlsYLkuI3og73lsI/kuo4wJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKG1heFZhbCAhPT0gbnVsbCAmJiBtYXhWYWwgPCAwKSB7XG4gICAgICAgIHRoaXMuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+acgOWkp+alvOWxguS4jeiDveWwj+S6jjAnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDlrp7ml7bpqozor4HojIPlm7TpgLvovpFcbiAgICAgIGlmIChtaW5WYWwgIT09IG51bGwgJiYgbWF4VmFsICE9PSBudWxsICYmICFpc05hTihtaW5WYWwpICYmICFpc05hTihtYXhWYWwpICYmIG1heFZhbCA8IG1pblZhbCkge1xuICAgICAgICB0aGlzLnNob3dGbG9vckZpbHRlckVycm9yKCfmnIDlpKfmpbzlsYLkuI3og73lsI/kuo7mnIDlsI/mpbzlsYInKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaGlkZUZsb29yRmlsdGVyRXJyb3IoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrmpbzlsYLnrZvpgInplJnor6/kv6Hmga9cbiAgICogQHBhcmFtIG1lc3NhZ2Ug6ZSZ6K+v5L+h5oGvXG4gICAqL1xuICBwdWJsaWMgc2hvd0Zsb29yRmlsdGVyRXJyb3IobWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgJGVycm9yRWwgPSB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItZmlsdGVyLWVycm9yJyk7XG4gICAgJGVycm9yRWwudGV4dChtZXNzYWdlKS5zaG93KCk7XG4gIH1cblxuICAvKipcbiAgICog6ZqQ6JeP5qW85bGC562b6YCJ6ZSZ6K+v5L+h5oGvXG4gICAqL1xuICBwdWJsaWMgaGlkZUZsb29yRmlsdGVyRXJyb3IoKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLWZpbHRlci1lcnJvcicpLmhpZGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDmpbzlsYLnrZvpgInovpPlhaXmoYbnmoTlgLxcbiAgICogQHBhcmFtIG1pbiDmnIDlsI/mpbzlsYLlgLxcbiAgICogQHBhcmFtIG1heCDmnIDlpKfmpbzlsYLlgLxcbiAgICovXG4gIHB1YmxpYyB1cGRhdGVGbG9vclJhbmdlSW5wdXRzKG1pbjogbnVtYmVyIHwgbnVsbCwgbWF4OiBudW1iZXIgfCBudWxsKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1pbicpLnZhbChtaW4gIT09IG51bGwgPyBtaW4udG9TdHJpbmcoKSA6ICcnKTtcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItbWF4JykudmFsKG1heCAhPT0gbnVsbCA/IG1heC50b1N0cmluZygpIDogJycpO1xuICAgIHRoaXMuaGlkZUZsb29yRmlsdGVyRXJyb3IoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blvZPliY3mtLvliqjnmoTlj5jph4/nsbvlnotcbiAgICogQHJldHVybnMg5b2T5YmN5rS75Yqo55qE5Y+Y6YeP57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpOiBWYXJpYWJsZVR5cGUge1xuICAgIHJldHVybiAodGhpcy5jb250YWluZXIuZmluZCgnLnRhYi1pdGVtLmFjdGl2ZScpLmF0dHIoJ2lkJyk/LnJlcGxhY2UoJy10YWInLCAnJykgYXMgVmFyaWFibGVUeXBlKSB8fCAnY2hhdCc7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u5rS75Yqo5qCH562+6aG1XG4gICAqIEBwYXJhbSB0eXBlIOimgea/gOa0u+eahOWPmOmHj+exu+Wei1xuICAgKi9cbiAgcHVibGljIHNldEFjdGl2ZVRhYih0eXBlOiBWYXJpYWJsZVR5cGUpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcudGFiLWl0ZW0nKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnLnRhYi1jb250ZW50JykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgdGhpcy5jb250YWluZXIuZmluZChgIyR7dHlwZX0tdGFiYCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoYCMke3R5cGV9LWNvbnRlbnRgKS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICBjb25zdCAkZmxvb3JGaWx0ZXJDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItZmlsdGVyLWNvbnRhaW5lcicpO1xuICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScpIHtcbiAgICAgICRmbG9vckZpbHRlckNvbnRhaW5lci5zaG93KCk7XG4gICAgICBjb25zdCBbbWluRmxvb3IsIG1heEZsb29yXSA9IHRoaXMuZ2V0Rmxvb3JSYW5nZSgpO1xuXG4gICAgICAvLyDlpoLmnpzmpbzlsYLojIPlm7TkuLrnqbrvvIzorr7nva7pu5jorqTojIPlm7RcbiAgICAgIGlmIChtaW5GbG9vciA9PT0gbnVsbCAmJiBtYXhGbG9vciA9PT0gbnVsbCkge1xuICAgICAgICBjb25zdCBsYXN0TWVzc2FnZUlkID0gZ2V0TGFzdE1lc3NhZ2VJZCgpO1xuICAgICAgICBjb25zdCBuZXdNaW5GbG9vciA9IE1hdGgubWF4KDAsIGxhc3RNZXNzYWdlSWQgLSA0KTtcbiAgICAgICAgY29uc3QgbmV3TWF4Rmxvb3IgPSBsYXN0TWVzc2FnZUlkO1xuICAgICAgICAodGhpcy5jb250cm9sbGVyIGFzIGFueSkubW9kZWwudXBkYXRlRmxvb3JSYW5nZShuZXdNaW5GbG9vciwgbmV3TWF4Rmxvb3IpO1xuICAgICAgICB0aGlzLnVwZGF0ZUZsb29yUmFuZ2VJbnB1dHMobmV3TWluRmxvb3IsIG5ld01heEZsb29yKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgJGZsb29yRmlsdGVyQ29udGFpbmVyLmhpZGUoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEZsb29yUmFuZ2UoKTogW251bWJlciB8IG51bGwsIG51bWJlciB8IG51bGxdIHtcbiAgICBjb25zdCBtaW5WYWwgPSB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItbWluJykudmFsKCkgYXMgc3RyaW5nO1xuICAgIGNvbnN0IG1heFZhbCA9IHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1tYXgnKS52YWwoKSBhcyBzdHJpbmc7XG5cbiAgICBsZXQgbWluRmxvb3IgPSBtaW5WYWwgJiYgbWluVmFsLnRyaW0oKSA/IHBhcnNlSW50KG1pblZhbCwgMTApIDogbnVsbDtcbiAgICBsZXQgbWF4Rmxvb3IgPSBtYXhWYWwgJiYgbWF4VmFsLnRyaW0oKSA/IHBhcnNlSW50KG1heFZhbCwgMTApIDogbnVsbDtcblxuICAgIC8vIOehruS/nealvOWxguS4jeWwj+S6jjBcbiAgICBpZiAobWluRmxvb3IgIT09IG51bGwpIHtcbiAgICAgIG1pbkZsb29yID0gTWF0aC5tYXgoMCwgbWluRmxvb3IpO1xuICAgIH1cbiAgICBpZiAobWF4Rmxvb3IgIT09IG51bGwpIHtcbiAgICAgIG1heEZsb29yID0gTWF0aC5tYXgoMCwgbWF4Rmxvb3IpO1xuICAgIH1cblxuICAgIHJldHVybiBbXG4gICAgICBtaW5GbG9vciAhPT0gbnVsbCAmJiAhaXNOYU4obWluRmxvb3IpID8gbWluRmxvb3IgOiBudWxsLFxuICAgICAgbWF4Rmxvb3IgIT09IG51bGwgJiYgIWlzTmFOKG1heEZsb29yKSA/IG1heEZsb29yIDogbnVsbCxcbiAgICBdO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIt+aWsOWPmOmHj+WNoeeJh1xuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnotcbiAgICogQHBhcmFtIHZhcmlhYmxlcyDov4fmu6TlkI7nmoTlj5jph4/liJfooahcbiAgICovXG4gIHB1YmxpYyByZWZyZXNoVmFyaWFibGVDYXJkcyh0eXBlOiBWYXJpYWJsZVR5cGUsIHZhcmlhYmxlczogVmFyaWFibGVJdGVtW10pOiB2b2lkIHtcbiAgICAvLyDmm7TmlrDmoIfnrb7mlofmnKxcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcudmFyaWFibGUtdHlwZS1sYWJlbCcpLnRleHQoYCR7dHlwZX3lj5jph49gKTtcblxuICAgIC8vIOiOt+WPluW9k+WJjea0u+WKqOeahOWGheWuueWuueWZqFxuICAgIGNvbnN0IGFjdGl2ZUNvbnRlbnQgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAjJHt0eXBlfS1jb250ZW50YCk7XG4gICAgY29uc3QgJHZhcmlhYmxlTGlzdCA9IGFjdGl2ZUNvbnRlbnQuZmluZCgnLnZhcmlhYmxlLWxpc3QnKTtcblxuICAgIGNvbnN0IHNjcm9sbFRvcCA9ICR2YXJpYWJsZUxpc3Quc2Nyb2xsVG9wKCkgfHwgMDtcblxuICAgICR2YXJpYWJsZUxpc3QuZW1wdHkoKTtcblxuICAgIGlmICh2YXJpYWJsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAkdmFyaWFibGVMaXN0Lmh0bWwoJzxkaXYgY2xhc3M9XCJlbXB0eS1zdGF0ZVwiPjxwPuaaguaXoOWPmOmHjzwvcD48L2Rpdj4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyDmoLnmja7lj5jph4/nsbvlnovpgInmi6nkuI3lkIznmoTmuLLmn5PmlrnlvI9cbiAgICBpZiAodHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICB0aGlzLnJlbmRlck1lc3NhZ2VWYXJpYWJsZXNCeUZsb29yKCR2YXJpYWJsZUxpc3QsIHZhcmlhYmxlcyk7XG4gICAgICAkdmFyaWFibGVMaXN0LnNjcm9sbFRvcChzY3JvbGxUb3ApO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHZhcmlhYmxlcykge1xuICAgICAgICBjb25zdCBjYXJkID0gdGhpcy5jYXJkRmFjdG9yeS5jcmVhdGVDYXJkKHZhcmlhYmxlKTtcbiAgICAgICAgJHZhcmlhYmxlTGlzdC5hcHBlbmQoY2FyZCk7XG4gICAgICB9XG4gICAgICAkdmFyaWFibGVMaXN0LnNjcm9sbFRvcChzY3JvbGxUb3ApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlupTnlKjnrZvpgIlcbiAgICogQHBhcmFtIGZpbHRlclN0YXRlIOetm+mAieeKtuaAgVxuICAgKiBAcGFyYW0gc2VhcmNoS2V5d29yZCDmkJzntKLlhbPplK7lrZdcbiAgICovXG4gIHB1YmxpYyBhcHBseUNsaWVudFNpZGVGaWx0ZXJzKGZpbHRlclN0YXRlOiBSZWNvcmQ8VmFyaWFibGVEYXRhVHlwZSwgYm9vbGVhbj4sIHNlYXJjaEtleXdvcmQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGFjdGl2ZVR5cGUgPSB0aGlzLmdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpO1xuICAgIGNvbnN0ICR2YXJpYWJsZUNhcmRzID0gdGhpcy5jb250YWluZXIuZmluZChgIyR7YWN0aXZlVHlwZX0tY29udGVudCAudmFyaWFibGUtY2FyZGApO1xuICAgIGxldCB2aXNpYmxlQ291bnQgPSAwO1xuXG4gICAgJHZhcmlhYmxlQ2FyZHMuZWFjaCgoXywgY2FyZCkgPT4ge1xuICAgICAgY29uc3QgJGNhcmQgPSAkKGNhcmQpO1xuICAgICAgY29uc3QgY2FyZFR5cGUgPSAkY2FyZC5hdHRyKCdkYXRhLXR5cGUnKSBhcyBWYXJpYWJsZURhdGFUeXBlO1xuICAgICAgY29uc3QgY2FyZE5hbWUgPSAoJGNhcmQuZmluZCgnLnZhcmlhYmxlLXRpdGxlJykudmFsKCkgYXMgc3RyaW5nKSB8fCAnJztcblxuICAgICAgY29uc3QgdHlwZVZpc2libGUgPSBmaWx0ZXJTdGF0ZVtjYXJkVHlwZV07XG4gICAgICBjb25zdCBrZXl3b3JkVmlzaWJsZSA9ICFzZWFyY2hLZXl3b3JkIHx8IGNhcmROYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoS2V5d29yZC50b0xvd2VyQ2FzZSgpKTtcblxuICAgICAgaWYgKHR5cGVWaXNpYmxlICYmIGtleXdvcmRWaXNpYmxlKSB7XG4gICAgICAgICRjYXJkLnNob3coKTtcbiAgICAgICAgdmlzaWJsZUNvdW50Kys7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkY2FyZC5oaWRlKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyDmm7TmlrDnqbrnirbmgIHmmL7npLpcbiAgICB0aGlzLnVwZGF0ZUZpbHRlckVtcHR5U3RhdGUoYWN0aXZlVHlwZSwgdmlzaWJsZUNvdW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDnrZvpgInlkI7nmoTnqbrnirbmgIHmmL7npLpcbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LXG4gICAqIEBwYXJhbSB2aXNpYmxlQ291bnQg5Y+v6KeB5Y2h54mH5pWw6YePXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZUZpbHRlckVtcHR5U3RhdGUodHlwZTogVmFyaWFibGVUeXBlLCB2aXNpYmxlQ291bnQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0ICR2YXJpYWJsZUxpc3QgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAjJHt0eXBlfS1jb250ZW50IC52YXJpYWJsZS1saXN0YCk7XG4gICAgY29uc3QgJGV4aXN0aW5nRW1wdHlTdGF0ZSA9ICR2YXJpYWJsZUxpc3QuZmluZCgnLmZpbHRlci1lbXB0eS1zdGF0ZScpO1xuXG4gICAgaWYgKHZpc2libGVDb3VudCA9PT0gMCkge1xuICAgICAgLy8g5qOA5p+l5piv5ZCm5pyJ5Y+Y6YeP5Y2h54mH77yI5Y2z5L2/6KKr6ZqQ6JeP77yJXG4gICAgICBjb25zdCB0b3RhbENhcmRzID0gJHZhcmlhYmxlTGlzdC5maW5kKCcudmFyaWFibGUtY2FyZCcpLmxlbmd0aDtcbiAgICAgIGlmICh0b3RhbENhcmRzID4gMCkge1xuICAgICAgICBpZiAoJGV4aXN0aW5nRW1wdHlTdGF0ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAkdmFyaWFibGVMaXN0LmFwcGVuZCgnPGRpdiBjbGFzcz1cImZpbHRlci1lbXB0eS1zdGF0ZVwiPjxwPuayoeacieespuWQiOetm+mAieadoeS7tueahOWPmOmHjzwvcD48L2Rpdj4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAkZXhpc3RpbmdFbXB0eVN0YXRlLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmjInmpbzlsYLmuLLmn5NtZXNzYWdl57G75Z6L55qE5Y+Y6YePXG4gICAqIEBwYXJhbSBjb250YWluZXIg5a655Zmo5YWD57SgXG4gICAqIEBwYXJhbSB2YXJpYWJsZXMg5Y+Y6YeP5YiX6KGoXG4gICAqL1xuICBwcml2YXRlIHJlbmRlck1lc3NhZ2VWYXJpYWJsZXNCeUZsb29yKGNvbnRhaW5lcjogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgdmFyaWFibGVzOiBWYXJpYWJsZUl0ZW1bXSk6IHZvaWQge1xuICAgIC8vIOaMiealvOWxguWIhue7hOWPmOmHj1xuICAgIGNvbnN0IGZsb29yR3JvdXBzOiBNYXA8bnVtYmVyLCBWYXJpYWJsZUl0ZW1bXT4gPSBuZXcgTWFwKCk7XG5cbiAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIHZhcmlhYmxlcykge1xuICAgICAgaWYgKHZhcmlhYmxlLm1lc3NhZ2VfaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoIWZsb29yR3JvdXBzLmhhcyh2YXJpYWJsZS5tZXNzYWdlX2lkKSkge1xuICAgICAgICAgIGZsb29yR3JvdXBzLnNldCh2YXJpYWJsZS5tZXNzYWdlX2lkLCBbXSk7XG4gICAgICAgIH1cbiAgICAgICAgZmxvb3JHcm91cHMuZ2V0KHZhcmlhYmxlLm1lc3NhZ2VfaWQpIS5wdXNoKHZhcmlhYmxlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzb3J0ZWRGbG9vcnMgPSBBcnJheS5mcm9tKGZsb29yR3JvdXBzLmtleXMoKSkuc29ydCgoYSwgYikgPT4gYiAtIGEpOyAvLyDpmY3luo/mjpLliJfvvIzmnIDmlrDmpbzlsYLlnKjkuIpcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc29ydGVkRmxvb3JzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBmbG9vciA9IHNvcnRlZEZsb29yc1tpXTtcbiAgICAgIGNvbnN0IGZsb29yVmFyaWFibGVzID0gZmxvb3JHcm91cHMuZ2V0KGZsb29yKSE7XG4gICAgICBjb25zdCBpc0V4cGFuZGVkID0gaSA9PT0gMDsgLy8g5Y+q5bGV5byA5pyA5paw5LiA5bGC5qW8XG5cbiAgICAgIGNvbnN0ICRwYW5lbCA9IHRoaXMuY3JlYXRlRmxvb3JQYW5lbChmbG9vciwgaXNFeHBhbmRlZCk7XG4gICAgICBjb25zdCAkcGFuZWxCb2R5ID0gJHBhbmVsLmZpbmQoJy5mbG9vci1wYW5lbC1ib2R5Jyk7XG5cbiAgICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgZmxvb3JWYXJpYWJsZXMpIHtcbiAgICAgICAgY29uc3QgY2FyZCA9IHRoaXMuY2FyZEZhY3RvcnkuY3JlYXRlQ2FyZCh2YXJpYWJsZSk7XG4gICAgICAgIGNhcmQuYXR0cignZGF0YS1mbG9vci1pZCcsIGZsb29yLnRvU3RyaW5nKCkpO1xuICAgICAgICAkcGFuZWxCb2R5LmFwcGVuZChjYXJkKTtcbiAgICAgIH1cblxuICAgICAgY29udGFpbmVyLmFwcGVuZCgkcGFuZWwpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rmpbzlsYLmipjlj6DpnaLmnb9cbiAgICogQHBhcmFtIGZsb29yIOalvOWxguWPt1xuICAgKiBAcGFyYW0gaXNFeHBhbmRlZCDmmK/lkKbpu5jorqTlsZXlvIBcbiAgICogQHJldHVybnMg5oqY5Y+g6Z2i5p2/alF1ZXJ55a+56LGhXG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZUZsb29yUGFuZWwoZmxvb3I6IG51bWJlciwgaXNFeHBhbmRlZDogYm9vbGVhbik6IEpRdWVyeTxIVE1MRWxlbWVudD4ge1xuICAgIGNvbnN0IHRpdGxlQ29udGVudCA9IGAjICR7Zmxvb3J9IOalvGA7XG5cbiAgICBjb25zdCAkcGFuZWwgPSAkKGBcbiAgICAgIDxkaXYgY2xhc3M9XCJmbG9vci1wYW5lbFwiIGRhdGEtZmxvb3I9XCIke2Zsb29yfVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZmxvb3ItcGFuZWwtaGVhZGVyIGZsZXggc3BhY2VCZXR3ZWVuIGFsaWduSXRlbXNDZW50ZXJcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxvb3ItcGFuZWwtdGl0bGVcIj4ke3RpdGxlQ29udGVudH08L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxvb3ItcGFuZWwtaWNvbiAke2lzRXhwYW5kZWQgPyAnZXhwYW5kZWQnIDogJyd9XCI+XG4gICAgICAgICAgICA8aSBjbGFzcz1cImZhLXNvbGlkIGZhLWNoZXZyb24tZG93blwiPjwvaT5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmbG9vci1wYW5lbC1ib2R5ICR7aXNFeHBhbmRlZCA/ICdleHBhbmRlZCcgOiAnJ31cIj48L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIGApO1xuXG4gICAgJHBhbmVsLmZpbmQoJy5mbG9vci1wYW5lbC1oZWFkZXInKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCAkdGhpcyA9ICQodGhpcyk7XG4gICAgICBjb25zdCAkaWNvbiA9ICR0aGlzLmZpbmQoJy5mbG9vci1wYW5lbC1pY29uJyk7XG4gICAgICBjb25zdCAkYm9keSA9ICR0aGlzLmNsb3Nlc3QoJy5mbG9vci1wYW5lbCcpLmZpbmQoJy5mbG9vci1wYW5lbC1ib2R5Jyk7XG5cbiAgICAgICRpY29uLnRvZ2dsZUNsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgJGJvZHkudG9nZ2xlQ2xhc3MoJ2V4cGFuZGVkJyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gJHBhbmVsO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uuaWsOWPmOmHj+WNoeeJh1xuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnotcbiAgICogQHBhcmFtIGRhdGFUeXBlIOWPmOmHj+aVsOaNruexu+Wei1xuICAgKiBAcGFyYW0gZmxvb3JJZCDmpbzlsYJJRCjku4XnlKjkuo5tZXNzYWdl57G75Z6LKVxuICAgKi9cbiAgcHVibGljIGFkZE5ld1ZhcmlhYmxlQ2FyZCh0eXBlOiBWYXJpYWJsZVR5cGUsIGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlLCBmbG9vcklkPzogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgJGNvbnRlbnQgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAjJHt0eXBlfS1jb250ZW50YCkuZmluZCgnLnZhcmlhYmxlLWxpc3QnKTtcbiAgICAkY29udGVudC5maW5kKCcuZW1wdHktc3RhdGUnKS5yZW1vdmUoKTtcblxuICAgIGNvbnN0IGRlZmF1bHRWYXJpYWJsZTogVmFyaWFibGVJdGVtID0ge1xuICAgICAgbmFtZTogJ25ld192YXJpYWJsZScsXG4gICAgICB2YWx1ZTogVmFyaWFibGVNYW5hZ2VyVXRpbC5nZXREZWZhdWx0VmFsdWVGb3JUeXBlKGRhdGFUeXBlKSxcbiAgICAgIGRhdGFUeXBlOiBkYXRhVHlwZSxcbiAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICB9O1xuXG4gICAgY29uc3QgbmV3Q2FyZCA9IHRoaXMuY2FyZEZhY3RvcnkuY3JlYXRlQ2FyZChkZWZhdWx0VmFyaWFibGUpO1xuICAgIG5ld0NhcmQuYXR0cignZGF0YS10eXBlJywgZGF0YVR5cGUpO1xuXG4gICAgaWYgKHR5cGUgPT09ICdtZXNzYWdlJyAmJiBmbG9vcklkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuYWRkQ2FyZFRvRmxvb3JQYW5lbCgkY29udGVudCwgbmV3Q2FyZCwgZmxvb3JJZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICRjb250ZW50LnByZXBlbmQobmV3Q2FyZCk7XG4gICAgICB0aGlzLmFkZEFuaW1hdGlvbihuZXdDYXJkLCAndmFyaWFibGUtYWRkZWQnLCAoKSA9PiB7fSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWwhuWNoeeJh+a3u+WKoOWIsOaMh+WumualvOWxgumdouadv1xuICAgKiBAcGFyYW0gY29udGVudCDlhoXlrrnlrrnlmahcbiAgICogQHBhcmFtIGNhcmQg5Y2h54mH5YWD57SgXG4gICAqIEBwYXJhbSBmbG9vcklkIOalvOWxgklEXG4gICAqL1xuICBwcml2YXRlIGFkZENhcmRUb0Zsb29yUGFuZWwoY29udGVudDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgZmxvb3JJZDogbnVtYmVyKTogdm9pZCB7XG4gICAgbGV0ICRmbG9vclBhbmVsID0gY29udGVudC5maW5kKGAuZmxvb3ItcGFuZWxbZGF0YS1mbG9vcj1cIiR7Zmxvb3JJZH1cIl1gKTtcblxuICAgIGlmICgkZmxvb3JQYW5lbC5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0ICRwYW5lbCA9IHRoaXMuY3JlYXRlRmxvb3JQYW5lbChmbG9vcklkLCB0cnVlKTtcbiAgICAgIHRoaXMuaW5zZXJ0Rmxvb3JQYW5lbEluT3JkZXIoY29udGVudCwgJHBhbmVsLCBmbG9vcklkKTtcbiAgICAgICRmbG9vclBhbmVsID0gJHBhbmVsO1xuICAgIH1cblxuICAgIGNvbnN0ICRwYW5lbEJvZHkgPSAkZmxvb3JQYW5lbC5maW5kKCcuZmxvb3ItcGFuZWwtYm9keScpO1xuXG4gICAgaWYgKCEkcGFuZWxCb2R5Lmhhc0NsYXNzKCdleHBhbmRlZCcpKSB7XG4gICAgICAkZmxvb3JQYW5lbC5maW5kKCcuZmxvb3ItcGFuZWwtaWNvbicpLmFkZENsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgJHBhbmVsQm9keS5hZGRDbGFzcygnZXhwYW5kZWQnKTtcbiAgICB9XG5cbiAgICBjYXJkLmF0dHIoJ2RhdGEtZmxvb3ItaWQnLCBmbG9vcklkLnRvU3RyaW5nKCkpO1xuICAgICRwYW5lbEJvZHkucHJlcGVuZChjYXJkKTtcbiAgICB0aGlzLmFkZEFuaW1hdGlvbihjYXJkLCAndmFyaWFibGUtYWRkZWQnLCAoKSA9PiB7fSk7XG4gIH1cblxuICAvKipcbiAgICog5oyJ5qW85bGC5Y+36aG65bqP5o+S5YWl5qW85bGC6Z2i5p2/XG4gICAqIEBwYXJhbSBjb250ZW50IOWGheWuueWuueWZqFxuICAgKiBAcGFyYW0gcGFuZWwg6KaB5o+S5YWl55qE6Z2i5p2/XG4gICAqIEBwYXJhbSBmbG9vcklkIOalvOWxgklEXG4gICAqL1xuICBwcml2YXRlIGluc2VydEZsb29yUGFuZWxJbk9yZGVyKGNvbnRlbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sIHBhbmVsOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBmbG9vcklkOiBudW1iZXIpOiB2b2lkIHtcbiAgICBsZXQgaW5zZXJ0ZWQgPSBmYWxzZTtcbiAgICBjb250ZW50LmZpbmQoJy5mbG9vci1wYW5lbCcpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZXhpc3RpbmdGbG9vciA9IHBhcnNlSW50KCQodGhpcykuYXR0cignZGF0YS1mbG9vcicpIHx8ICcwJyk7XG4gICAgICBpZiAoZmxvb3JJZCA+IGV4aXN0aW5nRmxvb3IpIHtcbiAgICAgICAgJCh0aGlzKS5iZWZvcmUocGFuZWwpO1xuICAgICAgICBpbnNlcnRlZCA9IHRydWU7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSk7XG5cbiAgICBpZiAoIWluc2VydGVkKSB7XG4gICAgICBjb250ZW50LnByZXBlbmQocGFuZWwpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blj5jph4/ljaHniYfkv6Hmga9cbiAgICogQHBhcmFtIGNhcmQg5Y2h54mH5YWD57SgXG4gICAqIEByZXR1cm5zIOWNoeeJh+S4reeahOWPmOmHj+S/oeaBr1xuICAgKi9cbiAgcHVibGljIGdldFZhcmlhYmxlRnJvbUNhcmQoY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IFZhcmlhYmxlSXRlbSB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLmNhcmRGYWN0b3J5LmdldFZhcmlhYmxlRnJvbUNhcmQoY2FyZCk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5Y+Y6YeP5Y2h54mH5ZCN56ewXG4gICAqIEBwYXJhbSBjYXJkIOWNoeeJh+WFg+e0oFxuICAgKiBAcmV0dXJucyDljaHniYfkuK3nmoTlj5jph4/lkI3np7BcbiAgICovXG4gIHB1YmxpYyBnZXRWYXJpYWJsZUNhcmROYW1lKGNhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiBzdHJpbmcge1xuICAgIGNvbnN0IHZhcmlhYmxlID0gdGhpcy5nZXRWYXJpYWJsZUZyb21DYXJkKGNhcmQpO1xuICAgIHJldHVybiB2YXJpYWJsZT8ubmFtZSB8fCAnJztcbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrmt7vliqDlj5jph4/pgInmi6nlr7nor53moYZcbiAgICogQHBhcmFtIGNhbGxiYWNrIOmAieaLqeWQjueahOWbnuiwg+WHveaVsFxuICAgKi9cbiAgcHVibGljIGFzeW5jIHNob3dBZGRWYXJpYWJsZURpYWxvZyhjYWxsYmFjazogKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlLCBmbG9vcklkPzogbnVtYmVyKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY3VycmVudFR5cGUgPSB0aGlzLmdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpO1xuXG4gICAgaWYgKGN1cnJlbnRUeXBlID09PSAnbWVzc2FnZScpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2hvd0Zsb29ySW5wdXREaWFsb2coYXN5bmMgZmxvb3JJZCA9PiB7XG4gICAgICAgIGlmIChmbG9vcklkID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgYXdhaXQgdGhpcy5zaG93VmFyaWFibGVUeXBlRGlhbG9nKGRhdGFUeXBlID0+IHtcbiAgICAgICAgICBjYWxsYmFjayhkYXRhVHlwZSwgZmxvb3JJZCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy5zaG93VmFyaWFibGVUeXBlRGlhbG9nKGRhdGFUeXBlID0+IHtcbiAgICAgIGNhbGxiYWNrKGRhdGFUeXBlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrmpbzlsYLovpPlhaXlr7nor53moYZcbiAgICogQHBhcmFtIGNhbGxiYWNrIOi+k+WFpeWujOaIkOWQjueahOWbnuiwg+WHveaVsFxuICAgKi9cbiAgcHVibGljIGFzeW5jIHNob3dGbG9vcklucHV0RGlhbG9nKGNhbGxiYWNrOiAoZmxvb3JJZDogbnVtYmVyIHwgbnVsbCkgPT4gdm9pZCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSAkKGBcbiAgICAgIDxkaXY+XG4gICAgICAgIDxoMz7ovpPlhaXmpbzlsYLlj7fnoIE8L2gzPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZmxvb3ItaW5wdXQtZGlhbG9nXCI+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJudW1iZXJcIiBpZD1cImZsb29yLWlucHV0XCIgbWluPVwiMFwiIHBsYWNlaG9sZGVyPVwi6K+36L6T5YWl5qW85bGC5Y+356CBXCIgLz5cbiAgICAgICAgICA8ZGl2IGlkPVwiZmxvb3ItaW5wdXQtZXJyb3JcIiBjbGFzcz1cImZsb29yLWZpbHRlci1lcnJvclwiIHN0eWxlPVwiZGlzcGxheTogbm9uZVwiPuivt+i+k+WFpeacieaViOeahOalvOWxguWPt+eggTwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIGApO1xuXG4gICAgY29uc3QgJGlucHV0RmllbGQgPSBjb250ZW50LmZpbmQoJyNmbG9vci1pbnB1dCcpO1xuICAgIGNvbnN0ICRlcnJvck1zZyA9IGNvbnRlbnQuZmluZCgnI2Zsb29yLWlucHV0LWVycm9yJyk7XG5cbiAgICBjb25zdCBsYXN0TWVzc2FnZUlkID0gZ2V0TGFzdE1lc3NhZ2VJZCgpO1xuICAgIGlmIChsYXN0TWVzc2FnZUlkID49IDApIHtcbiAgICAgICRpbnB1dEZpZWxkLnZhbChsYXN0TWVzc2FnZUlkKTtcbiAgICB9XG5cbiAgICAvLyDmt7vliqDovpPlhaXpqozor4FcbiAgICAkaW5wdXRGaWVsZC5vbignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHBhcnNlSW50KCQodGhpcykudmFsKCkgYXMgc3RyaW5nLCAxMCk7XG4gICAgICBpZiAoJCh0aGlzKS52YWwoKSAmJiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlIDwgMCkpIHtcbiAgICAgICAgJGVycm9yTXNnLnRleHQoJ+alvOWxguWPt+eggeS4jeiDveWwj+S6jjAnKS5zaG93KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkZXJyb3JNc2cuaGlkZSgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChjb250ZW50LCBQT1BVUF9UWVBFLkNPTkZJUk0sICcnLCB7XG4gICAgICBva0J1dHRvbjogJ+ehruiupCcsXG4gICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGlucHV0VmFsdWUgPSAkaW5wdXRGaWVsZC52YWwoKSBhcyBzdHJpbmc7XG4gICAgY29uc3QgZmxvb3JJZCA9IHBhcnNlSW50KGlucHV0VmFsdWUsIDEwKTtcblxuICAgIGlmICghaW5wdXRWYWx1ZS50cmltKCkgfHwgaXNOYU4oZmxvb3JJZCkpIHtcbiAgICAgICRlcnJvck1zZy50ZXh0KCfor7fovpPlhaXmnInmlYjnmoTmpbzlsYLlj7fnoIEnKS5zaG93KCk7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuc2hvd0Zsb29ySW5wdXREaWFsb2coY2FsbGJhY2spLCAxMDApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChmbG9vcklkIDwgMCkge1xuICAgICAgJGVycm9yTXNnLnRleHQoJ+alvOWxguWPt+eggeS4jeiDveWwj+S6jjAnKS5zaG93KCk7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuc2hvd0Zsb29ySW5wdXREaWFsb2coY2FsbGJhY2spLCAxMDApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNhbGxiYWNrKGZsb29ySWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuWPmOmHj+exu+Wei+mAieaLqeWvueivneahhlxuICAgKiBAcGFyYW0gY2FsbGJhY2sg6YCJ5oup5ZCO55qE5Zue6LCD5Ye95pWwXG4gICAqIEBwYXJhbSBmbG9vcklkIOalvOWxgklEKOS7heeUqOS6jm1lc3NhZ2XnsbvlnospXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2hvd1ZhcmlhYmxlVHlwZURpYWxvZyhjYWxsYmFjazogKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29udGVudCA9ICQoYFxuICAgICAgPGRpdj5cbiAgICAgICAgPGgzPumAieaLqeWPmOmHj+exu+WeizwvaDM+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS10eXBlLW9wdGlvbnNcIj5cbiAgICAgICAgICA8ZGl2IGRhdGEtdHlwZT1cInN0cmluZ1wiPjxpIGNsYXNzPVwiZmEtcmVndWxhciBmYS1mb250XCI+PC9pPiDlrZfnrKbkuLI8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGRhdGEtdHlwZT1cIm51bWJlclwiPjxpIGNsYXNzPVwiZmEtcmVndWxhciBmYS1oYXNodGFnXCI+PC9pPiDmlbDlrZc8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGRhdGEtdHlwZT1cImJvb2xlYW5cIj48aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtdG9nZ2xlLW9uXCI+PC9pPiDluIPlsJTlgLw8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGRhdGEtdHlwZT1cImFycmF5XCI+PGkgY2xhc3M9XCJmYS1yZWd1bGFyIGZhLWxpc3RcIj48L2k+IOaVsOe7hDwvZGl2PlxuICAgICAgICAgIDxkaXYgZGF0YS10eXBlPVwib2JqZWN0XCI+PGkgY2xhc3M9XCJmYS1yZWd1bGFyIGZhLWNvZGVcIj48L2k+IOWvueixoTwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIGApO1xuXG4gICAgY29udGVudC5maW5kKCcudmFyaWFibGUtdHlwZS1vcHRpb25zIGRpdicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGRhdGFUeXBlID0gJCh0aGlzKS5hdHRyKCdkYXRhLXR5cGUnKSBhcyBWYXJpYWJsZURhdGFUeXBlO1xuICAgICAgY2FsbGJhY2soZGF0YVR5cGUpO1xuXG4gICAgICAkKCcucG9wdXAnKS5maW5kKCcucG9wdXAtYnV0dG9uLWNsb3NlJykudHJpZ2dlcignY2xpY2snKTtcbiAgICB9KTtcblxuICAgIGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoY29udGVudCwgUE9QVVBfVFlQRS5ESVNQTEFZKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrnoa7orqTlr7nor53moYZcbiAgICogQHBhcmFtIG1lc3NhZ2Ug56Gu6K6k5L+h5oGvXG4gICAqIEBwYXJhbSBjYWxsYmFjayDnoa7orqTlkI7nmoTlm57osINcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzaG93Q29uZmlybURpYWxvZyhtZXNzYWdlOiBzdHJpbmcsIGNhbGxiYWNrOiAoY29uZmlybWVkOiBib29sZWFuKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChtZXNzYWdlLCBQT1BVUF9UWVBFLkNPTkZJUk0sICcnLCB7XG4gICAgICBva0J1dHRvbjogJ+ehruiupCcsXG4gICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgIH0pO1xuXG4gICAgY2FsbGJhY2soISFyZXN1bHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4suafk+WPmOmHj+euoeeQhuWZqOa1rueql1xuICAgKiDliJvlu7rlj6/mi5bliqjjgIHlj6/osIPmlbTlpKflsI/nmoTmta7nqpdcbiAgICovXG4gIHB1YmxpYyByZW5kZXIoKTogdm9pZCB7XG4gICAgdGhpcy51bnJlbmRlcigpO1xuXG4gICAgdGhpcy5kaWFsb2cgPSAkKGBcbiAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1tYW5hZ2VyLWRpYWxvZ1wiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZGlhbG9nLWhlYWRlclwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJkaWFsb2ctdGl0bGVcIj7lj5jph4/nrqHnkIblmag8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGlhbG9nLWNvbnRyb2xzXCI+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiZGlhbG9nLXRvZ2dsZS1idG5cIiB0aXRsZT1cIuaKmOWPoC/lsZXlvIDlhoXlrrlcIj48aSBjbGFzcz1cImZhLXNvbGlkIGZhLWNoZXZyb24tdXBcIj48L2k+PC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiZGlhbG9nLWNsb3NlLWJ0blwiPjxpIGNsYXNzPVwiZmEtc29saWQgZmEtdGltZXNcIj48L2k+PC9idXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZGlhbG9nLWNvbnRlbnRcIj48L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImRpYWxvZy1yZXNpemUtaGFuZGxlXCI+PC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcblxuICAgIHRoaXMuZGlhbG9nLmZpbmQoJy5kaWFsb2ctY29udGVudCcpLmFwcGVuZCh0aGlzLmNvbnRhaW5lcik7XG5cbiAgICB0aGlzLmRpYWxvZy5maW5kKCcuZGlhbG9nLWNsb3NlLWJ0bicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMudW5yZW5kZXIoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuZGlhbG9nLmZpbmQoJy5kaWFsb2ctdG9nZ2xlLWJ0bicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0ICRjb250ZW50ID0gdGhpcy5kaWFsb2chLmZpbmQoJy5kaWFsb2ctY29udGVudCcpO1xuICAgICAgY29uc3QgJHRvZ2dsZUJ0biA9IHRoaXMuZGlhbG9nIS5maW5kKCcuZGlhbG9nLXRvZ2dsZS1idG4gaScpO1xuXG4gICAgICAkY29udGVudC5zbGlkZVRvZ2dsZSgzMDAsICgpID0+IHtcbiAgICAgICAgaWYgKCRjb250ZW50LmlzKCc6dmlzaWJsZScpKSB7XG4gICAgICAgICAgJHRvZ2dsZUJ0bi5yZW1vdmVDbGFzcygnZmEtY2hldnJvbi1kb3duJykuYWRkQ2xhc3MoJ2ZhLWNoZXZyb24tdXAnKTtcbiAgICAgICAgICB0aGlzLmRpYWxvZyEuZmluZCgnLmRpYWxvZy1yZXNpemUtaGFuZGxlJykuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICR0b2dnbGVCdG4ucmVtb3ZlQ2xhc3MoJ2ZhLWNoZXZyb24tdXAnKS5hZGRDbGFzcygnZmEtY2hldnJvbi1kb3duJyk7XG4gICAgICAgICAgdGhpcy5kaWFsb2chLmZpbmQoJy5kaWFsb2ctcmVzaXplLWhhbmRsZScpLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuZGlhbG9nIS50b2dnbGVDbGFzcygnY29udGVudC1jb2xsYXBzZWQnKTtcbiAgICB9KTtcblxuICAgICQoJ2JvZHknKS5hcHBlbmQodGhpcy5kaWFsb2cpO1xuXG4gICAgdGhpcy5pbml0RHJhZ2dhYmxlRGlhbG9nKCk7XG4gICAgdGhpcy5jZW50ZXJEaWFsb2coKTtcbiAgICB0aGlzLmNvbnRhaW5lci5zaG93KCk7XG4gIH1cblxuICAvKipcbiAgICog5YWz6Zet5bm25riF55CG5Y+Y6YeP566h55CG5Zmo5rWu56qXXG4gICAqL1xuICBwdWJsaWMgdW5yZW5kZXIoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZGlhbG9nKSB7XG4gICAgICB0aGlzLmNvbnRhaW5lci5kZXRhY2goKTtcbiAgICAgIHRoaXMuZGlhbG9nLnJlbW92ZSgpO1xuICAgICAgdGhpcy5kaWFsb2cgPSBudWxsO1xuXG4gICAgICBpZiAodGhpcy5jb250cm9sbGVyKSB7XG4gICAgICAgIHRoaXMuY29udHJvbGxlci5jbGVhbnVwKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIneWni+WMlua1rueql+eahOaLluWKqOWSjOiwg+aVtOWkp+Wwj+WKn+iDvVxuICAgKi9cbiAgcHJpdmF0ZSBpbml0RHJhZ2dhYmxlRGlhbG9nKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5kaWFsb2cpIHJldHVybjtcblxuICAgIGNvbnN0IGlzTW9iaWxlRGV2aWNlID0gaXNNb2JpbGUoKTtcblxuICAgICh0aGlzLmRpYWxvZyBhcyBhbnkpLmRyYWdnYWJsZSh7XG4gICAgICBoYW5kbGU6ICcuZGlhbG9nLWhlYWRlcicsXG4gICAgICBjb250YWlubWVudDogJ3dpbmRvdycsXG4gICAgICBzdGFydDogKCkgPT4ge1xuICAgICAgICB0aGlzLmRpYWxvZz8uYWRkQ2xhc3MoJ2RyYWdnaW5nJyk7XG4gICAgICB9LFxuICAgICAgc3RvcDogKCkgPT4ge1xuICAgICAgICB0aGlzLmRpYWxvZz8ucmVtb3ZlQ2xhc3MoJ2RyYWdnaW5nJyk7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgKHRoaXMuZGlhbG9nIGFzIGFueSkucmVzaXphYmxlKHtcbiAgICAgIC8vIOahjOmdouiuvuWkh+eUqOaJgOaciei+uee8mO+8jOenu+WKqOiuvuWkh+S7heeUqOWPs+S4i+inklxuICAgICAgaGFuZGxlczogaXNNb2JpbGVEZXZpY2UgPyAnc2UnIDogJ24sZSxzLHcsbmUsc2Usc3csbncnLFxuICAgICAgbWluSGVpZ2h0OiBWYXJpYWJsZVZpZXcuTUlOX0RJQUxPR19IRUlHSFQsXG4gICAgICBtaW5XaWR0aDogVmFyaWFibGVWaWV3Lk1JTl9ESUFMT0dfV0lEVEgsXG4gICAgICBzdGFydDogKCkgPT4ge1xuICAgICAgICB0aGlzLmRpYWxvZz8uYWRkQ2xhc3MoJ3Jlc2l6aW5nJyk7XG4gICAgICB9LFxuICAgICAgc3RvcDogKCkgPT4ge1xuICAgICAgICB0aGlzLmRpYWxvZz8ucmVtb3ZlQ2xhc3MoJ3Jlc2l6aW5nJyk7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgdGhpcy5kaWFsb2cuZmluZCgnLmRpYWxvZy1yZXNpemUtaGFuZGxlJykudG9nZ2xlKGlzTW9iaWxlRGV2aWNlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlsIbmta7nqpflsYXkuK3mmL7npLpcbiAgICovXG4gIHByaXZhdGUgY2VudGVyRGlhbG9nKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5kaWFsb2cpIHJldHVybjtcblxuICAgIGNvbnN0IHdpbmRvd1dpZHRoID0gJCh3aW5kb3cpLndpZHRoKCkgfHwgMDtcbiAgICBjb25zdCB3aW5kb3dIZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCkgfHwgMDtcblxuICAgIGNvbnN0IGRpYWxvZ1dpZHRoID0gdGhpcy5kaWFsb2cub3V0ZXJXaWR0aCgpIHx8IFZhcmlhYmxlVmlldy5NSU5fRElBTE9HX1dJRFRIO1xuICAgIGNvbnN0IGRpYWxvZ0hlaWdodCA9IHRoaXMuZGlhbG9nLm91dGVySGVpZ2h0KCkgfHwgVmFyaWFibGVWaWV3Lk1JTl9ESUFMT0dfSEVJR0hUO1xuXG4gICAgY29uc3QgbGVmdCA9IE1hdGgubWF4KDAsICh3aW5kb3dXaWR0aCAtIGRpYWxvZ1dpZHRoKSAvIDIpO1xuICAgIGNvbnN0IHRvcCA9IE1hdGgubWF4KDAsICh3aW5kb3dIZWlnaHQgLSBkaWFsb2dIZWlnaHQpIC8gMik7XG5cbiAgICB0aGlzLmRpYWxvZy5jc3Moe1xuICAgICAgbGVmdDogYCR7bGVmdH1weGAsXG4gICAgICB0b3A6IGAke3RvcH1weGAsXG4gICAgICBwb3NpdGlvbjogJ2ZpeGVkJyxcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBhZGRWYXJpYWJsZUNhcmQodmFyaWFibGU6IFZhcmlhYmxlSXRlbSk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBuZXdDYXJkID0gdGhpcy5jYXJkRmFjdG9yeS5jcmVhdGVDYXJkKHZhcmlhYmxlKTtcbiAgICAgIG5ld0NhcmQuYXR0cignZGF0YS10eXBlJywgdmFyaWFibGUuZGF0YVR5cGUpO1xuXG4gICAgICBjb25zdCBhY3RpdmVUeXBlID0gdGhpcy5nZXRBY3RpdmVWYXJpYWJsZVR5cGUoKTtcbiAgICAgIGNvbnN0ICR2YXJpYWJsZUxpc3QgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAjJHthY3RpdmVUeXBlfS1jb250ZW50IC52YXJpYWJsZS1saXN0YCk7XG5cbiAgICAgIGlmIChhY3RpdmVUeXBlID09PSAnbWVzc2FnZScgJiYgdmFyaWFibGUubWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXMuYWRkQ2FyZFRvRmxvb3JQYW5lbCgkdmFyaWFibGVMaXN0LCBuZXdDYXJkLCB2YXJpYWJsZS5tZXNzYWdlX2lkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICR2YXJpYWJsZUxpc3QuZmluZCgnLmVtcHR5LXN0YXRlJykucmVtb3ZlKCk7XG4gICAgICAgICR2YXJpYWJsZUxpc3QuYXBwZW5kKG5ld0NhcmQpO1xuICAgICAgICB0aGlzLmFkZEFuaW1hdGlvbihuZXdDYXJkLCAndmFyaWFibGUtYWRkZWQnLCAoKSA9PiB7fSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOa3u+WKoOWNoeeJh1wiJHt2YXJpYWJsZS5uYW1lfVwi5aSx6LSlOmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog56e76Zmk5Y+Y6YeP5Y2h54mHXG4gICAqIEBwYXJhbSB2YXJpYWJsZV9pZCDlj5jph49JRFxuICAgKi9cbiAgcHVibGljIHJlbW92ZVZhcmlhYmxlQ2FyZCh2YXJpYWJsZV9pZDogc3RyaW5nKTogdm9pZCB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghdmFyaWFibGVfaWQpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBbVmFyaWFibGVNYW5hZ2VyXSDlj5jph49JROS4uuepuu+8jOaXoOazleenu+mZpOWNoeeJh2ApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0ICRjYXJkID0gdGhpcy5jb250YWluZXIuZmluZChgLnZhcmlhYmxlLWNhcmRbZGF0YS12YXJpYWJsZS1pZD1cIiR7dmFyaWFibGVfaWR9XCJdYCk7XG5cbiAgICAgIGlmICgkY2FyZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBbVmFyaWFibGVNYW5hZ2VyXSDmnKrmib7liLBJROS4ulwiJHt2YXJpYWJsZV9pZH1cIueahOWNoeeJh2ApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYWRkQW5pbWF0aW9uKCRjYXJkLCAndmFyaWFibGUtZGVsZXRlZCcsICgpID0+IHtcbiAgICAgICAgJGNhcmQucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuY2hlY2tBbmRTaG93RW1wdHlTdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOenu+mZpOWNoeeJh+Wksei0pTpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOajgOafpeW5tuaYvuekuuepuueKtuaAgeaPkOekulxuICAgKi9cbiAgcHJpdmF0ZSBjaGVja0FuZFNob3dFbXB0eVN0YXRlKCk6IHZvaWQge1xuICAgIGNvbnN0IGFjdGl2ZVR5cGUgPSB0aGlzLmdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpO1xuICAgIGNvbnN0ICR2YXJpYWJsZUxpc3QgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAjJHthY3RpdmVUeXBlfS1jb250ZW50IC52YXJpYWJsZS1saXN0YCk7XG5cbiAgICBpZiAoJHZhcmlhYmxlTGlzdC5maW5kKCcudmFyaWFibGUtY2FyZCcpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgJHZhcmlhYmxlTGlzdC5odG1sKCc8ZGl2IGNsYXNzPVwiZW1wdHktc3RhdGVcIj48cD7mmoLml6Dlj5jph488L3A+PC9kaXY+Jyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOWPmOmHj+WNoeeJh1xuICAgKiBAcGFyYW0gdmFyaWFibGUg5Y+Y6YePXG4gICAqL1xuICBwdWJsaWMgdXBkYXRlVmFyaWFibGVDYXJkKHZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0pOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgJGNhcmQgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAudmFyaWFibGUtY2FyZFtkYXRhLXZhcmlhYmxlLWlkPVwiJHt2YXJpYWJsZS5pZH1cIl1gKTtcblxuICAgICAgaWYgKCRjYXJkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zb2xlLndhcm4oYFtWYXJpYWJsZU1hbmFnZXJdIOacquaJvuWIsElE5Li6XCIke3ZhcmlhYmxlLmlkfVwi55qE5Y2h54mHYCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8g5Yib5bu65paw5Y2h54mH5pu/5o2i5pen5Y2h54mH77yM5L+d5oyB5LiA6Ie05oCnXG4gICAgICBjb25zdCBuZXdDYXJkID0gdGhpcy5jYXJkRmFjdG9yeS5jcmVhdGVDYXJkKHZhcmlhYmxlKTtcbiAgICAgIG5ld0NhcmQuYXR0cignZGF0YS10eXBlJywgdmFyaWFibGUuZGF0YVR5cGUpO1xuXG4gICAgICBpZiAodmFyaWFibGUubWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG5ld0NhcmQuYXR0cignZGF0YS1mbG9vci1pZCcsIHZhcmlhYmxlLm1lc3NhZ2VfaWQudG9TdHJpbmcoKSk7XG4gICAgICB9XG5cbiAgICAgICRjYXJkLnJlcGxhY2VXaXRoKG5ld0NhcmQpO1xuICAgICAgdGhpcy5hZGRBbmltYXRpb24obmV3Q2FyZCwgJ3ZhcmlhYmxlLWNoYW5nZWQnLCAoKSA9PiB7fSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOabtOaWsOWNoeeJh+Wksei0pTpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuumUruWQjei+k+WFpeWvueivneahhlxuICAgKiBAcGFyYW0gY2FsbGJhY2sg6L6T5YWl5a6M5oiQ5ZCO55qE5Zue6LCD5Ye95pWwXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2hvd0tleU5hbWVJbnB1dERpYWxvZyhjYWxsYmFjazogKGtleU5hbWU6IHN0cmluZyB8IG51bGwpID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZW50ID0gJChgXG4gICAgICA8ZGl2PlxuICAgICAgICA8aDM+6L6T5YWl6ZSu5ZCNPC9oMz5cbiAgICAgICAgPGRpdiBjbGFzcz1cImtleS1pbnB1dC1kaWFsb2dcIj5cbiAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBpZD1cImtleS1pbnB1dFwiIHBsYWNlaG9sZGVyPVwi6K+36L6T5YWl6ZSu5ZCNXCIgLz5cbiAgICAgICAgICA8ZGl2IGlkPVwia2V5LWlucHV0LWVycm9yXCIgY2xhc3M9XCJpbnB1dC1lcnJvclwiIHN0eWxlPVwiZGlzcGxheTogbm9uZVwiPuivt+i+k+WFpeacieaViOeahOmUruWQjTwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIGApO1xuXG4gICAgY29uc3QgJGlucHV0RmllbGQgPSBjb250ZW50LmZpbmQoJyNrZXktaW5wdXQnKTtcbiAgICBjb25zdCAkZXJyb3JNc2cgPSBjb250ZW50LmZpbmQoJyNrZXktaW5wdXQtZXJyb3InKTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoY29udGVudCwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgb2tCdXR0b246ICfnoa7orqQnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICB9KTtcblxuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBrZXlOYW1lID0gJGlucHV0RmllbGQudmFsKCkgYXMgc3RyaW5nO1xuICAgIGlmICgha2V5TmFtZSB8fCBrZXlOYW1lLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgICRlcnJvck1zZy5zaG93KCk7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuc2hvd0tleU5hbWVJbnB1dERpYWxvZyhjYWxsYmFjayksIDEwKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYWxsYmFjayhrZXlOYW1lLnRyaW0oKSk7XG4gIH1cblxuICAvKipcbiAgICog5re75Yqg5Yqo55S75pWI5p6cXG4gICAqIEBwYXJhbSBlbGVtZW50IOimgea3u+WKoOWKqOeUu+aViOaenOeahOWFg+e0oFxuICAgKiBAcGFyYW0gYW5pbWF0aW9uQ2xhc3MgQ1NT5Yqo55S757G75ZCNXG4gICAqIEBwYXJhbSBjYWxsYmFjayDliqjnlLvnu5PmnZ/lkI7nmoTlm57osINcbiAgICovXG4gIHB1YmxpYyBhZGRBbmltYXRpb24oZWxlbWVudDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgYW5pbWF0aW9uQ2xhc3M6IHN0cmluZywgY2FsbGJhY2s6ICgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICBjb25zdCBuYW1lc3BhY2UgPSBgYW5pbWF0aW9uLiR7YW5pbWF0aW9uQ2xhc3N9YDtcblxuICAgIGVsZW1lbnQuYWRkQ2xhc3MoYW5pbWF0aW9uQ2xhc3MpO1xuXG4gICAgdm9pZCBlbGVtZW50WzBdLm9mZnNldEhlaWdodDtcblxuICAgIGVsZW1lbnQub2ZmKGBhbmltYXRpb25lbmQuJHtuYW1lc3BhY2V9YCk7XG5cbiAgICBlbGVtZW50Lm9uKGBhbmltYXRpb25lbmQuJHtuYW1lc3BhY2V9YCwgZnVuY3Rpb24gKCkge1xuICAgICAgJCh0aGlzKS5vZmYoYGFuaW1hdGlvbmVuZC4ke25hbWVzcGFjZX1gKTtcbiAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoYW5pbWF0aW9uQ2xhc3MpO1xuICAgICAgY2FsbGJhY2soKTtcbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/view.ts\n")},"./src/function/builtin.ts":
/*!*********************************!*\
  !*** ./src/function/builtin.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   builtin: () => (/* binding */ builtin)\n/* harmony export */ });\n/* harmony import */ var _compatibility__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/compatibility */ "./src/compatibility.ts");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n\n\nconst builtin = {\n    addOneMessage: _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.addOneMessage,\n    saveSettings: _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveSettings,\n    reloadEditor: _compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditor,\n    reloadEditorDebounced: _compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditorDebounced,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vYnVpbHRpbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0U7QUFDSjtBQUUzRCxNQUFNLE9BQU8sR0FBRztJQUNyQixhQUFhO0lBQ2IsWUFBWTtJQUNaLFlBQVk7SUFDWixxQkFBcUI7Q0FDdEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9idWlsdGluLnRzP2YyNzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVsb2FkRWRpdG9yLCByZWxvYWRFZGl0b3JEZWJvdW5jZWQgfSBmcm9tICdAL2NvbXBhdGliaWxpdHknO1xuaW1wb3J0IHsgYWRkT25lTWVzc2FnZSwgc2F2ZVNldHRpbmdzIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmV4cG9ydCBjb25zdCBidWlsdGluID0ge1xuICBhZGRPbmVNZXNzYWdlLFxuICBzYXZlU2V0dGluZ3MsXG4gIHJlbG9hZEVkaXRvcixcbiAgcmVsb2FkRWRpdG9yRGVib3VuY2VkLFxufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/builtin.ts\n')},"./src/function/character.ts":
/*!***********************************!*\
  !*** ./src/function/character.ts ***!
  \***********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Character: () => (/* binding */ Character),\n/* harmony export */   getCharAvatarPath: () => (/* binding */ getCharAvatarPath),\n/* harmony export */   getCharData: () => (/* binding */ getCharData),\n/* harmony export */   getChatHistoryBrief: () => (/* binding */ getChatHistoryBrief),\n/* harmony export */   getChatHistoryDetail: () => (/* binding */ getChatHistoryDetail)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n\n\nclass Character {\n    charData;\n    constructor(characterData) {\n        this.charData = characterData;\n    }\n    static find({ name, allowAvatar = true } = {}) {\n        if (name === undefined) {\n            // @ts-ignore\n            const currentChar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid];\n            if (currentChar) {\n                name = currentChar.avatar;\n                // allowAvatartrueavatar\n                allowAvatar = true;\n            }\n        }\n        const matches = (char) => !name || char.name === name || (allowAvatar && char.avatar === name);\n        const filteredCharacters = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters;\n        // id\n        if (allowAvatar && name) {\n            const characterByAvatar = filteredCharacters.find(char => char.avatar === name);\n            if (characterByAvatar) {\n                return characterByAvatar;\n            }\n        }\n        // \n        const matchingCharacters = name ? filteredCharacters.filter(matches) : filteredCharacters;\n        if (matchingCharacters.length > 1) {\n            console.warn(`: ${name}`);\n        }\n        if (matchingCharacters.length === 0) {\n            throw new Error(`ID: ${name}`);\n        }\n        return matchingCharacters[0];\n    }\n    static findCharacterIndex(name) {\n        const matchTypes = [\n            (a, b) => a === b,\n            (a, b) => a.startsWith(b),\n            (a, b) => a.includes(b),\n        ];\n        const exactAvatarMatch = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters.findIndex(x => x.avatar === name);\n        if (exactAvatarMatch !== -1) {\n            return exactAvatarMatch;\n        }\n        for (const matchType of matchTypes) {\n            const index = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters.findIndex(x => matchType(x.name.toLowerCase(), name.toLowerCase()));\n            if (index !== -1) {\n                return index;\n            }\n        }\n        return -1;\n    }\n    static async getChatsFromFiles(data, isGroupChat) {\n        const chat_dict = {};\n        const chat_list = Object.values(data)\n            .sort((a, b) => a['file_name'].localeCompare(b['file_name']))\n            .reverse();\n        const chat_promise = chat_list.map(async ({ file_name }) => {\n            // \n            const ch_name = isGroupChat ? '' : file_name.split(' - ')[0];\n            // Character.find\n            let characterData = null;\n            let avatar_url = '';\n            if (!isGroupChat && ch_name) {\n                characterData = Character.find({ name: ch_name });\n                if (characterData) {\n                    avatar_url = characterData.avatar;\n                }\n            }\n            const endpoint = isGroupChat ? '/api/chats/group/get' : '/api/chats/get';\n            const requestBody = isGroupChat\n                ? JSON.stringify({ id: file_name })\n                : JSON.stringify({\n                    ch_name: ch_name,\n                    file_name: file_name.replace('.jsonl', ''),\n                    avatar_url: avatar_url,\n                });\n            const chatResponse = await fetch(endpoint, {\n                method: 'POST',\n                headers: (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getRequestHeaders)(),\n                body: requestBody,\n                cache: 'no-cache',\n            });\n            if (!chatResponse.ok) {\n                return;\n            }\n            const currentChat = await chatResponse.json();\n            if (!isGroupChat) {\n                // remove the first message, which is metadata, only for individual chats\n                currentChat.shift();\n            }\n            chat_dict[file_name] = currentChat;\n        });\n        await Promise.all(chat_promise);\n        return chat_dict;\n    }\n    getCardData() {\n        return this.charData;\n    }\n    getAvatarId() {\n        return this.charData.avatar || '';\n    }\n    getRegexScripts() {\n        return this.charData.data?.extensions?.regex_scripts || [];\n    }\n    getCharacterBook() {\n        return this.charData.data?.character_book || null;\n    }\n    getWorldName() {\n        return this.charData.data?.extensions?.world || '';\n    }\n}\nfunction getCharData(name, allowAvatar = true) {\n    try {\n        const characterData = Character.find({ name, allowAvatar });\n        if (!characterData)\n            return null;\n        const character = new Character(characterData);\n        console.info(`, : ${name || ''}`);\n        return character.getCardData();\n    }\n    catch (error) {\n        console.error(`, : ${name || ''}`, error);\n        return null;\n    }\n}\nfunction getCharAvatarPath(name, allowAvatar = true) {\n    try {\n        const characterData = Character.find({ name, allowAvatar });\n        if (!characterData)\n            return null;\n        const character = new Character(characterData);\n        const avatarId = character.getAvatarId();\n        // getThumbnailUrlURL\n        const thumbnailPath = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getThumbnailUrl)('avatar', avatarId);\n        const targetAvatarImg = thumbnailPath.substring(thumbnailPath.lastIndexOf('=') + 1);\n        // charsPath\n        console.info(`, : ${name || ''}`);\n        return _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.charsPath + targetAvatarImg;\n    }\n    catch (error) {\n        console.error(`, : ${name || ''}`, error);\n        return null;\n    }\n}\nasync function getChatHistoryBrief(name, allowAvatar = true) {\n    try {\n        const characterData = Character.find({ name, allowAvatar });\n        if (!characterData)\n            return null;\n        const character = new Character(characterData);\n        const index = Character.findCharacterIndex(character.getAvatarId());\n        if (index === -1)\n            return null;\n        const chats = await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getPastCharacterChats)(index);\n        console.info(`, : ${name || ''}`);\n        return chats;\n    }\n    catch (error) {\n        console.error(`, : ${name || ''}`, error);\n        return null;\n    }\n}\nasync function getChatHistoryDetail(data, isGroupChat = false) {\n    try {\n        const result = await Character.getChatsFromFiles(data, isGroupChat);\n        console.info(``);\n        return result;\n    }\n    catch (error) {\n        console.error(``, error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFFcEUsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDO1lBQUUsT0FBTyxJQUFJLENBQUM7UUFFOUIsTUFBTSxLQUFLLEdBQUcsTUFBTSwwRUFBcUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNqRCxPQUFPLENBQUMsSUFBSSxDQUFDLHFCQUFxQixJQUFJLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQztRQUNsRCxPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQyxxQkFBcUIsSUFBSSxJQUFJLElBQUksRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQzFELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztBQUNILENBQUM7QUFFTSxLQUFLLFVBQVUsb0JBQW9CLENBQ3hDLElBQVcsRUFDWCxjQUF1QixLQUFLO0lBRTVCLElBQUksQ0FBQztRQUNILE1BQU0sTUFBTSxHQUFHLE1BQU0sU0FBUyxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxXQUFXLENBQUMsQ0FBQztRQUNwRSxPQUFPLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQzNCLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDbkMsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9jaGFyYWN0ZXIudHM/MzQ2OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjaGFyc1BhdGggfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5pbXBvcnQgeyBjaGFyYWN0ZXJzLCBnZXRQYXN0Q2hhcmFjdGVyQ2hhdHMsIGdldFJlcXVlc3RIZWFkZXJzLCBnZXRUaHVtYm5haWxVcmwsIHRoaXNfY2hpZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgdjFDaGFyRGF0YSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2NoYXItZGF0YSc7XG5cbmV4cG9ydCBjbGFzcyBDaGFyYWN0ZXIge1xuICBwcml2YXRlIGNoYXJEYXRhOiB2MUNoYXJEYXRhO1xuXG4gIGNvbnN0cnVjdG9yKGNoYXJhY3RlckRhdGE6IHYxQ2hhckRhdGEpIHtcbiAgICB0aGlzLmNoYXJEYXRhID0gY2hhcmFjdGVyRGF0YTtcbiAgfVxuXG4gIHN0YXRpYyBmaW5kKHsgbmFtZSwgYWxsb3dBdmF0YXIgPSB0cnVlIH06IHsgbmFtZT86IHN0cmluZzsgYWxsb3dBdmF0YXI/OiBib29sZWFuIH0gPSB7fSk6IHYxQ2hhckRhdGEge1xuICAgIGlmIChuYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNvbnN0IGN1cnJlbnRDaGFyID0gY2hhcmFjdGVyc1t0aGlzX2NoaWRdO1xuICAgICAgaWYgKGN1cnJlbnRDaGFyKSB7XG4gICAgICAgIG5hbWUgPSBjdXJyZW50Q2hhci5hdmF0YXI7XG4gICAgICAgIC8vIOehruS/nWFsbG93QXZhdGFy5Li6dHJ1Ze+8jOS7peS+v+WPr+S7pemAmui/h2F2YXRhcuWHhuehruafpeaJvuinkuiJslxuICAgICAgICBhbGxvd0F2YXRhciA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbWF0Y2hlcyA9IChjaGFyOiB7IGF2YXRhcjogc3RyaW5nOyBuYW1lOiBzdHJpbmcgfSkgPT5cbiAgICAgICFuYW1lIHx8IGNoYXIubmFtZSA9PT0gbmFtZSB8fCAoYWxsb3dBdmF0YXIgJiYgY2hhci5hdmF0YXIgPT09IG5hbWUpO1xuXG4gICAgY29uc3QgZmlsdGVyZWRDaGFyYWN0ZXJzID0gY2hhcmFjdGVycztcblxuICAgIC8vIOWmguaenOacieehruWumueahOinkuiJsuWktOWDj2lk5o+Q5L6b77yM5YiZ6L+U5Zue6K+l6KeS6ImyXG4gICAgaWYgKGFsbG93QXZhdGFyICYmIG5hbWUpIHtcbiAgICAgIGNvbnN0IGNoYXJhY3RlckJ5QXZhdGFyID0gZmlsdGVyZWRDaGFyYWN0ZXJzLmZpbmQoY2hhciA9PiBjaGFyLmF2YXRhciA9PT0gbmFtZSk7XG4gICAgICBpZiAoY2hhcmFjdGVyQnlBdmF0YXIpIHtcbiAgICAgICAgcmV0dXJuIGNoYXJhY3RlckJ5QXZhdGFyO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIOafpeaJvuaJgOacieWMuemFjeeahOinkuiJslxuICAgIGNvbnN0IG1hdGNoaW5nQ2hhcmFjdGVycyA9IG5hbWUgPyBmaWx0ZXJlZENoYXJhY3RlcnMuZmlsdGVyKG1hdGNoZXMpIDogZmlsdGVyZWRDaGFyYWN0ZXJzO1xuICAgIGlmIChtYXRjaGluZ0NoYXJhY3RlcnMubGVuZ3RoID4gMSkge1xuICAgICAgY29uc29sZS53YXJuKGDmib7liLDlpJrkuKrnrKblkIjmnaHku7bnmoTop5LoibLvvIzov5Tlm57lr7zlhaXml7bpl7TmnIDml6nnmoTop5LoibI6ICR7bmFtZX1gKTtcbiAgICB9XG5cbiAgICBpZiAobWF0Y2hpbmdDaGFyYWN0ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGDmj5DkvpvnmoTlkI3np7DmiJblpLTlg49JROS4ujogJHtuYW1lfe+8jOacquaJvuWIsOespuWQiOadoeS7tueahOinkuiJsmApO1xuICAgIH1cblxuICAgIHJldHVybiBtYXRjaGluZ0NoYXJhY3RlcnNbMF07XG4gIH1cblxuICBzdGF0aWMgZmluZENoYXJhY3RlckluZGV4KG5hbWU6IHN0cmluZyk6IG51bWJlciB7XG4gICAgY29uc3QgbWF0Y2hUeXBlcyA9IFtcbiAgICAgIChhOiBzdHJpbmcsIGI6IHN0cmluZykgPT4gYSA9PT0gYixcbiAgICAgIChhOiBzdHJpbmcsIGI6IHN0cmluZykgPT4gYS5zdGFydHNXaXRoKGIpLFxuICAgICAgKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiBhLmluY2x1ZGVzKGIpLFxuICAgIF07XG5cbiAgICBjb25zdCBleGFjdEF2YXRhck1hdGNoID0gY2hhcmFjdGVycy5maW5kSW5kZXgoeCA9PiB4LmF2YXRhciA9PT0gbmFtZSk7XG5cbiAgICBpZiAoZXhhY3RBdmF0YXJNYXRjaCAhPT0gLTEpIHtcbiAgICAgIHJldHVybiBleGFjdEF2YXRhck1hdGNoO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgbWF0Y2hUeXBlIG9mIG1hdGNoVHlwZXMpIHtcbiAgICAgIGNvbnN0IGluZGV4ID0gY2hhcmFjdGVycy5maW5kSW5kZXgoeCA9PiBtYXRjaFR5cGUoeC5uYW1lLnRvTG93ZXJDYXNlKCksIG5hbWUudG9Mb3dlckNhc2UoKSkpO1xuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIC0xO1xuICB9XG5cbiAgc3RhdGljIGFzeW5jIGdldENoYXRzRnJvbUZpbGVzKGRhdGE6IGFueVtdLCBpc0dyb3VwQ2hhdDogYm9vbGVhbik6IFByb21pc2U8UmVjb3JkPHN0cmluZywgYW55Pj4ge1xuICAgIGNvbnN0IGNoYXRfZGljdDogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgIGNvbnN0IGNoYXRfbGlzdCA9IE9iamVjdC52YWx1ZXMoZGF0YSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBhWydmaWxlX25hbWUnXS5sb2NhbGVDb21wYXJlKGJbJ2ZpbGVfbmFtZSddKSlcbiAgICAgIC5yZXZlcnNlKCk7XG5cbiAgICBjb25zdCBjaGF0X3Byb21pc2UgPSBjaGF0X2xpc3QubWFwKGFzeW5jICh7IGZpbGVfbmFtZSB9KSA9PiB7XG4gICAgICAvLyDku47mlofku7blkI3kuK3mj5Dlj5bop5LoibLlkI3np7DvvIjnoLTmipjlj7fliY3nmoTpg6jliIbvvIlcbiAgICAgIGNvbnN0IGNoX25hbWUgPSBpc0dyb3VwQ2hhdCA/ICcnIDogZmlsZV9uYW1lLnNwbGl0KCcgLSAnKVswXTtcblxuICAgICAgLy8g5L2/55SoQ2hhcmFjdGVyLmZpbmTmlrnms5Xmn6Xmib7op5LoibLvvIzojrflj5blpLTlg49cbiAgICAgIGxldCBjaGFyYWN0ZXJEYXRhID0gbnVsbDtcbiAgICAgIGxldCBhdmF0YXJfdXJsID0gJyc7XG5cbiAgICAgIGlmICghaXNHcm91cENoYXQgJiYgY2hfbmFtZSkge1xuICAgICAgICBjaGFyYWN0ZXJEYXRhID0gQ2hhcmFjdGVyLmZpbmQoeyBuYW1lOiBjaF9uYW1lIH0pO1xuICAgICAgICBpZiAoY2hhcmFjdGVyRGF0YSkge1xuICAgICAgICAgIGF2YXRhcl91cmwgPSBjaGFyYWN0ZXJEYXRhLmF2YXRhcjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBlbmRwb2ludCA9IGlzR3JvdXBDaGF0ID8gJy9hcGkvY2hhdHMvZ3JvdXAvZ2V0JyA6ICcvYXBpL2NoYXRzL2dldCc7XG4gICAgICBjb25zdCByZXF1ZXN0Qm9keSA9IGlzR3JvdXBDaGF0XG4gICAgICAgID8gSlNPTi5zdHJpbmdpZnkoeyBpZDogZmlsZV9uYW1lIH0pXG4gICAgICAgIDogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgY2hfbmFtZTogY2hfbmFtZSxcbiAgICAgICAgICAgIGZpbGVfbmFtZTogZmlsZV9uYW1lLnJlcGxhY2UoJy5qc29ubCcsICcnKSxcbiAgICAgICAgICAgIGF2YXRhcl91cmw6IGF2YXRhcl91cmwsXG4gICAgICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGNoYXRSZXNwb25zZSA9IGF3YWl0IGZldGNoKGVuZHBvaW50LCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiBnZXRSZXF1ZXN0SGVhZGVycygpLFxuICAgICAgICBib2R5OiByZXF1ZXN0Qm9keSxcbiAgICAgICAgY2FjaGU6ICduby1jYWNoZScsXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFjaGF0UmVzcG9uc2Uub2spIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjdXJyZW50Q2hhdCA9IGF3YWl0IGNoYXRSZXNwb25zZS5qc29uKCk7XG4gICAgICBpZiAoIWlzR3JvdXBDaGF0KSB7XG4gICAgICAgIC8vIHJlbW92ZSB0aGUgZmlyc3QgbWVzc2FnZSwgd2hpY2ggaXMgbWV0YWRhdGEsIG9ubHkgZm9yIGluZGl2aWR1YWwgY2hhdHNcbiAgICAgICAgY3VycmVudENoYXQuc2hpZnQoKTtcbiAgICAgIH1cbiAgICAgIGNoYXRfZGljdFtmaWxlX25hbWVdID0gY3VycmVudENoYXQ7XG4gICAgfSk7XG5cbiAgICBhd2FpdCBQcm9taXNlLmFsbChjaGF0X3Byb21pc2UpO1xuXG4gICAgcmV0dXJuIGNoYXRfZGljdDtcbiAgfVxuXG4gIGdldENhcmREYXRhKCk6IHYxQ2hhckRhdGEge1xuICAgIHJldHVybiB0aGlzLmNoYXJEYXRhO1xuICB9XG5cbiAgZ2V0QXZhdGFySWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jaGFyRGF0YS5hdmF0YXIgfHwgJyc7XG4gIH1cblxuICBnZXRSZWdleFNjcmlwdHMoKTogQXJyYXk8e1xuICAgIGlkOiBzdHJpbmc7XG4gICAgc2NyaXB0TmFtZTogc3RyaW5nO1xuICAgIGZpbmRSZWdleDogc3RyaW5nO1xuICAgIHJlcGxhY2VTdHJpbmc6IHN0cmluZztcbiAgICB0cmltU3RyaW5nczogc3RyaW5nW107XG4gICAgcGxhY2VtZW50OiBudW1iZXJbXTtcbiAgICBkaXNhYmxlZDogYm9vbGVhbjtcbiAgICBtYXJrZG93bk9ubHk6IGJvb2xlYW47XG4gICAgcHJvbXB0T25seTogYm9vbGVhbjtcbiAgICBydW5PbkVkaXQ6IGJvb2xlYW47XG4gICAgc3Vic3RpdHV0ZVJlZ2V4OiBudW1iZXIgfCBib29sZWFuO1xuICAgIG1pbkRlcHRoOiBudW1iZXI7XG4gICAgbWF4RGVwdGg6IG51bWJlcjtcbiAgfT4ge1xuICAgIHJldHVybiB0aGlzLmNoYXJEYXRhLmRhdGE/LmV4dGVuc2lvbnM/LnJlZ2V4X3NjcmlwdHMgfHwgW107XG4gIH1cblxuICBnZXRDaGFyYWN0ZXJCb29rKCk6IHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgZW50cmllczogQXJyYXk8e1xuICAgICAga2V5czogc3RyaW5nW107XG4gICAgICBzZWNvbmRhcnlfa2V5cz86IHN0cmluZ1tdO1xuICAgICAgY29tbWVudDogc3RyaW5nO1xuICAgICAgY29udGVudDogc3RyaW5nO1xuICAgICAgY29uc3RhbnQ6IGJvb2xlYW47XG4gICAgICBzZWxlY3RpdmU6IGJvb2xlYW47XG4gICAgICBpbnNlcnRpb25fb3JkZXI6IG51bWJlcjtcbiAgICAgIGVuYWJsZWQ6IGJvb2xlYW47XG4gICAgICBwb3NpdGlvbjogc3RyaW5nO1xuICAgICAgZXh0ZW5zaW9uczogYW55O1xuICAgICAgaWQ6IG51bWJlcjtcbiAgICB9PjtcbiAgfSB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLmNoYXJEYXRhLmRhdGE/LmNoYXJhY3Rlcl9ib29rIHx8IG51bGw7XG4gIH1cblxuICBnZXRXb3JsZE5hbWUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jaGFyRGF0YS5kYXRhPy5leHRlbnNpb25zPy53b3JsZCB8fCAnJztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhckRhdGEobmFtZT86IHN0cmluZywgYWxsb3dBdmF0YXI6IGJvb2xlYW4gPSB0cnVlKTogdjFDaGFyRGF0YSB8IG51bGwge1xuICB0cnkge1xuICAgIGNvbnN0IGNoYXJhY3RlckRhdGEgPSBDaGFyYWN0ZXIuZmluZCh7IG5hbWUsIGFsbG93QXZhdGFyIH0pO1xuICAgIGlmICghY2hhcmFjdGVyRGF0YSkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCBjaGFyYWN0ZXIgPSBuZXcgQ2hhcmFjdGVyKGNoYXJhY3RlckRhdGEpO1xuICAgIGNvbnNvbGUuaW5mbyhg6I635Y+W6KeS6Imy5Y2h5pWw5o2u5oiQ5YqfLCDop5LoibI6ICR7bmFtZSB8fCAn5pyq55+lJ31gKTtcbiAgICByZXR1cm4gY2hhcmFjdGVyLmdldENhcmREYXRhKCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihg6I635Y+W6KeS6Imy5Y2h5pWw5o2u5aSx6LSlLCDop5LoibI6ICR7bmFtZSB8fCAn5pyq55+lJ31gLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENoYXJBdmF0YXJQYXRoKG5hbWU/OiBzdHJpbmcsIGFsbG93QXZhdGFyOiBib29sZWFuID0gdHJ1ZSk6IHN0cmluZyB8IG51bGwge1xuICB0cnkge1xuICAgIGNvbnN0IGNoYXJhY3RlckRhdGEgPSBDaGFyYWN0ZXIuZmluZCh7IG5hbWUsIGFsbG93QXZhdGFyIH0pO1xuICAgIGlmICghY2hhcmFjdGVyRGF0YSkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCBjaGFyYWN0ZXIgPSBuZXcgQ2hhcmFjdGVyKGNoYXJhY3RlckRhdGEpO1xuICAgIGNvbnN0IGF2YXRhcklkID0gY2hhcmFjdGVyLmdldEF2YXRhcklkKCk7XG5cbiAgICAvLyDkvb/nlKhnZXRUaHVtYm5haWxVcmzojrflj5bnvKnnlaXlm75VUkzvvIznhLblkI7mj5Dlj5blrp7pmYXmlofku7blkI1cbiAgICBjb25zdCB0aHVtYm5haWxQYXRoID0gZ2V0VGh1bWJuYWlsVXJsKCdhdmF0YXInLCBhdmF0YXJJZCk7XG4gICAgY29uc3QgdGFyZ2V0QXZhdGFySW1nID0gdGh1bWJuYWlsUGF0aC5zdWJzdHJpbmcodGh1bWJuYWlsUGF0aC5sYXN0SW5kZXhPZignPScpICsgMSk7XG5cbiAgICAvLyDlgYforr5jaGFyc1BhdGjlnKjlhbbku5blnLDmlrnlrprkuYlcbiAgICBjb25zb2xlLmluZm8oYOiOt+WPluinkuiJsuWktOWDj+i3r+W+hOaIkOWKnywg6KeS6ImyOiAke25hbWUgfHwgJ+acquefpSd9YCk7XG4gICAgcmV0dXJuIGNoYXJzUGF0aCArIHRhcmdldEF2YXRhckltZztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGDojrflj5bop5LoibLlpLTlg4/ot6/lvoTlpLHotKUsIOinkuiJsjogJHtuYW1lIHx8ICfmnKrnn6UnfWAsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhdEhpc3RvcnlCcmllZihuYW1lPzogc3RyaW5nLCBhbGxvd0F2YXRhcjogYm9vbGVhbiA9IHRydWUpOiBQcm9taXNlPGFueVtdIHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNoYXJhY3RlckRhdGEgPSBDaGFyYWN0ZXIuZmluZCh7IG5hbWUsIGFsbG93QXZhdGFyIH0pO1xuICAgIGlmICghY2hhcmFjdGVyRGF0YSkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCBjaGFyYWN0ZXIgPSBuZXcgQ2hhcmFjdGVyKGNoYXJhY3RlckRhdGEpO1xuICAgIGNvbnN0IGluZGV4ID0gQ2hhcmFjdGVyLmZpbmRDaGFyYWN0ZXJJbmRleChjaGFyYWN0ZXIuZ2V0QXZhdGFySWQoKSk7XG5cbiAgICBpZiAoaW5kZXggPT09IC0xKSByZXR1cm4gbnVsbDtcblxuICAgIGNvbnN0IGNoYXRzID0gYXdhaXQgZ2V0UGFzdENoYXJhY3RlckNoYXRzKGluZGV4KTtcbiAgICBjb25zb2xlLmluZm8oYOiOt+WPluinkuiJsuiBiuWkqeWOhuWPsuaRmOimgeaIkOWKnywg6KeS6ImyOiAke25hbWUgfHwgJ+acquefpSd9YCk7XG4gICAgcmV0dXJuIGNoYXRzO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoYOiOt+WPluinkuiJsuiBiuWkqeWOhuWPsuaRmOimgeWksei0pSwg6KeS6ImyOiAke25hbWUgfHwgJ+acquefpSd9YCwgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDaGF0SGlzdG9yeURldGFpbChcbiAgZGF0YTogYW55W10sXG4gIGlzR3JvdXBDaGF0OiBib29sZWFuID0gZmFsc2UsXG4pOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQ2hhcmFjdGVyLmdldENoYXRzRnJvbUZpbGVzKGRhdGEsIGlzR3JvdXBDaGF0KTtcbiAgICBjb25zb2xlLmluZm8oYOiOt+WPluiBiuWkqeaWh+S7tuivpuaDheaIkOWKn2ApO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihg6I635Y+W6IGK5aSp5paH5Lu26K+m5oOF5aSx6LSlYCwgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/character.ts\n")},"./src/function/chat_message.ts":
/*!**************************************!*\
  !*** ./src/function/chat_message.ts ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createChatMessages: () => (/* binding */ createChatMessages),\n/* harmony export */   deleteChatMessages: () => (/* binding */ deleteChatMessages),\n/* harmony export */   getChatMessages: () => (/* binding */ getChatMessages),\n/* harmony export */   rotateChatMessages: () => (/* binding */ rotateChatMessages),\n/* harmony export */   setChatMessage: () => (/* binding */ setChatMessage),\n/* harmony export */   setChatMessages: () => (/* binding */ setChatMessages)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n\nfunction string_to_range(input, min, max) {\n    let start, end;\n    if (input.match(/^(-?\\d+)$/)) {\n        const value = Number(input);\n        start = end = value < 0 ? max + value + 1 : value;\n    }\n    else {\n        const match = input.match(/^(-?\\d+)-(-?\\d+)$/);\n        if (!match) {\n            return null;\n        }\n        [start, end] = _.sortBy([match[1], match[2]].map(value => Number(value)).map(value => (value < 0 ? max + value + 1 : value)));\n    }\n    if (isNaN(start) || isNaN(end) || start > end || start < min || end > max) {\n        return null;\n    }\n    return { start, end };\n}\nfunction getChatMessages(range, { role = 'all', hide_state = 'all', include_swipes = false } = {}) {\n    const range_demacroed = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParamsExtended)(range.toString());\n    const range_number = string_to_range(range_demacroed, 0, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length - 1);\n    if (!range_number) {\n        throw Error(` range : ${range}`);\n    }\n    if (!['all', 'system', 'assistant', 'user'].includes(role)) {\n        throw Error(` role ,  'all', 'system', 'assistant'  'user', : ${role}`);\n    }\n    if (!['all', 'hidden', 'unhidden'].includes(hide_state)) {\n        throw Error(` hide_state ,  'all', 'hidden'  'unhidden', : ${hide_state}`);\n    }\n    const { start, end } = range_number;\n    const get_role = (chat_message) => {\n        const is_narrator = chat_message.extra?.type === _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.system_message_types.NARRATOR;\n        if (is_narrator) {\n            if (chat_message.is_user) {\n                return 'unknown';\n            }\n            return 'system';\n        }\n        if (chat_message.is_user) {\n            return 'user';\n        }\n        return 'assistant';\n    };\n    const process_message = (message_id) => {\n        const message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[message_id];\n        if (!message) {\n            console.warn(` ${message_id} `);\n            return null;\n        }\n        const message_role = get_role(message);\n        if (role !== 'all' && message_role !== role) {\n            console.debug(` ${message_id}  ${role}`);\n            return null;\n        }\n        if (hide_state !== 'all' && (hide_state === 'hidden') !== message.is_system) {\n            console.debug(` ${message_id} ${hide_state === 'hidden' ? `` : ``} `);\n            return null;\n        }\n        const swipe_id = message?.swipe_id ?? 0;\n        const swipes = message?.swipes ?? [message.mes];\n        const swipes_data = message?.variables ?? [{}];\n        const swipes_info = message?.swipes_info ?? [message?.extra ?? {}];\n        const extra = swipes_info[swipe_id];\n        const data = swipes_data[swipe_id];\n        if (include_swipes) {\n            return {\n                message_id: message_id,\n                name: message.name,\n                role: message_role,\n                is_hidden: message.is_system,\n                swipe_id: swipe_id,\n                swipes: swipes,\n                swipes_data: swipes_data,\n                swipes_info: swipes_info,\n            };\n        }\n        return {\n            message_id: message_id,\n            name: message.name,\n            role: message_role,\n            is_hidden: message.is_system,\n            message: message.mes,\n            data: data,\n            extra: extra,\n            // for compatibility\n            swipe_id: swipe_id,\n            swipes: swipes,\n            swipes_data: swipes_data,\n        };\n    };\n    const chat_messages = _.range(start, end + 1)\n        .map(i => process_message(i))\n        .filter(chat_message => chat_message !== null);\n    console.info(`${start == end ? ` ${start} ` : ` ${start}-${end} `}, : ${JSON.stringify({\n        role,\n        hide_state,\n        include_swipes,\n    })} `);\n    return structuredClone(chat_messages);\n}\nasync function setChatMessages(chat_messages, { refresh = 'affected' } = {}) {\n    const is_chat_message = (chat_message) => {\n        return _.has(chat_message, 'message') || _.has(chat_message, 'data');\n    };\n    const modify = async (chat_message) => {\n        const data = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[chat_message.message_id];\n        if (data === undefined) {\n            return;\n        }\n        if (chat_message?.name !== undefined) {\n            _.set(data, 'name', chat_message.name);\n        }\n        if (chat_message?.role !== undefined) {\n            _.set(data, 'is_user', chat_message.role === 'user');\n        }\n        if (chat_message?.is_hidden !== undefined) {\n            _.set(data, 'is_system', chat_message.is_hidden);\n        }\n        if (is_chat_message(chat_message)) {\n            if (chat_message?.message !== undefined) {\n                _.set(data, 'mes', chat_message.message);\n                if (data?.swipes !== undefined) {\n                    _.set(data, ['swipes', data.swipe_id], chat_message.message);\n                }\n            }\n            if (chat_message?.data !== undefined) {\n                if (data?.variables === undefined) {\n                    _.set(data, 'variables', _.times(data.swipes?.length ?? 1, _.constant({})));\n                }\n                _.set(data, ['variables', data.swipe_id ?? 0], chat_message.data);\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('message_variables_changed', {\n                    message_id: chat_message.message_id,\n                    variables: chat_message.data,\n                });\n            }\n            if (chat_message?.extra !== undefined) {\n                if (data?.swipes_info === undefined) {\n                    _.set(data, 'swipes_info', _.times(data.swipes?.length ?? 1, _.constant({})));\n                }\n                _.set(data, 'extra', chat_message?.extra);\n                _.set(data, ['swipes_info', data.swipe_id ?? 0], chat_message?.extra);\n            }\n        }\n        else if (chat_message?.swipe_id !== undefined ||\n            chat_message?.swipes !== undefined ||\n            chat_message?.swipes_data !== undefined ||\n            chat_message?.swipes_info !== undefined) {\n            _.set(chat_message, 'swipe_id', chat_message.swipe_id ?? data.swipe_id ?? 0);\n            _.set(chat_message, 'swipes', chat_message.swipes ?? data.swipes ?? [data.mes]);\n            _.set(chat_message, 'swipes_data', chat_message.swipes_data ?? data.variables ?? [{}]);\n            _.set(chat_message, 'swipes_info', chat_message.swipes_info ?? data.swipes_info ?? [{}]);\n            const max_length = _.max([chat_message.swipes?.length, chat_message.swipes_data?.length, chat_message.swipes_info?.length]) ?? 1;\n            chat_message.swipes.length = max_length;\n            chat_message.swipes_data.length = max_length;\n            chat_message.swipes_info.length = max_length;\n            _.set(data, 'swipes', chat_message.swipes);\n            _.set(data, 'variables', chat_message.swipes_data);\n            _.set(data, 'swipes_info', chat_message.swipes_info);\n            _.set(data, 'swipe_id', chat_message.swipe_id);\n            _.set(data, 'mes', data.swipes[data.swipe_id]);\n            _.set(data, 'extra', data.swipes_info[data.swipe_id]);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('message_variables_changed', {\n                message_id: chat_message.message_id,\n                variables: chat_message.swipes_data[chat_message.swipe_id],\n            });\n        }\n    };\n    const render = async (message_id) => {\n        const $mes_html = $(`div.mes[mesid = \"${message_id}\"]`);\n        if (!$mes_html) {\n            return;\n        }\n        const chat_message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[message_id];\n        if (chat_message.swipes) {\n            $mes_html.find('.swipes-counter').text(`${chat_message.swipe_id + 1}\\u200b/\\u200b${chat_message.swipes.length}`);\n        }\n        $mes_html\n            .find('.mes_text')\n            .empty()\n            .append((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.messageFormatting)(chat_message.mes, chat_message.name, chat_message.is_system, chat_message.is_user, message_id));\n        await _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(chat_message.is_user ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, message_id);\n    };\n    await Promise.all(chat_messages.map(modify));\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    else if (refresh === 'affected') {\n        await Promise.all(chat_messages.map(message => render(message.message_id)));\n    }\n    console.info(` '${chat_messages.map(message => message.message_id).join(', ')}' , : ${JSON.stringify({\n        refresh,\n    })}`);\n}\nasync function createChatMessages(chat_messages, { insert_at = 'end', refresh = 'all' } = {}) {\n    if (insert_at !== 'end') {\n        insert_at = insert_at < 0 ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length + insert_at : insert_at;\n        if (insert_at < 0 || insert_at > _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length) {\n            throw Error(` insert_at ,  '0'  '${_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length}' , : '${insert_at}'`);\n        }\n    }\n    const convert = async (chat_message) => {\n        const result = {};\n        if (chat_message?.name !== undefined) {\n            _.set(result, 'name', chat_message.name);\n        }\n        else if (chat_message.role === 'user') {\n            _.set(result, 'name', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1);\n        }\n        else {\n            _.set(result, 'name', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2);\n        }\n        // TODO: avatar\n        _.set(result, 'is_user', chat_message.role === 'user');\n        _.set(result, 'is_system', chat_message.is_hidden ?? false);\n        _.set(result, 'mes', chat_message.message);\n        _.set(result, ['variables', 0], chat_message.data ?? {});\n        return result;\n    };\n    const converted = await Promise.all(chat_messages.map(convert));\n    if (insert_at === 'end') {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.push(...converted);\n    }\n    else {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.splice(insert_at, 0, ...converted);\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'affected' && insert_at === 'end') {\n        converted.forEach(message => (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.addOneMessage)(message));\n    }\n    else {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    console.info(`${insert_at === 'end' ? '' : ` ${insert_at} `} ${chat_messages.length} , : ${JSON.stringify({\n        insert_at,\n        refresh,\n    })}`);\n}\nasync function deleteChatMessages(message_ids, { refresh = 'all' } = {}) {\n    message_ids = message_ids.map(id => (id < 0 ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length + id : id)).filter(id => id >= 0 && id < _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length);\n    _.pullAt(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat, message_ids);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    console.info(` '${message_ids.join(', ')}' , : ${JSON.stringify({\n        refresh,\n    })}`);\n}\nasync function rotateChatMessages(begin, middle, end, { refresh = 'all' } = {}) {\n    const right_part = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.splice(middle, end - middle);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.splice(begin, 0, ...right_part);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    console.info(` '[${begin}, ${middle}) [${middle}, ${end})' , : ${JSON.stringify({\n        refresh,\n    })}`);\n}\n//----------------------------------------------------------------------------------------------------------------------\n/** @deprecated  `setChatMessages`  */\nasync function setChatMessage(field_values, message_id, { swipe_id = 'current', refresh = 'display_and_render_current', } = {}) {\n    field_values = typeof field_values === 'string' ? { message: field_values } : field_values;\n    if (typeof swipe_id !== 'number' && swipe_id !== 'current') {\n        throw Error(` swipe_id ,  'current' , : ${swipe_id} `);\n    }\n    if (!['none', 'display_current', 'display_and_render_current', 'all'].includes(refresh)) {\n        throw Error(` refresh ,  'none', 'display_current', 'display_and_render_current'  'all', : ${refresh} `);\n    }\n    const chat_message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.at(message_id);\n    if (!chat_message) {\n        console.warn(` ${message_id} `);\n        return;\n    }\n    const add_swipes_if_required = () => {\n        if (swipe_id === 'current') {\n            return false;\n        }\n        // swipe_id \n        if (swipe_id == 0 || (chat_message.swipes && swipe_id < chat_message.swipes.length)) {\n            return true;\n        }\n        if (!chat_message.swipes) {\n            chat_message.swipe_id = 0;\n            chat_message.swipes = [chat_message.mes];\n            chat_message.variables = [{}];\n        }\n        for (let i = chat_message.swipes.length; i <= swipe_id; ++i) {\n            chat_message.swipes.push('');\n            chat_message.variables.push({});\n        }\n        return true;\n    };\n    const swipe_id_previous_index = chat_message.swipe_id ?? 0;\n    const swipe_id_to_set_index = swipe_id == 'current' ? swipe_id_previous_index : swipe_id;\n    const swipe_id_to_use_index = refresh != 'none' ? swipe_id_to_set_index : swipe_id_previous_index;\n    const message = field_values.message ??\n        (chat_message.swipes ? chat_message.swipes[swipe_id_to_set_index] : undefined) ??\n        chat_message.mes;\n    const update_chat_message = () => {\n        const message_demacroed = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParamsExtended)(message);\n        if (field_values.data) {\n            if (!chat_message.variables) {\n                chat_message.variables = [];\n            }\n            chat_message.variables[swipe_id_to_set_index] = field_values.data;\n        }\n        if (chat_message.swipes) {\n            chat_message.swipes[swipe_id_to_set_index] = message_demacroed;\n            chat_message.swipe_id = swipe_id_to_use_index;\n        }\n        if (swipe_id_to_use_index === swipe_id_to_set_index) {\n            chat_message.mes = message_demacroed;\n        }\n    };\n    const update_partial_html = async (should_update_swipe) => {\n        // @ts-ignore\n        const mes_html = $(`div.mes[mesid = \"${message_id}\"]`);\n        if (!mes_html) {\n            return;\n        }\n        if (should_update_swipe) {\n            // FIXME: , swipes-counter ;  swipes-counter  \"Swipe # for All Messages\" \n            mes_html.find('.swipes-counter').text(`${swipe_id_to_use_index + 1}\\u200b/\\u200b${chat_message.swipes.length}`);\n        }\n        if (refresh != 'none') {\n            mes_html\n                .find('.mes_text')\n                .empty()\n                .append((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.messageFormatting)(message, chat_message.name, chat_message.is_system, chat_message.is_user, message_id));\n            if (refresh === 'display_and_render_current') {\n                await _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(chat_message.is_user ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, message_id);\n            }\n        }\n    };\n    const should_update_swipe = add_swipes_if_required();\n    update_chat_message();\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh == 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    else {\n        await update_partial_html(should_update_swipe);\n    }\n    console.info(` ${message_id} , : ${JSON.stringify({\n        swipe_id,\n        refresh,\n    })}, : ${swipe_id_previous_index}, : ${swipe_id_to_set_index}, : ${swipe_id_to_use_index} `);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSSxDQUFDLENBQUMsQ0FBQztZQUM3RSxDQUFDLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBRSxRQUFRLEVBQUUsWUFBWSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDaEYsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsYUFBYSxFQUFFLFlBQVksQ0FBQyxXQUFXLElBQUksSUFBSSxDQUFDLFNBQVMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDdkYsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsYUFBYSxFQUFFLFlBQVksQ0FBQyxXQUFXLElBQUksSUFBSSxDQUFDLFdBQVcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDekYsTUFBTSxVQUFVLEdBQ2QsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLFlBQVksQ0FBQyxXQUFXLEVBQUUsTUFBTSxFQUFFLFlBQVksQ0FBQyxXQUFXLEVBQUUsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDL0csWUFBWSxDQUFDLE1BQW1CLENBQUMsTUFBTSxHQUFHLFVBQVUsQ0FBQztZQUNyRCxZQUFZLENBQUMsV0FBcUMsQ0FBQyxNQUFNLEdBQUcsVUFBVSxDQUFDO1lBQ3ZFLFlBQVksQ0FBQyxXQUFxQyxDQUFDLE1BQU0sR0FBRyxVQUFVLENBQUM7WUFFeEUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUMzQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxXQUFXLEVBQUUsWUFBWSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ25ELENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLGFBQWEsRUFBRSxZQUFZLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDckQsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJ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QkFDTCxJQUFJLENBQUMsV0FBVyxDQUFDO2lCQUNqQixLQUFLLEVBQUU7aUJBQ1AsTUFBTSxDQUNMLHNFQUFpQixDQUFDLE9BQU8sRUFBRSxZQUFZLENBQUMsSUFBSSxFQUFFLFlBQVksQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsQ0FDeEcsQ0FBQztZQUNKLElBQUksT0FBTyxLQUFLLDRCQUE0QixFQUFFLENBQUM7Z0JBQzdDLE1BQU0sNERBQVcsQ0FBQyxJQUFJLENBQ3BCLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLDREQUFXLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLDREQUFXLENBQUMsMEJBQTBCLEVBQ2pHLFVBQVUsQ0FDWCxDQUFDO1lBQ0osQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDLENBQUM7SUFFRixNQUFNLG1CQUFtQixHQUFZLHNCQUFzQixFQUFFLENBQUM7SUFDOUQsbUJBQW1CLEVBQUUsQ0FBQztJQUN0QixNQUFNLHdFQUFtQixFQUFFLENBQUM7SUFDNUIsSUFBSSxPQUFPLElBQUksS0FBSyxFQUFFLENBQUM7UUFDckIsTUFBTSxzRUFBaUIsRUFBRSxDQUFDO0lBQzVCLENBQUM7U0FBTSxDQUFDO1FBQ04sTUFBTSxtQkFBbUIsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0lBQ2pELENBQUM7SUFFRCxPQUFPLENBQUMsSUFBSSxDQUNWLE9BQU8sVUFBVSxhQUFhLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDM0MsUUFBUTtRQUNSLE9BQU87S0FDUixDQUFDLGdCQUFnQix1QkFBdUIsYUFBYSxxQkFBcUIsZUFBZSxxQkFBcUIsR0FBRyxDQUNuSCxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9jaGF0X21lc3NhZ2UudHM/OTY3OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBhZGRPbmVNZXNzYWdlLFxuICBjaGF0LFxuICBldmVudF90eXBlcyxcbiAgZXZlbnRTb3VyY2UsXG4gIG1lc3NhZ2VGb3JtYXR0aW5nLFxuICBuYW1lMSxcbiAgbmFtZTIsXG4gIHJlbG9hZEN1cnJlbnRDaGF0LFxuICBzYXZlQ2hhdENvbmRpdGlvbmFsLFxuICBzdWJzdGl0dXRlUGFyYW1zRXh0ZW5kZWQsXG4gIHN5c3RlbV9tZXNzYWdlX3R5cGVzLFxufSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcblxuaW50ZXJmYWNlIENoYXRNZXNzYWdlIHtcbiAgbWVzc2FnZV9pZDogbnVtYmVyO1xuICBuYW1lOiBzdHJpbmc7XG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gIGlzX2hpZGRlbjogYm9vbGVhbjtcbiAgbWVzc2FnZTogc3RyaW5nO1xuICBkYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICBleHRyYTogUmVjb3JkPHN0cmluZywgYW55Pjtcbn1cblxuaW50ZXJmYWNlIENoYXRNZXNzYWdlU3dpcGVkIHtcbiAgbWVzc2FnZV9pZDogbnVtYmVyO1xuICBuYW1lOiBzdHJpbmc7XG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gIGlzX2hpZGRlbjogYm9vbGVhbjtcbiAgc3dpcGVfaWQ6IG51bWJlcjtcbiAgc3dpcGVzOiBzdHJpbmdbXTtcbiAgc3dpcGVzX2RhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXTtcbiAgc3dpcGVzX2luZm86IFJlY29yZDxzdHJpbmcsIGFueT5bXTtcbn1cblxuaW50ZXJmYWNlIEdldENoYXRNZXNzYWdlc09wdGlvbiB7XG4gIHJvbGU/OiAnYWxsJyB8ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gIGhpZGVfc3RhdGU/OiAnYWxsJyB8ICdoaWRkZW4nIHwgJ3VuaGlkZGVuJztcbiAgaW5jbHVkZV9zd2lwZXM/OiBib29sZWFuO1xufVxuXG5mdW5jdGlvbiBzdHJpbmdfdG9fcmFuZ2UoaW5wdXQ6IHN0cmluZywgbWluOiBudW1iZXIsIG1heDogbnVtYmVyKSB7XG4gIGxldCBzdGFydCwgZW5kO1xuXG4gIGlmIChpbnB1dC5tYXRjaCgvXigtP1xcZCspJC8pKSB7XG4gICAgY29uc3QgdmFsdWUgPSBOdW1iZXIoaW5wdXQpO1xuICAgIHN0YXJ0ID0gZW5kID0gdmFsdWUgPCAwID8gbWF4ICsgdmFsdWUgKyAxIDogdmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgbWF0Y2ggPSBpbnB1dC5tYXRjaCgvXigtP1xcZCspLSgtP1xcZCspJC8pO1xuICAgIGlmICghbWF0Y2gpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIFtzdGFydCwgZW5kXSA9IF8uc29ydEJ5KFxuICAgICAgW21hdGNoWzFdLCBtYXRjaFsyXV0ubWFwKHZhbHVlID0+IE51bWJlcih2YWx1ZSkpLm1hcCh2YWx1ZSA9PiAodmFsdWUgPCAwID8gbWF4ICsgdmFsdWUgKyAxIDogdmFsdWUpKSxcbiAgICApO1xuICB9XG5cbiAgaWYgKGlzTmFOKHN0YXJ0KSB8fCBpc05hTihlbmQpIHx8IHN0YXJ0ID4gZW5kIHx8IHN0YXJ0IDwgbWluIHx8IGVuZCA+IG1heCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiB7IHN0YXJ0LCBlbmQgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENoYXRNZXNzYWdlcyhcbiAgcmFuZ2U6IHN0cmluZyB8IG51bWJlcixcbiAgeyByb2xlLCBoaWRlX3N0YXRlLCBpbmNsdWRlX3N3aXBlcyB9PzogT21pdDxHZXRDaGF0TWVzc2FnZXNPcHRpb24sICdpbmNsdWRlX3N3aXBlcyc+ICYgeyBpbmNsdWRlX3N3aXBlcz86IGZhbHNlIH0sXG4pOiBDaGF0TWVzc2FnZVtdO1xuZXhwb3J0IGZ1bmN0aW9uIGdldENoYXRNZXNzYWdlcyhcbiAgcmFuZ2U6IHN0cmluZyB8IG51bWJlcixcbiAgeyByb2xlLCBoaWRlX3N0YXRlLCBpbmNsdWRlX3N3aXBlcyB9PzogT21pdDxHZXRDaGF0TWVzc2FnZXNPcHRpb24sICdpbmNsdWRlX3N3aXBlcyc+ICYgeyBpbmNsdWRlX3N3aXBlcz86IHRydWUgfSxcbik6IENoYXRNZXNzYWdlU3dpcGVkW107XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhdE1lc3NhZ2VzKFxuICByYW5nZTogc3RyaW5nIHwgbnVtYmVyLFxuICB7IHJvbGUgPSAnYWxsJywgaGlkZV9zdGF0ZSA9ICdhbGwnLCBpbmNsdWRlX3N3aXBlcyA9IGZhbHNlIH06IEdldENoYXRNZXNzYWdlc09wdGlvbiA9IHt9LFxuKTogKENoYXRNZXNzYWdlIHwgQ2hhdE1lc3NhZ2VTd2lwZWQpW10ge1xuICBjb25zdCByYW5nZV9kZW1hY3JvZWQgPSBzdWJzdGl0dXRlUGFyYW1zRXh0ZW5kZWQocmFuZ2UudG9TdHJpbmcoKSk7XG4gIGNvbnN0IHJhbmdlX251bWJlciA9IHN0cmluZ190b19yYW5nZShyYW5nZV9kZW1hY3JvZWQsIDAsIGNoYXQubGVuZ3RoIC0gMSk7XG4gIGlmICghcmFuZ2VfbnVtYmVyKSB7XG4gICAgdGhyb3cgRXJyb3IoYOaPkOS+m+eahOa2iOaBr+iMg+WbtCByYW5nZSDml6DmlYg6ICR7cmFuZ2V9YCk7XG4gIH1cbiAgaWYgKCFbJ2FsbCcsICdzeXN0ZW0nLCAnYXNzaXN0YW50JywgJ3VzZXInXS5pbmNsdWRlcyhyb2xlKSkge1xuICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgcm9sZSDml6DmlYgsIOivt+aPkOS+myAnYWxsJywgJ3N5c3RlbScsICdhc3Npc3RhbnQnIOaIliAndXNlcicsIOS9oOaPkOS+m+eahOaYrzogJHtyb2xlfWApO1xuICB9XG4gIGlmICghWydhbGwnLCAnaGlkZGVuJywgJ3VuaGlkZGVuJ10uaW5jbHVkZXMoaGlkZV9zdGF0ZSkpIHtcbiAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qEIGhpZGVfc3RhdGUg5peg5pWILCDor7fmj5DkvpsgJ2FsbCcsICdoaWRkZW4nIOaIliAndW5oaWRkZW4nLCDkvaDmj5DkvpvnmoTmmK86ICR7aGlkZV9zdGF0ZX1gKTtcbiAgfVxuXG4gIGNvbnN0IHsgc3RhcnQsIGVuZCB9ID0gcmFuZ2VfbnVtYmVyO1xuXG4gIGNvbnN0IGdldF9yb2xlID0gKGNoYXRfbWVzc2FnZTogYW55KSA9PiB7XG4gICAgY29uc3QgaXNfbmFycmF0b3IgPSBjaGF0X21lc3NhZ2UuZXh0cmE/LnR5cGUgPT09IHN5c3RlbV9tZXNzYWdlX3R5cGVzLk5BUlJBVE9SO1xuICAgIGlmIChpc19uYXJyYXRvcikge1xuICAgICAgaWYgKGNoYXRfbWVzc2FnZS5pc191c2VyKSB7XG4gICAgICAgIHJldHVybiAndW5rbm93bic7XG4gICAgICB9XG4gICAgICByZXR1cm4gJ3N5c3RlbSc7XG4gICAgfVxuICAgIGlmIChjaGF0X21lc3NhZ2UuaXNfdXNlcikge1xuICAgICAgcmV0dXJuICd1c2VyJztcbiAgICB9XG4gICAgcmV0dXJuICdhc3Npc3RhbnQnO1xuICB9O1xuXG4gIGNvbnN0IHByb2Nlc3NfbWVzc2FnZSA9IChtZXNzYWdlX2lkOiBudW1iZXIpOiAoQ2hhdE1lc3NhZ2UgfCBDaGF0TWVzc2FnZVN3aXBlZCkgfCBudWxsID0+IHtcbiAgICBjb25zdCBtZXNzYWdlID0gY2hhdFttZXNzYWdlX2lkXTtcbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgIGNvbnNvbGUud2Fybihg5rKh5om+5Yiw56ysICR7bWVzc2FnZV9pZH0g5qW855qE5raI5oGvYCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBtZXNzYWdlX3JvbGUgPSBnZXRfcm9sZShtZXNzYWdlKTtcbiAgICBpZiAocm9sZSAhPT0gJ2FsbCcgJiYgbWVzc2FnZV9yb2xlICE9PSByb2xlKSB7XG4gICAgICBjb25zb2xlLmRlYnVnKGDnrZvljrvkuobnrKwgJHttZXNzYWdlX2lkfSDmpbznmoTmtojmga/lm6DkuLrlroPnmoTouqvku73kuI3mmK8gJHtyb2xlfWApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGhpZGVfc3RhdGUgIT09ICdhbGwnICYmIChoaWRlX3N0YXRlID09PSAnaGlkZGVuJykgIT09IG1lc3NhZ2UuaXNfc3lzdGVtKSB7XG4gICAgICBjb25zb2xlLmRlYnVnKGDnrZvljrvkuobnrKwgJHttZXNzYWdlX2lkfSDmpbznmoTmtojmga/lm6DkuLrlroMke2hpZGVfc3RhdGUgPT09ICdoaWRkZW4nID8gYGAgOiBg5rKhYH0g6KKr6ZqQ6JePYCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBzd2lwZV9pZCA9IG1lc3NhZ2U/LnN3aXBlX2lkID8/IDA7XG4gICAgY29uc3Qgc3dpcGVzID0gbWVzc2FnZT8uc3dpcGVzID8/IFttZXNzYWdlLm1lc107XG4gICAgY29uc3Qgc3dpcGVzX2RhdGEgPSBtZXNzYWdlPy52YXJpYWJsZXMgPz8gW3t9XTtcbiAgICBjb25zdCBzd2lwZXNfaW5mbyA9IG1lc3NhZ2U/LnN3aXBlc19pbmZvID8/IFttZXNzYWdlPy5leHRyYSA/PyB7fV07XG4gICAgY29uc3QgZXh0cmEgPSBzd2lwZXNfaW5mb1tzd2lwZV9pZF07XG4gICAgY29uc3QgZGF0YSA9IHN3aXBlc19kYXRhW3N3aXBlX2lkXTtcblxuICAgIGlmIChpbmNsdWRlX3N3aXBlcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZV9pZDogbWVzc2FnZV9pZCxcbiAgICAgICAgbmFtZTogbWVzc2FnZS5uYW1lLFxuICAgICAgICByb2xlOiBtZXNzYWdlX3JvbGUgYXMgJ3N5c3RlbScgfCAnYXNzaXN0YW50JyB8ICd1c2VyJyxcbiAgICAgICAgaXNfaGlkZGVuOiBtZXNzYWdlLmlzX3N5c3RlbSxcbiAgICAgICAgc3dpcGVfaWQ6IHN3aXBlX2lkLFxuICAgICAgICBzd2lwZXM6IHN3aXBlcyxcbiAgICAgICAgc3dpcGVzX2RhdGE6IHN3aXBlc19kYXRhLFxuICAgICAgICBzd2lwZXNfaW5mbzogc3dpcGVzX2luZm8sXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgbWVzc2FnZV9pZDogbWVzc2FnZV9pZCxcbiAgICAgIG5hbWU6IG1lc3NhZ2UubmFtZSxcbiAgICAgIHJvbGU6IG1lc3NhZ2Vfcm9sZSBhcyAnc3lzdGVtJyB8ICdhc3Npc3RhbnQnIHwgJ3VzZXInLFxuICAgICAgaXNfaGlkZGVuOiBtZXNzYWdlLmlzX3N5c3RlbSxcbiAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UubWVzLFxuICAgICAgZGF0YTogZGF0YSxcbiAgICAgIGV4dHJhOiBleHRyYSxcblxuICAgICAgLy8gZm9yIGNvbXBhdGliaWxpdHlcbiAgICAgIHN3aXBlX2lkOiBzd2lwZV9pZCxcbiAgICAgIHN3aXBlczogc3dpcGVzLFxuICAgICAgc3dpcGVzX2RhdGE6IHN3aXBlc19kYXRhLFxuICAgIH07XG4gIH07XG5cbiAgY29uc3QgY2hhdF9tZXNzYWdlczogKENoYXRNZXNzYWdlIHwgQ2hhdE1lc3NhZ2VTd2lwZWQpW10gPSBfLnJhbmdlKHN0YXJ0LCBlbmQgKyAxKVxuICAgIC5tYXAoaSA9PiBwcm9jZXNzX21lc3NhZ2UoaSkpXG4gICAgLmZpbHRlcihjaGF0X21lc3NhZ2UgPT4gY2hhdF9tZXNzYWdlICE9PSBudWxsKTtcblxuICBjb25zb2xlLmluZm8oXG4gICAgYOiOt+WPliR7c3RhcnQgPT0gZW5kID8gYOesrCAke3N0YXJ0fSBgIDogYCAke3N0YXJ0fS0ke2VuZH0gYH3mpbznmoTmtojmga8sIOmAiemhuTogJHtKU09OLnN0cmluZ2lmeSh7XG4gICAgICByb2xlLFxuICAgICAgaGlkZV9zdGF0ZSxcbiAgICAgIGluY2x1ZGVfc3dpcGVzLFxuICAgIH0pfSBgLFxuICApO1xuICByZXR1cm4gc3RydWN0dXJlZENsb25lKGNoYXRfbWVzc2FnZXMpO1xufVxuXG5pbnRlcmZhY2UgU2V0Q2hhdE1lc3NhZ2VzT3B0aW9uIHtcbiAgcmVmcmVzaD86ICdub25lJyB8ICdhZmZlY3RlZCcgfCAnYWxsJztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldENoYXRNZXNzYWdlcyhcbiAgY2hhdF9tZXNzYWdlczogQXJyYXk8eyBtZXNzYWdlX2lkOiBudW1iZXIgfSAmIChQYXJ0aWFsPENoYXRNZXNzYWdlPiB8IFBhcnRpYWw8Q2hhdE1lc3NhZ2VTd2lwZWQ+KT4sXG4gIHsgcmVmcmVzaCA9ICdhZmZlY3RlZCcgfTogU2V0Q2hhdE1lc3NhZ2VzT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgaXNfY2hhdF9tZXNzYWdlID0gKFxuICAgIGNoYXRfbWVzc2FnZTogeyBtZXNzYWdlX2lkOiBudW1iZXIgfSAmIChQYXJ0aWFsPENoYXRNZXNzYWdlPiB8IFBhcnRpYWw8Q2hhdE1lc3NhZ2VTd2lwZWQ+KSxcbiAgKTogY2hhdF9tZXNzYWdlIGlzIHsgbWVzc2FnZV9pZDogbnVtYmVyIH0gJiBQYXJ0aWFsPENoYXRNZXNzYWdlPiA9PiB7XG4gICAgcmV0dXJuIF8uaGFzKGNoYXRfbWVzc2FnZSwgJ21lc3NhZ2UnKSB8fCBfLmhhcyhjaGF0X21lc3NhZ2UsICdkYXRhJyk7XG4gIH07XG5cbiAgY29uc3QgbW9kaWZ5ID0gYXN5bmMgKGNoYXRfbWVzc2FnZTogeyBtZXNzYWdlX2lkOiBudW1iZXIgfSAmIChQYXJ0aWFsPENoYXRNZXNzYWdlPiB8IFBhcnRpYWw8Q2hhdE1lc3NhZ2VTd2lwZWQ+KSkgPT4ge1xuICAgIGNvbnN0IGRhdGEgPSBjaGF0W2NoYXRfbWVzc2FnZS5tZXNzYWdlX2lkXTtcbiAgICBpZiAoZGF0YSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGNoYXRfbWVzc2FnZT8ubmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBfLnNldChkYXRhLCAnbmFtZScsIGNoYXRfbWVzc2FnZS5uYW1lKTtcbiAgICB9XG4gICAgaWYgKGNoYXRfbWVzc2FnZT8ucm9sZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBfLnNldChkYXRhLCAnaXNfdXNlcicsIGNoYXRfbWVzc2FnZS5yb2xlID09PSAndXNlcicpO1xuICAgIH1cbiAgICBpZiAoY2hhdF9tZXNzYWdlPy5pc19oaWRkZW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgXy5zZXQoZGF0YSwgJ2lzX3N5c3RlbScsIGNoYXRfbWVzc2FnZS5pc19oaWRkZW4pO1xuICAgIH1cblxuICAgIGlmIChpc19jaGF0X21lc3NhZ2UoY2hhdF9tZXNzYWdlKSkge1xuICAgICAgaWYgKGNoYXRfbWVzc2FnZT8ubWVzc2FnZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIF8uc2V0KGRhdGEsICdtZXMnLCBjaGF0X21lc3NhZ2UubWVzc2FnZSk7XG4gICAgICAgIGlmIChkYXRhPy5zd2lwZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIF8uc2V0KGRhdGEsIFsnc3dpcGVzJywgZGF0YS5zd2lwZV9pZF0sIGNoYXRfbWVzc2FnZS5tZXNzYWdlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGNoYXRfbWVzc2FnZT8uZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChkYXRhPy52YXJpYWJsZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIF8uc2V0KGRhdGEsICd2YXJpYWJsZXMnLCBfLnRpbWVzKGRhdGEuc3dpcGVzPy5sZW5ndGggPz8gMSwgXy5jb25zdGFudCh7fSkpKTtcbiAgICAgICAgfVxuICAgICAgICBfLnNldChkYXRhLCBbJ3ZhcmlhYmxlcycsIGRhdGEuc3dpcGVfaWQgPz8gMF0sIGNoYXRfbWVzc2FnZS5kYXRhKTtcbiAgICAgICAgZXZlbnRTb3VyY2UuZW1pdCgnbWVzc2FnZV92YXJpYWJsZXNfY2hhbmdlZCcsIHtcbiAgICAgICAgICBtZXNzYWdlX2lkOiBjaGF0X21lc3NhZ2UubWVzc2FnZV9pZCxcbiAgICAgICAgICB2YXJpYWJsZXM6IGNoYXRfbWVzc2FnZS5kYXRhLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChjaGF0X21lc3NhZ2U/LmV4dHJhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKGRhdGE/LnN3aXBlc19pbmZvID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBfLnNldChkYXRhLCAnc3dpcGVzX2luZm8nLCBfLnRpbWVzKGRhdGEuc3dpcGVzPy5sZW5ndGggPz8gMSwgXy5jb25zdGFudCh7fSkpKTtcbiAgICAgICAgfVxuICAgICAgICBfLnNldChkYXRhLCAnZXh0cmEnLCBjaGF0X21lc3NhZ2U/LmV4dHJhKTtcbiAgICAgICAgXy5zZXQoZGF0YSwgWydzd2lwZXNfaW5mbycsIGRhdGEuc3dpcGVfaWQgPz8gMF0sIGNoYXRfbWVzc2FnZT8uZXh0cmEpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoXG4gICAgICBjaGF0X21lc3NhZ2U/LnN3aXBlX2lkICE9PSB1bmRlZmluZWQgfHxcbiAgICAgIGNoYXRfbWVzc2FnZT8uc3dpcGVzICE9PSB1bmRlZmluZWQgfHxcbiAgICAgIGNoYXRfbWVzc2FnZT8uc3dpcGVzX2RhdGEgIT09IHVuZGVmaW5lZCB8fFxuICAgICAgY2hhdF9tZXNzYWdlPy5zd2lwZXNfaW5mbyAhPT0gdW5kZWZpbmVkXG4gICAgKSB7XG4gICAgICBfLnNldChjaGF0X21lc3NhZ2UsICdzd2lwZV9pZCcsIGNoYXRfbWVzc2FnZS5zd2lwZV9pZCA/PyBkYXRhLnN3aXBlX2lkID8/IDApO1xuICAgICAgXy5zZXQoY2hhdF9tZXNzYWdlLCAnc3dpcGVzJywgY2hhdF9tZXNzYWdlLnN3aXBlcyA/PyBkYXRhLnN3aXBlcyA/PyBbZGF0YS5tZXNdKTtcbiAgICAgIF8uc2V0KGNoYXRfbWVzc2FnZSwgJ3N3aXBlc19kYXRhJywgY2hhdF9tZXNzYWdlLnN3aXBlc19kYXRhID8/IGRhdGEudmFyaWFibGVzID8/IFt7fV0pO1xuICAgICAgXy5zZXQoY2hhdF9tZXNzYWdlLCAnc3dpcGVzX2luZm8nLCBjaGF0X21lc3NhZ2Uuc3dpcGVzX2luZm8gPz8gZGF0YS5zd2lwZXNfaW5mbyA/PyBbe31dKTtcbiAgICAgIGNvbnN0IG1heF9sZW5ndGggPVxuICAgICAgICBfLm1heChbY2hhdF9tZXNzYWdlLnN3aXBlcz8ubGVuZ3RoLCBjaGF0X21lc3NhZ2Uuc3dpcGVzX2RhdGE/Lmxlbmd0aCwgY2hhdF9tZXNzYWdlLnN3aXBlc19pbmZvPy5sZW5ndGhdKSA/PyAxO1xuICAgICAgKGNoYXRfbWVzc2FnZS5zd2lwZXMgYXMgc3RyaW5nW10pLmxlbmd0aCA9IG1heF9sZW5ndGg7XG4gICAgICAoY2hhdF9tZXNzYWdlLnN3aXBlc19kYXRhIGFzIFJlY29yZDxzdHJpbmcsIGFueT5bXSkubGVuZ3RoID0gbWF4X2xlbmd0aDtcbiAgICAgIChjaGF0X21lc3NhZ2Uuc3dpcGVzX2luZm8gYXMgUmVjb3JkPHN0cmluZywgYW55PltdKS5sZW5ndGggPSBtYXhfbGVuZ3RoO1xuXG4gICAgICBfLnNldChkYXRhLCAnc3dpcGVzJywgY2hhdF9tZXNzYWdlLnN3aXBlcyk7XG4gICAgICBfLnNldChkYXRhLCAndmFyaWFibGVzJywgY2hhdF9tZXNzYWdlLnN3aXBlc19kYXRhKTtcbiAgICAgIF8uc2V0KGRhdGEsICdzd2lwZXNfaW5mbycsIGNoYXRfbWVzc2FnZS5zd2lwZXNfaW5mbyk7XG4gICAgICBfLnNldChkYXRhLCAnc3dpcGVfaWQnLCBjaGF0X21lc3NhZ2Uuc3dpcGVfaWQpO1xuICAgICAgXy5zZXQoZGF0YSwgJ21lcycsIGRhdGEuc3dpcGVzW2RhdGEuc3dpcGVfaWRdKTtcbiAgICAgIF8uc2V0KGRhdGEsICdleHRyYScsIGRhdGEuc3dpcGVzX2luZm9bZGF0YS5zd2lwZV9pZF0pO1xuXG4gICAgICBldmVudFNvdXJjZS5lbWl0KCdtZXNzYWdlX3ZhcmlhYmxlc19jaGFuZ2VkJywge1xuICAgICAgICBtZXNzYWdlX2lkOiBjaGF0X21lc3NhZ2UubWVzc2FnZV9pZCxcbiAgICAgICAgdmFyaWFibGVzOiAoY2hhdF9tZXNzYWdlLnN3aXBlc19kYXRhIGFzIFJlY29yZDxzdHJpbmcsIGFueT5bXSlbY2hhdF9tZXNzYWdlLnN3aXBlX2lkIGFzIG51bWJlcl0sXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcmVuZGVyID0gYXN5bmMgKG1lc3NhZ2VfaWQ6IG51bWJlcikgPT4ge1xuICAgIGNvbnN0ICRtZXNfaHRtbCA9ICQoYGRpdi5tZXNbbWVzaWQgPSBcIiR7bWVzc2FnZV9pZH1cIl1gKTtcbiAgICBpZiAoISRtZXNfaHRtbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGNoYXRfbWVzc2FnZSA9IGNoYXRbbWVzc2FnZV9pZF07XG4gICAgaWYgKGNoYXRfbWVzc2FnZS5zd2lwZXMpIHtcbiAgICAgICRtZXNfaHRtbC5maW5kKCcuc3dpcGVzLWNvdW50ZXInKS50ZXh0KGAke2NoYXRfbWVzc2FnZS5zd2lwZV9pZCArIDF9XFx1MjAwYi9cXHUyMDBiJHtjaGF0X21lc3NhZ2Uuc3dpcGVzLmxlbmd0aH1gKTtcbiAgICB9XG4gICAgJG1lc19odG1sXG4gICAgICAuZmluZCgnLm1lc190ZXh0JylcbiAgICAgIC5lbXB0eSgpXG4gICAgICAuYXBwZW5kKFxuICAgICAgICBtZXNzYWdlRm9ybWF0dGluZyhcbiAgICAgICAgICBjaGF0X21lc3NhZ2UubWVzLFxuICAgICAgICAgIGNoYXRfbWVzc2FnZS5uYW1lLFxuICAgICAgICAgIGNoYXRfbWVzc2FnZS5pc19zeXN0ZW0sXG4gICAgICAgICAgY2hhdF9tZXNzYWdlLmlzX3VzZXIsXG4gICAgICAgICAgbWVzc2FnZV9pZCxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgYXdhaXQgZXZlbnRTb3VyY2UuZW1pdChcbiAgICAgIGNoYXRfbWVzc2FnZS5pc191c2VyID8gZXZlbnRfdHlwZXMuVVNFUl9NRVNTQUdFX1JFTkRFUkVEIDogZXZlbnRfdHlwZXMuQ0hBUkFDVEVSX01FU1NBR0VfUkVOREVSRUQsXG4gICAgICBtZXNzYWdlX2lkLFxuICAgICk7XG4gIH07XG5cbiAgYXdhaXQgUHJvbWlzZS5hbGwoY2hhdF9tZXNzYWdlcy5tYXAobW9kaWZ5KSk7XG4gIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgaWYgKHJlZnJlc2ggPT09ICdhbGwnKSB7XG4gICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgfSBlbHNlIGlmIChyZWZyZXNoID09PSAnYWZmZWN0ZWQnKSB7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoY2hhdF9tZXNzYWdlcy5tYXAobWVzc2FnZSA9PiByZW5kZXIobWVzc2FnZS5tZXNzYWdlX2lkKSkpO1xuICB9XG4gIGNvbnNvbGUuaW5mbyhcbiAgICBg5L+u5pS556ysICcke2NoYXRfbWVzc2FnZXMubWFwKG1lc3NhZ2UgPT4gbWVzc2FnZS5tZXNzYWdlX2lkKS5qb2luKCcsICcpfScg5qW855qE5raI5oGvLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgcmVmcmVzaCxcbiAgICB9KX1gLFxuICApO1xufVxuXG5pbnRlcmZhY2UgQ2hhdE1lc3NhZ2VDcmVhdGluZyB7XG4gIG5hbWU/OiBzdHJpbmc7XG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gIGlzX2hpZGRlbj86IGJvb2xlYW47XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XG59XG5cbmludGVyZmFjZSBDcmVhdGVDaGF0TWVzc2FnZXNPcHRpb24ge1xuICBpbnNlcnRfYXQ/OiBudW1iZXIgfCAnZW5kJztcbiAgcmVmcmVzaD86ICdub25lJyB8ICdhZmZlY3RlZCcgfCAnYWxsJztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNoYXRNZXNzYWdlcyhcbiAgY2hhdF9tZXNzYWdlczogQ2hhdE1lc3NhZ2VDcmVhdGluZ1tdLFxuICB7IGluc2VydF9hdCA9ICdlbmQnLCByZWZyZXNoID0gJ2FsbCcgfTogQ3JlYXRlQ2hhdE1lc3NhZ2VzT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKGluc2VydF9hdCAhPT0gJ2VuZCcpIHtcbiAgICBpbnNlcnRfYXQgPSBpbnNlcnRfYXQgPCAwID8gY2hhdC5sZW5ndGggKyBpbnNlcnRfYXQgOiBpbnNlcnRfYXQ7XG4gICAgaWYgKGluc2VydF9hdCA8IDAgfHwgaW5zZXJ0X2F0ID4gY2hhdC5sZW5ndGgpIHtcbiAgICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgaW5zZXJ0X2F0IOaXoOaViCwg6K+35o+Q5L6b5LiA5Liq5ZyoICcwJyDliLAgJyR7Y2hhdC5sZW5ndGh9JyDkuYvpl7TnmoTmlbTmlbAsIOS9oOaPkOS+m+eahOaYrzogJyR7aW5zZXJ0X2F0fSdgKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBjb252ZXJ0ID0gYXN5bmMgKGNoYXRfbWVzc2FnZTogQ2hhdE1lc3NhZ2VDcmVhdGluZykgPT4ge1xuICAgIGNvbnN0IHJlc3VsdDogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuXG4gICAgaWYgKGNoYXRfbWVzc2FnZT8ubmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBfLnNldChyZXN1bHQsICduYW1lJywgY2hhdF9tZXNzYWdlLm5hbWUpO1xuICAgIH0gZWxzZSBpZiAoY2hhdF9tZXNzYWdlLnJvbGUgPT09ICd1c2VyJykge1xuICAgICAgXy5zZXQocmVzdWx0LCAnbmFtZScsIG5hbWUxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgXy5zZXQocmVzdWx0LCAnbmFtZScsIG5hbWUyKTtcbiAgICB9XG5cbiAgICAvLyBUT0RPOiBhdmF0YXJcblxuICAgIF8uc2V0KHJlc3VsdCwgJ2lzX3VzZXInLCBjaGF0X21lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInKTtcbiAgICBfLnNldChyZXN1bHQsICdpc19zeXN0ZW0nLCBjaGF0X21lc3NhZ2UuaXNfaGlkZGVuID8/IGZhbHNlKTtcbiAgICBfLnNldChyZXN1bHQsICdtZXMnLCBjaGF0X21lc3NhZ2UubWVzc2FnZSk7XG4gICAgXy5zZXQocmVzdWx0LCBbJ3ZhcmlhYmxlcycsIDBdLCBjaGF0X21lc3NhZ2UuZGF0YSA/PyB7fSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBjb25zdCBjb252ZXJ0ZWQgPSBhd2FpdCBQcm9taXNlLmFsbChjaGF0X21lc3NhZ2VzLm1hcChjb252ZXJ0KSk7XG4gIGlmIChpbnNlcnRfYXQgPT09ICdlbmQnKSB7XG4gICAgY2hhdC5wdXNoKC4uLmNvbnZlcnRlZCk7XG4gIH0gZWxzZSB7XG4gICAgY2hhdC5zcGxpY2UoaW5zZXJ0X2F0LCAwLCAuLi5jb252ZXJ0ZWQpO1xuICB9XG4gIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgaWYgKHJlZnJlc2ggPT09ICdhZmZlY3RlZCcgJiYgaW5zZXJ0X2F0ID09PSAnZW5kJykge1xuICAgIGNvbnZlcnRlZC5mb3JFYWNoKG1lc3NhZ2UgPT4gYWRkT25lTWVzc2FnZShtZXNzYWdlKSk7XG4gIH0gZWxzZSB7XG4gICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgfVxuICBjb25zb2xlLmluZm8oXG4gICAgYOWcqCR7aW5zZXJ0X2F0ID09PSAnZW5kJyA/ICfmnIDlkI4nIDogYOesrCAke2luc2VydF9hdH0g5qW85YmNYH3liJvlu7ogJHtcbiAgICAgIGNoYXRfbWVzc2FnZXMubGVuZ3RoXG4gICAgfSDmnaHmtojmga8sIOmAiemhuTogJHtKU09OLnN0cmluZ2lmeSh7XG4gICAgICBpbnNlcnRfYXQsXG4gICAgICByZWZyZXNoLFxuICAgIH0pfWAsXG4gICk7XG59XG5cbmludGVyZmFjZSBEZWxldGVDaGF0TWVzc2FnZXNPcHRpb24ge1xuICByZWZyZXNoPzogJ25vbmUnIHwgJ2FsbCc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVDaGF0TWVzc2FnZXMoXG4gIG1lc3NhZ2VfaWRzOiBudW1iZXJbXSxcbiAgeyByZWZyZXNoID0gJ2FsbCcgfTogRGVsZXRlQ2hhdE1lc3NhZ2VzT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgbWVzc2FnZV9pZHMgPSBtZXNzYWdlX2lkcy5tYXAoaWQgPT4gKGlkIDwgMCA/IGNoYXQubGVuZ3RoICsgaWQgOiBpZCkpLmZpbHRlcihpZCA9PiBpZCA+PSAwICYmIGlkIDwgY2hhdC5sZW5ndGgpO1xuXG4gIF8ucHVsbEF0KGNoYXQsIG1lc3NhZ2VfaWRzKTtcbiAgYXdhaXQgc2F2ZUNoYXRDb25kaXRpb25hbCgpO1xuICBpZiAocmVmcmVzaCA9PT0gJ2FsbCcpIHtcbiAgICBhd2FpdCByZWxvYWRDdXJyZW50Q2hhdCgpO1xuICB9XG4gIGNvbnNvbGUuaW5mbyhcbiAgICBg5Yig6Zmk56ysICcke21lc3NhZ2VfaWRzLmpvaW4oJywgJyl9JyDmpbznmoTmtojmga8sIOmAiemhuTogJHtKU09OLnN0cmluZ2lmeSh7XG4gICAgICByZWZyZXNoLFxuICAgIH0pfWAsXG4gICk7XG59XG5cbmludGVyZmFjZSBSb3RhdGVDaGF0TWVzc2FnZXNPcHRpb24ge1xuICByZWZyZXNoPzogJ25vbmUnIHwgJ2FsbCc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByb3RhdGVDaGF0TWVzc2FnZXMoXG4gIGJlZ2luOiBudW1iZXIsXG4gIG1pZGRsZTogbnVtYmVyLFxuICBlbmQ6IG51bWJlcixcbiAgeyByZWZyZXNoID0gJ2FsbCcgfTogUm90YXRlQ2hhdE1lc3NhZ2VzT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgcmlnaHRfcGFydCA9IGNoYXQuc3BsaWNlKG1pZGRsZSwgZW5kIC0gbWlkZGxlKTtcbiAgY2hhdC5zcGxpY2UoYmVnaW4sIDAsIC4uLnJpZ2h0X3BhcnQpO1xuICBhd2FpdCBzYXZlQ2hhdENvbmRpdGlvbmFsKCk7XG4gIGlmIChyZWZyZXNoID09PSAnYWxsJykge1xuICAgIGF3YWl0IHJlbG9hZEN1cnJlbnRDaGF0KCk7XG4gIH1cbiAgY29uc29sZS5pbmZvKFxuICAgIGDml4vovaznrKwgJ1ske2JlZ2lufSwgJHttaWRkbGV9KSBbJHttaWRkbGV9LCAke2VuZH0pJyDmpbznmoTmtojmga8sIOmAiemhuTogJHtKU09OLnN0cmluZ2lmeSh7XG4gICAgICByZWZyZXNoLFxuICAgIH0pfWAsXG4gICk7XG59XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIEBkZXByZWNhdGVkIOivt+S9v+eUqCBgc2V0Q2hhdE1lc3NhZ2VzYCDku6Pmm78gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRDaGF0TWVzc2FnZShcbiAgZmllbGRfdmFsdWVzOiB7IG1lc3NhZ2U/OiBzdHJpbmc7IGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+IH0sXG4gIG1lc3NhZ2VfaWQ6IG51bWJlcixcbiAge1xuICAgIHN3aXBlX2lkID0gJ2N1cnJlbnQnLFxuICAgIHJlZnJlc2ggPSAnZGlzcGxheV9hbmRfcmVuZGVyX2N1cnJlbnQnLFxuICB9OiB7XG4gICAgc3dpcGVfaWQ/OiAnY3VycmVudCcgfCBudW1iZXI7XG4gICAgcmVmcmVzaD86ICdub25lJyB8ICdkaXNwbGF5X2N1cnJlbnQnIHwgJ2Rpc3BsYXlfYW5kX3JlbmRlcl9jdXJyZW50JyB8ICdhbGwnO1xuICB9ID0ge30sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgZmllbGRfdmFsdWVzID0gdHlwZW9mIGZpZWxkX3ZhbHVlcyA9PT0gJ3N0cmluZycgPyB7IG1lc3NhZ2U6IGZpZWxkX3ZhbHVlcyB9IDogZmllbGRfdmFsdWVzO1xuICBpZiAodHlwZW9mIHN3aXBlX2lkICE9PSAnbnVtYmVyJyAmJiBzd2lwZV9pZCAhPT0gJ2N1cnJlbnQnKSB7XG4gICAgdGhyb3cgRXJyb3IoYOaPkOS+m+eahCBzd2lwZV9pZCDml6DmlYgsIOivt+aPkOS+myAnY3VycmVudCcg5oiW5bqP5Y+3LCDkvaDmj5DkvpvnmoTmmK86ICR7c3dpcGVfaWR9IGApO1xuICB9XG4gIGlmICghWydub25lJywgJ2Rpc3BsYXlfY3VycmVudCcsICdkaXNwbGF5X2FuZF9yZW5kZXJfY3VycmVudCcsICdhbGwnXS5pbmNsdWRlcyhyZWZyZXNoKSkge1xuICAgIHRocm93IEVycm9yKFxuICAgICAgYOaPkOS+m+eahCByZWZyZXNoIOaXoOaViCwg6K+35o+Q5L6bICdub25lJywgJ2Rpc3BsYXlfY3VycmVudCcsICdkaXNwbGF5X2FuZF9yZW5kZXJfY3VycmVudCcg5oiWICdhbGwnLCDkvaDmj5DkvpvnmoTmmK86ICR7cmVmcmVzaH0gYCxcbiAgICApO1xuICB9XG5cbiAgY29uc3QgY2hhdF9tZXNzYWdlID0gY2hhdC5hdChtZXNzYWdlX2lkKTtcbiAgaWYgKCFjaGF0X21lc3NhZ2UpIHtcbiAgICBjb25zb2xlLndhcm4oYOacquaJvuWIsOesrCAke21lc3NhZ2VfaWR9IOalvOeahOa2iOaBr2ApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGFkZF9zd2lwZXNfaWZfcmVxdWlyZWQgPSAoKTogYm9vbGVhbiA9PiB7XG4gICAgaWYgKHN3aXBlX2lkID09PSAnY3VycmVudCcpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBzd2lwZV9pZCDlr7nlupTnmoTmtojmga/pobXlrZjlnKhcbiAgICBpZiAoc3dpcGVfaWQgPT0gMCB8fCAoY2hhdF9tZXNzYWdlLnN3aXBlcyAmJiBzd2lwZV9pZCA8IGNoYXRfbWVzc2FnZS5zd2lwZXMubGVuZ3RoKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKCFjaGF0X21lc3NhZ2Uuc3dpcGVzKSB7XG4gICAgICBjaGF0X21lc3NhZ2Uuc3dpcGVfaWQgPSAwO1xuICAgICAgY2hhdF9tZXNzYWdlLnN3aXBlcyA9IFtjaGF0X21lc3NhZ2UubWVzXTtcbiAgICAgIGNoYXRfbWVzc2FnZS52YXJpYWJsZXMgPSBbe31dO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gY2hhdF9tZXNzYWdlLnN3aXBlcy5sZW5ndGg7IGkgPD0gc3dpcGVfaWQ7ICsraSkge1xuICAgICAgY2hhdF9tZXNzYWdlLnN3aXBlcy5wdXNoKCcnKTtcbiAgICAgIGNoYXRfbWVzc2FnZS52YXJpYWJsZXMucHVzaCh7fSk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9O1xuXG4gIGNvbnN0IHN3aXBlX2lkX3ByZXZpb3VzX2luZGV4OiBudW1iZXIgPSBjaGF0X21lc3NhZ2Uuc3dpcGVfaWQgPz8gMDtcbiAgY29uc3Qgc3dpcGVfaWRfdG9fc2V0X2luZGV4OiBudW1iZXIgPSBzd2lwZV9pZCA9PSAnY3VycmVudCcgPyBzd2lwZV9pZF9wcmV2aW91c19pbmRleCA6IHN3aXBlX2lkO1xuICBjb25zdCBzd2lwZV9pZF90b191c2VfaW5kZXg6IG51bWJlciA9IHJlZnJlc2ggIT0gJ25vbmUnID8gc3dpcGVfaWRfdG9fc2V0X2luZGV4IDogc3dpcGVfaWRfcHJldmlvdXNfaW5kZXg7XG4gIGNvbnN0IG1lc3NhZ2U6IHN0cmluZyA9XG4gICAgZmllbGRfdmFsdWVzLm1lc3NhZ2UgPz9cbiAgICAoY2hhdF9tZXNzYWdlLnN3aXBlcyA/IGNoYXRfbWVzc2FnZS5zd2lwZXNbc3dpcGVfaWRfdG9fc2V0X2luZGV4XSA6IHVuZGVmaW5lZCkgPz9cbiAgICBjaGF0X21lc3NhZ2UubWVzO1xuXG4gIGNvbnN0IHVwZGF0ZV9jaGF0X21lc3NhZ2UgPSAoKSA9PiB7XG4gICAgY29uc3QgbWVzc2FnZV9kZW1hY3JvZWQgPSBzdWJzdGl0dXRlUGFyYW1zRXh0ZW5kZWQobWVzc2FnZSk7XG5cbiAgICBpZiAoZmllbGRfdmFsdWVzLmRhdGEpIHtcbiAgICAgIGlmICghY2hhdF9tZXNzYWdlLnZhcmlhYmxlcykge1xuICAgICAgICBjaGF0X21lc3NhZ2UudmFyaWFibGVzID0gW107XG4gICAgICB9XG4gICAgICBjaGF0X21lc3NhZ2UudmFyaWFibGVzW3N3aXBlX2lkX3RvX3NldF9pbmRleF0gPSBmaWVsZF92YWx1ZXMuZGF0YTtcbiAgICB9XG5cbiAgICBpZiAoY2hhdF9tZXNzYWdlLnN3aXBlcykge1xuICAgICAgY2hhdF9tZXNzYWdlLnN3aXBlc1tzd2lwZV9pZF90b19zZXRfaW5kZXhdID0gbWVzc2FnZV9kZW1hY3JvZWQ7XG4gICAgICBjaGF0X21lc3NhZ2Uuc3dpcGVfaWQgPSBzd2lwZV9pZF90b191c2VfaW5kZXg7XG4gICAgfVxuXG4gICAgaWYgKHN3aXBlX2lkX3RvX3VzZV9pbmRleCA9PT0gc3dpcGVfaWRfdG9fc2V0X2luZGV4KSB7XG4gICAgICBjaGF0X21lc3NhZ2UubWVzID0gbWVzc2FnZV9kZW1hY3JvZWQ7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHVwZGF0ZV9wYXJ0aWFsX2h0bWwgPSBhc3luYyAoc2hvdWxkX3VwZGF0ZV9zd2lwZTogYm9vbGVhbikgPT4ge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBtZXNfaHRtbCA9ICQoYGRpdi5tZXNbbWVzaWQgPSBcIiR7bWVzc2FnZV9pZH1cIl1gKTtcbiAgICBpZiAoIW1lc19odG1sKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHNob3VsZF91cGRhdGVfc3dpcGUpIHtcbiAgICAgIC8vIEZJWE1FOiDlj6rmnInkuIDmnaHmtojmga/ml7YsIHN3aXBlcy1jb3VudGVyIOS4jeS8muato+W4uOaYvuekujsg5q2k5aSW6L+Y6KaB6ICD6JmRIHN3aXBlcy1jb3VudGVyIOeahCBcIlN3aXBlICMgZm9yIEFsbCBNZXNzYWdlc1wiIOmAiemhuVxuICAgICAgbWVzX2h0bWwuZmluZCgnLnN3aXBlcy1jb3VudGVyJykudGV4dChgJHtzd2lwZV9pZF90b191c2VfaW5kZXggKyAxfVxcdTIwMGIvXFx1MjAwYiR7Y2hhdF9tZXNzYWdlLnN3aXBlcy5sZW5ndGh9YCk7XG4gICAgfVxuICAgIGlmIChyZWZyZXNoICE9ICdub25lJykge1xuICAgICAgbWVzX2h0bWxcbiAgICAgICAgLmZpbmQoJy5tZXNfdGV4dCcpXG4gICAgICAgIC5lbXB0eSgpXG4gICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgbWVzc2FnZUZvcm1hdHRpbmcobWVzc2FnZSwgY2hhdF9tZXNzYWdlLm5hbWUsIGNoYXRfbWVzc2FnZS5pc19zeXN0ZW0sIGNoYXRfbWVzc2FnZS5pc191c2VyLCBtZXNzYWdlX2lkKSxcbiAgICAgICAgKTtcbiAgICAgIGlmIChyZWZyZXNoID09PSAnZGlzcGxheV9hbmRfcmVuZGVyX2N1cnJlbnQnKSB7XG4gICAgICAgIGF3YWl0IGV2ZW50U291cmNlLmVtaXQoXG4gICAgICAgICAgY2hhdF9tZXNzYWdlLmlzX3VzZXIgPyBldmVudF90eXBlcy5VU0VSX01FU1NBR0VfUkVOREVSRUQgOiBldmVudF90eXBlcy5DSEFSQUNURVJfTUVTU0FHRV9SRU5ERVJFRCxcbiAgICAgICAgICBtZXNzYWdlX2lkLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCBzaG91bGRfdXBkYXRlX3N3aXBlOiBib29sZWFuID0gYWRkX3N3aXBlc19pZl9yZXF1aXJlZCgpO1xuICB1cGRhdGVfY2hhdF9tZXNzYWdlKCk7XG4gIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgaWYgKHJlZnJlc2ggPT0gJ2FsbCcpIHtcbiAgICBhd2FpdCByZWxvYWRDdXJyZW50Q2hhdCgpO1xuICB9IGVsc2Uge1xuICAgIGF3YWl0IHVwZGF0ZV9wYXJ0aWFsX2h0bWwoc2hvdWxkX3VwZGF0ZV9zd2lwZSk7XG4gIH1cblxuICBjb25zb2xlLmluZm8oXG4gICAgYOiuvue9ruesrCAke21lc3NhZ2VfaWR9IOalvOa2iOaBrywg6YCJ6aG5OiAke0pTT04uc3RyaW5naWZ5KHtcbiAgICAgIHN3aXBlX2lkLFxuICAgICAgcmVmcmVzaCxcbiAgICB9KX0sIOiuvue9ruWJjeS9v+eUqOeahOa2iOaBr+mhtTogJHtzd2lwZV9pZF9wcmV2aW91c19pbmRleH0sIOiuvue9rueahOa2iOaBr+mhtTogJHtzd2lwZV9pZF90b19zZXRfaW5kZXh9LCDnjrDlnKjkvb/nlKjnmoTmtojmga/pobU6ICR7c3dpcGVfaWRfdG9fdXNlX2luZGV4fSBgLFxuICApO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/chat_message.ts\n")},"./src/function/displayed_message.ts":
/*!*******************************************!*\
  !*** ./src/function/displayed_message.ts ***!
  \*******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   formatAsDisplayedMessage: () => (/* binding */ formatAsDisplayedMessage),\n/* harmony export */   retrieveDisplayedMessage: () => (/* binding */ retrieveDisplayedMessage)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/macros */ \"@sillytavern/scripts/macros\");\n\n\nfunction formatAsDisplayedMessage(text, { message_id = 'last' } = {}) {\n    if (typeof message_id !== 'number' && !['last', 'last_user', 'last_char'].includes(message_id)) {\n        throw Error(` message_id ,  'last', 'last_user', 'last_char' , : ${message_id}`);\n    }\n    const last_message_id = (0,_sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.getLastMessageId)();\n    if (last_message_id === null) {\n        throw Error(`, : ${message_id}`);\n    }\n    switch (message_id) {\n        case 'last':\n            message_id = last_message_id;\n            break;\n        case 'last_user': {\n            const last_user_message_id = (0,_sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.getLastMessageId)({ filter: (m) => m.is_user && !m.is_system });\n            if (last_user_message_id === null) {\n                throw Error(` user , : ${message_id}`);\n            }\n            message_id = last_user_message_id;\n            break;\n        }\n        case 'last_char': {\n            const last_char_message_id = (0,_sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.getLastMessageId)({ filter: (m) => !m.is_user && !m.is_system });\n            if (last_char_message_id === null) {\n                throw Error(` char , : ${message_id}`);\n            }\n            message_id = last_char_message_id;\n            break;\n        }\n    }\n    if (message_id < 0 || message_id > last_message_id) {\n        throw Error(` message_id  [0, ${last_message_id}] , : ${message_id} `);\n    }\n    const chat_message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[message_id];\n    const result = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.messageFormatting)(text, chat_message.name, chat_message.is_system, chat_message.is_user, message_id);\n    console.info(` html , : '${text}', : '${JSON.stringify({\n        message_id,\n    })}', : '${result}'`);\n    return result;\n}\nfunction retrieveDisplayedMessage(message_id) {\n    return $(`div.mes[mesid = \"${message_id}\"]`, window.parent.document).find(`div.mes_text`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vZGlzcGxheWVkX21lc3NhZ2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE4RDtBQUNDO0FBTXhELFNBQVMsd0JBQXdCLENBQ3RDLElBQVksRUFDWixFQUFFLFVBQVUsR0FBRyxNQUFNLEtBQXFDLEVBQUU7SUFFNUQsSUFBSSxPQUFPLFVBQVUsS0FBSyxRQUFRLElBQUksQ0FBQyxDQUFDLE1BQU0sRUFBRSxXQUFXLEVBQUUsV0FBVyxDQUFDLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7UUFDL0YsTUFBTSxLQUFLLENBQ1QsMEVBQTBFLFVBQVUsRUFBRSxDQUN2RixDQUFDO0lBQ0osQ0FBQztJQUVELE1BQU0sZUFBZSxHQUFHLDZFQUFnQixFQUFFLENBQUM7SUFDM0MsSUFBSSxlQUFlLEtBQUssSUFBSSxFQUFFLENBQUM7UUFDN0IsTUFBTSxLQUFLLENBQUMscUJBQXFCLFVBQVUsRUFBRSxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUVELFFBQVEsVUFBVSxFQUFFLENBQUM7UUFDbkIsS0FBSyxNQUFNO1lBQ1QsVUFBVSxHQUFHLGVBQWUsQ0FBQztZQUM3QixNQUFNO1FBQ1IsS0FBSyxXQUFXLENBQUMsQ0FBQyxDQUFDO1lBQ2pCLE1BQU0sb0JBQW9CLEdBQUcsNkVBQWdCLENBQUMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFNLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQVcsQ0FBQztZQUMzRyxJQUFJLG9CQUFvQixLQUFLLElBQUksRUFBRSxDQUFDO2dCQUNsQyxNQUFNLEtBQUssQ0FBQywyQkFBMkIsVUFBVSxFQUFFLENBQUMsQ0FBQztZQUN2RCxDQUFDO1lBQ0QsVUFBVSxHQUFHLG9CQUFvQixDQUFDO1lBQ2xDLE1BQU07UUFDUixDQUFDO1FBQ0QsS0FBSyxXQUFXLENBQUMsQ0FBQyxDQUFDO1lBQ2pCLE1BQU0sb0JBQW9CLEdBQUcsNkVBQWdCLENBQUMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFNLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBVyxDQUFDO1lBQzVHLElBQUksb0JBQW9CLEtBQUssSUFBSSxFQUFFLENBQUM7Z0JBQ2xDLE1BQU0sS0FBSyxDQUFDLDJCQUEyQixVQUFVLEVBQUUsQ0FBQyxDQUFDO1lBQ3ZELENBQUM7WUFDRCxVQUFVLEdBQUcsb0JBQW9CLENBQUM7WUFDbEMsTUFBTTtRQUNSLENBQUM7SUFDSCxDQUFDO0lBQ0QsSUFBSSxVQUFVLEdBQUcsQ0FBQyxJQUFJLFVBQVUsR0FBRyxlQUFlLEVBQUUsQ0FBQztRQUNuRCxNQUFNLEtBQUssQ0FBQyx5QkFBeUIsZUFBZSxlQUFlLFVBQVUsR0FBRyxDQUFDLENBQUM7SUFDcEYsQ0FBQztJQUVELE1BQU0sWUFBWSxHQUFHLHFEQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDdEMsTUFBTSxNQUFNLEdBQUcsc0VBQWlCLENBQUMsSUFBSSxFQUFFLFlBQVksQ0FBQyxJQUFJLEVBQUUsWUFBWSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBRXBILE9BQU8sQ0FBQyxJQUFJLENBQ1YsaUNBQWlDLElBQUksV0FBVyxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQzdELFVBQVU7S0FDWCxDQUFDLFdBQVcsTUFBTSxHQUFHLENBQ3ZCLENBQUM7SUFDRixPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDO0FBRU0sU0FBUyx3QkFBd0IsQ0FBQyxVQUFrQjtJQUN6RCxPQUFPLENBQUMsQ0FBQyxvQkFBb0IsVUFBVSxJQUFJLEVBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7QUFDNUYsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9kaXNwbGF5ZWRfbWVzc2FnZS50cz9lMTk0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNoYXQsIG1lc3NhZ2VGb3JtYXR0aW5nIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBnZXRMYXN0TWVzc2FnZUlkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvbWFjcm9zJztcblxuaW50ZXJmYWNlIEZvcm1hdEFzRGlzcGxheWVkTWVzc2FnZU9wdGlvbiB7XG4gIG1lc3NhZ2VfaWQ/OiAnbGFzdCcgfCAnbGFzdF91c2VyJyB8ICdsYXN0X2NoYXInIHwgbnVtYmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0QXNEaXNwbGF5ZWRNZXNzYWdlKFxuICB0ZXh0OiBzdHJpbmcsXG4gIHsgbWVzc2FnZV9pZCA9ICdsYXN0JyB9OiBGb3JtYXRBc0Rpc3BsYXllZE1lc3NhZ2VPcHRpb24gPSB7fSxcbik6IHN0cmluZyB7XG4gIGlmICh0eXBlb2YgbWVzc2FnZV9pZCAhPT0gJ251bWJlcicgJiYgIVsnbGFzdCcsICdsYXN0X3VzZXInLCAnbGFzdF9jaGFyJ10uaW5jbHVkZXMobWVzc2FnZV9pZCkpIHtcbiAgICB0aHJvdyBFcnJvcihcbiAgICAgIGDmj5DkvpvnmoQgbWVzc2FnZV9pZCDml6DmlYgsIOivt+aPkOS+myAnbGFzdCcsICdsYXN0X3VzZXInLCAnbGFzdF9jaGFyJyDmiJbmpbzlsYLmtojmga/lj7csIOS9oOaPkOS+m+eahOaYrzogJHttZXNzYWdlX2lkfWAsXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IGxhc3RfbWVzc2FnZV9pZCA9IGdldExhc3RNZXNzYWdlSWQoKTtcbiAgaWYgKGxhc3RfbWVzc2FnZV9pZCA9PT0gbnVsbCkge1xuICAgIHRocm93IEVycm9yKGDmnKrmib7liLDku7vkvZXmtojmga/mpbzlsYIsIOS9oOaPkOS+m+eahOaYrzogJHttZXNzYWdlX2lkfWApO1xuICB9XG5cbiAgc3dpdGNoIChtZXNzYWdlX2lkKSB7XG4gICAgY2FzZSAnbGFzdCc6XG4gICAgICBtZXNzYWdlX2lkID0gbGFzdF9tZXNzYWdlX2lkO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnbGFzdF91c2VyJzoge1xuICAgICAgY29uc3QgbGFzdF91c2VyX21lc3NhZ2VfaWQgPSBnZXRMYXN0TWVzc2FnZUlkKHsgZmlsdGVyOiAobTogYW55KSA9PiBtLmlzX3VzZXIgJiYgIW0uaXNfc3lzdGVtIH0pIGFzIG51bWJlcjtcbiAgICAgIGlmIChsYXN0X3VzZXJfbWVzc2FnZV9pZCA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBFcnJvcihg5pyq5om+5Yiw5Lu75L2VIHVzZXIg5raI5oGv5qW85bGCLCDkvaDmj5DkvpvnmoTmmK86ICR7bWVzc2FnZV9pZH1gKTtcbiAgICAgIH1cbiAgICAgIG1lc3NhZ2VfaWQgPSBsYXN0X3VzZXJfbWVzc2FnZV9pZDtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjYXNlICdsYXN0X2NoYXInOiB7XG4gICAgICBjb25zdCBsYXN0X2NoYXJfbWVzc2FnZV9pZCA9IGdldExhc3RNZXNzYWdlSWQoeyBmaWx0ZXI6IChtOiBhbnkpID0+ICFtLmlzX3VzZXIgJiYgIW0uaXNfc3lzdGVtIH0pIGFzIG51bWJlcjtcbiAgICAgIGlmIChsYXN0X2NoYXJfbWVzc2FnZV9pZCA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBFcnJvcihg5pyq5om+5Yiw5Lu75L2VIGNoYXIg5raI5oGv5qW85bGCLCDkvaDmj5DkvpvnmoTmmK86ICR7bWVzc2FnZV9pZH1gKTtcbiAgICAgIH1cbiAgICAgIG1lc3NhZ2VfaWQgPSBsYXN0X2NoYXJfbWVzc2FnZV9pZDtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICBpZiAobWVzc2FnZV9pZCA8IDAgfHwgbWVzc2FnZV9pZCA+IGxhc3RfbWVzc2FnZV9pZCkge1xuICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgbWVzc2FnZV9pZCDkuI3lnKggWzAsICR7bGFzdF9tZXNzYWdlX2lkfV0g5YaFLCDkvaDmj5DkvpvnmoTmmK86ICR7bWVzc2FnZV9pZH0gYCk7XG4gIH1cblxuICBjb25zdCBjaGF0X21lc3NhZ2UgPSBjaGF0W21lc3NhZ2VfaWRdO1xuICBjb25zdCByZXN1bHQgPSBtZXNzYWdlRm9ybWF0dGluZyh0ZXh0LCBjaGF0X21lc3NhZ2UubmFtZSwgY2hhdF9tZXNzYWdlLmlzX3N5c3RlbSwgY2hhdF9tZXNzYWdlLmlzX3VzZXIsIG1lc3NhZ2VfaWQpO1xuXG4gIGNvbnNvbGUuaW5mbyhcbiAgICBg5bCG5a2X56ym5Liy5aSE55CG5Li66YWS6aaG55So5LqO5pi+56S655qEIGh0bWwg5qC85byPLCDlrZfnrKbkuLI6ICcke3RleHR9Jywg6YCJ6aG5OiAnJHtKU09OLnN0cmluZ2lmeSh7XG4gICAgICBtZXNzYWdlX2lkLFxuICAgIH0pfScsIOe7k+aenDogJyR7cmVzdWx0fSdgLFxuICApO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmV0cmlldmVEaXNwbGF5ZWRNZXNzYWdlKG1lc3NhZ2VfaWQ6IG51bWJlcik6IEpRdWVyeTxIVE1MRGl2RWxlbWVudD4ge1xuICByZXR1cm4gJChgZGl2Lm1lc1ttZXNpZCA9IFwiJHttZXNzYWdlX2lkfVwiXWAsIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQpLmZpbmQoYGRpdi5tZXNfdGV4dGApO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/displayed_message.ts\n")},"./src/function/generate.ts":
/*!**********************************!*\
  !*** ./src/function/generate.ts ***!
  \**********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   builtin_prompt_default_order: () => (/* binding */ builtin_prompt_default_order),\n/* harmony export */   generate: () => (/* binding */ generate),\n/* harmony export */   generateRaw: () => (/* binding */ generateRaw)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/authors-note */ \"@sillytavern/scripts/authors-note\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions/regex/engine */ \"@sillytavern/scripts/extensions/regex/engine\");\n/* harmony import */ var _sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/i18n */ \"@sillytavern/scripts/i18n\");\n/* harmony import */ var _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/openai */ \"@sillytavern/scripts/openai\");\n/* harmony import */ var _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/power-user */ \"@sillytavern/scripts/power-user\");\n/* harmony import */ var _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/scripts/PromptManager */ \"@sillytavern/scripts/PromptManager\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n\n\n\n\n\n\n\n\n\n\nconst builtin_prompt_default_order = [\n    'world_info_before',\n    'persona_description',\n    'char_description',\n    'char_personality',\n    'scenario',\n    'world_info_after',\n    'dialogue_examples',\n    'chat_history',\n    'user_input',\n];\nlet abortController = new AbortController();\nfunction fromOverrides(overrides) {\n    return {\n        world_info_before: overrides.world_info_before,\n        persona_description: overrides.persona_description,\n        char_description: overrides.char_description,\n        char_personality: overrides.char_personality,\n        scenario: overrides.scenario,\n        world_info_after: overrides.world_info_after,\n        dialogue_examples: overrides.dialogue_examples,\n        with_depth_entries: overrides.chat_history?.with_depth_entries,\n        author_note: overrides.chat_history?.author_note,\n        chat_history: overrides.chat_history?.prompts,\n    };\n}\nfunction fromInjectionPrompt(inject) {\n    const position_map = {\n        before_prompt: 'before_prompt',\n        in_chat: 'in_chat',\n        after_prompt: 'after_prompt',\n        none: 'none',\n    };\n    return {\n        role: inject.role,\n        content: inject.content,\n        position: position_map[inject.position],\n        depth: inject.depth,\n        should_scan: inject.should_scan,\n    };\n}\nfunction fromGenerateConfig(config) {\n    return {\n        user_input: config.user_input,\n        use_preset: true,\n        image: config.image,\n        stream: config.should_stream ?? false,\n        overrides: config.overrides !== undefined ? fromOverrides(config.overrides) : undefined,\n        inject: config.injects !== undefined ? config.injects.map(fromInjectionPrompt) : undefined,\n        max_chat_history: typeof config.max_chat_history === 'number' ? config.max_chat_history : undefined,\n    };\n}\nfunction fromGenerateRawConfig(config) {\n    return {\n        user_input: config.user_input,\n        use_preset: false,\n        image: config.image,\n        stream: config.should_stream ?? false,\n        max_chat_history: typeof config.max_chat_history === 'number' ? config.max_chat_history : undefined,\n        overrides: config.overrides ? fromOverrides(config.overrides) : undefined,\n        inject: config.injects ? config.injects.map(fromInjectionPrompt) : undefined,\n        order: config.ordered_prompts,\n    };\n}\nconst type = 'quiet';\nconst dryRun = false;\nconst character_names_behavior = {\n    NONE: -1,\n    DEFAULT: 0,\n    COMPLETION: 1,\n    CONTENT: 2,\n};\nconst roleTypes = {\n    system: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.SYSTEM,\n    user: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.USER,\n    assistant: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.ASSISTANT,\n};\nconst default_order = [\n    'world_info_before',\n    'persona_description',\n    'char_description',\n    'char_personality',\n    'scenario',\n    'world_info_after',\n    'dialogue_examples',\n    'chat_history',\n    'user_input',\n];\nclass StreamingProcessor {\n    generator;\n    stoppingStrings;\n    result;\n    isStopped;\n    isFinished;\n    abortController;\n    messageBuffer;\n    constructor() {\n        this.result = '';\n        this.messageBuffer = '';\n        this.isStopped = false;\n        this.isFinished = false;\n        this.generator = this.nullStreamingGeneration;\n        this.abortController = new AbortController();\n    }\n    onProgressStreaming(text, isFinal) {\n        // \n        const newText = text.slice(this.messageBuffer.length);\n        this.messageBuffer = text;\n        // @ts-expect-error\n        let processedText = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.cleanUpMessage)(newText, false, false, !isFinal, this.stoppingStrings);\n        const charsToBalance = ['*', '\"', '```'];\n        for (const char of charsToBalance) {\n            if (!isFinal && (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.isOdd)((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.countOccurrences)(processedText, char))) {\n                const separator = char.length > 1 ? '\\n' : '';\n                processedText = processedText.trimEnd() + separator + char;\n            }\n        }\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_stream_token_received_fully', text);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_stream_token_received_incrementally', processedText);\n        if (isFinal) {\n            // @ts-expect-error\n            const fullText = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.cleanUpMessage)(text, false, false, false, this.stoppingStrings);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_generation_ended', fullText);\n        }\n    }\n    onErrorStreaming() {\n        if (this.abortController) {\n            this.abortController.abort();\n        }\n        this.isStopped = true;\n        unblockGeneration();\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    }\n    // eslint-disable-next-line require-yield\n    async *nullStreamingGeneration() {\n        throw Error('Generation function for streaming is not hooked up');\n    }\n    async generate() {\n        try {\n            const sw = new _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__.Stopwatch(1000 / _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.streaming_fps);\n            const timestamps = [];\n            for await (const { text } of this.generator()) {\n                timestamps.push(Date.now());\n                if (this.isStopped) {\n                    this.messageBuffer = '';\n                    return;\n                }\n                this.result = text;\n                await sw.tick(() => this.onProgressStreaming(text, false));\n            }\n            if (!this.isStopped) {\n                this.onProgressStreaming(this.result, true);\n            }\n            else {\n                this.messageBuffer = '';\n            }\n            const seconds = (timestamps[timestamps.length - 1] - timestamps[0]) / 1000;\n            console.warn(`Stream stats: ${timestamps.length} tokens, ${seconds.toFixed(2)} seconds, rate: ${Number(timestamps.length / seconds).toFixed(2)} TPS`);\n        }\n        catch (err) {\n            if (!this.isFinished) {\n                this.onErrorStreaming();\n                throw Error(`Generate method error: ${err}`);\n            }\n            this.messageBuffer = '';\n            return this.result;\n        }\n        this.isFinished = true;\n        return this.result;\n    }\n}\nasync function iframeGenerate({ user_input = '', use_preset = true, image = undefined, overrides = undefined, max_chat_history = undefined, inject = [], order = undefined, stream = false, } = {}) {\n    //\n    abortController = new AbortController();\n    // 1. \n    const processedUserInput = processUserInput((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParams)(user_input)) || '';\n    // 2. \n    const baseData = await prepareAndOverrideData({\n        overrides,\n        max_chat_history,\n        inject,\n        order,\n    }, processedUserInput);\n    // 3.  use_preset \n    const generate_data = use_preset\n        ? await handlePresetPath(baseData, processedUserInput, {\n            image,\n            overrides,\n            max_chat_history,\n            inject,\n            order,\n        })\n        : await handleCustomPath(baseData, {\n            image,\n            overrides,\n            max_chat_history,\n            inject,\n            order,\n        }, processedUserInput);\n    console.log('[Generate:]', generate_data);\n    // 4.  stream \n    return await generateResponse(generate_data, stream);\n}\nasync function prepareAndOverrideData(config, processedUserInput) {\n    const getOverrideContent = (identifier) => {\n        if (!config.overrides)\n            return undefined;\n        const value = config.overrides[identifier];\n        if (typeof value === 'boolean')\n            return undefined;\n        return value;\n    };\n    // 1.  - chat_history\n    if (!isPromptFiltered('chat_history', config)) {\n        handleCharDepthPrompt();\n    }\n    // 2.  - chat_history\n    if (!isPromptFiltered('chat_history', config) && !isPromptFiltered('author_note', config)) {\n        setAuthorNotePrompt(config);\n    }\n    // 3. user - chat_historypersona_description\n    if (!isPromptFiltered('chat_history', config) && !isPromptFiltered('persona_description', config)) {\n        setPersonaDescriptionExtensionPrompt();\n    }\n    // 4. \n    const { description: rawDescription, personality: rawPersonality, persona: rawPersona, scenario: rawScenario, mesExamples: rawMesExamples, system, jailbreak, charDepthPrompt, creatorNotes, } = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getCharacterCardFields)();\n    // ,,override\n    const description = isPromptFiltered('char_description', config)\n        ? ''\n        : getOverrideContent('char_description') ?? rawDescription;\n    const personality = isPromptFiltered('char_personality', config)\n        ? ''\n        : getOverrideContent('char_personality') ?? rawPersonality;\n    const persona = isPromptFiltered('persona_description', config)\n        ? ''\n        : getOverrideContent('persona_description') ?? rawPersona;\n    const scenario = isPromptFiltered('scenario', config) ? '' : getOverrideContent('scenario') ?? rawScenario;\n    const mesExamples = isPromptFiltered('dialogue_examples', config)\n        ? ''\n        : getOverrideContent('dialogue_examples') ?? rawMesExamples;\n    let mesExamplesArray = parseMesExamples(mesExamples);\n    let oaiMessageExamples = [];\n    oaiMessageExamples = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.setOpenAIMessageExamples)(mesExamplesArray);\n    // 5. \n    const { promptBias } = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getBiasStrings)(processedUserInput, type);\n    // 6. \n    if (config.inject) {\n        await handleInjectedPrompts(config);\n    }\n    // 7. \n    let oaiMessages = [];\n    if (config.overrides?.chat_history) {\n        oaiMessages = [...config.overrides.chat_history].reverse();\n    }\n    else {\n        oaiMessages = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.setOpenAIMessages)(await processChatHistory(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat));\n        if (config.max_chat_history !== undefined) {\n            oaiMessages = oaiMessages.slice(0, config.max_chat_history);\n        }\n    }\n    // \n    addTemporaryUserMessage(processedUserInput);\n    // 8. \n    const worldInfo = await processWorldInfo(oaiMessages, config, {\n        description: rawDescription,\n        personality: rawPersonality,\n        persona: rawPersona,\n        scenario: rawScenario,\n        charDepthPrompt,\n        creatorNotes,\n    });\n    // \n    removeTemporaryUserMessage();\n    // 9. \n    mesExamplesArray = !isPromptFiltered('dialogue_examples', config)\n        ? await processMessageExamples(mesExamplesArray, worldInfo.worldInfoExamples)\n        : [];\n    return {\n        characterInfo: {\n            description,\n            personality,\n            persona,\n            scenario,\n            system: system,\n            jailbreak: jailbreak,\n        },\n        chatContext: {\n            oaiMessages,\n            oaiMessageExamples,\n            promptBias,\n        },\n        worldInfo,\n    };\n}\n//\nfunction handleCharDepthPrompt() {\n    const depthPromptText = \n    // @ts-ignore\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.baseChatReplace)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.prompt?.trim(), _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2) || '';\n    // @ts-ignore\n    const depthPromptDepth = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.depth ?? '4';\n    const depthPromptRole = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getExtensionPromptRoleByName)(\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.role ?? 'system');\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)('DEPTH_PROMPT', depthPromptText, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT, depthPromptDepth, \n    // @ts-ignore\n    _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.note.allowWIScan, depthPromptRole);\n}\n//\nfunction setAuthorNotePrompt(config) {\n    const authorNoteOverride = config?.overrides?.author_note;\n    // @ts-ignore\n    const prompt = authorNoteOverride ?? $('#extension_floating_prompt').val();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME, prompt, \n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.position], \n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.depth], \n    // @ts-ignore\n    _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.note.allowWIScan, \n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.role]);\n}\n//\nfunction setPersonaDescriptionExtensionPrompt() {\n    const description = _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description;\n    const INJECT_TAG = 'PERSONA_DESCRIPTION';\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(INJECT_TAG, '', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT, 0);\n    if (!description || _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.NONE) {\n        return;\n    }\n    //user - \n    const promptPositions = [_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.BOTTOM_AN, _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.TOP_AN];\n    if (promptPositions.includes(_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position) && _sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.shouldWIAddPrompt) {\n        // @ts-ignore\n        const originalAN = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().extensionPrompts[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME].value;\n        const ANWithDesc = _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.TOP_AN\n            ? `${description}\\n${originalAN}`\n            : `${originalAN}\\n${description}`;\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME, ANWithDesc, \n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.position], \n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.depth], \n        // @ts-ignore\n        _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.note.allowWIScan, \n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.role]);\n    }\n    // user\n    if (_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.AT_DEPTH) {\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(INJECT_TAG, description, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT, _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_depth, true, _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_role);\n    }\n}\nasync function handleInjectedPrompts(promptConfig) {\n    if (!promptConfig || !Array.isArray(promptConfig.inject))\n        return;\n    const injects = promptConfig.inject;\n    const position_map = {\n        before_prompt: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.BEFORE_PROMPT,\n        in_chat: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT,\n        after_prompt: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT,\n        none: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.NONE,\n    };\n    for (const inject of injects) {\n        const validatedInject = {\n            role: roleTypes[inject.role] ?? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.SYSTEM,\n            content: inject.content || '',\n            depth: Number(inject.depth) || 0,\n            should_scan: Boolean(inject.should_scan) || true,\n            position: position_map[inject.position] ?? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT,\n        };\n        // \n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(`INJECTION-${inject.depth}-${inject.role}`, validatedInject.content, validatedInject.position, validatedInject.depth, validatedInject.should_scan, validatedInject.role);\n    }\n}\n// \nasync function processChatHistory(chatHistory) {\n    const coreChat = chatHistory.filter(x => !x.is_system);\n    return await Promise.all(coreChat.map(async (chatItem, index) => {\n        const message = chatItem.mes;\n        const regexType = chatItem.is_user ? _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.USER_INPUT : _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.AI_OUTPUT;\n        const regexedMessage = (0,_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.getRegexedString)(message, regexType, {\n            isPrompt: true,\n            depth: coreChat.length - index - 1,\n        });\n        return {\n            ...chatItem,\n            mes: regexedMessage,\n            index,\n        };\n    }));\n}\n// \nasync function processWorldInfo(oaiMessages, config, characterInfo) {\n    const chatForWI = oaiMessages\n        .filter(x => x.role !== 'system')\n        .map(x => {\n        const name = x.role === 'user' ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1 : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2;\n        return _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_9__.world_info_include_names ? `${name}: ${x.content}` : x.content;\n    })\n        .reverse();\n    const this_max_context = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getMaxContextSize)();\n    const globalScanData = {\n        personaDescription: config.overrides?.persona_description ?? characterInfo.persona,\n        characterDescription: config.overrides?.char_description ?? characterInfo.description,\n        characterPersonality: config.overrides?.char_personality ?? characterInfo.personality,\n        characterDepthPrompt: characterInfo.charDepthPrompt,\n        scenario: config.overrides?.scenario ?? characterInfo.scenario,\n        creatorNotes: characterInfo.creatorNotes,\n    };\n    const { worldInfoString, worldInfoBefore, worldInfoAfter, worldInfoExamples, worldInfoDepth } = await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_9__.getWorldInfoPrompt)(chatForWI, this_max_context, dryRun, globalScanData);\n    await clearInjectionPrompts(['customDepthWI']);\n    if (!isPromptFiltered('with_depth_entries', config)) {\n        processWorldInfoDepth(worldInfoDepth);\n    }\n    // null\n    const finalWorldInfoBefore = isPromptFiltered('world_info_before', config)\n        ? null\n        : config.overrides?.world_info_before !== undefined\n            ? config.overrides.world_info_before\n            : worldInfoBefore;\n    const finalWorldInfoAfter = isPromptFiltered('world_info_after', config)\n        ? null\n        : config.overrides?.world_info_after !== undefined\n            ? config.overrides.world_info_after\n            : worldInfoAfter;\n    return {\n        worldInfoString,\n        worldInfoBefore: finalWorldInfoBefore,\n        worldInfoAfter: finalWorldInfoAfter,\n        worldInfoExamples,\n        worldInfoDepth: !isPromptFiltered('with_depth_entries', config) ? worldInfoDepth : null,\n    };\n}\n// \nfunction processWorldInfoDepth(worldInfoDepth) {\n    if (Array.isArray(worldInfoDepth)) {\n        worldInfoDepth.forEach(entry => {\n            const joinedEntries = entry.entries.join('\\n');\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(`customDepthWI-${entry.depth}-${entry.role}`, joinedEntries, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT, entry.depth, false, entry.role);\n        });\n    }\n}\n// \nasync function processMessageExamples(mesExamplesArray, worldInfoExamples) {\n    // \n    for (const example of worldInfoExamples) {\n        if (!example.content.length)\n            continue;\n        const formattedExample = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.baseChatReplace)(example.content, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2);\n        const cleanedExample = parseMesExamples(formattedExample);\n        if (example.position === _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_9__.wi_anchor_position.before) {\n            mesExamplesArray.unshift(...cleanedExample);\n        }\n        else {\n            mesExamplesArray.push(...cleanedExample);\n        }\n    }\n    return mesExamplesArray;\n}\n//\nfunction parseMesExamples(examplesStr) {\n    if (examplesStr.length === 0 || examplesStr === '<START>') {\n        return [];\n    }\n    if (!examplesStr.startsWith('<START>')) {\n        examplesStr = '<START>\\n' + examplesStr.trim();\n    }\n    const blockHeading = '<START>\\n';\n    const splitExamples = examplesStr\n        .split(/<START>/gi)\n        .slice(1)\n        .map(block => `${blockHeading}${block.trim()}\\n`);\n    return splitExamples;\n}\n//\nfunction processUserInput(user_input) {\n    if (user_input === '') {\n        user_input = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.send_if_empty.trim();\n    }\n    return (0,_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.getRegexedString)(user_input, _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.USER_INPUT, {\n        isPrompt: true,\n        depth: 0,\n    });\n}\n//\nasync function handlePresetPath(baseData, processedUserInput, config) {\n    // prepareOpenAIMessages\n    let originalScenario = null;\n    try {\n        const scenarioOverride = config?.overrides?.scenario;\n        // @ts-ignore\n        if (scenarioOverride && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]) {\n            // \n            // @ts-ignore\n            originalScenario = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].scenario || null;\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].scenario = scenarioOverride;\n        }\n        // user()\n        const userMessageTemp = {\n            role: 'user',\n            content: processedUserInput,\n            image: config.image,\n        };\n        if (config.image) {\n            userMessageTemp.image = await convertFileToBase64(config.image);\n        }\n        baseData.chatContext.oaiMessages.unshift(userMessageTemp);\n        const messageData = {\n            name2: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2,\n            charDescription: baseData.characterInfo.description,\n            charPersonality: baseData.characterInfo.personality,\n            Scenario: baseData.characterInfo.scenario,\n            worldInfoBefore: baseData.worldInfo.worldInfoBefore,\n            worldInfoAfter: baseData.worldInfo.worldInfoAfter,\n            extensionPrompts: (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().extensionPrompts,\n            bias: baseData.chatContext.promptBias,\n            type: 'normal',\n            quietPrompt: '',\n            quietImage: null,\n            cyclePrompt: '',\n            systemPromptOverride: baseData.characterInfo.system,\n            jailbreakPromptOverride: baseData.characterInfo.jailbreak,\n            personaDescription: baseData.characterInfo.persona,\n            messages: baseData.chatContext.oaiMessages,\n            messageExamples: baseData.chatContext.oaiMessageExamples,\n        };\n        const [prompt] = await (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.prepareOpenAIMessages)(messageData, dryRun);\n        return { prompt };\n    }\n    finally {\n        // \n        // @ts-ignore\n        if (originalScenario !== null && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]) {\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].scenario = originalScenario;\n        }\n    }\n}\nasync function convertSystemPromptsToCollection(baseData, promptConfig) {\n    const promptCollection = new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_7__.PromptCollection();\n    const examplesCollection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection('dialogue_examples');\n    const orderArray = promptConfig.order || builtin_prompt_default_order;\n    const builtinPromptContents = {\n        world_info_before: baseData.worldInfo.worldInfoBefore,\n        persona_description: _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description &&\n            _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.IN_PROMPT\n            ? baseData.characterInfo.persona : null,\n        char_description: baseData.characterInfo.description,\n        char_personality: baseData.characterInfo.personality,\n        scenario: baseData.characterInfo.scenario,\n        world_info_after: baseData.worldInfo.worldInfoAfter,\n    };\n    for (const [index, item] of orderArray.entries()) {\n        if (typeof item === 'string') {\n            // \n            const content = builtinPromptContents[item];\n            if (content) {\n                promptCollection.add(new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_7__.Prompt({\n                    identifier: item,\n                    role: 'system',\n                    content: content,\n                    system_prompt: true,\n                }));\n            }\n        }\n        else if (typeof item === 'object' && item.role && item.content) {\n            // \n            const identifier = `custom_prompt_${index}`;\n            promptCollection.add(new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_7__.Prompt({\n                identifier: identifier,\n                role: item.role,\n                content: item.content,\n                system_prompt: item.role === 'system',\n            }));\n        }\n    }\n    if (baseData.chatContext.oaiMessageExamples.length > 0) {\n        // \n        for (const dialogue of [...baseData.chatContext.oaiMessageExamples]) {\n            const dialogueIndex = baseData.chatContext.oaiMessageExamples.indexOf(dialogue);\n            const chatMessages = [];\n            for (let promptIndex = 0; promptIndex < dialogue.length; promptIndex++) {\n                const prompt = dialogue[promptIndex];\n                const role = 'system';\n                const content = prompt.content || '';\n                const identifier = `dialogue_examples ${dialogueIndex}-${promptIndex}`;\n                const chatMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync(role, content, identifier);\n                await chatMessage.setName(prompt.name);\n                chatMessages.push(chatMessage);\n            }\n            for (const message of chatMessages) {\n                examplesCollection.add(message);\n            }\n        }\n    }\n    return {\n        systemPrompts: promptCollection,\n        dialogue_examples: examplesCollection,\n    };\n}\n//\nasync function handleCustomPath(baseData, config, processedUserInput) {\n    const chatCompletion = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.ChatCompletion();\n    chatCompletion.setTokenBudget(_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.openai_max_context, _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.openai_max_tokens);\n    chatCompletion.reserveBudget(3);\n    const orderArray = config.order || default_order;\n    const positionMap = orderArray.reduce((acc, item, index) => {\n        if (typeof item === 'string') {\n            acc[item.toLowerCase()] = index;\n        }\n        else if (typeof item === 'object') {\n            acc[`custom_prompt_${index}`] = index;\n        }\n        return acc;\n    }, {});\n    //\n    const { systemPrompts, dialogue_examples } = await convertSystemPromptsToCollection(baseData, config);\n    const addToChatCompletionInOrder = async (source, index) => {\n        if (typeof source === 'object') {\n            // \n            const collection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection(`custom_prompt_${index}`);\n            const message = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync(source.role, source.content, `custom_prompt_${index}`);\n            collection.add(message);\n            chatCompletion.add(collection, index);\n        }\n        else if (systemPrompts.has(source)) {\n            // \n            const prompt = systemPrompts.get(source);\n            const collection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection(source);\n            const message = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.fromPromptAsync(prompt);\n            collection.add(message);\n            chatCompletion.add(collection, positionMap[source]);\n        }\n    };\n    // \n    for (const [index, item] of orderArray.entries()) {\n        if (typeof item === 'string') {\n            if (!isPromptFiltered(item, config)) {\n                await addToChatCompletionInOrder(item, index);\n            }\n        }\n        else if (typeof item === 'object' && item.role && item.content) {\n            await addToChatCompletionInOrder(item, index);\n        }\n    }\n    const dialogue_examplesIndex = orderArray.findIndex(item => typeof item === 'string' && item.toLowerCase() === 'dialogue_examples');\n    if (dialogue_examplesIndex !== -1 && !isPromptFiltered('dialogue_examples', config)) {\n        chatCompletion.add(dialogue_examples, dialogue_examplesIndex);\n    }\n    //usertoken\n    const userInputMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync('user', processedUserInput, 'user_input');\n    chatCompletion.reserveBudget(userInputMessage);\n    await processChatHistoryAndInject(baseData, config, chatCompletion, processedUserInput);\n    chatCompletion.freeBudget(userInputMessage);\n    //role\n    if (_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.squash_system_messages) {\n        await chatCompletion.squashSystemMessages();\n    }\n    const prompt = chatCompletion.getChat();\n    return { prompt };\n}\nasync function processChatHistoryAndInject(baseData, promptConfig, chatCompletion, processedUserInput) {\n    const orderArray = promptConfig.order || default_order;\n    const chatHistoryIndex = orderArray.findIndex(item => typeof item === 'string' && item.toLowerCase() === 'chat_history');\n    const userInputIndex = orderArray.findIndex(item => typeof item === 'string' && item.toLowerCase() === 'user_input');\n    const hasUserInput = userInputIndex !== -1;\n    const hasChatHistory = chatHistoryIndex !== -1;\n    const isChatHistoryFiltered = isPromptFiltered('chat_history', promptConfig);\n    // \n    const userMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync('user', processedUserInput, 'user_input');\n    // \n    if (promptConfig.image && hasUserInput) {\n        await userMessage.addImage(await convertFileToBase64(promptConfig.image));\n    }\n    // order\n    if (isChatHistoryFiltered || !hasChatHistory) {\n        const insertIndex = hasUserInput ? userInputIndex : orderArray.length;\n        chatCompletion.add(new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection('user_input', userMessage), insertIndex);\n        return;\n    }\n    // \n    const chatCollection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection('chat_history');\n    // token\n    const newChat = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.new_chat_prompt;\n    const newChatMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync('system', (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParams)(newChat), 'newMainChat');\n    chatCompletion.reserveBudget(newChatMessage);\n    // \n    chatCollection.add(newChatMessage);\n    // \n    const lastChatPrompt = baseData.chatContext.oaiMessages[baseData.chatContext.oaiMessages.length - 1];\n    const emptyMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync('user', _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.send_if_empty, 'emptyUserMessageReplacement');\n    if (lastChatPrompt &&\n        lastChatPrompt.role === 'assistant' &&\n        _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.send_if_empty &&\n        chatCompletion.canAfford(emptyMessage)) {\n        chatCollection.add(emptyMessage);\n    }\n    // \n    if (!hasUserInput) {\n        const userPrompt = {\n            role: 'user',\n            content: processedUserInput,\n            identifier: 'user_input',\n            image: promptConfig.image ? await convertFileToBase64(promptConfig.image) : undefined,\n        };\n        baseData.chatContext.oaiMessages.unshift(userPrompt);\n    }\n    // \n    const messages = (await populationInjectionPrompts(baseData, baseData.chatContext.oaiMessages, promptConfig.inject, promptConfig)).reverse();\n    const imageInlining = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.isImageInliningSupported)();\n    // \n    const chatPool = [...messages];\n    for (const chatPrompt of chatPool) {\n        const prompt = new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_7__.Prompt(chatPrompt);\n        prompt.identifier = `chat_history-${messages.length - chatPool.indexOf(chatPrompt)}`;\n        prompt.content = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParams)(prompt.content);\n        const chatMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.fromPromptAsync(prompt);\n        const promptManager = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.setupChatCompletionPromptManager)(_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings);\n        if (promptManager) {\n            // @ts-ignore\n            if (promptManager.serviceSettings.names_behavior === character_names_behavior.COMPLETION && prompt.name) {\n                const messageName = promptManager.isValidName(prompt.name)\n                    ? prompt.name\n                    : promptManager.sanitizeName(prompt.name);\n                await chatMessage.setName(messageName);\n            }\n        }\n        if (imageInlining && chatPrompt.image) {\n            await chatMessage.addImage(chatPrompt.image);\n        }\n        if (chatCompletion.canAfford(chatMessage)) {\n            chatCollection.add(chatMessage);\n        }\n        else {\n            break;\n        }\n    }\n    // token\n    chatCompletion.freeBudget(newChatMessage);\n    if (hasUserInput) {\n        // order\n        chatCompletion.add(chatCollection, chatHistoryIndex);\n        chatCompletion.add(new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection('user_input', userMessage), userInputIndex);\n    }\n    else {\n        // chat_history\n        chatCompletion.add(chatCollection, chatHistoryIndex);\n    }\n}\nasync function populationInjectionPrompts(baseData, messages, customInjects = [], config) {\n    const processedMessages = [...messages];\n    let totalInsertedMessages = 0;\n    const injectionPrompts = [];\n    // @ts-ignore\n    const authorsNote = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().extensionPrompts[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME];\n    if (authorsNote && authorsNote.value) {\n        injectionPrompts.push({\n            role: getPromptRole(authorsNote.role),\n            content: authorsNote.value,\n            identifier: 'authorsNote',\n            injection_depth: authorsNote.depth,\n            injected: true,\n        });\n    }\n    if (_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description &&\n        _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.AT_DEPTH) {\n        injectionPrompts.push({\n            role: 'system',\n            content: _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description,\n            identifier: 'persona_description',\n            injection_depth: _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_depth,\n            injected: true,\n        });\n    }\n    if (!isPromptFiltered('char_depth_prompt', config)) {\n        const wiDepthPrompt = baseData.worldInfo.worldInfoDepth;\n        if (wiDepthPrompt) {\n            for (const entry of wiDepthPrompt) {\n                const content = await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getExtensionPromptByName)(`customDepthWI-${entry.depth}-${entry.role}`);\n                injectionPrompts.push({\n                    role: getPromptRole(entry.role),\n                    content: content,\n                    injection_depth: entry.depth,\n                    injected: true,\n                });\n                console.log('injectionPrompts', injectionPrompts);\n            }\n        }\n    }\n    // \n    if (Array.isArray(customInjects)) {\n        for (const inject of customInjects) {\n            injectionPrompts.push({\n                identifier: `INJECTION-${inject.role}-${inject.depth}`,\n                role: inject.role,\n                content: inject.content,\n                injection_depth: inject.depth || 0,\n                injected: true,\n            });\n        }\n    }\n    for (let i = 0; i <= _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.MAX_INJECTION_DEPTH; i++) {\n        const depthPrompts = injectionPrompts.filter(prompt => prompt.injection_depth === i && prompt.content);\n        const roles = ['system', 'user', 'assistant'];\n        const roleMessages = [];\n        const separator = '\\n';\n        for (const role of roles) {\n            // \n            const rolePrompts = depthPrompts\n                .filter(prompt => prompt.role === role)\n                .map(x => x.content.trim())\n                .join(separator);\n            if (rolePrompts) {\n                roleMessages.push({\n                    role: role,\n                    content: rolePrompts,\n                    injected: true,\n                });\n            }\n        }\n        if (roleMessages.length) {\n            const injectIdx = i + totalInsertedMessages;\n            processedMessages.splice(injectIdx, 0, ...roleMessages);\n            totalInsertedMessages += roleMessages.length;\n        }\n    }\n    return processedMessages;\n}\nfunction getPromptRole(role) {\n    switch (role) {\n        case _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.SYSTEM:\n            return 'system';\n        case _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.USER:\n            return 'user';\n        case _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.ASSISTANT:\n            return 'assistant';\n        default:\n            return 'system';\n    }\n}\n//\nasync function generateResponse(generate_data, useStream = false) {\n    let result = '';\n    try {\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.deactivateSendButtons)();\n        if (useStream) {\n            const originalStreamSetting = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.stream_openai;\n            if (!originalStreamSetting) {\n                _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.stream_openai = true;\n                (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n            }\n            const streamingProcessor = new StreamingProcessor();\n            // @ts-ignore\n            streamingProcessor.generator = await (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.sendOpenAIRequest)('normal', generate_data.prompt, abortController.signal);\n            result = (await streamingProcessor.generate());\n            // console.log(\"getMessage\", getMessage);\n            if (originalStreamSetting !== _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.stream_openai) {\n                _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.stream_openai = originalStreamSetting;\n                (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n            }\n        }\n        else {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_generation_started');\n            const response = await (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.sendOpenAIRequest)(type, generate_data.prompt, abortController.signal);\n            result = await handleResponse(response);\n        }\n    }\n    catch (error) {\n        console.error(error);\n    }\n    finally {\n        unblockGeneration();\n        await clearInjectionPrompts(['INJECTION']);\n    }\n    return result;\n}\n// \nasync function handleResponse(response) {\n    if (!response) {\n        throw Error(``);\n    }\n    if (response.error) {\n        if (response?.response) {\n            toastr.error(response.response, (0,_sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_4__.t) `API Error`, {\n                preventDuplicates: true,\n            });\n        }\n        throw Error(response?.response);\n    }\n    const message = extractMessageFromData(response);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_generation_ended', message);\n    return message;\n}\nfunction unblockGeneration() {\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.activateSendButtons)();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.showSwipeButtons)();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setGenerationProgress)(0);\n    (0,_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.flushEphemeralStoppingStrings)();\n}\n// \nasync function clearInjectionPrompts(prefixes) {\n    const prompts = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().extensionPrompts;\n    Object.keys(prompts)\n        .filter(key => prefixes.some(prefix => key.startsWith(prefix)))\n        .forEach(key => delete prompts[key]);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n}\nfunction extractMessageFromData(data) {\n    if (typeof data === 'string') {\n        return data;\n    }\n    return (data?.choices?.[0]?.message?.content ??\n        data?.choices?.[0]?.text ??\n        data?.text ??\n        data?.message?.content?.[0]?.text ??\n        data?.message?.tool_plan ??\n        '');\n}\nasync function convertFileToBase64(image) {\n    if (image instanceof File) {\n        return await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__.getBase64Async)(image);\n    }\n    return image;\n}\nfunction addTemporaryUserMessage(userContent) {\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)('TEMP_USER_MESSAGE', userContent, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT, 0, true, 1);\n}\nfunction removeTemporaryUserMessage() {\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)('TEMP_USER_MESSAGE', '', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT, 0, true, 1);\n}\nfunction isPromptFiltered(promptId, config) {\n    if (!config.overrides) {\n        return false;\n    }\n    if (promptId === 'with_depth_entries') {\n        return config.overrides.with_depth_entries === false;\n    }\n    //  chat_history\n    if (promptId === 'chat_history') {\n        const prompts = config.overrides.chat_history;\n        return prompts !== undefined && prompts.length === 0;\n    }\n    //  overrides \n    const override = config.overrides[promptId];\n    return override !== undefined && override === '';\n}\nasync function generate(config) {\n    const converted_config = fromGenerateConfig(config);\n    return await iframeGenerate(converted_config);\n}\nasync function generateRaw(config) {\n    const converted_config = fromGenerateRawConfig(config);\n    return await iframeGenerate(converted_config);\n}\n// @ts-ignore\n$(document).on('click', '#mes_stop', function () {\n    const wasStopped = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.stopGeneration)();\n    if (wasStopped) {\n        if (abortController) {\n            abortController.abort('Clicked stop button');\n        }\n        unblockGeneration();\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SSxRQUFRLEtBQUssRUFBRSxDQUFDO0FBQ25ELENBQUM7QUFFTSxLQUFLLFVBQVUsUUFBUSxDQUFDLE1BQXNCO0lBQ25ELE1BQU0sZ0JBQWdCLEdBQUcsa0JBQWtCLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDcEQsT0FBTyxNQUFNLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQ2hELENBQUM7QUFFTSxLQUFLLFVBQVUsV0FBVyxDQUFDLE1BQXlCO0lBQ3pELE1BQU0sZ0JBQWdCLEdBQUcscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDdkQsT0FBTyxNQUFNLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQ2hELENBQUM7QUFFRCxhQUFhO0FBQ2IsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsV0FBVyxFQUFFO0lBQ25DLE1BQU0sVUFBVSxHQUFHLG1FQUFjLEVBQUUsQ0FBQztJQUNwQyxJQUFJLFVBQVUsRUFBRSxDQUFDO1FBQ2YsSUFBSSxlQUFlLEVBQUUsQ0FBQztZQUNwQixlQUFlLENBQUMsS0FBSyxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDL0MsQ0FBQztRQUNELGlCQUFpQixFQUFFLENBQUM7SUFDdEIsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL2dlbmVyYXRlLnRzPzIwNGMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgTUFYX0lOSkVDVElPTl9ERVBUSCxcbiAgYWN0aXZhdGVTZW5kQnV0dG9ucyxcbiAgYmFzZUNoYXRSZXBsYWNlLFxuICBjaGFyYWN0ZXJzLFxuICBjaGF0LFxuICBjaGF0X21ldGFkYXRhLFxuICBjbGVhblVwTWVzc2FnZSxcbiAgY291bnRPY2N1cnJlbmNlcyxcbiAgZGVhY3RpdmF0ZVNlbmRCdXR0b25zLFxuICBldmVudFNvdXJjZSxcbiAgZXh0ZW5zaW9uX3Byb21wdF9yb2xlcyxcbiAgZXh0ZW5zaW9uX3Byb21wdF90eXBlcyxcbiAgZ2V0Qmlhc1N0cmluZ3MsXG4gIGdldENoYXJhY3RlckNhcmRGaWVsZHMsXG4gIGdldEV4dGVuc2lvblByb21wdEJ5TmFtZSxcbiAgZ2V0RXh0ZW5zaW9uUHJvbXB0Um9sZUJ5TmFtZSxcbiAgZ2V0TWF4Q29udGV4dFNpemUsXG4gIGlzT2RkLFxuICBuYW1lMSxcbiAgbmFtZTIsXG4gIHNhdmVDaGF0Q29uZGl0aW9uYWwsXG4gIHNhdmVTZXR0aW5nc0RlYm91bmNlZCxcbiAgc2V0RXh0ZW5zaW9uUHJvbXB0LFxuICBzZXRHZW5lcmF0aW9uUHJvZ3Jlc3MsXG4gIHNob3dTd2lwZUJ1dHRvbnMsXG4gIHN0b3BHZW5lcmF0aW9uLFxuICBzdWJzdGl0dXRlUGFyYW1zLFxuICB0aGlzX2NoaWQsXG59IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgTk9URV9NT0RVTEVfTkFNRSwgbWV0YWRhdGFfa2V5cywgc2hvdWxkV0lBZGRQcm9tcHQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9hdXRob3JzLW5vdGUnO1xuaW1wb3J0IHsgZXh0ZW5zaW9uX3NldHRpbmdzLCBnZXRDb250ZXh0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyBnZXRSZWdleGVkU3RyaW5nLCByZWdleF9wbGFjZW1lbnQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zL3JlZ2V4L2VuZ2luZSc7XG5pbXBvcnQgeyB0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvaTE4bic7XG5pbXBvcnQge1xuICBDaGF0Q29tcGxldGlvbixcbiAgTWVzc2FnZSxcbiAgTWVzc2FnZUNvbGxlY3Rpb24sXG4gIGlzSW1hZ2VJbmxpbmluZ1N1cHBvcnRlZCxcbiAgb2FpX3NldHRpbmdzLFxuICBwcmVwYXJlT3BlbkFJTWVzc2FnZXMsXG4gIHNlbmRPcGVuQUlSZXF1ZXN0LFxuICBzZXRPcGVuQUlNZXNzYWdlRXhhbXBsZXMsXG4gIHNldE9wZW5BSU1lc3NhZ2VzLFxuICBzZXR1cENoYXRDb21wbGV0aW9uUHJvbXB0TWFuYWdlcixcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvb3BlbmFpJztcbmltcG9ydCB7XG4gIGZsdXNoRXBoZW1lcmFsU3RvcHBpbmdTdHJpbmdzLFxuICBwZXJzb25hX2Rlc2NyaXB0aW9uX3Bvc2l0aW9ucyxcbiAgcG93ZXJfdXNlcixcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG93ZXItdXNlcic7XG5pbXBvcnQgeyBQcm9tcHQsIFByb21wdENvbGxlY3Rpb24gfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9Qcm9tcHRNYW5hZ2VyJztcbmltcG9ydCB7IFN0b3B3YXRjaCwgZ2V0QmFzZTY0QXN5bmMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy91dGlscyc7XG5pbXBvcnQgeyBnZXRXb3JsZEluZm9Qcm9tcHQsIHdpX2FuY2hvcl9wb3NpdGlvbiwgd29ybGRfaW5mb19pbmNsdWRlX25hbWVzIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvd29ybGQtaW5mbyc7XG5cbmludGVyZmFjZSBHZW5lcmF0ZUNvbmZpZyB7XG4gIHVzZXJfaW5wdXQ/OiBzdHJpbmc7XG4gIGltYWdlPzogRmlsZSB8IHN0cmluZztcbiAgc2hvdWxkX3N0cmVhbT86IGJvb2xlYW47XG4gIG92ZXJyaWRlcz86IE92ZXJyaWRlcztcbiAgaW5qZWN0cz86IEluamVjdGlvblByb21wdFtdO1xuICBtYXhfY2hhdF9oaXN0b3J5PzogJ2FsbCcgfCBudW1iZXI7XG59XG5cbmludGVyZmFjZSBHZW5lcmF0ZVJhd0NvbmZpZyB7XG4gIHVzZXJfaW5wdXQ/OiBzdHJpbmc7XG4gIGltYWdlPzogRmlsZSB8IHN0cmluZztcbiAgc2hvdWxkX3N0cmVhbT86IGJvb2xlYW47XG4gIG92ZXJyaWRlcz86IE92ZXJyaWRlcztcbiAgaW5qZWN0cz86IEluamVjdGlvblJhd1Byb21wdFtdO1xuICBvcmRlcmVkX3Byb21wdHM/OiAoQnVpbHRpblByb21wdCB8IFJvbGVQcm9tcHQpW107XG4gIG1heF9jaGF0X2hpc3Rvcnk/OiAnYWxsJyB8IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFJvbGVQcm9tcHQge1xuICByb2xlOiAnc3lzdGVtJyB8ICdhc3Npc3RhbnQnIHwgJ3VzZXInO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIGltYWdlPzogRmlsZSB8IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEluamVjdGlvblByb21wdCB7XG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgcG9zaXRpb246ICdiZWZvcmVfcHJvbXB0JyB8ICdpbl9jaGF0JyB8ICdhZnRlcl9wcm9tcHQnIHwgJ25vbmUnO1xuICBkZXB0aDogbnVtYmVyO1xuICBzaG91bGRfc2NhbjogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIEluamVjdGlvblJhd1Byb21wdCB7XG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgcG9zaXRpb246ICdpbl9jaGF0JyB8ICdub25lJztcbiAgZGVwdGg6IG51bWJlcjtcbiAgc2hvdWxkX3NjYW46IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBPdmVycmlkZXMge1xuICB3b3JsZF9pbmZvX2JlZm9yZT86IHN0cmluZzsgLy8g5LiW55WM5LmmKOinkuiJsuWumuS5ieWJjSlcbiAgcGVyc29uYV9kZXNjcmlwdGlvbj86IHN0cmluZzsgLy8g55So5oi35o+P6L+wXG4gIGNoYXJfZGVzY3JpcHRpb24/OiBzdHJpbmc7IC8vIOinkuiJsuaPj+i/sFxuICBjaGFyX3BlcnNvbmFsaXR5Pzogc3RyaW5nOyAvLyDop5LoibLmgKfmoLxcbiAgc2NlbmFyaW8/OiBzdHJpbmc7IC8vIOWcuuaZr1xuICB3b3JsZF9pbmZvX2FmdGVyPzogc3RyaW5nOyAvLyDkuJbnlYzkuaYo6KeS6Imy5a6a5LmJ5ZCOKVxuICBkaWFsb2d1ZV9leGFtcGxlcz86IHN0cmluZzsgLy8g5a+56K+d56S65L6LXG4gIGNoYXRfaGlzdG9yeT86IHtcbiAgICB3aXRoX2RlcHRoX2VudHJpZXM/OiBib29sZWFuO1xuICAgIGF1dGhvcl9ub3RlPzogc3RyaW5nO1xuICAgIHByb21wdHM/OiBSb2xlUHJvbXB0W107XG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBidWlsdGluX3Byb21wdF9kZWZhdWx0X29yZGVyOiBCdWlsdGluUHJvbXB0W10gPSBbXG4gICd3b3JsZF9pbmZvX2JlZm9yZScsXG4gICdwZXJzb25hX2Rlc2NyaXB0aW9uJyxcbiAgJ2NoYXJfZGVzY3JpcHRpb24nLFxuICAnY2hhcl9wZXJzb25hbGl0eScsXG4gICdzY2VuYXJpbycsXG4gICd3b3JsZF9pbmZvX2FmdGVyJyxcbiAgJ2RpYWxvZ3VlX2V4YW1wbGVzJyxcbiAgJ2NoYXRfaGlzdG9yeScsXG4gICd1c2VyX2lucHV0Jyxcbl07XG5cbnR5cGUgQnVpbHRpblByb21wdCA9XG4gIHwgJ3dvcmxkX2luZm9fYmVmb3JlJ1xuICB8ICdwZXJzb25hX2Rlc2NyaXB0aW9uJ1xuICB8ICdjaGFyX2Rlc2NyaXB0aW9uJ1xuICB8ICdjaGFyX3BlcnNvbmFsaXR5J1xuICB8ICdzY2VuYXJpbydcbiAgfCAnd29ybGRfaW5mb19hZnRlcidcbiAgfCAnZGlhbG9ndWVfZXhhbXBsZXMnXG4gIHwgJ2NoYXRfaGlzdG9yeSdcbiAgfCAndXNlcl9pbnB1dCc7XG5cbmludGVyZmFjZSBCYXNlRGF0YSB7XG4gIGNoYXJhY3RlckluZm86IHtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIHBlcnNvbmFsaXR5OiBzdHJpbmc7XG4gICAgcGVyc29uYTogc3RyaW5nO1xuICAgIHNjZW5hcmlvOiBzdHJpbmc7XG4gICAgc3lzdGVtOiBzdHJpbmc7XG4gICAgamFpbGJyZWFrOiBzdHJpbmc7XG4gIH07XG4gIGNoYXRDb250ZXh0OiB7XG4gICAgb2FpTWVzc2FnZXM6IFJvbGVQcm9tcHRbXTtcbiAgICBvYWlNZXNzYWdlRXhhbXBsZXM6IHN0cmluZ1tdO1xuICAgIHByb21wdEJpYXM6IHN0cmluZ1tdO1xuICB9O1xuICB3b3JsZEluZm86IHtcbiAgICB3b3JsZEluZm9BZnRlcjogQXJyYXk8c3RyaW5nPjtcbiAgICB3b3JsZEluZm9CZWZvcmU6IEFycmF5PHN0cmluZz47XG4gICAgd29ybGRJbmZvRGVwdGg6IEFycmF5PHsgZW50cmllczogc3RyaW5nOyBkZXB0aDogbnVtYmVyOyByb2xlOiBudW1iZXIgfT47XG4gICAgd29ybGRJbmZvRXhhbXBsZXM6IEFycmF5PHN0cmluZz47XG4gICAgd29ybGRJbmZvU3RyaW5nOiBBcnJheTxzdHJpbmc+O1xuICB9O1xufVxuXG5sZXQgYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuXG5mdW5jdGlvbiBmcm9tT3ZlcnJpZGVzKG92ZXJyaWRlczogT3ZlcnJpZGVzKTogZGV0YWlsLk92ZXJyaWRlQ29uZmlnIHtcbiAgcmV0dXJuIHtcbiAgICB3b3JsZF9pbmZvX2JlZm9yZTogb3ZlcnJpZGVzLndvcmxkX2luZm9fYmVmb3JlLFxuICAgIHBlcnNvbmFfZGVzY3JpcHRpb246IG92ZXJyaWRlcy5wZXJzb25hX2Rlc2NyaXB0aW9uLFxuICAgIGNoYXJfZGVzY3JpcHRpb246IG92ZXJyaWRlcy5jaGFyX2Rlc2NyaXB0aW9uLFxuICAgIGNoYXJfcGVyc29uYWxpdHk6IG92ZXJyaWRlcy5jaGFyX3BlcnNvbmFsaXR5LFxuICAgIHNjZW5hcmlvOiBvdmVycmlkZXMuc2NlbmFyaW8sXG4gICAgd29ybGRfaW5mb19hZnRlcjogb3ZlcnJpZGVzLndvcmxkX2luZm9fYWZ0ZXIsXG4gICAgZGlhbG9ndWVfZXhhbXBsZXM6IG92ZXJyaWRlcy5kaWFsb2d1ZV9leGFtcGxlcyxcblxuICAgIHdpdGhfZGVwdGhfZW50cmllczogb3ZlcnJpZGVzLmNoYXRfaGlzdG9yeT8ud2l0aF9kZXB0aF9lbnRyaWVzLFxuICAgIGF1dGhvcl9ub3RlOiBvdmVycmlkZXMuY2hhdF9oaXN0b3J5Py5hdXRob3Jfbm90ZSxcbiAgICBjaGF0X2hpc3Rvcnk6IG92ZXJyaWRlcy5jaGF0X2hpc3Rvcnk/LnByb21wdHMsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGZyb21JbmplY3Rpb25Qcm9tcHQoaW5qZWN0OiBJbmplY3Rpb25Qcm9tcHQpOiBJbmplY3Rpb25Qcm9tcHQge1xuICBjb25zdCBwb3NpdGlvbl9tYXAgPSB7XG4gICAgYmVmb3JlX3Byb21wdDogJ2JlZm9yZV9wcm9tcHQnLFxuICAgIGluX2NoYXQ6ICdpbl9jaGF0JyxcbiAgICBhZnRlcl9wcm9tcHQ6ICdhZnRlcl9wcm9tcHQnLFxuICAgIG5vbmU6ICdub25lJyxcbiAgfSBhcyBjb25zdDtcbiAgcmV0dXJuIHtcbiAgICByb2xlOiBpbmplY3Qucm9sZSxcbiAgICBjb250ZW50OiBpbmplY3QuY29udGVudCxcbiAgICBwb3NpdGlvbjogcG9zaXRpb25fbWFwW2luamVjdC5wb3NpdGlvbl0gYXMgJ2JlZm9yZV9wcm9tcHQnIHwgJ2luX2NoYXQnIHwgJ2FmdGVyX3Byb21wdCcgfCAnbm9uZScsXG4gICAgZGVwdGg6IGluamVjdC5kZXB0aCxcbiAgICBzaG91bGRfc2NhbjogaW5qZWN0LnNob3VsZF9zY2FuLFxuICB9O1xufVxuXG5mdW5jdGlvbiBmcm9tR2VuZXJhdGVDb25maWcoY29uZmlnOiBHZW5lcmF0ZUNvbmZpZyk6IGRldGFpbC5HZW5lcmF0ZVBhcmFtcyB7XG4gIHJldHVybiB7XG4gICAgdXNlcl9pbnB1dDogY29uZmlnLnVzZXJfaW5wdXQsXG4gICAgdXNlX3ByZXNldDogdHJ1ZSxcbiAgICBpbWFnZTogY29uZmlnLmltYWdlLFxuICAgIHN0cmVhbTogY29uZmlnLnNob3VsZF9zdHJlYW0gPz8gZmFsc2UsXG4gICAgb3ZlcnJpZGVzOiBjb25maWcub3ZlcnJpZGVzICE9PSB1bmRlZmluZWQgPyBmcm9tT3ZlcnJpZGVzKGNvbmZpZy5vdmVycmlkZXMpIDogdW5kZWZpbmVkLFxuICAgIGluamVjdDogY29uZmlnLmluamVjdHMgIT09IHVuZGVmaW5lZCA/IGNvbmZpZy5pbmplY3RzLm1hcChmcm9tSW5qZWN0aW9uUHJvbXB0KSA6IHVuZGVmaW5lZCxcbiAgICBtYXhfY2hhdF9oaXN0b3J5OiB0eXBlb2YgY29uZmlnLm1heF9jaGF0X2hpc3RvcnkgPT09ICdudW1iZXInID8gY29uZmlnLm1heF9jaGF0X2hpc3RvcnkgOiB1bmRlZmluZWQsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGZyb21HZW5lcmF0ZVJhd0NvbmZpZyhjb25maWc6IEdlbmVyYXRlUmF3Q29uZmlnKTogZGV0YWlsLkdlbmVyYXRlUGFyYW1zIHtcbiAgcmV0dXJuIHtcbiAgICB1c2VyX2lucHV0OiBjb25maWcudXNlcl9pbnB1dCxcbiAgICB1c2VfcHJlc2V0OiBmYWxzZSxcbiAgICBpbWFnZTogY29uZmlnLmltYWdlLFxuICAgIHN0cmVhbTogY29uZmlnLnNob3VsZF9zdHJlYW0gPz8gZmFsc2UsXG4gICAgbWF4X2NoYXRfaGlzdG9yeTogdHlwZW9mIGNvbmZpZy5tYXhfY2hhdF9oaXN0b3J5ID09PSAnbnVtYmVyJyA/IGNvbmZpZy5tYXhfY2hhdF9oaXN0b3J5IDogdW5kZWZpbmVkLFxuICAgIG92ZXJyaWRlczogY29uZmlnLm92ZXJyaWRlcyA/IGZyb21PdmVycmlkZXMoY29uZmlnLm92ZXJyaWRlcykgOiB1bmRlZmluZWQsXG4gICAgaW5qZWN0OiBjb25maWcuaW5qZWN0cyA/IGNvbmZpZy5pbmplY3RzLm1hcChmcm9tSW5qZWN0aW9uUHJvbXB0KSA6IHVuZGVmaW5lZCxcbiAgICBvcmRlcjogY29uZmlnLm9yZGVyZWRfcHJvbXB0cyxcbiAgfTtcbn1cblxubmFtZXNwYWNlIGRldGFpbCB7XG4gIGV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tUHJvbXB0IHtcbiAgICByb2xlOiAnc3lzdGVtJyB8ICd1c2VyJyB8ICdhc3Npc3RhbnQnO1xuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgfVxuXG4gIC8vIOimhueblumFjee9ruexu+Wei1xuICBleHBvcnQgaW50ZXJmYWNlIE92ZXJyaWRlQ29uZmlnIHtcbiAgICB3b3JsZF9pbmZvX2JlZm9yZT86IHN0cmluZzsgLy8g5LiW55WM5Lmm77yI6KeS6Imy5a6a5LmJ5LmL5YmN55qE6YOo5YiG77yJXG4gICAgcGVyc29uYV9kZXNjcmlwdGlvbj86IHN0cmluZzsgLy8g55So5oi35o+P6L+wXG4gICAgY2hhcl9kZXNjcmlwdGlvbj86IHN0cmluZzsgLy8g6KeS6Imy5o+P6L+wXG4gICAgY2hhcl9wZXJzb25hbGl0eT86IHN0cmluZzsgLy8g6KeS6Imy6auY57qn5a6a5LmJLeaAp+agvFxuICAgIHNjZW5hcmlvPzogc3RyaW5nOyAvLyDlnLrmma9cbiAgICB3b3JsZF9pbmZvX2FmdGVyPzogc3RyaW5nOyAvLyDkuJbnlYzkuabvvIjop5LoibLlrprkuYnkuYvlkI7nmoTpg6jliIbvvIlcbiAgICBkaWFsb2d1ZV9leGFtcGxlcz86IHN0cmluZzsgLy8g6KeS6Imy6auY57qn5a6a5LmJLeWvueivneekuuS+i1xuXG4gICAgd2l0aF9kZXB0aF9lbnRyaWVzPzogYm9vbGVhbjsgLy8g5LiW55WM5Lmm5rex5bqmXG4gICAgYXV0aG9yX25vdGU/OiBzdHJpbmc7IC8vIOS9nOiAheazqOmHilxuICAgIGNoYXRfaGlzdG9yeT86IFJvbGVQcm9tcHRbXTsgLy8g6IGK5aSp5Y6G5Y+yXG4gIH1cblxuICAvLyDlhoXnva7mj5DnpLror43mnaHnm67nsbvlnotcbiAgZXhwb3J0IHR5cGUgQnVpbHRpblByb21wdEVudHJ5ID1cbiAgICB8ICd3b3JsZF9pbmZvX2JlZm9yZScgLy8g5LiW55WM5LmmKOinkuiJsuWumuS5ieWJjSlcbiAgICB8ICdwZXJzb25hX2Rlc2NyaXB0aW9uJyAvLyDnlKjmiLfmj4/ov7BcbiAgICB8ICdjaGFyX2Rlc2NyaXB0aW9uJyAvLyDop5LoibLmj4/ov7BcbiAgICB8ICdjaGFyX3BlcnNvbmFsaXR5JyAvLyDop5LoibLmgKfmoLxcbiAgICB8ICdzY2VuYXJpbycgLy8g5Zy65pmvXG4gICAgfCAnd29ybGRfaW5mb19hZnRlcicgLy8g5LiW55WM5LmmKOinkuiJsuWumuS5ieWQjilcbiAgICB8ICdkaWFsb2d1ZV9leGFtcGxlcycgLy8g5a+56K+d56S65L6LXG4gICAgfCAnY2hhdF9oaXN0b3J5JyAvLyDogYrlpKnljoblj7JcbiAgICB8ICd1c2VyX2lucHV0JzsgLy8g55So5oi36L6T5YWlXG5cbiAgLy8g55Sf5oiQ5Y+C5pWw57G75Z6LXG4gIGV4cG9ydCBpbnRlcmZhY2UgR2VuZXJhdGVQYXJhbXMge1xuICAgIHVzZXJfaW5wdXQ/OiBzdHJpbmc7XG4gICAgdXNlX3ByZXNldD86IGJvb2xlYW47XG4gICAgaW1hZ2U/OiBGaWxlIHwgc3RyaW5nO1xuICAgIHN0cmVhbT86IGJvb2xlYW47XG4gICAgb3ZlcnJpZGVzPzogT3ZlcnJpZGVDb25maWc7XG4gICAgbWF4X2NoYXRfaGlzdG9yeT86IG51bWJlcjtcbiAgICBpbmplY3Q/OiBJbmplY3Rpb25Qcm9tcHRbXTtcbiAgICBvcmRlcj86IEFycmF5PEJ1aWx0aW5Qcm9tcHRFbnRyeSB8IEN1c3RvbVByb21wdD47XG4gIH1cbn1cblxuY29uc3QgdHlwZSA9ICdxdWlldCc7XG5jb25zdCBkcnlSdW4gPSBmYWxzZTtcblxuY29uc3QgY2hhcmFjdGVyX25hbWVzX2JlaGF2aW9yID0ge1xuICBOT05FOiAtMSxcbiAgREVGQVVMVDogMCxcbiAgQ09NUExFVElPTjogMSxcbiAgQ09OVEVOVDogMixcbn07XG5cbmNvbnN0IHJvbGVUeXBlczogUmVjb3JkPFxuICAnc3lzdGVtJyB8ICd1c2VyJyB8ICdhc3Npc3RhbnQnLFxuICAodHlwZW9mIGV4dGVuc2lvbl9wcm9tcHRfcm9sZXMpW2tleW9mIHR5cGVvZiBleHRlbnNpb25fcHJvbXB0X3JvbGVzXVxuPiA9IHtcbiAgc3lzdGVtOiBleHRlbnNpb25fcHJvbXB0X3JvbGVzLlNZU1RFTSxcbiAgdXNlcjogZXh0ZW5zaW9uX3Byb21wdF9yb2xlcy5VU0VSLFxuICBhc3Npc3RhbnQ6IGV4dGVuc2lvbl9wcm9tcHRfcm9sZXMuQVNTSVNUQU5ULFxufTtcbmNvbnN0IGRlZmF1bHRfb3JkZXI6IGRldGFpbC5CdWlsdGluUHJvbXB0RW50cnlbXSA9IFtcbiAgJ3dvcmxkX2luZm9fYmVmb3JlJyxcbiAgJ3BlcnNvbmFfZGVzY3JpcHRpb24nLFxuICAnY2hhcl9kZXNjcmlwdGlvbicsXG4gICdjaGFyX3BlcnNvbmFsaXR5JyxcbiAgJ3NjZW5hcmlvJyxcbiAgJ3dvcmxkX2luZm9fYWZ0ZXInLFxuICAnZGlhbG9ndWVfZXhhbXBsZXMnLFxuICAnY2hhdF9oaXN0b3J5JyxcbiAgJ3VzZXJfaW5wdXQnLFxuXTtcblxuY2xhc3MgU3RyZWFtaW5nUHJvY2Vzc29yIHtcbiAgcHVibGljIGdlbmVyYXRvcjogKCkgPT4gQXN5bmNHZW5lcmF0b3I8eyB0ZXh0OiBzdHJpbmcgfSwgdm9pZCwgdm9pZD47XG4gIHB1YmxpYyBzdG9wcGluZ1N0cmluZ3M/OiBhbnk7XG4gIHB1YmxpYyByZXN1bHQ6IHN0cmluZztcbiAgcHVibGljIGlzU3RvcHBlZDogYm9vbGVhbjtcbiAgcHVibGljIGlzRmluaXNoZWQ6IGJvb2xlYW47XG4gIHB1YmxpYyBhYm9ydENvbnRyb2xsZXI6IEFib3J0Q29udHJvbGxlcjtcbiAgcHJpdmF0ZSBtZXNzYWdlQnVmZmVyOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5yZXN1bHQgPSAnJztcbiAgICB0aGlzLm1lc3NhZ2VCdWZmZXIgPSAnJztcbiAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIHRoaXMuaXNGaW5pc2hlZCA9IGZhbHNlO1xuICAgIHRoaXMuZ2VuZXJhdG9yID0gdGhpcy5udWxsU3RyZWFtaW5nR2VuZXJhdGlvbjtcbiAgICB0aGlzLmFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgfVxuXG4gIG9uUHJvZ3Jlc3NTdHJlYW1pbmcodGV4dDogc3RyaW5nLCBpc0ZpbmFsOiBib29sZWFuKSB7XG4gICAgLy8g6K6h566X5aKe6YeP5paH5pysXG4gICAgY29uc3QgbmV3VGV4dCA9IHRleHQuc2xpY2UodGhpcy5tZXNzYWdlQnVmZmVyLmxlbmd0aCk7XG4gICAgdGhpcy5tZXNzYWdlQnVmZmVyID0gdGV4dDtcblxuICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgICBsZXQgcHJvY2Vzc2VkVGV4dCA9IGNsZWFuVXBNZXNzYWdlKG5ld1RleHQsIGZhbHNlLCBmYWxzZSwgIWlzRmluYWwsIHRoaXMuc3RvcHBpbmdTdHJpbmdzKTtcblxuICAgIGNvbnN0IGNoYXJzVG9CYWxhbmNlID0gWycqJywgJ1wiJywgJ2BgYCddO1xuICAgIGZvciAoY29uc3QgY2hhciBvZiBjaGFyc1RvQmFsYW5jZSkge1xuICAgICAgaWYgKCFpc0ZpbmFsICYmIGlzT2RkKGNvdW50T2NjdXJyZW5jZXMocHJvY2Vzc2VkVGV4dCwgY2hhcikpKSB7XG4gICAgICAgIGNvbnN0IHNlcGFyYXRvciA9IGNoYXIubGVuZ3RoID4gMSA/ICdcXG4nIDogJyc7XG4gICAgICAgIHByb2Nlc3NlZFRleHQgPSBwcm9jZXNzZWRUZXh0LnRyaW1FbmQoKSArIHNlcGFyYXRvciArIGNoYXI7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZXZlbnRTb3VyY2UuZW1pdCgnanNfc3RyZWFtX3Rva2VuX3JlY2VpdmVkX2Z1bGx5JywgdGV4dCk7XG4gICAgZXZlbnRTb3VyY2UuZW1pdCgnanNfc3RyZWFtX3Rva2VuX3JlY2VpdmVkX2luY3JlbWVudGFsbHknLCBwcm9jZXNzZWRUZXh0KTtcblxuICAgIGlmIChpc0ZpbmFsKSB7XG4gICAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgICBjb25zdCBmdWxsVGV4dCA9IGNsZWFuVXBNZXNzYWdlKHRleHQsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIHRoaXMuc3RvcHBpbmdTdHJpbmdzKTtcbiAgICAgIGV2ZW50U291cmNlLmVtaXQoJ2pzX2dlbmVyYXRpb25fZW5kZWQnLCBmdWxsVGV4dCk7XG4gICAgfVxuICB9XG5cbiAgb25FcnJvclN0cmVhbWluZygpIHtcbiAgICBpZiAodGhpcy5hYm9ydENvbnRyb2xsZXIpIHtcbiAgICAgIHRoaXMuYWJvcnRDb250cm9sbGVyLmFib3J0KCk7XG4gICAgfVxuICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICB1bmJsb2NrR2VuZXJhdGlvbigpO1xuICAgIHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZXF1aXJlLXlpZWxkXG4gIGFzeW5jICpudWxsU3RyZWFtaW5nR2VuZXJhdGlvbigpOiBBc3luY0dlbmVyYXRvcjx7IHRleHQ6IHN0cmluZyB9LCB2b2lkLCB2b2lkPiB7XG4gICAgdGhyb3cgRXJyb3IoJ0dlbmVyYXRpb24gZnVuY3Rpb24gZm9yIHN0cmVhbWluZyBpcyBub3QgaG9va2VkIHVwJyk7XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3cgPSBuZXcgU3RvcHdhdGNoKDEwMDAgLyBwb3dlcl91c2VyLnN0cmVhbWluZ19mcHMpO1xuICAgICAgY29uc3QgdGltZXN0YW1wcyA9IFtdO1xuXG4gICAgICBmb3IgYXdhaXQgKGNvbnN0IHsgdGV4dCB9IG9mIHRoaXMuZ2VuZXJhdG9yKCkpIHtcbiAgICAgICAgdGltZXN0YW1wcy5wdXNoKERhdGUubm93KCkpO1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLm1lc3NhZ2VCdWZmZXIgPSAnJztcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlc3VsdCA9IHRleHQ7XG4gICAgICAgIGF3YWl0IHN3LnRpY2soKCkgPT4gdGhpcy5vblByb2dyZXNzU3RyZWFtaW5nKHRleHQsIGZhbHNlKSk7XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5vblByb2dyZXNzU3RyZWFtaW5nKHRoaXMucmVzdWx0LCB0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubWVzc2FnZUJ1ZmZlciA9ICcnO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzZWNvbmRzID0gKHRpbWVzdGFtcHNbdGltZXN0YW1wcy5sZW5ndGggLSAxXSAtIHRpbWVzdGFtcHNbMF0pIC8gMTAwMDtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgYFN0cmVhbSBzdGF0czogJHt0aW1lc3RhbXBzLmxlbmd0aH0gdG9rZW5zLCAke3NlY29uZHMudG9GaXhlZCgyKX0gc2Vjb25kcywgcmF0ZTogJHtOdW1iZXIoXG4gICAgICAgICAgdGltZXN0YW1wcy5sZW5ndGggLyBzZWNvbmRzLFxuICAgICAgICApLnRvRml4ZWQoMil9IFRQU2AsXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKCF0aGlzLmlzRmluaXNoZWQpIHtcbiAgICAgICAgdGhpcy5vbkVycm9yU3RyZWFtaW5nKCk7XG4gICAgICAgIHRocm93IEVycm9yKGBHZW5lcmF0ZSBtZXRob2QgZXJyb3I6ICR7ZXJyfWApO1xuICAgICAgfVxuICAgICAgdGhpcy5tZXNzYWdlQnVmZmVyID0gJyc7XG4gICAgICByZXR1cm4gdGhpcy5yZXN1bHQ7XG4gICAgfVxuXG4gICAgdGhpcy5pc0ZpbmlzaGVkID0gdHJ1ZTtcbiAgICByZXR1cm4gdGhpcy5yZXN1bHQ7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gaWZyYW1lR2VuZXJhdGUoe1xuICB1c2VyX2lucHV0ID0gJycsXG4gIHVzZV9wcmVzZXQgPSB0cnVlLFxuICBpbWFnZSA9IHVuZGVmaW5lZCxcbiAgb3ZlcnJpZGVzID0gdW5kZWZpbmVkLFxuICBtYXhfY2hhdF9oaXN0b3J5ID0gdW5kZWZpbmVkLFxuICBpbmplY3QgPSBbXSxcbiAgb3JkZXIgPSB1bmRlZmluZWQsXG4gIHN0cmVhbSA9IGZhbHNlLFxufTogZGV0YWlsLkdlbmVyYXRlUGFyYW1zID0ge30pOiBQcm9taXNlPHN0cmluZz4ge1xuICAvL+WIneWni+WMllxuICBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG5cbiAgLy8gMS4g5aSE55CG55So5oi36L6T5YWl77yI5q2j5YiZ77yM5a6P77yJXG4gIGNvbnN0IHByb2Nlc3NlZFVzZXJJbnB1dCA9IHByb2Nlc3NVc2VySW5wdXQoc3Vic3RpdHV0ZVBhcmFtcyh1c2VyX2lucHV0KSkgfHwgJyc7XG5cbiAgLy8gMi4g5YeG5aSH6L+H5ruk5ZCO55qE5Z+656GA5pWw5o2uXG4gIGNvbnN0IGJhc2VEYXRhID0gYXdhaXQgcHJlcGFyZUFuZE92ZXJyaWRlRGF0YShcbiAgICB7XG4gICAgICBvdmVycmlkZXMsXG4gICAgICBtYXhfY2hhdF9oaXN0b3J5LFxuICAgICAgaW5qZWN0LFxuICAgICAgb3JkZXIsXG4gICAgfSxcbiAgICBwcm9jZXNzZWRVc2VySW5wdXQsXG4gICk7XG5cbiAgLy8gMy4g5qC55o2uIHVzZV9wcmVzZXQg5YiG5rWB5aSE55CGXG4gIGNvbnN0IGdlbmVyYXRlX2RhdGEgPSB1c2VfcHJlc2V0XG4gICAgPyBhd2FpdCBoYW5kbGVQcmVzZXRQYXRoKGJhc2VEYXRhLCBwcm9jZXNzZWRVc2VySW5wdXQsIHtcbiAgICAgICAgaW1hZ2UsXG4gICAgICAgIG92ZXJyaWRlcyxcbiAgICAgICAgbWF4X2NoYXRfaGlzdG9yeSxcbiAgICAgICAgaW5qZWN0LFxuICAgICAgICBvcmRlcixcbiAgICAgIH0pXG4gICAgOiBhd2FpdCBoYW5kbGVDdXN0b21QYXRoKFxuICAgICAgICBiYXNlRGF0YSxcbiAgICAgICAge1xuICAgICAgICAgIGltYWdlLFxuICAgICAgICAgIG92ZXJyaWRlcyxcbiAgICAgICAgICBtYXhfY2hhdF9oaXN0b3J5LFxuICAgICAgICAgIGluamVjdCxcbiAgICAgICAgICBvcmRlcixcbiAgICAgICAgfSxcbiAgICAgICAgcHJvY2Vzc2VkVXNlcklucHV0LFxuICAgICAgKTtcbiAgY29uc29sZS5sb2coJ1tHZW5lcmF0ZTrlj5HpgIHmj5DnpLror41dJywgZ2VuZXJhdGVfZGF0YSk7XG4gIC8vIDQuIOagueaNriBzdHJlYW0g5Y+C5pWw5Yaz5a6a55Sf5oiQ5pa55byPXG4gIHJldHVybiBhd2FpdCBnZW5lcmF0ZVJlc3BvbnNlKGdlbmVyYXRlX2RhdGEsIHN0cmVhbSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHByZXBhcmVBbmRPdmVycmlkZURhdGEoXG4gIGNvbmZpZzogT21pdDxkZXRhaWwuR2VuZXJhdGVQYXJhbXMsICd1c2VyX2lucHV0JyB8ICd1c2VfcHJlc2V0Jz4sXG4gIHByb2Nlc3NlZFVzZXJJbnB1dDogc3RyaW5nLFxuKSB7XG4gIGNvbnN0IGdldE92ZXJyaWRlQ29udGVudCA9IChpZGVudGlmaWVyOiBzdHJpbmcpOiBzdHJpbmcgfCBSb2xlUHJvbXB0W10gfCB1bmRlZmluZWQgPT4ge1xuICAgIGlmICghY29uZmlnLm92ZXJyaWRlcykgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICBjb25zdCB2YWx1ZSA9IGNvbmZpZy5vdmVycmlkZXNbaWRlbnRpZmllciBhcyBrZXlvZiBkZXRhaWwuT3ZlcnJpZGVDb25maWddO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJykgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgLy8gMS4g5aSE55CG6KeS6Imy5Y2h6auY57qn5a6a5LmJ6KeS6Imy5aSH5rOoIC0g5LuF5ZyoY2hhdF9oaXN0b3J55pyq6KKr6L+H5ruk5pe25omn6KGMXG4gIGlmICghaXNQcm9tcHRGaWx0ZXJlZCgnY2hhdF9oaXN0b3J5JywgY29uZmlnKSkge1xuICAgIGhhbmRsZUNoYXJEZXB0aFByb21wdCgpO1xuICB9XG5cbiAgLy8gMi4g6K6+572u5L2c6ICF5rOo6YeKIC0g5LuF5ZyoY2hhdF9oaXN0b3J55pyq6KKr6L+H5ruk5pe25omn6KGMXG4gIGlmICghaXNQcm9tcHRGaWx0ZXJlZCgnY2hhdF9oaXN0b3J5JywgY29uZmlnKSAmJiAhaXNQcm9tcHRGaWx0ZXJlZCgnYXV0aG9yX25vdGUnLCBjb25maWcpKSB7XG4gICAgc2V0QXV0aG9yTm90ZVByb21wdChjb25maWcpO1xuICB9XG5cbiAgLy8gMy4g5aSE55CGdXNlcuinkuiJsuaPj+i/sCAtIOS7heWcqGNoYXRfaGlzdG9yeeWSjHBlcnNvbmFfZGVzY3JpcHRpb27pg73mnKrooqvov4fmu6Tml7bmiafooYxcbiAgaWYgKCFpc1Byb21wdEZpbHRlcmVkKCdjaGF0X2hpc3RvcnknLCBjb25maWcpICYmICFpc1Byb21wdEZpbHRlcmVkKCdwZXJzb25hX2Rlc2NyaXB0aW9uJywgY29uZmlnKSkge1xuICAgIHNldFBlcnNvbmFEZXNjcmlwdGlvbkV4dGVuc2lvblByb21wdCgpO1xuICB9XG5cbiAgLy8gNC4g6I635Y+W6KeS6Imy5Y2h5Z+656GA5a2X5q61XG4gIGNvbnN0IHtcbiAgICBkZXNjcmlwdGlvbjogcmF3RGVzY3JpcHRpb24sXG4gICAgcGVyc29uYWxpdHk6IHJhd1BlcnNvbmFsaXR5LFxuICAgIHBlcnNvbmE6IHJhd1BlcnNvbmEsXG4gICAgc2NlbmFyaW86IHJhd1NjZW5hcmlvLFxuICAgIG1lc0V4YW1wbGVzOiByYXdNZXNFeGFtcGxlcyxcbiAgICBzeXN0ZW0sXG4gICAgamFpbGJyZWFrLFxuICAgIGNoYXJEZXB0aFByb21wdCxcbiAgICBjcmVhdG9yTm90ZXMsXG4gIH0gPSBnZXRDaGFyYWN0ZXJDYXJkRmllbGRzKCk7XG5cbiAgLy8g5Yik5pat5piv5ZCm6KKr6L+H5rukLOWmguaenOiiq+i/h+a7pOi/lOWbnuepuuWtl+espuS4sizlkKbliJnov5Tlm55vdmVycmlkZeeahOWAvOaIluWOn+Wni+WAvFxuICBjb25zdCBkZXNjcmlwdGlvbiA9IGlzUHJvbXB0RmlsdGVyZWQoJ2NoYXJfZGVzY3JpcHRpb24nLCBjb25maWcpXG4gICAgPyAnJ1xuICAgIDogZ2V0T3ZlcnJpZGVDb250ZW50KCdjaGFyX2Rlc2NyaXB0aW9uJykgPz8gcmF3RGVzY3JpcHRpb247XG5cbiAgY29uc3QgcGVyc29uYWxpdHkgPSBpc1Byb21wdEZpbHRlcmVkKCdjaGFyX3BlcnNvbmFsaXR5JywgY29uZmlnKVxuICAgID8gJydcbiAgICA6IGdldE92ZXJyaWRlQ29udGVudCgnY2hhcl9wZXJzb25hbGl0eScpID8/IHJhd1BlcnNvbmFsaXR5O1xuXG4gIGNvbnN0IHBlcnNvbmEgPSBpc1Byb21wdEZpbHRlcmVkKCdwZXJzb25hX2Rlc2NyaXB0aW9uJywgY29uZmlnKVxuICAgID8gJydcbiAgICA6IGdldE92ZXJyaWRlQ29udGVudCgncGVyc29uYV9kZXNjcmlwdGlvbicpID8/IHJhd1BlcnNvbmE7XG5cbiAgY29uc3Qgc2NlbmFyaW8gPSBpc1Byb21wdEZpbHRlcmVkKCdzY2VuYXJpbycsIGNvbmZpZykgPyAnJyA6IGdldE92ZXJyaWRlQ29udGVudCgnc2NlbmFyaW8nKSA/PyByYXdTY2VuYXJpbztcblxuICBjb25zdCBtZXNFeGFtcGxlcyA9IGlzUHJvbXB0RmlsdGVyZWQoJ2RpYWxvZ3VlX2V4YW1wbGVzJywgY29uZmlnKVxuICAgID8gJydcbiAgICA6IChnZXRPdmVycmlkZUNvbnRlbnQoJ2RpYWxvZ3VlX2V4YW1wbGVzJykgYXMgc3RyaW5nKSA/PyByYXdNZXNFeGFtcGxlcztcblxuICBsZXQgbWVzRXhhbXBsZXNBcnJheSA9IHBhcnNlTWVzRXhhbXBsZXMobWVzRXhhbXBsZXMpO1xuICBsZXQgb2FpTWVzc2FnZUV4YW1wbGVzID0gW107XG4gIG9haU1lc3NhZ2VFeGFtcGxlcyA9IHNldE9wZW5BSU1lc3NhZ2VFeGFtcGxlcyhtZXNFeGFtcGxlc0FycmF5KTtcblxuICAvLyA1LiDojrflj5blgY/nva7lrZfnrKbkuLJcbiAgY29uc3QgeyBwcm9tcHRCaWFzIH0gPSBnZXRCaWFzU3RyaW5ncyhwcm9jZXNzZWRVc2VySW5wdXQsIHR5cGUpO1xuXG4gIC8vIDYuIOWkhOeQhuiHquWumuS5ieazqOWFpeeahOaPkOekuuivjVxuICBpZiAoY29uZmlnLmluamVjdCkge1xuICAgIGF3YWl0IGhhbmRsZUluamVjdGVkUHJvbXB0cyhjb25maWcpO1xuICB9XG5cbiAgLy8gNy4g5aSE55CG6IGK5aSp6K6w5b2VXG4gIGxldCBvYWlNZXNzYWdlcyA9IFtdO1xuICBpZiAoY29uZmlnLm92ZXJyaWRlcz8uY2hhdF9oaXN0b3J5KSB7XG4gICAgb2FpTWVzc2FnZXMgPSBbLi4uY29uZmlnLm92ZXJyaWRlcy5jaGF0X2hpc3RvcnldLnJldmVyc2UoKTtcbiAgfSBlbHNlIHtcbiAgICBvYWlNZXNzYWdlcyA9IHNldE9wZW5BSU1lc3NhZ2VzKGF3YWl0IHByb2Nlc3NDaGF0SGlzdG9yeShjaGF0KSk7XG4gICAgaWYgKGNvbmZpZy5tYXhfY2hhdF9oaXN0b3J5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIG9haU1lc3NhZ2VzID0gb2FpTWVzc2FnZXMuc2xpY2UoMCwgY29uZmlnLm1heF9jaGF0X2hpc3RvcnkpO1xuICAgIH1cbiAgfVxuXG4gIC8vIOa3u+WKoOS4tOaXtua2iOaBr+eUqOS6jua/gOa0u+S4lueVjOS5plxuICBhZGRUZW1wb3JhcnlVc2VyTWVzc2FnZShwcm9jZXNzZWRVc2VySW5wdXQpO1xuICAvLyA4LiDlpITnkIbkuJbnlYzkv6Hmga9cbiAgY29uc3Qgd29ybGRJbmZvID0gYXdhaXQgcHJvY2Vzc1dvcmxkSW5mbyhvYWlNZXNzYWdlcyBhcyBSb2xlUHJvbXB0W10sIGNvbmZpZywge1xuICAgIGRlc2NyaXB0aW9uOiByYXdEZXNjcmlwdGlvbixcbiAgICBwZXJzb25hbGl0eTogcmF3UGVyc29uYWxpdHksXG4gICAgcGVyc29uYTogcmF3UGVyc29uYSxcbiAgICBzY2VuYXJpbzogcmF3U2NlbmFyaW8sXG4gICAgY2hhckRlcHRoUHJvbXB0LFxuICAgIGNyZWF0b3JOb3RlcyxcbiAgfSk7XG5cbiAgLy8g56e76Zmk5Li05pe25raI5oGvXG4gIHJlbW92ZVRlbXBvcmFyeVVzZXJNZXNzYWdlKCk7XG5cbiAgLy8gOS4g5aSE55CG5LiW55WM5Lmm5raI5oGv56S65L6LXG4gIG1lc0V4YW1wbGVzQXJyYXkgPSAhaXNQcm9tcHRGaWx0ZXJlZCgnZGlhbG9ndWVfZXhhbXBsZXMnLCBjb25maWcpXG4gICAgPyBhd2FpdCBwcm9jZXNzTWVzc2FnZUV4YW1wbGVzKG1lc0V4YW1wbGVzQXJyYXksIHdvcmxkSW5mby53b3JsZEluZm9FeGFtcGxlcylcbiAgICA6IFtdO1xuXG4gIHJldHVybiB7XG4gICAgY2hhcmFjdGVySW5mbzoge1xuICAgICAgZGVzY3JpcHRpb24sXG4gICAgICBwZXJzb25hbGl0eSxcbiAgICAgIHBlcnNvbmEsXG4gICAgICBzY2VuYXJpbyxcbiAgICAgIHN5c3RlbTogc3lzdGVtLFxuICAgICAgamFpbGJyZWFrOiBqYWlsYnJlYWssXG4gICAgfSxcbiAgICBjaGF0Q29udGV4dDoge1xuICAgICAgb2FpTWVzc2FnZXMsXG4gICAgICBvYWlNZXNzYWdlRXhhbXBsZXMsXG4gICAgICBwcm9tcHRCaWFzLFxuICAgIH0sXG4gICAgd29ybGRJbmZvLFxuICB9O1xufVxuXG4vL+WkhOeQhuinkuiJsuWNoeS4reeahOa3seW6puaPkOekuuivjVxuZnVuY3Rpb24gaGFuZGxlQ2hhckRlcHRoUHJvbXB0KCkge1xuICBjb25zdCBkZXB0aFByb21wdFRleHQgPVxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBiYXNlQ2hhdFJlcGxhY2UoY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5kZXB0aF9wcm9tcHQ/LnByb21wdD8udHJpbSgpLCBuYW1lMSwgbmFtZTIpIHx8ICcnO1xuICAvLyBAdHMtaWdub3JlXG4gIGNvbnN0IGRlcHRoUHJvbXB0RGVwdGggPSBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0/LmRhdGE/LmV4dGVuc2lvbnM/LmRlcHRoX3Byb21wdD8uZGVwdGggPz8gJzQnO1xuICBjb25zdCBkZXB0aFByb21wdFJvbGUgPSBnZXRFeHRlbnNpb25Qcm9tcHRSb2xlQnlOYW1lKFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0/LmRhdGE/LmV4dGVuc2lvbnM/LmRlcHRoX3Byb21wdD8ucm9sZSA/PyAnc3lzdGVtJyxcbiAgKTtcbiAgc2V0RXh0ZW5zaW9uUHJvbXB0KFxuICAgICdERVBUSF9QUk9NUFQnLFxuICAgIGRlcHRoUHJvbXB0VGV4dCxcbiAgICBleHRlbnNpb25fcHJvbXB0X3R5cGVzLklOX0NIQVQsXG4gICAgZGVwdGhQcm9tcHREZXB0aCxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZXh0ZW5zaW9uX3NldHRpbmdzLm5vdGUuYWxsb3dXSVNjYW4sXG4gICAgZGVwdGhQcm9tcHRSb2xlLFxuICApO1xufVxuLy/lpITnkIbkvZzogIXms6jph4pcbmZ1bmN0aW9uIHNldEF1dGhvck5vdGVQcm9tcHQoY29uZmlnOiBkZXRhaWwuR2VuZXJhdGVQYXJhbXMpIHtcbiAgY29uc3QgYXV0aG9yTm90ZU92ZXJyaWRlID0gY29uZmlnPy5vdmVycmlkZXM/LmF1dGhvcl9ub3RlO1xuICAvLyBAdHMtaWdub3JlXG4gIGNvbnN0IHByb21wdCA9IGF1dGhvck5vdGVPdmVycmlkZSA/PyAoJCgnI2V4dGVuc2lvbl9mbG9hdGluZ19wcm9tcHQnKS52YWwoKSBhcyBzdHJpbmcpO1xuXG4gIHNldEV4dGVuc2lvblByb21wdChcbiAgICBOT1RFX01PRFVMRV9OQU1FLFxuICAgIHByb21wdCxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY2hhdF9tZXRhZGF0YVttZXRhZGF0YV9rZXlzLnBvc2l0aW9uXSxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY2hhdF9tZXRhZGF0YVttZXRhZGF0YV9rZXlzLmRlcHRoXSxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZXh0ZW5zaW9uX3NldHRpbmdzLm5vdGUuYWxsb3dXSVNjYW4sXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNoYXRfbWV0YWRhdGFbbWV0YWRhdGFfa2V5cy5yb2xlXSxcbiAgKTtcbn1cbi8v55So5oi36KeS6Imy5o+P6L+w5o+Q56S66K+N6K6+572u5Li65o+Q56S66K+N566h55CG5Zmo5LmL5aSW55qE6YCJ6aG555qE5oOF5Ya1XG5mdW5jdGlvbiBzZXRQZXJzb25hRGVzY3JpcHRpb25FeHRlbnNpb25Qcm9tcHQoKSB7XG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gcG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uO1xuICBjb25zdCBJTkpFQ1RfVEFHID0gJ1BFUlNPTkFfREVTQ1JJUFRJT04nO1xuICBzZXRFeHRlbnNpb25Qcm9tcHQoSU5KRUNUX1RBRywgJycsIGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuSU5fUFJPTVBULCAwKTtcblxuICBpZiAoIWRlc2NyaXB0aW9uIHx8IHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbiA9PT0gcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuTk9ORSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8v5b2TdXNlcuS/oeaBr+WcqOS9nOiAheazqOmHiuWJjeWQjiAtIOS7heWcqOS9nOiAheazqOmHiuacquiiq+i/h+a7pOaXtuaJp+ihjFxuICBjb25zdCBwcm9tcHRQb3NpdGlvbnMgPSBbcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuQk9UVE9NX0FOLCBwZXJzb25hX2Rlc2NyaXB0aW9uX3Bvc2l0aW9ucy5UT1BfQU5dO1xuXG4gIGlmIChwcm9tcHRQb3NpdGlvbnMuaW5jbHVkZXMocG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uX3Bvc2l0aW9uKSAmJiBzaG91bGRXSUFkZFByb21wdCkge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBvcmlnaW5hbEFOID0gZ2V0Q29udGV4dCgpLmV4dGVuc2lvblByb21wdHNbTk9URV9NT0RVTEVfTkFNRV0udmFsdWU7XG4gICAgY29uc3QgQU5XaXRoRGVzYyA9XG4gICAgICBwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb24gPT09IHBlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb25zLlRPUF9BTlxuICAgICAgICA/IGAke2Rlc2NyaXB0aW9ufVxcbiR7b3JpZ2luYWxBTn1gXG4gICAgICAgIDogYCR7b3JpZ2luYWxBTn1cXG4ke2Rlc2NyaXB0aW9ufWA7XG5cbiAgICBzZXRFeHRlbnNpb25Qcm9tcHQoXG4gICAgICBOT1RFX01PRFVMRV9OQU1FLFxuICAgICAgQU5XaXRoRGVzYyxcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNoYXRfbWV0YWRhdGFbbWV0YWRhdGFfa2V5cy5wb3NpdGlvbl0sXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjaGF0X21ldGFkYXRhW21ldGFkYXRhX2tleXMuZGVwdGhdLFxuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgZXh0ZW5zaW9uX3NldHRpbmdzLm5vdGUuYWxsb3dXSVNjYW4sXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjaGF0X21ldGFkYXRhW21ldGFkYXRhX2tleXMucm9sZV0sXG4gICAgKTtcbiAgfVxuXG4gIC8vIHVzZXLkv6Hmga/mt7Hluqbms6jlhaXkuI3kvp3otZbkuo7kvZzogIXms6jph4rnmoTnirbmgIHvvIznm7TmjqXlupTnlKhcbiAgaWYgKHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbiA9PT0gcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuQVRfREVQVEgpIHtcbiAgICBzZXRFeHRlbnNpb25Qcm9tcHQoXG4gICAgICBJTkpFQ1RfVEFHLFxuICAgICAgZGVzY3JpcHRpb24sXG4gICAgICBleHRlbnNpb25fcHJvbXB0X3R5cGVzLklOX0NIQVQsXG4gICAgICBwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb25fZGVwdGgsXG4gICAgICB0cnVlLFxuICAgICAgcG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uX3JvbGUsXG4gICAgKTtcbiAgfVxufVxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlSW5qZWN0ZWRQcm9tcHRzKHByb21wdENvbmZpZzogT21pdDxkZXRhaWwuR2VuZXJhdGVQYXJhbXMsICd1c2VyX2lucHV0JyB8ICd1c2VfcHJlc2V0Jz4pIHtcbiAgaWYgKCFwcm9tcHRDb25maWcgfHwgIUFycmF5LmlzQXJyYXkocHJvbXB0Q29uZmlnLmluamVjdCkpIHJldHVybjtcblxuICBjb25zdCBpbmplY3RzID0gcHJvbXB0Q29uZmlnLmluamVjdDtcblxuICBjb25zdCBwb3NpdGlvbl9tYXAgPSB7XG4gICAgYmVmb3JlX3Byb21wdDogZXh0ZW5zaW9uX3Byb21wdF90eXBlcy5CRUZPUkVfUFJPTVBULFxuICAgIGluX2NoYXQ6IGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuSU5fQ0hBVCxcbiAgICBhZnRlcl9wcm9tcHQ6IGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuSU5fUFJPTVBULFxuICAgIG5vbmU6IGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuTk9ORSxcbiAgfSBhcyBjb25zdDtcblxuICBmb3IgKGNvbnN0IGluamVjdCBvZiBpbmplY3RzKSB7XG4gICAgY29uc3QgdmFsaWRhdGVkSW5qZWN0ID0ge1xuICAgICAgcm9sZTogcm9sZVR5cGVzW2luamVjdC5yb2xlXSA/PyBleHRlbnNpb25fcHJvbXB0X3JvbGVzLlNZU1RFTSxcbiAgICAgIGNvbnRlbnQ6IGluamVjdC5jb250ZW50IHx8ICcnLFxuICAgICAgZGVwdGg6IE51bWJlcihpbmplY3QuZGVwdGgpIHx8IDAsXG4gICAgICBzaG91bGRfc2NhbjogQm9vbGVhbihpbmplY3Quc2hvdWxkX3NjYW4pIHx8IHRydWUsXG4gICAgICBwb3NpdGlvbjogcG9zaXRpb25fbWFwW2luamVjdC5wb3NpdGlvbiBhcyBrZXlvZiB0eXBlb2YgcG9zaXRpb25fbWFwXSA/PyBleHRlbnNpb25fcHJvbXB0X3R5cGVzLklOX0NIQVQsXG4gICAgfTtcblxuICAgIC8vIOiuvue9rueUqOaIt+iHquWumuS5ieazqOWFpeaPkOekuuivjVxuICAgIHNldEV4dGVuc2lvblByb21wdChcbiAgICAgIGBJTkpFQ1RJT04tJHtpbmplY3QuZGVwdGh9LSR7aW5qZWN0LnJvbGV9YCxcbiAgICAgIHZhbGlkYXRlZEluamVjdC5jb250ZW50LFxuICAgICAgdmFsaWRhdGVkSW5qZWN0LnBvc2l0aW9uLFxuICAgICAgdmFsaWRhdGVkSW5qZWN0LmRlcHRoLFxuICAgICAgdmFsaWRhdGVkSW5qZWN0LnNob3VsZF9zY2FuLFxuICAgICAgdmFsaWRhdGVkSW5qZWN0LnJvbGUsXG4gICAgKTtcbiAgfVxufVxuLy8g5aSE55CG6IGK5aSp6K6w5b2VXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzQ2hhdEhpc3RvcnkoY2hhdEhpc3Rvcnk6IGFueVtdKSB7XG4gIGNvbnN0IGNvcmVDaGF0ID0gY2hhdEhpc3RvcnkuZmlsdGVyKHggPT4gIXguaXNfc3lzdGVtKTtcblxuICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgY29yZUNoYXQubWFwKGFzeW5jIChjaGF0SXRlbSwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBjaGF0SXRlbS5tZXM7XG4gICAgICBjb25zdCByZWdleFR5cGUgPSBjaGF0SXRlbS5pc191c2VyID8gcmVnZXhfcGxhY2VtZW50LlVTRVJfSU5QVVQgOiByZWdleF9wbGFjZW1lbnQuQUlfT1VUUFVUO1xuXG4gICAgICBjb25zdCByZWdleGVkTWVzc2FnZSA9IGdldFJlZ2V4ZWRTdHJpbmcobWVzc2FnZSwgcmVnZXhUeXBlLCB7XG4gICAgICAgIGlzUHJvbXB0OiB0cnVlLFxuICAgICAgICBkZXB0aDogY29yZUNoYXQubGVuZ3RoIC0gaW5kZXggLSAxLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmNoYXRJdGVtLFxuICAgICAgICBtZXM6IHJlZ2V4ZWRNZXNzYWdlLFxuICAgICAgICBpbmRleCxcbiAgICAgIH07XG4gICAgfSksXG4gICk7XG59XG5cbi8vIOWkhOeQhuS4lueVjOS5plxuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1dvcmxkSW5mbyhcbiAgb2FpTWVzc2FnZXM6IFJvbGVQcm9tcHRbXSxcbiAgY29uZmlnOiBPbWl0PGRldGFpbC5HZW5lcmF0ZVBhcmFtcywgJ3VzZXJfaW5wdXQnIHwgJ3VzZV9wcmVzZXQnPixcbiAgY2hhcmFjdGVySW5mbzoge1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgcGVyc29uYWxpdHk6IHN0cmluZztcbiAgICBwZXJzb25hOiBzdHJpbmc7XG4gICAgc2NlbmFyaW86IHN0cmluZztcbiAgICBjaGFyRGVwdGhQcm9tcHQ6IHN0cmluZztcbiAgICBjcmVhdG9yTm90ZXM6IHN0cmluZztcbiAgfSxcbikge1xuICBjb25zdCBjaGF0Rm9yV0kgPSBvYWlNZXNzYWdlc1xuICAgIC5maWx0ZXIoeCA9PiB4LnJvbGUgIT09ICdzeXN0ZW0nKVxuICAgIC5tYXAoeCA9PiB7XG4gICAgICBjb25zdCBuYW1lID0geC5yb2xlID09PSAndXNlcicgPyBuYW1lMSA6IG5hbWUyO1xuICAgICAgcmV0dXJuIHdvcmxkX2luZm9faW5jbHVkZV9uYW1lcyA/IGAke25hbWV9OiAke3guY29udGVudH1gIDogeC5jb250ZW50O1xuICAgIH0pXG4gICAgLnJldmVyc2UoKTtcblxuICBjb25zdCB0aGlzX21heF9jb250ZXh0ID0gZ2V0TWF4Q29udGV4dFNpemUoKTtcbiAgY29uc3QgZ2xvYmFsU2NhbkRhdGEgPSB7XG4gICAgcGVyc29uYURlc2NyaXB0aW9uOiBjb25maWcub3ZlcnJpZGVzPy5wZXJzb25hX2Rlc2NyaXB0aW9uID8/IGNoYXJhY3RlckluZm8ucGVyc29uYSxcbiAgICBjaGFyYWN0ZXJEZXNjcmlwdGlvbjogY29uZmlnLm92ZXJyaWRlcz8uY2hhcl9kZXNjcmlwdGlvbiA/PyBjaGFyYWN0ZXJJbmZvLmRlc2NyaXB0aW9uLFxuICAgIGNoYXJhY3RlclBlcnNvbmFsaXR5OiBjb25maWcub3ZlcnJpZGVzPy5jaGFyX3BlcnNvbmFsaXR5ID8/IGNoYXJhY3RlckluZm8ucGVyc29uYWxpdHksXG4gICAgY2hhcmFjdGVyRGVwdGhQcm9tcHQ6IGNoYXJhY3RlckluZm8uY2hhckRlcHRoUHJvbXB0LFxuICAgIHNjZW5hcmlvOiBjb25maWcub3ZlcnJpZGVzPy5zY2VuYXJpbyA/PyBjaGFyYWN0ZXJJbmZvLnNjZW5hcmlvLFxuICAgIGNyZWF0b3JOb3RlczogY2hhcmFjdGVySW5mby5jcmVhdG9yTm90ZXMsXG4gIH07XG4gIGNvbnN0IHsgd29ybGRJbmZvU3RyaW5nLCB3b3JsZEluZm9CZWZvcmUsIHdvcmxkSW5mb0FmdGVyLCB3b3JsZEluZm9FeGFtcGxlcywgd29ybGRJbmZvRGVwdGggfSA9XG4gICAgYXdhaXQgZ2V0V29ybGRJbmZvUHJvbXB0KGNoYXRGb3JXSSwgdGhpc19tYXhfY29udGV4dCwgZHJ5UnVuLCBnbG9iYWxTY2FuRGF0YSk7XG5cbiAgYXdhaXQgY2xlYXJJbmplY3Rpb25Qcm9tcHRzKFsnY3VzdG9tRGVwdGhXSSddKTtcblxuICBpZiAoIWlzUHJvbXB0RmlsdGVyZWQoJ3dpdGhfZGVwdGhfZW50cmllcycsIGNvbmZpZykpIHtcbiAgICBwcm9jZXNzV29ybGRJbmZvRGVwdGgod29ybGRJbmZvRGVwdGgpO1xuICB9XG5cbiAgLy8g5YWI5qOA5p+l5piv5ZCm6KKr6L+H5ruk77yM5aaC5p6c6KKr6L+H5ruk55u05o6l6L+U5ZuebnVsbFxuICBjb25zdCBmaW5hbFdvcmxkSW5mb0JlZm9yZSA9IGlzUHJvbXB0RmlsdGVyZWQoJ3dvcmxkX2luZm9fYmVmb3JlJywgY29uZmlnKVxuICAgID8gbnVsbFxuICAgIDogY29uZmlnLm92ZXJyaWRlcz8ud29ybGRfaW5mb19iZWZvcmUgIT09IHVuZGVmaW5lZFxuICAgID8gY29uZmlnLm92ZXJyaWRlcy53b3JsZF9pbmZvX2JlZm9yZVxuICAgIDogd29ybGRJbmZvQmVmb3JlO1xuXG4gIGNvbnN0IGZpbmFsV29ybGRJbmZvQWZ0ZXIgPSBpc1Byb21wdEZpbHRlcmVkKCd3b3JsZF9pbmZvX2FmdGVyJywgY29uZmlnKVxuICAgID8gbnVsbFxuICAgIDogY29uZmlnLm92ZXJyaWRlcz8ud29ybGRfaW5mb19hZnRlciAhPT0gdW5kZWZpbmVkXG4gICAgPyBjb25maWcub3ZlcnJpZGVzLndvcmxkX2luZm9fYWZ0ZXJcbiAgICA6IHdvcmxkSW5mb0FmdGVyO1xuXG4gIHJldHVybiB7XG4gICAgd29ybGRJbmZvU3RyaW5nLFxuICAgIHdvcmxkSW5mb0JlZm9yZTogZmluYWxXb3JsZEluZm9CZWZvcmUsXG4gICAgd29ybGRJbmZvQWZ0ZXI6IGZpbmFsV29ybGRJbmZvQWZ0ZXIsXG4gICAgd29ybGRJbmZvRXhhbXBsZXMsXG4gICAgd29ybGRJbmZvRGVwdGg6ICFpc1Byb21wdEZpbHRlcmVkKCd3aXRoX2RlcHRoX2VudHJpZXMnLCBjb25maWcpID8gd29ybGRJbmZvRGVwdGggOiBudWxsLFxuICB9O1xufVxuLy8g5aSE55CG5LiW55WM5L+h5oGv5rex5bqm6YOo5YiGXG5mdW5jdGlvbiBwcm9jZXNzV29ybGRJbmZvRGVwdGgod29ybGRJbmZvRGVwdGg6IGFueVtdKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KHdvcmxkSW5mb0RlcHRoKSkge1xuICAgIHdvcmxkSW5mb0RlcHRoLmZvckVhY2goZW50cnkgPT4ge1xuICAgICAgY29uc3Qgam9pbmVkRW50cmllcyA9IGVudHJ5LmVudHJpZXMuam9pbignXFxuJyk7XG4gICAgICBzZXRFeHRlbnNpb25Qcm9tcHQoXG4gICAgICAgIGBjdXN0b21EZXB0aFdJLSR7ZW50cnkuZGVwdGh9LSR7ZW50cnkucm9sZX1gLFxuICAgICAgICBqb2luZWRFbnRyaWVzLFxuICAgICAgICBleHRlbnNpb25fcHJvbXB0X3R5cGVzLklOX0NIQVQsXG4gICAgICAgIGVudHJ5LmRlcHRoLFxuICAgICAgICBmYWxzZSxcbiAgICAgICAgZW50cnkucm9sZSxcbiAgICAgICk7XG4gICAgfSk7XG4gIH1cbn1cbi8vIOWkhOeQhuS4lueVjOS5puS4reekuuS+i+WJjeWQjlxuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc01lc3NhZ2VFeGFtcGxlcyhtZXNFeGFtcGxlc0FycmF5OiBzdHJpbmdbXSwgd29ybGRJbmZvRXhhbXBsZXM6IGFueVtdKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAvLyDlpITnkIbkuJbnlYzkv6Hmga/kuK3nmoTnpLrkvotcbiAgZm9yIChjb25zdCBleGFtcGxlIG9mIHdvcmxkSW5mb0V4YW1wbGVzKSB7XG4gICAgaWYgKCFleGFtcGxlLmNvbnRlbnQubGVuZ3RoKSBjb250aW51ZTtcblxuICAgIGNvbnN0IGZvcm1hdHRlZEV4YW1wbGUgPSBiYXNlQ2hhdFJlcGxhY2UoZXhhbXBsZS5jb250ZW50LCBuYW1lMSwgbmFtZTIpO1xuICAgIGNvbnN0IGNsZWFuZWRFeGFtcGxlID0gcGFyc2VNZXNFeGFtcGxlcyhmb3JtYXR0ZWRFeGFtcGxlKTtcblxuICAgIGlmIChleGFtcGxlLnBvc2l0aW9uID09PSB3aV9hbmNob3JfcG9zaXRpb24uYmVmb3JlKSB7XG4gICAgICBtZXNFeGFtcGxlc0FycmF5LnVuc2hpZnQoLi4uY2xlYW5lZEV4YW1wbGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBtZXNFeGFtcGxlc0FycmF5LnB1c2goLi4uY2xlYW5lZEV4YW1wbGUpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBtZXNFeGFtcGxlc0FycmF5O1xufVxuLy/lpITnkIblr7nor53npLrkvovmoLzlvI9cbmZ1bmN0aW9uIHBhcnNlTWVzRXhhbXBsZXMoZXhhbXBsZXNTdHI6IHN0cmluZykge1xuICBpZiAoZXhhbXBsZXNTdHIubGVuZ3RoID09PSAwIHx8IGV4YW1wbGVzU3RyID09PSAnPFNUQVJUPicpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBpZiAoIWV4YW1wbGVzU3RyLnN0YXJ0c1dpdGgoJzxTVEFSVD4nKSkge1xuICAgIGV4YW1wbGVzU3RyID0gJzxTVEFSVD5cXG4nICsgZXhhbXBsZXNTdHIudHJpbSgpO1xuICB9XG4gIGNvbnN0IGJsb2NrSGVhZGluZyA9ICc8U1RBUlQ+XFxuJztcbiAgY29uc3Qgc3BsaXRFeGFtcGxlcyA9IGV4YW1wbGVzU3RyXG4gICAgLnNwbGl0KC88U1RBUlQ+L2dpKVxuICAgIC5zbGljZSgxKVxuICAgIC5tYXAoYmxvY2sgPT4gYCR7YmxvY2tIZWFkaW5nfSR7YmxvY2sudHJpbSgpfVxcbmApO1xuXG4gIHJldHVybiBzcGxpdEV4YW1wbGVzO1xufVxuLy/nlKjmiLfovpPlhaXlhYjmraPliJnlpITnkIZcbmZ1bmN0aW9uIHByb2Nlc3NVc2VySW5wdXQodXNlcl9pbnB1dDogc3RyaW5nKSB7XG4gIGlmICh1c2VyX2lucHV0ID09PSAnJykge1xuICAgIHVzZXJfaW5wdXQgPSBvYWlfc2V0dGluZ3Muc2VuZF9pZl9lbXB0eS50cmltKCk7XG4gIH1cbiAgcmV0dXJuIGdldFJlZ2V4ZWRTdHJpbmcodXNlcl9pbnB1dCwgcmVnZXhfcGxhY2VtZW50LlVTRVJfSU5QVVQsIHtcbiAgICBpc1Byb21wdDogdHJ1ZSxcbiAgICBkZXB0aDogMCxcbiAgfSk7XG59XG4vL+S9v+eUqOmihOiuvlxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlUHJlc2V0UGF0aChcbiAgYmFzZURhdGE6IGFueSxcbiAgcHJvY2Vzc2VkVXNlcklucHV0OiBzdHJpbmcsXG4gIGNvbmZpZzogT21pdDxkZXRhaWwuR2VuZXJhdGVQYXJhbXMsICd1c2VyX2lucHV0JyB8ICd1c2VfcHJlc2V0Jz4sXG4pIHtcbiAgLy8gcHJlcGFyZU9wZW5BSU1lc3NhZ2Vz5Lya5LuO6K6+572u6YeM6K+75Y+W5Zy65pmv5Zug5q2k5Li05pe26KaG55uWXG4gIGxldCBvcmlnaW5hbFNjZW5hcmlvID0gbnVsbDtcblxuICB0cnkge1xuICAgIGNvbnN0IHNjZW5hcmlvT3ZlcnJpZGUgPSBjb25maWc/Lm92ZXJyaWRlcz8uc2NlbmFyaW87XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGlmIChzY2VuYXJpb092ZXJyaWRlICYmIGNoYXJhY3RlcnMgJiYgY2hhcmFjdGVyc1t0aGlzX2NoaWRdKSB7XG4gICAgICAvLyDkv53lrZjljp/lp4vlnLrmma9cbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIG9yaWdpbmFsU2NlbmFyaW8gPSBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0uc2NlbmFyaW8gfHwgbnVsbDtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNoYXJhY3RlcnNbdGhpc19jaGlkXS5zY2VuYXJpbyA9IHNjZW5hcmlvT3ZlcnJpZGU7XG4gICAgfVxuICAgIC8vIOa3u+WKoHVzZXLmtojmga8o5LiA5qyh5oCnKVxuICAgIGNvbnN0IHVzZXJNZXNzYWdlVGVtcCA9IHtcbiAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgIGNvbnRlbnQ6IHByb2Nlc3NlZFVzZXJJbnB1dCxcbiAgICAgIGltYWdlOiBjb25maWcuaW1hZ2UsXG4gICAgfTtcblxuICAgIGlmIChjb25maWcuaW1hZ2UpIHtcbiAgICAgIHVzZXJNZXNzYWdlVGVtcC5pbWFnZSA9IGF3YWl0IGNvbnZlcnRGaWxlVG9CYXNlNjQoY29uZmlnLmltYWdlKTtcbiAgICB9XG5cbiAgICBiYXNlRGF0YS5jaGF0Q29udGV4dC5vYWlNZXNzYWdlcy51bnNoaWZ0KHVzZXJNZXNzYWdlVGVtcCk7XG5cbiAgICBjb25zdCBtZXNzYWdlRGF0YSA9IHtcbiAgICAgIG5hbWUyLFxuICAgICAgY2hhckRlc2NyaXB0aW9uOiBiYXNlRGF0YS5jaGFyYWN0ZXJJbmZvLmRlc2NyaXB0aW9uLFxuICAgICAgY2hhclBlcnNvbmFsaXR5OiBiYXNlRGF0YS5jaGFyYWN0ZXJJbmZvLnBlcnNvbmFsaXR5LFxuICAgICAgU2NlbmFyaW86IGJhc2VEYXRhLmNoYXJhY3RlckluZm8uc2NlbmFyaW8sXG4gICAgICB3b3JsZEluZm9CZWZvcmU6IGJhc2VEYXRhLndvcmxkSW5mby53b3JsZEluZm9CZWZvcmUsXG4gICAgICB3b3JsZEluZm9BZnRlcjogYmFzZURhdGEud29ybGRJbmZvLndvcmxkSW5mb0FmdGVyLFxuICAgICAgZXh0ZW5zaW9uUHJvbXB0czogZ2V0Q29udGV4dCgpLmV4dGVuc2lvblByb21wdHMsXG4gICAgICBiaWFzOiBiYXNlRGF0YS5jaGF0Q29udGV4dC5wcm9tcHRCaWFzLFxuICAgICAgdHlwZTogJ25vcm1hbCcsXG4gICAgICBxdWlldFByb21wdDogJycsXG4gICAgICBxdWlldEltYWdlOiBudWxsLFxuICAgICAgY3ljbGVQcm9tcHQ6ICcnLFxuICAgICAgc3lzdGVtUHJvbXB0T3ZlcnJpZGU6IGJhc2VEYXRhLmNoYXJhY3RlckluZm8uc3lzdGVtLFxuICAgICAgamFpbGJyZWFrUHJvbXB0T3ZlcnJpZGU6IGJhc2VEYXRhLmNoYXJhY3RlckluZm8uamFpbGJyZWFrLFxuICAgICAgcGVyc29uYURlc2NyaXB0aW9uOiBiYXNlRGF0YS5jaGFyYWN0ZXJJbmZvLnBlcnNvbmEsXG4gICAgICBtZXNzYWdlczogYmFzZURhdGEuY2hhdENvbnRleHQub2FpTWVzc2FnZXMsXG4gICAgICBtZXNzYWdlRXhhbXBsZXM6IGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VFeGFtcGxlcyxcbiAgICB9O1xuXG4gICAgY29uc3QgW3Byb21wdF0gPSBhd2FpdCBwcmVwYXJlT3BlbkFJTWVzc2FnZXMobWVzc2FnZURhdGEgYXMgYW55LCBkcnlSdW4pO1xuXG4gICAgcmV0dXJuIHsgcHJvbXB0IH07XG4gIH0gZmluYWxseSB7XG4gICAgLy8g5oGi5aSN5Y6f5aeL5Zy65pmvXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGlmIChvcmlnaW5hbFNjZW5hcmlvICE9PSBudWxsICYmIGNoYXJhY3RlcnMgJiYgY2hhcmFjdGVyc1t0aGlzX2NoaWRdKSB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0uc2NlbmFyaW8gPSBvcmlnaW5hbFNjZW5hcmlvO1xuICAgIH1cbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjb252ZXJ0U3lzdGVtUHJvbXB0c1RvQ29sbGVjdGlvbihcbiAgYmFzZURhdGE6IGFueSxcbiAgcHJvbXB0Q29uZmlnOiBPbWl0PGRldGFpbC5HZW5lcmF0ZVBhcmFtcywgJ3VzZXJfaW5wdXQnIHwgJ3VzZV9wcmVzZXQnPixcbikge1xuICBjb25zdCBwcm9tcHRDb2xsZWN0aW9uID0gbmV3IFByb21wdENvbGxlY3Rpb24oKTtcbiAgY29uc3QgZXhhbXBsZXNDb2xsZWN0aW9uID0gbmV3IE1lc3NhZ2VDb2xsZWN0aW9uKCdkaWFsb2d1ZV9leGFtcGxlcycpO1xuICBcbiAgY29uc3Qgb3JkZXJBcnJheSA9IHByb21wdENvbmZpZy5vcmRlciB8fCBidWlsdGluX3Byb21wdF9kZWZhdWx0X29yZGVyO1xuICBcbiAgY29uc3QgYnVpbHRpblByb21wdENvbnRlbnRzID0ge1xuICAgIHdvcmxkX2luZm9fYmVmb3JlOiBiYXNlRGF0YS53b3JsZEluZm8ud29ybGRJbmZvQmVmb3JlLFxuICAgIHBlcnNvbmFfZGVzY3JpcHRpb246IHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbiAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbiA9PT0gcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuSU5fUFJPTVBUXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGJhc2VEYXRhLmNoYXJhY3RlckluZm8ucGVyc29uYSA6IG51bGwsXG4gICAgY2hhcl9kZXNjcmlwdGlvbjogYmFzZURhdGEuY2hhcmFjdGVySW5mby5kZXNjcmlwdGlvbixcbiAgICBjaGFyX3BlcnNvbmFsaXR5OiBiYXNlRGF0YS5jaGFyYWN0ZXJJbmZvLnBlcnNvbmFsaXR5LFxuICAgIHNjZW5hcmlvOiBiYXNlRGF0YS5jaGFyYWN0ZXJJbmZvLnNjZW5hcmlvLFxuICAgIHdvcmxkX2luZm9fYWZ0ZXI6IGJhc2VEYXRhLndvcmxkSW5mby53b3JsZEluZm9BZnRlcixcbiAgfTtcblxuICBmb3IgKGNvbnN0IFtpbmRleCwgaXRlbV0gb2Ygb3JkZXJBcnJheS5lbnRyaWVzKCkpIHtcbiAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAvLyDlpITnkIblhoXnva7mj5DnpLror41cbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBidWlsdGluUHJvbXB0Q29udGVudHNbaXRlbSBhcyBrZXlvZiB0eXBlb2YgYnVpbHRpblByb21wdENvbnRlbnRzXTtcbiAgICAgIGlmIChjb250ZW50KSB7XG4gICAgICAgIHByb21wdENvbGxlY3Rpb24uYWRkKFxuICAgICAgICAgIG5ldyBQcm9tcHQoe1xuICAgICAgICAgICAgaWRlbnRpZmllcjogaXRlbSxcbiAgICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgICAgIHN5c3RlbV9wcm9tcHQ6IHRydWUsXG4gICAgICAgICAgfSksXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgaXRlbS5yb2xlICYmIGl0ZW0uY29udGVudCkge1xuICAgICAgLy8g5aSE55CG6Ieq5a6a5LmJ5rOo5YWlXG4gICAgICBjb25zdCBpZGVudGlmaWVyID0gYGN1c3RvbV9wcm9tcHRfJHtpbmRleH1gO1xuICAgICAgcHJvbXB0Q29sbGVjdGlvbi5hZGQoXG4gICAgICAgIG5ldyBQcm9tcHQoe1xuICAgICAgICAgIGlkZW50aWZpZXI6IGlkZW50aWZpZXIsXG4gICAgICAgICAgcm9sZTogaXRlbS5yb2xlLFxuICAgICAgICAgIGNvbnRlbnQ6IGl0ZW0uY29udGVudCxcbiAgICAgICAgICBzeXN0ZW1fcHJvbXB0OiBpdGVtLnJvbGUgPT09ICdzeXN0ZW0nLFxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VFeGFtcGxlcy5sZW5ndGggPiAwKSB7XG4gICAgLy8g6YGN5Y6G5omA5pyJ5a+56K+d56S65L6LXG4gICAgZm9yIChjb25zdCBkaWFsb2d1ZSBvZiBbLi4uYmFzZURhdGEuY2hhdENvbnRleHQub2FpTWVzc2FnZUV4YW1wbGVzXSkge1xuICAgICAgY29uc3QgZGlhbG9ndWVJbmRleCA9IGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VFeGFtcGxlcy5pbmRleE9mKGRpYWxvZ3VlKTtcbiAgICAgIGNvbnN0IGNoYXRNZXNzYWdlcyA9IFtdO1xuXG4gICAgICBmb3IgKGxldCBwcm9tcHRJbmRleCA9IDA7IHByb21wdEluZGV4IDwgZGlhbG9ndWUubGVuZ3RoOyBwcm9tcHRJbmRleCsrKSB7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IGRpYWxvZ3VlW3Byb21wdEluZGV4XTtcbiAgICAgICAgY29uc3Qgcm9sZSA9ICdzeXN0ZW0nO1xuICAgICAgICBjb25zdCBjb250ZW50ID0gcHJvbXB0LmNvbnRlbnQgfHwgJyc7XG4gICAgICAgIGNvbnN0IGlkZW50aWZpZXIgPSBgZGlhbG9ndWVfZXhhbXBsZXMgJHtkaWFsb2d1ZUluZGV4fS0ke3Byb21wdEluZGV4fWA7XG5cbiAgICAgICAgY29uc3QgY2hhdE1lc3NhZ2UgPSBhd2FpdCBNZXNzYWdlLmNyZWF0ZUFzeW5jKHJvbGUsIGNvbnRlbnQsIGlkZW50aWZpZXIpO1xuICAgICAgICBhd2FpdCBjaGF0TWVzc2FnZS5zZXROYW1lKHByb21wdC5uYW1lKTtcbiAgICAgICAgY2hhdE1lc3NhZ2VzLnB1c2goY2hhdE1lc3NhZ2UpO1xuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIGNoYXRNZXNzYWdlcykge1xuICAgICAgICBleGFtcGxlc0NvbGxlY3Rpb24uYWRkKG1lc3NhZ2UpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4ge1xuICAgIHN5c3RlbVByb21wdHM6IHByb21wdENvbGxlY3Rpb24sXG4gICAgZGlhbG9ndWVfZXhhbXBsZXM6IGV4YW1wbGVzQ29sbGVjdGlvbixcbiAgfTtcbn1cblxuLy/kuI3kvb/nlKjpooTorr5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUN1c3RvbVBhdGgoXG4gIGJhc2VEYXRhOiBhbnksXG4gIGNvbmZpZzogT21pdDxkZXRhaWwuR2VuZXJhdGVQYXJhbXMsICd1c2VyX2lucHV0JyB8ICd1c2VfcHJlc2V0Jz4sXG4gIHByb2Nlc3NlZFVzZXJJbnB1dDogc3RyaW5nLFxuKSB7XG4gIGNvbnN0IGNoYXRDb21wbGV0aW9uID0gbmV3IENoYXRDb21wbGV0aW9uKCk7XG4gIGNoYXRDb21wbGV0aW9uLnNldFRva2VuQnVkZ2V0KG9haV9zZXR0aW5ncy5vcGVuYWlfbWF4X2NvbnRleHQsIG9haV9zZXR0aW5ncy5vcGVuYWlfbWF4X3Rva2Vucyk7XG4gIGNoYXRDb21wbGV0aW9uLnJlc2VydmVCdWRnZXQoMyk7XG4gIGNvbnN0IG9yZGVyQXJyYXkgPSBjb25maWcub3JkZXIgfHwgZGVmYXVsdF9vcmRlcjtcbiAgY29uc3QgcG9zaXRpb25NYXA6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSBvcmRlckFycmF5LnJlZHVjZSgoYWNjOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+LCBpdGVtLCBpbmRleCkgPT4ge1xuICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGFjY1tpdGVtLnRvTG93ZXJDYXNlKCldID0gaW5kZXg7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGFjY1tgY3VzdG9tX3Byb21wdF8ke2luZGV4fWBdID0gaW5kZXg7XG4gICAgfVxuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcblxuICAvL+i9rOaNouS4uumbhuWQiFxuICBjb25zdCB7IHN5c3RlbVByb21wdHMsIGRpYWxvZ3VlX2V4YW1wbGVzIH0gPSBhd2FpdCBjb252ZXJ0U3lzdGVtUHJvbXB0c1RvQ29sbGVjdGlvbihiYXNlRGF0YSwgY29uZmlnKTtcbiAgY29uc3QgYWRkVG9DaGF0Q29tcGxldGlvbkluT3JkZXIgPSBhc3luYyAoc291cmNlOiBhbnksIGluZGV4OiBudW1iZXIpID0+IHtcbiAgICBpZiAodHlwZW9mIHNvdXJjZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIC8vIOWkhOeQhuiHquWumuS5ieazqOWFpVxuICAgICAgY29uc3QgY29sbGVjdGlvbiA9IG5ldyBNZXNzYWdlQ29sbGVjdGlvbihgY3VzdG9tX3Byb21wdF8ke2luZGV4fWApO1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGF3YWl0IE1lc3NhZ2UuY3JlYXRlQXN5bmMoc291cmNlLnJvbGUsIHNvdXJjZS5jb250ZW50LCBgY3VzdG9tX3Byb21wdF8ke2luZGV4fWApO1xuICAgICAgY29sbGVjdGlvbi5hZGQobWVzc2FnZSk7XG4gICAgICBjaGF0Q29tcGxldGlvbi5hZGQoY29sbGVjdGlvbiwgaW5kZXgpO1xuICAgIH0gZWxzZSBpZiAoc3lzdGVtUHJvbXB0cy5oYXMoc291cmNlKSkge1xuICAgICAgLy8g5aSE55CG5pmu6YCa5o+Q56S66K+NXG4gICAgICBjb25zdCBwcm9tcHQgPSBzeXN0ZW1Qcm9tcHRzLmdldChzb3VyY2UpO1xuICAgICAgY29uc3QgY29sbGVjdGlvbiA9IG5ldyBNZXNzYWdlQ29sbGVjdGlvbihzb3VyY2UpO1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGF3YWl0IE1lc3NhZ2UuZnJvbVByb21wdEFzeW5jKHByb21wdCk7XG4gICAgICBjb2xsZWN0aW9uLmFkZChtZXNzYWdlKTtcbiAgICAgIGNoYXRDb21wbGV0aW9uLmFkZChjb2xsZWN0aW9uLCBwb3NpdGlvbk1hcFtzb3VyY2VdKTtcbiAgICB9XG4gIH07XG5cbiAgLy8g5aSE55CG5omA5pyJ57G75Z6L55qE5o+Q56S66K+NXG4gIGZvciAoY29uc3QgW2luZGV4LCBpdGVtXSBvZiBvcmRlckFycmF5LmVudHJpZXMoKSkge1xuICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGlmICghaXNQcm9tcHRGaWx0ZXJlZChpdGVtLCBjb25maWcpKSB7XG4gICAgICAgIGF3YWl0IGFkZFRvQ2hhdENvbXBsZXRpb25Jbk9yZGVyKGl0ZW0sIGluZGV4KTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBpdGVtID09PSAnb2JqZWN0JyAmJiBpdGVtLnJvbGUgJiYgaXRlbS5jb250ZW50KSB7XG4gICAgICBhd2FpdCBhZGRUb0NoYXRDb21wbGV0aW9uSW5PcmRlcihpdGVtLCBpbmRleCk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgZGlhbG9ndWVfZXhhbXBsZXNJbmRleCA9IG9yZGVyQXJyYXkuZmluZEluZGV4KFxuICAgIGl0ZW0gPT4gdHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnICYmIGl0ZW0udG9Mb3dlckNhc2UoKSA9PT0gJ2RpYWxvZ3VlX2V4YW1wbGVzJyxcbiAgKTtcblxuICBpZiAoZGlhbG9ndWVfZXhhbXBsZXNJbmRleCAhPT0gLTEgJiYgIWlzUHJvbXB0RmlsdGVyZWQoJ2RpYWxvZ3VlX2V4YW1wbGVzJywgY29uZmlnKSkge1xuICAgIGNoYXRDb21wbGV0aW9uLmFkZChkaWFsb2d1ZV9leGFtcGxlcywgZGlhbG9ndWVfZXhhbXBsZXNJbmRleCk7XG4gIH1cbiAgLy/nu5l1c2Vy6L6T5YWl6aKE55WZdG9rZW5cbiAgY29uc3QgdXNlcklucHV0TWVzc2FnZSA9IGF3YWl0IE1lc3NhZ2UuY3JlYXRlQXN5bmMoJ3VzZXInLCBwcm9jZXNzZWRVc2VySW5wdXQsICd1c2VyX2lucHV0Jyk7XG4gIGNoYXRDb21wbGV0aW9uLnJlc2VydmVCdWRnZXQodXNlcklucHV0TWVzc2FnZSk7XG5cbiAgYXdhaXQgcHJvY2Vzc0NoYXRIaXN0b3J5QW5kSW5qZWN0KGJhc2VEYXRhLCBjb25maWcsIGNoYXRDb21wbGV0aW9uLCBwcm9jZXNzZWRVc2VySW5wdXQpO1xuICBjaGF0Q29tcGxldGlvbi5mcmVlQnVkZ2V0KHVzZXJJbnB1dE1lc3NhZ2UpO1xuXG4gIC8v5qC55o2u5b2T5YmN6aKE6K6+5Yaz5a6a5piv5ZCm5ZCI5bm26L+e57ut57O757ufcm9sZea2iOaBr1xuICBpZiAob2FpX3NldHRpbmdzLnNxdWFzaF9zeXN0ZW1fbWVzc2FnZXMpIHtcbiAgICBhd2FpdCBjaGF0Q29tcGxldGlvbi5zcXVhc2hTeXN0ZW1NZXNzYWdlcygpO1xuICB9XG4gIGNvbnN0IHByb21wdCA9IGNoYXRDb21wbGV0aW9uLmdldENoYXQoKTtcbiAgcmV0dXJuIHsgcHJvbXB0IH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NDaGF0SGlzdG9yeUFuZEluamVjdChcbiAgYmFzZURhdGE6IGFueSxcbiAgcHJvbXB0Q29uZmlnOiBPbWl0PGRldGFpbC5HZW5lcmF0ZVBhcmFtcywgJ3VzZXJfaW5wdXQnIHwgJ3VzZV9wcmVzZXQnPixcbiAgY2hhdENvbXBsZXRpb246IENoYXRDb21wbGV0aW9uLFxuICBwcm9jZXNzZWRVc2VySW5wdXQ6IHN0cmluZyxcbikge1xuICBjb25zdCBvcmRlckFycmF5ID0gcHJvbXB0Q29uZmlnLm9yZGVyIHx8IGRlZmF1bHRfb3JkZXI7XG4gIGNvbnN0IGNoYXRIaXN0b3J5SW5kZXggPSBvcmRlckFycmF5LmZpbmRJbmRleChcbiAgICBpdGVtID0+IHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJyAmJiBpdGVtLnRvTG93ZXJDYXNlKCkgPT09ICdjaGF0X2hpc3RvcnknLFxuICApO1xuICBjb25zdCB1c2VySW5wdXRJbmRleCA9IG9yZGVyQXJyYXkuZmluZEluZGV4KGl0ZW0gPT4gdHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnICYmIGl0ZW0udG9Mb3dlckNhc2UoKSA9PT0gJ3VzZXJfaW5wdXQnKTtcblxuICBjb25zdCBoYXNVc2VySW5wdXQgPSB1c2VySW5wdXRJbmRleCAhPT0gLTE7XG4gIGNvbnN0IGhhc0NoYXRIaXN0b3J5ID0gY2hhdEhpc3RvcnlJbmRleCAhPT0gLTE7XG4gIGNvbnN0IGlzQ2hhdEhpc3RvcnlGaWx0ZXJlZCA9IGlzUHJvbXB0RmlsdGVyZWQoJ2NoYXRfaGlzdG9yeScsIHByb21wdENvbmZpZyk7XG5cbiAgLy8g5Yib5bu655So5oi36L6T5YWl5raI5oGvXG4gIGNvbnN0IHVzZXJNZXNzYWdlID0gYXdhaXQgTWVzc2FnZS5jcmVhdGVBc3luYygndXNlcicsIHByb2Nlc3NlZFVzZXJJbnB1dCwgJ3VzZXJfaW5wdXQnKTtcblxuICAvLyDku4XlnKjpnIDopoHml7bmt7vliqDlm77lg49cbiAgaWYgKHByb21wdENvbmZpZy5pbWFnZSAmJiBoYXNVc2VySW5wdXQpIHtcbiAgICBhd2FpdCB1c2VyTWVzc2FnZS5hZGRJbWFnZShhd2FpdCBjb252ZXJ0RmlsZVRvQmFzZTY0KHByb21wdENvbmZpZy5pbWFnZSkpO1xuICB9XG5cbiAgLy8g5aaC5p6c6IGK5aSp6K6w5b2V6KKr6L+H5ruk5oiW5LiN5Zyob3JkZXLkuK3vvIzlj6rlpITnkIbnlKjmiLfovpPlhaVcbiAgaWYgKGlzQ2hhdEhpc3RvcnlGaWx0ZXJlZCB8fCAhaGFzQ2hhdEhpc3RvcnkpIHtcbiAgICBjb25zdCBpbnNlcnRJbmRleCA9IGhhc1VzZXJJbnB1dCA/IHVzZXJJbnB1dEluZGV4IDogb3JkZXJBcnJheS5sZW5ndGg7XG4gICAgY2hhdENvbXBsZXRpb24uYWRkKG5ldyBNZXNzYWdlQ29sbGVjdGlvbigndXNlcl9pbnB1dCcsIHVzZXJNZXNzYWdlKSwgaW5zZXJ0SW5kZXgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIOWkhOeQhuiBiuWkqeiusOW9lVxuICBjb25zdCBjaGF0Q29sbGVjdGlvbiA9IG5ldyBNZXNzYWdlQ29sbGVjdGlvbignY2hhdF9oaXN0b3J5Jyk7XG5cbiAgLy8g5Li65paw6IGK5aSp5oyH56S66aKE55WZdG9rZW5cbiAgY29uc3QgbmV3Q2hhdCA9IG9haV9zZXR0aW5ncy5uZXdfY2hhdF9wcm9tcHQ7XG4gIGNvbnN0IG5ld0NoYXRNZXNzYWdlID0gYXdhaXQgTWVzc2FnZS5jcmVhdGVBc3luYygnc3lzdGVtJywgc3Vic3RpdHV0ZVBhcmFtcyhuZXdDaGF0KSwgJ25ld01haW5DaGF0Jyk7XG4gIGNoYXRDb21wbGV0aW9uLnJlc2VydmVCdWRnZXQobmV3Q2hhdE1lc3NhZ2UpO1xuXG4gIC8vIOa3u+WKoOaWsOiBiuWkqeaPkOekuuivjeWIsOmbhuWQiOeahOacgOWJjemdolxuICBjaGF0Q29sbGVjdGlvbi5hZGQobmV3Q2hhdE1lc3NhZ2UpO1xuXG4gIC8vIOWkhOeQhuepuua2iOaBr+abv+aNolxuICBjb25zdCBsYXN0Q2hhdFByb21wdCA9IGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VzW2Jhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuICBjb25zdCBlbXB0eU1lc3NhZ2UgPSBhd2FpdCBNZXNzYWdlLmNyZWF0ZUFzeW5jKCd1c2VyJywgb2FpX3NldHRpbmdzLnNlbmRfaWZfZW1wdHksICdlbXB0eVVzZXJNZXNzYWdlUmVwbGFjZW1lbnQnKTtcblxuICBpZiAoXG4gICAgbGFzdENoYXRQcm9tcHQgJiZcbiAgICBsYXN0Q2hhdFByb21wdC5yb2xlID09PSAnYXNzaXN0YW50JyAmJlxuICAgIG9haV9zZXR0aW5ncy5zZW5kX2lmX2VtcHR5ICYmXG4gICAgY2hhdENvbXBsZXRpb24uY2FuQWZmb3JkKGVtcHR5TWVzc2FnZSlcbiAgKSB7XG4gICAgY2hhdENvbGxlY3Rpb24uYWRkKGVtcHR5TWVzc2FnZSk7XG4gIH1cblxuICAvLyDlsIbnlKjmiLfmtojmga/mt7vliqDliLDmtojmga/mlbDnu4TkuK3lh4blpIflpITnkIbms6jlhaVcbiAgaWYgKCFoYXNVc2VySW5wdXQpIHtcbiAgICBjb25zdCB1c2VyUHJvbXB0ID0ge1xuICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgY29udGVudDogcHJvY2Vzc2VkVXNlcklucHV0LFxuICAgICAgaWRlbnRpZmllcjogJ3VzZXJfaW5wdXQnLFxuICAgICAgaW1hZ2U6IHByb21wdENvbmZpZy5pbWFnZSA/IGF3YWl0IGNvbnZlcnRGaWxlVG9CYXNlNjQocHJvbXB0Q29uZmlnLmltYWdlKSA6IHVuZGVmaW5lZCxcbiAgICB9O1xuICAgIGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VzLnVuc2hpZnQodXNlclByb21wdCk7XG4gIH1cblxuICAvLyDlpITnkIbms6jlhaXlkozmt7vliqDmtojmga9cbiAgY29uc3QgbWVzc2FnZXMgPSAoXG4gICAgYXdhaXQgcG9wdWxhdGlvbkluamVjdGlvblByb21wdHMoYmFzZURhdGEsIGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VzLCBwcm9tcHRDb25maWcuaW5qZWN0LCBwcm9tcHRDb25maWcpXG4gICkucmV2ZXJzZSgpO1xuICBjb25zdCBpbWFnZUlubGluaW5nID0gaXNJbWFnZUlubGluaW5nU3VwcG9ydGVkKCk7XG4gIC8vIOa3u+WKoOiBiuWkqeiusOW9lVxuICBjb25zdCBjaGF0UG9vbCA9IFsuLi5tZXNzYWdlc107XG4gIGZvciAoY29uc3QgY2hhdFByb21wdCBvZiBjaGF0UG9vbCkge1xuICAgIGNvbnN0IHByb21wdCA9IG5ldyBQcm9tcHQoY2hhdFByb21wdCBhcyBhbnkpO1xuICAgIHByb21wdC5pZGVudGlmaWVyID0gYGNoYXRfaGlzdG9yeS0ke21lc3NhZ2VzLmxlbmd0aCAtIGNoYXRQb29sLmluZGV4T2YoY2hhdFByb21wdCl9YDtcbiAgICBwcm9tcHQuY29udGVudCA9IHN1YnN0aXR1dGVQYXJhbXMocHJvbXB0LmNvbnRlbnQpO1xuXG4gICAgY29uc3QgY2hhdE1lc3NhZ2UgPSBhd2FpdCBNZXNzYWdlLmZyb21Qcm9tcHRBc3luYyhwcm9tcHQpO1xuICAgIGNvbnN0IHByb21wdE1hbmFnZXIgPSBzZXR1cENoYXRDb21wbGV0aW9uUHJvbXB0TWFuYWdlcihvYWlfc2V0dGluZ3MpO1xuXG4gICAgaWYgKHByb21wdE1hbmFnZXIpIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGlmIChwcm9tcHRNYW5hZ2VyLnNlcnZpY2VTZXR0aW5ncy5uYW1lc19iZWhhdmlvciA9PT0gY2hhcmFjdGVyX25hbWVzX2JlaGF2aW9yLkNPTVBMRVRJT04gJiYgcHJvbXB0Lm5hbWUpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZU5hbWUgPSBwcm9tcHRNYW5hZ2VyLmlzVmFsaWROYW1lKHByb21wdC5uYW1lKVxuICAgICAgICAgID8gcHJvbXB0Lm5hbWVcbiAgICAgICAgICA6IHByb21wdE1hbmFnZXIuc2FuaXRpemVOYW1lKHByb21wdC5uYW1lKTtcbiAgICAgICAgYXdhaXQgY2hhdE1lc3NhZ2Uuc2V0TmFtZShtZXNzYWdlTmFtZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChpbWFnZUlubGluaW5nICYmIGNoYXRQcm9tcHQuaW1hZ2UpIHtcbiAgICAgIGF3YWl0IGNoYXRNZXNzYWdlLmFkZEltYWdlKGNoYXRQcm9tcHQuaW1hZ2UgYXMgc3RyaW5nKTtcbiAgICB9XG4gICAgaWYgKGNoYXRDb21wbGV0aW9uLmNhbkFmZm9yZChjaGF0TWVzc2FnZSkpIHtcbiAgICAgIGNoYXRDb2xsZWN0aW9uLmFkZChjaGF0TWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIC8vIOmHiuaUvuaWsOiBiuWkqeaPkOekuuivjeeahOmihOeVmXRva2VuXG4gIGNoYXRDb21wbGV0aW9uLmZyZWVCdWRnZXQobmV3Q2hhdE1lc3NhZ2UpO1xuXG4gIGlmIChoYXNVc2VySW5wdXQpIHtcbiAgICAvLyDmjInlkIToh6rlnKhvcmRlcuS4reeahOS9jee9rua3u+WKoOiBiuWkqeiusOW9leWSjOeUqOaIt+i+k+WFpVxuICAgIGNoYXRDb21wbGV0aW9uLmFkZChjaGF0Q29sbGVjdGlvbiwgY2hhdEhpc3RvcnlJbmRleCk7XG4gICAgY2hhdENvbXBsZXRpb24uYWRkKG5ldyBNZXNzYWdlQ29sbGVjdGlvbigndXNlcl9pbnB1dCcsIHVzZXJNZXNzYWdlKSwgdXNlcklucHV0SW5kZXgpO1xuICB9IGVsc2Uge1xuICAgIC8vIOiBiuWkqeiusOW9leS4reW3suWMheWQq+eUqOaIt+i+k+WFpe+8jOebtOaOpea3u+WKoOWIsGNoYXRfaGlzdG9yeeS9jee9rlxuICAgIGNoYXRDb21wbGV0aW9uLmFkZChjaGF0Q29sbGVjdGlvbiwgY2hhdEhpc3RvcnlJbmRleCk7XG4gIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIHBvcHVsYXRpb25JbmplY3Rpb25Qcm9tcHRzKFxuICBiYXNlRGF0YTogQmFzZURhdGEsXG4gIG1lc3NhZ2VzOiBSb2xlUHJvbXB0W10sXG4gIGN1c3RvbUluamVjdHM6IEluamVjdGlvblByb21wdFtdID0gW10sXG4gIGNvbmZpZzogT21pdDxkZXRhaWwuR2VuZXJhdGVQYXJhbXMsICd1c2VyX2lucHV0JyB8ICd1c2VfcHJlc2V0Jz4sXG4pIHtcbiAgY29uc3QgcHJvY2Vzc2VkTWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuICBsZXQgdG90YWxJbnNlcnRlZE1lc3NhZ2VzID0gMDtcbiAgY29uc3QgaW5qZWN0aW9uUHJvbXB0cyA9IFtdO1xuICAvLyBAdHMtaWdub3JlXG5cbiAgY29uc3QgYXV0aG9yc05vdGUgPSBnZXRDb250ZXh0KCkuZXh0ZW5zaW9uUHJvbXB0c1tOT1RFX01PRFVMRV9OQU1FXTtcbiAgaWYgKGF1dGhvcnNOb3RlICYmIGF1dGhvcnNOb3RlLnZhbHVlKSB7XG4gICAgaW5qZWN0aW9uUHJvbXB0cy5wdXNoKHtcbiAgICAgIHJvbGU6IGdldFByb21wdFJvbGUoYXV0aG9yc05vdGUucm9sZSksXG4gICAgICBjb250ZW50OiBhdXRob3JzTm90ZS52YWx1ZSxcbiAgICAgIGlkZW50aWZpZXI6ICdhdXRob3JzTm90ZScsXG4gICAgICBpbmplY3Rpb25fZGVwdGg6IGF1dGhvcnNOb3RlLmRlcHRoLFxuICAgICAgaW5qZWN0ZWQ6IHRydWUsXG4gICAgfSk7XG4gIH1cblxuICBpZiAoXG4gICAgcG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uICYmXG4gICAgcG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uX3Bvc2l0aW9uID09PSBwZXJzb25hX2Rlc2NyaXB0aW9uX3Bvc2l0aW9ucy5BVF9ERVBUSFxuICApIHtcbiAgICBpbmplY3Rpb25Qcm9tcHRzLnB1c2goe1xuICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICBjb250ZW50OiBwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb24sXG4gICAgICBpZGVudGlmaWVyOiAncGVyc29uYV9kZXNjcmlwdGlvbicsXG4gICAgICBpbmplY3Rpb25fZGVwdGg6IHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9kZXB0aCxcbiAgICAgIGluamVjdGVkOiB0cnVlLFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKCFpc1Byb21wdEZpbHRlcmVkKCdjaGFyX2RlcHRoX3Byb21wdCcsIGNvbmZpZykpIHtcbiAgICBjb25zdCB3aURlcHRoUHJvbXB0ID0gYmFzZURhdGEud29ybGRJbmZvLndvcmxkSW5mb0RlcHRoO1xuICAgIGlmICh3aURlcHRoUHJvbXB0KSB7XG4gICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIHdpRGVwdGhQcm9tcHQpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IGdldEV4dGVuc2lvblByb21wdEJ5TmFtZShgY3VzdG9tRGVwdGhXSS0ke2VudHJ5LmRlcHRofS0ke2VudHJ5LnJvbGV9YCk7XG4gICAgICAgIGluamVjdGlvblByb21wdHMucHVzaCh7XG4gICAgICAgICAgcm9sZTogZ2V0UHJvbXB0Um9sZShlbnRyeS5yb2xlKSxcbiAgICAgICAgICBjb250ZW50OiBjb250ZW50LFxuICAgICAgICAgIGluamVjdGlvbl9kZXB0aDogZW50cnkuZGVwdGgsXG4gICAgICAgICAgaW5qZWN0ZWQ6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZygnaW5qZWN0aW9uUHJvbXB0cycsIGluamVjdGlvblByb21wdHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIOWkhOeQhuiHquWumuS5ieazqOWFpVxuICBpZiAoQXJyYXkuaXNBcnJheShjdXN0b21JbmplY3RzKSkge1xuICAgIGZvciAoY29uc3QgaW5qZWN0IG9mIGN1c3RvbUluamVjdHMpIHtcbiAgICAgIGluamVjdGlvblByb21wdHMucHVzaCh7XG4gICAgICAgIGlkZW50aWZpZXI6IGBJTkpFQ1RJT04tJHtpbmplY3Qucm9sZX0tJHtpbmplY3QuZGVwdGh9YCxcbiAgICAgICAgcm9sZTogaW5qZWN0LnJvbGUsXG4gICAgICAgIGNvbnRlbnQ6IGluamVjdC5jb250ZW50LFxuICAgICAgICBpbmplY3Rpb25fZGVwdGg6IGluamVjdC5kZXB0aCB8fCAwLFxuICAgICAgICBpbmplY3RlZDogdHJ1ZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDw9IE1BWF9JTkpFQ1RJT05fREVQVEg7IGkrKykge1xuICAgIGNvbnN0IGRlcHRoUHJvbXB0cyA9IGluamVjdGlvblByb21wdHMuZmlsdGVyKHByb21wdCA9PiBwcm9tcHQuaW5qZWN0aW9uX2RlcHRoID09PSBpICYmIHByb21wdC5jb250ZW50KTtcblxuICAgIGNvbnN0IHJvbGVzID0gWydzeXN0ZW0nLCAndXNlcicsICdhc3Npc3RhbnQnXTtcbiAgICBjb25zdCByb2xlTWVzc2FnZXMgPSBbXTtcbiAgICBjb25zdCBzZXBhcmF0b3IgPSAnXFxuJztcblxuICAgIGZvciAoY29uc3Qgcm9sZSBvZiByb2xlcykge1xuICAgICAgLy8g55u05o6l5aSE55CG5b2T5YmN5rex5bqm5ZKM6KeS6Imy55qE5omA5pyJ5o+Q56S66K+NXG4gICAgICBjb25zdCByb2xlUHJvbXB0cyA9IGRlcHRoUHJvbXB0c1xuICAgICAgICAuZmlsdGVyKHByb21wdCA9PiBwcm9tcHQucm9sZSA9PT0gcm9sZSlcbiAgICAgICAgLm1hcCh4ID0+IHguY29udGVudC50cmltKCkpXG4gICAgICAgIC5qb2luKHNlcGFyYXRvcik7XG5cbiAgICAgIGlmIChyb2xlUHJvbXB0cykge1xuICAgICAgICByb2xlTWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgcm9sZTogcm9sZSBhcyAndXNlcicgfCAnc3lzdGVtJyB8ICdhc3Npc3RhbnQnLFxuICAgICAgICAgIGNvbnRlbnQ6IHJvbGVQcm9tcHRzLFxuICAgICAgICAgIGluamVjdGVkOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocm9sZU1lc3NhZ2VzLmxlbmd0aCkge1xuICAgICAgY29uc3QgaW5qZWN0SWR4ID0gaSArIHRvdGFsSW5zZXJ0ZWRNZXNzYWdlcztcbiAgICAgIHByb2Nlc3NlZE1lc3NhZ2VzLnNwbGljZShpbmplY3RJZHgsIDAsIC4uLnJvbGVNZXNzYWdlcyk7XG4gICAgICB0b3RhbEluc2VydGVkTWVzc2FnZXMgKz0gcm9sZU1lc3NhZ2VzLmxlbmd0aDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcHJvY2Vzc2VkTWVzc2FnZXM7XG59XG5cbmZ1bmN0aW9uIGdldFByb21wdFJvbGUocm9sZTogbnVtYmVyKSB7XG4gIHN3aXRjaCAocm9sZSkge1xuICAgIGNhc2UgZXh0ZW5zaW9uX3Byb21wdF9yb2xlcy5TWVNURU06XG4gICAgICByZXR1cm4gJ3N5c3RlbSc7XG4gICAgY2FzZSBleHRlbnNpb25fcHJvbXB0X3JvbGVzLlVTRVI6XG4gICAgICByZXR1cm4gJ3VzZXInO1xuICAgIGNhc2UgZXh0ZW5zaW9uX3Byb21wdF9yb2xlcy5BU1NJU1RBTlQ6XG4gICAgICByZXR1cm4gJ2Fzc2lzdGFudCc7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiAnc3lzdGVtJztcbiAgfVxufVxuXG4vL+eUn+aIkOWTjeW6lFxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVSZXNwb25zZShnZW5lcmF0ZV9kYXRhOiBhbnksIHVzZVN0cmVhbSA9IGZhbHNlKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgbGV0IHJlc3VsdCA9ICcnO1xuICB0cnkge1xuICAgIGRlYWN0aXZhdGVTZW5kQnV0dG9ucygpO1xuXG4gICAgaWYgKHVzZVN0cmVhbSkge1xuICAgICAgY29uc3Qgb3JpZ2luYWxTdHJlYW1TZXR0aW5nID0gb2FpX3NldHRpbmdzLnN0cmVhbV9vcGVuYWk7XG4gICAgICBpZiAoIW9yaWdpbmFsU3RyZWFtU2V0dGluZykge1xuICAgICAgICBvYWlfc2V0dGluZ3Muc3RyZWFtX29wZW5haSA9IHRydWU7XG4gICAgICAgIHNhdmVTZXR0aW5nc0RlYm91bmNlZCgpO1xuICAgICAgfVxuICAgICAgY29uc3Qgc3RyZWFtaW5nUHJvY2Vzc29yID0gbmV3IFN0cmVhbWluZ1Byb2Nlc3NvcigpO1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgc3RyZWFtaW5nUHJvY2Vzc29yLmdlbmVyYXRvciA9IGF3YWl0IHNlbmRPcGVuQUlSZXF1ZXN0KCdub3JtYWwnLCBnZW5lcmF0ZV9kYXRhLnByb21wdCwgYWJvcnRDb250cm9sbGVyLnNpZ25hbCk7XG4gICAgICByZXN1bHQgPSAoYXdhaXQgc3RyZWFtaW5nUHJvY2Vzc29yLmdlbmVyYXRlKCkpIGFzIHN0cmluZztcbiAgICAgIC8vIGNvbnNvbGUubG9nKFwiZ2V0TWVzc2FnZVwiLCBnZXRNZXNzYWdlKTtcbiAgICAgIGlmIChvcmlnaW5hbFN0cmVhbVNldHRpbmcgIT09IG9haV9zZXR0aW5ncy5zdHJlYW1fb3BlbmFpKSB7XG4gICAgICAgIG9haV9zZXR0aW5ncy5zdHJlYW1fb3BlbmFpID0gb3JpZ2luYWxTdHJlYW1TZXR0aW5nO1xuICAgICAgICBzYXZlU2V0dGluZ3NEZWJvdW5jZWQoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZXZlbnRTb3VyY2UuZW1pdCgnanNfZ2VuZXJhdGlvbl9zdGFydGVkJyk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHNlbmRPcGVuQUlSZXF1ZXN0KHR5cGUsIGdlbmVyYXRlX2RhdGEucHJvbXB0LCBhYm9ydENvbnRyb2xsZXIuc2lnbmFsKTtcbiAgICAgIHJlc3VsdCA9IGF3YWl0IGhhbmRsZVJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gIH0gZmluYWxseSB7XG4gICAgdW5ibG9ja0dlbmVyYXRpb24oKTtcbiAgICBhd2FpdCBjbGVhckluamVjdGlvblByb21wdHMoWydJTkpFQ1RJT04nXSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8g5aSE55CG5ZON5bqUXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVSZXNwb25zZShyZXNwb25zZTogYW55KSB7XG4gIGlmICghcmVzcG9uc2UpIHtcbiAgICB0aHJvdyBFcnJvcihg5pyq5b6X5Yiw5ZON5bqUYCk7XG4gIH1cbiAgaWYgKHJlc3BvbnNlLmVycm9yKSB7XG4gICAgaWYgKHJlc3BvbnNlPy5yZXNwb25zZSkge1xuICAgICAgdG9hc3RyLmVycm9yKHJlc3BvbnNlLnJlc3BvbnNlLCB0YEFQSSBFcnJvcmAsIHtcbiAgICAgICAgcHJldmVudER1cGxpY2F0ZXM6IHRydWUsXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhyb3cgRXJyb3IocmVzcG9uc2U/LnJlc3BvbnNlKTtcbiAgfVxuICBjb25zdCBtZXNzYWdlOiBzdHJpbmcgPSBleHRyYWN0TWVzc2FnZUZyb21EYXRhKHJlc3BvbnNlKTtcbiAgZXZlbnRTb3VyY2UuZW1pdCgnanNfZ2VuZXJhdGlvbl9lbmRlZCcsIG1lc3NhZ2UpO1xuICByZXR1cm4gbWVzc2FnZTtcbn1cblxuZnVuY3Rpb24gdW5ibG9ja0dlbmVyYXRpb24oKSB7XG4gIGFjdGl2YXRlU2VuZEJ1dHRvbnMoKTtcbiAgc2hvd1N3aXBlQnV0dG9ucygpO1xuICBzZXRHZW5lcmF0aW9uUHJvZ3Jlc3MoMCk7XG4gIGZsdXNoRXBoZW1lcmFsU3RvcHBpbmdTdHJpbmdzKCk7XG59XG5cbi8vIOa4heeQhuazqOWFpVxuYXN5bmMgZnVuY3Rpb24gY2xlYXJJbmplY3Rpb25Qcm9tcHRzKHByZWZpeGVzOiBzdHJpbmdbXSkge1xuICBjb25zdCBwcm9tcHRzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0gZ2V0Q29udGV4dCgpLmV4dGVuc2lvblByb21wdHM7XG4gIE9iamVjdC5rZXlzKHByb21wdHMpXG4gICAgLmZpbHRlcihrZXkgPT4gcHJlZml4ZXMuc29tZShwcmVmaXggPT4ga2V5LnN0YXJ0c1dpdGgocHJlZml4KSkpXG4gICAgLmZvckVhY2goa2V5ID0+IGRlbGV0ZSBwcm9tcHRzW2tleV0pO1xuXG4gIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbn1cbmZ1bmN0aW9uIGV4dHJhY3RNZXNzYWdlRnJvbURhdGEoZGF0YTogYW55KSB7XG4gIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgZGF0YT8uY2hvaWNlcz8uWzBdPy5tZXNzYWdlPy5jb250ZW50ID8/XG4gICAgZGF0YT8uY2hvaWNlcz8uWzBdPy50ZXh0ID8/XG4gICAgZGF0YT8udGV4dCA/P1xuICAgIGRhdGE/Lm1lc3NhZ2U/LmNvbnRlbnQ/LlswXT8udGV4dCA/P1xuICAgIGRhdGE/Lm1lc3NhZ2U/LnRvb2xfcGxhbiA/P1xuICAgICcnXG4gICk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNvbnZlcnRGaWxlVG9CYXNlNjQoaW1hZ2U6IEZpbGUgfCBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICBpZiAoaW1hZ2UgaW5zdGFuY2VvZiBGaWxlKSB7XG4gICAgcmV0dXJuIGF3YWl0IGdldEJhc2U2NEFzeW5jKGltYWdlKTtcbiAgfVxuICByZXR1cm4gaW1hZ2U7XG59XG5cbmZ1bmN0aW9uIGFkZFRlbXBvcmFyeVVzZXJNZXNzYWdlKHVzZXJDb250ZW50OiBzdHJpbmcpIHtcbiAgc2V0RXh0ZW5zaW9uUHJvbXB0KCdURU1QX1VTRVJfTUVTU0FHRScsIHVzZXJDb250ZW50LCBleHRlbnNpb25fcHJvbXB0X3R5cGVzLklOX1BST01QVCwgMCwgdHJ1ZSwgMSk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVRlbXBvcmFyeVVzZXJNZXNzYWdlKCkge1xuICBzZXRFeHRlbnNpb25Qcm9tcHQoJ1RFTVBfVVNFUl9NRVNTQUdFJywgJycsIGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuSU5fUFJPTVBULCAwLCB0cnVlLCAxKTtcbn1cblxuZnVuY3Rpb24gaXNQcm9tcHRGaWx0ZXJlZChwcm9tcHRJZDogc3RyaW5nLCBjb25maWc6IHsgb3ZlcnJpZGVzPzogZGV0YWlsLk92ZXJyaWRlQ29uZmlnIH0pOiBib29sZWFuIHtcbiAgaWYgKCFjb25maWcub3ZlcnJpZGVzKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKHByb21wdElkID09PSAnd2l0aF9kZXB0aF9lbnRyaWVzJykge1xuICAgIHJldHVybiBjb25maWcub3ZlcnJpZGVzLndpdGhfZGVwdGhfZW50cmllcyA9PT0gZmFsc2U7XG4gIH1cblxuICAvLyDnibnmrorlpITnkIYgY2hhdF9oaXN0b3J5XG4gIGlmIChwcm9tcHRJZCA9PT0gJ2NoYXRfaGlzdG9yeScpIHtcbiAgICBjb25zdCBwcm9tcHRzID0gY29uZmlnLm92ZXJyaWRlcy5jaGF0X2hpc3Rvcnk7XG4gICAgcmV0dXJuIHByb21wdHMgIT09IHVuZGVmaW5lZCAmJiBwcm9tcHRzLmxlbmd0aCA9PT0gMDtcbiAgfVxuXG4gIC8vIOWvueS6juaZrumAmuaPkOekuuivje+8jOWPquacieW9k+Wug+WcqCBvdmVycmlkZXMg5Lit5a2Y5Zyo5LiU5Li656m65a2X56ym5Liy5pe25omN6KKr6L+H5rukXG4gIGNvbnN0IG92ZXJyaWRlID0gY29uZmlnLm92ZXJyaWRlc1twcm9tcHRJZCBhcyBrZXlvZiBPbWl0PGRldGFpbC5PdmVycmlkZUNvbmZpZywgJ2NoYXRfaGlzdG9yeSc+XTtcbiAgcmV0dXJuIG92ZXJyaWRlICE9PSB1bmRlZmluZWQgJiYgb3ZlcnJpZGUgPT09ICcnO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGUoY29uZmlnOiBHZW5lcmF0ZUNvbmZpZykge1xuICBjb25zdCBjb252ZXJ0ZWRfY29uZmlnID0gZnJvbUdlbmVyYXRlQ29uZmlnKGNvbmZpZyk7XG4gIHJldHVybiBhd2FpdCBpZnJhbWVHZW5lcmF0ZShjb252ZXJ0ZWRfY29uZmlnKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlUmF3KGNvbmZpZzogR2VuZXJhdGVSYXdDb25maWcpIHtcbiAgY29uc3QgY29udmVydGVkX2NvbmZpZyA9IGZyb21HZW5lcmF0ZVJhd0NvbmZpZyhjb25maWcpO1xuICByZXR1cm4gYXdhaXQgaWZyYW1lR2VuZXJhdGUoY29udmVydGVkX2NvbmZpZyk7XG59XG5cbi8vIEB0cy1pZ25vcmVcbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjbWVzX3N0b3AnLCBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHdhc1N0b3BwZWQgPSBzdG9wR2VuZXJhdGlvbigpO1xuICBpZiAod2FzU3RvcHBlZCkge1xuICAgIGlmIChhYm9ydENvbnRyb2xsZXIpIHtcbiAgICAgIGFib3J0Q29udHJvbGxlci5hYm9ydCgnQ2xpY2tlZCBzdG9wIGJ1dHRvbicpO1xuICAgIH1cbiAgICB1bmJsb2NrR2VuZXJhdGlvbigpO1xuICB9XG59KTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/generate.ts\n")},"./src/function/index.ts":
/*!*******************************!*\
  !*** ./src/function/index.ts ***!
  \*******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initTavernHelperObject: () => (/* binding */ initTavernHelperObject)\n/* harmony export */ });\n/* harmony import */ var _component_macrolike__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/macrolike */ "./src/component/macrolike.ts");\n/* harmony import */ var _function_character__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/character */ "./src/function/character.ts");\n/* harmony import */ var _function_chat_message__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/function/chat_message */ "./src/function/chat_message.ts");\n/* harmony import */ var _function_displayed_message__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/function/displayed_message */ "./src/function/displayed_message.ts");\n/* harmony import */ var _function_generate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/function/generate */ "./src/function/generate.ts");\n/* harmony import */ var _function_lorebook__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/function/lorebook */ "./src/function/lorebook.ts");\n/* harmony import */ var _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/function/lorebook_entry */ "./src/function/lorebook_entry.ts");\n/* harmony import */ var _function_slash__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/function/slash */ "./src/function/slash.ts");\n/* harmony import */ var _function_tavern_regex__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/function/tavern_regex */ "./src/function/tavern_regex.ts");\n/* harmony import */ var _function_util__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/function/util */ "./src/function/util.ts");\n/* harmony import */ var _function_variables__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/function/variables */ "./src/function/variables.ts");\n/* harmony import */ var _function_version__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/function/version */ "./src/function/version.ts");\n/* harmony import */ var _slash_command_audio__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/slash_command/audio */ "./src/slash_command/audio.ts");\n/* harmony import */ var _builtin__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./builtin */ "./src/function/builtin.ts");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction getTavernHelper() {\n    return {\n        // audio\n        audioEnable: _slash_command_audio__WEBPACK_IMPORTED_MODULE_12__.audioEnable,\n        audioImport: _slash_command_audio__WEBPACK_IMPORTED_MODULE_12__.audioImport,\n        audioMode: _slash_command_audio__WEBPACK_IMPORTED_MODULE_12__.audioMode,\n        audioPlay: _slash_command_audio__WEBPACK_IMPORTED_MODULE_12__.audioPlay,\n        audioSelect: _slash_command_audio__WEBPACK_IMPORTED_MODULE_12__.audioSelect,\n        // builtin\n        builtin: _builtin__WEBPACK_IMPORTED_MODULE_13__.builtin,\n        // character\n        Character: _function_character__WEBPACK_IMPORTED_MODULE_1__.Character,\n        getCharData: _function_character__WEBPACK_IMPORTED_MODULE_1__.getCharData,\n        getCharAvatarPath: _function_character__WEBPACK_IMPORTED_MODULE_1__.getCharAvatarPath,\n        getChatHistoryBrief: _function_character__WEBPACK_IMPORTED_MODULE_1__.getChatHistoryBrief,\n        getChatHistoryDetail: _function_character__WEBPACK_IMPORTED_MODULE_1__.getChatHistoryDetail,\n        // chat_message\n        getChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.getChatMessages,\n        setChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.setChatMessages,\n        setChatMessage: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.setChatMessage,\n        createChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.createChatMessages,\n        deleteChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.deleteChatMessages,\n        rotateChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.rotateChatMessages,\n        // displayed_message\n        formatAsDisplayedMessage: _function_displayed_message__WEBPACK_IMPORTED_MODULE_3__.formatAsDisplayedMessage,\n        retrieveDisplayedMessage: _function_displayed_message__WEBPACK_IMPORTED_MODULE_3__.retrieveDisplayedMessage,\n        // generate\n        builtin_prompt_default_order: _function_generate__WEBPACK_IMPORTED_MODULE_4__.builtin_prompt_default_order,\n        generate: _function_generate__WEBPACK_IMPORTED_MODULE_4__.generate,\n        generateRaw: _function_generate__WEBPACK_IMPORTED_MODULE_4__.generateRaw,\n        // lorebook_entry\n        getLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.getLorebookEntries,\n        replaceLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.replaceLorebookEntries,\n        updateLorebookEntriesWith: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.updateLorebookEntriesWith,\n        setLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.setLorebookEntries,\n        createLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.createLorebookEntries,\n        createLorebookEntry: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.createLorebookEntry,\n        deleteLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.deleteLorebookEntries,\n        deleteLorebookEntry: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.deleteLorebookEntry,\n        // lorebook\n        getLorebookSettings: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getLorebookSettings,\n        setLorebookSettings: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.setLorebookSettings,\n        getCharLorebooks: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getCharLorebooks,\n        setCurrentCharLorebooks: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.setCurrentCharLorebooks,\n        getLorebooks: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getLorebooks,\n        deleteLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.deleteLorebook,\n        createLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.createLorebook,\n        getCurrentCharPrimaryLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getCurrentCharPrimaryLorebook,\n        getChatLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getChatLorebook,\n        setChatLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.setChatLorebook,\n        getOrCreateChatLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getOrCreateChatLorebook,\n        // macrolike\n        registerMacroLike: _component_macrolike__WEBPACK_IMPORTED_MODULE_0__.registerMacroLike,\n        // slash\n        triggerSlash: _function_slash__WEBPACK_IMPORTED_MODULE_7__.triggerSlash,\n        triggerSlashWithResult: _function_slash__WEBPACK_IMPORTED_MODULE_7__.triggerSlash,\n        // tavern_regex\n        isCharacterTavernRegexesEnabled: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_8__.isCharacterTavernRegexesEnabled,\n        getTavernRegexes: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_8__.getTavernRegexes,\n        replaceTavernRegexes: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_8__.replaceTavernRegexes,\n        updateTavernRegexesWith: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_8__.updateTavernRegexesWith,\n        // util\n        substitudeMacros: _function_util__WEBPACK_IMPORTED_MODULE_9__.substitudeMacros,\n        getLastMessageId: _function_util__WEBPACK_IMPORTED_MODULE_9__.getLastMessageId,\n        errorCatched: _function_util__WEBPACK_IMPORTED_MODULE_9__.errorCatched,\n        // variables\n        getVariables: _function_variables__WEBPACK_IMPORTED_MODULE_10__.getVariables,\n        replaceVariables: _function_variables__WEBPACK_IMPORTED_MODULE_10__.replaceVariables,\n        updateVariablesWith: _function_variables__WEBPACK_IMPORTED_MODULE_10__.updateVariablesWith,\n        insertOrAssignVariables: _function_variables__WEBPACK_IMPORTED_MODULE_10__.insertOrAssignVariables,\n        deleteVariable: _function_variables__WEBPACK_IMPORTED_MODULE_10__.deleteVariable,\n        insertVariables: _function_variables__WEBPACK_IMPORTED_MODULE_10__.insertVariables,\n        // version\n        getTavernHelperVersion: _function_version__WEBPACK_IMPORTED_MODULE_11__.getTavernHelperVersion,\n        updateTavernHelper: _function_version__WEBPACK_IMPORTED_MODULE_11__.updateTavernHelper,\n        getFrontendVersion: _function_version__WEBPACK_IMPORTED_MODULE_11__.getTavernHelperVersion,\n        updateFrontendVersion: _function_version__WEBPACK_IMPORTED_MODULE_11__.updateTavernHelper,\n    };\n}\n/**\n * TavernHelper\n * \n */\nfunction initTavernHelperObject() {\n    globalThis.TavernHelper = getTavernHelper();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTBEO0FBTzVCO0FBUUc7QUFDaUU7QUFDUjtBQWE3RDtBQVVNO0FBQ2E7QUFNZjtBQUNrRDtBQVFyRDtBQUNrRDtBQUNvQjtBQUNoRTtBQUVwQyxTQUFTLGVBQWU7SUFDdEIsT0FBTztRQUNMLFFBQVE7UUFDUixXQUFXO1FBQ1gsV0FBVztRQUNYLFNBQVM7UUFDVCxTQUFTO1FBQ1QsV0FBVztRQUVYLFVBQVU7UUFDVixPQUFPO1FBRVAsWUFBWTtRQUNaLFNBQVM7UUFDVCxXQUFXO1FBQ1gsaUJBQWlCO1FBQ2pCLG1CQUFtQjtRQUNuQixvQkFBb0I7UUFFcEIsZUFBZTtRQUNmLGVBQWU7UUFDZixlQUFlO1FBQ2YsY0FBYztRQUNkLGtCQUFrQjtRQUNsQixrQkFBa0I7UUFDbEIsa0JBQWtCO1FBRWxCLG9CQUFvQjtRQUNwQix3QkFBd0I7UUFDeEIsd0JBQXdCO1FBRXhCLFdBQVc7UUFDWCw0QkFBNEI7UUFDNUIsUUFBUTtRQUNSLFdBQVc7UUFFWCxpQkFBaUI7UUFDakIsa0JBQWtCO1FBQ2xCLHNCQUFzQjtRQUN0Qix5QkFBeUI7UUFDekIsa0JBQWtCO1FBQ2xCLHFCQUFxQjtRQUNyQixtQkFBbUI7UUFDbkIscUJBQXFCO1FBQ3JCLG1CQUFtQjtRQUVuQixXQUFXO1FBQ1gsbUJBQW1CO1FBQ25CLG1CQUFtQjtRQUNuQixnQkFBZ0I7UUFDaEIsdUJBQXVCO1FBQ3ZCLFlBQVk7UUFDWixjQUFjO1FBQ2QsY0FBYztRQUNkLDZCQUE2QjtRQUM3QixlQUFlO1FBQ2YsZUFBZTtRQUNmLHVCQUF1QjtRQUV2QixZQUFZO1FBQ1osaUJBQWlCO1FBRWpCLFFBQVE7UUFDUixZQUFZO1FBQ1osc0JBQXNCLEVBQUUseURBQVk7UUFFcEMsZUFBZTtRQUNmLCtCQUErQjtRQUMvQixnQkFBZ0I7UUFDaEIsb0JBQW9CO1FBQ3BCLHVCQUF1QjtRQUV2QixPQUFPO1FBQ1AsZ0JBQWdCO1FBQ2hCLGdCQUFnQjtRQUNoQixZQUFZO1FBRVosWUFBWTtRQUNaLFlBQVk7UUFDWixnQkFBZ0I7UUFDaEIsbUJBQW1CO1FBQ25CLHVCQUF1QjtRQUN2QixjQUFjO1FBQ2QsZUFBZTtRQUVmLFVBQVU7UUFDVixzQkFBc0I7UUFDdEIsa0JBQWtCO1FBQ2xCLGtCQUFrQixFQUFFLHNFQUFzQjtRQUMxQyxxQkFBcUIsRUFBRSxrRUFBa0I7S0FDMUMsQ0FBQztBQUNKLENBQUM7QUFNRDs7O0dBR0c7QUFDSSxTQUFTLHNCQUFzQjtJQUNwQyxVQUFVLENBQUMsWUFBWSxHQUFHLGVBQWUsRUFBRSxDQUFDO0FBQzlDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vaW5kZXgudHM/N2ViZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZWdpc3Rlck1hY3JvTGlrZSB9IGZyb20gJ0AvY29tcG9uZW50L21hY3JvbGlrZSc7XG5pbXBvcnQge1xuICBDaGFyYWN0ZXIsXG4gIGdldENoYXJBdmF0YXJQYXRoLFxuICBnZXRDaGFyRGF0YSxcbiAgZ2V0Q2hhdEhpc3RvcnlCcmllZixcbiAgZ2V0Q2hhdEhpc3RvcnlEZXRhaWwsXG59IGZyb20gJ0AvZnVuY3Rpb24vY2hhcmFjdGVyJztcbmltcG9ydCB7XG4gIGNyZWF0ZUNoYXRNZXNzYWdlcyxcbiAgZGVsZXRlQ2hhdE1lc3NhZ2VzLFxuICBnZXRDaGF0TWVzc2FnZXMsXG4gIHJvdGF0ZUNoYXRNZXNzYWdlcyxcbiAgc2V0Q2hhdE1lc3NhZ2UsXG4gIHNldENoYXRNZXNzYWdlcyxcbn0gZnJvbSAnQC9mdW5jdGlvbi9jaGF0X21lc3NhZ2UnO1xuaW1wb3J0IHsgZm9ybWF0QXNEaXNwbGF5ZWRNZXNzYWdlLCByZXRyaWV2ZURpc3BsYXllZE1lc3NhZ2UgfSBmcm9tICdAL2Z1bmN0aW9uL2Rpc3BsYXllZF9tZXNzYWdlJztcbmltcG9ydCB7IGJ1aWx0aW5fcHJvbXB0X2RlZmF1bHRfb3JkZXIsIGdlbmVyYXRlLCBnZW5lcmF0ZVJhdyB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUnO1xuaW1wb3J0IHtcbiAgY3JlYXRlTG9yZWJvb2ssXG4gIGRlbGV0ZUxvcmVib29rLFxuICBnZXRDaGFyTG9yZWJvb2tzLFxuICBnZXRDaGF0TG9yZWJvb2ssXG4gIGdldEN1cnJlbnRDaGFyUHJpbWFyeUxvcmVib29rLFxuICBnZXRMb3JlYm9va3MsXG4gIGdldExvcmVib29rU2V0dGluZ3MsXG4gIGdldE9yQ3JlYXRlQ2hhdExvcmVib29rLFxuICBzZXRDaGF0TG9yZWJvb2ssXG4gIHNldEN1cnJlbnRDaGFyTG9yZWJvb2tzLFxuICBzZXRMb3JlYm9va1NldHRpbmdzLFxufSBmcm9tICdAL2Z1bmN0aW9uL2xvcmVib29rJztcbmltcG9ydCB7XG4gIGNyZWF0ZUxvcmVib29rRW50cmllcyxcbiAgY3JlYXRlTG9yZWJvb2tFbnRyeSxcbiAgZGVsZXRlTG9yZWJvb2tFbnRyaWVzLFxuICBkZWxldGVMb3JlYm9va0VudHJ5LFxuICBnZXRMb3JlYm9va0VudHJpZXMsXG4gIHJlcGxhY2VMb3JlYm9va0VudHJpZXMsXG4gIHNldExvcmVib29rRW50cmllcyxcbiAgdXBkYXRlTG9yZWJvb2tFbnRyaWVzV2l0aCxcbn0gZnJvbSAnQC9mdW5jdGlvbi9sb3JlYm9va19lbnRyeSc7XG5pbXBvcnQgeyB0cmlnZ2VyU2xhc2ggfSBmcm9tICdAL2Z1bmN0aW9uL3NsYXNoJztcbmltcG9ydCB7XG4gIGdldFRhdmVyblJlZ2V4ZXMsXG4gIGlzQ2hhcmFjdGVyVGF2ZXJuUmVnZXhlc0VuYWJsZWQsXG4gIHJlcGxhY2VUYXZlcm5SZWdleGVzLFxuICB1cGRhdGVUYXZlcm5SZWdleGVzV2l0aCxcbn0gZnJvbSAnQC9mdW5jdGlvbi90YXZlcm5fcmVnZXgnO1xuaW1wb3J0IHsgZXJyb3JDYXRjaGVkLCBnZXRMYXN0TWVzc2FnZUlkLCBzdWJzdGl0dWRlTWFjcm9zIH0gZnJvbSAnQC9mdW5jdGlvbi91dGlsJztcbmltcG9ydCB7XG4gIGRlbGV0ZVZhcmlhYmxlLFxuICBnZXRWYXJpYWJsZXMsXG4gIGluc2VydE9yQXNzaWduVmFyaWFibGVzLFxuICBpbnNlcnRWYXJpYWJsZXMsXG4gIHJlcGxhY2VWYXJpYWJsZXMsXG4gIHVwZGF0ZVZhcmlhYmxlc1dpdGgsXG59IGZyb20gJ0AvZnVuY3Rpb24vdmFyaWFibGVzJztcbmltcG9ydCB7IGdldFRhdmVybkhlbHBlclZlcnNpb24sIHVwZGF0ZVRhdmVybkhlbHBlciB9IGZyb20gJ0AvZnVuY3Rpb24vdmVyc2lvbic7XG5pbXBvcnQgeyBhdWRpb0VuYWJsZSwgYXVkaW9JbXBvcnQsIGF1ZGlvTW9kZSwgYXVkaW9QbGF5LCBhdWRpb1NlbGVjdCB9IGZyb20gJ0Avc2xhc2hfY29tbWFuZC9hdWRpbyc7XG5pbXBvcnQgeyBidWlsdGluIH0gZnJvbSAnLi9idWlsdGluJztcblxuZnVuY3Rpb24gZ2V0VGF2ZXJuSGVscGVyKCkge1xuICByZXR1cm4ge1xuICAgIC8vIGF1ZGlvXG4gICAgYXVkaW9FbmFibGUsXG4gICAgYXVkaW9JbXBvcnQsXG4gICAgYXVkaW9Nb2RlLFxuICAgIGF1ZGlvUGxheSxcbiAgICBhdWRpb1NlbGVjdCxcblxuICAgIC8vIGJ1aWx0aW5cbiAgICBidWlsdGluLFxuXG4gICAgLy8gY2hhcmFjdGVyXG4gICAgQ2hhcmFjdGVyLFxuICAgIGdldENoYXJEYXRhLFxuICAgIGdldENoYXJBdmF0YXJQYXRoLFxuICAgIGdldENoYXRIaXN0b3J5QnJpZWYsXG4gICAgZ2V0Q2hhdEhpc3RvcnlEZXRhaWwsXG5cbiAgICAvLyBjaGF0X21lc3NhZ2VcbiAgICBnZXRDaGF0TWVzc2FnZXMsXG4gICAgc2V0Q2hhdE1lc3NhZ2VzLFxuICAgIHNldENoYXRNZXNzYWdlLFxuICAgIGNyZWF0ZUNoYXRNZXNzYWdlcyxcbiAgICBkZWxldGVDaGF0TWVzc2FnZXMsXG4gICAgcm90YXRlQ2hhdE1lc3NhZ2VzLFxuXG4gICAgLy8gZGlzcGxheWVkX21lc3NhZ2VcbiAgICBmb3JtYXRBc0Rpc3BsYXllZE1lc3NhZ2UsXG4gICAgcmV0cmlldmVEaXNwbGF5ZWRNZXNzYWdlLFxuXG4gICAgLy8gZ2VuZXJhdGVcbiAgICBidWlsdGluX3Byb21wdF9kZWZhdWx0X29yZGVyLFxuICAgIGdlbmVyYXRlLFxuICAgIGdlbmVyYXRlUmF3LFxuXG4gICAgLy8gbG9yZWJvb2tfZW50cnlcbiAgICBnZXRMb3JlYm9va0VudHJpZXMsXG4gICAgcmVwbGFjZUxvcmVib29rRW50cmllcyxcbiAgICB1cGRhdGVMb3JlYm9va0VudHJpZXNXaXRoLFxuICAgIHNldExvcmVib29rRW50cmllcyxcbiAgICBjcmVhdGVMb3JlYm9va0VudHJpZXMsXG4gICAgY3JlYXRlTG9yZWJvb2tFbnRyeSxcbiAgICBkZWxldGVMb3JlYm9va0VudHJpZXMsXG4gICAgZGVsZXRlTG9yZWJvb2tFbnRyeSxcblxuICAgIC8vIGxvcmVib29rXG4gICAgZ2V0TG9yZWJvb2tTZXR0aW5ncyxcbiAgICBzZXRMb3JlYm9va1NldHRpbmdzLFxuICAgIGdldENoYXJMb3JlYm9va3MsXG4gICAgc2V0Q3VycmVudENoYXJMb3JlYm9va3MsXG4gICAgZ2V0TG9yZWJvb2tzLFxuICAgIGRlbGV0ZUxvcmVib29rLFxuICAgIGNyZWF0ZUxvcmVib29rLFxuICAgIGdldEN1cnJlbnRDaGFyUHJpbWFyeUxvcmVib29rLFxuICAgIGdldENoYXRMb3JlYm9vayxcbiAgICBzZXRDaGF0TG9yZWJvb2ssXG4gICAgZ2V0T3JDcmVhdGVDaGF0TG9yZWJvb2ssXG5cbiAgICAvLyBtYWNyb2xpa2VcbiAgICByZWdpc3Rlck1hY3JvTGlrZSxcblxuICAgIC8vIHNsYXNoXG4gICAgdHJpZ2dlclNsYXNoLFxuICAgIHRyaWdnZXJTbGFzaFdpdGhSZXN1bHQ6IHRyaWdnZXJTbGFzaCxcblxuICAgIC8vIHRhdmVybl9yZWdleFxuICAgIGlzQ2hhcmFjdGVyVGF2ZXJuUmVnZXhlc0VuYWJsZWQsXG4gICAgZ2V0VGF2ZXJuUmVnZXhlcyxcbiAgICByZXBsYWNlVGF2ZXJuUmVnZXhlcyxcbiAgICB1cGRhdGVUYXZlcm5SZWdleGVzV2l0aCxcblxuICAgIC8vIHV0aWxcbiAgICBzdWJzdGl0dWRlTWFjcm9zLFxuICAgIGdldExhc3RNZXNzYWdlSWQsXG4gICAgZXJyb3JDYXRjaGVkLFxuXG4gICAgLy8gdmFyaWFibGVzXG4gICAgZ2V0VmFyaWFibGVzLFxuICAgIHJlcGxhY2VWYXJpYWJsZXMsXG4gICAgdXBkYXRlVmFyaWFibGVzV2l0aCxcbiAgICBpbnNlcnRPckFzc2lnblZhcmlhYmxlcyxcbiAgICBkZWxldGVWYXJpYWJsZSxcbiAgICBpbnNlcnRWYXJpYWJsZXMsXG5cbiAgICAvLyB2ZXJzaW9uXG4gICAgZ2V0VGF2ZXJuSGVscGVyVmVyc2lvbixcbiAgICB1cGRhdGVUYXZlcm5IZWxwZXIsXG4gICAgZ2V0RnJvbnRlbmRWZXJzaW9uOiBnZXRUYXZlcm5IZWxwZXJWZXJzaW9uLFxuICAgIHVwZGF0ZUZyb250ZW5kVmVyc2lvbjogdXBkYXRlVGF2ZXJuSGVscGVyLFxuICB9O1xufVxuXG5kZWNsYXJlIG5hbWVzcGFjZSBnbG9iYWxUaGlzIHtcbiAgbGV0IFRhdmVybkhlbHBlcjogUmV0dXJuVHlwZTx0eXBlb2YgZ2V0VGF2ZXJuSGVscGVyPjtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJZUYXZlcm5IZWxwZXLlhajlsYDlr7nosaFcbiAqIOWwhuWQhOenjeWKn+iDveWHveaVsOaatOmcsuWIsOWFqOWxgOS9nOeUqOWfn1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdFRhdmVybkhlbHBlck9iamVjdCgpIHtcbiAgZ2xvYmFsVGhpcy5UYXZlcm5IZWxwZXIgPSBnZXRUYXZlcm5IZWxwZXIoKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/index.ts\n')},"./src/function/lorebook.ts":
/*!**********************************!*\
  !*** ./src/function/lorebook.ts ***!
  \**********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLorebook: () => (/* binding */ createLorebook),\n/* harmony export */   deleteLorebook: () => (/* binding */ deleteLorebook),\n/* harmony export */   getCharLorebooks: () => (/* binding */ getCharLorebooks),\n/* harmony export */   getChatLorebook: () => (/* binding */ getChatLorebook),\n/* harmony export */   getCurrentCharPrimaryLorebook: () => (/* binding */ getCurrentCharPrimaryLorebook),\n/* harmony export */   getLorebookSettings: () => (/* binding */ getLorebookSettings),\n/* harmony export */   getLorebooks: () => (/* binding */ getLorebooks),\n/* harmony export */   getOrCreateChatLorebook: () => (/* binding */ getOrCreateChatLorebook),\n/* harmony export */   setChatLorebook: () => (/* binding */ setChatLorebook),\n/* harmony export */   setCurrentCharLorebooks: () => (/* binding */ setCurrentCharLorebooks),\n/* harmony export */   setLorebookSettings: () => (/* binding */ setLorebookSettings)\n/* harmony export */ });\n/* harmony import */ var _compatibility__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/compatibility */ \"./src/compatibility.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_group_chats__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/group-chats */ \"@sillytavern/scripts/group-chats\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n\n\n// @ts-ignore\n\n\n\nasync function editCurrentCharacter() {\n    // @ts-ignore\n    $('#rm_info_avatar').html('');\n    // @ts-ignore\n    const form_data = new FormData($('#form_create').get(0));\n    const raw_file = form_data.get('avatar');\n    if (raw_file instanceof File) {\n        const converted_file = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_3__.ensureImageFormatSupported)(raw_file);\n        form_data.set('avatar', converted_file);\n    }\n    const headers = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getRequestHeaders)();\n    // @ts-ignore\n    delete headers['Content-Type'];\n    // TODO: !\n    form_data.delete('alternate_greetings');\n    // @ts-ignore\n    const chid = $('.open_alternate_greetings').data('chid');\n    if (chid && Array.isArray(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[chid]?.data?.alternate_greetings)) {\n        for (const value of _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[chid].data.alternate_greetings) {\n            form_data.append('alternate_greetings', value);\n        }\n    }\n    const response = await fetch('/api/characters/edit', {\n        method: 'POST',\n        headers: headers,\n        body: form_data,\n        cache: 'no-cache',\n    });\n    if (!response.ok) {\n        return false;\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getOneCharacter)(form_data.get('avatar_url'));\n    // @ts-ignore\n    $('#add_avatar_button').replaceWith($('#add_avatar_button').val('').clone(true));\n    // @ts-ignore\n    $('#create_button').attr('value', 'Save');\n    return true;\n}\nfunction toLorebookSettings(world_info_settings) {\n    return {\n        selected_global_lorebooks: world_info_settings.world_info.globalSelect,\n        scan_depth: world_info_settings.world_info_depth,\n        context_percentage: world_info_settings.world_info_budget,\n        budget_cap: world_info_settings.world_info_budget_cap,\n        min_activations: world_info_settings.world_info_min_activations,\n        max_depth: world_info_settings.world_info_min_activations_depth_max,\n        max_recursion_steps: world_info_settings.world_info_max_recursion_steps,\n        insertion_strategy: { 0: 'evenly', 1: 'character_first', 2: 'global_first' }[world_info_settings.world_info_character_strategy],\n        include_names: world_info_settings.world_info_include_names,\n        recursive: world_info_settings.world_info_recursive,\n        case_sensitive: world_info_settings.world_info_case_sensitive,\n        match_whole_words: world_info_settings.world_info_match_whole_words,\n        use_group_scoring: world_info_settings.world_info_use_group_scoring,\n        overflow_alert: world_info_settings.world_info_overflow_alert,\n    };\n}\nfunction assignPartialLorebookSettings(settings) {\n    const for_eachs = {\n        selected_global_lorebooks: (value) => {\n            // @ts-ignore\n            $('#world_info').find('option[value!=\"\"]').remove();\n            _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names.forEach((item, i) => \n            // @ts-ignore\n            $('#world_info').append(`<option value='${i}'${value.includes(item) ? ' selected' : ''}>${item}</option>`));\n            _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.selected_world_info.length = 0;\n            _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.selected_world_info.push(...value);\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveSettings)();\n        },\n        scan_depth: (value) => {\n            // @ts-ignore\n            $('#world_info_depth').val(value).trigger('input');\n        },\n        context_percentage: (value) => {\n            // @ts-ignore\n            $('#world_info_budget').val(value).trigger('input');\n        },\n        budget_cap: (value) => {\n            // @ts-ignore\n            $('#world_info_budget_cap').val(value).trigger('input');\n        },\n        min_activations: (value) => {\n            // @ts-ignore\n            $('#world_info_min_activations').val(value).trigger('input');\n        },\n        max_depth: (value) => {\n            // @ts-ignore\n            $('#world_info_min_activations_depth_max').val(value).trigger('input');\n        },\n        max_recursion_steps: (value) => {\n            // @ts-ignore\n            $('#world_info_max_recursion_steps').val(value).trigger('input');\n        },\n        insertion_strategy: (value) => {\n            const converted_value = { evenly: 0, character_first: 1, global_first: 2 }[value];\n            // @ts-ignore\n            $(`#world_info_character_strategy option[value='${converted_value}']`).prop('selected', true);\n            // @ts-ignore\n            $('#world_info_character_strategy').val(converted_value).trigger('change');\n        },\n        include_names: (value) => {\n            // @ts-ignore\n            $('#world_info_include_names').prop('checked', value).trigger('input');\n        },\n        recursive: (value) => {\n            // @ts-ignore\n            $('#world_info_recursive').prop('checked', value).trigger('input');\n        },\n        case_sensitive: (value) => {\n            // @ts-ignore\n            $('#world_info_case_sensitive').prop('checked', value).trigger('input');\n        },\n        match_whole_words: (value) => {\n            // @ts-ignore\n            $('#world_info_match_whole_words').prop('checked', value).trigger('input');\n        },\n        use_group_scoring: (value) => {\n            // @ts-ignore\n            $('#world_info_use_group_scoring').prop('checked', value).trigger('change');\n        },\n        overflow_alert: (value) => {\n            // @ts-ignore\n            $('#world_info_overflow_alert').prop('checked', value).trigger('change');\n        },\n    };\n    Object.entries(settings)\n        .filter(([_, value]) => value !== undefined)\n        .forEach(([field, value]) => {\n        // @ts-ignore\n        for_eachs[field]?.(value);\n    });\n}\nfunction getLorebookSettings() {\n    const lorebook_settings = toLorebookSettings((0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.getWorldInfoSettings)());\n    console.info(`:\\n${JSON.stringify(lorebook_settings)}`);\n    return structuredClone(lorebook_settings);\n}\nfunction setLorebookSettings(settings) {\n    if (settings.selected_global_lorebooks) {\n        const inexisting_lorebooks = settings.selected_global_lorebooks.filter(lorebook => !_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names.includes(lorebook));\n        if (inexisting_lorebooks.length > 0) {\n            throw Error(`, : ${JSON.stringify(inexisting_lorebooks)}`);\n        }\n    }\n    assignPartialLorebookSettings(settings);\n    console.info(`:\\n${JSON.stringify(settings)}`);\n}\nfunction getLorebooks() {\n    console.info(`: ${JSON.stringify(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names)}`);\n    return structuredClone(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names);\n}\nasync function deleteLorebook(lorebook) {\n    const success = await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.deleteWorldInfo)(lorebook);\n    console.info(` '${lorebook}' ${success ? '' : ''}`);\n    return success;\n}\nasync function createLorebook(lorebook) {\n    const success = await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.createNewWorldInfo)(lorebook, { interactive: false });\n    console.info(` '${lorebook}' ${success ? '' : ''}`);\n    return success;\n}\nfunction getCharLorebooks({ name = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid]?.avatar ?? null, type = 'all', } = {}) {\n    // @ts-ignore\n    if (_sillytavern_scripts_group_chats__WEBPACK_IMPORTED_MODULE_2__.selected_group && !name) {\n        throw Error(``);\n    }\n    // @ts-ignore\n    const character = (0,_compatibility__WEBPACK_IMPORTED_MODULE_0__.findChar)({ name });\n    if (!character) {\n        throw Error(` '${name}' `);\n    }\n    const books = { primary: null, additional: [] };\n    if (character.data?.extensions?.world) {\n        books.primary = character.data?.extensions?.world;\n    }\n    const filename = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_3__.getCharaFilename)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters.indexOf(character));\n    const extraCharLore = _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_info.charLore?.find(e => e.name === filename);\n    if (extraCharLore && Array.isArray(extraCharLore.extraBooks)) {\n        books.additional = extraCharLore.extraBooks;\n    }\n    //  type \n    if (type) {\n        switch (type) {\n            case 'primary':\n                return { primary: books.primary, additional: [] };\n            case 'additional':\n                return { primary: null, additional: books.additional };\n            case 'all':\n            default:\n                return books;\n        }\n    }\n    console.info(`, : ${JSON.stringify({ name, type })}, : ${JSON.stringify(books)}`);\n    return structuredClone(books);\n}\nfunction getCurrentCharPrimaryLorebook() {\n    return getCharLorebooks().primary;\n}\nasync function setCurrentCharLorebooks(lorebooks) {\n    // @ts-ignore\n    if (_sillytavern_scripts_group_chats__WEBPACK_IMPORTED_MODULE_2__.selected_group && !name) {\n        throw Error(``);\n    }\n    // @ts-ignore\n    const filename = name ?? (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_3__.getCharaFilename)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid);\n    if (!filename) {\n        throw Error(``);\n    }\n    const inexisting_lorebooks = [\n        ...(lorebooks.primary && !_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names.includes(lorebooks.primary) ? [lorebooks.primary] : []),\n        ...(lorebooks.additional ? lorebooks.additional.filter(lorebook => !_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names.includes(lorebook)) : []),\n    ];\n    if (inexisting_lorebooks.length > 0) {\n        throw Error(` '${filename}' , : ${inexisting_lorebooks}`);\n    }\n    if (lorebooks.primary !== undefined) {\n        // @ts-ignore\n        const previous_primary = String($('#character_world').val());\n        // @ts-ignore\n        $('#character_world').val(lorebooks.primary ? lorebooks.primary : '');\n        // @ts-ignore\n        $('.character_world_info_selector')\n            .find('option:selected')\n            .val(lorebooks.primary ? _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names.indexOf(lorebooks.primary) : '');\n        if (previous_primary && !lorebooks.primary) {\n            // @ts-ignore\n            const data = JSON.parse(String($('#character_json_data').val()));\n            if (data?.data?.character_book) {\n                data.data.character_book = undefined;\n            }\n            // @ts-ignore\n            $('#character_json_data').val(JSON.stringify(data));\n        }\n        if (!(await editCurrentCharacter())) {\n            throw Error(` '${filename}' , `);\n        }\n        // @ts-ignore\n        (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.setWorldInfoButtonClass)(undefined, !!lorebooks.primary);\n    }\n    if (lorebooks.additional !== undefined) {\n        const char_lore = _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_info.charLore ?? [];\n        const existing_char_index = char_lore.findIndex(entry => entry.name === filename);\n        if (existing_char_index === -1) {\n            char_lore.push({ name: filename, extraBooks: lorebooks.additional });\n        }\n        else if (lorebooks.additional.length === 0) {\n            char_lore.splice(existing_char_index, 1);\n        }\n        else {\n            char_lore[existing_char_index].extraBooks = lorebooks.additional;\n        }\n        Object.assign(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_info, { charLore: char_lore });\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveCharacterDebounced)();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveSettingsDebounced)();\n    console.info(`, : ${JSON.stringify(lorebooks)}${lorebooks.primary === undefined ? ', ' : ''}${lorebooks.additional === undefined ? ', ' : ''}`);\n}\nasync function getChatLorebook() {\n    const chat_id = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getCurrentChatId)();\n    if (!chat_id) {\n        throw Error(`, `);\n    }\n    const existing_lorebook = _.get(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.METADATA_KEY, '');\n    if (_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names.includes(existing_lorebook)) {\n        return existing_lorebook;\n    }\n    _.unset(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.METADATA_KEY);\n    return null;\n}\nasync function setChatLorebook(lorebook) {\n    if (lorebook === null) {\n        _.unset(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.METADATA_KEY);\n        $('.chat_lorebook_button').removeClass('world_set');\n    }\n    else {\n        if (!_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names.includes(lorebook)) {\n            throw new Error(`,  '${lorebook}' `);\n        }\n        _.set(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.METADATA_KEY, lorebook);\n        $('.chat_lorebook_button').addClass('world_set');\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveMetadata)();\n}\nasync function getOrCreateChatLorebook(lorebook) {\n    const existing_lorebook = await getChatLorebook();\n    if (existing_lorebook !== null) {\n        return existing_lorebook;\n    }\n    const new_lorebook = (() => {\n        if (lorebook) {\n            if (_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.world_names.includes(lorebook)) {\n                throw new Error(`,  '${lorebook}' `);\n            }\n            return lorebook;\n        }\n        return `Chat Book ${(0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getCurrentChatId)()}`\n            .replace(/[^a-z0-9]/gi, '_')\n            .replace(/_{2,}/g, '_')\n            .substring(0, 64);\n    })();\n    await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_4__.createNewWorldInfo)(new_lorebook);\n    await setChatLorebook(new_lorebook);\n    return new_lorebook;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQzthQUN0QixTQUFTLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3RCLENBQUMsQ0FBQyxFQUFFLENBQUM7SUFDTCxNQUFNLG1GQUFrQixDQUFDLFlBQVksQ0FBQyxDQUFDO0lBRXZDLE1BQU0sZUFBZSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ3BDLE9BQU8sWUFBWSxDQUFDO0FBQ3RCLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vbG9yZWJvb2sudHM/NjdlMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBmaW5kQ2hhciB9IGZyb20gJ0AvY29tcGF0aWJpbGl0eSc7XG5cbmltcG9ydCB7XG4gIGNoYXJhY3RlcnMsXG4gIGNoYXRfbWV0YWRhdGEsXG4gIGdldEN1cnJlbnRDaGF0SWQsXG4gIGdldE9uZUNoYXJhY3RlcixcbiAgZ2V0UmVxdWVzdEhlYWRlcnMsXG4gIHNhdmVDaGFyYWN0ZXJEZWJvdW5jZWQsXG4gIHNhdmVNZXRhZGF0YSxcbiAgc2F2ZVNldHRpbmdzLFxuICBzYXZlU2V0dGluZ3NEZWJvdW5jZWQsXG4gIHRoaXNfY2hpZCxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG4vLyBAdHMtaWdub3JlXG5pbXBvcnQgeyBzZWxlY3RlZF9ncm91cCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2dyb3VwLWNoYXRzJztcbmltcG9ydCB7IGVuc3VyZUltYWdlRm9ybWF0U3VwcG9ydGVkLCBnZXRDaGFyYUZpbGVuYW1lIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuaW1wb3J0IHtcbiAgY3JlYXRlTmV3V29ybGRJbmZvLFxuICBkZWxldGVXb3JsZEluZm8sXG4gIGdldFdvcmxkSW5mb1NldHRpbmdzLFxuICBNRVRBREFUQV9LRVksXG4gIHNlbGVjdGVkX3dvcmxkX2luZm8sXG4gIHNldFdvcmxkSW5mb0J1dHRvbkNsYXNzLFxuICB3b3JsZF9pbmZvLFxuICB3b3JsZF9uYW1lcyxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvd29ybGQtaW5mbyc7XG5cbmludGVyZmFjZSBMb3JlYm9va1NldHRpbmdzIHtcbiAgc2VsZWN0ZWRfZ2xvYmFsX2xvcmVib29rczogc3RyaW5nW107XG5cbiAgc2Nhbl9kZXB0aDogbnVtYmVyO1xuICBjb250ZXh0X3BlcmNlbnRhZ2U6IG51bWJlcjtcbiAgYnVkZ2V0X2NhcDogbnVtYmVyOyAvLyAwIOihqOekuuemgeeUqFxuICBtaW5fYWN0aXZhdGlvbnM6IG51bWJlcjtcbiAgbWF4X2RlcHRoOiBudW1iZXI7IC8vIDAg6KGo56S65peg6ZmQ5Yi2XG4gIG1heF9yZWN1cnNpb25fc3RlcHM6IG51bWJlcjtcblxuICBpbnNlcnRpb25fc3RyYXRlZ3k6ICdldmVubHknIHwgJ2NoYXJhY3Rlcl9maXJzdCcgfCAnZ2xvYmFsX2ZpcnN0JztcblxuICBpbmNsdWRlX25hbWVzOiBib29sZWFuO1xuICByZWN1cnNpdmU6IGJvb2xlYW47XG4gIGNhc2Vfc2Vuc2l0aXZlOiBib29sZWFuO1xuICBtYXRjaF93aG9sZV93b3JkczogYm9vbGVhbjtcbiAgdXNlX2dyb3VwX3Njb3Jpbmc6IGJvb2xlYW47XG4gIG92ZXJmbG93X2FsZXJ0OiBib29sZWFuO1xufVxuXG5hc3luYyBmdW5jdGlvbiBlZGl0Q3VycmVudENoYXJhY3RlcigpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgLy8gQHRzLWlnbm9yZVxuICAkKCcjcm1faW5mb19hdmF0YXInKS5odG1sKCcnKTtcbiAgLy8gQHRzLWlnbm9yZVxuICBjb25zdCBmb3JtX2RhdGEgPSBuZXcgRm9ybURhdGEoKCQoJyNmb3JtX2NyZWF0ZScpIGFzIEpRdWVyeTxIVE1MRm9ybUVsZW1lbnQ+KS5nZXQoMCkpO1xuXG4gIGNvbnN0IHJhd19maWxlID0gZm9ybV9kYXRhLmdldCgnYXZhdGFyJyk7XG4gIGlmIChyYXdfZmlsZSBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICBjb25zdCBjb252ZXJ0ZWRfZmlsZSA9IGF3YWl0IGVuc3VyZUltYWdlRm9ybWF0U3VwcG9ydGVkKHJhd19maWxlKTtcbiAgICBmb3JtX2RhdGEuc2V0KCdhdmF0YXInLCBjb252ZXJ0ZWRfZmlsZSk7XG4gIH1cblxuICBjb25zdCBoZWFkZXJzID0gZ2V0UmVxdWVzdEhlYWRlcnMoKTtcbiAgLy8gQHRzLWlnbm9yZVxuICBkZWxldGUgaGVhZGVyc1snQ29udGVudC1UeXBlJ107XG5cbiAgLy8gVE9ETzog6L+Z6YeM55qE5Luj56CB5Y+v5Lul55So5p2l5L+u5pS556ys5LiA5p2h5raI5oGvIVxuICBmb3JtX2RhdGEuZGVsZXRlKCdhbHRlcm5hdGVfZ3JlZXRpbmdzJyk7XG4gIC8vIEB0cy1pZ25vcmVcbiAgY29uc3QgY2hpZCA9ICQoJy5vcGVuX2FsdGVybmF0ZV9ncmVldGluZ3MnKS5kYXRhKCdjaGlkJyk7XG4gIGlmIChjaGlkICYmIEFycmF5LmlzQXJyYXkoY2hhcmFjdGVyc1tjaGlkXT8uZGF0YT8uYWx0ZXJuYXRlX2dyZWV0aW5ncykpIHtcbiAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIGNoYXJhY3RlcnNbY2hpZF0uZGF0YS5hbHRlcm5hdGVfZ3JlZXRpbmdzKSB7XG4gICAgICBmb3JtX2RhdGEuYXBwZW5kKCdhbHRlcm5hdGVfZ3JlZXRpbmdzJywgdmFsdWUpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvY2hhcmFjdGVycy9lZGl0Jywge1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgYm9keTogZm9ybV9kYXRhLFxuICAgIGNhY2hlOiAnbm8tY2FjaGUnLFxuICB9KTtcblxuICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgYXdhaXQgZ2V0T25lQ2hhcmFjdGVyKGZvcm1fZGF0YS5nZXQoJ2F2YXRhcl91cmwnKSk7XG4gIC8vIEB0cy1pZ25vcmVcbiAgJCgnI2FkZF9hdmF0YXJfYnV0dG9uJykucmVwbGFjZVdpdGgoJCgnI2FkZF9hdmF0YXJfYnV0dG9uJykudmFsKCcnKS5jbG9uZSh0cnVlKSk7XG4gIC8vIEB0cy1pZ25vcmVcbiAgJCgnI2NyZWF0ZV9idXR0b24nKS5hdHRyKCd2YWx1ZScsICdTYXZlJyk7XG5cbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIHRvTG9yZWJvb2tTZXR0aW5ncyh3b3JsZF9pbmZvX3NldHRpbmdzOiBSZXR1cm5UeXBlPHR5cGVvZiBnZXRXb3JsZEluZm9TZXR0aW5ncz4pOiBMb3JlYm9va1NldHRpbmdzIHtcbiAgcmV0dXJuIHtcbiAgICBzZWxlY3RlZF9nbG9iYWxfbG9yZWJvb2tzOiAod29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvIGFzIHsgZ2xvYmFsU2VsZWN0OiBzdHJpbmdbXSB9KS5nbG9iYWxTZWxlY3QsXG5cbiAgICBzY2FuX2RlcHRoOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fZGVwdGgsXG4gICAgY29udGV4dF9wZXJjZW50YWdlOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fYnVkZ2V0LFxuICAgIGJ1ZGdldF9jYXA6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19idWRnZXRfY2FwLFxuICAgIG1pbl9hY3RpdmF0aW9uczogd29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvX21pbl9hY3RpdmF0aW9ucyxcbiAgICBtYXhfZGVwdGg6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19taW5fYWN0aXZhdGlvbnNfZGVwdGhfbWF4LFxuICAgIG1heF9yZWN1cnNpb25fc3RlcHM6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19tYXhfcmVjdXJzaW9uX3N0ZXBzLFxuXG4gICAgaW5zZXJ0aW9uX3N0cmF0ZWd5OiB7IDA6ICdldmVubHknLCAxOiAnY2hhcmFjdGVyX2ZpcnN0JywgMjogJ2dsb2JhbF9maXJzdCcgfVtcbiAgICAgIHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19jaGFyYWN0ZXJfc3RyYXRlZ3lcbiAgICBdIGFzICdldmVubHknIHwgJ2NoYXJhY3Rlcl9maXJzdCcgfCAnZ2xvYmFsX2ZpcnN0JyxcblxuICAgIGluY2x1ZGVfbmFtZXM6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19pbmNsdWRlX25hbWVzLFxuICAgIHJlY3Vyc2l2ZTogd29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvX3JlY3Vyc2l2ZSxcbiAgICBjYXNlX3NlbnNpdGl2ZTogd29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvX2Nhc2Vfc2Vuc2l0aXZlLFxuICAgIG1hdGNoX3dob2xlX3dvcmRzOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fbWF0Y2hfd2hvbGVfd29yZHMsXG4gICAgdXNlX2dyb3VwX3Njb3Jpbmc6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb191c2VfZ3JvdXBfc2NvcmluZyxcbiAgICBvdmVyZmxvd19hbGVydDogd29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvX292ZXJmbG93X2FsZXJ0LFxuICB9O1xufVxuXG5mdW5jdGlvbiBhc3NpZ25QYXJ0aWFsTG9yZWJvb2tTZXR0aW5ncyhzZXR0aW5nczogUGFydGlhbDxMb3JlYm9va1NldHRpbmdzPik6IHZvaWQge1xuICBjb25zdCBmb3JfZWFjaHMgPSB7XG4gICAgc2VsZWN0ZWRfZ2xvYmFsX2xvcmVib29rczogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydzZWxlY3RlZF9nbG9iYWxfbG9yZWJvb2tzJ10pID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICQoJyN3b3JsZF9pbmZvJykuZmluZCgnb3B0aW9uW3ZhbHVlIT1cIlwiXScpLnJlbW92ZSgpO1xuICAgICAgd29ybGRfbmFtZXMuZm9yRWFjaCgoaXRlbSwgaSkgPT5cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAkKCcjd29ybGRfaW5mbycpLmFwcGVuZChgPG9wdGlvbiB2YWx1ZT0nJHtpfScke3ZhbHVlLmluY2x1ZGVzKGl0ZW0pID8gJyBzZWxlY3RlZCcgOiAnJ30+JHtpdGVtfTwvb3B0aW9uPmApLFxuICAgICAgKTtcblxuICAgICAgc2VsZWN0ZWRfd29ybGRfaW5mby5sZW5ndGggPSAwO1xuICAgICAgc2VsZWN0ZWRfd29ybGRfaW5mby5wdXNoKC4uLnZhbHVlKTtcbiAgICAgIHNhdmVTZXR0aW5ncygpO1xuICAgIH0sXG5cbiAgICBzY2FuX2RlcHRoOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ3NjYW5fZGVwdGgnXSkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgJCgnI3dvcmxkX2luZm9fZGVwdGgnKS52YWwodmFsdWUpLnRyaWdnZXIoJ2lucHV0Jyk7XG4gICAgfSxcbiAgICBjb250ZXh0X3BlcmNlbnRhZ2U6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snY29udGV4dF9wZXJjZW50YWdlJ10pID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICQoJyN3b3JsZF9pbmZvX2J1ZGdldCcpLnZhbCh2YWx1ZSkudHJpZ2dlcignaW5wdXQnKTtcbiAgICB9LFxuICAgIGJ1ZGdldF9jYXA6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snYnVkZ2V0X2NhcCddKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mb19idWRnZXRfY2FwJykudmFsKHZhbHVlKS50cmlnZ2VyKCdpbnB1dCcpO1xuICAgIH0sXG4gICAgbWluX2FjdGl2YXRpb25zOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ21pbl9hY3RpdmF0aW9ucyddKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mb19taW5fYWN0aXZhdGlvbnMnKS52YWwodmFsdWUpLnRyaWdnZXIoJ2lucHV0Jyk7XG4gICAgfSxcbiAgICBtYXhfZGVwdGg6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snbWF4X2RlcHRoJ10pID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICQoJyN3b3JsZF9pbmZvX21pbl9hY3RpdmF0aW9uc19kZXB0aF9tYXgnKS52YWwodmFsdWUpLnRyaWdnZXIoJ2lucHV0Jyk7XG4gICAgfSxcbiAgICBtYXhfcmVjdXJzaW9uX3N0ZXBzOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ21heF9yZWN1cnNpb25fc3RlcHMnXSkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgJCgnI3dvcmxkX2luZm9fbWF4X3JlY3Vyc2lvbl9zdGVwcycpLnZhbCh2YWx1ZSkudHJpZ2dlcignaW5wdXQnKTtcbiAgICB9LFxuXG4gICAgaW5zZXJ0aW9uX3N0cmF0ZWd5OiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ2luc2VydGlvbl9zdHJhdGVneSddKSA9PiB7XG4gICAgICBjb25zdCBjb252ZXJ0ZWRfdmFsdWUgPSB7IGV2ZW5seTogMCwgY2hhcmFjdGVyX2ZpcnN0OiAxLCBnbG9iYWxfZmlyc3Q6IDIgfVt2YWx1ZV07XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKGAjd29ybGRfaW5mb19jaGFyYWN0ZXJfc3RyYXRlZ3kgb3B0aW9uW3ZhbHVlPScke2NvbnZlcnRlZF92YWx1ZX0nXWApLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mb19jaGFyYWN0ZXJfc3RyYXRlZ3knKS52YWwoY29udmVydGVkX3ZhbHVlKS50cmlnZ2VyKCdjaGFuZ2UnKTtcbiAgICB9LFxuXG4gICAgaW5jbHVkZV9uYW1lczogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydpbmNsdWRlX25hbWVzJ10pID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICQoJyN3b3JsZF9pbmZvX2luY2x1ZGVfbmFtZXMnKS5wcm9wKCdjaGVja2VkJywgdmFsdWUpLnRyaWdnZXIoJ2lucHV0Jyk7XG4gICAgfSxcbiAgICByZWN1cnNpdmU6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1sncmVjdXJzaXZlJ10pID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICQoJyN3b3JsZF9pbmZvX3JlY3Vyc2l2ZScpLnByb3AoJ2NoZWNrZWQnLCB2YWx1ZSkudHJpZ2dlcignaW5wdXQnKTtcbiAgICB9LFxuICAgIGNhc2Vfc2Vuc2l0aXZlOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ2Nhc2Vfc2Vuc2l0aXZlJ10pID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICQoJyN3b3JsZF9pbmZvX2Nhc2Vfc2Vuc2l0aXZlJykucHJvcCgnY2hlY2tlZCcsIHZhbHVlKS50cmlnZ2VyKCdpbnB1dCcpO1xuICAgIH0sXG4gICAgbWF0Y2hfd2hvbGVfd29yZHM6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snbWF0Y2hfd2hvbGVfd29yZHMnXSkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgJCgnI3dvcmxkX2luZm9fbWF0Y2hfd2hvbGVfd29yZHMnKS5wcm9wKCdjaGVja2VkJywgdmFsdWUpLnRyaWdnZXIoJ2lucHV0Jyk7XG4gICAgfSxcbiAgICB1c2VfZ3JvdXBfc2NvcmluZzogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWyd1c2VfZ3JvdXBfc2NvcmluZyddKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mb191c2VfZ3JvdXBfc2NvcmluZycpLnByb3AoJ2NoZWNrZWQnLCB2YWx1ZSkudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgfSxcbiAgICBvdmVyZmxvd19hbGVydDogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydvdmVyZmxvd19hbGVydCddKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mb19vdmVyZmxvd19hbGVydCcpLnByb3AoJ2NoZWNrZWQnLCB2YWx1ZSkudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgfSxcbiAgfTtcblxuICBPYmplY3QuZW50cmllcyhzZXR0aW5ncylcbiAgICAuZmlsdGVyKChbXywgdmFsdWVdKSA9PiB2YWx1ZSAhPT0gdW5kZWZpbmVkKVxuICAgIC5mb3JFYWNoKChbZmllbGQsIHZhbHVlXSkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgZm9yX2VhY2hzW2ZpZWxkXT8uKHZhbHVlKTtcbiAgICB9KTtcbn1cblxuaW50ZXJmYWNlIEdldENoYXJMb3JlYm9va3NPcHRpb24ge1xuICBuYW1lPzogc3RyaW5nO1xuICB0eXBlPzogJ2FsbCcgfCAncHJpbWFyeScgfCAnYWRkaXRpb25hbCc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMb3JlYm9va1NldHRpbmdzKCk6IExvcmVib29rU2V0dGluZ3Mge1xuICBjb25zdCBsb3JlYm9va19zZXR0aW5ncyA9IHRvTG9yZWJvb2tTZXR0aW5ncyhnZXRXb3JsZEluZm9TZXR0aW5ncygpKTtcblxuICBjb25zb2xlLmluZm8oYOiOt+WPluS4lueVjOS5puWFqOWxgOiuvue9rjpcXG4ke0pTT04uc3RyaW5naWZ5KGxvcmVib29rX3NldHRpbmdzKX1gKTtcbiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZShsb3JlYm9va19zZXR0aW5ncyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRMb3JlYm9va1NldHRpbmdzKHNldHRpbmdzOiBQYXJ0aWFsPExvcmVib29rU2V0dGluZ3M+KTogdm9pZCB7XG4gIGlmIChzZXR0aW5ncy5zZWxlY3RlZF9nbG9iYWxfbG9yZWJvb2tzKSB7XG4gICAgY29uc3QgaW5leGlzdGluZ19sb3JlYm9va3MgPSBzZXR0aW5ncy5zZWxlY3RlZF9nbG9iYWxfbG9yZWJvb2tzLmZpbHRlcihsb3JlYm9vayA9PiAhd29ybGRfbmFtZXMuaW5jbHVkZXMobG9yZWJvb2spKTtcbiAgICBpZiAoaW5leGlzdGluZ19sb3JlYm9va3MubGVuZ3RoID4gMCkge1xuICAgICAgdGhyb3cgRXJyb3IoYOWwneivleS/ruaUueimgeWFqOWxgOWQr+eUqOeahOS4lueVjOS5piwg5L2G5pyq5om+5Yiw5Lul5LiL5LiW55WM5LmmOiAke0pTT04uc3RyaW5naWZ5KGluZXhpc3RpbmdfbG9yZWJvb2tzKX1gKTtcbiAgICB9XG4gIH1cblxuICBhc3NpZ25QYXJ0aWFsTG9yZWJvb2tTZXR0aW5ncyhzZXR0aW5ncyk7XG5cbiAgY29uc29sZS5pbmZvKGDkv67mlLnkuJbnlYzkuablhajlsYDorr7nva46XFxuJHtKU09OLnN0cmluZ2lmeShzZXR0aW5ncyl9YCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMb3JlYm9va3MoKTogc3RyaW5nW10ge1xuICBjb25zb2xlLmluZm8oYOiOt+WPluS4lueVjOS5puWIl+ihqDogJHtKU09OLnN0cmluZ2lmeSh3b3JsZF9uYW1lcyl9YCk7XG4gIHJldHVybiBzdHJ1Y3R1cmVkQ2xvbmUod29ybGRfbmFtZXMpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlTG9yZWJvb2sobG9yZWJvb2s6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBzdWNjZXNzID0gYXdhaXQgZGVsZXRlV29ybGRJbmZvKGxvcmVib29rKTtcblxuICBjb25zb2xlLmluZm8oYOenu+mZpOS4lueVjOS5piAnJHtsb3JlYm9va30nICR7c3VjY2VzcyA/ICfmiJDlip8nIDogJ+Wksei0pSd9YCk7XG4gIHJldHVybiBzdWNjZXNzO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlTG9yZWJvb2sobG9yZWJvb2s6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBzdWNjZXNzID0gYXdhaXQgY3JlYXRlTmV3V29ybGRJbmZvKGxvcmVib29rLCB7IGludGVyYWN0aXZlOiBmYWxzZSB9KTtcblxuICBjb25zb2xlLmluZm8oYOaWsOW7uuS4lueVjOS5piAnJHtsb3JlYm9va30nICR7c3VjY2VzcyA/ICfmiJDlip8nIDogJ+Wksei0pSd9YCk7XG4gIHJldHVybiBzdWNjZXNzO1xufVxuXG5pbnRlcmZhY2UgQ2hhckxvcmVib29rcyB7XG4gIHByaW1hcnk6IHN0cmluZyB8IG51bGw7XG4gIGFkZGl0aW9uYWw6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhckxvcmVib29rcyh7XG4gIG5hbWUgPSAoY2hhcmFjdGVycyBhcyBhbnkpW3RoaXNfY2hpZCBhcyBzdHJpbmddPy5hdmF0YXIgPz8gbnVsbCxcbiAgdHlwZSA9ICdhbGwnLFxufTogR2V0Q2hhckxvcmVib29rc09wdGlvbiA9IHt9KTogQ2hhckxvcmVib29rcyB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgaWYgKHNlbGVjdGVkX2dyb3VwICYmICFuYW1lKSB7XG4gICAgdGhyb3cgRXJyb3IoYOS4jeimgeWcqOe+pOe7hOS4reiwg+eUqOi/meS4quWKn+iDvWApO1xuICB9XG4gIC8vIEB0cy1pZ25vcmVcbiAgY29uc3QgY2hhcmFjdGVyID0gZmluZENoYXIoeyBuYW1lIH0pO1xuICBpZiAoIWNoYXJhY3Rlcikge1xuICAgIHRocm93IEVycm9yKGDmnKrmib7liLDlkI3kuLogJyR7bmFtZX0nIOeahOinkuiJsuWNoWApO1xuICB9XG5cbiAgY29uc3QgYm9va3M6IENoYXJMb3JlYm9va3MgPSB7IHByaW1hcnk6IG51bGwsIGFkZGl0aW9uYWw6IFtdIH07XG5cbiAgaWYgKGNoYXJhY3Rlci5kYXRhPy5leHRlbnNpb25zPy53b3JsZCkge1xuICAgIGJvb2tzLnByaW1hcnkgPSBjaGFyYWN0ZXIuZGF0YT8uZXh0ZW5zaW9ucz8ud29ybGQ7XG4gIH1cblxuICBjb25zdCBmaWxlbmFtZSA9IGdldENoYXJhRmlsZW5hbWUoY2hhcmFjdGVycy5pbmRleE9mKGNoYXJhY3RlcikpIGFzIHN0cmluZztcbiAgY29uc3QgZXh0cmFDaGFyTG9yZSA9ICh3b3JsZF9pbmZvIGFzIHsgY2hhckxvcmU6IHsgbmFtZTogc3RyaW5nOyBleHRyYUJvb2tzOiBzdHJpbmdbXSB9W10gfSkuY2hhckxvcmU/LmZpbmQoXG4gICAgZSA9PiBlLm5hbWUgPT09IGZpbGVuYW1lLFxuICApO1xuICBpZiAoZXh0cmFDaGFyTG9yZSAmJiBBcnJheS5pc0FycmF5KGV4dHJhQ2hhckxvcmUuZXh0cmFCb29rcykpIHtcbiAgICBib29rcy5hZGRpdGlvbmFsID0gZXh0cmFDaGFyTG9yZS5leHRyYUJvb2tzO1xuICB9XG5cbiAgLy8g5qC55o2uIHR5cGUg5Y+C5pWw6L+H5ruk57uT5p6cXG4gIGlmICh0eXBlKSB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdwcmltYXJ5JzpcbiAgICAgICAgcmV0dXJuIHsgcHJpbWFyeTogYm9va3MucHJpbWFyeSwgYWRkaXRpb25hbDogW10gfTtcbiAgICAgIGNhc2UgJ2FkZGl0aW9uYWwnOlxuICAgICAgICByZXR1cm4geyBwcmltYXJ5OiBudWxsLCBhZGRpdGlvbmFsOiBib29rcy5hZGRpdGlvbmFsIH07XG4gICAgICBjYXNlICdhbGwnOlxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGJvb2tzO1xuICAgIH1cbiAgfVxuXG4gIGNvbnNvbGUuaW5mbyhg6I635Y+W6KeS6Imy5Y2h57uR5a6a55qE5LiW55WM5LmmLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoeyBuYW1lLCB0eXBlIH0pfSwg6I635Y+W57uT5p6cOiAke0pTT04uc3RyaW5naWZ5KGJvb2tzKX1gKTtcbiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZShib29rcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50Q2hhclByaW1hcnlMb3JlYm9vaygpOiBzdHJpbmcgfCBudWxsIHtcbiAgcmV0dXJuIGdldENoYXJMb3JlYm9va3MoKS5wcmltYXJ5O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0Q3VycmVudENoYXJMb3JlYm9va3MobG9yZWJvb2tzOiBQYXJ0aWFsPENoYXJMb3JlYm9va3M+KTogUHJvbWlzZTx2b2lkPiB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgaWYgKHNlbGVjdGVkX2dyb3VwICYmICFuYW1lKSB7XG4gICAgdGhyb3cgRXJyb3IoYOS4jeimgeWcqOe+pOe7hOS4reiwg+eUqOi/meS4quWKn+iDvWApO1xuICB9XG4gIC8vIEB0cy1pZ25vcmVcbiAgY29uc3QgZmlsZW5hbWUgPSBuYW1lID8/IGdldENoYXJhRmlsZW5hbWUodGhpc19jaGlkKTtcbiAgaWYgKCFmaWxlbmFtZSkge1xuICAgIHRocm93IEVycm9yKGDmnKrmiZPlvIDku7vkvZXop5LoibLljaFgKTtcbiAgfVxuXG4gIGNvbnN0IGluZXhpc3RpbmdfbG9yZWJvb2tzOiBzdHJpbmdbXSA9IFtcbiAgICAuLi4obG9yZWJvb2tzLnByaW1hcnkgJiYgIXdvcmxkX25hbWVzLmluY2x1ZGVzKGxvcmVib29rcy5wcmltYXJ5KSA/IFtsb3JlYm9va3MucHJpbWFyeV0gOiBbXSksXG4gICAgLi4uKGxvcmVib29rcy5hZGRpdGlvbmFsID8gbG9yZWJvb2tzLmFkZGl0aW9uYWwuZmlsdGVyKGxvcmVib29rID0+ICF3b3JsZF9uYW1lcy5pbmNsdWRlcyhsb3JlYm9vaykpIDogW10pLFxuICBdO1xuICBpZiAoaW5leGlzdGluZ19sb3JlYm9va3MubGVuZ3RoID4gMCkge1xuICAgIHRocm93IEVycm9yKGDlsJ3or5Xkv67mlLkgJyR7ZmlsZW5hbWV9JyDnu5HlrprnmoTkuJbnlYzkuaYsIOS9huacquaJvuWIsOS7peS4i+S4lueVjOS5pjogJHtpbmV4aXN0aW5nX2xvcmVib29rc31gKTtcbiAgfVxuXG4gIGlmIChsb3JlYm9va3MucHJpbWFyeSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IHByZXZpb3VzX3ByaW1hcnkgPSBTdHJpbmcoJCgnI2NoYXJhY3Rlcl93b3JsZCcpLnZhbCgpKTtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgJCgnI2NoYXJhY3Rlcl93b3JsZCcpLnZhbChsb3JlYm9va3MucHJpbWFyeSA/IGxvcmVib29rcy5wcmltYXJ5IDogJycpO1xuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgICQoJy5jaGFyYWN0ZXJfd29ybGRfaW5mb19zZWxlY3RvcicpXG4gICAgICAuZmluZCgnb3B0aW9uOnNlbGVjdGVkJylcbiAgICAgIC52YWwobG9yZWJvb2tzLnByaW1hcnkgPyB3b3JsZF9uYW1lcy5pbmRleE9mKGxvcmVib29rcy5wcmltYXJ5KSA6ICcnKTtcblxuICAgIGlmIChwcmV2aW91c19wcmltYXJ5ICYmICFsb3JlYm9va3MucHJpbWFyeSkge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoU3RyaW5nKCQoJyNjaGFyYWN0ZXJfanNvbl9kYXRhJykudmFsKCkpKTtcbiAgICAgIGlmIChkYXRhPy5kYXRhPy5jaGFyYWN0ZXJfYm9vaykge1xuICAgICAgICBkYXRhLmRhdGEuY2hhcmFjdGVyX2Jvb2sgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjY2hhcmFjdGVyX2pzb25fZGF0YScpLnZhbChKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgfVxuXG4gICAgaWYgKCEoYXdhaXQgZWRpdEN1cnJlbnRDaGFyYWN0ZXIoKSkpIHtcbiAgICAgIHRocm93IEVycm9yKGDlsJ3or5XkuLogJyR7ZmlsZW5hbWV9JyDnu5HlrprkuLvopoHkuJbnlYzkuaYsIOS9huWcqOiuv+mXrumFkummhuWQjuerr+aXtuWHuumUmWApO1xuICAgIH1cblxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBzZXRXb3JsZEluZm9CdXR0b25DbGFzcyh1bmRlZmluZWQsICEhbG9yZWJvb2tzLnByaW1hcnkpO1xuICB9XG5cbiAgaWYgKGxvcmVib29rcy5hZGRpdGlvbmFsICE9PSB1bmRlZmluZWQpIHtcbiAgICBpbnRlcmZhY2UgQ2hhckxvcmVFbnRyeSB7XG4gICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICBleHRyYUJvb2tzOiBzdHJpbmdbXTtcbiAgICB9XG4gICAgY29uc3QgY2hhcl9sb3JlID0gKHdvcmxkX2luZm8gYXMgeyBjaGFyTG9yZTogQ2hhckxvcmVFbnRyeVtdIH0pLmNoYXJMb3JlID8/IFtdO1xuXG4gICAgY29uc3QgZXhpc3RpbmdfY2hhcl9pbmRleCA9IGNoYXJfbG9yZS5maW5kSW5kZXgoZW50cnkgPT4gZW50cnkubmFtZSA9PT0gZmlsZW5hbWUpO1xuICAgIGlmIChleGlzdGluZ19jaGFyX2luZGV4ID09PSAtMSkge1xuICAgICAgY2hhcl9sb3JlLnB1c2goeyBuYW1lOiBmaWxlbmFtZSwgZXh0cmFCb29rczogbG9yZWJvb2tzLmFkZGl0aW9uYWwgfSk7XG4gICAgfSBlbHNlIGlmIChsb3JlYm9va3MuYWRkaXRpb25hbC5sZW5ndGggPT09IDApIHtcbiAgICAgIGNoYXJfbG9yZS5zcGxpY2UoZXhpc3RpbmdfY2hhcl9pbmRleCwgMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNoYXJfbG9yZVtleGlzdGluZ19jaGFyX2luZGV4XS5leHRyYUJvb2tzID0gbG9yZWJvb2tzLmFkZGl0aW9uYWw7XG4gICAgfVxuXG4gICAgT2JqZWN0LmFzc2lnbih3b3JsZF9pbmZvLCB7IGNoYXJMb3JlOiBjaGFyX2xvcmUgfSk7XG4gIH1cblxuICBzYXZlQ2hhcmFjdGVyRGVib3VuY2VkKCk7XG4gIHNhdmVTZXR0aW5nc0RlYm91bmNlZCgpO1xuXG4gIGNvbnNvbGUuaW5mbyhcbiAgICBg5L+u5pS56KeS6Imy5Y2h57uR5a6a55qE5LiW55WM5LmmLCDopoHkv67mlLnnmoTpg6jliIY6ICR7SlNPTi5zdHJpbmdpZnkobG9yZWJvb2tzKX0ke1xuICAgICAgbG9yZWJvb2tzLnByaW1hcnkgPT09IHVuZGVmaW5lZCA/ICcsIOS4u+imgeS4lueVjOS5puS/neaMgeS4jeWPmCcgOiAnJ1xuICAgIH0ke2xvcmVib29rcy5hZGRpdGlvbmFsID09PSB1bmRlZmluZWQgPyAnLCDpmYTliqDkuJbnlYzkuabkv53mjIHkuI3lj5gnIDogJyd9YCxcbiAgKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENoYXRMb3JlYm9vaygpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgY29uc3QgY2hhdF9pZCA9IGdldEN1cnJlbnRDaGF0SWQoKTtcbiAgaWYgKCFjaGF0X2lkKSB7XG4gICAgdGhyb3cgRXJyb3IoYOacquaJk+W8gOS7u+S9leiBiuWkqSwg5LiN5Y+v6I635Y+W6IGK5aSp5LiW55WM5LmmYCk7XG4gIH1cblxuICBjb25zdCBleGlzdGluZ19sb3JlYm9vayA9IF8uZ2V0KGNoYXRfbWV0YWRhdGEsIE1FVEFEQVRBX0tFWSwgJycpIGFzIHN0cmluZztcbiAgaWYgKHdvcmxkX25hbWVzLmluY2x1ZGVzKGV4aXN0aW5nX2xvcmVib29rKSkge1xuICAgIHJldHVybiBleGlzdGluZ19sb3JlYm9vaztcbiAgfVxuICBfLnVuc2V0KGNoYXRfbWV0YWRhdGEsIE1FVEFEQVRBX0tFWSk7XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0Q2hhdExvcmVib29rKGxvcmVib29rOiBzdHJpbmcgfCBudWxsKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmIChsb3JlYm9vayA9PT0gbnVsbCkge1xuICAgIF8udW5zZXQoY2hhdF9tZXRhZGF0YSwgTUVUQURBVEFfS0VZKTtcbiAgICAkKCcuY2hhdF9sb3JlYm9va19idXR0b24nKS5yZW1vdmVDbGFzcygnd29ybGRfc2V0Jyk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCF3b3JsZF9uYW1lcy5pbmNsdWRlcyhsb3JlYm9vaykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihg5bCd6K+V5Li66KeS6Imy5Y2h57uR5a6a6IGK5aSp5LiW55WM5LmmLCDlvZPor6XkuJbnlYzkuaYgJyR7bG9yZWJvb2t9JyDkuI3lrZjlnKhgKTtcbiAgICB9XG5cbiAgICBfLnNldChjaGF0X21ldGFkYXRhLCBNRVRBREFUQV9LRVksIGxvcmVib29rKTtcbiAgICAkKCcuY2hhdF9sb3JlYm9va19idXR0b24nKS5hZGRDbGFzcygnd29ybGRfc2V0Jyk7XG4gIH1cbiAgYXdhaXQgc2F2ZU1ldGFkYXRhKCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPckNyZWF0ZUNoYXRMb3JlYm9vayhsb3JlYm9vaz86IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGV4aXN0aW5nX2xvcmVib29rID0gYXdhaXQgZ2V0Q2hhdExvcmVib29rKCk7XG4gIGlmIChleGlzdGluZ19sb3JlYm9vayAhPT0gbnVsbCkge1xuICAgIHJldHVybiBleGlzdGluZ19sb3JlYm9vaztcbiAgfVxuXG4gIGNvbnN0IG5ld19sb3JlYm9vayA9ICgoKSA9PiB7XG4gICAgaWYgKGxvcmVib29rKSB7XG4gICAgICBpZiAod29ybGRfbmFtZXMuaW5jbHVkZXMobG9yZWJvb2spKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihg5bCd6K+V5Yib5bu66IGK5aSp5LiW55WM5LmmLCDkvYbor6XlkI3np7AgJyR7bG9yZWJvb2t9JyDlt7LlrZjlnKhgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBsb3JlYm9vaztcbiAgICB9XG5cbiAgICByZXR1cm4gYENoYXQgQm9vayAke2dldEN1cnJlbnRDaGF0SWQoKX1gXG4gICAgICAucmVwbGFjZSgvW15hLXowLTldL2dpLCAnXycpXG4gICAgICAucmVwbGFjZSgvX3syLH0vZywgJ18nKVxuICAgICAgLnN1YnN0cmluZygwLCA2NCk7XG4gIH0pKCk7XG4gIGF3YWl0IGNyZWF0ZU5ld1dvcmxkSW5mbyhuZXdfbG9yZWJvb2spO1xuXG4gIGF3YWl0IHNldENoYXRMb3JlYm9vayhuZXdfbG9yZWJvb2spO1xuICByZXR1cm4gbmV3X2xvcmVib29rO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/lorebook.ts\n")},"./src/function/lorebook_entry.ts":
/*!****************************************!*\
  !*** ./src/function/lorebook_entry.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLorebookEntries: () => (/* binding */ createLorebookEntries),\n/* harmony export */   createLorebookEntry: () => (/* binding */ createLorebookEntry),\n/* harmony export */   deleteLorebookEntries: () => (/* binding */ deleteLorebookEntries),\n/* harmony export */   deleteLorebookEntry: () => (/* binding */ deleteLorebookEntry),\n/* harmony export */   getLorebookEntries: () => (/* binding */ getLorebookEntries),\n/* harmony export */   replaceLorebookEntries: () => (/* binding */ replaceLorebookEntries),\n/* harmony export */   setLorebookEntries: () => (/* binding */ setLorebookEntries),\n/* harmony export */   updateLorebookEntriesWith: () => (/* binding */ updateLorebookEntriesWith)\n/* harmony export */ });\n/* harmony import */ var _compatibility__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/compatibility */ \"./src/compatibility.ts\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n\n\nconst default_original_lorebook_entry = {\n    key: [],\n    keysecondary: [],\n    comment: '',\n    content: '',\n    constant: false,\n    vectorized: false,\n    selective: true,\n    selectiveLogic: 0,\n    addMemo: true,\n    order: 100,\n    position: 0,\n    disable: false,\n    excludeRecursion: false,\n    preventRecursion: false,\n    matchPersonaDescription: false,\n    matchCharacterDescription: false,\n    matchCharacterPersonality: false,\n    matchCharacterDepthPrompt: false,\n    matchScenario: false,\n    matchCreatorNotes: false,\n    delayUntilRecursion: 0,\n    probability: 100,\n    useProbability: true,\n    depth: 4,\n    group: '',\n    groupOverride: false,\n    groupWeight: 100,\n    scanDepth: null,\n    caseSensitive: null,\n    matchWholeWords: null,\n    useGroupScoring: null,\n    automationId: '',\n    role: 0,\n    sticky: null,\n    cooldown: null,\n    delay: null,\n};\nfunction toLorebookEntry(entry) {\n    return {\n        uid: entry.uid,\n        display_index: entry.displayIndex,\n        comment: entry.comment,\n        enabled: !entry.disable,\n        type: entry.constant ? 'constant' : entry.vectorized ? 'vectorized' : 'selective',\n        // @ts-ignore\n        position: {\n            0: 'before_character_definition',\n            1: 'after_character_definition',\n            5: 'before_example_messages',\n            6: 'after_example_messages',\n            2: 'before_author_note',\n            3: 'after_author_note',\n        }[entry.position] ??\n            (entry.role === 0 ? 'at_depth_as_system' : entry.role === 1 ? 'at_depth_as_user' : 'at_depth_as_assistant'),\n        depth: entry.position === 4 ? entry.depth : null,\n        order: entry.order,\n        probability: entry.probability,\n        key: entry.key,\n        keys: entry.key,\n        logic: {\n            0: 'and_any',\n            1: 'and_all',\n            2: 'not_any',\n            3: 'not_all',\n        }[entry.selectiveLogic],\n        filter: entry.keysecondary,\n        filters: entry.keysecondary,\n        scan_depth: entry.scanDepth ?? 'same_as_global',\n        case_sensitive: entry.caseSensitive ?? 'same_as_global',\n        match_whole_words: entry.matchWholeWords ?? 'same_as_global',\n        use_group_scoring: entry.useGroupScoring ?? 'same_as_global',\n        automation_id: entry.automationId || null,\n        exclude_recursion: entry.excludeRecursion,\n        prevent_recursion: entry.preventRecursion,\n        delay_until_recursion: entry.delayUntilRecursion,\n        content: entry.content,\n        group: entry.group,\n        group_prioritized: entry.groupOverride,\n        group_weight: entry.groupWeight,\n        sticky: entry.sticky || null,\n        cooldown: entry.cooldown || null,\n        delay: entry.delay || null,\n    };\n}\nasync function getLorebookEntries(lorebook, { filter = 'none' } = {}) {\n    if (!_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.world_names.includes(lorebook)) {\n        throw Error(` '${lorebook}'`);\n    }\n    // @ts-ignore\n    let entries = Object.values((await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.loadWorldInfo)(lorebook)).entries).map(toLorebookEntry);\n    if (filter !== 'none') {\n        entries = entries.filter(entry => Object.entries(filter).every(([field, expected_value]) => {\n            // @ts-ignore\n            const entry_value = entry[field];\n            if (Array.isArray(entry_value)) {\n                return expected_value.every(value => entry_value.includes(value));\n            }\n            if (typeof entry_value === 'string') {\n                return entry_value.includes(expected_value);\n            }\n            return entry_value === expected_value;\n        }));\n    }\n    console.info(` '${lorebook}' , : ${JSON.stringify({ filter })}`);\n    return structuredClone(entries);\n}\nfunction fromPartialLorebookEntry(entry) {\n    if (_.has(entry, 'key') && !_.has(entry, 'keys')) {\n        _.set(entry, 'keys', entry.key);\n    }\n    if (_.has(entry, 'filter') && !_.has(entry, 'filters')) {\n        _.set(entry, 'filters', entry.filter);\n    }\n    const transformers = {\n        uid: (value) => ({ uid: value }),\n        display_index: (value) => ({ displayIndex: value }),\n        comment: (value) => ({ comment: value }),\n        enabled: (value) => ({ disable: !value }),\n        type: (value) => ({\n            constant: value === 'constant',\n            vectorized: value === 'vectorized',\n        }),\n        position: (value) => ({\n            position: {\n                before_character_definition: 0,\n                after_character_definition: 1,\n                before_example_messages: 5,\n                after_example_messages: 6,\n                before_author_note: 2,\n                after_author_note: 3,\n                at_depth_as_system: 4,\n                at_depth_as_user: 4,\n                at_depth_as_assistant: 4,\n            }[value],\n            role: \n            // @ts-ignore\n            {\n                at_depth_as_system: 0,\n                at_depth_as_user: 1,\n                at_depth_as_assistant: 2,\n            }[value] ?? null,\n        }),\n        depth: (value) => ({ depth: value === null ? 4 : value }),\n        order: (value) => ({ order: value }),\n        probability: (value) => ({ probability: value }),\n        keys: (value) => ({ key: value }),\n        logic: (value) => ({\n            selectiveLogic: {\n                and_any: 0,\n                and_all: 1,\n                not_any: 2,\n                not_all: 3,\n            }[value],\n        }),\n        filters: (value) => ({ keysecondary: value }),\n        scan_depth: (value) => ({ scanDepth: value === 'same_as_global' ? null : value }),\n        case_sensitive: (value) => ({\n            caseSensitive: value === 'same_as_global' ? null : value,\n        }),\n        match_whole_words: (value) => ({\n            matchWholeWords: value === 'same_as_global' ? null : value,\n        }),\n        use_group_scoring: (value) => ({\n            useGroupScoring: value === 'same_as_global' ? null : value,\n        }),\n        automation_id: (value) => ({ automationId: value === null ? '' : value }),\n        exclude_recursion: (value) => ({ excludeRecursion: value }),\n        prevent_recursion: (value) => ({ preventRecursion: value }),\n        delay_until_recursion: (value) => ({ delayUntilRecursion: value }),\n        content: (value) => ({ content: value }),\n        group: (value) => ({ group: value }),\n        group_prioritized: (value) => ({ groupOverride: value }),\n        group_weight: (value) => ({ groupWeight: value }),\n        sticky: (value) => ({ sticky: value === null ? 0 : value }),\n        cooldown: (value) => ({ cooldown: value === null ? 0 : value }),\n        delay: (value) => ({ delay: value === null ? 0 : value }),\n    };\n    return _.merge({}, default_original_lorebook_entry, ...Object.entries(entry)\n        .filter(([_, value]) => value !== undefined)\n        // @ts-ignore\n        .map(([key, value]) => transformers[key]?.(value)));\n}\nconst MAX_UID = 1_000_000;\nfunction handleLorebookEntriesCollision(entries) {\n    const uid_set = new Set();\n    const handle_uid_collision = (index) => {\n        if (index === undefined) {\n            index = _.random(0, MAX_UID - 1);\n        }\n        let i = 1;\n        while (true) {\n            if (!uid_set.has(index)) {\n                uid_set.add(index);\n                return index;\n            }\n            index = (index + i * i) % MAX_UID;\n            ++i;\n        }\n    };\n    let max_display_index = _.max(entries.map(entry => entry.display_index ?? -1)) ?? -1;\n    return entries.map(entry => ({\n        ...entry,\n        uid: handle_uid_collision(entry.uid),\n        display_index: entry.display_index ?? ++max_display_index,\n    }));\n}\nasync function replaceLorebookEntries(lorebook, entries) {\n    if (!_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.world_names.includes(lorebook)) {\n        throw Error(` '${lorebook}'`);\n    }\n    const data = {\n        entries: _.merge({}, ...handleLorebookEntriesCollision(entries)\n            .map(fromPartialLorebookEntry)\n            .map(entry => ({ [entry.uid]: entry }))),\n    };\n    await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.saveWorldInfo)(lorebook, data);\n    (0,_compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditorDebounced)(lorebook);\n    console.info(` '${lorebook}' `);\n}\nasync function updateLorebookEntriesWith(lorebook, updater) {\n    console.info(` '${lorebook}' `);\n    await replaceLorebookEntries(lorebook, await updater(await getLorebookEntries(lorebook)));\n    return getLorebookEntries(lorebook);\n}\nasync function setLorebookEntries(lorebook, entries) {\n    return await updateLorebookEntriesWith(lorebook, data => {\n        for (const entry_to_set of entries) {\n            const data_entry = data.find(entry => entry.uid === entry_to_set.uid);\n            if (data_entry) {\n                _.merge(data_entry, entry_to_set);\n            }\n        }\n        return data;\n    });\n}\nasync function createLorebookEntries(lorebook, entries) {\n    const new_uids = [];\n    const updated_entries = await updateLorebookEntriesWith(lorebook, data => {\n        const uid_set = new Set(data.map(entry => entry.uid));\n        const get_free_uid = () => {\n            for (let i = 0; i < MAX_UID; ++i) {\n                if (!uid_set.has(i)) {\n                    uid_set.add(i);\n                    new_uids.push(i);\n                    return i;\n                }\n            }\n            throw Error(` uid`);\n        };\n        entries.forEach(entry => (entry.uid = get_free_uid()));\n        return [...data, ...entries];\n    });\n    return { entries: updated_entries, new_uids: new_uids };\n}\nasync function deleteLorebookEntries(lorebook, uids) {\n    let deleted = false;\n    const updated_entires = await updateLorebookEntriesWith(lorebook, data => {\n        const removed_data = _.remove(data, entry => uids.includes(entry.uid));\n        deleted = removed_data.length > 0;\n        return data;\n    });\n    return { entries: updated_entires, delete_occurred: deleted };\n}\n//----------------------------------------------------------------------------------------------------------------------\n/** @deprecated  `createLorebookEntries`  */\nasync function createLorebookEntry(lorebook, field_values) {\n    return (await createLorebookEntries(lorebook, [field_values])).new_uids[0];\n}\n/** @deprecated  `deleteLorebookEntries`  */\nasync function deleteLorebookEntry(lorebook, uid) {\n    return (await deleteLorebookEntries(lorebook, [uid])).delete_occurred;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUM7QUFDN0UsQ0FBQztBQUVELGlEQUFpRDtBQUMxQyxLQUFLLFVBQVUsbUJBQW1CLENBQUMsUUFBZ0IsRUFBRSxHQUFXO0lBQ3JFLE9BQU8sQ0FBQyxNQUFNLHFCQUFxQixDQUFDLFFBQVEsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUM7QUFDeEUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9sb3JlYm9va19lbnRyeS50cz8yYWY4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbG9hZEVkaXRvckRlYm91bmNlZCB9IGZyb20gJ0AvY29tcGF0aWJpbGl0eSc7XG5pbXBvcnQgeyBsb2FkV29ybGRJbmZvLCBzYXZlV29ybGRJbmZvLCB3b3JsZF9uYW1lcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3dvcmxkLWluZm8nO1xuXG5pbnRlcmZhY2UgTG9yZWJvb2tFbnRyeSB7XG4gIHVpZDogbnVtYmVyO1xuICBkaXNwbGF5X2luZGV4OiBudW1iZXI7XG5cbiAgY29tbWVudDogc3RyaW5nO1xuICBlbmFibGVkOiBib29sZWFuO1xuICB0eXBlOiAnY29uc3RhbnQnIHwgJ3NlbGVjdGl2ZScgfCAndmVjdG9yaXplZCc7XG4gIHBvc2l0aW9uOlxuICAgIHwgJ2JlZm9yZV9jaGFyYWN0ZXJfZGVmaW5pdGlvbicgLy8g6KeS6Imy5a6a5LmJ5LmL5YmNXG4gICAgfCAnYWZ0ZXJfY2hhcmFjdGVyX2RlZmluaXRpb24nIC8vIOinkuiJsuWumuS5ieS5i+WQjlxuICAgIHwgJ2JlZm9yZV9leGFtcGxlX21lc3NhZ2VzJyAvLyDnpLrkvovmtojmga/kuYvliY1cbiAgICB8ICdhZnRlcl9leGFtcGxlX21lc3NhZ2VzJyAvLyDnpLrkvovmtojmga/kuYvlkI5cbiAgICB8ICdiZWZvcmVfYXV0aG9yX25vdGUnIC8vIOS9nOiAheazqOmHiuS5i+WJjVxuICAgIHwgJ2FmdGVyX2F1dGhvcl9ub3RlJyAvLyDkvZzogIXms6jph4rkuYvlkI5cbiAgICB8ICdhdF9kZXB0aF9hc19zeXN0ZW0nIC8vIEBE4pqZXG4gICAgfCAnYXRfZGVwdGhfYXNfYXNzaXN0YW50JyAvLyBARPCfkaRcbiAgICB8ICdhdF9kZXB0aF9hc191c2VyJzsgLy8gQETwn6SWXG4gIGRlcHRoOiBudW1iZXIgfCBudWxsO1xuICBvcmRlcjogbnVtYmVyO1xuICBwcm9iYWJpbGl0eTogbnVtYmVyO1xuXG4gIC8qKiBAZGVwcmVjYXRlZCDor7fkvb/nlKggYGtleXNgIOS7o+abvyAqL1xuICBrZXk6IHN0cmluZ1tdO1xuICBrZXlzOiBzdHJpbmdbXTtcbiAgbG9naWM6ICdhbmRfYW55JyB8ICdhbmRfYWxsJyB8ICdub3RfYWxsJyB8ICdub3RfYW55JztcbiAgLyoqIEBkZXByZWNhdGVkIOivt+S9v+eUqCBgZmlsdGVyc2Ag5Luj5pu/ICovXG4gIGZpbHRlcjogc3RyaW5nW107XG4gIGZpbHRlcnM6IHN0cmluZ1tdO1xuXG4gIHNjYW5fZGVwdGg6ICdzYW1lX2FzX2dsb2JhbCcgfCBudW1iZXI7XG4gIGNhc2Vfc2Vuc2l0aXZlOiAnc2FtZV9hc19nbG9iYWwnIHwgYm9vbGVhbjtcbiAgbWF0Y2hfd2hvbGVfd29yZHM6ICdzYW1lX2FzX2dsb2JhbCcgfCBib29sZWFuO1xuICB1c2VfZ3JvdXBfc2NvcmluZzogJ3NhbWVfYXNfZ2xvYmFsJyB8IGJvb2xlYW47XG4gIGF1dG9tYXRpb25faWQ6IHN0cmluZyB8IG51bGw7XG5cbiAgZXhjbHVkZV9yZWN1cnNpb246IGJvb2xlYW47XG4gIHByZXZlbnRfcmVjdXJzaW9uOiBib29sZWFuO1xuICBkZWxheV91bnRpbF9yZWN1cnNpb246IGJvb2xlYW4gfCBudW1iZXI7XG5cbiAgY29udGVudDogc3RyaW5nO1xuXG4gIGdyb3VwOiBzdHJpbmc7XG4gIGdyb3VwX3ByaW9yaXRpemVkOiBib29sZWFuO1xuICBncm91cF93ZWlnaHQ6IG51bWJlcjtcbiAgc3RpY2t5OiBudW1iZXIgfCBudWxsO1xuICBjb29sZG93bjogbnVtYmVyIHwgbnVsbDtcbiAgZGVsYXk6IG51bWJlciB8IG51bGw7XG59XG5cbmludGVyZmFjZSBfT3JpZ2luYWxMb3JlYm9va0VudHJ5IHtcbiAgdWlkOiBudW1iZXI7XG4gIGtleTogc3RyaW5nW107XG4gIGtleXNlY29uZGFyeTogc3RyaW5nW107XG4gIGNvbW1lbnQ6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICBjb25zdGFudDogYm9vbGVhbjtcbiAgdmVjdG9yaXplZDogYm9vbGVhbjtcbiAgc2VsZWN0aXZlOiBib29sZWFuO1xuICBzZWxlY3RpdmVMb2dpYzogMCB8IDEgfCAyIHwgMzsgLy8gMDogYW5kX2FueSwgMTogYW5kX2FsbCwgMjogbm90X2FueSwgMzogbm90X2FsbFxuICBhZGRNZW1vOiBib29sZWFuO1xuICBvcmRlcjogbnVtYmVyO1xuICBwb3NpdGlvbjogbnVtYmVyO1xuICBkaXNhYmxlOiBib29sZWFuO1xuICBleGNsdWRlUmVjdXJzaW9uOiBib29sZWFuO1xuICBwcmV2ZW50UmVjdXJzaW9uOiBib29sZWFuO1xuICBtYXRjaFBlcnNvbmFEZXNjcmlwdGlvbjogYm9vbGVhbjtcbiAgbWF0Y2hDaGFyYWN0ZXJEZXNjcmlwdGlvbjogYm9vbGVhbjtcbiAgbWF0Y2hDaGFyYWN0ZXJQZXJzb25hbGl0eTogYm9vbGVhbjtcbiAgbWF0Y2hDaGFyYWN0ZXJEZXB0aFByb21wdDogYm9vbGVhbjtcbiAgbWF0Y2hTY2VuYXJpbzogYm9vbGVhbjtcbiAgbWF0Y2hDcmVhdG9yTm90ZXM6IGJvb2xlYW47XG4gIGRlbGF5VW50aWxSZWN1cnNpb246IG51bWJlcjtcbiAgcHJvYmFiaWxpdHk6IG51bWJlcjtcbiAgdXNlUHJvYmFiaWxpdHk6IGJvb2xlYW47XG4gIGRlcHRoOiBudW1iZXI7XG4gIGdyb3VwOiBzdHJpbmc7XG4gIGdyb3VwT3ZlcnJpZGU6IGJvb2xlYW47XG4gIGdyb3VwV2VpZ2h0OiBudW1iZXI7XG4gIHNjYW5EZXB0aDogbnVtYmVyIHwgbnVsbDtcbiAgY2FzZVNlbnNpdGl2ZTogYm9vbGVhbiB8IG51bGw7XG4gIG1hdGNoV2hvbGVXb3JkczogYm9vbGVhbiB8IG51bGw7XG4gIHVzZUdyb3VwU2NvcmluZzogYm9vbGVhbiB8IG51bGw7XG4gIGF1dG9tYXRpb25JZDogc3RyaW5nO1xuICByb2xlOiAwIHwgMSB8IDI7IC8vIDA6IHN5c3RlbSwgMTogdXNlciwgMjogYXNzaXN0YW50XG4gIHN0aWNreTogbnVtYmVyIHwgbnVsbDtcbiAgY29vbGRvd246IG51bWJlciB8IG51bGw7XG4gIGRlbGF5OiBudW1iZXIgfCBudWxsO1xuICBkaXNwbGF5SW5kZXg6IG51bWJlcjtcbn1cblxuY29uc3QgZGVmYXVsdF9vcmlnaW5hbF9sb3JlYm9va19lbnRyeTogT21pdDxfT3JpZ2luYWxMb3JlYm9va0VudHJ5LCAndWlkJyB8ICdkaXNwbGF5SW5kZXgnPiA9IHtcbiAga2V5OiBbXSxcbiAga2V5c2Vjb25kYXJ5OiBbXSxcbiAgY29tbWVudDogJycsXG4gIGNvbnRlbnQ6ICcnLFxuICBjb25zdGFudDogZmFsc2UsXG4gIHZlY3Rvcml6ZWQ6IGZhbHNlLFxuICBzZWxlY3RpdmU6IHRydWUsXG4gIHNlbGVjdGl2ZUxvZ2ljOiAwLFxuICBhZGRNZW1vOiB0cnVlLFxuICBvcmRlcjogMTAwLFxuICBwb3NpdGlvbjogMCxcbiAgZGlzYWJsZTogZmFsc2UsXG4gIGV4Y2x1ZGVSZWN1cnNpb246IGZhbHNlLFxuICBwcmV2ZW50UmVjdXJzaW9uOiBmYWxzZSxcbiAgbWF0Y2hQZXJzb25hRGVzY3JpcHRpb246IGZhbHNlLFxuICBtYXRjaENoYXJhY3RlckRlc2NyaXB0aW9uOiBmYWxzZSxcbiAgbWF0Y2hDaGFyYWN0ZXJQZXJzb25hbGl0eTogZmFsc2UsXG4gIG1hdGNoQ2hhcmFjdGVyRGVwdGhQcm9tcHQ6IGZhbHNlLFxuICBtYXRjaFNjZW5hcmlvOiBmYWxzZSxcbiAgbWF0Y2hDcmVhdG9yTm90ZXM6IGZhbHNlLFxuICBkZWxheVVudGlsUmVjdXJzaW9uOiAwLFxuICBwcm9iYWJpbGl0eTogMTAwLFxuICB1c2VQcm9iYWJpbGl0eTogdHJ1ZSxcbiAgZGVwdGg6IDQsXG4gIGdyb3VwOiAnJyxcbiAgZ3JvdXBPdmVycmlkZTogZmFsc2UsXG4gIGdyb3VwV2VpZ2h0OiAxMDAsXG4gIHNjYW5EZXB0aDogbnVsbCxcbiAgY2FzZVNlbnNpdGl2ZTogbnVsbCxcbiAgbWF0Y2hXaG9sZVdvcmRzOiBudWxsLFxuICB1c2VHcm91cFNjb3Jpbmc6IG51bGwsXG4gIGF1dG9tYXRpb25JZDogJycsXG4gIHJvbGU6IDAsXG4gIHN0aWNreTogbnVsbCxcbiAgY29vbGRvd246IG51bGwsXG4gIGRlbGF5OiBudWxsLFxufTtcblxuZnVuY3Rpb24gdG9Mb3JlYm9va0VudHJ5KGVudHJ5OiBfT3JpZ2luYWxMb3JlYm9va0VudHJ5KTogTG9yZWJvb2tFbnRyeSB7XG4gIHJldHVybiB7XG4gICAgdWlkOiBlbnRyeS51aWQsXG4gICAgZGlzcGxheV9pbmRleDogZW50cnkuZGlzcGxheUluZGV4LFxuXG4gICAgY29tbWVudDogZW50cnkuY29tbWVudCxcbiAgICBlbmFibGVkOiAhZW50cnkuZGlzYWJsZSxcbiAgICB0eXBlOiBlbnRyeS5jb25zdGFudCA/ICdjb25zdGFudCcgOiBlbnRyeS52ZWN0b3JpemVkID8gJ3ZlY3Rvcml6ZWQnIDogJ3NlbGVjdGl2ZScsXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHBvc2l0aW9uOlxuICAgICAge1xuICAgICAgICAwOiAnYmVmb3JlX2NoYXJhY3Rlcl9kZWZpbml0aW9uJyxcbiAgICAgICAgMTogJ2FmdGVyX2NoYXJhY3Rlcl9kZWZpbml0aW9uJyxcbiAgICAgICAgNTogJ2JlZm9yZV9leGFtcGxlX21lc3NhZ2VzJyxcbiAgICAgICAgNjogJ2FmdGVyX2V4YW1wbGVfbWVzc2FnZXMnLFxuICAgICAgICAyOiAnYmVmb3JlX2F1dGhvcl9ub3RlJyxcbiAgICAgICAgMzogJ2FmdGVyX2F1dGhvcl9ub3RlJyxcbiAgICAgIH1bZW50cnkucG9zaXRpb25dID8/XG4gICAgICAoZW50cnkucm9sZSA9PT0gMCA/ICdhdF9kZXB0aF9hc19zeXN0ZW0nIDogZW50cnkucm9sZSA9PT0gMSA/ICdhdF9kZXB0aF9hc191c2VyJyA6ICdhdF9kZXB0aF9hc19hc3Npc3RhbnQnKSxcbiAgICBkZXB0aDogZW50cnkucG9zaXRpb24gPT09IDQgPyBlbnRyeS5kZXB0aCA6IG51bGwsXG4gICAgb3JkZXI6IGVudHJ5Lm9yZGVyLFxuICAgIHByb2JhYmlsaXR5OiBlbnRyeS5wcm9iYWJpbGl0eSxcblxuICAgIGtleTogZW50cnkua2V5LFxuICAgIGtleXM6IGVudHJ5LmtleSxcbiAgICBsb2dpYzoge1xuICAgICAgMDogJ2FuZF9hbnknLFxuICAgICAgMTogJ2FuZF9hbGwnLFxuICAgICAgMjogJ25vdF9hbnknLFxuICAgICAgMzogJ25vdF9hbGwnLFxuICAgIH1bZW50cnkuc2VsZWN0aXZlTG9naWMgYXMgbnVtYmVyXSBhcyAnYW5kX2FueScgfCAnYW5kX2FsbCcgfCAnbm90X2FueScgfCAnbm90X2FsbCcsXG4gICAgZmlsdGVyOiBlbnRyeS5rZXlzZWNvbmRhcnksXG4gICAgZmlsdGVyczogZW50cnkua2V5c2Vjb25kYXJ5LFxuXG4gICAgc2Nhbl9kZXB0aDogZW50cnkuc2NhbkRlcHRoID8/ICdzYW1lX2FzX2dsb2JhbCcsXG4gICAgY2FzZV9zZW5zaXRpdmU6IGVudHJ5LmNhc2VTZW5zaXRpdmUgPz8gJ3NhbWVfYXNfZ2xvYmFsJyxcbiAgICBtYXRjaF93aG9sZV93b3JkczogZW50cnkubWF0Y2hXaG9sZVdvcmRzID8/ICdzYW1lX2FzX2dsb2JhbCcsXG4gICAgdXNlX2dyb3VwX3Njb3Jpbmc6IGVudHJ5LnVzZUdyb3VwU2NvcmluZyA/PyAnc2FtZV9hc19nbG9iYWwnLFxuICAgIGF1dG9tYXRpb25faWQ6IGVudHJ5LmF1dG9tYXRpb25JZCB8fCBudWxsLFxuXG4gICAgZXhjbHVkZV9yZWN1cnNpb246IGVudHJ5LmV4Y2x1ZGVSZWN1cnNpb24sXG4gICAgcHJldmVudF9yZWN1cnNpb246IGVudHJ5LnByZXZlbnRSZWN1cnNpb24sXG4gICAgZGVsYXlfdW50aWxfcmVjdXJzaW9uOiBlbnRyeS5kZWxheVVudGlsUmVjdXJzaW9uLFxuXG4gICAgY29udGVudDogZW50cnkuY29udGVudCxcblxuICAgIGdyb3VwOiBlbnRyeS5ncm91cCxcbiAgICBncm91cF9wcmlvcml0aXplZDogZW50cnkuZ3JvdXBPdmVycmlkZSxcbiAgICBncm91cF93ZWlnaHQ6IGVudHJ5Lmdyb3VwV2VpZ2h0LFxuICAgIHN0aWNreTogZW50cnkuc3RpY2t5IHx8IG51bGwsXG4gICAgY29vbGRvd246IGVudHJ5LmNvb2xkb3duIHx8IG51bGwsXG4gICAgZGVsYXk6IGVudHJ5LmRlbGF5IHx8IG51bGwsXG4gIH07XG59XG5cbmludGVyZmFjZSBHZXRMb3JlYm9va0VudHJpZXNPcHRpb24ge1xuICBmaWx0ZXI/OiAnbm9uZScgfCBQYXJ0aWFsPExvcmVib29rRW50cnk+O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TG9yZWJvb2tFbnRyaWVzKFxuICBsb3JlYm9vazogc3RyaW5nLFxuICB7IGZpbHRlciA9ICdub25lJyB9OiBHZXRMb3JlYm9va0VudHJpZXNPcHRpb24gPSB7fSxcbik6IFByb21pc2U8TG9yZWJvb2tFbnRyeVtdPiB7XG4gIGlmICghd29ybGRfbmFtZXMuaW5jbHVkZXMobG9yZWJvb2spKSB7XG4gICAgdGhyb3cgRXJyb3IoYOacquiDveaJvuWIsOS4lueVjOS5piAnJHtsb3JlYm9va30nYCk7XG4gIH1cblxuICAvLyBAdHMtaWdub3JlXG4gIGxldCBlbnRyaWVzOiBMb3JlYm9va0VudHJ5W10gPSBPYmplY3QudmFsdWVzKChhd2FpdCBsb2FkV29ybGRJbmZvKGxvcmVib29rKSkuZW50cmllcykubWFwKHRvTG9yZWJvb2tFbnRyeSk7XG4gIGlmIChmaWx0ZXIgIT09ICdub25lJykge1xuICAgIGVudHJpZXMgPSBlbnRyaWVzLmZpbHRlcihlbnRyeSA9PlxuICAgICAgT2JqZWN0LmVudHJpZXMoZmlsdGVyKS5ldmVyeSgoW2ZpZWxkLCBleHBlY3RlZF92YWx1ZV0pID0+IHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBlbnRyeV92YWx1ZSA9IGVudHJ5W2ZpZWxkXTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZW50cnlfdmFsdWUpKSB7XG4gICAgICAgICAgcmV0dXJuIChleHBlY3RlZF92YWx1ZSBhcyBzdHJpbmdbXSkuZXZlcnkodmFsdWUgPT4gZW50cnlfdmFsdWUuaW5jbHVkZXModmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGVudHJ5X3ZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHJldHVybiBlbnRyeV92YWx1ZS5pbmNsdWRlcyhleHBlY3RlZF92YWx1ZSBhcyBzdHJpbmcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbnRyeV92YWx1ZSA9PT0gZXhwZWN0ZWRfdmFsdWU7XG4gICAgICB9KSxcbiAgICApO1xuICB9XG5cbiAgY29uc29sZS5pbmZvKGDojrflj5bkuJbnlYzkuaYgJyR7bG9yZWJvb2t9JyDkuK3nmoTmnaHnm64sIOmAiemhuTogJHtKU09OLnN0cmluZ2lmeSh7IGZpbHRlciB9KX1gKTtcbiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZShlbnRyaWVzKTtcbn1cblxuZnVuY3Rpb24gZnJvbVBhcnRpYWxMb3JlYm9va0VudHJ5KFxuICBlbnRyeTogUGljazxMb3JlYm9va0VudHJ5LCAndWlkJyB8ICdkaXNwbGF5X2luZGV4Jz4gJiBQYXJ0aWFsPExvcmVib29rRW50cnk+LFxuKTogUGljazxfT3JpZ2luYWxMb3JlYm9va0VudHJ5LCAndWlkJyB8ICdkaXNwbGF5SW5kZXgnPiAmIFBhcnRpYWw8X09yaWdpbmFsTG9yZWJvb2tFbnRyeT4ge1xuICBpZiAoXy5oYXMoZW50cnksICdrZXknKSAmJiAhXy5oYXMoZW50cnksICdrZXlzJykpIHtcbiAgICBfLnNldChlbnRyeSwgJ2tleXMnLCBlbnRyeS5rZXkpO1xuICB9XG4gIGlmIChfLmhhcyhlbnRyeSwgJ2ZpbHRlcicpICYmICFfLmhhcyhlbnRyeSwgJ2ZpbHRlcnMnKSkge1xuICAgIF8uc2V0KGVudHJ5LCAnZmlsdGVycycsIGVudHJ5LmZpbHRlcik7XG4gIH1cblxuICBjb25zdCB0cmFuc2Zvcm1lcnMgPSB7XG4gICAgdWlkOiAodmFsdWU6IExvcmVib29rRW50cnlbJ3VpZCddKSA9PiAoeyB1aWQ6IHZhbHVlIH0pLFxuICAgIGRpc3BsYXlfaW5kZXg6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnZGlzcGxheV9pbmRleCddKSA9PiAoeyBkaXNwbGF5SW5kZXg6IHZhbHVlIH0pLFxuXG4gICAgY29tbWVudDogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wydjb21tZW50J10pID0+ICh7IGNvbW1lbnQ6IHZhbHVlIH0pLFxuICAgIGVuYWJsZWQ6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnZW5hYmxlZCddKSA9PiAoeyBkaXNhYmxlOiAhdmFsdWUgfSksXG4gICAgdHlwZTogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wyd0eXBlJ10pID0+ICh7XG4gICAgICBjb25zdGFudDogdmFsdWUgPT09ICdjb25zdGFudCcsXG4gICAgICB2ZWN0b3JpemVkOiB2YWx1ZSA9PT0gJ3ZlY3Rvcml6ZWQnLFxuICAgIH0pLFxuICAgIHBvc2l0aW9uOiAodmFsdWU6IExvcmVib29rRW50cnlbJ3Bvc2l0aW9uJ10pID0+ICh7XG4gICAgICBwb3NpdGlvbjoge1xuICAgICAgICBiZWZvcmVfY2hhcmFjdGVyX2RlZmluaXRpb246IDAsXG4gICAgICAgIGFmdGVyX2NoYXJhY3Rlcl9kZWZpbml0aW9uOiAxLFxuICAgICAgICBiZWZvcmVfZXhhbXBsZV9tZXNzYWdlczogNSxcbiAgICAgICAgYWZ0ZXJfZXhhbXBsZV9tZXNzYWdlczogNixcbiAgICAgICAgYmVmb3JlX2F1dGhvcl9ub3RlOiAyLFxuICAgICAgICBhZnRlcl9hdXRob3Jfbm90ZTogMyxcbiAgICAgICAgYXRfZGVwdGhfYXNfc3lzdGVtOiA0LFxuICAgICAgICBhdF9kZXB0aF9hc191c2VyOiA0LFxuICAgICAgICBhdF9kZXB0aF9hc19hc3Npc3RhbnQ6IDQsXG4gICAgICB9W3ZhbHVlXSxcbiAgICAgIHJvbGU6XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAge1xuICAgICAgICAgIGF0X2RlcHRoX2FzX3N5c3RlbTogMCxcbiAgICAgICAgICBhdF9kZXB0aF9hc191c2VyOiAxLFxuICAgICAgICAgIGF0X2RlcHRoX2FzX2Fzc2lzdGFudDogMixcbiAgICAgICAgfVt2YWx1ZV0gPz8gbnVsbCxcbiAgICB9KSxcbiAgICBkZXB0aDogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydkZXB0aCddKSA9PiAoeyBkZXB0aDogdmFsdWUgPT09IG51bGwgPyA0IDogdmFsdWUgfSksXG4gICAgb3JkZXI6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnb3JkZXInXSkgPT4gKHsgb3JkZXI6IHZhbHVlIH0pLFxuICAgIHByb2JhYmlsaXR5OiAodmFsdWU6IExvcmVib29rRW50cnlbJ3Byb2JhYmlsaXR5J10pID0+ICh7IHByb2JhYmlsaXR5OiB2YWx1ZSB9KSxcblxuICAgIGtleXM6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsna2V5cyddKSA9PiAoeyBrZXk6IHZhbHVlIH0pLFxuICAgIGxvZ2ljOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2xvZ2ljJ10pID0+ICh7XG4gICAgICBzZWxlY3RpdmVMb2dpYzoge1xuICAgICAgICBhbmRfYW55OiAwLFxuICAgICAgICBhbmRfYWxsOiAxLFxuICAgICAgICBub3RfYW55OiAyLFxuICAgICAgICBub3RfYWxsOiAzLFxuICAgICAgfVt2YWx1ZV0sXG4gICAgfSksXG4gICAgZmlsdGVyczogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydmaWx0ZXInXSkgPT4gKHsga2V5c2Vjb25kYXJ5OiB2YWx1ZSB9KSxcblxuICAgIHNjYW5fZGVwdGg6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnc2Nhbl9kZXB0aCddKSA9PiAoeyBzY2FuRGVwdGg6IHZhbHVlID09PSAnc2FtZV9hc19nbG9iYWwnID8gbnVsbCA6IHZhbHVlIH0pLFxuICAgIGNhc2Vfc2Vuc2l0aXZlOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2Nhc2Vfc2Vuc2l0aXZlJ10pID0+ICh7XG4gICAgICBjYXNlU2Vuc2l0aXZlOiB2YWx1ZSA9PT0gJ3NhbWVfYXNfZ2xvYmFsJyA/IG51bGwgOiB2YWx1ZSxcbiAgICB9KSxcbiAgICBtYXRjaF93aG9sZV93b3JkczogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydtYXRjaF93aG9sZV93b3JkcyddKSA9PiAoe1xuICAgICAgbWF0Y2hXaG9sZVdvcmRzOiB2YWx1ZSA9PT0gJ3NhbWVfYXNfZ2xvYmFsJyA/IG51bGwgOiB2YWx1ZSxcbiAgICB9KSxcbiAgICB1c2VfZ3JvdXBfc2NvcmluZzogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wyd1c2VfZ3JvdXBfc2NvcmluZyddKSA9PiAoe1xuICAgICAgdXNlR3JvdXBTY29yaW5nOiB2YWx1ZSA9PT0gJ3NhbWVfYXNfZ2xvYmFsJyA/IG51bGwgOiB2YWx1ZSxcbiAgICB9KSxcbiAgICBhdXRvbWF0aW9uX2lkOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2F1dG9tYXRpb25faWQnXSkgPT4gKHsgYXV0b21hdGlvbklkOiB2YWx1ZSA9PT0gbnVsbCA/ICcnIDogdmFsdWUgfSksXG5cbiAgICBleGNsdWRlX3JlY3Vyc2lvbjogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydleGNsdWRlX3JlY3Vyc2lvbiddKSA9PiAoeyBleGNsdWRlUmVjdXJzaW9uOiB2YWx1ZSB9KSxcbiAgICBwcmV2ZW50X3JlY3Vyc2lvbjogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydwcmV2ZW50X3JlY3Vyc2lvbiddKSA9PiAoeyBwcmV2ZW50UmVjdXJzaW9uOiB2YWx1ZSB9KSxcbiAgICBkZWxheV91bnRpbF9yZWN1cnNpb246ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnZGVsYXlfdW50aWxfcmVjdXJzaW9uJ10pID0+ICh7IGRlbGF5VW50aWxSZWN1cnNpb246IHZhbHVlIH0pLFxuXG4gICAgY29udGVudDogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wydjb250ZW50J10pID0+ICh7IGNvbnRlbnQ6IHZhbHVlIH0pLFxuXG4gICAgZ3JvdXA6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnZ3JvdXAnXSkgPT4gKHsgZ3JvdXA6IHZhbHVlIH0pLFxuICAgIGdyb3VwX3ByaW9yaXRpemVkOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2dyb3VwX3ByaW9yaXRpemVkJ10pID0+ICh7IGdyb3VwT3ZlcnJpZGU6IHZhbHVlIH0pLFxuICAgIGdyb3VwX3dlaWdodDogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wydncm91cF93ZWlnaHQnXSkgPT4gKHsgZ3JvdXBXZWlnaHQ6IHZhbHVlIH0pLFxuICAgIHN0aWNreTogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydzdGlja3knXSkgPT4gKHsgc3RpY2t5OiB2YWx1ZSA9PT0gbnVsbCA/IDAgOiB2YWx1ZSB9KSxcbiAgICBjb29sZG93bjogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wydjb29sZG93biddKSA9PiAoeyBjb29sZG93bjogdmFsdWUgPT09IG51bGwgPyAwIDogdmFsdWUgfSksXG4gICAgZGVsYXk6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnZGVsYXknXSkgPT4gKHsgZGVsYXk6IHZhbHVlID09PSBudWxsID8gMCA6IHZhbHVlIH0pLFxuICB9O1xuXG4gIHJldHVybiBfLm1lcmdlKFxuICAgIHt9LFxuICAgIGRlZmF1bHRfb3JpZ2luYWxfbG9yZWJvb2tfZW50cnksXG4gICAgLi4uT2JqZWN0LmVudHJpZXMoZW50cnkpXG4gICAgICAuZmlsdGVyKChbXywgdmFsdWVdKSA9PiB2YWx1ZSAhPT0gdW5kZWZpbmVkKVxuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgLm1hcCgoW2tleSwgdmFsdWVdKSA9PiB0cmFuc2Zvcm1lcnNba2V5XT8uKHZhbHVlKSksXG4gICk7XG59XG5cbmNvbnN0IE1BWF9VSUQgPSAxXzAwMF8wMDA7XG5cbmZ1bmN0aW9uIGhhbmRsZUxvcmVib29rRW50cmllc0NvbGxpc2lvbihcbiAgZW50cmllczogUGFydGlhbDxMb3JlYm9va0VudHJ5PltdLFxuKTogQXJyYXk8UGljazxMb3JlYm9va0VudHJ5LCAndWlkJyB8ICdkaXNwbGF5X2luZGV4Jz4gJiBQYXJ0aWFsPExvcmVib29rRW50cnk+PiB7XG4gIGNvbnN0IHVpZF9zZXQgPSBuZXcgU2V0PG51bWJlcj4oKTtcbiAgY29uc3QgaGFuZGxlX3VpZF9jb2xsaXNpb24gPSAoaW5kZXg6IG51bWJlciB8IHVuZGVmaW5lZCkgPT4ge1xuICAgIGlmIChpbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBpbmRleCA9IF8ucmFuZG9tKDAsIE1BWF9VSUQgLSAxKTtcbiAgICB9XG5cbiAgICBsZXQgaSA9IDE7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIGlmICghdWlkX3NldC5oYXMoaW5kZXgpKSB7XG4gICAgICAgIHVpZF9zZXQuYWRkKGluZGV4KTtcbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgfVxuXG4gICAgICBpbmRleCA9IChpbmRleCArIGkgKiBpKSAlIE1BWF9VSUQ7XG4gICAgICArK2k7XG4gICAgfVxuICB9O1xuXG4gIGxldCBtYXhfZGlzcGxheV9pbmRleCA9IF8ubWF4KGVudHJpZXMubWFwKGVudHJ5ID0+IGVudHJ5LmRpc3BsYXlfaW5kZXggPz8gLTEpKSA/PyAtMTtcbiAgcmV0dXJuIGVudHJpZXMubWFwKGVudHJ5ID0+ICh7XG4gICAgLi4uZW50cnksXG4gICAgdWlkOiBoYW5kbGVfdWlkX2NvbGxpc2lvbihlbnRyeS51aWQpLFxuICAgIGRpc3BsYXlfaW5kZXg6IGVudHJ5LmRpc3BsYXlfaW5kZXggPz8gKyttYXhfZGlzcGxheV9pbmRleCxcbiAgfSkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVwbGFjZUxvcmVib29rRW50cmllcyhsb3JlYm9vazogc3RyaW5nLCBlbnRyaWVzOiBQYXJ0aWFsPExvcmVib29rRW50cnk+W10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCF3b3JsZF9uYW1lcy5pbmNsdWRlcyhsb3JlYm9vaykpIHtcbiAgICB0aHJvdyBFcnJvcihg5pyq6IO95om+5Yiw5LiW55WM5LmmICcke2xvcmVib29rfSdgKTtcbiAgfVxuXG4gIGNvbnN0IGRhdGEgPSB7XG4gICAgZW50cmllczogXy5tZXJnZShcbiAgICAgIHt9LFxuICAgICAgLi4uaGFuZGxlTG9yZWJvb2tFbnRyaWVzQ29sbGlzaW9uKGVudHJpZXMpXG4gICAgICAgIC5tYXAoZnJvbVBhcnRpYWxMb3JlYm9va0VudHJ5KVxuICAgICAgICAubWFwKGVudHJ5ID0+ICh7IFtlbnRyeS51aWRdOiBlbnRyeSB9KSksXG4gICAgKSxcbiAgfTtcbiAgYXdhaXQgc2F2ZVdvcmxkSW5mbyhsb3JlYm9vaywgZGF0YSk7XG4gIHJlbG9hZEVkaXRvckRlYm91bmNlZChsb3JlYm9vayk7XG5cbiAgY29uc29sZS5pbmZvKGDmm7TmlrDkuJbnlYzkuaYgJyR7bG9yZWJvb2t9JyDkuK3nmoTmnaHnm65gKTtcbn1cblxudHlwZSBMb3JlYm9va0VudHJpZXNVcGRhdGVyID1cbiAgfCAoKGVudHJpZXM6IExvcmVib29rRW50cnlbXSkgPT4gUGFydGlhbDxMb3JlYm9va0VudHJ5PltdKVxuICB8ICgoZW50cmllczogTG9yZWJvb2tFbnRyeVtdKSA9PiBQcm9taXNlPFBhcnRpYWw8TG9yZWJvb2tFbnRyeT5bXT4pO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlTG9yZWJvb2tFbnRyaWVzV2l0aChcbiAgbG9yZWJvb2s6IHN0cmluZyxcbiAgdXBkYXRlcjogTG9yZWJvb2tFbnRyaWVzVXBkYXRlcixcbik6IFByb21pc2U8TG9yZWJvb2tFbnRyeVtdPiB7XG4gIGNvbnNvbGUuaW5mbyhg5a+55LiW55WM5LmmICcke2xvcmVib29rfScg5Lit55qE5p2h55uu6L+b6KGM5pu05pawYCk7XG4gIGF3YWl0IHJlcGxhY2VMb3JlYm9va0VudHJpZXMobG9yZWJvb2ssIGF3YWl0IHVwZGF0ZXIoYXdhaXQgZ2V0TG9yZWJvb2tFbnRyaWVzKGxvcmVib29rKSkpO1xuICByZXR1cm4gZ2V0TG9yZWJvb2tFbnRyaWVzKGxvcmVib29rKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldExvcmVib29rRW50cmllcyhcbiAgbG9yZWJvb2s6IHN0cmluZyxcbiAgZW50cmllczogQXJyYXk8UGljazxMb3JlYm9va0VudHJ5LCAndWlkJz4gJiBQYXJ0aWFsPExvcmVib29rRW50cnk+Pixcbik6IFByb21pc2U8TG9yZWJvb2tFbnRyeVtdPiB7XG4gIHJldHVybiBhd2FpdCB1cGRhdGVMb3JlYm9va0VudHJpZXNXaXRoKGxvcmVib29rLCBkYXRhID0+IHtcbiAgICBmb3IgKGNvbnN0IGVudHJ5X3RvX3NldCBvZiBlbnRyaWVzKSB7XG4gICAgICBjb25zdCBkYXRhX2VudHJ5ID0gZGF0YS5maW5kKGVudHJ5ID0+IGVudHJ5LnVpZCA9PT0gZW50cnlfdG9fc2V0LnVpZCk7XG4gICAgICBpZiAoZGF0YV9lbnRyeSkge1xuICAgICAgICBfLm1lcmdlKGRhdGFfZW50cnksIGVudHJ5X3RvX3NldCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUxvcmVib29rRW50cmllcyhcbiAgbG9yZWJvb2s6IHN0cmluZyxcbiAgZW50cmllczogUGFydGlhbDxMb3JlYm9va0VudHJ5PltdLFxuKTogUHJvbWlzZTx7IGVudHJpZXM6IExvcmVib29rRW50cnlbXTsgbmV3X3VpZHM6IG51bWJlcltdIH0+IHtcbiAgY29uc3QgbmV3X3VpZHM6IG51bWJlcltdID0gW107XG4gIGNvbnN0IHVwZGF0ZWRfZW50cmllcyA9IGF3YWl0IHVwZGF0ZUxvcmVib29rRW50cmllc1dpdGgobG9yZWJvb2ssIGRhdGEgPT4ge1xuICAgIGNvbnN0IHVpZF9zZXQgPSBuZXcgU2V0KGRhdGEubWFwKGVudHJ5ID0+IGVudHJ5LnVpZCkpO1xuICAgIGNvbnN0IGdldF9mcmVlX3VpZCA9ICgpID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTUFYX1VJRDsgKytpKSB7XG4gICAgICAgIGlmICghdWlkX3NldC5oYXMoaSkpIHtcbiAgICAgICAgICB1aWRfc2V0LmFkZChpKTtcbiAgICAgICAgICBuZXdfdWlkcy5wdXNoKGkpO1xuICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aHJvdyBFcnJvcihg5peg5rOV5om+5Yiw5Y+v55So55qE5LiW55WM5Lmm5p2h55uuIHVpZGApO1xuICAgIH07XG5cbiAgICBlbnRyaWVzLmZvckVhY2goZW50cnkgPT4gKGVudHJ5LnVpZCA9IGdldF9mcmVlX3VpZCgpKSk7XG4gICAgcmV0dXJuIFsuLi5kYXRhLCAuLi5lbnRyaWVzXTtcbiAgfSk7XG4gIHJldHVybiB7IGVudHJpZXM6IHVwZGF0ZWRfZW50cmllcywgbmV3X3VpZHM6IG5ld191aWRzIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVMb3JlYm9va0VudHJpZXMoXG4gIGxvcmVib29rOiBzdHJpbmcsXG4gIHVpZHM6IG51bWJlcltdLFxuKTogUHJvbWlzZTx7IGVudHJpZXM6IExvcmVib29rRW50cnlbXTsgZGVsZXRlX29jY3VycmVkOiBib29sZWFuIH0+IHtcbiAgbGV0IGRlbGV0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgY29uc3QgdXBkYXRlZF9lbnRpcmVzID0gYXdhaXQgdXBkYXRlTG9yZWJvb2tFbnRyaWVzV2l0aChsb3JlYm9vaywgZGF0YSA9PiB7XG4gICAgY29uc3QgcmVtb3ZlZF9kYXRhID0gXy5yZW1vdmUoZGF0YSwgZW50cnkgPT4gdWlkcy5pbmNsdWRlcyhlbnRyeS51aWQpKTtcbiAgICBkZWxldGVkID0gcmVtb3ZlZF9kYXRhLmxlbmd0aCA+IDA7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH0pO1xuICByZXR1cm4geyBlbnRyaWVzOiB1cGRhdGVkX2VudGlyZXMsIGRlbGV0ZV9vY2N1cnJlZDogZGVsZXRlZCB9O1xufVxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKiBAZGVwcmVjYXRlZCDor7fkvb/nlKggYGNyZWF0ZUxvcmVib29rRW50cmllc2Ag5Luj5pu/ICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlTG9yZWJvb2tFbnRyeShsb3JlYm9vazogc3RyaW5nLCBmaWVsZF92YWx1ZXM6IFBhcnRpYWw8TG9yZWJvb2tFbnRyeT4pOiBQcm9taXNlPG51bWJlcj4ge1xuICByZXR1cm4gKGF3YWl0IGNyZWF0ZUxvcmVib29rRW50cmllcyhsb3JlYm9vaywgW2ZpZWxkX3ZhbHVlc10pKS5uZXdfdWlkc1swXTtcbn1cblxuLyoqIEBkZXByZWNhdGVkIOivt+S9v+eUqCBgZGVsZXRlTG9yZWJvb2tFbnRyaWVzYCDku6Pmm78gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVMb3JlYm9va0VudHJ5KGxvcmVib29rOiBzdHJpbmcsIHVpZDogbnVtYmVyKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHJldHVybiAoYXdhaXQgZGVsZXRlTG9yZWJvb2tFbnRyaWVzKGxvcmVib29rLCBbdWlkXSkpLmRlbGV0ZV9vY2N1cnJlZDtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/lorebook_entry.ts\n")},"./src/function/slash.ts":
/*!*******************************!*\
  !*** ./src/function/slash.ts ***!
  \*******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   triggerSlash: () => (/* binding */ triggerSlash)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_slash_commands__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands */ \"@sillytavern/scripts/slash-commands\");\n\nasync function triggerSlash(command) {\n    const result = await (0,_sillytavern_scripts_slash_commands__WEBPACK_IMPORTED_MODULE_0__.executeSlashCommandsWithOptions)(command);\n    if (result.isError) {\n        throw Error(` Slash  '${command}' : ${result.errorMessage}`);\n    }\n    console.info(` Slash : ${command}`);\n    return result.pipe;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vc2xhc2gudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBc0Y7QUFFL0UsS0FBSyxVQUFVLFlBQVksQ0FBQyxPQUFlO0lBQ2hELE1BQU0sTUFBTSxHQUFHLE1BQU0sb0dBQStCLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDOUQsSUFBSSxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDbkIsTUFBTSxLQUFLLENBQUMsZ0JBQWdCLE9BQU8sVUFBVSxNQUFNLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQztJQUN0RSxDQUFDO0lBRUQsT0FBTyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsT0FBTyxFQUFFLENBQUMsQ0FBQztJQUN4QyxPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUM7QUFDckIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9zbGFzaC50cz8zNWQwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4ZWN1dGVTbGFzaENvbW1hbmRzV2l0aE9wdGlvbnMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9zbGFzaC1jb21tYW5kcyc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0cmlnZ2VyU2xhc2goY29tbWFuZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0ZVNsYXNoQ29tbWFuZHNXaXRoT3B0aW9ucyhjb21tYW5kKTtcbiAgaWYgKHJlc3VsdC5pc0Vycm9yKSB7XG4gICAgdGhyb3cgRXJyb3IoYOi/kOihjCBTbGFzaCDlkb3ku6QgJyR7Y29tbWFuZH0nIOaXtuWHuumUmTogJHtyZXN1bHQuZXJyb3JNZXNzYWdlfWApO1xuICB9XG5cbiAgY29uc29sZS5pbmZvKGDov5DooYwgU2xhc2gg5ZG95LukOiAke2NvbW1hbmR9YCk7XG4gIHJldHVybiByZXN1bHQucGlwZTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/slash.ts\n")},"./src/function/tavern_regex.ts":
/*!**************************************!*\
  !*** ./src/function/tavern_regex.ts ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCharacterRegexes: () => (/* binding */ getCharacterRegexes),\n/* harmony export */   getGlobalRegexes: () => (/* binding */ getGlobalRegexes),\n/* harmony export */   getTavernRegexes: () => (/* binding */ getTavernRegexes),\n/* harmony export */   isCharacterTavernRegexEnabled: () => (/* binding */ isCharacterTavernRegexEnabled),\n/* harmony export */   isCharacterTavernRegexesEnabled: () => (/* binding */ isCharacterTavernRegexesEnabled),\n/* harmony export */   replaceTavernRegexes: () => (/* binding */ replaceTavernRegexes),\n/* harmony export */   updateTavernRegexesWith: () => (/* binding */ updateTavernRegexesWith)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions/regex/engine */ \"@sillytavern/scripts/extensions/regex/engine\");\n\n\n\nfunction isCharacterTavernRegexEnabled() {\n    // @ts-ignore 2345\n    return _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings?.character_allowed_regex?.includes(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters?.[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.avatar);\n}\nfunction getGlobalRegexes() {\n    return _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings.regex ?? [];\n}\nfunction getCharacterRegexes() {\n    // @ts-ignore\n    return _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.regex_scripts ?? [];\n}\nfunction toTavernRegex(regex_script_data, scope) {\n    return {\n        id: regex_script_data.id,\n        script_name: regex_script_data.scriptName,\n        enabled: !regex_script_data.disabled,\n        run_on_edit: regex_script_data.runOnEdit,\n        scope: scope,\n        find_regex: regex_script_data.findRegex,\n        replace_string: regex_script_data.replaceString,\n        source: {\n            user_input: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.USER_INPUT),\n            ai_output: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.AI_OUTPUT),\n            slash_command: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.SLASH_COMMAND),\n            world_info: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.WORLD_INFO),\n        },\n        destination: {\n            display: regex_script_data.markdownOnly,\n            prompt: regex_script_data.promptOnly,\n        },\n        min_depth: typeof regex_script_data.minDepth === 'number' ? regex_script_data.minDepth : null,\n        max_depth: typeof regex_script_data.maxDepth === 'number' ? regex_script_data.maxDepth : null,\n    };\n}\nfunction fromTavernRegex(tavern_regex) {\n    return {\n        id: tavern_regex.id,\n        scriptName: tavern_regex.script_name,\n        disabled: !tavern_regex.enabled,\n        runOnEdit: tavern_regex.run_on_edit,\n        findRegex: tavern_regex.find_regex,\n        replaceString: tavern_regex.replace_string,\n        trimStrings: [], // TODO: handle this?\n        placement: [\n            ...(tavern_regex.source.user_input ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.USER_INPUT] : []),\n            ...(tavern_regex.source.ai_output ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.AI_OUTPUT] : []),\n            ...(tavern_regex.source.slash_command ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.SLASH_COMMAND] : []),\n            ...(tavern_regex.source.world_info ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.WORLD_INFO] : []),\n        ],\n        substituteRegex: 0, // TODO: handle this?\n        // @ts-ignore\n        minDepth: tavern_regex.min_depth,\n        // @ts-ignore\n        maxDepth: tavern_regex.max_depth,\n        markdownOnly: tavern_regex.destination.display,\n        promptOnly: tavern_regex.destination.prompt,\n    };\n}\nfunction isCharacterTavernRegexesEnabled() {\n    const result = isCharacterTavernRegexEnabled();\n    console.info(`${result ? '' : ''}`);\n    return result;\n}\nfunction getTavernRegexes({ scope = 'all', enable_state = 'all' } = {}) {\n    if (!['all', 'enabled', 'disabled'].includes(enable_state)) {\n        throw Error(` enable_state ,  'all', 'enabled'  'disabled', : ${enable_state}`);\n    }\n    if (!['all', 'global', 'character'].includes(scope)) {\n        throw Error(` scope ,  'all', 'global'  'character', : ${scope}`);\n    }\n    let regexes = [];\n    if (scope === 'all' || scope === 'global') {\n        regexes = [...regexes, ...getGlobalRegexes().map(regex => toTavernRegex(regex, 'global'))];\n    }\n    if (scope === 'all' || scope === 'character') {\n        regexes = [...regexes, ...getCharacterRegexes().map(regex => toTavernRegex(regex, 'character'))];\n    }\n    if (enable_state !== 'all') {\n        regexes = regexes.filter(regex => regex.enabled === (enable_state === 'enabled'));\n    }\n    return structuredClone(regexes);\n}\nasync function replaceTavernRegexes(regexes, { scope = 'all' }) {\n    if (!['all', 'global', 'character'].includes(scope)) {\n        throw Error(` scope ,  'all', 'global'  'character', : ${scope}`);\n    }\n    // FIXME: `trimStrings` and `substituteRegex` are not considered\n    const emptied_regexes = regexes.filter(regex => regex.script_name == '');\n    if (emptied_regexes.length > 0) {\n        throw Error(`:\\n${JSON.stringify(emptied_regexes.map(regex => regex.id))}`);\n    }\n    const [global_regexes, character_regexes] = _.partition(regexes, regex => regex.scope === 'global').map(paritioned => paritioned.map(fromTavernRegex));\n    // @ts-ignore\n    const character = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid];\n    if (scope === 'all' || scope === 'global') {\n        _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings.regex = global_regexes;\n    }\n    if (scope === 'all' || scope === 'character') {\n        if (character) {\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].data.extensions.regex_scripts = character_regexes;\n            // @ts-ignore\n            await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid, 'regex_scripts', character_regexes);\n        }\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettings)();\n    if (character) {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    console.info(`\\\n${scope === 'all' || scope === 'global' ? `, :\\n${JSON.stringify(global_regexes)}` : ``}\\\n${scope === 'all' || scope === 'character' ? `, :\\n${JSON.stringify(character_regexes)}` : ``}`);\n}\nasync function updateTavernRegexesWith(updater, { scope = 'all' } = {}) {\n    let regexes = getTavernRegexes({ scope });\n    regexes = await updater(regexes);\n    console.info(`${{ all: '', global: '', character: '' }[scope]}`);\n    await replaceTavernRegexes(regexes, { scope });\n    return regexes;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztJQUNILENBQUM7SUFDRCxNQUFNLGlFQUFZLEVBQUUsQ0FBQztJQUNyQixJQUFJLFNBQVMsRUFBRSxDQUFDO1FBQ2QsTUFBTSx3RUFBbUIsRUFBRSxDQUFDO0lBQzlCLENBQUM7SUFDRCxNQUFNLHNFQUFpQixFQUFFLENBQUM7SUFFMUIsT0FBTyxDQUFDLElBQUksQ0FBQztFQUNiLEtBQUssS0FBSyxLQUFLLElBQUksS0FBSyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsWUFBWSxJQUFJLENBQUMsU0FBUyxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUU7RUFDekYsS0FBSyxLQUFLLEtBQUssSUFBSSxLQUFLLEtBQUssV0FBVyxDQUFDLENBQUMsQ0FBQyxZQUFZLElBQUksQ0FBQyxTQUFTLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQ3JHLENBQUM7QUFNTSxLQUFLLFVBQVUsdUJBQXVCLENBQzNDLE9BQTJCLEVBQzNCLEVBQUUsS0FBSyxHQUFHLEtBQUssS0FBaUMsRUFBRTtJQUVsRCxJQUFJLE9BQU8sR0FBRyxnQkFBZ0IsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDMUMsT0FBTyxHQUFHLE1BQU0sT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2pDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQy9FLE1BQU0sb0JBQW9CLENBQUMsT0FBTyxFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztJQUMvQyxPQUFPLE9BQU8sQ0FBQztBQUNqQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL3RhdmVybl9yZWdleC50cz82ODliIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNoYXJhY3RlcnMsIHJlbG9hZEN1cnJlbnRDaGF0LCBzYXZlQ2hhdENvbmRpdGlvbmFsLCBzYXZlU2V0dGluZ3MsIHRoaXNfY2hpZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgUmVnZXhTY3JpcHREYXRhIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvY2hhci1kYXRhJztcbmltcG9ydCB7IGV4dGVuc2lvbl9zZXR0aW5ncywgd3JpdGVFeHRlbnNpb25GaWVsZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuaW1wb3J0IHsgcmVnZXhfcGxhY2VtZW50IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucy9yZWdleC9lbmdpbmUnO1xuXG5pbnRlcmZhY2UgVGF2ZXJuUmVnZXgge1xuICBpZDogc3RyaW5nO1xuICBzY3JpcHRfbmFtZTogc3RyaW5nO1xuICBlbmFibGVkOiBib29sZWFuO1xuICBydW5fb25fZWRpdDogYm9vbGVhbjtcbiAgc2NvcGU6ICdnbG9iYWwnIHwgJ2NoYXJhY3Rlcic7XG5cbiAgZmluZF9yZWdleDogc3RyaW5nO1xuICByZXBsYWNlX3N0cmluZzogc3RyaW5nO1xuXG4gIHNvdXJjZToge1xuICAgIHVzZXJfaW5wdXQ6IGJvb2xlYW47XG4gICAgYWlfb3V0cHV0OiBib29sZWFuO1xuICAgIHNsYXNoX2NvbW1hbmQ6IGJvb2xlYW47XG4gICAgd29ybGRfaW5mbzogYm9vbGVhbjtcbiAgfTtcblxuICBkZXN0aW5hdGlvbjoge1xuICAgIGRpc3BsYXk6IGJvb2xlYW47XG4gICAgcHJvbXB0OiBib29sZWFuO1xuICB9O1xuXG4gIG1pbl9kZXB0aDogbnVtYmVyIHwgbnVsbDtcbiAgbWF4X2RlcHRoOiBudW1iZXIgfCBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDaGFyYWN0ZXJUYXZlcm5SZWdleEVuYWJsZWQoKTogYm9vbGVhbiB7XG4gIC8vIEB0cy1pZ25vcmUgMjM0NVxuICByZXR1cm4gZXh0ZW5zaW9uX3NldHRpbmdzPy5jaGFyYWN0ZXJfYWxsb3dlZF9yZWdleD8uaW5jbHVkZXMoY2hhcmFjdGVycz8uW3RoaXNfY2hpZF0/LmF2YXRhcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRHbG9iYWxSZWdleGVzKCk6IFJlZ2V4U2NyaXB0RGF0YVtdIHtcbiAgcmV0dXJuIGV4dGVuc2lvbl9zZXR0aW5ncy5yZWdleCA/PyBbXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENoYXJhY3RlclJlZ2V4ZXMoKTogUmVnZXhTY3JpcHREYXRhW10ge1xuICAvLyBAdHMtaWdub3JlXG4gIHJldHVybiBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0/LmRhdGE/LmV4dGVuc2lvbnM/LnJlZ2V4X3NjcmlwdHMgPz8gW107XG59XG5cbmZ1bmN0aW9uIHRvVGF2ZXJuUmVnZXgocmVnZXhfc2NyaXB0X2RhdGE6IFJlZ2V4U2NyaXB0RGF0YSwgc2NvcGU6ICdnbG9iYWwnIHwgJ2NoYXJhY3RlcicpOiBUYXZlcm5SZWdleCB7XG4gIHJldHVybiB7XG4gICAgaWQ6IHJlZ2V4X3NjcmlwdF9kYXRhLmlkLFxuICAgIHNjcmlwdF9uYW1lOiByZWdleF9zY3JpcHRfZGF0YS5zY3JpcHROYW1lLFxuICAgIGVuYWJsZWQ6ICFyZWdleF9zY3JpcHRfZGF0YS5kaXNhYmxlZCxcbiAgICBydW5fb25fZWRpdDogcmVnZXhfc2NyaXB0X2RhdGEucnVuT25FZGl0LFxuICAgIHNjb3BlOiBzY29wZSxcblxuICAgIGZpbmRfcmVnZXg6IHJlZ2V4X3NjcmlwdF9kYXRhLmZpbmRSZWdleCxcbiAgICByZXBsYWNlX3N0cmluZzogcmVnZXhfc2NyaXB0X2RhdGEucmVwbGFjZVN0cmluZyxcblxuICAgIHNvdXJjZToge1xuICAgICAgdXNlcl9pbnB1dDogcmVnZXhfc2NyaXB0X2RhdGEucGxhY2VtZW50LmluY2x1ZGVzKHJlZ2V4X3BsYWNlbWVudC5VU0VSX0lOUFVUKSxcbiAgICAgIGFpX291dHB1dDogcmVnZXhfc2NyaXB0X2RhdGEucGxhY2VtZW50LmluY2x1ZGVzKHJlZ2V4X3BsYWNlbWVudC5BSV9PVVRQVVQpLFxuICAgICAgc2xhc2hfY29tbWFuZDogcmVnZXhfc2NyaXB0X2RhdGEucGxhY2VtZW50LmluY2x1ZGVzKHJlZ2V4X3BsYWNlbWVudC5TTEFTSF9DT01NQU5EKSxcbiAgICAgIHdvcmxkX2luZm86IHJlZ2V4X3NjcmlwdF9kYXRhLnBsYWNlbWVudC5pbmNsdWRlcyhyZWdleF9wbGFjZW1lbnQuV09STERfSU5GTyksXG4gICAgfSxcblxuICAgIGRlc3RpbmF0aW9uOiB7XG4gICAgICBkaXNwbGF5OiByZWdleF9zY3JpcHRfZGF0YS5tYXJrZG93bk9ubHksXG4gICAgICBwcm9tcHQ6IHJlZ2V4X3NjcmlwdF9kYXRhLnByb21wdE9ubHksXG4gICAgfSxcblxuICAgIG1pbl9kZXB0aDogdHlwZW9mIHJlZ2V4X3NjcmlwdF9kYXRhLm1pbkRlcHRoID09PSAnbnVtYmVyJyA/IHJlZ2V4X3NjcmlwdF9kYXRhLm1pbkRlcHRoIDogbnVsbCxcbiAgICBtYXhfZGVwdGg6IHR5cGVvZiByZWdleF9zY3JpcHRfZGF0YS5tYXhEZXB0aCA9PT0gJ251bWJlcicgPyByZWdleF9zY3JpcHRfZGF0YS5tYXhEZXB0aCA6IG51bGwsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGZyb21UYXZlcm5SZWdleCh0YXZlcm5fcmVnZXg6IFRhdmVyblJlZ2V4KTogUmVnZXhTY3JpcHREYXRhIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogdGF2ZXJuX3JlZ2V4LmlkLFxuICAgIHNjcmlwdE5hbWU6IHRhdmVybl9yZWdleC5zY3JpcHRfbmFtZSxcbiAgICBkaXNhYmxlZDogIXRhdmVybl9yZWdleC5lbmFibGVkLFxuICAgIHJ1bk9uRWRpdDogdGF2ZXJuX3JlZ2V4LnJ1bl9vbl9lZGl0LFxuXG4gICAgZmluZFJlZ2V4OiB0YXZlcm5fcmVnZXguZmluZF9yZWdleCxcbiAgICByZXBsYWNlU3RyaW5nOiB0YXZlcm5fcmVnZXgucmVwbGFjZV9zdHJpbmcsXG4gICAgdHJpbVN0cmluZ3M6IFtdLCAvLyBUT0RPOiBoYW5kbGUgdGhpcz9cblxuICAgIHBsYWNlbWVudDogW1xuICAgICAgLi4uKHRhdmVybl9yZWdleC5zb3VyY2UudXNlcl9pbnB1dCA/IFtyZWdleF9wbGFjZW1lbnQuVVNFUl9JTlBVVF0gOiBbXSksXG4gICAgICAuLi4odGF2ZXJuX3JlZ2V4LnNvdXJjZS5haV9vdXRwdXQgPyBbcmVnZXhfcGxhY2VtZW50LkFJX09VVFBVVF0gOiBbXSksXG4gICAgICAuLi4odGF2ZXJuX3JlZ2V4LnNvdXJjZS5zbGFzaF9jb21tYW5kID8gW3JlZ2V4X3BsYWNlbWVudC5TTEFTSF9DT01NQU5EXSA6IFtdKSxcbiAgICAgIC4uLih0YXZlcm5fcmVnZXguc291cmNlLndvcmxkX2luZm8gPyBbcmVnZXhfcGxhY2VtZW50LldPUkxEX0lORk9dIDogW10pLFxuICAgIF0sXG5cbiAgICBzdWJzdGl0dXRlUmVnZXg6IDAsIC8vIFRPRE86IGhhbmRsZSB0aGlzP1xuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIG1pbkRlcHRoOiB0YXZlcm5fcmVnZXgubWluX2RlcHRoLFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBtYXhEZXB0aDogdGF2ZXJuX3JlZ2V4Lm1heF9kZXB0aCxcblxuICAgIG1hcmtkb3duT25seTogdGF2ZXJuX3JlZ2V4LmRlc3RpbmF0aW9uLmRpc3BsYXksXG4gICAgcHJvbXB0T25seTogdGF2ZXJuX3JlZ2V4LmRlc3RpbmF0aW9uLnByb21wdCxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ2hhcmFjdGVyVGF2ZXJuUmVnZXhlc0VuYWJsZWQoKTogYm9vbGVhbiB7XG4gIGNvbnN0IHJlc3VsdCA9IGlzQ2hhcmFjdGVyVGF2ZXJuUmVnZXhFbmFibGVkKCk7XG5cbiAgY29uc29sZS5pbmZvKGDmn6Xor6LliLDlsYDpg6jmraPliJkke3Jlc3VsdCA/ICfooqvlkK/nlKgnIDogJ+iiq+emgeeUqCd9YCk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmludGVyZmFjZSBHZXRUYXZlcm5SZWdleGVzT3B0aW9uIHtcbiAgc2NvcGU/OiAnYWxsJyB8ICdnbG9iYWwnIHwgJ2NoYXJhY3Rlcic7IC8vIOaMieaJgOWcqOWMuuWfn+etm+mAieato+WImVxuICBlbmFibGVfc3RhdGU/OiAnYWxsJyB8ICdlbmFibGVkJyB8ICdkaXNhYmxlZCc7IC8vIOaMieaYr+WQpuiiq+W8gOWQr+etm+mAieato+WImVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGF2ZXJuUmVnZXhlcyh7IHNjb3BlID0gJ2FsbCcsIGVuYWJsZV9zdGF0ZSA9ICdhbGwnIH06IEdldFRhdmVyblJlZ2V4ZXNPcHRpb24gPSB7fSk6IFRhdmVyblJlZ2V4W10ge1xuICBpZiAoIVsnYWxsJywgJ2VuYWJsZWQnLCAnZGlzYWJsZWQnXS5pbmNsdWRlcyhlbmFibGVfc3RhdGUpKSB7XG4gICAgdGhyb3cgRXJyb3IoYOaPkOS+m+eahCBlbmFibGVfc3RhdGUg5peg5pWILCDor7fmj5DkvpsgJ2FsbCcsICdlbmFibGVkJyDmiJYgJ2Rpc2FibGVkJywg5L2g5o+Q5L6b55qE5pivOiAke2VuYWJsZV9zdGF0ZX1gKTtcbiAgfVxuICBpZiAoIVsnYWxsJywgJ2dsb2JhbCcsICdjaGFyYWN0ZXInXS5pbmNsdWRlcyhzY29wZSkpIHtcbiAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qEIHNjb3BlIOaXoOaViCwg6K+35o+Q5L6bICdhbGwnLCAnZ2xvYmFsJyDmiJYgJ2NoYXJhY3RlcicsIOS9oOaPkOS+m+eahOaYrzogJHtzY29wZX1gKTtcbiAgfVxuXG4gIGxldCByZWdleGVzOiBUYXZlcm5SZWdleFtdID0gW107XG4gIGlmIChzY29wZSA9PT0gJ2FsbCcgfHwgc2NvcGUgPT09ICdnbG9iYWwnKSB7XG4gICAgcmVnZXhlcyA9IFsuLi5yZWdleGVzLCAuLi5nZXRHbG9iYWxSZWdleGVzKCkubWFwKHJlZ2V4ID0+IHRvVGF2ZXJuUmVnZXgocmVnZXgsICdnbG9iYWwnKSldO1xuICB9XG4gIGlmIChzY29wZSA9PT0gJ2FsbCcgfHwgc2NvcGUgPT09ICdjaGFyYWN0ZXInKSB7XG4gICAgcmVnZXhlcyA9IFsuLi5yZWdleGVzLCAuLi5nZXRDaGFyYWN0ZXJSZWdleGVzKCkubWFwKHJlZ2V4ID0+IHRvVGF2ZXJuUmVnZXgocmVnZXgsICdjaGFyYWN0ZXInKSldO1xuICB9XG4gIGlmIChlbmFibGVfc3RhdGUgIT09ICdhbGwnKSB7XG4gICAgcmVnZXhlcyA9IHJlZ2V4ZXMuZmlsdGVyKHJlZ2V4ID0+IHJlZ2V4LmVuYWJsZWQgPT09IChlbmFibGVfc3RhdGUgPT09ICdlbmFibGVkJykpO1xuICB9XG5cbiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZShyZWdleGVzKTtcbn1cblxuaW50ZXJmYWNlIFJlcGxhY2VUYXZlcm5SZWdleGVzT3B0aW9uIHtcbiAgc2NvcGU/OiAnYWxsJyB8ICdnbG9iYWwnIHwgJ2NoYXJhY3Rlcic7IC8vIOimgeabv+aNoueahOmFkummhuato+WImemDqOWIhlxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVwbGFjZVRhdmVyblJlZ2V4ZXMoXG4gIHJlZ2V4ZXM6IFRhdmVyblJlZ2V4W10sXG4gIHsgc2NvcGUgPSAnYWxsJyB9OiBSZXBsYWNlVGF2ZXJuUmVnZXhlc09wdGlvbixcbik6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoIVsnYWxsJywgJ2dsb2JhbCcsICdjaGFyYWN0ZXInXS5pbmNsdWRlcyhzY29wZSkpIHtcbiAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qEIHNjb3BlIOaXoOaViCwg6K+35o+Q5L6bICdhbGwnLCAnZ2xvYmFsJyDmiJYgJ2NoYXJhY3RlcicsIOS9oOaPkOS+m+eahOaYrzogJHtzY29wZX1gKTtcbiAgfVxuXG4gIC8vIEZJWE1FOiBgdHJpbVN0cmluZ3NgIGFuZCBgc3Vic3RpdHV0ZVJlZ2V4YCBhcmUgbm90IGNvbnNpZGVyZWRcbiAgY29uc3QgZW1wdGllZF9yZWdleGVzID0gcmVnZXhlcy5maWx0ZXIocmVnZXggPT4gcmVnZXguc2NyaXB0X25hbWUgPT0gJycpO1xuICBpZiAoZW1wdGllZF9yZWdleGVzLmxlbmd0aCA+IDApIHtcbiAgICB0aHJvdyBFcnJvcihg5LiN6IO95bCG6YWS6aaG5q2j5YiZ55qE5ZCN56ew6K6+572u5Li656m65a2X56ym5LiyOlxcbiR7SlNPTi5zdHJpbmdpZnkoZW1wdGllZF9yZWdleGVzLm1hcChyZWdleCA9PiByZWdleC5pZCkpfWApO1xuICB9XG4gIGNvbnN0IFtnbG9iYWxfcmVnZXhlcywgY2hhcmFjdGVyX3JlZ2V4ZXNdID0gXy5wYXJ0aXRpb24ocmVnZXhlcywgcmVnZXggPT4gcmVnZXguc2NvcGUgPT09ICdnbG9iYWwnKS5tYXAocGFyaXRpb25lZCA9PlxuICAgIHBhcml0aW9uZWQubWFwKGZyb21UYXZlcm5SZWdleCksXG4gICk7XG5cbiAgLy8gQHRzLWlnbm9yZVxuICBjb25zdCBjaGFyYWN0ZXIgPSBjaGFyYWN0ZXJzW3RoaXNfY2hpZF07XG4gIGlmIChzY29wZSA9PT0gJ2FsbCcgfHwgc2NvcGUgPT09ICdnbG9iYWwnKSB7XG4gICAgZXh0ZW5zaW9uX3NldHRpbmdzLnJlZ2V4ID0gZ2xvYmFsX3JlZ2V4ZXM7XG4gIH1cbiAgaWYgKHNjb3BlID09PSAnYWxsJyB8fCBzY29wZSA9PT0gJ2NoYXJhY3RlcicpIHtcbiAgICBpZiAoY2hhcmFjdGVyKSB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0uZGF0YS5leHRlbnNpb25zLnJlZ2V4X3NjcmlwdHMgPSBjaGFyYWN0ZXJfcmVnZXhlcztcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGF3YWl0IHdyaXRlRXh0ZW5zaW9uRmllbGQodGhpc19jaGlkLCAncmVnZXhfc2NyaXB0cycsIGNoYXJhY3Rlcl9yZWdleGVzKTtcbiAgICB9XG4gIH1cbiAgYXdhaXQgc2F2ZVNldHRpbmdzKCk7XG4gIGlmIChjaGFyYWN0ZXIpIHtcbiAgICBhd2FpdCBzYXZlQ2hhdENvbmRpdGlvbmFsKCk7XG4gIH1cbiAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcblxuICBjb25zb2xlLmluZm8oYOabv+aNoumFkummhuato+WImVxcXG4ke3Njb3BlID09PSAnYWxsJyB8fCBzY29wZSA9PT0gJ2dsb2JhbCcgPyBgLCDlhajlsYDmraPliJk6XFxuJHtKU09OLnN0cmluZ2lmeShnbG9iYWxfcmVnZXhlcyl9YCA6IGBgfVxcXG4ke3Njb3BlID09PSAnYWxsJyB8fCBzY29wZSA9PT0gJ2NoYXJhY3RlcicgPyBgLCDlsYDpg6jmraPliJk6XFxuJHtKU09OLnN0cmluZ2lmeShjaGFyYWN0ZXJfcmVnZXhlcyl9YCA6IGBgfWApO1xufVxuXG50eXBlIFRhdmVyblJlZ2V4VXBkYXRlciA9XG4gIHwgKChyZWdleGVzOiBUYXZlcm5SZWdleFtdKSA9PiBUYXZlcm5SZWdleFtdKVxuICB8ICgocmVnZXhlczogVGF2ZXJuUmVnZXhbXSkgPT4gUHJvbWlzZTxUYXZlcm5SZWdleFtdPik7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVUYXZlcm5SZWdleGVzV2l0aChcbiAgdXBkYXRlcjogVGF2ZXJuUmVnZXhVcGRhdGVyLFxuICB7IHNjb3BlID0gJ2FsbCcgfTogUmVwbGFjZVRhdmVyblJlZ2V4ZXNPcHRpb24gPSB7fSxcbik6IFByb21pc2U8VGF2ZXJuUmVnZXhbXT4ge1xuICBsZXQgcmVnZXhlcyA9IGdldFRhdmVyblJlZ2V4ZXMoeyBzY29wZSB9KTtcbiAgcmVnZXhlcyA9IGF3YWl0IHVwZGF0ZXIocmVnZXhlcyk7XG4gIGNvbnNvbGUuaW5mbyhg5a+5JHt7IGFsbDogJ+WFqOmDqCcsIGdsb2JhbDogJ+WFqOWxgCcsIGNoYXJhY3RlcjogJ+WxgOmDqCcgfVtzY29wZV195Y+Y6YeP6KGo6L+b6KGM5pu05pawYCk7XG4gIGF3YWl0IHJlcGxhY2VUYXZlcm5SZWdleGVzKHJlZ2V4ZXMsIHsgc2NvcGUgfSk7XG4gIHJldHVybiByZWdleGVzO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/tavern_regex.ts\n")},"./src/function/util.ts":
/*!******************************!*\
  !*** ./src/function/util.ts ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   errorCatched: () => (/* binding */ errorCatched),\n/* harmony export */   getLastMessageId: () => (/* binding */ getLastMessageId),\n/* harmony export */   substitudeMacros: () => (/* binding */ substitudeMacros)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n\nfunction substitudeMacros(text) {\n    const text_demacroed = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParamsExtended)(text);\n    console.info(`, : '${text}', : '${text_demacroed}'`);\n    return text_demacroed;\n}\nfunction getLastMessageId() {\n    return Number(substitudeMacros('{{lastMessageId}}'));\n}\nfunction errorCatched(fn) {\n    const onError = (error) => {\n        toastr.error(`${error.stack ? error.stack : error.name + ': ' + error.message}`);\n        throw error;\n    };\n    return (...args) => {\n        try {\n            const result = fn(...args);\n            if (result instanceof Promise) {\n                return result.catch(error => {\n                    onError(error);\n                });\n            }\n            return result;\n        }\n        catch (error) {\n            return onError(error);\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vdXRpbC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQStEO0FBRXhELFNBQVMsZ0JBQWdCLENBQUMsSUFBWTtJQUMzQyxNQUFNLGNBQWMsR0FBRyw2RUFBd0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUV0RCxPQUFPLENBQUMsSUFBSSxDQUFDLG1CQUFtQixJQUFJLFdBQVcsY0FBYyxHQUFHLENBQUMsQ0FBQztJQUNsRSxPQUFPLGNBQWMsQ0FBQztBQUN4QixDQUFDO0FBRU0sU0FBUyxnQkFBZ0I7SUFDOUIsT0FBTyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDO0FBQ3ZELENBQUM7QUFFTSxTQUFTLFlBQVksQ0FBcUIsRUFBcUI7SUFDcEUsTUFBTSxPQUFPLEdBQUcsQ0FBQyxLQUFZLEVBQUUsRUFBRTtRQUMvQixNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxJQUFJLEdBQUcsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7UUFDakYsTUFBTSxLQUFLLENBQUM7SUFDZCxDQUFDLENBQUM7SUFDRixPQUFPLENBQUMsR0FBRyxJQUFPLEVBQUssRUFBRTtRQUN2QixJQUFJLENBQUM7WUFDSCxNQUFNLE1BQU0sR0FBRyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztZQUMzQixJQUFJLE1BQU0sWUFBWSxPQUFPLEVBQUUsQ0FBQztnQkFDOUIsT0FBTyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFO29CQUMxQixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQ2pCLENBQUMsQ0FBTSxDQUFDO1lBQ1YsQ0FBQztZQUNELE9BQU8sTUFBTSxDQUFDO1FBQ2hCLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsT0FBTyxPQUFPLENBQUMsS0FBYyxDQUFDLENBQUM7UUFDakMsQ0FBQztJQUNILENBQUMsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vdXRpbC50cz81MjA2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHN1YnN0aXR1dGVQYXJhbXNFeHRlbmRlZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG5leHBvcnQgZnVuY3Rpb24gc3Vic3RpdHVkZU1hY3Jvcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCB0ZXh0X2RlbWFjcm9lZCA9IHN1YnN0aXR1dGVQYXJhbXNFeHRlbmRlZCh0ZXh0KTtcblxuICBjb25zb2xlLmluZm8oYOabv+aNouWtl+espuS4suS4reeahOWujywg5a2X56ym5LiyOiAnJHt0ZXh0fScsIOe7k+aenDogJyR7dGV4dF9kZW1hY3JvZWR9J2ApO1xuICByZXR1cm4gdGV4dF9kZW1hY3JvZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMYXN0TWVzc2FnZUlkKCk6IG51bWJlciB7XG4gIHJldHVybiBOdW1iZXIoc3Vic3RpdHVkZU1hY3Jvcygne3tsYXN0TWVzc2FnZUlkfX0nKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlcnJvckNhdGNoZWQ8VCBleHRlbmRzIGFueVtdLCBVPihmbjogKC4uLmFyZ3M6IFQpID0+IFUpOiAoLi4uYXJnczogVCkgPT4gVSB7XG4gIGNvbnN0IG9uRXJyb3IgPSAoZXJyb3I6IEVycm9yKSA9PiB7XG4gICAgdG9hc3RyLmVycm9yKGAke2Vycm9yLnN0YWNrID8gZXJyb3Iuc3RhY2sgOiBlcnJvci5uYW1lICsgJzogJyArIGVycm9yLm1lc3NhZ2V9YCk7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH07XG4gIHJldHVybiAoLi4uYXJnczogVCk6IFUgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBmbiguLi5hcmdzKTtcbiAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICB9KSBhcyBVO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIG9uRXJyb3IoZXJyb3IgYXMgRXJyb3IpO1xuICAgIH1cbiAgfTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/util.ts\n")},"./src/function/variables.ts":
/*!***********************************!*\
  !*** ./src/function/variables.ts ***!
  \***********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteVariable: () => (/* binding */ deleteVariable),\n/* harmony export */   getVariables: () => (/* binding */ getVariables),\n/* harmony export */   insertOrAssignVariables: () => (/* binding */ insertOrAssignVariables),\n/* harmony export */   insertVariables: () => (/* binding */ insertVariables),\n/* harmony export */   replaceVariables: () => (/* binding */ replaceVariables),\n/* harmony export */   updateVariablesWith: () => (/* binding */ updateVariablesWith)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _function_chat_message__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/chat_message */ \"./src/function/chat_message.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n\n\n\n\nfunction getVariablesByType({ type = 'chat', message_id = 'latest', script_id }) {\n    switch (type) {\n        case 'message': {\n            if (message_id !== 'latest' && (message_id < -_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length || message_id >= _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length)) {\n                throw Error(` message_id(${message_id}) `);\n            }\n            message_id = message_id === 'latest' ? -1 : message_id;\n            return (0,_function_chat_message__WEBPACK_IMPORTED_MODULE_1__.getChatMessages)(message_id)[0].data;\n        }\n        case 'chat': {\n            const metadata = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata;\n            if (!metadata.variables) {\n                metadata.variables = {};\n            }\n            return metadata.variables;\n        }\n        case 'character': {\n            //@ts-ignore\n            return _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_characterScriptVariables || {};\n        }\n        case 'global':\n            return _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.extension_settings.variables.global;\n        case 'script':\n            if (!script_id) {\n                throw Error(',  script_id');\n            }\n            return _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__.ScriptManager.getInstance().getScriptVariables(script_id);\n    }\n}\nfunction getVariables({ type = 'chat', message_id = 'latest', script_id } = {}) {\n    const result = getVariablesByType({ type, message_id, script_id });\n    console.info(`${type === 'message'\n        ? `'${message_id}' `\n        : type === 'chat'\n            ? ''\n            : type === 'character'\n                ? ''\n                : type === 'script'\n                    ? `'${script_id}' `\n                    : ''}:\\n${JSON.stringify(result)}`);\n    return structuredClone(result);\n}\nasync function replaceVariables(variables, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    switch (type) {\n        case 'message':\n            if (message_id !== 'latest' && (message_id < -_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length || message_id >= _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length)) {\n                throw Error(` message_id(${message_id}) `);\n            }\n            message_id = message_id === 'latest' ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length - 1 : message_id < 0 ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length + message_id : message_id;\n            await (0,_function_chat_message__WEBPACK_IMPORTED_MODULE_1__.setChatMessages)([{ message_id, data: variables }], { refresh: 'none' });\n            break;\n        case 'chat':\n            _.set(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata, 'variables', variables);\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveMetadata)();\n            break;\n        case 'character':\n            if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n                throw new Error('');\n            }\n            //@ts-ignore\n            await writeExtensionField(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_characterScriptVariables', variables);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.emit('character_variables_changed', { variables });\n            break;\n        case 'global':\n            _.set(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.extension_settings.variables, 'global', variables);\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettings)();\n            break;\n        case 'script':\n            if (!script_id) {\n                throw Error(',  script_id');\n            }\n            {\n                const script_manager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__.ScriptManager.getInstance();\n                const script = script_manager.getScriptById(script_id);\n                if (!script) {\n                    throw Error(`'${script_id}' `);\n                }\n                const script_type = script_manager['scriptData'].getScriptType(script);\n                await script_manager.updateScriptVariables(script_id, variables, script_type);\n            }\n            break;\n    }\n    console.info(`${type === 'message'\n        ? `'${message_id}' `\n        : type === 'chat'\n            ? ''\n            : type === 'character'\n                ? ''\n                : type === 'script'\n                    ? `'${script_id}' `\n                    : ''}:\\n${JSON.stringify(variables)}`);\n}\nasync function updateVariablesWith(updater, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    let variables = getVariables({ type, message_id, script_id });\n    variables = await updater(variables);\n    console.info(`${type === 'message'\n        ? `'${message_id}' `\n        : type === 'chat'\n            ? ''\n            : type === 'character'\n                ? ''\n                : type === 'script'\n                    ? `'${script_id}' `\n                    : ''}`);\n    await replaceVariables(variables, { type, message_id, script_id });\n    return variables;\n}\nasync function insertOrAssignVariables(variables, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    await updateVariablesWith(old_variables => _.merge(old_variables, variables), { type, message_id, script_id });\n}\nasync function insertVariables(variables, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    await updateVariablesWith(old_variables => _.defaultsDeep(old_variables, variables), { type, message_id, script_id });\n}\nasync function deleteVariable(variable_path, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    let result = false;\n    await updateVariablesWith(old_variables => {\n        result = _.unset(old_variables, variable_path);\n        return old_variables;\n    }, { type, message_id, script_id });\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxhQUFhLEVBQUUsU0FBUyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUM7QUFDeEgsQ0FBQztBQUVNLEtBQUssVUFBVSxjQUFjLENBQ2xDLGFBQXFCLEVBQ3JCLEVBQUUsSUFBSSxHQUFHLE1BQU0sRUFBRSxVQUFVLEdBQUcsUUFBUSxFQUFFLFNBQVMsS0FBcUIsRUFBRTtJQUV4RSxJQUFJLE1BQU0sR0FBWSxLQUFLLENBQUM7SUFDNUIsTUFBTSxtQkFBbUIsQ0FDdkIsYUFBYSxDQUFDLEVBQUU7UUFDZCxNQUFNLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxhQUFhLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFDL0MsT0FBTyxhQUFhLENBQUM7SUFDdkIsQ0FBQyxFQUNELEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsQ0FDaEMsQ0FBQztJQUNGLE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vdmFyaWFibGVzLnRzP2UzYjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2NyaXB0TWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyJztcbmltcG9ydCB7IGdldENoYXRNZXNzYWdlcywgc2V0Q2hhdE1lc3NhZ2VzIH0gZnJvbSAnQC9mdW5jdGlvbi9jaGF0X21lc3NhZ2UnO1xuXG5pbXBvcnQge1xuICBjaGFyYWN0ZXJzLFxuICBjaGF0LFxuICBjaGF0X21ldGFkYXRhLFxuICBldmVudFNvdXJjZSxcbiAgc2F2ZU1ldGFkYXRhLFxuICBzYXZlU2V0dGluZ3MsXG4gIHRoaXNfY2hpZCxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBleHRlbnNpb25fc2V0dGluZ3MgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcblxuaW50ZXJmYWNlIFZhcmlhYmxlT3B0aW9uIHtcbiAgdHlwZT86ICdtZXNzYWdlJyB8ICdjaGF0JyB8ICdjaGFyYWN0ZXInIHwgJ3NjcmlwdCcgfCAnZ2xvYmFsJztcbiAgbWVzc2FnZV9pZD86IG51bWJlciB8ICdsYXRlc3QnO1xuICBzY3JpcHRfaWQ/OiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGdldFZhcmlhYmxlc0J5VHlwZSh7IHR5cGUgPSAnY2hhdCcsIG1lc3NhZ2VfaWQgPSAnbGF0ZXN0Jywgc2NyaXB0X2lkIH06IFZhcmlhYmxlT3B0aW9uKTogUmVjb3JkPHN0cmluZywgYW55PiB7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ21lc3NhZ2UnOiB7XG4gICAgICBpZiAobWVzc2FnZV9pZCAhPT0gJ2xhdGVzdCcgJiYgKG1lc3NhZ2VfaWQgPCAtY2hhdC5sZW5ndGggfHwgbWVzc2FnZV9pZCA+PSBjaGF0Lmxlbmd0aCkpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoYOaPkOS+m+eahCBtZXNzYWdlX2lkKCR7bWVzc2FnZV9pZH0pIOi2heWHuuS6huiBiuWkqea2iOaBr+alvOWxguWPt+iMg+WbtGApO1xuICAgICAgfVxuICAgICAgbWVzc2FnZV9pZCA9IG1lc3NhZ2VfaWQgPT09ICdsYXRlc3QnID8gLTEgOiBtZXNzYWdlX2lkO1xuICAgICAgcmV0dXJuIGdldENoYXRNZXNzYWdlcyhtZXNzYWdlX2lkKVswXS5kYXRhO1xuICAgIH1cbiAgICBjYXNlICdjaGF0Jzoge1xuICAgICAgY29uc3QgbWV0YWRhdGEgPSBjaGF0X21ldGFkYXRhIGFzIHtcbiAgICAgICAgdmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgdW5kZWZpbmVkO1xuICAgICAgfTtcbiAgICAgIGlmICghbWV0YWRhdGEudmFyaWFibGVzKSB7XG4gICAgICAgIG1ldGFkYXRhLnZhcmlhYmxlcyA9IHt9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1ldGFkYXRhLnZhcmlhYmxlcztcbiAgICB9XG4gICAgY2FzZSAnY2hhcmFjdGVyJzoge1xuICAgICAgLy9AdHMtaWdub3JlXG4gICAgICByZXR1cm4gY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5UYXZlcm5IZWxwZXJfY2hhcmFjdGVyU2NyaXB0VmFyaWFibGVzIHx8IHt9O1xuICAgIH1cbiAgICBjYXNlICdnbG9iYWwnOlxuICAgICAgcmV0dXJuIGV4dGVuc2lvbl9zZXR0aW5ncy52YXJpYWJsZXMuZ2xvYmFsO1xuICAgIGNhc2UgJ3NjcmlwdCc6XG4gICAgICBpZiAoIXNjcmlwdF9pZCkge1xuICAgICAgICB0aHJvdyBFcnJvcign6I635Y+W6ISa5pys5Y+Y6YeP5aSx6LSlLCDmnKrmjIflrpogc2NyaXB0X2lkJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gU2NyaXB0TWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldFNjcmlwdFZhcmlhYmxlcyhzY3JpcHRfaWQpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRWYXJpYWJsZXMoeyB0eXBlID0gJ2NoYXQnLCBtZXNzYWdlX2lkID0gJ2xhdGVzdCcsIHNjcmlwdF9pZCB9OiBWYXJpYWJsZU9wdGlvbiA9IHt9KTogUmVjb3JkPFxuICBzdHJpbmcsXG4gIGFueVxuPiB7XG4gIGNvbnN0IHJlc3VsdCA9IGdldFZhcmlhYmxlc0J5VHlwZSh7IHR5cGUsIG1lc3NhZ2VfaWQsIHNjcmlwdF9pZCB9KTtcblxuICBjb25zb2xlLmluZm8oXG4gICAgYOiOt+WPliR7XG4gICAgICB0eXBlID09PSAnbWVzc2FnZSdcbiAgICAgICAgPyBgJyR7bWVzc2FnZV9pZH0nIOa2iOaBr2BcbiAgICAgICAgOiB0eXBlID09PSAnY2hhdCdcbiAgICAgICAgPyAn6IGK5aSpJ1xuICAgICAgICA6IHR5cGUgPT09ICdjaGFyYWN0ZXInXG4gICAgICAgID8gJ+inkuiJsidcbiAgICAgICAgOiB0eXBlID09PSAnc2NyaXB0J1xuICAgICAgICA/IGAnJHtzY3JpcHRfaWR9JyDohJrmnKxgXG4gICAgICAgIDogJ+WFqOWxgCdcbiAgICB95Y+Y6YeP6KGoOlxcbiR7SlNPTi5zdHJpbmdpZnkocmVzdWx0KX1gLFxuICApO1xuICByZXR1cm4gc3RydWN0dXJlZENsb25lKHJlc3VsdCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBsYWNlVmFyaWFibGVzKFxuICB2YXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gIHsgdHlwZSA9ICdjaGF0JywgbWVzc2FnZV9pZCA9ICdsYXRlc3QnLCBzY3JpcHRfaWQgfTogVmFyaWFibGVPcHRpb24gPSB7fSxcbik6IFByb21pc2U8dm9pZD4ge1xuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlICdtZXNzYWdlJzpcbiAgICAgIGlmIChtZXNzYWdlX2lkICE9PSAnbGF0ZXN0JyAmJiAobWVzc2FnZV9pZCA8IC1jaGF0Lmxlbmd0aCB8fCBtZXNzYWdlX2lkID49IGNoYXQubGVuZ3RoKSkge1xuICAgICAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qEIG1lc3NhZ2VfaWQoJHttZXNzYWdlX2lkfSkg6LaF5Ye65LqG6IGK5aSp5raI5oGv5qW85bGC5Y+36IyD5Zu0YCk7XG4gICAgICB9XG4gICAgICBtZXNzYWdlX2lkID0gbWVzc2FnZV9pZCA9PT0gJ2xhdGVzdCcgPyBjaGF0Lmxlbmd0aCAtIDEgOiBtZXNzYWdlX2lkIDwgMCA/IGNoYXQubGVuZ3RoICsgbWVzc2FnZV9pZCA6IG1lc3NhZ2VfaWQ7XG4gICAgICBhd2FpdCBzZXRDaGF0TWVzc2FnZXMoW3sgbWVzc2FnZV9pZCwgZGF0YTogdmFyaWFibGVzIH1dLCB7IHJlZnJlc2g6ICdub25lJyB9KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2NoYXQnOlxuICAgICAgXy5zZXQoY2hhdF9tZXRhZGF0YSwgJ3ZhcmlhYmxlcycsIHZhcmlhYmxlcyk7XG4gICAgICBhd2FpdCBzYXZlTWV0YWRhdGEoKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2NoYXJhY3Rlcic6XG4gICAgICBpZiAoIXRoaXNfY2hpZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+S/neWtmOWPmOmHj+Wksei0pe+8jOW9k+WJjeinkuiJsuS4uuepuicpO1xuICAgICAgfVxuICAgICAgLy9AdHMtaWdub3JlXG4gICAgICBhd2FpdCB3cml0ZUV4dGVuc2lvbkZpZWxkKHRoaXNfY2hpZCwgJ1RhdmVybkhlbHBlcl9jaGFyYWN0ZXJTY3JpcHRWYXJpYWJsZXMnLCB2YXJpYWJsZXMpO1xuICAgICAgZXZlbnRTb3VyY2UuZW1pdCgnY2hhcmFjdGVyX3ZhcmlhYmxlc19jaGFuZ2VkJywgeyB2YXJpYWJsZXMgfSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdnbG9iYWwnOlxuICAgICAgXy5zZXQoZXh0ZW5zaW9uX3NldHRpbmdzLnZhcmlhYmxlcywgJ2dsb2JhbCcsIHZhcmlhYmxlcyk7XG4gICAgICBhd2FpdCBzYXZlU2V0dGluZ3MoKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3NjcmlwdCc6XG4gICAgICBpZiAoIXNjcmlwdF9pZCkge1xuICAgICAgICB0aHJvdyBFcnJvcign5L+d5a2Y5Y+Y6YeP5aSx6LSlLCDmnKrmjIflrpogc2NyaXB0X2lkJyk7XG4gICAgICB9XG4gICAgICB7XG4gICAgICAgIGNvbnN0IHNjcmlwdF9tYW5hZ2VyID0gU2NyaXB0TWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuICAgICAgICBjb25zdCBzY3JpcHQgPSBzY3JpcHRfbWFuYWdlci5nZXRTY3JpcHRCeUlkKHNjcmlwdF9pZCk7XG4gICAgICAgIGlmICghc2NyaXB0KSB7XG4gICAgICAgICAgdGhyb3cgRXJyb3IoYCcke3NjcmlwdF9pZH0nIOiEmuacrOS4jeWtmOWcqGApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNjcmlwdF90eXBlID0gc2NyaXB0X21hbmFnZXJbJ3NjcmlwdERhdGEnXS5nZXRTY3JpcHRUeXBlKHNjcmlwdCk7XG4gICAgICAgIGF3YWl0IHNjcmlwdF9tYW5hZ2VyLnVwZGF0ZVNjcmlwdFZhcmlhYmxlcyhzY3JpcHRfaWQsIHZhcmlhYmxlcywgc2NyaXB0X3R5cGUpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH1cblxuICBjb25zb2xlLmluZm8oXG4gICAgYOWwhiR7XG4gICAgICB0eXBlID09PSAnbWVzc2FnZSdcbiAgICAgICAgPyBgJyR7bWVzc2FnZV9pZH0nIOa2iOaBr2BcbiAgICAgICAgOiB0eXBlID09PSAnY2hhdCdcbiAgICAgICAgPyAn6IGK5aSpJ1xuICAgICAgICA6IHR5cGUgPT09ICdjaGFyYWN0ZXInXG4gICAgICAgID8gJ+inkuiJsidcbiAgICAgICAgOiB0eXBlID09PSAnc2NyaXB0J1xuICAgICAgICA/IGAnJHtzY3JpcHRfaWR9JyDohJrmnKxgXG4gICAgICAgIDogJ+WFqOWxgCdcbiAgICB95Y+Y6YeP6KGo5pu/5o2i5Li6OlxcbiR7SlNPTi5zdHJpbmdpZnkodmFyaWFibGVzKX1gLFxuICApO1xufVxuXG50eXBlIFZhcmlhYmxlc1VwZGF0ZXIgPVxuICB8ICgodmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSA9PiBSZWNvcmQ8c3RyaW5nLCBhbnk+KVxuICB8ICgodmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSA9PiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIGFueT4+KTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVZhcmlhYmxlc1dpdGgoXG4gIHVwZGF0ZXI6IFZhcmlhYmxlc1VwZGF0ZXIsXG4gIHsgdHlwZSA9ICdjaGF0JywgbWVzc2FnZV9pZCA9ICdsYXRlc3QnLCBzY3JpcHRfaWQgfTogVmFyaWFibGVPcHRpb24gPSB7fSxcbik6IFByb21pc2U8UmVjb3JkPHN0cmluZywgYW55Pj4ge1xuICBsZXQgdmFyaWFibGVzID0gZ2V0VmFyaWFibGVzKHsgdHlwZSwgbWVzc2FnZV9pZCwgc2NyaXB0X2lkIH0pO1xuICB2YXJpYWJsZXMgPSBhd2FpdCB1cGRhdGVyKHZhcmlhYmxlcyk7XG4gIGNvbnNvbGUuaW5mbyhcbiAgICBg5a+5JHtcbiAgICAgIHR5cGUgPT09ICdtZXNzYWdlJ1xuICAgICAgICA/IGAnJHttZXNzYWdlX2lkfScg5raI5oGvYFxuICAgICAgICA6IHR5cGUgPT09ICdjaGF0J1xuICAgICAgICA/ICfogYrlpKknXG4gICAgICAgIDogdHlwZSA9PT0gJ2NoYXJhY3RlcidcbiAgICAgICAgPyAn6KeS6ImyJ1xuICAgICAgICA6IHR5cGUgPT09ICdzY3JpcHQnXG4gICAgICAgID8gYCcke3NjcmlwdF9pZH0nIOiEmuacrGBcbiAgICAgICAgOiAn5YWo5bGAJ1xuICAgIH3lj5jph4/ooajov5vooYzmm7TmlrBgLFxuICApO1xuICBhd2FpdCByZXBsYWNlVmFyaWFibGVzKHZhcmlhYmxlcywgeyB0eXBlLCBtZXNzYWdlX2lkLCBzY3JpcHRfaWQgfSk7XG4gIHJldHVybiB2YXJpYWJsZXM7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRPckFzc2lnblZhcmlhYmxlcyhcbiAgdmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxuICB7IHR5cGUgPSAnY2hhdCcsIG1lc3NhZ2VfaWQgPSAnbGF0ZXN0Jywgc2NyaXB0X2lkIH06IFZhcmlhYmxlT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgdXBkYXRlVmFyaWFibGVzV2l0aChvbGRfdmFyaWFibGVzID0+IF8ubWVyZ2Uob2xkX3ZhcmlhYmxlcywgdmFyaWFibGVzKSwgeyB0eXBlLCBtZXNzYWdlX2lkLCBzY3JpcHRfaWQgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRWYXJpYWJsZXMoXG4gIHZhcmlhYmxlczogUmVjb3JkPHN0cmluZywgYW55PixcbiAgeyB0eXBlID0gJ2NoYXQnLCBtZXNzYWdlX2lkID0gJ2xhdGVzdCcsIHNjcmlwdF9pZCB9OiBWYXJpYWJsZU9wdGlvbiA9IHt9LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGF3YWl0IHVwZGF0ZVZhcmlhYmxlc1dpdGgob2xkX3ZhcmlhYmxlcyA9PiBfLmRlZmF1bHRzRGVlcChvbGRfdmFyaWFibGVzLCB2YXJpYWJsZXMpLCB7IHR5cGUsIG1lc3NhZ2VfaWQsIHNjcmlwdF9pZCB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVZhcmlhYmxlKFxuICB2YXJpYWJsZV9wYXRoOiBzdHJpbmcsXG4gIHsgdHlwZSA9ICdjaGF0JywgbWVzc2FnZV9pZCA9ICdsYXRlc3QnLCBzY3JpcHRfaWQgfTogVmFyaWFibGVPcHRpb24gPSB7fSxcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBsZXQgcmVzdWx0OiBib29sZWFuID0gZmFsc2U7XG4gIGF3YWl0IHVwZGF0ZVZhcmlhYmxlc1dpdGgoXG4gICAgb2xkX3ZhcmlhYmxlcyA9PiB7XG4gICAgICByZXN1bHQgPSBfLnVuc2V0KG9sZF92YXJpYWJsZXMsIHZhcmlhYmxlX3BhdGgpO1xuICAgICAgcmV0dXJuIG9sZF92YXJpYWJsZXM7XG4gICAgfSxcbiAgICB7IHR5cGUsIG1lc3NhZ2VfaWQsIHNjcmlwdF9pZCB9LFxuICApO1xuICByZXR1cm4gcmVzdWx0O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/variables.ts\n")},"./src/function/version.ts":
/*!*********************************!*\
  !*** ./src/function/version.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getTavernHelperVersion: () => (/* binding */ getTavernHelperVersion),\n/* harmony export */   updateTavernHelper: () => (/* binding */ updateTavernHelper)\n/* harmony export */ });\n/* harmony import */ var _util_check_update__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/check_update */ \"./src/util/check_update.ts\");\n\nasync function getTavernHelperVersion() {\n    const currentVersion = await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_0__.getCurrentVersion)(_util_check_update__WEBPACK_IMPORTED_MODULE_0__.VERSION_FILE_PATH);\n    if (typeof currentVersion !== 'string') {\n        throw new Error('');\n    }\n    return currentVersion;\n}\nasync function updateTavernHelper() {\n    return (0,_util_check_update__WEBPACK_IMPORTED_MODULE_0__.updateTavernHelper)();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vdmVyc2lvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFJNkI7QUFFdEIsS0FBSyxVQUFVLHNCQUFzQjtJQUMxQyxNQUFNLGNBQWMsR0FBRyxNQUFNLHFFQUFpQixDQUFDLGlFQUFpQixDQUFDLENBQUM7SUFDbEUsSUFBSSxPQUFPLGNBQWMsS0FBSyxRQUFRLEVBQUUsQ0FBQztRQUN2QyxNQUFNLElBQUksS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFDRCxPQUFPLGNBQWMsQ0FBQztBQUN4QixDQUFDO0FBRU0sS0FBSyxVQUFVLGtCQUFrQjtJQUN0QyxPQUFPLHNFQUFzQixFQUFFLENBQUM7QUFDbEMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi92ZXJzaW9uLnRzPzI5OWQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgZ2V0Q3VycmVudFZlcnNpb24sXG4gIHVwZGF0ZVRhdmVybkhlbHBlciBhcyB1cGRhdGVUYXZlcm5IZWxwZXJJbXBsLFxuICBWRVJTSU9OX0ZJTEVfUEFUSCxcbn0gZnJvbSAnQC91dGlsL2NoZWNrX3VwZGF0ZSc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUYXZlcm5IZWxwZXJWZXJzaW9uKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGN1cnJlbnRWZXJzaW9uID0gYXdhaXQgZ2V0Q3VycmVudFZlcnNpb24oVkVSU0lPTl9GSUxFX1BBVEgpO1xuICBpZiAodHlwZW9mIGN1cnJlbnRWZXJzaW9uICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBFcnJvcign6I635Y+W55qE54mI5pys5Y+35peg5pWIJyk7XG4gIH1cbiAgcmV0dXJuIGN1cnJlbnRWZXJzaW9uO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGF2ZXJuSGVscGVyKCkge1xuICByZXR1cm4gdXBkYXRlVGF2ZXJuSGVscGVySW1wbCgpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/version.ts\n")},"./src/iframe_client/_impl.ts?raw":
/*!****************************************!*\
  !*** ./src/iframe_client/_impl.ts?raw ***!
  \****************************************/Q=>{Q.exports="\"use strict\";\n// @ts-expect-error\nvar detail;\n(function (detail) {\n    async function make_iframe_promise(message) {\n        return new Promise((resolve, _) => {\n            const uid = Date.now() + Math.random();\n            function handleMessage(event) {\n                if (event.data?.request === message.request + '_callback' && event.data.uid == uid) {\n                    window.removeEventListener('message', handleMessage);\n                    resolve(event.data.result);\n                }\n            }\n            window.addEventListener('message', handleMessage);\n            window.parent.postMessage({\n                uid: uid,\n                ...message,\n            }, '*');\n        });\n    }\n    detail.make_iframe_promise = make_iframe_promise;\n    function format_function_to_string(fn) {\n        const string = fn.toString();\n        const index = string.indexOf('\\n');\n        if (index > -1) {\n            return string.slice(0, index);\n        }\n        else {\n            return string;\n        }\n    }\n    detail.format_function_to_string = format_function_to_string;\n    function get_or_set(map, key, defaulter) {\n        const existing_value = map.get(key);\n        if (existing_value) {\n            return existing_value;\n        }\n        const default_value = defaulter();\n        map.set(key, default_value);\n        return default_value;\n    }\n    detail.get_or_set = get_or_set;\n    function extract(map, key) {\n        const value = map.get(key);\n        if (!value) {\n            return undefined;\n        }\n        map.delete(key);\n        return value;\n    }\n    detail.extract = extract;\n})(detail || (detail = {}));\n"},"./src/iframe_client/_multimap.ts?raw":
/*!********************************************!*\
  !*** ./src/iframe_client/_multimap.ts?raw ***!
  \********************************************/Q=>{Q.exports="\"use strict\";\n//  _multimap.ts, ,  iframe \nclass Multimap {\n    size_ = 0;\n    map = new Map();\n    operator;\n    constructor(operator, iterable) {\n        this.operator = operator;\n        if (iterable) {\n            for (const [key, value] of iterable) {\n                this.put(key, value);\n            }\n        }\n        return this;\n    }\n    get size() {\n        return this.size_;\n    }\n    get(key) {\n        const values = this.map.get(key);\n        if (values) {\n            return this.operator.clone(values);\n        }\n        else {\n            return this.operator.create();\n        }\n    }\n    put(key, value) {\n        let values = this.map.get(key);\n        if (!values) {\n            values = this.operator.create();\n        }\n        if (!this.operator.add(value, values)) {\n            return false;\n        }\n        this.map.set(key, values);\n        this.size_++;\n        return true;\n    }\n    putAll(arg1, arg2) {\n        let pushed = 0;\n        if (arg2) {\n            const key = arg1;\n            const values = arg2;\n            for (const value of values) {\n                this.put(key, value);\n                pushed++;\n            }\n        }\n        else if (arg1 instanceof Multimap) {\n            for (const [key, value] of arg1.entries()) {\n                this.put(key, value);\n                pushed++;\n            }\n        }\n        else {\n            throw new TypeError('unexpected arguments');\n        }\n        return pushed > 0;\n    }\n    has(key) {\n        return this.map.has(key);\n    }\n    hasEntry(key, value) {\n        return this.operator.has(value, this.get(key));\n    }\n    delete(key) {\n        this.size_ -= this.operator.size(this.get(key));\n        return this.map.delete(key);\n    }\n    deleteEntry(key, value) {\n        const current = this.get(key);\n        if (!this.operator.delete(value, current)) {\n            return false;\n        }\n        this.map.set(key, current);\n        this.size_--;\n        return true;\n    }\n    clear() {\n        this.map.clear();\n        this.size_ = 0;\n    }\n    keys() {\n        return this.map.keys();\n    }\n    entries() {\n        const self = this;\n        function* gen() {\n            for (const [key, values] of self.map.entries()) {\n                for (const value of values) {\n                    yield [key, value];\n                }\n            }\n        }\n        return gen();\n    }\n    values() {\n        const self = this;\n        function* gen() {\n            for (const [, value] of self.entries()) {\n                yield value;\n            }\n        }\n        return gen();\n    }\n    forEach(callback, thisArg) {\n        for (const [key, value] of this.entries()) {\n            callback.call(thisArg === undefined ? this : thisArg, value, key, this);\n        }\n    }\n    [Symbol.iterator]() {\n        return this.entries();\n    }\n    asMap() {\n        const ret = new Map();\n        for (const key of this.keys()) {\n            ret.set(key, this.operator.clone(this.get(key)));\n        }\n        return ret;\n    }\n}\nclass ArrayMultimap extends Multimap {\n    constructor(iterable) {\n        super(new ArrayOperator(), iterable);\n    }\n    get [Symbol.toStringTag]() {\n        return 'ArrayMultimap';\n    }\n}\nclass ArrayOperator {\n    create() {\n        return [];\n    }\n    clone(collection) {\n        return collection.slice();\n    }\n    add(value, collection) {\n        collection.push(value);\n        return true;\n    }\n    size(collection) {\n        return collection.length;\n    }\n    delete(value, collection) {\n        const index = collection.indexOf(value);\n        if (index > -1) {\n            collection.splice(index, 1);\n            return true;\n        }\n        return false;\n    }\n    has(value, collection) {\n        return collection.includes(value);\n    }\n}\nclass SetMultimap extends Multimap {\n    constructor(iterable) {\n        super(new SetOperator(), iterable);\n    }\n    get [Symbol.toStringTag]() {\n        return 'SetMultimap';\n    }\n}\nclass SetOperator {\n    create() {\n        return new Set();\n    }\n    clone(collection) {\n        return new Set(collection);\n    }\n    add(value, collection) {\n        const prev = collection.size;\n        collection.add(value);\n        return prev !== collection.size;\n    }\n    size(collection) {\n        return collection.size;\n    }\n    delete(value, collection) {\n        return collection.delete(value);\n    }\n    has(value, collection) {\n        return collection.has(value);\n    }\n}\n"},"./src/iframe_client/event.ts?raw":
/*!****************************************!*\
  !*** ./src/iframe_client/event.ts?raw ***!
  \****************************************/Q=>{Q.exports="\"use strict\";\n/**\n *  `listener`  `event_type`,  `listener`.\n *\n * -  `listener`  `event_type`, .\n *\n * @param event_type \n * @param listener \n *\n * @example\n * function hello() { alert(\"hello\"); }\n * eventOn(, hello);\n *\n * @example\n * // \n * //  MESSAGE_UPDATED  id , , \n * function detectMessageUpdated(message_id) {\n *   alert(` ${message_id} `);\n * }\n * eventOn(tavern_events.MESSAGE_UPDATED, detectMessageUpdated);\n */\nfunction eventOn(event_type, listener) {\n    if (detail.try_get_wrapper(listener, event_type)) {\n        console.warn(`[Event][eventOn]  '${event_type}' , \\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    SillyTavern.eventSource.on(event_type, detail.get_or_make_wrapper(listener, event_type, false));\n    console.info(`[Event][eventOn]  '${event_type}' \\n\\n  ${detail.format_function_to_string(listener)}`);\n}\n/**\n *  `listener`  `event_type`,  `listener`.\n *\n * -  `listener`  `event_type`, .\n *\n * @param event_type \n * @param listener \n *\n * @example\n * function hello() { alert(\"hello\"); }\n * eventOnButton(, hello);\n */\nfunction eventOnButton(event_type, listener) {\n    const script_id = getScriptId();\n    if (detail.try_get_wrapper(listener, event_type)) {\n        console.warn(`[Event][eventOnButton](id${String(script_id)})  '${event_type}' , \\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    const event_type_with_script_id = `${String(script_id)}_${event_type}`;\n    SillyTavern.eventSource.on(event_type_with_script_id, detail.get_or_make_wrapper(listener, event_type_with_script_id, false));\n    console.info(`[Event][eventOnButton](script_id${String(script_id)})  '${event_type}' \\n\\n  ${detail.format_function_to_string(listener)}`);\n}\n/**\n *  `listener`  `event_type`,  `listener`.\n *\n * -  `listener`  `event_type`,  `listener` .\n *\n * @param event_type \n * @param listener /\n *\n * @example\n * eventMakeLast(, );\n */\nfunction eventMakeLast(event_type, listener) {\n    const is_listening = detail.try_get_wrapper(listener, event_type) !== undefined;\n    SillyTavern.eventSource.makeLast(event_type, detail.get_or_make_wrapper(listener, event_type, false));\n    if (is_listening) {\n        console.info(`[Event][eventMakeLast](${getIframeName()})  '${event_type}' \\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n    else {\n        console.info(`[Event][eventMakeLast](${getIframeName()})  '${event_type}' \\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n}\n/**\n *  `listener`  `event_type`,  `listener`.\n *\n * -  `listener`  `event_type`,  `listener` .\n *\n * @param event_type \n * @param listener /\n *\n * @example\n * eventMakeFirst(, );\n */\nfunction eventMakeFirst(event_type, listener) {\n    const is_listening = detail.try_get_wrapper(listener, event_type) !== undefined;\n    SillyTavern.eventSource.makeFirst(event_type, detail.get_or_make_wrapper(listener, event_type, false));\n    if (is_listening) {\n        console.info(`[Event][eventMakeFirst](${getIframeName()})  '${event_type}' \\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n    else {\n        console.info(`[Event][eventMakeFirst](${getIframeName()})  '${event_type}' \\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n}\n/**\n *  `listener`  `event_type`,  `listener`, .\n *\n * -  `listener`  `event_type`, .\n *\n * @param event_type \n * @param listener \n *\n * @example\n * eventOnce(, );\n */\nfunction eventOnce(event_type, listener) {\n    if (detail.try_get_wrapper(listener, event_type)) {\n        console.warn(`[Event][eventOnce](${getIframeName()})  '${event_type}' , \\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    SillyTavern.eventSource.once(event_type, detail.get_or_make_wrapper(listener, event_type, true));\n    console.info(`[Event][eventOnce](${getIframeName()})  '${event_type}' \\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nasync function eventWaitOnce(event_type, listener) {\n    if (!listener) {\n        const do_nothing = () => { };\n        eventOnce(event_type, do_nothing);\n        return await eventWaitOnce(event_type, do_nothing);\n    }\n    const entry = `${event_type}#${listener.toString()}`;\n    return new Promise((resolve, _) => {\n        const uid = Date.now() + Math.random();\n        function handleMessage(event) {\n            if (event.data?.request === 'iframe_event_wait_callback' && event.data.uid == uid) {\n                window.removeEventListener('message', handleMessage);\n                resolve(event.data.result);\n                detail.waiting_event_map.deleteEntry(entry, uid);\n                console.info(`[Event][eventWaitOnce](${getIframeName()})  '${event_type}' : ${JSON.stringify(event.data.result)}\\n\\n  ${detail.format_function_to_string(listener)}`);\n            }\n        }\n        window.addEventListener('message', handleMessage);\n        detail.waiting_event_map.put(entry, uid);\n        console.info(`[Event][eventWaitOnce](${getIframeName()})  '${event_type}' \\n\\n  ${detail.format_function_to_string(listener)}`);\n    });\n}\n/**\n *  `event_type` ,  `data`.\n *\n *  `event_type`  `data`.\n *\n * @param event_type \n * @param data \n *\n * @example\n * //  \"\" ,  `listener` \n * eventEmit(\"\");\n *\n * @example\n * //  \"\" ,  `listener` () \n * await eventEmit(\"\");\n *\n * @example\n * //  [\"\", 0]\n * eventEmit(\"\", \"\", 0);\n */\nasync function eventEmit(event_type, ...data) {\n    await SillyTavern.eventSource.emit(event_type, ...data);\n    console.info(`[Event][eventEmit](${getIframeName()})  '${event_type}' , : ${JSON.stringify(data)}`);\n}\n/**\n *  `listener`  `event_type` .\n *\n * -  `listener`  `event_type`, .\n *\n * @param event_type \n * @param listener \n *\n * @example\n * eventRemoveListener(, );\n */\nfunction eventRemoveListener(event_type, listener) {\n    const wrapper = detail.try_get_wrapper(listener, event_type);\n    if (!wrapper) {\n        console.warn(`[Event][eventRemoveListener](${getIframeName()})  '${event_type}' , \\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    SillyTavern.eventSource.removeListener(event_type, wrapper);\n    detail.remove_wrapper(listener, event_type);\n    console.info(`[Event][eventRemoveListener](${getIframeName()})  '${event_type}' \\n\\n  ${detail.format_function_to_string(listener)}`);\n}\n/**\n *  iframe  `event_type` \n *\n * @param event_type \n */\nfunction eventClearEvent(event_type) {\n    detail.listener_event_wrapper_map.forEach((event_wrapper_map, _) => {\n        const wrapper = event_wrapper_map.get(event_type);\n        if (wrapper) {\n            SillyTavern.eventSource.removeListener(event_type, wrapper);\n            event_wrapper_map.delete(event_type);\n        }\n    });\n    console.info(`[Event][eventClearEvent](${getIframeName()}) '${event_type}' `);\n}\n/**\n *  iframe  `listener` \n *\n * @param listener \n */\nfunction eventClearListener(listener) {\n    const event_callback_map = detail.extract(detail.listener_event_wrapper_map, listener);\n    if (event_callback_map) {\n        event_callback_map.forEach((callback, event_type) => {\n            SillyTavern.eventSource.removeListener(event_type, callback);\n        });\n    }\n    console.info(`[Event][eventClearListener](${getIframeName()}) \\n\\n  ${detail.format_function_to_string(listener)}`);\n}\n/**\n *  iframe \n */\nfunction eventClearAll() {\n    detail.listener_event_wrapper_map.forEach((event_wrapper_map, _) => {\n        event_wrapper_map.forEach((wrapper, event_type) => {\n            SillyTavern.eventSource.removeListener(event_type, wrapper);\n        });\n    });\n    detail.listener_event_wrapper_map.clear();\n    console.info(`[Event][eventClearAll](${getIframeName()}) `);\n}\n// iframe \nconst iframe_events = {\n    MESSAGE_IFRAME_RENDER_STARTED: 'message_iframe_render_started',\n    MESSAGE_IFRAME_RENDER_ENDED: 'message_iframe_render_ended',\n    /** `generate`  */\n    GENERATION_STARTED: 'js_generation_started',\n    /**  `generate` : \"\", \"\", \"\" */\n    STREAM_TOKEN_RECEIVED_FULLY: 'js_stream_token_received_fully',\n    /**  `generate` : \"\", \"\", \"\" */\n    STREAM_TOKEN_RECEIVED_INCREMENTALLY: 'js_stream_token_received_incrementally',\n    /** `generate`  */\n    GENERATION_ENDED: 'js_generation_ended',\n};\n// . **, **\nconst tavern_events = {\n    APP_READY: 'app_ready',\n    EXTRAS_CONNECTED: 'extras_connected',\n    MESSAGE_SWIPED: 'message_swiped',\n    MESSAGE_SENT: 'message_sent',\n    MESSAGE_RECEIVED: 'message_received',\n    MESSAGE_EDITED: 'message_edited',\n    MESSAGE_DELETED: 'message_deleted',\n    MESSAGE_UPDATED: 'message_updated',\n    MESSAGE_FILE_EMBEDDED: 'message_file_embedded',\n    IMPERSONATE_READY: 'impersonate_ready',\n    CHAT_CHANGED: 'chat_id_changed',\n    GENERATION_AFTER_COMMANDS: 'GENERATION_AFTER_COMMANDS',\n    GENERATION_STARTED: 'generation_started',\n    GENERATION_STOPPED: 'generation_stopped',\n    GENERATION_ENDED: 'generation_ended',\n    EXTENSIONS_FIRST_LOAD: 'extensions_first_load',\n    EXTENSION_SETTINGS_LOADED: 'extension_settings_loaded',\n    SETTINGS_LOADED: 'settings_loaded',\n    SETTINGS_UPDATED: 'settings_updated',\n    GROUP_UPDATED: 'group_updated',\n    MOVABLE_PANELS_RESET: 'movable_panels_reset',\n    SETTINGS_LOADED_BEFORE: 'settings_loaded_before',\n    SETTINGS_LOADED_AFTER: 'settings_loaded_after',\n    CHATCOMPLETION_SOURCE_CHANGED: 'chatcompletion_source_changed',\n    CHATCOMPLETION_MODEL_CHANGED: 'chatcompletion_model_changed',\n    OAI_PRESET_CHANGED_BEFORE: 'oai_preset_changed_before',\n    OAI_PRESET_CHANGED_AFTER: 'oai_preset_changed_after',\n    OAI_PRESET_EXPORT_READY: 'oai_preset_export_ready',\n    OAI_PRESET_IMPORT_READY: 'oai_preset_import_ready',\n    WORLDINFO_SETTINGS_UPDATED: 'worldinfo_settings_updated',\n    WORLDINFO_UPDATED: 'worldinfo_updated',\n    CHARACTER_EDITED: 'character_edited',\n    CHARACTER_PAGE_LOADED: 'character_page_loaded',\n    CHARACTER_GROUP_OVERLAY_STATE_CHANGE_BEFORE: 'character_group_overlay_state_change_before',\n    CHARACTER_GROUP_OVERLAY_STATE_CHANGE_AFTER: 'character_group_overlay_state_change_after',\n    USER_MESSAGE_RENDERED: 'user_message_rendered',\n    CHARACTER_MESSAGE_RENDERED: 'character_message_rendered',\n    FORCE_SET_BACKGROUND: 'force_set_background',\n    CHAT_DELETED: 'chat_deleted',\n    CHAT_CREATED: 'chat_created',\n    GROUP_CHAT_DELETED: 'group_chat_deleted',\n    GROUP_CHAT_CREATED: 'group_chat_created',\n    GENERATE_BEFORE_COMBINE_PROMPTS: 'generate_before_combine_prompts',\n    GENERATE_AFTER_COMBINE_PROMPTS: 'generate_after_combine_prompts',\n    GENERATE_AFTER_DATA: 'generate_after_data',\n    GROUP_MEMBER_DRAFTED: 'group_member_drafted',\n    WORLD_INFO_ACTIVATED: 'world_info_activated',\n    TEXT_COMPLETION_SETTINGS_READY: 'text_completion_settings_ready',\n    CHAT_COMPLETION_SETTINGS_READY: 'chat_completion_settings_ready',\n    CHAT_COMPLETION_PROMPT_READY: 'chat_completion_prompt_ready',\n    CHARACTER_FIRST_MESSAGE_SELECTED: 'character_first_message_selected',\n    // TODO: Naming convention is inconsistent with other events\n    CHARACTER_DELETED: 'characterDeleted',\n    CHARACTER_DUPLICATED: 'character_duplicated',\n    STREAM_TOKEN_RECEIVED: 'stream_token_received',\n    FILE_ATTACHMENT_DELETED: 'file_attachment_deleted',\n    WORLDINFO_FORCE_ACTIVATE: 'worldinfo_force_activate',\n    OPEN_CHARACTER_LIBRARY: 'open_character_library',\n    ONLINE_STATUS_CHANGED: 'online_status_changed',\n    IMAGE_SWIPED: 'image_swiped',\n    CONNECTION_PROFILE_LOADED: 'connection_profile_loaded',\n    TOOL_CALLS_PERFORMED: 'tool_calls_performed',\n    TOOL_CALLS_RENDERED: 'tool_calls_rendered',\n};\n//------------------------------------------------------------------------------------------------------------------------\n// @ts-expect-error\nvar detail;\n(function (detail) {\n    detail.listener_event_wrapper_map = new Map();\n    function try_get_wrapper(listener, event_type) {\n        return detail.listener_event_wrapper_map.get(listener)?.get(event_type);\n    }\n    detail.try_get_wrapper = try_get_wrapper;\n    function remove_wrapper(listener, event_type) {\n        detail.listener_event_wrapper_map.get(listener)?.delete(event_type);\n    }\n    detail.remove_wrapper = remove_wrapper;\n    function get_or_make_wrapper(listener, event_type, once) {\n        const default_wrapper = async (...args) => {\n            if (once) {\n                remove_wrapper(listener, event_type);\n            }\n            const result = await listener(...args);\n            console.info(`[Event][callback '${event_type}'](${getIframeName()})  '${event_type}' \\n\\n  ${detail.format_function_to_string(listener)}`);\n            const uid = detail.waiting_event_map.get(`${event_type}#${listener.toString()}`)[0];\n            if (uid) {\n                window.postMessage({\n                    request: 'iframe_event_wait_callback',\n                    uid: uid,\n                    result: result,\n                }, '*');\n            }\n            return result;\n        };\n        const default_event_wrapper_map = new Map([[event_type, default_wrapper]]);\n        const event_wrapper = detail.get_or_set(detail.listener_event_wrapper_map, listener, () => default_event_wrapper_map);\n        const wrapper = detail.get_or_set(event_wrapper, event_type, () => default_wrapper);\n        return wrapper;\n    }\n    detail.get_or_make_wrapper = get_or_make_wrapper;\n    detail.waiting_event_map = new ArrayMultimap();\n    $(window).on('unload', eventClearAll);\n})(detail || (detail = {}));\n"},"./src/iframe_client/exported.ts?raw":
/*!*******************************************!*\
  !*** ./src/iframe_client/exported.ts?raw ***!
  \*******************************************/Q=>{Q.exports='"use strict";\n/**\n * ,  /public/scripts/st-context  https://github.com/SillyTavern/SillyTavern/blob/release/public/scripts/st-context.js\n *  f12,  `window.SillyTavern.getContext()` \n */\nconst SillyTavern = window.parent.SillyTavern.getContext();\n/**\n * ,  https://n0vi028.github.io/JS-Slash-Runner-Doc\n *  f12,  `window.TavernHelper` \n */\nconst TavernHelper = window.parent.TavernHelper;\nfor (const key in TavernHelper) {\n    window[key] = TavernHelper[key];\n}\nconst toastr = window.parent.toastr;\n/**\n * ,  https://github.com/zonde306/ST-Prompt-Template\n *  f12, `window.EjsTemplate` \n */\nconst EjsTemplate = window.parent.EjsTemplate;\n'},"./src/iframe_client/index.ts":
/*!************************************!*\
  !*** ./src/iframe_client/index.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   iframe_client: () => (/* binding */ iframe_client)\n/* harmony export */ });\n/* harmony import */ var _iframe_client_impl_raw__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/iframe_client/_impl?raw */ "./src/iframe_client/_impl.ts?raw");\n/* harmony import */ var _iframe_client_multimap_raw__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/iframe_client/_multimap?raw */ "./src/iframe_client/_multimap.ts?raw");\n/* harmony import */ var _iframe_client_event_raw__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/iframe_client/event?raw */ "./src/iframe_client/event.ts?raw");\n/* harmony import */ var _iframe_client_exported_raw__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/iframe_client/exported?raw */ "./src/iframe_client/exported.ts?raw");\n/* harmony import */ var _iframe_client_util_raw__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/iframe_client/util?raw */ "./src/iframe_client/util.ts?raw");\n/* harmony import */ var _iframe_client_variables_raw__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/iframe_client/variables?raw */ "./src/iframe_client/variables.ts?raw");\n// TODO:  index  raw,  raw\n\n\n\n\n\n\nconst iframe_client = [_iframe_client_impl_raw__WEBPACK_IMPORTED_MODULE_0__, _iframe_client_multimap_raw__WEBPACK_IMPORTED_MODULE_1__, _iframe_client_event_raw__WEBPACK_IMPORTED_MODULE_2__, _iframe_client_exported_raw__WEBPACK_IMPORTED_MODULE_3__, _iframe_client_variables_raw__WEBPACK_IMPORTED_MODULE_5__, _iframe_client_util_raw__WEBPACK_IMPORTED_MODULE_4__].join(\'\\n\');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaWZyYW1lX2NsaWVudC9pbmRleC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsc0NBQXNDO0FBQ1E7QUFDUTtBQUNSO0FBQ007QUFDUjtBQUNVO0FBRS9DLE1BQU0sYUFBYSxHQUFHLENBQUMsb0RBQUssRUFBRSx3REFBUyxFQUFFLHFEQUFLLEVBQUUsd0RBQVEsRUFBRSx5REFBUyxFQUFFLG9EQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvaWZyYW1lX2NsaWVudC9pbmRleC50cz83NzZhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRPRE86IOWvvOWFpSBpbmRleCDml7bkvb/nlKggcmF3LCDogIzkuI3mmK/liIbliKvkvb/nlKggcmF3XG5pbXBvcnQgX2ltcGwgZnJvbSAnQC9pZnJhbWVfY2xpZW50L19pbXBsP3Jhdyc7XG5pbXBvcnQgX211bHRpbWFwIGZyb20gJ0AvaWZyYW1lX2NsaWVudC9fbXVsdGltYXA/cmF3JztcbmltcG9ydCBldmVudCBmcm9tICdAL2lmcmFtZV9jbGllbnQvZXZlbnQ/cmF3JztcbmltcG9ydCBleHBvcnRlZCBmcm9tICdAL2lmcmFtZV9jbGllbnQvZXhwb3J0ZWQ/cmF3JztcbmltcG9ydCB1dGlsIGZyb20gJ0AvaWZyYW1lX2NsaWVudC91dGlsP3Jhdyc7XG5pbXBvcnQgdmFyaWFibGVzIGZyb20gJ0AvaWZyYW1lX2NsaWVudC92YXJpYWJsZXM/cmF3JztcblxuZXhwb3J0IGNvbnN0IGlmcmFtZV9jbGllbnQgPSBbX2ltcGwsIF9tdWx0aW1hcCwgZXZlbnQsIGV4cG9ydGVkLCB2YXJpYWJsZXMsIHV0aWxdLmpvaW4oJ1xcbicpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/iframe_client/index.ts\n')},"./src/iframe_client/util.ts?raw":
/*!***************************************!*\
  !*** ./src/iframe_client/util.ts?raw ***!
  \***************************************/Q=>{Q.exports="\"use strict\";\n/**\n *  iframe \n *\n * @returns  `message-iframe-id-iframe`;  `script-iframe-`;  `tavern-helper-script-`\n */\nfunction getIframeName() {\n    return window.frameElement.id;\n}\n/**\n *  id, ****\n *\n * @returns  id\n */\nfunction getScriptId() {\n    return $(window.frameElement).attr('script-id') ?? 'unknown_script';\n}\n/**\n *  iframe  id, ** iframe** \n *\n * @returns  id\n */\nfunction getCurrentMessageId() {\n    return getMessageId(getIframeName());\n}\n/**\n *  iframe  `iframe_name`  id, ** iframe** \n *\n * @param iframe_name  iframe \n * @returns  id\n */\nfunction getMessageId(iframe_name) {\n    const match = iframe_name.match(/^message-iframe-(\\d+)-\\d+$/);\n    if (!match) {\n        throw Error(` ${iframe_name}  id :  iframe  getMessageId!`);\n    }\n    return parseInt(match[1].toString());\n}\n"},"./src/iframe_client/variables.ts?raw":
/*!********************************************!*\
  !*** ./src/iframe_client/variables.ts?raw ***!
  \********************************************/Q=>{Q.exports="\"use strict\";\n//------------------------------------------------------------------------------------------------------------------------\n// , \n/** @deprecated ,  `insertOrAssignVariables`  */\nasync function setVariables(message_id, new_or_updated_variables) {\n    let actual_message_id;\n    let actual_variables;\n    if (new_or_updated_variables) {\n        actual_message_id = message_id;\n        actual_variables = new_or_updated_variables;\n    }\n    else {\n        actual_message_id = getCurrentMessageId();\n        actual_variables = message_id;\n    }\n    if (typeof actual_message_id !== 'number' || typeof actual_variables !== 'object') {\n        console.error('[Variables][setVariables] , ');\n        return;\n    }\n    return detail.make_iframe_promise({\n        request: '[Variables][setVariables]',\n        message_id: actual_message_id,\n        variables: actual_variables,\n    });\n}\n"},"./src/iframe_server/_impl.ts":
/*!************************************!*\
  !*** ./src/iframe_server/_impl.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getIframeName: () => (/* binding */ getIframeName),\n/* harmony export */   getLogPrefix: () => (/* binding */ getLogPrefix),\n/* harmony export */   iframe_handlers: () => (/* binding */ iframe_handlers),\n/* harmony export */   registerIframeHandler: () => (/* binding */ registerIframeHandler)\n/* harmony export */ });\nfunction getIframeName(event) {\n    const window = event.source;\n    return window.frameElement?.id;\n}\nfunction getLogPrefix(event) {\n    return `${event.data.request}(${getIframeName(event)}) `;\n}\nconst iframe_handlers = {};\nfunction registerIframeHandler(request, handler) {\n    iframe_handlers[request] = handler;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaWZyYW1lX3NlcnZlci9faW1wbC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBS08sU0FBUyxhQUFhLENBQTBCLEtBQXNCO0lBQzNFLE1BQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxNQUFnQixDQUFDO0lBQ3RDLE9BQU8sTUFBTSxDQUFDLFlBQVksRUFBRSxFQUFZLENBQUM7QUFDM0MsQ0FBQztBQUVNLFNBQVMsWUFBWSxDQUEwQixLQUFzQjtJQUMxRSxPQUFPLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLElBQUksYUFBYSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUM7QUFDM0QsQ0FBQztBQU1NLE1BQU0sZUFBZSxHQUFtQixFQUFFLENBQUM7QUFFM0MsU0FBUyxxQkFBcUIsQ0FDbkMsT0FBZSxFQUNmLE9BQXdEO0lBRXhELGVBQWUsQ0FBQyxPQUFPLENBQUMsR0FBRyxPQUFPLENBQUM7QUFDckMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9pZnJhbWVfc2VydmVyL19pbXBsLnRzPzRkNWEiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGludGVyZmFjZSBJZnJhbWVNZXNzYWdlIHtcbiAgcmVxdWVzdDogc3RyaW5nO1xuICB1aWQ6IG51bWJlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldElmcmFtZU5hbWU8VCBleHRlbmRzIElmcmFtZU1lc3NhZ2U+KGV2ZW50OiBNZXNzYWdlRXZlbnQ8VD4pOiBzdHJpbmcge1xuICBjb25zdCB3aW5kb3cgPSBldmVudC5zb3VyY2UgYXMgV2luZG93O1xuICByZXR1cm4gd2luZG93LmZyYW1lRWxlbWVudD8uaWQgYXMgc3RyaW5nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9nUHJlZml4PFQgZXh0ZW5kcyBJZnJhbWVNZXNzYWdlPihldmVudDogTWVzc2FnZUV2ZW50PFQ+KTogc3RyaW5nIHtcbiAgcmV0dXJuIGAke2V2ZW50LmRhdGEucmVxdWVzdH0oJHtnZXRJZnJhbWVOYW1lKGV2ZW50KX0pIGA7XG59XG5cbnR5cGUgSWZyYW1lSGFuZGxlcnMgPSB7XG4gIFtyZXF1ZXN0OiBzdHJpbmddOiAoZXZlbnQ6IE1lc3NhZ2VFdmVudDxhbnk+KSA9PiBQcm9taXNlPGFueSB8IHZvaWQ+O1xufTtcblxuZXhwb3J0IGNvbnN0IGlmcmFtZV9oYW5kbGVyczogSWZyYW1lSGFuZGxlcnMgPSB7fTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVySWZyYW1lSGFuZGxlcjxUIGV4dGVuZHMgSWZyYW1lTWVzc2FnZT4oXG4gIHJlcXVlc3Q6IHN0cmluZyxcbiAgaGFuZGxlcjogKGV2ZW50OiBNZXNzYWdlRXZlbnQ8VD4pID0+IFByb21pc2U8YW55IHwgdm9pZD4sXG4pIHtcbiAgaWZyYW1lX2hhbmRsZXJzW3JlcXVlc3RdID0gaGFuZGxlcjtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/iframe_server/_impl.ts\n")},"./src/iframe_server/index.ts":
/*!************************************!*\
  !*** ./src/iframe_server/index.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handleIframe: () => (/* binding */ handleIframe)\n/* harmony export */ });\n/* harmony import */ var _iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/iframe_server/_impl */ \"./src/iframe_server/_impl.ts\");\n/* harmony import */ var _iframe_server_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/iframe_server/variables */ \"./src/iframe_server/variables.ts\");\n/* harmony import */ var _sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/i18n */ \"@sillytavern/scripts/i18n\");\n\n\n\nasync function handleIframe(event) {\n    if (!event.data)\n        return;\n    const handler = _iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__.iframe_handlers[event.data.request];\n    if (!handler) {\n        return;\n    }\n    let result = undefined;\n    try {\n        result = await handler(event);\n    }\n    catch (err) {\n        const error = err;\n        toastr.error((0,_sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_2__.t) `${(0,_iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__.getLogPrefix)(event)}${error.name + ': ' + error.message}${error.stack ? error.stack : ''}`);\n        console.error((0,_iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__.getLogPrefix)(event), error);\n    }\n    finally {\n        event.source.postMessage({\n            request: event.data.request + '_callback',\n            uid: event.data.uid,\n            result: result,\n        }, {\n            targetOrigin: '*',\n        });\n    }\n}\n(0,_iframe_server_variables__WEBPACK_IMPORTED_MODULE_1__.registerIframeVariableHandler)();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaWZyYW1lX3NlcnZlci9pbmRleC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXFGO0FBQ1g7QUFFNUI7QUFFdkMsS0FBSyxVQUFVLFlBQVksQ0FBQyxLQUFrQztJQUNuRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUk7UUFBRSxPQUFPO0lBRXhCLE1BQU0sT0FBTyxHQUFHLGdFQUFlLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNwRCxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDYixPQUFPO0lBQ1QsQ0FBQztJQUVELElBQUksTUFBTSxHQUFRLFNBQVMsQ0FBQztJQUM1QixJQUFJLENBQUM7UUFDSCxNQUFNLEdBQUcsTUFBTSxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7UUFDYixNQUFNLEtBQUssR0FBRyxHQUFZLENBQUM7UUFDM0IsTUFBTSxDQUFDLEtBQUssQ0FBQyw0REFBQyxJQUFHLGlFQUFZLENBQUMsS0FBSyxDQUFDLEdBQUcsS0FBSyxDQUFDLElBQUksR0FBRyxJQUFJLEdBQUcsS0FBSyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQzdHLE9BQU8sQ0FBQyxLQUFLLENBQUMsaUVBQVksQ0FBQyxLQUFLLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUM1QyxDQUFDO1lBQVMsQ0FBQztRQUNSLEtBQUssQ0FBQyxNQUE2QixDQUFDLFdBQVcsQ0FDOUM7WUFDRSxPQUFPLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLEdBQUcsV0FBVztZQUN6QyxHQUFHLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHO1lBQ25CLE1BQU0sRUFBRSxNQUFNO1NBQ2YsRUFDRDtZQUNFLFlBQVksRUFBRSxHQUFHO1NBQ2xCLENBQ0YsQ0FBQztJQUNKLENBQUM7QUFDSCxDQUFDO0FBRUQsdUZBQTZCLEVBQUUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9pZnJhbWVfc2VydmVyL2luZGV4LnRzPzE3OGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSWZyYW1lTWVzc2FnZSwgZ2V0TG9nUHJlZml4LCBpZnJhbWVfaGFuZGxlcnMgfSBmcm9tICdAL2lmcmFtZV9zZXJ2ZXIvX2ltcGwnO1xuaW1wb3J0IHsgcmVnaXN0ZXJJZnJhbWVWYXJpYWJsZUhhbmRsZXIgfSBmcm9tICdAL2lmcmFtZV9zZXJ2ZXIvdmFyaWFibGVzJztcblxuaW1wb3J0IHsgdCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2kxOG4nO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlSWZyYW1lKGV2ZW50OiBNZXNzYWdlRXZlbnQ8SWZyYW1lTWVzc2FnZT4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCFldmVudC5kYXRhKSByZXR1cm47XG5cbiAgY29uc3QgaGFuZGxlciA9IGlmcmFtZV9oYW5kbGVyc1tldmVudC5kYXRhLnJlcXVlc3RdO1xuICBpZiAoIWhhbmRsZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgcmVzdWx0OiBhbnkgPSB1bmRlZmluZWQ7XG4gIHRyeSB7XG4gICAgcmVzdWx0ID0gYXdhaXQgaGFuZGxlcihldmVudCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnN0IGVycm9yID0gZXJyIGFzIEVycm9yO1xuICAgIHRvYXN0ci5lcnJvcih0YCR7Z2V0TG9nUHJlZml4KGV2ZW50KX0ke2Vycm9yLm5hbWUgKyAnOiAnICsgZXJyb3IubWVzc2FnZX0ke2Vycm9yLnN0YWNrID8gZXJyb3Iuc3RhY2sgOiAnJ31gKTtcbiAgICBjb25zb2xlLmVycm9yKGdldExvZ1ByZWZpeChldmVudCksIGVycm9yKTtcbiAgfSBmaW5hbGx5IHtcbiAgICAoZXZlbnQuc291cmNlIGFzIE1lc3NhZ2VFdmVudFNvdXJjZSkucG9zdE1lc3NhZ2UoXG4gICAgICB7XG4gICAgICAgIHJlcXVlc3Q6IGV2ZW50LmRhdGEucmVxdWVzdCArICdfY2FsbGJhY2snLFxuICAgICAgICB1aWQ6IGV2ZW50LmRhdGEudWlkLFxuICAgICAgICByZXN1bHQ6IHJlc3VsdCxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHRhcmdldE9yaWdpbjogJyonLFxuICAgICAgfSxcbiAgICApO1xuICB9XG59XG5cbnJlZ2lzdGVySWZyYW1lVmFyaWFibGVIYW5kbGVyKCk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/iframe_server/index.ts\n")},"./src/iframe_server/variables.ts":
/*!****************************************!*\
  !*** ./src/iframe_server/variables.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkVariablesEvents: () => (/* binding */ checkVariablesEvents),\n/* harmony export */   clearTempVariables: () => (/* binding */ clearTempVariables),\n/* harmony export */   registerIframeVariableHandler: () => (/* binding */ registerIframeVariableHandler),\n/* harmony export */   shouldUpdateVariables: () => (/* binding */ shouldUpdateVariables)\n/* harmony export */ });\n/* harmony import */ var _iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/iframe_server/_impl */ \"./src/iframe_server/_impl.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n\n\n\nlet latest_set_variables_message_id = null;\nfunction registerIframeVariableHandler() {\n    (0,_iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__.registerIframeHandler)('[Variables][setVariables]', async (event) => {\n        const variables = event.data.variables;\n        const message_id = event.data.message_id;\n        if (isNaN(message_id)) {\n            return;\n        }\n        const chat_length = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().chat.length;\n        const latest_message_id = chat_length - 1;\n        if (message_id !== latest_message_id) {\n            console.info(` ${message_id}  ${latest_message_id} , . :\\n${JSON.stringify(variables, undefined, 2)} `);\n            return;\n        }\n        latest_set_variables_message_id = message_id;\n        if (\n        // @ts-ignore\n        !_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables ||\n            // @ts-ignore\n            typeof _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables !== 'object') {\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables = {};\n        }\n        if (\n        // @ts-ignore\n        !_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables ||\n            // @ts-ignore\n            typeof _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables !== 'object') {\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables = {};\n        }\n        if (_.has(variables, 'tempVariables')) {\n            // @ts-ignore\n            delete variables.tempVariables;\n        }\n        // @ts-ignore\n        const tempVariables = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables;\n        // @ts-ignore\n        const currentVariables = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables;\n        Object.keys(variables).forEach(key => {\n            // @ts-ignore\n            const newValue = variables[key];\n            const currentValue = currentVariables[key];\n            if (newValue !== currentValue) {\n                tempVariables[key] = newValue;\n            }\n        });\n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables = tempVariables;\n        (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.saveMetadataDebounced)();\n        console.info(`${(0,_iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__.getLogPrefix)(event)}, :\\n${JSON.stringify(variables, undefined, 2)} `);\n    });\n}\nfunction clearTempVariables() {\n    if (\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables &&\n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables &&\n        // @ts-ignore\n        Object.keys(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables).length > 0) {\n        console.log('[Var]Clearing tempVariables.');\n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables = {};\n        (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.saveMetadataDebounced)();\n    }\n}\nfunction shouldUpdateVariables(eventMesId) {\n    if (\n    // @ts-ignore\n    !_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables ||\n        // @ts-ignore\n        !_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables ||\n        // @ts-ignore\n        Object.keys(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables).length === 0) {\n        return;\n    }\n    if (eventMesId === latest_set_variables_message_id) {\n        console.log('[Var]MesId matches the latest setVariables, skipping ST variable update.');\n        return;\n    }\n    else if (latest_set_variables_message_id !== null && eventMesId > latest_set_variables_message_id) {\n        console.log('[Var]Event mesId is newer than setVariables mesId, updating ST variables.');\n        // @ts-ignore\n        const newVariables = { ..._sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables };\n        updateVariables(newVariables);\n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables = {};\n        console.log('[Var]TempVariables cleared.');\n    }\n    else {\n        console.log('[Var]Event mesId is older than setVariables mesId, ignoring.');\n    }\n}\nfunction updateVariables(newVariables) {\n    // @ts-ignore\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables) {\n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables = {};\n    }\n    // @ts-ignore\n    const currentVariables = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables;\n    for (const key in newVariables) {\n        if (_.has(newVariables, key)) {\n            currentVariables[key] = newVariables[key];\n        }\n    }\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables = currentVariables;\n    (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.saveMetadataDebounced)();\n}\nconst checkVariablesEvents = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.event_types.CHARACTER_MESSAGE_RENDERED, _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.event_types.USER_MESSAGE_RENDERED];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxPQUFPLENBQUMsR0FBRyxDQUFDLDZCQUE2QixDQUFDLENBQUM7SUFDN0MsQ0FBQztTQUFNLENBQUM7UUFDTixPQUFPLENBQUMsR0FBRyxDQUFDLDhEQUE4RCxDQUFDLENBQUM7SUFDOUUsQ0FBQztBQUNILENBQUM7QUFFRCxTQUFTLGVBQWUsQ0FBQyxZQUFpQztJQUN4RCxhQUFhO0lBQ2IsSUFBSSxDQUFDLDhEQUFhLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDN0IsYUFBYTtRQUNiLDhEQUFhLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztJQUMvQixDQUFDO0lBRUQsYUFBYTtJQUNiLE1BQU0sZ0JBQWdCLEdBQUcsOERBQWEsQ0FBQyxTQUFTLENBQUM7SUFFakQsS0FBSyxNQUFNLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUMvQixJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDN0IsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQzVDLENBQUM7SUFDSCxDQUFDO0lBRUQsYUFBYTtJQUNiLDhEQUFhLENBQUMsU0FBUyxHQUFHLGdCQUFnQixDQUFDO0lBRTNDLHNGQUFxQixFQUFFLENBQUM7QUFDMUIsQ0FBQztBQUVNLE1BQU0sb0JBQW9CLEdBQUcsQ0FBQyw0REFBVyxDQUFDLDBCQUEwQixFQUFFLDREQUFXLENBQUMscUJBQXFCLENBQUMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9pZnJhbWVfc2VydmVyL3ZhcmlhYmxlcy50cz8zNzFlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldExvZ1ByZWZpeCwgSWZyYW1lTWVzc2FnZSwgcmVnaXN0ZXJJZnJhbWVIYW5kbGVyIH0gZnJvbSAnQC9pZnJhbWVfc2VydmVyL19pbXBsJztcblxuaW1wb3J0IHsgY2hhdF9tZXRhZGF0YSwgZXZlbnRfdHlwZXMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGdldENvbnRleHQsIHNhdmVNZXRhZGF0YURlYm91bmNlZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuXG5pbnRlcmZhY2UgSWZyYW1lU2V0VmFyaWFibGVzIGV4dGVuZHMgSWZyYW1lTWVzc2FnZSB7XG4gIHJlcXVlc3Q6ICdbVmFyaWFibGVzXVtzZXRWYXJpYWJsZXNdJztcbiAgbWVzc2FnZV9pZDogbnVtYmVyO1xuICB2YXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT47XG59XG5cbmxldCBsYXRlc3Rfc2V0X3ZhcmlhYmxlc19tZXNzYWdlX2lkOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVySWZyYW1lVmFyaWFibGVIYW5kbGVyKCkge1xuICByZWdpc3RlcklmcmFtZUhhbmRsZXIoJ1tWYXJpYWJsZXNdW3NldFZhcmlhYmxlc10nLCBhc3luYyAoZXZlbnQ6IE1lc3NhZ2VFdmVudDxJZnJhbWVTZXRWYXJpYWJsZXM+KTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgY29uc3QgdmFyaWFibGVzID0gZXZlbnQuZGF0YS52YXJpYWJsZXM7XG4gICAgY29uc3QgbWVzc2FnZV9pZCA9IGV2ZW50LmRhdGEubWVzc2FnZV9pZDtcblxuICAgIGlmIChpc05hTihtZXNzYWdlX2lkKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBjaGF0X2xlbmd0aCA9IGdldENvbnRleHQoKS5jaGF0Lmxlbmd0aDtcbiAgICBjb25zdCBsYXRlc3RfbWVzc2FnZV9pZCA9IGNoYXRfbGVuZ3RoIC0gMTtcblxuICAgIGlmIChtZXNzYWdlX2lkICE9PSBsYXRlc3RfbWVzc2FnZV9pZCkge1xuICAgICAgY29uc29sZS5pbmZvKFxuICAgICAgICBg5Zug5Li6ICR7bWVzc2FnZV9pZH0g5qW85LiN5piv5pyA5paw5qW85bGCICR7bGF0ZXN0X21lc3NhZ2VfaWR9IOalvCwg5Y+W5raI6K6+572u6IGK5aSp5Y+Y6YePLiDljp/mnKzopoHorr7nva7nmoTlj5jph486XFxuJHtKU09OLnN0cmluZ2lmeShcbiAgICAgICAgICB2YXJpYWJsZXMsXG4gICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgIDIsXG4gICAgICAgICl9IGAsXG4gICAgICApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsYXRlc3Rfc2V0X3ZhcmlhYmxlc19tZXNzYWdlX2lkID0gbWVzc2FnZV9pZDtcbiAgICBpZiAoXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAhY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMgfHxcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIHR5cGVvZiBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyAhPT0gJ29iamVjdCdcbiAgICApIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzID0ge307XG4gICAgfVxuICAgIGlmIChcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICFjaGF0X21ldGFkYXRhLnZhcmlhYmxlcy50ZW1wVmFyaWFibGVzIHx8XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICB0eXBlb2YgY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMudGVtcFZhcmlhYmxlcyAhPT0gJ29iamVjdCdcbiAgICApIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzLnRlbXBWYXJpYWJsZXMgPSB7fTtcbiAgICB9XG4gICAgaWYgKF8uaGFzKHZhcmlhYmxlcywgJ3RlbXBWYXJpYWJsZXMnKSkge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgZGVsZXRlIHZhcmlhYmxlcy50ZW1wVmFyaWFibGVzO1xuICAgIH1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3QgdGVtcFZhcmlhYmxlcyA9IGNoYXRfbWV0YWRhdGEudmFyaWFibGVzLnRlbXBWYXJpYWJsZXM7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IGN1cnJlbnRWYXJpYWJsZXMgPSBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcztcbiAgICBPYmplY3Qua2V5cyh2YXJpYWJsZXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNvbnN0IG5ld1ZhbHVlID0gdmFyaWFibGVzW2tleV07XG4gICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSBjdXJyZW50VmFyaWFibGVzW2tleV07XG4gICAgICBpZiAobmV3VmFsdWUgIT09IGN1cnJlbnRWYWx1ZSkge1xuICAgICAgICB0ZW1wVmFyaWFibGVzW2tleV0gPSBuZXdWYWx1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMudGVtcFZhcmlhYmxlcyA9IHRlbXBWYXJpYWJsZXM7XG4gICAgc2F2ZU1ldGFkYXRhRGVib3VuY2VkKCk7XG5cbiAgICBjb25zb2xlLmluZm8oYCR7Z2V0TG9nUHJlZml4KGV2ZW50KX3orr7nva7ogYrlpKnlj5jph48sIOimgeiuvue9rueahOWPmOmHjzpcXG4ke0pTT04uc3RyaW5naWZ5KHZhcmlhYmxlcywgdW5kZWZpbmVkLCAyKX0gYCk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJUZW1wVmFyaWFibGVzKCkge1xuICBpZiAoXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzICYmXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzLnRlbXBWYXJpYWJsZXMgJiZcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgT2JqZWN0LmtleXMoY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMudGVtcFZhcmlhYmxlcykubGVuZ3RoID4gMFxuICApIHtcbiAgICBjb25zb2xlLmxvZygnW1Zhcl1DbGVhcmluZyB0ZW1wVmFyaWFibGVzLicpO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcy50ZW1wVmFyaWFibGVzID0ge307XG4gICAgc2F2ZU1ldGFkYXRhRGVib3VuY2VkKCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNob3VsZFVwZGF0ZVZhcmlhYmxlcyhldmVudE1lc0lkOiBudW1iZXIpIHtcbiAgaWYgKFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICAhY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMgfHxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgIWNoYXRfbWV0YWRhdGEudmFyaWFibGVzLnRlbXBWYXJpYWJsZXMgfHxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgT2JqZWN0LmtleXMoY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMudGVtcFZhcmlhYmxlcykubGVuZ3RoID09PSAwXG4gICkge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoZXZlbnRNZXNJZCA9PT0gbGF0ZXN0X3NldF92YXJpYWJsZXNfbWVzc2FnZV9pZCkge1xuICAgIGNvbnNvbGUubG9nKCdbVmFyXU1lc0lkIG1hdGNoZXMgdGhlIGxhdGVzdCBzZXRWYXJpYWJsZXMsIHNraXBwaW5nIFNUIHZhcmlhYmxlIHVwZGF0ZS4nKTtcbiAgICByZXR1cm47XG4gIH0gZWxzZSBpZiAobGF0ZXN0X3NldF92YXJpYWJsZXNfbWVzc2FnZV9pZCAhPT0gbnVsbCAmJiBldmVudE1lc0lkID4gbGF0ZXN0X3NldF92YXJpYWJsZXNfbWVzc2FnZV9pZCkge1xuICAgIGNvbnNvbGUubG9nKCdbVmFyXUV2ZW50IG1lc0lkIGlzIG5ld2VyIHRoYW4gc2V0VmFyaWFibGVzIG1lc0lkLCB1cGRhdGluZyBTVCB2YXJpYWJsZXMuJyk7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IG5ld1ZhcmlhYmxlcyA9IHsgLi4uY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMudGVtcFZhcmlhYmxlcyB9O1xuICAgIHVwZGF0ZVZhcmlhYmxlcyhuZXdWYXJpYWJsZXMpO1xuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzLnRlbXBWYXJpYWJsZXMgPSB7fTtcbiAgICBjb25zb2xlLmxvZygnW1Zhcl1UZW1wVmFyaWFibGVzIGNsZWFyZWQuJyk7XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS5sb2coJ1tWYXJdRXZlbnQgbWVzSWQgaXMgb2xkZXIgdGhhbiBzZXRWYXJpYWJsZXMgbWVzSWQsIGlnbm9yaW5nLicpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVZhcmlhYmxlcyhuZXdWYXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT4pIHtcbiAgLy8gQHRzLWlnbm9yZVxuICBpZiAoIWNoYXRfbWV0YWRhdGEudmFyaWFibGVzKSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzID0ge307XG4gIH1cblxuICAvLyBAdHMtaWdub3JlXG4gIGNvbnN0IGN1cnJlbnRWYXJpYWJsZXMgPSBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcztcblxuICBmb3IgKGNvbnN0IGtleSBpbiBuZXdWYXJpYWJsZXMpIHtcbiAgICBpZiAoXy5oYXMobmV3VmFyaWFibGVzLCBrZXkpKSB7XG4gICAgICBjdXJyZW50VmFyaWFibGVzW2tleV0gPSBuZXdWYXJpYWJsZXNba2V5XTtcbiAgICB9XG4gIH1cblxuICAvLyBAdHMtaWdub3JlXG4gIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzID0gY3VycmVudFZhcmlhYmxlcztcblxuICBzYXZlTWV0YWRhdGFEZWJvdW5jZWQoKTtcbn1cblxuZXhwb3J0IGNvbnN0IGNoZWNrVmFyaWFibGVzRXZlbnRzID0gW2V2ZW50X3R5cGVzLkNIQVJBQ1RFUl9NRVNTQUdFX1JFTkRFUkVELCBldmVudF90eXBlcy5VU0VSX01FU1NBR0VfUkVOREVSRURdO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/iframe_server/variables.ts\n")},"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _component_audio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/audio */ \"./src/component/audio/index.ts\");\n/* harmony import */ var _component_listener__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/listener */ \"./src/component/listener/index.ts\");\n/* harmony import */ var _component_main__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/main */ \"./src/component/main.ts\");\n/* harmony import */ var _component_message_iframe__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/message_iframe */ \"./src/component/message_iframe/index.ts\");\n/* harmony import */ var _component_reference__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/reference */ \"./src/component/reference/index.ts\");\n/* harmony import */ var _component_script_repository_index__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/script_repository/index */ \"./src/component/script_repository/index.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _function__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/function */ \"./src/function/index.ts\");\n/* harmony import */ var _slash_command_audio__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/slash_command/audio */ \"./src/slash_command/audio.ts\");\n/* harmony import */ var _slash_command_event__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/slash_command/event */ \"./src/slash_command/event.ts\");\n/* harmony import */ var _util_check_update__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/util/check_update */ \"./src/util/check_update.ts\");\n/* harmony import */ var _util_collapsible__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/util/collapsible */ \"./src/util/collapsible.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _component_variable_manager__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @/component/variable_manager */ \"./src/component/variable_manager/index.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _component_macrolike__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./component/macrolike */ \"./src/component/macrolike.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst defaultSettings = {\n    enabled_extension: true,\n    render: {\n        ..._component_message_iframe__WEBPACK_IMPORTED_MODULE_3__.defaultIframeSettings,\n    },\n    script: {\n        ..._component_script_repository_types__WEBPACK_IMPORTED_MODULE_6__.defaultScriptSettings,\n    },\n    audio: {\n        ..._component_audio__WEBPACK_IMPORTED_MODULE_0__.defaultAudioSettings,\n    },\n};\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.extensionFolderPath}/src/component`;\n/**\n * \n *  @param event \n * */\nfunction handleSettingPageChange(event) {\n    const target = $(event.currentTarget);\n    let id = target.attr('id');\n    if (id === undefined) {\n        return;\n    }\n    id = id.replace('-settings-title', '');\n    function resetAllTitleClasses() {\n        $('#main-settings-title').removeClass('title-item-active');\n        $('#render-settings-title').removeClass('title-item-active');\n        $('#script-settings-title').removeClass('title-item-active');\n        $('#toolbox-settings-title').removeClass('title-item-active');\n    }\n    function hideAllContentPanels() {\n        $('#main-settings-content').hide();\n        $('#render-settings-content').hide();\n        $('#script-settings-content').hide();\n        $('#toolbox-settings-content').hide();\n    }\n    resetAllTitleClasses();\n    hideAllContentPanels();\n    switch (id) {\n        case 'main':\n            $('#main-settings-title').addClass('title-item-active');\n            $('#main-settings-content').show();\n            break;\n        case 'render':\n            $('#render-settings-title').addClass('title-item-active');\n            $('#render-settings-content').show();\n            break;\n        case 'script':\n            $('#script-settings-title').addClass('title-item-active');\n            $('#script-settings-content').show();\n            break;\n        case 'toolbox':\n            $('#toolbox-settings-title').addClass('title-item-active');\n            $('#toolbox-settings-content').show();\n            break;\n    }\n}\n/** */\nasync function initExtensionPanel() {\n    const getContainer = () => $('#extensions_settings');\n    const windowHtml = await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_15__.renderExtensionTemplateAsync)(`${_util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.extensionFolderPath}`, 'index');\n    getContainer().append(windowHtml);\n    const $script_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_15__.renderExtensionTemplateAsync)(`${templatePath}/script_repository/public`, 'index'));\n    $('#script-settings-content').append($script_container);\n    const $iframe_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_15__.renderExtensionTemplateAsync)(`${templatePath}/message_iframe`, 'index'));\n    $('#render-settings-content').append($iframe_container);\n    const $audio_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_15__.renderExtensionTemplateAsync)(`${templatePath}/audio`, 'index'));\n    $('#toolbox-settings-content').append($audio_container);\n    const $reference_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_15__.renderExtensionTemplateAsync)(`${templatePath}/reference`, 'index'));\n    $('#extension-reference').append($reference_container);\n    const $variables_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_15__.renderExtensionTemplateAsync)(`${templatePath}/variable_manager/public`, 'variable_manager_entry'));\n    $('#toolbox-settings-content').prepend($variables_container);\n}\n/**\n * \n */\nasync function handleVersionUpdate() {\n    const currentVersion = await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_10__.getCurrentVersion)(_util_check_update__WEBPACK_IMPORTED_MODULE_10__.VERSION_FILE_PATH);\n    $('.version').text(`Ver ${currentVersion}`);\n    const isNeedUpdate = await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_10__.runCheckWithPath)();\n    if (isNeedUpdate) {\n        (0,_util_check_update__WEBPACK_IMPORTED_MODULE_10__.addVersionUpdateElement)();\n    }\n    $('#update-extension').on('click', async () => await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_10__.handleUpdateButton)());\n}\n/**\n * \n */\njQuery(async () => {\n    await initExtensionPanel();\n    //@ts-ignore\n    if (!_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_15__.extension_settings[_util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.extensionSettingName]) {\n        _.set(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_15__.extension_settings, _util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.extensionSettingName, defaultSettings);\n        // \n        _.unset(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_15__.extension_settings, _util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.extensionName);\n        (0,_util_check_update__WEBPACK_IMPORTED_MODULE_10__.showNewFeature)();\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_14__.saveSettings)();\n    }\n    (0,_function__WEBPACK_IMPORTED_MODULE_7__.initTavernHelperObject)();\n    // \n    $('#main-settings-title').addClass('title-item-active');\n    $('#main-settings-content').show();\n    $('#render-settings-content').hide();\n    $('#script-settings-content').hide();\n    $('#toolbox-settings-content').hide();\n    // \n    $('#main-settings-title').on('click', (event) => handleSettingPageChange(event));\n    $('#render-settings-title').on('click', (event) => handleSettingPageChange(event));\n    $('#script-settings-title').on('click', (event) => handleSettingPageChange(event));\n    $('#toolbox-settings-title').on('click', (event) => handleSettingPageChange(event));\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_14__.eventSource.once(_sillytavern_script__WEBPACK_IMPORTED_MODULE_14__.event_types.APP_READY, async () => {\n        (0,_component_main__WEBPACK_IMPORTED_MODULE_2__.initExtensionMainPanel)();\n        await handleVersionUpdate();\n        await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.initAudioComponents)();\n        (0,_slash_command_audio__WEBPACK_IMPORTED_MODULE_8__.initAudioSlashCommands)();\n        (0,_slash_command_event__WEBPACK_IMPORTED_MODULE_9__.initSlashEventEmit)();\n        await (0,_component_script_repository_index__WEBPACK_IMPORTED_MODULE_5__.buildScriptRepository)();\n        await (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_3__.initIframePanel)();\n        (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_16__.renderAllMacros)();\n        await (0,_component_reference__WEBPACK_IMPORTED_MODULE_4__.initReference)();\n        await (0,_component_listener__WEBPACK_IMPORTED_MODULE_1__.initListener)();\n        (0,_component_variable_manager__WEBPACK_IMPORTED_MODULE_13__.initVariableManager)();\n    });\n    // Collapsible\n    _util_collapsible__WEBPACK_IMPORTED_MODULE_11__.Collapsible.initAll('.collapsible', {\n        headerSelector: 'div:first-child',\n        contentSelector: '.collapsible-content',\n        initiallyExpanded: false,\n        animationDuration: {\n            expand: 280,\n            collapse: 250,\n        },\n    });\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixFQUFFLENBQUM7SUFDeEIsQ0FBQyxDQUFDLENBQUM7SUFFSCxvQkFBb0I7SUFDcEIsMkRBQVcsQ0FBQyxPQUFPLENBQUMsY0FBYyxFQUFFO1FBQ2xDLGNBQWMsRUFBRSxpQkFBaUI7UUFDakMsZUFBZSxFQUFFLHNCQUFzQjtRQUN2QyxpQkFBaUIsRUFBRSxLQUFLO1FBQ3hCLGlCQUFpQixFQUFFO1lBQ2pCLE1BQU0sRUFBRSxHQUFHO1lBQ1gsUUFBUSxFQUFFLEdBQUc7U0FDZDtLQUNGLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2luZGV4LnRzP2ZmYjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVmYXVsdEF1ZGlvU2V0dGluZ3MsIGluaXRBdWRpb0NvbXBvbmVudHMgfSBmcm9tICdAL2NvbXBvbmVudC9hdWRpbyc7XG5pbXBvcnQgeyBpbml0TGlzdGVuZXIgfSBmcm9tICdAL2NvbXBvbmVudC9saXN0ZW5lcic7XG5pbXBvcnQgeyBpbml0RXh0ZW5zaW9uTWFpblBhbmVsIH0gZnJvbSAnQC9jb21wb25lbnQvbWFpbic7XG5pbXBvcnQgeyBkZWZhdWx0SWZyYW1lU2V0dGluZ3MsIGluaXRJZnJhbWVQYW5lbCB9IGZyb20gJ0AvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lJztcbmltcG9ydCB7IGluaXRSZWZlcmVuY2UgfSBmcm9tICdAL2NvbXBvbmVudC9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgYnVpbGRTY3JpcHRSZXBvc2l0b3J5IH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvaW5kZXgnO1xuaW1wb3J0IHsgZGVmYXVsdFNjcmlwdFNldHRpbmdzIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvdHlwZXMnO1xuaW1wb3J0IHsgaW5pdFRhdmVybkhlbHBlck9iamVjdCB9IGZyb20gJ0AvZnVuY3Rpb24nO1xuaW1wb3J0IHsgaW5pdEF1ZGlvU2xhc2hDb21tYW5kcyB9IGZyb20gJ0Avc2xhc2hfY29tbWFuZC9hdWRpbyc7XG5pbXBvcnQgeyBpbml0U2xhc2hFdmVudEVtaXQgfSBmcm9tICdAL3NsYXNoX2NvbW1hbmQvZXZlbnQnO1xuaW1wb3J0IHtcbiAgYWRkVmVyc2lvblVwZGF0ZUVsZW1lbnQsXG4gIGdldEN1cnJlbnRWZXJzaW9uLFxuICBoYW5kbGVVcGRhdGVCdXR0b24sXG4gIHJ1bkNoZWNrV2l0aFBhdGgsXG4gIHNob3dOZXdGZWF0dXJlLFxuICBWRVJTSU9OX0ZJTEVfUEFUSCxcbn0gZnJvbSAnQC91dGlsL2NoZWNrX3VwZGF0ZSc7XG5pbXBvcnQgeyBDb2xsYXBzaWJsZSB9IGZyb20gJ0AvdXRpbC9jb2xsYXBzaWJsZSc7XG5pbXBvcnQgeyBleHRlbnNpb25Gb2xkZXJQYXRoLCBleHRlbnNpb25OYW1lLCBleHRlbnNpb25TZXR0aW5nTmFtZSB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcbmltcG9ydCB7IGluaXRWYXJpYWJsZU1hbmFnZXIgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyJztcblxuaW1wb3J0IHsgZXZlbnRfdHlwZXMsIGV2ZW50U291cmNlLCBzYXZlU2V0dGluZ3MgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGV4dGVuc2lvbl9zZXR0aW5ncywgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuaW1wb3J0IHsgcmVuZGVyQWxsTWFjcm9zIH0gZnJvbSAnLi9jb21wb25lbnQvbWFjcm9saWtlJztcblxuY29uc3QgZGVmYXVsdFNldHRpbmdzID0ge1xuICBlbmFibGVkX2V4dGVuc2lvbjogdHJ1ZSxcbiAgcmVuZGVyOiB7XG4gICAgLi4uZGVmYXVsdElmcmFtZVNldHRpbmdzLFxuICB9LFxuICBzY3JpcHQ6IHtcbiAgICAuLi5kZWZhdWx0U2NyaXB0U2V0dGluZ3MsXG4gIH0sXG4gIGF1ZGlvOiB7XG4gICAgLi4uZGVmYXVsdEF1ZGlvU2V0dGluZ3MsXG4gIH0sXG59O1xuXG5jb25zdCB0ZW1wbGF0ZVBhdGggPSBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50YDtcblxuLyoqXG4gKiDorr7nva7pobXpnaLliIfmjaJcbiAqICBAcGFyYW0gZXZlbnQg5LqL5Lu25a+56LGhXG4gKiAqL1xuZnVuY3Rpb24gaGFuZGxlU2V0dGluZ1BhZ2VDaGFuZ2UoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSB7XG4gIGNvbnN0IHRhcmdldCA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gIGxldCBpZCA9IHRhcmdldC5hdHRyKCdpZCcpO1xuICBpZiAoaWQgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybjtcbiAgfVxuICBpZCA9IGlkLnJlcGxhY2UoJy1zZXR0aW5ncy10aXRsZScsICcnKTtcblxuICBmdW5jdGlvbiByZXNldEFsbFRpdGxlQ2xhc3NlcygpIHtcbiAgICAkKCcjbWFpbi1zZXR0aW5ncy10aXRsZScpLnJlbW92ZUNsYXNzKCd0aXRsZS1pdGVtLWFjdGl2ZScpO1xuICAgICQoJyNyZW5kZXItc2V0dGluZ3MtdGl0bGUnKS5yZW1vdmVDbGFzcygndGl0bGUtaXRlbS1hY3RpdmUnKTtcbiAgICAkKCcjc2NyaXB0LXNldHRpbmdzLXRpdGxlJykucmVtb3ZlQ2xhc3MoJ3RpdGxlLWl0ZW0tYWN0aXZlJyk7XG4gICAgJCgnI3Rvb2xib3gtc2V0dGluZ3MtdGl0bGUnKS5yZW1vdmVDbGFzcygndGl0bGUtaXRlbS1hY3RpdmUnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhpZGVBbGxDb250ZW50UGFuZWxzKCkge1xuICAgICQoJyNtYWluLXNldHRpbmdzLWNvbnRlbnQnKS5oaWRlKCk7XG4gICAgJCgnI3JlbmRlci1zZXR0aW5ncy1jb250ZW50JykuaGlkZSgpO1xuICAgICQoJyNzY3JpcHQtc2V0dGluZ3MtY29udGVudCcpLmhpZGUoKTtcbiAgICAkKCcjdG9vbGJveC1zZXR0aW5ncy1jb250ZW50JykuaGlkZSgpO1xuICB9XG5cbiAgcmVzZXRBbGxUaXRsZUNsYXNzZXMoKTtcbiAgaGlkZUFsbENvbnRlbnRQYW5lbHMoKTtcblxuICBzd2l0Y2ggKGlkKSB7XG4gICAgY2FzZSAnbWFpbic6XG4gICAgICAkKCcjbWFpbi1zZXR0aW5ncy10aXRsZScpLmFkZENsYXNzKCd0aXRsZS1pdGVtLWFjdGl2ZScpO1xuICAgICAgJCgnI21haW4tc2V0dGluZ3MtY29udGVudCcpLnNob3coKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3JlbmRlcic6XG4gICAgICAkKCcjcmVuZGVyLXNldHRpbmdzLXRpdGxlJykuYWRkQ2xhc3MoJ3RpdGxlLWl0ZW0tYWN0aXZlJyk7XG4gICAgICAkKCcjcmVuZGVyLXNldHRpbmdzLWNvbnRlbnQnKS5zaG93KCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdzY3JpcHQnOlxuICAgICAgJCgnI3NjcmlwdC1zZXR0aW5ncy10aXRsZScpLmFkZENsYXNzKCd0aXRsZS1pdGVtLWFjdGl2ZScpO1xuICAgICAgJCgnI3NjcmlwdC1zZXR0aW5ncy1jb250ZW50Jykuc2hvdygpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAndG9vbGJveCc6XG4gICAgICAkKCcjdG9vbGJveC1zZXR0aW5ncy10aXRsZScpLmFkZENsYXNzKCd0aXRsZS1pdGVtLWFjdGl2ZScpO1xuICAgICAgJCgnI3Rvb2xib3gtc2V0dGluZ3MtY29udGVudCcpLnNob3coKTtcbiAgICAgIGJyZWFrO1xuICB9XG59XG5cbi8qKueVjOmdoue7n+S4gOWKoOi9vSAqL1xuYXN5bmMgZnVuY3Rpb24gaW5pdEV4dGVuc2lvblBhbmVsKCkge1xuICBjb25zdCBnZXRDb250YWluZXIgPSAoKSA9PiAkKCcjZXh0ZW5zaW9uc19zZXR0aW5ncycpO1xuICBjb25zdCB3aW5kb3dIdG1sID0gYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhgJHtleHRlbnNpb25Gb2xkZXJQYXRofWAsICdpbmRleCcpO1xuICBnZXRDb250YWluZXIoKS5hcHBlbmQod2luZG93SHRtbCk7XG4gIGNvbnN0ICRzY3JpcHRfY29udGFpbmVyID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH0vc2NyaXB0X3JlcG9zaXRvcnkvcHVibGljYCwgJ2luZGV4JykpO1xuICAkKCcjc2NyaXB0LXNldHRpbmdzLWNvbnRlbnQnKS5hcHBlbmQoJHNjcmlwdF9jb250YWluZXIpO1xuICBjb25zdCAkaWZyYW1lX2NvbnRhaW5lciA9ICQoYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhgJHt0ZW1wbGF0ZVBhdGh9L21lc3NhZ2VfaWZyYW1lYCwgJ2luZGV4JykpO1xuICAkKCcjcmVuZGVyLXNldHRpbmdzLWNvbnRlbnQnKS5hcHBlbmQoJGlmcmFtZV9jb250YWluZXIpO1xuICBjb25zdCAkYXVkaW9fY29udGFpbmVyID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH0vYXVkaW9gLCAnaW5kZXgnKSk7XG4gICQoJyN0b29sYm94LXNldHRpbmdzLWNvbnRlbnQnKS5hcHBlbmQoJGF1ZGlvX2NvbnRhaW5lcik7XG4gIGNvbnN0ICRyZWZlcmVuY2VfY29udGFpbmVyID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH0vcmVmZXJlbmNlYCwgJ2luZGV4JykpO1xuICAkKCcjZXh0ZW5zaW9uLXJlZmVyZW5jZScpLmFwcGVuZCgkcmVmZXJlbmNlX2NvbnRhaW5lcik7XG4gIGNvbnN0ICR2YXJpYWJsZXNfY29udGFpbmVyID0gJChcbiAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH0vdmFyaWFibGVfbWFuYWdlci9wdWJsaWNgLCAndmFyaWFibGVfbWFuYWdlcl9lbnRyeScpLFxuICApO1xuICAkKCcjdG9vbGJveC1zZXR0aW5ncy1jb250ZW50JykucHJlcGVuZCgkdmFyaWFibGVzX2NvbnRhaW5lcik7XG59XG5cbi8qKlxuICog54mI5pys5o6n5Yi2XG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVZlcnNpb25VcGRhdGUoKSB7XG4gIGNvbnN0IGN1cnJlbnRWZXJzaW9uID0gYXdhaXQgZ2V0Q3VycmVudFZlcnNpb24oVkVSU0lPTl9GSUxFX1BBVEgpO1xuICAkKCcudmVyc2lvbicpLnRleHQoYFZlciAke2N1cnJlbnRWZXJzaW9ufWApO1xuICBjb25zdCBpc05lZWRVcGRhdGUgPSBhd2FpdCBydW5DaGVja1dpdGhQYXRoKCk7XG4gIGlmIChpc05lZWRVcGRhdGUpIHtcbiAgICBhZGRWZXJzaW9uVXBkYXRlRWxlbWVudCgpO1xuICB9XG4gICQoJyN1cGRhdGUtZXh0ZW5zaW9uJykub24oJ2NsaWNrJywgYXN5bmMgKCkgPT4gYXdhaXQgaGFuZGxlVXBkYXRlQnV0dG9uKCkpO1xufVxuXG4vKipcbiAqIOWIneWni+WMluaJqeWxlemdouadv1xuICovXG5qUXVlcnkoYXN5bmMgKCkgPT4ge1xuICBhd2FpdCBpbml0RXh0ZW5zaW9uUGFuZWwoKTtcbiAgLy9AdHMtaWdub3JlXG4gIGlmICghZXh0ZW5zaW9uX3NldHRpbmdzW2V4dGVuc2lvblNldHRpbmdOYW1lXSkge1xuICAgIF8uc2V0KGV4dGVuc2lvbl9zZXR0aW5ncywgZXh0ZW5zaW9uU2V0dGluZ05hbWUsIGRlZmF1bHRTZXR0aW5ncyk7XG4gICAgLy8g5Yig6Zmk5pen54mI6YWN572uXG4gICAgXy51bnNldChleHRlbnNpb25fc2V0dGluZ3MsIGV4dGVuc2lvbk5hbWUpO1xuICAgIHNob3dOZXdGZWF0dXJlKCk7XG4gICAgYXdhaXQgc2F2ZVNldHRpbmdzKCk7XG4gIH1cblxuICBpbml0VGF2ZXJuSGVscGVyT2JqZWN0KCk7XG5cbiAgLy8g6buY6K6k5pi+56S65Li76K6+572u55WM6Z2iXG4gICQoJyNtYWluLXNldHRpbmdzLXRpdGxlJykuYWRkQ2xhc3MoJ3RpdGxlLWl0ZW0tYWN0aXZlJyk7XG4gICQoJyNtYWluLXNldHRpbmdzLWNvbnRlbnQnKS5zaG93KCk7XG4gICQoJyNyZW5kZXItc2V0dGluZ3MtY29udGVudCcpLmhpZGUoKTtcbiAgJCgnI3NjcmlwdC1zZXR0aW5ncy1jb250ZW50JykuaGlkZSgpO1xuICAkKCcjdG9vbGJveC1zZXR0aW5ncy1jb250ZW50JykuaGlkZSgpO1xuXG4gIC8vIOebkeWQrOiuvue9rumAiemhueWNoeWIh+aNolxuICAkKCcjbWFpbi1zZXR0aW5ncy10aXRsZScpLm9uKCdjbGljaycsIChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IGhhbmRsZVNldHRpbmdQYWdlQ2hhbmdlKGV2ZW50KSk7XG4gICQoJyNyZW5kZXItc2V0dGluZ3MtdGl0bGUnKS5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiBoYW5kbGVTZXR0aW5nUGFnZUNoYW5nZShldmVudCkpO1xuICAkKCcjc2NyaXB0LXNldHRpbmdzLXRpdGxlJykub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlU2V0dGluZ1BhZ2VDaGFuZ2UoZXZlbnQpKTtcbiAgJCgnI3Rvb2xib3gtc2V0dGluZ3MtdGl0bGUnKS5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiBoYW5kbGVTZXR0aW5nUGFnZUNoYW5nZShldmVudCkpO1xuXG4gIGV2ZW50U291cmNlLm9uY2UoZXZlbnRfdHlwZXMuQVBQX1JFQURZLCBhc3luYyAoKSA9PiB7XG4gICAgaW5pdEV4dGVuc2lvbk1haW5QYW5lbCgpO1xuICAgIGF3YWl0IGhhbmRsZVZlcnNpb25VcGRhdGUoKTtcbiAgICBhd2FpdCBpbml0QXVkaW9Db21wb25lbnRzKCk7XG4gICAgaW5pdEF1ZGlvU2xhc2hDb21tYW5kcygpO1xuICAgIGluaXRTbGFzaEV2ZW50RW1pdCgpO1xuICAgIGF3YWl0IGJ1aWxkU2NyaXB0UmVwb3NpdG9yeSgpO1xuICAgIGF3YWl0IGluaXRJZnJhbWVQYW5lbCgpO1xuICAgIHJlbmRlckFsbE1hY3JvcygpO1xuICAgIGF3YWl0IGluaXRSZWZlcmVuY2UoKTtcbiAgICBhd2FpdCBpbml0TGlzdGVuZXIoKTtcbiAgICBpbml0VmFyaWFibGVNYW5hZ2VyKCk7XG4gIH0pO1xuXG4gIC8vIOmAmueUqENvbGxhcHNpYmxl5oqY5Y+g5Yqf6IO9XG4gIENvbGxhcHNpYmxlLmluaXRBbGwoJy5jb2xsYXBzaWJsZScsIHtcbiAgICBoZWFkZXJTZWxlY3RvcjogJ2RpdjpmaXJzdC1jaGlsZCcsXG4gICAgY29udGVudFNlbGVjdG9yOiAnLmNvbGxhcHNpYmxlLWNvbnRlbnQnLFxuICAgIGluaXRpYWxseUV4cGFuZGVkOiBmYWxzZSxcbiAgICBhbmltYXRpb25EdXJhdGlvbjoge1xuICAgICAgZXhwYW5kOiAyODAsXG4gICAgICBjb2xsYXBzZTogMjUwLFxuICAgIH0sXG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/index.ts\n")},"./src/script_url.ts":
/*!***************************!*\
  !*** ./src/script_url.ts ***!
  \***************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   script_url: () => (/* binding */ script_url)\n/* harmony export */ });\n/* harmony import */ var _util_map_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/map_util */ \"./src/util/map_util.ts\");\n\nfunction createObjectURLFromScript(code) {\n    return URL.createObjectURL(new Blob([code], { type: 'application/javascript' }));\n}\nclass ScriptUrl {\n    map = new Map();\n    get(name) {\n        return this.map.get(name);\n    }\n    set(name, code) {\n        this.map.set(name, createObjectURLFromScript(code));\n    }\n    delete(name) {\n        const url = (0,_util_map_util__WEBPACK_IMPORTED_MODULE_0__.extract)(this.map, name);\n        if (!url) {\n            return url;\n        }\n        URL.revokeObjectURL(url);\n        return url;\n    }\n}\nconst script_url = new ScriptUrl();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2NyaXB0X3VybC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUEwQztBQUUxQyxTQUFTLHlCQUF5QixDQUFDLElBQVk7SUFDN0MsT0FBTyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsd0JBQXdCLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDbkYsQ0FBQztBQUVELE1BQU0sU0FBUztJQUNMLEdBQUcsR0FBd0IsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUV0QyxHQUFHLENBQUMsSUFBWTtRQUNyQixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFDTSxHQUFHLENBQUMsSUFBWSxFQUFFLElBQVk7UUFDbkMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLHlCQUF5QixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUNNLE1BQU0sQ0FBQyxJQUFZO1FBQ3hCLE1BQU0sR0FBRyxHQUFHLHVEQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDVCxPQUFPLEdBQUcsQ0FBQztRQUNiLENBQUM7UUFDRCxHQUFHLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3pCLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztDQUNGO0FBRU0sTUFBTSxVQUFVLEdBQUcsSUFBSSxTQUFTLEVBQUUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9zY3JpcHRfdXJsLnRzPzUzZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXh0cmFjdCB9IGZyb20gJ0AvdXRpbC9tYXBfdXRpbCc7XG5cbmZ1bmN0aW9uIGNyZWF0ZU9iamVjdFVSTEZyb21TY3JpcHQoY29kZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIFVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2NvZGVdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JyB9KSk7XG59XG5cbmNsYXNzIFNjcmlwdFVybCB7XG4gIHByaXZhdGUgbWFwOiBNYXA8c3RyaW5nLCBzdHJpbmc+ID0gbmV3IE1hcCgpO1xuXG4gIHB1YmxpYyBnZXQobmFtZTogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5tYXAuZ2V0KG5hbWUpO1xuICB9XG4gIHB1YmxpYyBzZXQobmFtZTogc3RyaW5nLCBjb2RlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLm1hcC5zZXQobmFtZSwgY3JlYXRlT2JqZWN0VVJMRnJvbVNjcmlwdChjb2RlKSk7XG4gIH1cbiAgcHVibGljIGRlbGV0ZShuYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IHVybCA9IGV4dHJhY3QodGhpcy5tYXAsIG5hbWUpO1xuICAgIGlmICghdXJsKSB7XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH1cbiAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxufVxuXG5leHBvcnQgY29uc3Qgc2NyaXB0X3VybCA9IG5ldyBTY3JpcHRVcmwoKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/script_url.ts\n")},"./src/slash_command/audio.ts":
/*!************************************!*\
  !*** ./src/slash_command/audio.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   audioEnable: () => (/* binding */ audioEnable),\n/* harmony export */   audioImport: () => (/* binding */ audioImport),\n/* harmony export */   audioMode: () => (/* binding */ audioMode),\n/* harmony export */   audioPlay: () => (/* binding */ audioPlay),\n/* harmony export */   audioSelect: () => (/* binding */ audioSelect),\n/* harmony export */   initAudioSlashCommands: () => (/* binding */ initAudioSlashCommands)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommand */ \"@sillytavern/scripts/slash-commands/SlashCommand\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandArgument */ \"@sillytavern/scripts/slash-commands/SlashCommandArgument\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandCommonEnumsProvider */ \"@sillytavern/scripts/slash-commands/SlashCommandCommonEnumsProvider\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandEnumValue */ \"@sillytavern/scripts/slash-commands/SlashCommandEnumValue\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandParser */ \"@sillytavern/scripts/slash-commands/SlashCommandParser\");\n/* harmony import */ var _component_audio__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../component/audio */ \"./src/component/audio/index.ts\");\n\n\n\n\n\n\n\n\n\n/**\n * \n */\nasync function audioMode(args) {\n    const type = args.type.toLowerCase();\n    const mode = args.mode.toLowerCase();\n    if (!['bgm', 'ambient'].includes(type) || !['repeat', 'random', 'single', 'stop'].includes(mode)) {\n        console.warn('WARN: Invalid arguments for /audiomode command');\n        return '';\n    }\n    if (type === 'bgm') {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('audio.bgm_mode', mode);\n        const iconMap = {\n            repeat: 'fa-repeat',\n            random: 'fa-random',\n            single: 'fa-redo-alt',\n            stop: 'fa-cancel',\n        };\n        $('#audio_bgm_mode_icon').removeClass('fa-repeat fa-random fa-redo-alt fa-cancel');\n        $('#audio_bgm_mode_icon').addClass(iconMap[mode]);\n    }\n    else if (type === 'ambient') {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('audio.ambient_mode', mode);\n        const iconMap = {\n            repeat: 'fa-repeat',\n            random: 'fa-random',\n            single: 'fa-redo-alt',\n            stop: 'fa-cancel',\n        };\n        $('#audio_ambient_mode_icon').removeClass('fa-repeat fa-random fa-redo-alt fa-cancel');\n        $('#audio_ambient_mode_icon').addClass(iconMap[mode]);\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveSettingsDebounced)();\n    return '';\n}\n/**\n * \n */\nasync function audioEnable(args) {\n    const type = args.type.toLowerCase();\n    const state = (args.state || 'true').toLowerCase();\n    if (!type) {\n        console.warn('WARN: Missing arguments for /audioenable command');\n        return '';\n    }\n    if (type === 'bgm') {\n        if (state === 'true') {\n            $('#enable_bgm').prop('checked', true);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.onAudioEnabledClick)('bgm');\n        }\n        else if (state === 'false') {\n            $('#enable_bgm').prop('checked', false);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.onAudioEnabledClick)('bgm');\n        }\n    }\n    else if (type === 'ambient') {\n        if (state === 'true') {\n            $('#enable_ambient').prop('checked', true);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.onAudioEnabledClick)('ambient');\n        }\n        else if (state === 'false') {\n            $('#enable_ambient').prop('checked', false);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.onAudioEnabledClick)('ambient');\n        }\n    }\n    return '';\n}\n/**\n * /\n */\nasync function audioPlay(args) {\n    const type = args.type.toLowerCase();\n    const play = (args.play || 'true').toLowerCase();\n    if (!type) {\n        console.warn('WARN: Missing arguments for /audioplaypause command');\n        return '';\n    }\n    if (type === 'bgm') {\n        if (play === 'true') {\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.playAudio)('bgm');\n        }\n        else if (play === 'false') {\n            const audioElement = $('#audio_bgm')[0];\n            audioElement.pause();\n        }\n    }\n    else if (type === 'ambient') {\n        if (play === 'true') {\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.playAudio)('ambient');\n        }\n        else if (play === 'false') {\n            const audioElement = $('#audio_ambient')[0];\n            audioElement.pause();\n        }\n    }\n    return '';\n}\n/**\n * \n */\nasync function audioImport(args, url) {\n    const type = args.type.toLowerCase();\n    const play = (args.play || 'true').toLowerCase();\n    if (!type || !url) {\n        console.warn('WARN: Missing arguments for /audioimport command');\n        return '';\n    }\n    const urlArray = url\n        .split(',')\n        .map((url) => url.trim())\n        .filter((url) => url !== '')\n        .filter((url, index, self) => self.indexOf(url) === index);\n    if (urlArray.length === 0) {\n        console.warn('WARN: Invalid or empty URLs provided.');\n        return '';\n    }\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables) {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables = {};\n    }\n    const typeKey = type === 'bgm' ? 'bgmurl' : 'ambienturl';\n    const existingUrls = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables[typeKey] || [];\n    const mergedUrls = [...new Set([...urlArray, ...existingUrls])];\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables[typeKey] = mergedUrls;\n    (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.saveMetadataDebounced)();\n    if (type === 'bgm') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.updateAudioSelect)('bgm');\n    }\n    else if (type === 'ambient') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.updateAudioSelect)('ambient');\n    }\n    if (play === 'true' && urlArray[0]) {\n        const selectedUrl = urlArray[0];\n        if (type === 'bgm') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('audio.bgm_selected', selectedUrl);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.updateAudio)('bgm', true);\n        }\n        else if (type === 'ambient') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('audio.ambient_selected', selectedUrl);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.updateAudio)('ambient', true);\n        }\n    }\n    return '';\n}\n/**\n * \n */\nasync function audioSelect(args, url) {\n    const type = args.type.toLowerCase();\n    if (!url) {\n        console.warn('WARN: Missing URL for /audioselect command');\n        return '';\n    }\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables) {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables = {};\n    }\n    const playlist = type === 'bgm' ? _component_audio__WEBPACK_IMPORTED_MODULE_8__.list_BGMS : _component_audio__WEBPACK_IMPORTED_MODULE_8__.list_ambients;\n    const typeKey = type === 'bgm' ? 'bgmurl' : 'ambienturl';\n    if (playlist && playlist.includes(url)) {\n        if (type === 'bgm') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('audio.bgm_selected', url);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.updateAudio)('bgm', true);\n        }\n        else if (type === 'ambient') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('audio.ambient_selected', url);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.updateAudio)('ambient', true);\n        }\n        return '';\n    }\n    const existingUrls = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables[typeKey] || [];\n    const mergedUrls = [...new Set([url, ...existingUrls])];\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables[typeKey] = mergedUrls;\n    (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.saveMetadataDebounced)();\n    if (type === 'bgm') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.updateAudioSelect)('bgm');\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('audio.bgm_selected', url);\n        await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.updateAudio)('bgm', true);\n    }\n    else if (type === 'ambient') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.updateAudioSelect)('ambient');\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.saveSettingValue)('audio.ambient_selected', url);\n        await (0,_component_audio__WEBPACK_IMPORTED_MODULE_8__.updateAudio)('ambient', true);\n    }\n    return '';\n}\n/**\n *  slash command\n */\nfunction initAudioSlashCommands() {\n    //  audioselect \n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_7__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_3__.SlashCommand.fromProps({\n        name: 'audioselect',\n        callback: audioSelect,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: ' (bgm  ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n        ],\n        unnamedArgumentList: [new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandArgument('url', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.STRING], true)],\n        helpString: `\n        <div>\n            \n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioselect type=bgm https://example.com/song.mp3</code></pre>\n                    \n                </li>\n                <li>\n                    <pre><code>/audioselect type=ambient https://example.com/sound.mp3</code></pre>\n                    \n                </li>\n            </ul>\n        </div>\n      `,\n    }));\n    //  audioimport \n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_7__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_3__.SlashCommand.fromProps({\n        name: 'audioimport',\n        callback: audioImport,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: ' (bgm  ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandNamedArgument.fromProps({\n                name: 'play',\n                description: '',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.BOOLEAN],\n                defaultValue: 'true',\n                isRequired: false,\n            }),\n        ],\n        unnamedArgumentList: [new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandArgument('url', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.STRING], true)],\n        helpString: `\n        <div>\n            \n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioimport type=bgm https://example.com/song1.mp3,https://example.com/song2.mp3</code></pre>\n                     BGM \n                </li>\n                <li>\n                    <pre><code>/audioimport type=ambient play=false url=https://example.com/sound1.mp3,https://example.com/sound2.mp3 </code></pre>\n                     ()\n                </li>\n            </ul>\n        </div>\n      `,\n    }));\n    //  audioplay \n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_7__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_3__.SlashCommand.fromProps({\n        name: 'audioplay',\n        callback: audioPlay,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: ' (bgm  ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandNamedArgument('play', '', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.STRING], true, false, 'true', _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.commonEnumProviders.boolean('trueFalse')()),\n        ],\n        helpString: `\n        <div>\n            \n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioplay type=bgm</code></pre>\n                    \n                </li>\n                <li>\n                    <pre><code>/audioplay type=ambient play=false</code></pre>\n                    \n                </li>\n            </ul>\n        </div>\n      `,\n    }));\n    //  audioenable \n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_7__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_3__.SlashCommand.fromProps({\n        name: 'audioenable',\n        callback: audioEnable,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: ' (bgm  ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandNamedArgument('state', '', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.STRING], false, false, 'true', _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.commonEnumProviders.boolean('trueFalse')()),\n        ],\n        helpString: `\n        <div>\n            \n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioenable type=bgm state=true</code></pre>\n                    \n                </li>\n                <li>\n                    <pre><code>/audioenable type=ambient state=false</code></pre>\n                    \n                </li>\n            </ul>\n        </div>\n    `,\n    }));\n    //  audiomode \n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_7__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_3__.SlashCommand.fromProps({\n        name: 'audiomode',\n        callback: audioMode,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: ' (bgm  ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.SlashCommandNamedArgument.fromProps({\n                name: 'mode',\n                description: '',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_4__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('repeat', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.loop),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('random', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.shuffle),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('single', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.redo),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.SlashCommandEnumValue('stop', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_6__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_5__.enumIcons.stop),\n                ],\n                isRequired: true,\n            }),\n        ],\n        helpString: `\n        <div>\n            \n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audiomode type=bgm mode=repeat</code></pre>\n                    \n                </li>\n                <li>\n                    <pre><code>/audiomode type=ambient mode=random</code></pre>\n                    \n                </li>\n                <li>\n                    <pre><code>/audiomode type=bgm mode=single</code></pre>\n                    \n                </li>\n                <li>\n                    <pre><code>/audiomode type=ambient mode=stop</code></pre>\n                    \n                </li>\n            </ul>\n        </div>\n    `,\n    }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2xhc2hfY29tbWFuZC9hdWRpby50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBOEQ7QUFFYTtBQUNIO0FBQ1E7QUFLZDtBQUNtRDtBQUNSO0FBQ2pCO0FBU2hFO0FBTTVCOztHQUVHO0FBQ0ksS0FBSyxVQUFVLFNBQVMsQ0FBQyxJQUFvQztJQUNsRSxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3JDLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFFckMsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFLFNBQVMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7UUFDakcsT0FBTyxDQUFDLElBQUksQ0FBQyxnREFBZ0QsQ0FBQyxDQUFDO1FBQy9ELE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUVELElBQUksSUFBSSxLQUFLLEtBQUssRUFBRSxDQUFDO1FBQ25CLDJFQUFnQixDQUFDLGdCQUFnQixFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3pDLE1BQU0sT0FBTyxHQUEyQjtZQUN0QyxNQUFNLEVBQUUsV0FBVztZQUNuQixNQUFNLEVBQUUsV0FBVztZQUNuQixNQUFNLEVBQUUsYUFBYTtZQUNyQixJQUFJLEVBQUUsV0FBVztTQUNsQixDQUFDO1FBQ0YsQ0FBQyxDQUFDLHNCQUFzQixDQUFDLENBQUMsV0FBVyxDQUFDLDJDQUEyQyxDQUFDLENBQUM7UUFDbkYsQ0FBQyxDQUFDLHNCQUFzQixDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ3BELENBQUM7U0FBTSxJQUFJLElBQUksS0FBSyxTQUFTLEVBQUUsQ0FBQztRQUM5QiwyRUFBZ0IsQ0FBQyxvQkFBb0IsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUM3QyxNQUFNLE9BQU8sR0FBMkI7WUFDdEMsTUFBTSxFQUFFLFdBQVc7WUFDbkIsTUFBTSxFQUFFLFdBQVc7WUFDbkIsTUFBTSxFQUFFLGFBQWE7WUFDckIsSUFBSSxFQUFFLFdBQVc7U0FDbEIsQ0FBQztRQUNGLENBQUMsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDLFdBQVcsQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO1FBQ3ZGLENBQUMsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUN4RCxDQUFDO0lBRUQsMEVBQXFCLEVBQUUsQ0FBQztJQUN4QixPQUFPLEVBQUUsQ0FBQztBQUNaLENBQUM7QUFFRDs7R0FFRztBQUNJLEtBQUssVUFBVSxXQUFXLENBQUMsSUFBc0M7SUFDdEUsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUNyQyxNQUFNLEtBQUssR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLElBQUksTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7SUFFbkQsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ1YsT0FBTyxDQUFDLElBQUksQ0FBQyxrREFBa0QsQ0FBQyxDQUFDO1FBQ2pFLE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUVELElBQUksSUFBSSxLQUFLLEtBQUssRUFBRSxDQUFDO1FBQ25CLElBQUksS0FBSyxLQUFLLE1BQU0sRUFBRSxDQUFDO1lBQ3JCLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0scUVBQW1CLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbkMsQ0FBQzthQUFNLElBQUksS0FBSyxLQUFLLE9BQU8sRUFBRSxDQUFDO1lBQzdCLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ3hDLE1BQU0scUVBQW1CLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbkMsQ0FBQztJQUNILENBQUM7U0FBTSxJQUFJLElBQUksS0FBSyxTQUFTLEVBQUUsQ0FBQztRQUM5QixJQUFJLEtBQUssS0FBSyxNQUFNLEVBQUUsQ0FBQztZQUNyQixDQUFDLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQzNDLE1BQU0scUVBQW1CLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDdkMsQ0FBQzthQUFNLElBQUksS0FBSyxLQUFLLE9BQU8sRUFBRSxDQUFDO1lBQzdCLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDNUMsTUFBTSxxRUFBbUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN2QyxDQUFDO0lBQ0gsQ0FBQztJQUVELE9BQU8sRUFBRSxDQUFDO0FBQ1osQ0FBQztBQUVEOztHQUVHO0FBQ0ksS0FBSyxVQUFVLFNBQVMsQ0FBQyxJQUFxQztJQUNuRSxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3JDLE1BQU0sSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUVqRCxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDVixPQUFPLENBQUMsSUFBSSxDQUFDLHFEQUFxRCxDQUFDLENBQUM7UUFDcEUsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDO0lBRUQsSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFLENBQUM7UUFDbkIsSUFBSSxJQUFJLEtBQUssTUFBTSxFQUFFLENBQUM7WUFDcEIsTUFBTSwyREFBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3pCLENBQUM7YUFBTSxJQUFJLElBQUksS0FBSyxPQUFPLEVBQUUsQ0FBQztZQUM1QixNQUFNLFlBQVksR0FBRyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFpQixDQUFDO1lBQ3hELFlBQVksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN2QixDQUFDO0lBQ0gsQ0FBQztTQUFNLElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRSxDQUFDO1FBQzlCLElBQUksSUFBSSxLQUFLLE1BQU0sRUFBRSxDQUFDO1lBQ3BCLE1BQU0sMkRBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUM3QixDQUFDO2FBQU0sSUFBSSxJQUFJLEtBQUssT0FBTyxFQUFFLENBQUM7WUFDNUIsTUFBTSxZQUFZLEdBQUcsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFpQixDQUFDO1lBQzVELFlBQVksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN2QixDQUFDO0lBQ0gsQ0FBQztJQUVELE9BQU8sRUFBRSxDQUFDO0FBQ1osQ0FBQztBQUVEOztHQUVHO0FBQ0ksS0FBSyxVQUFVLFdBQVcsQ0FBQyxJQUFxQyxFQUFFLEdBQVc7SUFDbEYsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUNyQyxNQUFNLElBQUksR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7SUFFakQsSUFBSSxDQUFDLElBQUksSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQ2xCLE9BQU8sQ0FBQyxJQUFJLENBQUMsa0RBQWtELENBQUMsQ0FBQztRQUNqRSxPQUFPLEVBQUUsQ0FBQztJQUNaLENBQUM7SUFFRCxNQUFNLFFBQVEsR0FBRyxHQUFHO1NBQ2pCLEtBQUssQ0FBQyxHQUFHLENBQUM7U0FDVixHQUFHLENBQUMsQ0FBQyxHQUFXLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUNoQyxNQUFNLENBQUMsQ0FBQyxHQUFXLEVBQUUsRUFBRSxDQUFDLEdBQUcsS0FBSyxFQUFFLENBQUM7U0FDbkMsTUFBTSxDQUFDLENBQUMsR0FBVyxFQUFFLEtBQWEsRUFBRSxJQUFjLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssS0FBSyxDQUFDLENBQUM7SUFDdkYsSUFBSSxRQUFRLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRSxDQUFDO1FBQzFCLE9BQU8sQ0FBQyxJQUFJLENBQUMsdUNBQXVDLENBQUMsQ0FBQztRQUN0RCxPQUFPLEVBQUUsQ0FBQztJQUNaLENBQUM7SUFFRCxJQUFJLENBQUMsOERBQWEsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUM3Qiw4REFBYSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7SUFDL0IsQ0FBQztJQUVELE1BQU0sT0FBTyxHQUFHLElBQUksS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDO0lBQ3pELE1BQU0sWUFBWSxHQUFHLDhEQUFhLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUM1RCxNQUFNLFVBQVUsR0FBRyxDQUFDLEdBQUcsSUFBSSxHQUFHLENBQUMsQ0FBQyxHQUFHLFFBQVEsRUFBRSxHQUFHLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVoRSw4REFBYSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsR0FBRyxVQUFVLENBQUM7SUFDOUMsc0ZBQXFCLEVBQUUsQ0FBQztJQUV4QixJQUFJLElBQUksS0FBSyxLQUFLLEVBQUUsQ0FBQztRQUNuQixtRUFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMzQixDQUFDO1NBQU0sSUFBSSxJQUFJLEtBQUssU0FBUyxFQUFFLENBQUM7UUFDOUIsbUVBQWlCLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVELElBQUksSUFBSSxLQUFLLE1BQU0sSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUNuQyxNQUFNLFdBQVcsR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDaEMsSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFLENBQUM7WUFDbkIsMkVBQWdCLENBQUMsb0JBQW9CLEVBQUUsV0FBVyxDQUFDLENBQUM7WUFDcEQsTUFBTSw2REFBVyxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNqQyxDQUFDO2FBQU0sSUFBSSxJQUFJLEtBQUssU0FBUyxFQUFFLENBQUM7WUFDOUIsMkVBQWdCLENBQUMsd0JBQXdCLEVBQUUsV0FBVyxDQUFDLENBQUM7WUFDeEQsTUFBTSw2REFBVyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNyQyxDQUFDO0lBQ0gsQ0FBQztJQUVELE9BQU8sRUFBRSxDQUFDO0FBQ1osQ0FBQztBQUVEOztHQUVHO0FBQ0ksS0FBSyxVQUFVLFdBQVcsQ0FBQyxJQUFzQixFQUFFLEdBQVc7SUFDbkUsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUVyQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDVCxPQUFPLENBQUMsSUFBSSxDQUFDLDRDQUE0QyxDQUFDLENBQUM7UUFDM0QsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDO0lBRUQsSUFBSSxDQUFDLDhEQUFhLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDN0IsOERBQWEsQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO0lBQy9CLENBQUM7SUFFRCxNQUFNLFFBQVEsR0FBRyxJQUFJLEtBQUssS0FBSyxDQUFDLENBQUMsQ0FBQyx1REFBUyxDQUFDLENBQUMsQ0FBQywyREFBYSxDQUFDO0lBQzVELE1BQU0sT0FBTyxHQUFHLElBQUksS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDO0lBRXpELElBQUksUUFBUSxJQUFJLFFBQVEsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUN2QyxJQUFJLElBQUksS0FBSyxLQUFLLEVBQUUsQ0FBQztZQUNuQiwyRUFBZ0IsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLENBQUMsQ0FBQztZQUM1QyxNQUFNLDZEQUFXLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ2pDLENBQUM7YUFBTSxJQUFJLElBQUksS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUM5QiwyRUFBZ0IsQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLENBQUMsQ0FBQztZQUNoRCxNQUFNLDZEQUFXLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3JDLENBQUM7UUFDRCxPQUFPLEVBQUUsQ0FBQztJQUNaLENBQUM7SUFFRCxNQUFNLFlBQVksR0FBRyw4REFBYSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7SUFFNUQsTUFBTSxVQUFVLEdBQUcsQ0FBQyxHQUFHLElBQUksR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hELDhEQUFhLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxHQUFHLFVBQVUsQ0FBQztJQUM5QyxzRkFBcUIsRUFBRSxDQUFDO0lBRXhCLElBQUksSUFBSSxLQUFLLEtBQUssRUFBRSxDQUFDO1FBQ25CLG1FQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3pCLDJFQUFnQixDQUFDLG9CQUFvQixFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQzVDLE1BQU0sNkRBQVcsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDakMsQ0FBQztTQUFNLElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRSxDQUFDO1FBQzlCLG1FQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzdCLDJFQUFnQixDQUFDLHdCQUF3QixFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ2hELE1BQU0sNkRBQVcsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVELE9BQU8sRUFBRSxDQUFDO0FBQ1osQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyxzQkFBc0I7SUFDcEMsb0JBQW9CO0lBQ3BCLHNHQUFrQixDQUFDLGdCQUFnQixDQUNqQywwRkFBWSxDQUFDLFNBQVMsQ0FBQztRQUNyQixJQUFJLEVBQUUsYUFBYTtRQUNuQixRQUFRLEVBQUUsV0FBVztRQUNyQixpQkFBaUIsRUFBRTtZQUNqQiwrR0FBeUIsQ0FBQyxTQUFTLENBQUM7Z0JBQ2xDLElBQUksRUFBRSxNQUFNO2dCQUNaLFdBQVcsRUFBRSx5QkFBeUI7Z0JBQ3RDLFFBQVEsRUFBRSxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDO2dCQUNoQyxRQUFRLEVBQUU7b0JBQ1IsSUFBSSw0R0FBcUIsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLGdHQUFTLENBQUMsSUFBSSxFQUFFLDBHQUFTLENBQUMsSUFBSSxDQUFDO29CQUN0RSxJQUFJLDRHQUFxQixDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsZ0dBQVMsQ0FBQyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxJQUFJLENBQUM7aUJBQzNFO2dCQUNELFVBQVUsRUFBRSxJQUFJO2FBQ2pCLENBQUM7U0FDSDtRQUNELG1CQUFtQixFQUFFLENBQUMsSUFBSSwwR0FBb0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxtR0FBYSxDQUFDLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3BGLFVBQVUsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7T0FpQlg7S0FDRixDQUFDLENBQ0gsQ0FBQztJQUVGLG9CQUFvQjtJQUNwQixzR0FBa0IsQ0FBQyxnQkFBZ0IsQ0FDakMsMEZBQVksQ0FBQyxTQUFTLENBQUM7UUFDckIsSUFBSSxFQUFFLGFBQWE7UUFDbkIsUUFBUSxFQUFFLFdBQVc7UUFDckIsaUJBQWlCLEVBQUU7WUFDakIsK0dBQXlCLENBQUMsU0FBUyxDQUFDO2dCQUNsQyxJQUFJLEVBQUUsTUFBTTtnQkFDWixXQUFXLEVBQUUsd0JBQXdCO2dCQUNyQyxRQUFRLEVBQUUsQ0FBQyxtR0FBYSxDQUFDLE1BQU0sQ0FBQztnQkFDaEMsUUFBUSxFQUFFO29CQUNSLElBQUksNEdBQXFCLENBQUMsS0FBSyxFQUFFLElBQUksRUFBRSxnR0FBUyxDQUFDLElBQUksRUFBRSwwR0FBUyxDQUFDLElBQUksQ0FBQztvQkFDdEUsSUFBSSw0R0FBcUIsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLGdHQUFTLENBQUMsSUFBSSxFQUFFLDBHQUFTLENBQUMsSUFBSSxDQUFDO2lCQUMzRTtnQkFDRCxVQUFVLEVBQUUsSUFBSTthQUNqQixDQUFDO1lBQ0YsK0dBQXlCLENBQUMsU0FBUyxDQUFDO2dCQUNsQyxJQUFJLEVBQUUsTUFBTTtnQkFDWixXQUFXLEVBQUUsZ0JBQWdCO2dCQUM3QixRQUFRLEVBQUUsQ0FBQyxtR0FBYSxDQUFDLE9BQU8sQ0FBQztnQkFDakMsWUFBWSxFQUFFLE1BQU07Z0JBQ3BCLFVBQVUsRUFBRSxLQUFLO2FBQ2xCLENBQUM7U0FDSDtRQUNELG1CQUFtQixFQUFFLENBQUMsSUFBSSwwR0FBb0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxtR0FBYSxDQUFDLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3BGLFVBQVUsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7T0FpQlg7S0FDRixDQUFDLENBQ0gsQ0FBQztJQUVGLGtCQUFrQjtJQUNsQixzR0FBa0IsQ0FBQyxnQkFBZ0IsQ0FDakMsMEZBQVksQ0FBQyxTQUFTLENBQUM7UUFDckIsSUFBSSxFQUFFLFdBQVc7UUFDakIsUUFBUSxFQUFFLFNBQVM7UUFDbkIsaUJBQWlCLEVBQUU7WUFDakIsK0dBQXlCLENBQUMsU0FBUyxDQUFDO2dCQUNsQyxJQUFJLEVBQUUsTUFBTTtnQkFDWixXQUFXLEVBQUUsMEJBQTBCO2dCQUN2QyxRQUFRLEVBQUUsQ0FBQyxtR0FBYSxDQUFDLE1BQU0sQ0FBQztnQkFDaEMsUUFBUSxFQUFFO29CQUNSLElBQUksNEdBQXFCLENBQUMsS0FBSyxFQUFFLElBQUksRUFBRSxnR0FBUyxDQUFDLElBQUksRUFBRSwwR0FBUyxDQUFDLElBQUksQ0FBQztvQkFDdEUsSUFBSSw0R0FBcUIsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLGdHQUFTLENBQUMsSUFBSSxFQUFFLDBHQUFTLENBQUMsSUFBSSxDQUFDO2lCQUMzRTtnQkFDRCxVQUFVLEVBQUUsSUFBSTthQUNqQixDQUFDO1lBQ0YsSUFBSSwrR0FBeUIsQ0FDM0IsTUFBTSxFQUNOLE9BQU8sRUFDUCxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDLEVBQ3RCLElBQUksRUFDSixLQUFLLEVBQ0wsTUFBTSxFQUNOLG9IQUFtQixDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUMzQztTQUNGO1FBQ0QsVUFBVSxFQUFFOzs7Ozs7Ozs7Ozs7Ozs7OztPQWlCWDtLQUNGLENBQUMsQ0FDSCxDQUFDO0lBRUYsb0JBQW9CO0lBQ3BCLHNHQUFrQixDQUFDLGdCQUFnQixDQUNqQywwRkFBWSxDQUFDLFNBQVMsQ0FBQztRQUNyQixJQUFJLEVBQUUsYUFBYTtRQUNuQixRQUFRLEVBQUUsV0FBVztRQUNyQixpQkFBaUIsRUFBRTtZQUNqQiwrR0FBeUIsQ0FBQyxTQUFTLENBQUM7Z0JBQ2xDLElBQUksRUFBRSxNQUFNO2dCQUNaLFdBQVcsRUFBRSwwQkFBMEI7Z0JBQ3ZDLFFBQVEsRUFBRSxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDO2dCQUNoQyxRQUFRLEVBQUU7b0JBQ1IsSUFBSSw0R0FBcUIsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLGdHQUFTLENBQUMsSUFBSSxFQUFFLDBHQUFTLENBQUMsSUFBSSxDQUFDO29CQUN0RSxJQUFJLDRHQUFxQixDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsZ0dBQVMsQ0FBQyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxJQUFJLENBQUM7aUJBQzNFO2dCQUNELFVBQVUsRUFBRSxJQUFJO2FBQ2pCLENBQUM7WUFDRixJQUFJLCtHQUF5QixDQUMzQixPQUFPLEVBQ1AsVUFBVSxFQUNWLENBQUMsbUdBQWEsQ0FBQyxNQUFNLENBQUMsRUFDdEIsS0FBSyxFQUNMLEtBQUssRUFDTCxNQUFNLEVBQ04sb0hBQW1CLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQzNDO1NBQ0Y7UUFDRCxVQUFVLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7O0tBaUJiO0tBQ0EsQ0FBQyxDQUNILENBQUM7SUFFRixrQkFBa0I7SUFDbEIsc0dBQWtCLENBQUMsZ0JBQWdCLENBQ2pDLDBGQUFZLENBQUMsU0FBUyxDQUFDO1FBQ3JCLElBQUksRUFBRSxXQUFXO1FBQ2pCLFFBQVEsRUFBRSxTQUFTO1FBQ25CLGlCQUFpQixFQUFFO1lBQ2pCLCtHQUF5QixDQUFDLFNBQVMsQ0FBQztnQkFDbEMsSUFBSSxFQUFFLE1BQU07Z0JBQ1osV0FBVyxFQUFFLDBCQUEwQjtnQkFDdkMsUUFBUSxFQUFFLENBQUMsbUdBQWEsQ0FBQyxNQUFNLENBQUM7Z0JBQ2hDLFFBQVEsRUFBRTtvQkFDUixJQUFJLDRHQUFxQixDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUUsZ0dBQVMsQ0FBQyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxJQUFJLENBQUM7b0JBQ3RFLElBQUksNEdBQXFCLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxnR0FBUyxDQUFDLElBQUksRUFBRSwwR0FBUyxDQUFDLElBQUksQ0FBQztpQkFDM0U7Z0JBQ0QsVUFBVSxFQUFFLElBQUk7YUFDakIsQ0FBQztZQUNGLCtHQUF5QixDQUFDLFNBQVMsQ0FBQztnQkFDbEMsSUFBSSxFQUFFLE1BQU07Z0JBQ1osV0FBVyxFQUFFLFFBQVE7Z0JBQ3JCLFFBQVEsRUFBRSxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDO2dCQUNoQyxRQUFRLEVBQUU7b0JBQ1IsSUFBSSw0R0FBcUIsQ0FBQyxRQUFRLEVBQUUsSUFBSSxFQUFFLGdHQUFTLENBQUMsSUFBSSxFQUFFLDBHQUFTLENBQUMsSUFBSSxDQUFDO29CQUN6RSxJQUFJLDRHQUFxQixDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsZ0dBQVMsQ0FBQyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxPQUFPLENBQUM7b0JBQzVFLElBQUksNEdBQXFCLENBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxnR0FBUyxDQUFDLElBQUksRUFBRSwwR0FBUyxDQUFDLElBQUksQ0FBQztvQkFDekUsSUFBSSw0R0FBcUIsQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLGdHQUFTLENBQUMsSUFBSSxFQUFFLDBHQUFTLENBQUMsSUFBSSxDQUFDO2lCQUN4RTtnQkFDRCxVQUFVLEVBQUUsSUFBSTthQUNqQixDQUFDO1NBQ0g7UUFDRCxVQUFVLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7S0F5QmI7S0FDQSxDQUFDLENBQ0gsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvc2xhc2hfY29tbWFuZC9hdWRpby50cz8wYzgwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNhdmVTZXR0aW5nVmFsdWUgfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5cbmltcG9ydCB7IGNoYXRfbWV0YWRhdGEsIHNhdmVTZXR0aW5nc0RlYm91bmNlZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgc2F2ZU1ldGFkYXRhRGVib3VuY2VkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyBTbGFzaENvbW1hbmQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9zbGFzaC1jb21tYW5kcy9TbGFzaENvbW1hbmQnO1xuaW1wb3J0IHtcbiAgQVJHVU1FTlRfVFlQRSxcbiAgU2xhc2hDb21tYW5kQXJndW1lbnQsXG4gIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQsXG59IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZEFyZ3VtZW50JztcbmltcG9ydCB7IGNvbW1vbkVudW1Qcm92aWRlcnMsIGVudW1JY29ucyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZENvbW1vbkVudW1zUHJvdmlkZXInO1xuaW1wb3J0IHsgU2xhc2hDb21tYW5kRW51bVZhbHVlLCBlbnVtVHlwZXMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9zbGFzaC1jb21tYW5kcy9TbGFzaENvbW1hbmRFbnVtVmFsdWUnO1xuaW1wb3J0IHsgU2xhc2hDb21tYW5kUGFyc2VyIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvc2xhc2gtY29tbWFuZHMvU2xhc2hDb21tYW5kUGFyc2VyJztcblxuaW1wb3J0IHtcbiAgbGlzdF9CR01TLFxuICBsaXN0X2FtYmllbnRzLFxuICBvbkF1ZGlvRW5hYmxlZENsaWNrLFxuICBwbGF5QXVkaW8sXG4gIHVwZGF0ZUF1ZGlvLFxuICB1cGRhdGVBdWRpb1NlbGVjdCxcbn0gZnJvbSAnLi4vY29tcG9uZW50L2F1ZGlvJztcblxuaW50ZXJmYWNlIEF1ZGlvRWxlbWVudCBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgcGF1c2UoKTogdm9pZDtcbn1cblxuLyoqXG4gKiDliIfmjaLpn7PpopHmkq3mlL7mqKHlvI9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGF1ZGlvTW9kZShhcmdzOiB7IHR5cGU6IHN0cmluZzsgbW9kZTogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdHlwZSA9IGFyZ3MudHlwZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBtb2RlID0gYXJncy5tb2RlLnRvTG93ZXJDYXNlKCk7XG5cbiAgaWYgKCFbJ2JnbScsICdhbWJpZW50J10uaW5jbHVkZXModHlwZSkgfHwgIVsncmVwZWF0JywgJ3JhbmRvbScsICdzaW5nbGUnLCAnc3RvcCddLmluY2x1ZGVzKG1vZGUpKSB7XG4gICAgY29uc29sZS53YXJuKCdXQVJOOiBJbnZhbGlkIGFyZ3VtZW50cyBmb3IgL2F1ZGlvbW9kZSBjb21tYW5kJyk7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX21vZGUnLCBtb2RlKTtcbiAgICBjb25zdCBpY29uTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgcmVwZWF0OiAnZmEtcmVwZWF0JyxcbiAgICAgIHJhbmRvbTogJ2ZhLXJhbmRvbScsXG4gICAgICBzaW5nbGU6ICdmYS1yZWRvLWFsdCcsXG4gICAgICBzdG9wOiAnZmEtY2FuY2VsJyxcbiAgICB9O1xuICAgICQoJyNhdWRpb19iZ21fbW9kZV9pY29uJykucmVtb3ZlQ2xhc3MoJ2ZhLXJlcGVhdCBmYS1yYW5kb20gZmEtcmVkby1hbHQgZmEtY2FuY2VsJyk7XG4gICAgJCgnI2F1ZGlvX2JnbV9tb2RlX2ljb24nKS5hZGRDbGFzcyhpY29uTWFwW21vZGVdKTtcbiAgfSBlbHNlIGlmICh0eXBlID09PSAnYW1iaWVudCcpIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5hbWJpZW50X21vZGUnLCBtb2RlKTtcbiAgICBjb25zdCBpY29uTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgcmVwZWF0OiAnZmEtcmVwZWF0JyxcbiAgICAgIHJhbmRvbTogJ2ZhLXJhbmRvbScsXG4gICAgICBzaW5nbGU6ICdmYS1yZWRvLWFsdCcsXG4gICAgICBzdG9wOiAnZmEtY2FuY2VsJyxcbiAgICB9O1xuICAgICQoJyNhdWRpb19hbWJpZW50X21vZGVfaWNvbicpLnJlbW92ZUNsYXNzKCdmYS1yZXBlYXQgZmEtcmFuZG9tIGZhLXJlZG8tYWx0IGZhLWNhbmNlbCcpO1xuICAgICQoJyNhdWRpb19hbWJpZW50X21vZGVfaWNvbicpLmFkZENsYXNzKGljb25NYXBbbW9kZV0pO1xuICB9XG5cbiAgc2F2ZVNldHRpbmdzRGVib3VuY2VkKCk7XG4gIHJldHVybiAnJztcbn1cblxuLyoqXG4gKiDliIfmjaLmkq3mlL7lmajlvIDlhbPnirbmgIFcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGF1ZGlvRW5hYmxlKGFyZ3M6IHsgdHlwZTogc3RyaW5nOyBzdGF0ZT86IHN0cmluZyB9KTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHR5cGUgPSBhcmdzLnR5cGUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3Qgc3RhdGUgPSAoYXJncy5zdGF0ZSB8fCAndHJ1ZScpLnRvTG93ZXJDYXNlKCk7XG5cbiAgaWYgKCF0eXBlKSB7XG4gICAgY29uc29sZS53YXJuKCdXQVJOOiBNaXNzaW5nIGFyZ3VtZW50cyBmb3IgL2F1ZGlvZW5hYmxlIGNvbW1hbmQnKTtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICBpZiAoc3RhdGUgPT09ICd0cnVlJykge1xuICAgICAgJCgnI2VuYWJsZV9iZ20nKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG4gICAgICBhd2FpdCBvbkF1ZGlvRW5hYmxlZENsaWNrKCdiZ20nKTtcbiAgICB9IGVsc2UgaWYgKHN0YXRlID09PSAnZmFsc2UnKSB7XG4gICAgICAkKCcjZW5hYmxlX2JnbScpLnByb3AoJ2NoZWNrZWQnLCBmYWxzZSk7XG4gICAgICBhd2FpdCBvbkF1ZGlvRW5hYmxlZENsaWNrKCdiZ20nKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2FtYmllbnQnKSB7XG4gICAgaWYgKHN0YXRlID09PSAndHJ1ZScpIHtcbiAgICAgICQoJyNlbmFibGVfYW1iaWVudCcpLnByb3AoJ2NoZWNrZWQnLCB0cnVlKTtcbiAgICAgIGF3YWl0IG9uQXVkaW9FbmFibGVkQ2xpY2soJ2FtYmllbnQnKTtcbiAgICB9IGVsc2UgaWYgKHN0YXRlID09PSAnZmFsc2UnKSB7XG4gICAgICAkKCcjZW5hYmxlX2FtYmllbnQnKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuICAgICAgYXdhaXQgb25BdWRpb0VuYWJsZWRDbGljaygnYW1iaWVudCcpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiAnJztcbn1cblxuLyoqXG4gKiDliIfmjaLmkq3mlL4v5pqC5YGc54q25oCBXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdWRpb1BsYXkoYXJnczogeyB0eXBlOiBzdHJpbmc7IHBsYXk/OiBzdHJpbmcgfSk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB0eXBlID0gYXJncy50eXBlLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHBsYXkgPSAoYXJncy5wbGF5IHx8ICd0cnVlJykudG9Mb3dlckNhc2UoKTtcblxuICBpZiAoIXR5cGUpIHtcbiAgICBjb25zb2xlLndhcm4oJ1dBUk46IE1pc3NpbmcgYXJndW1lbnRzIGZvciAvYXVkaW9wbGF5cGF1c2UgY29tbWFuZCcpO1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGlmICh0eXBlID09PSAnYmdtJykge1xuICAgIGlmIChwbGF5ID09PSAndHJ1ZScpIHtcbiAgICAgIGF3YWl0IHBsYXlBdWRpbygnYmdtJyk7XG4gICAgfSBlbHNlIGlmIChwbGF5ID09PSAnZmFsc2UnKSB7XG4gICAgICBjb25zdCBhdWRpb0VsZW1lbnQgPSAkKCcjYXVkaW9fYmdtJylbMF0gYXMgQXVkaW9FbGVtZW50O1xuICAgICAgYXVkaW9FbGVtZW50LnBhdXNlKCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIGlmIChwbGF5ID09PSAndHJ1ZScpIHtcbiAgICAgIGF3YWl0IHBsYXlBdWRpbygnYW1iaWVudCcpO1xuICAgIH0gZWxzZSBpZiAocGxheSA9PT0gJ2ZhbHNlJykge1xuICAgICAgY29uc3QgYXVkaW9FbGVtZW50ID0gJCgnI2F1ZGlvX2FtYmllbnQnKVswXSBhcyBBdWRpb0VsZW1lbnQ7XG4gICAgICBhdWRpb0VsZW1lbnQucGF1c2UoKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gJyc7XG59XG5cbi8qKlxuICog5a+85YWl6Z+z6aKR6ZO+5o6lXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdWRpb0ltcG9ydChhcmdzOiB7IHR5cGU6IHN0cmluZzsgcGxheT86IHN0cmluZyB9LCB1cmw6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB0eXBlID0gYXJncy50eXBlLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHBsYXkgPSAoYXJncy5wbGF5IHx8ICd0cnVlJykudG9Mb3dlckNhc2UoKTtcblxuICBpZiAoIXR5cGUgfHwgIXVybCkge1xuICAgIGNvbnNvbGUud2FybignV0FSTjogTWlzc2luZyBhcmd1bWVudHMgZm9yIC9hdWRpb2ltcG9ydCBjb21tYW5kJyk7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgY29uc3QgdXJsQXJyYXkgPSB1cmxcbiAgICAuc3BsaXQoJywnKVxuICAgIC5tYXAoKHVybDogc3RyaW5nKSA9PiB1cmwudHJpbSgpKVxuICAgIC5maWx0ZXIoKHVybDogc3RyaW5nKSA9PiB1cmwgIT09ICcnKVxuICAgIC5maWx0ZXIoKHVybDogc3RyaW5nLCBpbmRleDogbnVtYmVyLCBzZWxmOiBzdHJpbmdbXSkgPT4gc2VsZi5pbmRleE9mKHVybCkgPT09IGluZGV4KTtcbiAgaWYgKHVybEFycmF5Lmxlbmd0aCA9PT0gMCkge1xuICAgIGNvbnNvbGUud2FybignV0FSTjogSW52YWxpZCBvciBlbXB0eSBVUkxzIHByb3ZpZGVkLicpO1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGlmICghY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMpIHtcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyA9IHt9O1xuICB9XG5cbiAgY29uc3QgdHlwZUtleSA9IHR5cGUgPT09ICdiZ20nID8gJ2JnbXVybCcgOiAnYW1iaWVudHVybCc7XG4gIGNvbnN0IGV4aXN0aW5nVXJscyA9IGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldIHx8IFtdO1xuICBjb25zdCBtZXJnZWRVcmxzID0gWy4uLm5ldyBTZXQoWy4uLnVybEFycmF5LCAuLi5leGlzdGluZ1VybHNdKV07XG5cbiAgY2hhdF9tZXRhZGF0YS52YXJpYWJsZXNbdHlwZUtleV0gPSBtZXJnZWRVcmxzO1xuICBzYXZlTWV0YWRhdGFEZWJvdW5jZWQoKTtcblxuICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICB1cGRhdGVBdWRpb1NlbGVjdCgnYmdtJyk7XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2FtYmllbnQnKSB7XG4gICAgdXBkYXRlQXVkaW9TZWxlY3QoJ2FtYmllbnQnKTtcbiAgfVxuXG4gIGlmIChwbGF5ID09PSAndHJ1ZScgJiYgdXJsQXJyYXlbMF0pIHtcbiAgICBjb25zdCBzZWxlY3RlZFVybCA9IHVybEFycmF5WzBdO1xuICAgIGlmICh0eXBlID09PSAnYmdtJykge1xuICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX3NlbGVjdGVkJywgc2VsZWN0ZWRVcmwpO1xuICAgICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2JnbScsIHRydWUpO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2FtYmllbnQnKSB7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5hbWJpZW50X3NlbGVjdGVkJywgc2VsZWN0ZWRVcmwpO1xuICAgICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2FtYmllbnQnLCB0cnVlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gJyc7XG59XG5cbi8qKlxuICog6YCJ5oup5bm25pKt5pS+6Z+z6aKRXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdWRpb1NlbGVjdChhcmdzOiB7IHR5cGU6IHN0cmluZyB9LCB1cmw6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB0eXBlID0gYXJncy50eXBlLnRvTG93ZXJDYXNlKCk7XG5cbiAgaWYgKCF1cmwpIHtcbiAgICBjb25zb2xlLndhcm4oJ1dBUk46IE1pc3NpbmcgVVJMIGZvciAvYXVkaW9zZWxlY3QgY29tbWFuZCcpO1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGlmICghY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMpIHtcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyA9IHt9O1xuICB9XG5cbiAgY29uc3QgcGxheWxpc3QgPSB0eXBlID09PSAnYmdtJyA/IGxpc3RfQkdNUyA6IGxpc3RfYW1iaWVudHM7XG4gIGNvbnN0IHR5cGVLZXkgPSB0eXBlID09PSAnYmdtJyA/ICdiZ211cmwnIDogJ2FtYmllbnR1cmwnO1xuXG4gIGlmIChwbGF5bGlzdCAmJiBwbGF5bGlzdC5pbmNsdWRlcyh1cmwpKSB7XG4gICAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnLCB1cmwpO1xuICAgICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2JnbScsIHRydWUpO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2FtYmllbnQnKSB7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5hbWJpZW50X3NlbGVjdGVkJywgdXJsKTtcbiAgICAgIGF3YWl0IHVwZGF0ZUF1ZGlvKCdhbWJpZW50JywgdHJ1ZSk7XG4gICAgfVxuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGNvbnN0IGV4aXN0aW5nVXJscyA9IGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldIHx8IFtdO1xuXG4gIGNvbnN0IG1lcmdlZFVybHMgPSBbLi4ubmV3IFNldChbdXJsLCAuLi5leGlzdGluZ1VybHNdKV07XG4gIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldID0gbWVyZ2VkVXJscztcbiAgc2F2ZU1ldGFkYXRhRGVib3VuY2VkKCk7XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgdXBkYXRlQXVkaW9TZWxlY3QoJ2JnbScpO1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmJnbV9zZWxlY3RlZCcsIHVybCk7XG4gICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2JnbScsIHRydWUpO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIHVwZGF0ZUF1ZGlvU2VsZWN0KCdhbWJpZW50Jyk7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcsIHVybCk7XG4gICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2FtYmllbnQnLCB0cnVlKTtcbiAgfVxuXG4gIHJldHVybiAnJztcbn1cblxuLyoqXG4gKiDliJ3lp4vljJbpn7PpopHnm7jlhbPnmoQgc2xhc2ggY29tbWFuZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdEF1ZGlvU2xhc2hDb21tYW5kcygpIHtcbiAgLy8g5rOo5YaMIGF1ZGlvc2VsZWN0IOWRveS7pFxuICBTbGFzaENvbW1hbmRQYXJzZXIuYWRkQ29tbWFuZE9iamVjdChcbiAgICBTbGFzaENvbW1hbmQuZnJvbVByb3BzKHtcbiAgICAgIG5hbWU6ICdhdWRpb3NlbGVjdCcsXG4gICAgICBjYWxsYmFjazogYXVkaW9TZWxlY3QsXG4gICAgICBuYW1lZEFyZ3VtZW50TGlzdDogW1xuICAgICAgICBTbGFzaENvbW1hbmROYW1lZEFyZ3VtZW50LmZyb21Qcm9wcyh7XG4gICAgICAgICAgbmFtZTogJ3R5cGUnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAn6YCJ5oup5pKt5pS+5Zmo57G75Z6LIChiZ20g5oiWIGFtYmllbnQpJyxcbiAgICAgICAgICB0eXBlTGlzdDogW0FSR1VNRU5UX1RZUEUuU1RSSU5HXSxcbiAgICAgICAgICBlbnVtTGlzdDogW1xuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnYmdtJywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5maWxlKSxcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ2FtYmllbnQnLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLmZpbGUpLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgaXNSZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICBdLFxuICAgICAgdW5uYW1lZEFyZ3VtZW50TGlzdDogW25ldyBTbGFzaENvbW1hbmRBcmd1bWVudCgndXJsJywgW0FSR1VNRU5UX1RZUEUuU1RSSU5HXSwgdHJ1ZSldLFxuICAgICAgaGVscFN0cmluZzogYFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAg6YCJ5oup5bm25pKt5pS+6Z+z6aKR44CC5aaC5p6c6Z+z6aKR6ZO+5o6l5LiN5a2Y5Zyo77yM5YiZ5YWI5a+85YWl5YaN5pKt5pS+44CCXG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPHN0cm9uZz5FeGFtcGxlOjwvc3Ryb25nPlxuICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9zZWxlY3QgdHlwZT1iZ20gaHR0cHM6Ly9leGFtcGxlLmNvbS9zb25nLm1wMzwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6YCJ5oup5bm25pKt5pS+5oyH5a6a55qE6Z+z5LmQ44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgIDxwcmU+PGNvZGU+L2F1ZGlvc2VsZWN0IHR5cGU9YW1iaWVudCBodHRwczovL2V4YW1wbGUuY29tL3NvdW5kLm1wMzwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6YCJ5oup5bm25pKt5pS+5oyH5a6a55qE6Z+z5pWI44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgIDwvdWw+XG4gICAgICAgIDwvZGl2PlxuICAgICAgYCxcbiAgICB9KSxcbiAgKTtcblxuICAvLyDms6jlhowgYXVkaW9pbXBvcnQg5ZG95LukXG4gIFNsYXNoQ29tbWFuZFBhcnNlci5hZGRDb21tYW5kT2JqZWN0KFxuICAgIFNsYXNoQ29tbWFuZC5mcm9tUHJvcHMoe1xuICAgICAgbmFtZTogJ2F1ZGlvaW1wb3J0JyxcbiAgICAgIGNhbGxiYWNrOiBhdWRpb0ltcG9ydCxcbiAgICAgIG5hbWVkQXJndW1lbnRMaXN0OiBbXG4gICAgICAgIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQuZnJvbVByb3BzKHtcbiAgICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICfpgInmi6nlr7zlhaXnsbvlnosgKGJnbSDmiJYgYW1iaWVudCknLFxuICAgICAgICAgIHR5cGVMaXN0OiBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLFxuICAgICAgICAgIGVudW1MaXN0OiBbXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdiZ20nLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLmZpbGUpLFxuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnYW1iaWVudCcsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgXSxcbiAgICAgICAgICBpc1JlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9KSxcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICdwbGF5JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+WvvOWFpeWQjuaYr+WQpueri+WNs+aSreaUvuesrOS4gOS4qumTvuaOpScsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLkJPT0xFQU5dLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ3RydWUnLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICB9KSxcbiAgICAgIF0sXG4gICAgICB1bm5hbWVkQXJndW1lbnRMaXN0OiBbbmV3IFNsYXNoQ29tbWFuZEFyZ3VtZW50KCd1cmwnLCBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLCB0cnVlKV0sXG4gICAgICBoZWxwU3RyaW5nOiBgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICDlr7zlhaXpn7PpopHmiJbpn7PkuZDpk77mjqXvvIzlubblhrPlrprmmK/lkKbnq4vljbPmkq3mlL7vvIzpu5jorqTkuLroh6rliqjmkq3mlL7jgILlj6/mibnph4/lr7zlhaXpk77mjqXvvIzkvb/nlKjoi7HmlofpgJflj7fliIbpmpTjgIJcbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8c3Ryb25nPkV4YW1wbGU6PC9zdHJvbmc+XG4gICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgICAgICA8cHJlPjxjb2RlPi9hdWRpb2ltcG9ydCB0eXBlPWJnbSBodHRwczovL2V4YW1wbGUuY29tL3NvbmcxLm1wMyxodHRwczovL2V4YW1wbGUuY29tL3NvbmcyLm1wMzwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg5a+85YWlIEJHTSDpn7PkuZDlubbnq4vljbPmkq3mlL7nrKzkuIDkuKrpk77mjqXjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9pbXBvcnQgdHlwZT1hbWJpZW50IHBsYXk9ZmFsc2UgdXJsPWh0dHBzOi8vZXhhbXBsZS5jb20vc291bmQxLm1wMyxodHRwczovL2V4YW1wbGUuY29tL3NvdW5kMi5tcDMgPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDlr7zlhaXpn7PmlYjpk77mjqUgKOS4jeiHquWKqOaSreaUvinjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgLFxuICAgIH0pLFxuICApO1xuXG4gIC8vIOazqOWGjCBhdWRpb3BsYXkg5ZG95LukXG4gIFNsYXNoQ29tbWFuZFBhcnNlci5hZGRDb21tYW5kT2JqZWN0KFxuICAgIFNsYXNoQ29tbWFuZC5mcm9tUHJvcHMoe1xuICAgICAgbmFtZTogJ2F1ZGlvcGxheScsXG4gICAgICBjYWxsYmFjazogYXVkaW9QbGF5LFxuICAgICAgbmFtZWRBcmd1bWVudExpc3Q6IFtcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+mAieaLqeaOp+WItueahOaSreaUvuWZqCAoYmdtIOaIliBhbWJpZW50KScsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZW51bUxpc3Q6IFtcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ2JnbScsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdhbWJpZW50JywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5maWxlKSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0pLFxuICAgICAgICBuZXcgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudChcbiAgICAgICAgICAncGxheScsXG4gICAgICAgICAgJ+aSreaUvuaIluaaguWBnCcsXG4gICAgICAgICAgW0FSR1VNRU5UX1RZUEUuU1RSSU5HXSxcbiAgICAgICAgICB0cnVlLFxuICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICd0cnVlJyxcbiAgICAgICAgICBjb21tb25FbnVtUHJvdmlkZXJzLmJvb2xlYW4oJ3RydWVGYWxzZScpKCksXG4gICAgICAgICksXG4gICAgICBdLFxuICAgICAgaGVscFN0cmluZzogYFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAg5o6n5Yi26Z+z5LmQ5pKt5pS+5Zmo5oiW6Z+z5pWI5pKt5pS+5Zmo55qE5pKt5pS+5LiO5pqC5YGc44CCXG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPHN0cm9uZz5FeGFtcGxlOjwvc3Ryb25nPlxuICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9wbGF5IHR5cGU9YmdtPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDmkq3mlL7lvZPliY3pn7PkuZDjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9wbGF5IHR5cGU9YW1iaWVudCBwbGF5PWZhbHNlPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDmmoLlgZzlvZPliY3pn7PmlYjjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgLFxuICAgIH0pLFxuICApO1xuXG4gIC8vIOazqOWGjCBhdWRpb2VuYWJsZSDlkb3ku6RcbiAgU2xhc2hDb21tYW5kUGFyc2VyLmFkZENvbW1hbmRPYmplY3QoXG4gICAgU2xhc2hDb21tYW5kLmZyb21Qcm9wcyh7XG4gICAgICBuYW1lOiAnYXVkaW9lbmFibGUnLFxuICAgICAgY2FsbGJhY2s6IGF1ZGlvRW5hYmxlLFxuICAgICAgbmFtZWRBcmd1bWVudExpc3Q6IFtcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+mAieaLqeaOp+WItueahOaSreaUvuWZqCAoYmdtIOaIliBhbWJpZW50KScsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZW51bUxpc3Q6IFtcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ2JnbScsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdhbWJpZW50JywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5maWxlKSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0pLFxuICAgICAgICBuZXcgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudChcbiAgICAgICAgICAnc3RhdGUnLFxuICAgICAgICAgICfmiZPlvIDmiJblhbPpl63mkq3mlL7lmagnLFxuICAgICAgICAgIFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgJ3RydWUnLFxuICAgICAgICAgIGNvbW1vbkVudW1Qcm92aWRlcnMuYm9vbGVhbigndHJ1ZUZhbHNlJykoKSxcbiAgICAgICAgKSxcbiAgICAgIF0sXG4gICAgICBoZWxwU3RyaW5nOiBgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICDmjqfliLbpn7PkuZDmkq3mlL7lmajmiJbpn7PmlYjmkq3mlL7lmajnmoTlvIDlkK/kuI7lhbPpl63jgIJcbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8c3Ryb25nPkV4YW1wbGU6PC9zdHJvbmc+XG4gICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgICAgICA8cHJlPjxjb2RlPi9hdWRpb2VuYWJsZSB0eXBlPWJnbSBzdGF0ZT10cnVlPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDmiZPlvIDpn7PkuZDmkq3mlL7lmajjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9lbmFibGUgdHlwZT1hbWJpZW50IHN0YXRlPWZhbHNlPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDlhbPpl63pn7PmlYjmkq3mlL7lmajjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgYCxcbiAgICB9KSxcbiAgKTtcblxuICAvLyDms6jlhowgYXVkaW9tb2RlIOWRveS7pFxuICBTbGFzaENvbW1hbmRQYXJzZXIuYWRkQ29tbWFuZE9iamVjdChcbiAgICBTbGFzaENvbW1hbmQuZnJvbVByb3BzKHtcbiAgICAgIG5hbWU6ICdhdWRpb21vZGUnLFxuICAgICAgY2FsbGJhY2s6IGF1ZGlvTW9kZSxcbiAgICAgIG5hbWVkQXJndW1lbnRMaXN0OiBbXG4gICAgICAgIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQuZnJvbVByb3BzKHtcbiAgICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICfpgInmi6nmjqfliLbnmoTmkq3mlL7lmaggKGJnbSDmiJYgYW1iaWVudCknLFxuICAgICAgICAgIHR5cGVMaXN0OiBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLFxuICAgICAgICAgIGVudW1MaXN0OiBbXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdiZ20nLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLmZpbGUpLFxuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnYW1iaWVudCcsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgXSxcbiAgICAgICAgICBpc1JlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9KSxcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICdtb2RlJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+mAieaLqeaSreaUvuaooeW8jycsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZW51bUxpc3Q6IFtcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ3JlcGVhdCcsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMubG9vcCksXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdyYW5kb20nLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLnNodWZmbGUpLFxuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnc2luZ2xlJywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5yZWRvKSxcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ3N0b3AnLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLnN0b3ApLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgaXNSZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICBdLFxuICAgICAgaGVscFN0cmluZzogYFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAg6K6+572u6Z+z6aKR5pKt5pS+5qih5byP44CCXG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPHN0cm9uZz5FeGFtcGxlOjwvc3Ryb25nPlxuICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9tb2RlIHR5cGU9YmdtIG1vZGU9cmVwZWF0PC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDorr7nva7pn7PkuZDkuLrlvqrnjq/mkq3mlL7mqKHlvI/jgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9tb2RlIHR5cGU9YW1iaWVudCBtb2RlPXJhbmRvbTwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6K6+572u6Z+z5pWI5Li66ZqP5py65pKt5pS+5qih5byP44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgIDxwcmU+PGNvZGU+L2F1ZGlvbW9kZSB0eXBlPWJnbSBtb2RlPXNpbmdsZTwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6K6+572u6Z+z5LmQ5Li65Y2V5puy5b6q546v5qih5byP44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgIDxwcmU+PGNvZGU+L2F1ZGlvbW9kZSB0eXBlPWFtYmllbnQgbW9kZT1zdG9wPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDorr7nva7pn7PmlYjkuLrlgZzmraLmkq3mlL7mqKHlvI/jgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgYCxcbiAgICB9KSxcbiAgKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/slash_command/audio.ts\n")},"./src/slash_command/event.ts":
/*!************************************!*\
  !*** ./src/slash_command/event.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initSlashEventEmit: () => (/* binding */ initSlashEventEmit),\n/* harmony export */   slashEventEmit: () => (/* binding */ slashEventEmit)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommand */ "@sillytavern/scripts/slash-commands/SlashCommand");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandArgument */ "@sillytavern/scripts/slash-commands/SlashCommandArgument");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandParser */ "@sillytavern/scripts/slash-commands/SlashCommandParser");\n\n\n\n\nasync function slashEventEmit(named_args) {\n    const event = named_args.event;\n    const data = named_args.data ?? [];\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(event, ...data);\n    console.info(`[Event][/event-emit]  \'${event}\' , : ${JSON.stringify(data)}`);\n    return event;\n}\nfunction initSlashEventEmit() {\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_3__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_1__.SlashCommand.fromProps({\n        name: \'event-emit\',\n        callback: slashEventEmit,\n        returns: \'\',\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.SlashCommandNamedArgument.fromProps({\n                name: \'event\',\n                description: \'\',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.ARGUMENT_TYPE.STRING],\n                isRequired: true,\n            }),\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.SlashCommandNamedArgument.fromProps({\n                name: \'data\',\n                description: \'\',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.ARGUMENT_TYPE.STRING],\n                isRequired: false,\n                acceptsMultiple: true,\n            }),\n        ],\n        unnamedArgumentList: [],\n        helpString: `\n    <div>\n         \\`event\\` , .\n         listener , .\n         STScript ,  string ;  number , .\n    </div>\n    <div>\n        <strong>Example:</strong>\n        <ul>\n            <li>\n                <pre><code class="language-stscript">/event-emit event=""</code></pre>\n            </li>\n            <li>\n                <pre><code class="language-stscript">/event-emit event="" data={{getvar::}} data=8 data= {{user}}</code></pre>\n            </li>\n            <li>\n                <pre><code class="language-stscript">/event-emit event="" data=" " data={{user}}</code></pre>\n            </li>\n        </ul>\n    </div>\n  `,\n    }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2xhc2hfY29tbWFuZC9ldmVudC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBa0Q7QUFDOEI7QUFDb0M7QUFDeEI7QUFFckYsS0FBSyxVQUFVLGNBQWMsQ0FBQyxVQUFlO0lBQ2xELE1BQU0sS0FBSyxHQUFXLFVBQVUsQ0FBQyxLQUFLLENBQUM7SUFDdkMsTUFBTSxJQUFJLEdBQWEsVUFBVSxDQUFDLElBQUksSUFBSSxFQUFFLENBQUM7SUFFN0MsNERBQVcsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUM7SUFFakMsT0FBTyxDQUFDLElBQUksQ0FBQyw0QkFBNEIsS0FBSyxlQUFlLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBRXJGLE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQUVNLFNBQVMsa0JBQWtCO0lBQ2hDLHNHQUFrQixDQUFDLGdCQUFnQixDQUNqQywwRkFBWSxDQUFDLFNBQVMsQ0FBQztRQUNyQixJQUFJLEVBQUUsWUFBWTtRQUNsQixRQUFRLEVBQUUsY0FBYztRQUN4QixPQUFPLEVBQUUsU0FBUztRQUNsQixpQkFBaUIsRUFBRTtZQUNqQiwrR0FBeUIsQ0FBQyxTQUFTLENBQUM7Z0JBQ2xDLElBQUksRUFBRSxPQUFPO2dCQUNiLFdBQVcsRUFBRSxNQUFNO2dCQUNuQixRQUFRLEVBQUUsQ0FBQyxtR0FBYSxDQUFDLE1BQU0sQ0FBQztnQkFDaEMsVUFBVSxFQUFFLElBQUk7YUFDakIsQ0FBQztZQUNGLCtHQUF5QixDQUFDLFNBQVMsQ0FBQztnQkFDbEMsSUFBSSxFQUFFLE1BQU07Z0JBQ1osV0FBVyxFQUFFLFFBQVE7Z0JBQ3JCLFFBQVEsRUFBRSxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDO2dCQUNoQyxVQUFVLEVBQUUsS0FBSztnQkFDakIsZUFBZSxFQUFFLElBQUk7YUFDdEIsQ0FBQztTQUNIO1FBQ0QsbUJBQW1CLEVBQUUsRUFBRTtRQUN2QixVQUFVLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBb0JmO0tBQ0UsQ0FBQyxDQUNILENBQUM7QUFDSixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL3NsYXNoX2NvbW1hbmQvZXZlbnQudHM/ZjZlNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBldmVudFNvdXJjZSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgU2xhc2hDb21tYW5kIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvc2xhc2gtY29tbWFuZHMvU2xhc2hDb21tYW5kJztcbmltcG9ydCB7IEFSR1VNRU5UX1RZUEUsIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9zbGFzaC1jb21tYW5kcy9TbGFzaENvbW1hbmRBcmd1bWVudCc7XG5pbXBvcnQgeyBTbGFzaENvbW1hbmRQYXJzZXIgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9zbGFzaC1jb21tYW5kcy9TbGFzaENvbW1hbmRQYXJzZXInO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xhc2hFdmVudEVtaXQobmFtZWRfYXJnczogYW55KTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3QgZXZlbnQ6IHN0cmluZyA9IG5hbWVkX2FyZ3MuZXZlbnQ7XG4gIGNvbnN0IGRhdGE6IHN0cmluZ1tdID0gbmFtZWRfYXJncy5kYXRhID8/IFtdO1xuXG4gIGV2ZW50U291cmNlLmVtaXQoZXZlbnQsIC4uLmRhdGEpO1xuXG4gIGNvbnNvbGUuaW5mbyhgW0V2ZW50XVsvZXZlbnQtZW1pdF0g5Y+R6YCBICcke2V2ZW50fScg5LqL5Lu2LCDmkLrluKbmlbDmja46ICR7SlNPTi5zdHJpbmdpZnkoZGF0YSl9YCk7XG5cbiAgcmV0dXJuIGV2ZW50O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5pdFNsYXNoRXZlbnRFbWl0KCkge1xuICBTbGFzaENvbW1hbmRQYXJzZXIuYWRkQ29tbWFuZE9iamVjdChcbiAgICBTbGFzaENvbW1hbmQuZnJvbVByb3BzKHtcbiAgICAgIG5hbWU6ICdldmVudC1lbWl0JyxcbiAgICAgIGNhbGxiYWNrOiBzbGFzaEV2ZW50RW1pdCxcbiAgICAgIHJldHVybnM6ICflj5HpgIHnmoTkuovku7blkI3np7AnLFxuICAgICAgbmFtZWRBcmd1bWVudExpc3Q6IFtcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICdldmVudCcsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICfkuovku7blkI3np7AnLFxuICAgICAgICAgIHR5cGVMaXN0OiBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0pLFxuICAgICAgICBTbGFzaENvbW1hbmROYW1lZEFyZ3VtZW50LmZyb21Qcm9wcyh7XG4gICAgICAgICAgbmFtZTogJ2RhdGEnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAn6KaB5Lyg6L6T55qE5pWw5o2uJyxcbiAgICAgICAgICB0eXBlTGlzdDogW0FSR1VNRU5UX1RZUEUuU1RSSU5HXSxcbiAgICAgICAgICBpc1JlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBhY2NlcHRzTXVsdGlwbGU6IHRydWUsXG4gICAgICAgIH0pLFxuICAgICAgXSxcbiAgICAgIHVubmFtZWRBcmd1bWVudExpc3Q6IFtdLFxuICAgICAgaGVscFN0cmluZzogYFxuICAgIDxkaXY+XG4gICAgICAgIOWPkemAgSBcXGBldmVudFxcYCDkuovku7YsIOWQjOaXtuWPr+S7peWPkemAgeS4gOS6m+aVsOaNri5cbiAgICAgICAg5omA5pyJ5q2j5Zyo55uR5ZCs6K+l5raI5oGv6aKR6YGT55qEIGxpc3RlbmVyIOWHveaVsOmDveS8muiHquWKqOi/kOihjCwg5bm26IO955So5Ye95pWw5Y+C5pWw5o6l5pS25Y+R6YCB5p2l55qE5pWw5o2uLlxuICAgICAgICDnlLHkuo7phZLppoYgU1RTY3JpcHQg6L6T5YWl5pa55byP55qE5bGA6ZmQ5oCnLCDmiYDmnInmlbDmja7lsIbkvJrku6XlrZfnrKbkuLIgc3RyaW5nIOexu+Wei+aOpeaUtjsg5aaC5p6c6ZyA6KaBIG51bWJlciDnrYnnsbvlnossIOivt+iHquihjOi9rOaNoi5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2PlxuICAgICAgICA8c3Ryb25nPkV4YW1wbGU6PC9zdHJvbmc+XG4gICAgICAgIDx1bD5cbiAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICA8cHJlPjxjb2RlIGNsYXNzPVwibGFuZ3VhZ2Utc3RzY3JpcHRcIj4vZXZlbnQtZW1pdCBldmVudD1cIuivu+aho1wiPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICA8cHJlPjxjb2RlIGNsYXNzPVwibGFuZ3VhZ2Utc3RzY3JpcHRcIj4vZXZlbnQtZW1pdCBldmVudD1cIuWtmOaho1wiIGRhdGE9e3tnZXR2YXI6OuaVsOaNrn19IGRhdGE9OCBkYXRhPeS9oOWlvSB7e3VzZXJ9fTwvY29kZT48L3ByZT5cbiAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgPHByZT48Y29kZSBjbGFzcz1cImxhbmd1YWdlLXN0c2NyaXB0XCI+L2V2ZW50LWVtaXQgZXZlbnQ9XCLpmo/kvr/ku4DkuYjlkI3np7BcIiBkYXRhPVwi6L+Z5piv5LiA5LiqIOaVsOaNrlwiIGRhdGE9e3t1c2VyfX08L2NvZGU+PC9wcmU+XG4gICAgICAgICAgICA8L2xpPlxuICAgICAgICA8L3VsPlxuICAgIDwvZGl2PlxuICBgLFxuICAgIH0pLFxuICApO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/slash_command/event.ts\n')},"./src/third_party.html":
/*!******************************!*\
  !*** ./src/third_party.html ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n// Module\nvar code = `<link\n  rel="stylesheet"\n  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"\n  integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n/>\n<link\n  rel="stylesheet"\n  href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.14.1/themes/base/jquery-ui.min.css"\n  integrity="sha512-TFee0335YRJoyiqz8hA8KV3P0tXa5CpRBSoM0Wnkn7JoJx1kaq1yXL/rb8YFpWXkMOjRcv5txv+C6UluttluCQ=="\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n/>\n${"<" + "script"}\n  src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"\n  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n>${"<" + "/script"}>\n${"<" + "script"}\n  src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.14.1/jquery-ui.min.js"\n  integrity="sha512-MSOo1aY+3pXCOCdGAYoBZ6YGI0aragoQsg1mKKBHXCYPIWxamwOE7Drh+N5CPgGI5SA9IEKJiPjdfqWFWmZtRA=="\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n>${"<" + "/script"}>\n${"<" + "script"}\n  src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"\n  integrity="sha512-WFN04846sdKMIP5LKNphMaWzU7YpMyCU245etK3g/2ARYbPK9Ub18eG+ljU96qKRCWh+quCY7yefSmlkQw1ANQ=="\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n>${"<" + "/script"}>\n${"<" + "script"}\n  src="https://fastly.jsdelivr.net/gh/N0VI028/JS-Slash-Runner/lib/yaml.min.js"\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n>${"<" + "/script"}>\n`;\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (code);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdGhpcmRfcGFydHkuaHRtbCIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnQkFBZ0I7QUFDbkIsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnQkFBZ0I7QUFDbkIsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnQkFBZ0I7QUFDbkIsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEdBQUcsZ0JBQWdCO0FBQ25CO0FBQ0E7QUFDQSxpRUFBZSxJQUFJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL3RoaXJkX3BhcnR5Lmh0bWw/MjgwMyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBNb2R1bGVcbnZhciBjb2RlID0gYDxsaW5rXG4gIHJlbD1cInN0eWxlc2hlZXRcIlxuICBocmVmPVwiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNy4yL2Nzcy9hbGwubWluLmNzc1wiXG4gIGludGVncml0eT1cInNoYTUxMi1FdnY4NE1yNGtxVkdSTlNnSUdML0YvYUlEcVFiN3hRMnZjcmRJd3hmalRoU0g4Q1NSN1BCRWFrQ3I1MUNrK3crL1U2c3dVMkltMXZWWDBTVms5QUJoZz09XCJcbiAgY3Jvc3NvcmlnaW49XCJhbm9ueW1vdXNcIlxuICByZWZlcnJlcnBvbGljeT1cIm5vLXJlZmVycmVyXCJcbi8+XG48bGlua1xuICByZWw9XCJzdHlsZXNoZWV0XCJcbiAgaHJlZj1cImh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2pxdWVyeXVpLzEuMTQuMS90aGVtZXMvYmFzZS9qcXVlcnktdWkubWluLmNzc1wiXG4gIGludGVncml0eT1cInNoYTUxMi1URmVlMDMzNVlSSm95aXF6OGhBOEtWM1AwdFhhNUNwUkJTb00wV25rbjdKb0p4MWthcTF5WEwvcmI4WUZwV1hrTU9qUmN2NXR4ditDNlVsdXR0bHVDUT09XCJcbiAgY3Jvc3NvcmlnaW49XCJhbm9ueW1vdXNcIlxuICByZWZlcnJlcnBvbGljeT1cIm5vLXJlZmVycmVyXCJcbi8+XG4ke1wiPFwiICsgXCJzY3JpcHRcIn1cbiAgc3JjPVwiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzMuNy4xL2pxdWVyeS5taW4uanNcIlxuICBpbnRlZ3JpdHk9XCJzaGE1MTItdjJDSjdVYVl5NEp3cUxESXJaVUkvNGhxZW9RaWVPbUFaTlhCZVF5am8yMWRhZG53Uis4WmFJSlZUOEVFMml5STYxT1Y4ZTZNOFBQMi80aHBRSU5RL2c9PVwiXG4gIGNyb3Nzb3JpZ2luPVwiYW5vbnltb3VzXCJcbiAgcmVmZXJyZXJwb2xpY3k9XCJuby1yZWZlcnJlclwiXG4+JHtcIjxcIiArIFwiL3NjcmlwdFwifT5cbiR7XCI8XCIgKyBcInNjcmlwdFwifVxuICBzcmM9XCJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9qcXVlcnl1aS8xLjE0LjEvanF1ZXJ5LXVpLm1pbi5qc1wiXG4gIGludGVncml0eT1cInNoYTUxMi1NU09vMWFZKzNwWENPQ2RHQVlvQlo2WUdJMGFyYWdvUXNnMW1LS0JIWENZUElXeGFtd09FN0RyaCtONUNQZ0dJNVNBOUlFS0ppUGpkZnFXRldtWnRSQT09XCJcbiAgY3Jvc3NvcmlnaW49XCJhbm9ueW1vdXNcIlxuICByZWZlcnJlcnBvbGljeT1cIm5vLXJlZmVycmVyXCJcbj4ke1wiPFwiICsgXCIvc2NyaXB0XCJ9PlxuJHtcIjxcIiArIFwic2NyaXB0XCJ9XG4gIHNyYz1cImh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2xvZGFzaC5qcy80LjE3LjIxL2xvZGFzaC5taW4uanNcIlxuICBpbnRlZ3JpdHk9XCJzaGE1MTItV0ZOMDQ4NDZzZEtNSVA1TEtOcGhNYVd6VTdZcE15Q1UyNDVldEszZy8yQVJZYlBLOVViMThlRytsalU5NnFLUkNXaCtxdUNZN3llZlNtbGtRdzFBTlE9PVwiXG4gIGNyb3Nzb3JpZ2luPVwiYW5vbnltb3VzXCJcbiAgcmVmZXJyZXJwb2xpY3k9XCJuby1yZWZlcnJlclwiXG4+JHtcIjxcIiArIFwiL3NjcmlwdFwifT5cbiR7XCI8XCIgKyBcInNjcmlwdFwifVxuICBzcmM9XCJodHRwczovL2Zhc3RseS5qc2RlbGl2ci5uZXQvZ2gvTjBWSTAyOC9KUy1TbGFzaC1SdW5uZXIvbGliL3lhbWwubWluLmpzXCJcbiAgY3Jvc3NvcmlnaW49XCJhbm9ueW1vdXNcIlxuICByZWZlcnJlcnBvbGljeT1cIm5vLXJlZmVycmVyXCJcbj4ke1wiPFwiICsgXCIvc2NyaXB0XCJ9PlxuYDtcbi8vIEV4cG9ydHNcbmV4cG9ydCBkZWZhdWx0IGNvZGU7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/third_party.html\n')},"./src/util/check_update.ts":
/*!**********************************!*\
  !*** ./src/util/check_update.ts ***!
  \**********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VERSION_FILE_PATH: () => (/* binding */ VERSION_FILE_PATH),\n/* harmony export */   addVersionUpdateElement: () => (/* binding */ addVersionUpdateElement),\n/* harmony export */   getChangelog: () => (/* binding */ getChangelog),\n/* harmony export */   getCurrentVersion: () => (/* binding */ getCurrentVersion),\n/* harmony export */   getFileContentByPath: () => (/* binding */ getFileContentByPath),\n/* harmony export */   handleUpdateButton: () => (/* binding */ handleUpdateButton),\n/* harmony export */   parseChangelogBetweenVersions: () => (/* binding */ parseChangelogBetweenVersions),\n/* harmony export */   parseVersionFromFile: () => (/* binding */ parseVersionFromFile),\n/* harmony export */   runCheckWithPath: () => (/* binding */ runCheckWithPath),\n/* harmony export */   showNewFeature: () => (/* binding */ showNewFeature),\n/* harmony export */   updateTavernHelper: () => (/* binding */ updateTavernHelper)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/i18n */ \"@sillytavern/scripts/i18n\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _extension_variables__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _render_markdown__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./render_markdown */ \"./src/util/render_markdown.ts\");\n\n\n\n\n\n\nconst GITLAB_INSTANCE_URL = 'gitlab.com';\nconst GITLAB_PROJECT_PATH = 'novi028/JS-Slash-Runner';\nconst GITLAB_BRANCH = 'main';\nconst VERSION_FILE_PATH_GITLAB = 'manifest.json';\nconst CHANGELOG_FILE_PATH_GITLAB = 'CHANGELOG.md';\nconst VERSION_FILE_PATH = `/scripts/extensions/${_extension_variables__WEBPACK_IMPORTED_MODULE_4__.extensionFolderPath}/manifest.json`;\nlet CURRENT_VERSION;\nlet LATEST_VERSION;\nlet CHANGELOG_CONTENT;\n/**\n *  GitLab  ( ID )\n * @param filePath  ( URL )\n * @returns  Promise<string>\n */\nasync function fetchRawFileContentFromGitLab(filePath) {\n    const idOrPathForUrl = typeof GITLAB_PROJECT_PATH === 'string' && GITLAB_PROJECT_PATH.includes('/')\n        ? encodeURIComponent(GITLAB_PROJECT_PATH)\n        : GITLAB_PROJECT_PATH;\n    const encodedFilePath = encodeURIComponent(filePath);\n    const url = `https://${GITLAB_INSTANCE_URL}/api/v4/projects/${idOrPathForUrl}/repository/files/${encodedFilePath}/raw?ref=${GITLAB_BRANCH}`;\n    const headers = {\n        'Cache-Control': 'no-cache',\n    };\n    try {\n        const response = await fetch(url, { method: 'GET', headers: headers });\n        if (!response.ok) {\n            let errorBody = '';\n            try {\n                errorBody = await response.text();\n            }\n            catch (e) {\n                /* ignore */\n            }\n            throw new Error(`[TavernHelper]  GitLab : ${response.status} ${response.statusText}. URL: ${url}. Response: ${errorBody}`);\n        }\n        const content = await response.text();\n        return content.trim();\n    }\n    catch (error) {\n        console.error('[TavernHelper]  GitLab :', error);\n        throw error;\n    }\n}\n/**\n *  JSON  'version' \n * @param content \n * @returns  ( \"2.5.5\")\n * @throws  JSON 'version' \n */\nfunction parseVersionFromFile(content) {\n    try {\n        const data = JSON.parse(content);\n        if (data && typeof data.version === 'string') {\n            return data.version;\n        }\n        else {\n            throw new Error(\"[TavernHelper]  JSON  'version'  ()\");\n        }\n    }\n    catch (error) {\n        console.error('[TavernHelper] :', error);\n        if (error instanceof SyntaxError) {\n            throw new Error(`[TavernHelper]  JSON: ${error.message}`);\n        }\n        throw new Error(`[TavernHelper] : ${error instanceof Error ? error.message : String(error)}`);\n    }\n}\n/**\n * \n * @param path \n * @returns \n */\nasync function getCurrentVersion(path) {\n    CURRENT_VERSION = parseVersionFromFile(await getFileContentByPath(path));\n    return CURRENT_VERSION;\n}\n/**\n *  (Semantic Versioning - Major.Minor.Patch)\n * @param versionA  A ( \"2.5.5\")\n * @param versionB  B ( \"1.0.0\")\n * @returns\n * -  (> 0):  versionA > versionB (A )\n * -  (< 0):  versionA < versionB (B )\n * - 0:         versionA == versionB ()\n * :  (-beta)  (+build)\n *  \"2.5.5-beta\"  \"2.5.5\" \n */\nfunction compareSemVer(versionA, versionB) {\n    const cleanVersionA = versionA.split('-')[0].split('+')[0];\n    const cleanVersionB = versionB.split('-')[0].split('+')[0];\n    const partsA = cleanVersionA.split('.').map(Number);\n    const partsB = cleanVersionB.split('.').map(Number);\n    for (let i = 0; i < 3; i++) {\n        //  ( \"1.2\" vs \"1.2.3\") 0\n        const numA = partsA[i] || 0;\n        const numB = partsB[i] || 0;\n        if (isNaN(numA) || isNaN(numB)) {\n            console.warn(`[TavernHelper]  \"${versionA}\"  \"${versionB}\" `);\n            return 0;\n        }\n        if (numA > numB) {\n            return 1;\n        }\n        if (numA < numB) {\n            return -1;\n        }\n    }\n    return 0;\n}\nasync function getFileContentByPath(filePath) {\n    try {\n        const response = await fetch(filePath);\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const content = await response.text();\n        return content;\n    }\n    catch (error) {\n        console.error(` ${filePath} :`, error);\n        throw error;\n    }\n}\nasync function runCheckWithPath() {\n    try {\n        LATEST_VERSION = parseVersionFromFile(await fetchRawFileContentFromGitLab(VERSION_FILE_PATH_GITLAB));\n        const comparisonResult = compareSemVer(LATEST_VERSION, CURRENT_VERSION);\n        if (comparisonResult > 0) {\n            console.info(`[TavernHelper]  ${LATEST_VERSION} >  ${CURRENT_VERSION}`);\n            return true;\n        }\n        else if (comparisonResult === 0) {\n            console.info(`[TavernHelper]  ${CURRENT_VERSION} `);\n            return false;\n        }\n        else {\n            console.warn(`[TavernHelper]  ${CURRENT_VERSION}  ${LATEST_VERSION} `);\n            return false;\n        }\n    }\n    catch (error) {\n        console.error('[TavernHelper] :', error);\n        return false;\n    }\n}\n/**\n * \n */\nfunction addVersionUpdateElement() {\n    const container = $('#tavern-helper-extension-container .inline-drawer-header b');\n    container.append(`\n    <span style=\"color: red; font-size: 12px; font-weight: bold;\">\n      New!\n    </span>\n  `);\n    $('#version-update-text').closest('.flex-container .alignItemsCenter').append(`\n      <div style='background-color: var(--SmartThemeQuoteColor);border-radius: 50px;padding: 0 5px;height: 50%; font-size: calc(var(--mainFontSize) * 0.7);'>\n        Ver ${LATEST_VERSION}\n      </div>\n    `);\n}\n/**\n * \n * @param changelogContent \n * @param currentVersion \n * @param latestVersion \n * @returns \n */\nfunction parseChangelogBetweenVersions(changelogContent, currentVersion, latestVersion) {\n    // Markdown\n    //  ##   #   [] \n    const versionRegex = /(?:^|\\n)(?:#{1,3}\\s*|\\[)([0-9]+\\.[0-9]+\\.[0-9]+)(?:\\]|\\s|$)/g;\n    const matches = [...changelogContent.matchAll(versionRegex)];\n    if (matches.length === 0) {\n        toastr.error('');\n        return;\n    }\n    // \n    const comparisonResult = compareSemVer(latestVersion, currentVersion);\n    let extractedContent = '';\n    if (comparisonResult <= 0) {\n        // \n        const latestVersionMatch = matches.find(match => match[1] === latestVersion);\n        if (!latestVersionMatch) {\n            toastr.error('');\n            return;\n        }\n        const startIndex = latestVersionMatch.index;\n        const nextVersionMatch = matches.find(match => match.index > startIndex);\n        const endIndex = nextVersionMatch ? nextVersionMatch.index : changelogContent.length;\n        extractedContent = changelogContent.substring(startIndex, endIndex).trim();\n    }\n    else {\n        const currentVersionMatch = matches.find(match => match[1] === currentVersion);\n        if (!currentVersionMatch) {\n            toastr.error(` ${currentVersion} `);\n            return;\n        }\n        const latestVersionMatch = matches.find(match => match[1] === latestVersion);\n        if (!latestVersionMatch) {\n            toastr.error(` ${latestVersion} `);\n            return;\n        }\n        const startIndex = currentVersionMatch.index;\n        const endIndex = latestVersionMatch.index;\n        extractedContent = changelogContent.substring(startIndex, endIndex).trim();\n    }\n    return (0,_render_markdown__WEBPACK_IMPORTED_MODULE_5__.renderMarkdown)(extractedContent);\n}\n/**\n * changeLogpopup\n */\nasync function handleUpdateButton() {\n    if (!CHANGELOG_CONTENT) {\n        await getChangelog();\n    }\n    const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.callGenericPopup)(CHANGELOG_CONTENT, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.POPUP_TYPE.CONFIRM, '', {\n        okButton: '',\n        cancelButton: '',\n    });\n    if (result) {\n        toastr.info('');\n        await updateTavernHelper();\n    }\n}\n/**\n * \n * @returns \n */\nasync function getChangelog() {\n    toastr.info('');\n    const changelogContent = await fetchRawFileContentFromGitLab(CHANGELOG_FILE_PATH_GITLAB);\n    if (LATEST_VERSION === undefined) {\n        LATEST_VERSION = parseVersionFromFile(await fetchRawFileContentFromGitLab(VERSION_FILE_PATH_GITLAB));\n    }\n    if (CURRENT_VERSION === undefined) {\n        CURRENT_VERSION = parseVersionFromFile(await getFileContentByPath(VERSION_FILE_PATH));\n    }\n    const logs = parseChangelogBetweenVersions(changelogContent, CURRENT_VERSION, LATEST_VERSION);\n    if (!logs) {\n        toastr.error('');\n        return;\n    }\n    else {\n        CHANGELOG_CONTENT = logs;\n    }\n}\n/**\n * \n */\nasync function updateTavernHelper() {\n    const extensionType = getExtensionType(_extension_variables__WEBPACK_IMPORTED_MODULE_4__.extensionName);\n    const response = await fetch('/api/extensions/update', {\n        method: 'POST',\n        headers: (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getRequestHeaders)(),\n        body: JSON.stringify({ extensionName: _extension_variables__WEBPACK_IMPORTED_MODULE_4__.extensionName, global: extensionType === 'global' ? true : false }),\n    });\n    if (!response.ok) {\n        const text = await response.text();\n        toastr.error(text || response.statusText, (0,_sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_2__.t) ``, { timeOut: 5000 });\n        console.error(`: ${text}`);\n        return false;\n    }\n    const data = await response.json();\n    if (data.isUpToDate) {\n        console.info(`, `);\n    }\n    else {\n        toastr.success((0,_sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_2__.t) ` ${data.shortCommitHash}, ...`);\n        console.info(`  ${data.shortCommitHash}, ...`);\n        setTimeout(() => location.reload(), 3000);\n    }\n    return true;\n}\n// \n/**\n * Gets the type of an extension based on its external ID.\n * @param {string} externalId External ID of the extension (excluding or including the leading 'third-party/')\n * @returns {string} Type of the extension (global, local, system, or empty string if not found)\n */\nfunction getExtensionType(externalId) {\n    const id = Object.keys(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extensionTypes).find(\n    // eslint-disable-next-line no-shadow\n    (id) => id === externalId || (id.startsWith('third-party') && id.endsWith(externalId)));\n    return id ? _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extensionTypes[id] : 'local';\n}\n// \n/**\n *\n */\nasync function showNewFeature() {\n    let changelogContent = await fetchRawFileContentFromGitLab(CHANGELOG_FILE_PATH_GITLAB);\n    changelogContent = changelogContent + '\\n\\n**';\n    const logs = parseChangelogBetweenVersions(changelogContent, '3.0.0', '3.0.0');\n    if (logs) {\n        const modifiedLogs = logs.replace(/<h2([^>]*)>([^<]*)<\\/h2>/g, '<h2$1> $2</h2>');\n        await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.callGenericPopup)(modifiedLogs, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.POPUP_TYPE.TEXT);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJLENBQUMsMkVBQWMsQ0FBQyxDQUFDLElBQUk7SUFDekMscUNBQXFDO0lBQ3JDLENBQUMsRUFBVSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEtBQUssVUFBVSxJQUFJLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQy9GLENBQUM7SUFDRixPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUMsMkVBQWMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDO0FBQzNDLENBQUM7QUFFRCxTQUFTO0FBQ1Q7O0dBRUc7QUFFSSxLQUFLLFVBQVUsY0FBYztJQUNsQyxJQUFJLGdCQUFnQixHQUFHLE1BQU0sNkJBQTZCLENBQUMsMEJBQTBCLENBQUMsQ0FBQztJQUN2RixnQkFBZ0IsR0FBRyxnQkFBZ0IsR0FBRyw2QkFBNkIsQ0FBQztJQUNwRSxNQUFNLElBQUksR0FBRyw2QkFBNkIsQ0FBQyxnQkFBZ0IsRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFFL0UsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUNULE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsMkJBQTJCLEVBQUUsb0JBQW9CLENBQUMsQ0FBQztRQUNyRixNQUFNLDRFQUFnQixDQUFDLFlBQVksRUFBRSxrRUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3hELENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL3V0aWwvY2hlY2tfdXBkYXRlLnRzPzFhMDkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0UmVxdWVzdEhlYWRlcnMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGV4dGVuc2lvblR5cGVzIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyB0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvaTE4bic7XG5pbXBvcnQgeyBQT1BVUF9UWVBFLCBjYWxsR2VuZXJpY1BvcHVwIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG9wdXAnO1xuaW1wb3J0IHsgZXh0ZW5zaW9uRm9sZGVyUGF0aCwgZXh0ZW5zaW9uTmFtZSB9IGZyb20gJy4vZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5pbXBvcnQgeyByZW5kZXJNYXJrZG93biB9IGZyb20gJy4vcmVuZGVyX21hcmtkb3duJztcblxuY29uc3QgR0lUTEFCX0lOU1RBTkNFX1VSTCA9ICdnaXRsYWIuY29tJztcbmNvbnN0IEdJVExBQl9QUk9KRUNUX1BBVEggPSAnbm92aTAyOC9KUy1TbGFzaC1SdW5uZXInO1xuY29uc3QgR0lUTEFCX0JSQU5DSCA9ICdtYWluJztcbmNvbnN0IFZFUlNJT05fRklMRV9QQVRIX0dJVExBQiA9ICdtYW5pZmVzdC5qc29uJztcbmNvbnN0IENIQU5HRUxPR19GSUxFX1BBVEhfR0lUTEFCID0gJ0NIQU5HRUxPRy5tZCc7XG5leHBvcnQgY29uc3QgVkVSU0lPTl9GSUxFX1BBVEggPSBgL3NjcmlwdHMvZXh0ZW5zaW9ucy8ke2V4dGVuc2lvbkZvbGRlclBhdGh9L21hbmlmZXN0Lmpzb25gO1xubGV0IENVUlJFTlRfVkVSU0lPTjogc3RyaW5nO1xubGV0IExBVEVTVF9WRVJTSU9OOiBzdHJpbmc7XG5sZXQgQ0hBTkdFTE9HX0NPTlRFTlQ6IHN0cmluZztcblxuLyoqXG4gKiDku44gR2l0TGFiIOS7k+W6k+iOt+WPluaMh+WumuaWh+S7tueahOWOn+Wni+WGheWuuSAo5pSv5oyB6aG555uuIElEIOaIlumhueebrui3r+W+hClcbiAqIEBwYXJhbSBmaWxlUGF0aCDmlofku7blnKjku5PlupPkuK3nmoTot6/lvoQgKOS8muiiq+iHquWKqCBVUkwg57yW56CBKVxuICogQHJldHVybnMg6L+U5Zue5paH5Lu25YaF5a6555qEIFByb21pc2U8c3RyaW5nPlxuICovXG5hc3luYyBmdW5jdGlvbiBmZXRjaFJhd0ZpbGVDb250ZW50RnJvbUdpdExhYihmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgaWRPclBhdGhGb3JVcmwgPVxuICAgIHR5cGVvZiBHSVRMQUJfUFJPSkVDVF9QQVRIID09PSAnc3RyaW5nJyAmJiBHSVRMQUJfUFJPSkVDVF9QQVRILmluY2x1ZGVzKCcvJylcbiAgICAgID8gZW5jb2RlVVJJQ29tcG9uZW50KEdJVExBQl9QUk9KRUNUX1BBVEgpXG4gICAgICA6IEdJVExBQl9QUk9KRUNUX1BBVEg7XG4gIGNvbnN0IGVuY29kZWRGaWxlUGF0aCA9IGVuY29kZVVSSUNvbXBvbmVudChmaWxlUGF0aCk7XG4gIGNvbnN0IHVybCA9IGBodHRwczovLyR7R0lUTEFCX0lOU1RBTkNFX1VSTH0vYXBpL3Y0L3Byb2plY3RzLyR7aWRPclBhdGhGb3JVcmx9L3JlcG9zaXRvcnkvZmlsZXMvJHtlbmNvZGVkRmlsZVBhdGh9L3Jhdz9yZWY9JHtHSVRMQUJfQlJBTkNIfWA7XG5cbiAgY29uc3QgaGVhZGVyczogSGVhZGVyc0luaXQgPSB7XG4gICAgJ0NhY2hlLUNvbnRyb2wnOiAnbm8tY2FjaGUnLFxuICB9O1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHsgbWV0aG9kOiAnR0VUJywgaGVhZGVyczogaGVhZGVycyB9KTtcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBsZXQgZXJyb3JCb2R5ID0gJyc7XG4gICAgICB0cnkge1xuICAgICAgICBlcnJvckJvZHkgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8qIGlnbm9yZSAqL1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgW1RhdmVybkhlbHBlcl0g5peg5rOV6I635Y+WIEdpdExhYiDmlofku7Y6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9LiBVUkw6ICR7dXJsfS4gUmVzcG9uc2U6ICR7ZXJyb3JCb2R5fWAsXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIHJldHVybiBjb250ZW50LnRyaW0oKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbVGF2ZXJuSGVscGVyXSDojrflj5YgR2l0TGFiIOaWh+S7tuWGheWuueaXtuWHuumUmTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLyoqXG4gKiDku44gSlNPTiDmlofku7blhoXlrrnkuK3op6PmnpAgJ3ZlcnNpb24nIOWtl+auteeahOWAvFxuICogQHBhcmFtIGNvbnRlbnQg5paH5Lu25YaF5a655a2X56ym5LiyXG4gKiBAcmV0dXJucyDop6PmnpDlh7rnmoTniYjmnKzlj7flrZfnrKbkuLIgKOS+i+WmgiBcIjIuNS41XCIpXG4gKiBAdGhyb3dzIOWmguaenOWGheWuueS4jeaYr+acieaViOeahCBKU09O77yM5oiW6ICFICd2ZXJzaW9uJyDlrZfmrrXkuI3lrZjlnKjmiJbkuI3mmK/lrZfnrKbkuLLvvIzliJnmipvlh7rplJnor69cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVmVyc2lvbkZyb21GaWxlKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIHRyeSB7XG4gICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoY29udGVudCk7XG5cbiAgICBpZiAoZGF0YSAmJiB0eXBlb2YgZGF0YS52ZXJzaW9uID09PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIGRhdGEudmVyc2lvbjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiW1RhdmVybkhlbHBlcl0g5ZyoIEpTT04g5pWw5o2u5Lit5pyq5om+5Yiw5pyJ5pWI55qEICd2ZXJzaW9uJyDlrZfmrrUgKOW/hemhu+aYr+Wtl+espuS4suexu+WeiylcIik7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tUYXZlcm5IZWxwZXJdIOino+aekOeJiOacrOaWh+S7tuWGheWuueaXtuWHuumUmTonLCBlcnJvcik7XG5cbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBTeW50YXhFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBbVGF2ZXJuSGVscGVyXSDml6Dms5XlsIbmlofku7blhoXlrrnop6PmnpDkuLogSlNPTjogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cblxuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBbVGF2ZXJuSGVscGVyXSDml6Dms5Xku47mlofku7blhoXlrrnkuK3op6PmnpDniYjmnKzlj7c6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWAsXG4gICAgKTtcbiAgfVxufVxuXG4vKipcbiAqIOiOt+WPluW9k+WJjeeJiOacrOWPt1xuICogQHBhcmFtIHBhdGgg54mI5pys5Y+35paH5Lu26Lev5b6EXG4gKiBAcmV0dXJucyDlvZPliY3niYjmnKzlj7dcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRWZXJzaW9uKHBhdGg6IHN0cmluZykge1xuICBDVVJSRU5UX1ZFUlNJT04gPSBwYXJzZVZlcnNpb25Gcm9tRmlsZShhd2FpdCBnZXRGaWxlQ29udGVudEJ5UGF0aChwYXRoKSk7XG4gIHJldHVybiBDVVJSRU5UX1ZFUlNJT047XG59XG5cbi8qKlxuICog5q+U6L6D5Lik5Liq6K+t5LmJ5YyW54mI5pys5Y+3IChTZW1hbnRpYyBWZXJzaW9uaW5nIC0gTWFqb3IuTWlub3IuUGF0Y2gpXG4gKiBAcGFyYW0gdmVyc2lvbkEg54mI5pys5Y+35a2X56ym5LiyIEEgKOS+i+WmgiBcIjIuNS41XCIpXG4gKiBAcGFyYW0gdmVyc2lvbkIg54mI5pys5Y+35a2X56ym5LiyIEIgKOS+i+WmgiBcIjEuMC4wXCIpXG4gKiBAcmV0dXJuc1xuICogLSDmraPmlbAgKD4gMCk6IOWmguaenCB2ZXJzaW9uQSA+IHZlcnNpb25CIChBIOabtOaWsClcbiAqIC0g6LSf5pWwICg8IDApOiDlpoLmnpwgdmVyc2lvbkEgPCB2ZXJzaW9uQiAoQiDmm7TmlrApXG4gKiAtIDA6ICAgICAgICDlpoLmnpwgdmVyc2lvbkEgPT0gdmVyc2lvbkIgKOeJiOacrOebuOWQjClcbiAqIOazqOaEjzog6L+Z5Liq5Z+656GA5q+U6L6D5Zmo5LiN5aSE55CG6aKE5Y+R5biD5qCH562+ICgtYmV0YSkg5oiW5p6E5bu65YWD5pWw5o2uICgrYnVpbGQp44CCXG4gKiDlroPkvJrlsIYgXCIyLjUuNS1iZXRhXCIg5ZKMIFwiMi41LjVcIiDlnKjmraTmr5TovoPkuK3op4bkuLrnm7jnrYnjgIJcbiAqL1xuZnVuY3Rpb24gY29tcGFyZVNlbVZlcih2ZXJzaW9uQTogc3RyaW5nLCB2ZXJzaW9uQjogc3RyaW5nKTogbnVtYmVyIHtcbiAgY29uc3QgY2xlYW5WZXJzaW9uQSA9IHZlcnNpb25BLnNwbGl0KCctJylbMF0uc3BsaXQoJysnKVswXTtcbiAgY29uc3QgY2xlYW5WZXJzaW9uQiA9IHZlcnNpb25CLnNwbGl0KCctJylbMF0uc3BsaXQoJysnKVswXTtcblxuICBjb25zdCBwYXJ0c0EgPSBjbGVhblZlcnNpb25BLnNwbGl0KCcuJykubWFwKE51bWJlcik7XG4gIGNvbnN0IHBhcnRzQiA9IGNsZWFuVmVyc2lvbkIuc3BsaXQoJy4nKS5tYXAoTnVtYmVyKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IDM7IGkrKykge1xuICAgIC8vIOWmguaenOafkOS4queJiOacrOWPt+mDqOWIhue8uuWksSAo5L6L5aaCIFwiMS4yXCIgdnMgXCIxLjIuM1wiKe+8jOWImeinhuS4uiAwXG4gICAgY29uc3QgbnVtQSA9IHBhcnRzQVtpXSB8fCAwO1xuICAgIGNvbnN0IG51bUIgPSBwYXJ0c0JbaV0gfHwgMDtcblxuICAgIGlmIChpc05hTihudW1BKSB8fCBpc05hTihudW1CKSkge1xuICAgICAgY29uc29sZS53YXJuKGBbVGF2ZXJuSGVscGVyXSDniYjmnKzlj7cgXCIke3ZlcnNpb25BfVwiIOaIliBcIiR7dmVyc2lvbkJ9XCIg5YyF5ZCr6Z2e5pWw5a2X6YOo5YiG77yM5Y+v6IO95a+86Ie05q+U6L6D5LiN5YeG56Gu44CCYCk7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICBpZiAobnVtQSA+IG51bUIpIHtcbiAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBpZiAobnVtQSA8IG51bUIpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gMDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEZpbGVDb250ZW50QnlQYXRoKGZpbGVQYXRoOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGZpbGVQYXRoKTtcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgfVxuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihg6K+75Y+W5paH5Lu2ICR7ZmlsZVBhdGh9IOWksei0pTpgLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJ1bkNoZWNrV2l0aFBhdGgoKSB7XG4gIHRyeSB7XG4gICAgTEFURVNUX1ZFUlNJT04gPSBwYXJzZVZlcnNpb25Gcm9tRmlsZShhd2FpdCBmZXRjaFJhd0ZpbGVDb250ZW50RnJvbUdpdExhYihWRVJTSU9OX0ZJTEVfUEFUSF9HSVRMQUIpKTtcblxuICAgIGNvbnN0IGNvbXBhcmlzb25SZXN1bHQgPSBjb21wYXJlU2VtVmVyKExBVEVTVF9WRVJTSU9OLCBDVVJSRU5UX1ZFUlNJT04pO1xuXG4gICAgaWYgKGNvbXBhcmlzb25SZXN1bHQgPiAwKSB7XG4gICAgICBjb25zb2xlLmluZm8oYFtUYXZlcm5IZWxwZXJdIOmcgOimgeabtOaWsO+8geacgOaWsOeJiOacrCAke0xBVEVTVF9WRVJTSU9OfSA+IOW9k+WJjeeJiOacrCAke0NVUlJFTlRfVkVSU0lPTn1gKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSBpZiAoY29tcGFyaXNvblJlc3VsdCA9PT0gMCkge1xuICAgICAgY29uc29sZS5pbmZvKGBbVGF2ZXJuSGVscGVyXSDlvZPliY3niYjmnKwgJHtDVVJSRU5UX1ZFUlNJT059IOW3suaYr+acgOaWsOOAgmApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLndhcm4oYFtUYXZlcm5IZWxwZXJdIOW9k+WJjeeJiOacrCAke0NVUlJFTlRfVkVSU0lPTn0g5q+U6L+c56iL54mI5pysICR7TEFURVNUX1ZFUlNJT059IOi/mOaWsO+8n2ApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbVGF2ZXJuSGVscGVyXSDniYjmnKzmo4Dmn6XlpLHotKU6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIOa3u+WKoOeJiOacrOabtOaWsOaPkOekuuWFg+e0oFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkVmVyc2lvblVwZGF0ZUVsZW1lbnQoKSB7XG4gIGNvbnN0IGNvbnRhaW5lciA9ICQoJyN0YXZlcm4taGVscGVyLWV4dGVuc2lvbi1jb250YWluZXIgLmlubGluZS1kcmF3ZXItaGVhZGVyIGInKTtcbiAgY29udGFpbmVyLmFwcGVuZChgXG4gICAgPHNwYW4gc3R5bGU9XCJjb2xvcjogcmVkOyBmb250LXNpemU6IDEycHg7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPlxuICAgICAgTmV3IVxuICAgIDwvc3Bhbj5cbiAgYCk7XG4gICQoJyN2ZXJzaW9uLXVwZGF0ZS10ZXh0JykuY2xvc2VzdCgnLmZsZXgtY29udGFpbmVyIC5hbGlnbkl0ZW1zQ2VudGVyJykuYXBwZW5kKGBcbiAgICAgIDxkaXYgc3R5bGU9J2JhY2tncm91bmQtY29sb3I6IHZhcigtLVNtYXJ0VGhlbWVRdW90ZUNvbG9yKTtib3JkZXItcmFkaXVzOiA1MHB4O3BhZGRpbmc6IDAgNXB4O2hlaWdodDogNTAlOyBmb250LXNpemU6IGNhbGModmFyKC0tbWFpbkZvbnRTaXplKSAqIDAuNyk7Jz5cbiAgICAgICAg5pyA5paw77yaVmVyICR7TEFURVNUX1ZFUlNJT059XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcbn1cblxuLyoqXG4gKiDop6PmnpDlj5jmm7Tml6Xlv5flhoXlrrnvvIzmj5Dlj5bkuKTkuKrniYjmnKzkuYvpl7TnmoTml6Xlv5dcbiAqIEBwYXJhbSBjaGFuZ2Vsb2dDb250ZW50IOWPmOabtOaXpeW/l+eahOWujOaVtOWGheWuuVxuICogQHBhcmFtIGN1cnJlbnRWZXJzaW9uIOW9k+WJjeeJiOacrOWPt1xuICogQHBhcmFtIGxhdGVzdFZlcnNpb24g5pyA5paw54mI5pys5Y+3XG4gKiBAcmV0dXJucyDkuKTkuKrniYjmnKzkuYvpl7TnmoTml6Xlv5flhoXlrrlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlQ2hhbmdlbG9nQmV0d2VlblZlcnNpb25zKFxuICBjaGFuZ2Vsb2dDb250ZW50OiBzdHJpbmcsXG4gIGN1cnJlbnRWZXJzaW9uOiBzdHJpbmcsXG4gIGxhdGVzdFZlcnNpb246IHN0cmluZyxcbik6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gIC8vIOafpeaJvuaJgOacieeJiOacrOagh+mimO+8jOaUr+aMgeWkmuenjU1hcmtkb3du5qCH6aKY5qC85byPXG4gIC8vIOWMuemFjSAjIyDniYjmnKzlj7cg5oiWICMg54mI5pys5Y+3IOaIliBb54mI5pys5Y+3XSDnrYnmoLzlvI9cbiAgY29uc3QgdmVyc2lvblJlZ2V4ID0gLyg/Ol58XFxuKSg/OiN7MSwzfVxccyp8XFxbKShbMC05XStcXC5bMC05XStcXC5bMC05XSspKD86XFxdfFxcc3wkKS9nO1xuICBjb25zdCBtYXRjaGVzID0gWy4uLmNoYW5nZWxvZ0NvbnRlbnQubWF0Y2hBbGwodmVyc2lvblJlZ2V4KV07XG5cbiAgaWYgKG1hdGNoZXMubGVuZ3RoID09PSAwKSB7XG4gICAgdG9hc3RyLmVycm9yKCfml6Dms5Xmib7liLDniYjmnKzml6Xlv5fjgIInKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyDmr5TovoPlvZPliY3niYjmnKzlkozmnIDmlrDniYjmnKxcbiAgY29uc3QgY29tcGFyaXNvblJlc3VsdCA9IGNvbXBhcmVTZW1WZXIobGF0ZXN0VmVyc2lvbiwgY3VycmVudFZlcnNpb24pO1xuICBsZXQgZXh0cmFjdGVkQ29udGVudCA9ICcnO1xuXG4gIGlmIChjb21wYXJpc29uUmVzdWx0IDw9IDApIHtcbiAgICAvLyDlvZPliY3niYjmnKzlpKfkuo7miJbnrYnkuo7mnIDmlrDniYjmnKzvvIzlj6rov5Tlm57mnIDmlrDniYjmnKznmoTml6Xlv5dcbiAgICBjb25zdCBsYXRlc3RWZXJzaW9uTWF0Y2ggPSBtYXRjaGVzLmZpbmQobWF0Y2ggPT4gbWF0Y2hbMV0gPT09IGxhdGVzdFZlcnNpb24pO1xuICAgIGlmICghbGF0ZXN0VmVyc2lvbk1hdGNoKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoJ+iOt+WPluabtOaWsOaXpeW/l+Wksei0pScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBsYXRlc3RWZXJzaW9uTWF0Y2guaW5kZXg7XG4gICAgY29uc3QgbmV4dFZlcnNpb25NYXRjaCA9IG1hdGNoZXMuZmluZChtYXRjaCA9PiBtYXRjaC5pbmRleCA+IHN0YXJ0SW5kZXgpO1xuICAgIGNvbnN0IGVuZEluZGV4ID0gbmV4dFZlcnNpb25NYXRjaCA/IG5leHRWZXJzaW9uTWF0Y2guaW5kZXggOiBjaGFuZ2Vsb2dDb250ZW50Lmxlbmd0aDtcblxuICAgIGV4dHJhY3RlZENvbnRlbnQgPSBjaGFuZ2Vsb2dDb250ZW50LnN1YnN0cmluZyhzdGFydEluZGV4LCBlbmRJbmRleCkudHJpbSgpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGN1cnJlbnRWZXJzaW9uTWF0Y2ggPSBtYXRjaGVzLmZpbmQobWF0Y2ggPT4gbWF0Y2hbMV0gPT09IGN1cnJlbnRWZXJzaW9uKTtcbiAgICBpZiAoIWN1cnJlbnRWZXJzaW9uTWF0Y2gpIHtcbiAgICAgIHRvYXN0ci5lcnJvcihg5peg5rOV5om+5Yiw54mI5pysICR7Y3VycmVudFZlcnNpb259IOeahOaXpeW/l+OAgmApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGxhdGVzdFZlcnNpb25NYXRjaCA9IG1hdGNoZXMuZmluZChtYXRjaCA9PiBtYXRjaFsxXSA9PT0gbGF0ZXN0VmVyc2lvbik7XG4gICAgaWYgKCFsYXRlc3RWZXJzaW9uTWF0Y2gpIHtcbiAgICAgIHRvYXN0ci5lcnJvcihg5peg5rOV5om+5Yiw54mI5pysICR7bGF0ZXN0VmVyc2lvbn0g55qE5pel5b+X44CCYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgc3RhcnRJbmRleCA9IGN1cnJlbnRWZXJzaW9uTWF0Y2guaW5kZXg7XG4gICAgY29uc3QgZW5kSW5kZXggPSBsYXRlc3RWZXJzaW9uTWF0Y2guaW5kZXg7XG5cbiAgICBleHRyYWN0ZWRDb250ZW50ID0gY2hhbmdlbG9nQ29udGVudC5zdWJzdHJpbmcoc3RhcnRJbmRleCwgZW5kSW5kZXgpLnRyaW0oKTtcbiAgfVxuXG4gIHJldHVybiByZW5kZXJNYXJrZG93bihleHRyYWN0ZWRDb250ZW50KTtcbn1cblxuLyoqXG4gKiDlvLnlh7pjaGFuZ2VMb2fnmoRwb3B1cFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlVXBkYXRlQnV0dG9uKCkge1xuICBpZiAoIUNIQU5HRUxPR19DT05URU5UKSB7XG4gICAgYXdhaXQgZ2V0Q2hhbmdlbG9nKCk7XG4gIH1cbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChDSEFOR0VMT0dfQ09OVEVOVCwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgIG9rQnV0dG9uOiAn5pu05pawJyxcbiAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICB9KTtcbiAgaWYgKHJlc3VsdCkge1xuICAgIHRvYXN0ci5pbmZvKCfmm7TmlrDkuK3igKbigKYnKTtcbiAgICBhd2FpdCB1cGRhdGVUYXZlcm5IZWxwZXIoKTtcbiAgfVxufVxuXG4vKipcbiAqIOiOt+WPluWPmOabtOaXpeW/l1xuICogQHJldHVybnMg5Lik5Liq54mI5pys5LmL6Ze055qE5pel5b+X5YaF5a65XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDaGFuZ2Vsb2coKSB7XG4gIHRvYXN0ci5pbmZvKCfojrflj5bmm7TmlrDml6Xlv5fkuK3igKbigKYnKTtcbiAgY29uc3QgY2hhbmdlbG9nQ29udGVudCA9IGF3YWl0IGZldGNoUmF3RmlsZUNvbnRlbnRGcm9tR2l0TGFiKENIQU5HRUxPR19GSUxFX1BBVEhfR0lUTEFCKTtcbiAgaWYgKExBVEVTVF9WRVJTSU9OID09PSB1bmRlZmluZWQpIHtcbiAgICBMQVRFU1RfVkVSU0lPTiA9IHBhcnNlVmVyc2lvbkZyb21GaWxlKGF3YWl0IGZldGNoUmF3RmlsZUNvbnRlbnRGcm9tR2l0TGFiKFZFUlNJT05fRklMRV9QQVRIX0dJVExBQikpO1xuICB9XG5cbiAgaWYgKENVUlJFTlRfVkVSU0lPTiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgQ1VSUkVOVF9WRVJTSU9OID0gcGFyc2VWZXJzaW9uRnJvbUZpbGUoYXdhaXQgZ2V0RmlsZUNvbnRlbnRCeVBhdGgoVkVSU0lPTl9GSUxFX1BBVEgpKTtcbiAgfVxuXG4gIGNvbnN0IGxvZ3MgPSBwYXJzZUNoYW5nZWxvZ0JldHdlZW5WZXJzaW9ucyhjaGFuZ2Vsb2dDb250ZW50LCBDVVJSRU5UX1ZFUlNJT04sIExBVEVTVF9WRVJTSU9OKTtcbiAgaWYgKCFsb2dzKSB7XG4gICAgdG9hc3RyLmVycm9yKCfml6Dms5Xojrflj5bmm7TmlrDml6Xlv5cnKTtcbiAgICByZXR1cm47XG4gIH0gZWxzZSB7XG4gICAgQ0hBTkdFTE9HX0NPTlRFTlQgPSBsb2dzO1xuICB9XG59XG5cbi8qKlxuICog5pu05paw6YWS6aaG5Yqp5omLXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVUYXZlcm5IZWxwZXIoKSB7XG4gIGNvbnN0IGV4dGVuc2lvblR5cGUgPSBnZXRFeHRlbnNpb25UeXBlKGV4dGVuc2lvbk5hbWUpO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2V4dGVuc2lvbnMvdXBkYXRlJywge1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGhlYWRlcnM6IGdldFJlcXVlc3RIZWFkZXJzKCksXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBleHRlbnNpb25OYW1lOiBleHRlbnNpb25OYW1lLCBnbG9iYWw6IGV4dGVuc2lvblR5cGUgPT09ICdnbG9iYWwnID8gdHJ1ZSA6IGZhbHNlIH0pLFxuICB9KTtcbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgdG9hc3RyLmVycm9yKHRleHQgfHwgcmVzcG9uc2Uuc3RhdHVzVGV4dCwgdGDmm7TmlrDphZLppobliqnmiYvlpLHotKVgLCB7IHRpbWVPdXQ6IDUwMDAgfSk7XG4gICAgY29uc29sZS5lcnJvcihg5pu05paw6YWS6aaG5Yqp5omL5aSx6LSlOiAke3RleHR9YCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgaWYgKGRhdGEuaXNVcFRvRGF0ZSkge1xuICAgIGNvbnNvbGUuaW5mbyhg6YWS6aaG5Yqp5omL5bey5piv5pyA5paw54mI5pysLCDml6DpnIDmm7TmlrBgKTtcbiAgfSBlbHNlIHtcbiAgICB0b2FzdHIuc3VjY2Vzcyh0YOaIkOWKn+abtOaWsOmFkummhuWKqeaJi+S4uiAke2RhdGEuc2hvcnRDb21taXRIYXNofSwg5YeG5aSH5Yi35paw6aG16Z2i5Lul55Sf5pWILi4uYCk7XG4gICAgY29uc29sZS5pbmZvKGDmiJDlip/mm7TmlrDphZLppobliqnmiYvkuLogICR7ZGF0YS5zaG9ydENvbW1pdEhhc2h9LCDlh4blpIfliLfmlrDpobXpnaLku6XnlJ/mlYguLi5gKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IGxvY2F0aW9uLnJlbG9hZCgpLCAzMDAwKTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLy8g6YWS6aaG5Y6f5Luj56CB5aSN5Yi25p2l55qEXG4vKipcbiAqIEdldHMgdGhlIHR5cGUgb2YgYW4gZXh0ZW5zaW9uIGJhc2VkIG9uIGl0cyBleHRlcm5hbCBJRC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBleHRlcm5hbElkIEV4dGVybmFsIElEIG9mIHRoZSBleHRlbnNpb24gKGV4Y2x1ZGluZyBvciBpbmNsdWRpbmcgdGhlIGxlYWRpbmcgJ3RoaXJkLXBhcnR5LycpXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUeXBlIG9mIHRoZSBleHRlbnNpb24gKGdsb2JhbCwgbG9jYWwsIHN5c3RlbSwgb3IgZW1wdHkgc3RyaW5nIGlmIG5vdCBmb3VuZClcbiAqL1xuZnVuY3Rpb24gZ2V0RXh0ZW5zaW9uVHlwZShleHRlcm5hbElkOiBzdHJpbmcpIHtcbiAgY29uc3QgaWQgPSBPYmplY3Qua2V5cyhleHRlbnNpb25UeXBlcykuZmluZChcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2hhZG93XG4gICAgKGlkOiBzdHJpbmcpID0+IGlkID09PSBleHRlcm5hbElkIHx8IChpZC5zdGFydHNXaXRoKCd0aGlyZC1wYXJ0eScpICYmIGlkLmVuZHNXaXRoKGV4dGVybmFsSWQpKSxcbiAgKTtcbiAgcmV0dXJuIGlkID8gZXh0ZW5zaW9uVHlwZXNbaWRdIDogJ2xvY2FsJztcbn1cblxuLy8g5pen54mI5pu05paw5ZCO55SoXG4vKipcbiAqXG4gKi9cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNob3dOZXdGZWF0dXJlKCkge1xuICBsZXQgY2hhbmdlbG9nQ29udGVudCA9IGF3YWl0IGZldGNoUmF3RmlsZUNvbnRlbnRGcm9tR2l0TGFiKENIQU5HRUxPR19GSUxFX1BBVEhfR0lUTEFCKTtcbiAgY2hhbmdlbG9nQ29udGVudCA9IGNoYW5nZWxvZ0NvbnRlbnQgKyAnXFxuXFxuKuWJjeerr+WKqeaJi+aXp+eJiOmFjee9ruW3sua4hemZpO+8jOivt+mHjeaWsOmFjee9ruaJqeWxleiuvue9rionO1xuICBjb25zdCBsb2dzID0gcGFyc2VDaGFuZ2Vsb2dCZXR3ZWVuVmVyc2lvbnMoY2hhbmdlbG9nQ29udGVudCwgJzMuMC4wJywgJzMuMC4wJyk7XG5cbiAgaWYgKGxvZ3MpIHtcbiAgICBjb25zdCBtb2RpZmllZExvZ3MgPSBsb2dzLnJlcGxhY2UoLzxoMihbXj5dKik+KFtePF0qKTxcXC9oMj4vZywgJzxoMiQxPumFkummhuWKqeaJiyAkMjwvaDI+Jyk7XG4gICAgYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChtb2RpZmllZExvZ3MsIFBPUFVQX1RZUEUuVEVYVCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/util/check_update.ts\n")},"./src/util/collapsible.ts":
/*!*********************************!*\
  !*** ./src/util/collapsible.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Collapsible: () => (/* binding */ Collapsible)\n/* harmony export */ });\n/**\n * \n */\nclass Collapsible {\n    $container;\n    $header;\n    $content;\n    options;\n    isAnimating = false;\n    /**\n     * \n     * @param containerSelector \n     * @param options \n     * @returns Collapsible\n     */\n    static initAll(containerSelector, options = {}) {\n        const instances = [];\n        $(containerSelector).each(function () {\n            instances.push(new Collapsible($(this), options));\n        });\n        return instances;\n    }\n    /**\n     * \n     * @param $container \n     * @param options \n     */\n    constructor($container, options = {}) {\n        this.$container = $container;\n        // \n        const defaultOptions = {\n            headerSelector: '.collapsible-header',\n            contentSelector: '.collapsible-content',\n            expandedClass: 'expanded',\n            animationDuration: {\n                expand: 280,\n                collapse: 250,\n            },\n            easingFunction: 'swing',\n            initiallyExpanded: false,\n            callbacks: {},\n        };\n        // \n        this.options = { ...defaultOptions, ...options };\n        // \n        this.$header = this.$container.find(this.options.headerSelector);\n        this.$content = this.$container.find(this.options.contentSelector);\n        // \n        this.initEvents();\n        // \n        if (!this.options.initiallyExpanded) {\n            this.$container.removeClass(this.options.expandedClass);\n            this.$content.hide();\n        }\n        else {\n            this.$container.addClass(this.options.expandedClass);\n            this.$content.show();\n        }\n    }\n    /**\n     * \n     */\n    initEvents() {\n        this.$header.on('click', (event) => {\n            // \n            if (this.shouldIgnoreClick(event.target)) {\n                return;\n            }\n            this.toggle();\n        });\n    }\n    /**\n     * \n     * @param target \n     * @returns \n     */\n    shouldIgnoreClick(target) {\n        const $target = $(target);\n        // \n        if ($target.hasClass('toggle-switch') ||\n            $target.hasClass('toggle-input') ||\n            $target.hasClass('toggle-label') ||\n            $target.hasClass('toggle-handle') ||\n            $target.closest('.toggle-switch').length > 0) {\n            return true;\n        }\n        // \n        if ($target.hasClass('menu_button') ||\n            $target.closest('.menu_button').length > 0 ||\n            $target.hasClass('TavernHelper-button') ||\n            $target.closest('.TavernHelper-button').length > 0) {\n            return true;\n        }\n        // \n        if ($target.is('input, select, textarea, button, a') ||\n            $target.closest('input, select, textarea, button, a').length > 0) {\n            return true;\n        }\n        return false;\n    }\n    /**\n     * /\n     */\n    toggle() {\n        if (this.isAnimating)\n            return;\n        if (this.$container.hasClass(this.options.expandedClass)) {\n            this.collapse();\n        }\n        else {\n            this.expand();\n        }\n    }\n    /**\n     * \n     */\n    expand() {\n        if (this.isAnimating || this.$container.hasClass(this.options.expandedClass))\n            return;\n        this.isAnimating = true;\n        // \n        if (this.options.callbacks?.beforeExpand) {\n            this.options.callbacks.beforeExpand();\n        }\n        this.$container.addClass(this.options.expandedClass);\n        this.$content.addClass('animating');\n        this.$content.slideDown({\n            duration: this.options.animationDuration.expand,\n            easing: this.options.easingFunction,\n            start: function () {\n                $(this).css({\n                    opacity: 0,\n                    transform: 'translateY(-10px) scaleY(0.95)',\n                });\n            },\n            progress: function (_animation, progress) {\n                $(this).css({\n                    opacity: progress,\n                    transform: `translateY(${-10 * (1 - progress)}px) scaleY(${0.95 + 0.05 * progress})`,\n                });\n            },\n            complete: () => {\n                this.$content\n                    .css({\n                    opacity: '',\n                    transform: '',\n                })\n                    .removeClass('animating');\n                this.isAnimating = false;\n                // \n                if (this.options.callbacks?.afterExpand) {\n                    this.options.callbacks.afterExpand();\n                }\n            },\n        });\n    }\n    /**\n     * \n     */\n    collapse() {\n        if (this.isAnimating || !this.$container.hasClass(this.options.expandedClass))\n            return;\n        this.isAnimating = true;\n        // \n        if (this.options.callbacks?.beforeCollapse) {\n            this.options.callbacks.beforeCollapse();\n        }\n        this.$container.removeClass(this.options.expandedClass);\n        this.$content.addClass('animating');\n        this.$content.slideUp({\n            duration: this.options.animationDuration.collapse,\n            easing: this.options.easingFunction,\n            start: function () {\n                $(this).css({\n                    opacity: 1,\n                    transform: 'translateY(0) scaleY(1)',\n                });\n            },\n            progress: function (_animation, progress) {\n                const inverseProgress = 1 - progress;\n                $(this).css({\n                    opacity: inverseProgress,\n                    transform: `translateY(${-5 * progress}px) scaleY(${1 - 0.05 * progress})`,\n                });\n            },\n            complete: () => {\n                this.$content\n                    .css({\n                    opacity: '',\n                    transform: '',\n                })\n                    .removeClass('animating');\n                this.isAnimating = false;\n                // \n                if (this.options.callbacks?.afterCollapse) {\n                    this.options.callbacks.afterCollapse();\n                }\n            },\n        });\n    }\n    /**\n     * \n     * @returns \n     */\n    isExpanded() {\n        return this.$container.hasClass(this.options.expandedClass);\n    }\n    /**\n     * \n     */\n    destroy() {\n        this.$header.off('click');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZXIvLi9zcmMvdXRpbC9jb2xsYXBzaWJsZS50cz83OTlmIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5oqY5Y+g5bGV5byA6YWN572u5o6l5Y+jXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29sbGFwc2libGVPcHRpb25zIHtcbiAgLyoqIOinpuWPkeWZqOmAieaLqeWZqCAqL1xuICBoZWFkZXJTZWxlY3Rvcjogc3RyaW5nO1xuICAvKiog5YaF5a656YCJ5oup5ZmoICovXG4gIGNvbnRlbnRTZWxlY3Rvcjogc3RyaW5nO1xuICAvKiog5bGV5byA54q25oCB55qE57G75ZCNICovXG4gIGV4cGFuZGVkQ2xhc3M/OiBzdHJpbmc7XG4gIC8qKiDliqjnlLvmjIHnu63ml7bpl7Qo5q+r56eSKSAqL1xuICBhbmltYXRpb25EdXJhdGlvbj86IHtcbiAgICBleHBhbmQ6IG51bWJlcjtcbiAgICBjb2xsYXBzZTogbnVtYmVyO1xuICB9O1xuICAvKiog5Yqo55S757yT5Yqo5Ye95pWwICovXG4gIGVhc2luZ0Z1bmN0aW9uPzogc3RyaW5nO1xuICAvKiog5Yid5aeL54q25oCB5piv5ZCm5bGV5byAICovXG4gIGluaXRpYWxseUV4cGFuZGVkPzogYm9vbGVhbjtcbiAgLyoqIOWbnuiwg+WHveaVsCAqL1xuICBjYWxsYmFja3M/OiB7XG4gICAgYmVmb3JlRXhwYW5kPzogKCkgPT4gdm9pZDtcbiAgICBhZnRlckV4cGFuZD86ICgpID0+IHZvaWQ7XG4gICAgYmVmb3JlQ29sbGFwc2U/OiAoKSA9PiB2b2lkO1xuICAgIGFmdGVyQ29sbGFwc2U/OiAoKSA9PiB2b2lkO1xuICB9O1xufVxuXG4vKipcbiAqIOaKmOWPoOWxleW8gOWKn+iDveexu1xuICovXG5leHBvcnQgY2xhc3MgQ29sbGFwc2libGUge1xuICBwcml2YXRlICRjb250YWluZXI6IEpRdWVyeTtcbiAgcHJpdmF0ZSAkaGVhZGVyOiBKUXVlcnk7XG4gIHByaXZhdGUgJGNvbnRlbnQ6IEpRdWVyeTtcbiAgcHJpdmF0ZSBvcHRpb25zOiBDb2xsYXBzaWJsZU9wdGlvbnM7XG4gIHByaXZhdGUgaXNBbmltYXRpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvKipcbiAgICog6Z2Z5oCB5pa55rOV77ya5Yid5aeL5YyW5omA5pyJ56ym5ZCI6YCJ5oup5Zmo55qE5YWD57Sg5Li65Y+v5oqY5Y+g5YWD57SgXG4gICAqIEBwYXJhbSBjb250YWluZXJTZWxlY3RvciDlrrnlmajpgInmi6nlmahcbiAgICogQHBhcmFtIG9wdGlvbnMg6YWN572u6YCJ6aG5XG4gICAqIEByZXR1cm5zIENvbGxhcHNpYmxl5a6e5L6L5pWw57uEXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGluaXRBbGwoY29udGFpbmVyU2VsZWN0b3I6IHN0cmluZywgb3B0aW9uczogUGFydGlhbDxDb2xsYXBzaWJsZU9wdGlvbnM+ID0ge30pOiBDb2xsYXBzaWJsZVtdIHtcbiAgICBjb25zdCBpbnN0YW5jZXM6IENvbGxhcHNpYmxlW10gPSBbXTtcbiAgICAkKGNvbnRhaW5lclNlbGVjdG9yKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIGluc3RhbmNlcy5wdXNoKG5ldyBDb2xsYXBzaWJsZSgkKHRoaXMpLCBvcHRpb25zKSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGluc3RhbmNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiDmnoTpgKDlh73mlbBcbiAgICogQHBhcmFtICRjb250YWluZXIg5a655Zmo5YWD57SgXG4gICAqIEBwYXJhbSBvcHRpb25zIOmFjee9rumAiemhuVxuICAgKi9cbiAgY29uc3RydWN0b3IoJGNvbnRhaW5lcjogSlF1ZXJ5LCBvcHRpb25zOiBQYXJ0aWFsPENvbGxhcHNpYmxlT3B0aW9ucz4gPSB7fSkge1xuICAgIHRoaXMuJGNvbnRhaW5lciA9ICRjb250YWluZXI7XG5cbiAgICAvLyDpu5jorqTphY3nva5cbiAgICBjb25zdCBkZWZhdWx0T3B0aW9uczogQ29sbGFwc2libGVPcHRpb25zID0ge1xuICAgICAgaGVhZGVyU2VsZWN0b3I6ICcuY29sbGFwc2libGUtaGVhZGVyJyxcbiAgICAgIGNvbnRlbnRTZWxlY3RvcjogJy5jb2xsYXBzaWJsZS1jb250ZW50JyxcbiAgICAgIGV4cGFuZGVkQ2xhc3M6ICdleHBhbmRlZCcsXG4gICAgICBhbmltYXRpb25EdXJhdGlvbjoge1xuICAgICAgICBleHBhbmQ6IDI4MCxcbiAgICAgICAgY29sbGFwc2U6IDI1MCxcbiAgICAgIH0sXG4gICAgICBlYXNpbmdGdW5jdGlvbjogJ3N3aW5nJyxcbiAgICAgIGluaXRpYWxseUV4cGFuZGVkOiBmYWxzZSxcbiAgICAgIGNhbGxiYWNrczoge30sXG4gICAgfTtcblxuICAgIC8vIOWQiOW5tumFjee9rlxuICAgIHRoaXMub3B0aW9ucyA9IHsgLi4uZGVmYXVsdE9wdGlvbnMsIC4uLm9wdGlvbnMgfTtcblxuICAgIC8vIOiOt+WPluWFg+e0oFxuICAgIHRoaXMuJGhlYWRlciA9IHRoaXMuJGNvbnRhaW5lci5maW5kKHRoaXMub3B0aW9ucy5oZWFkZXJTZWxlY3Rvcik7XG4gICAgdGhpcy4kY29udGVudCA9IHRoaXMuJGNvbnRhaW5lci5maW5kKHRoaXMub3B0aW9ucy5jb250ZW50U2VsZWN0b3IpO1xuXG4gICAgLy8g5Yid5aeL5YyW5LqL5Lu2XG4gICAgdGhpcy5pbml0RXZlbnRzKCk7XG5cbiAgICAvLyDorr7nva7liJ3lp4vnirbmgIFcbiAgICBpZiAoIXRoaXMub3B0aW9ucy5pbml0aWFsbHlFeHBhbmRlZCkge1xuICAgICAgdGhpcy4kY29udGFpbmVyLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5leHBhbmRlZENsYXNzKTtcbiAgICAgIHRoaXMuJGNvbnRlbnQuaGlkZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiRjb250YWluZXIuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKTtcbiAgICAgIHRoaXMuJGNvbnRlbnQuc2hvdygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJbkuovku7ZcbiAgICovXG4gIHByaXZhdGUgaW5pdEV2ZW50cygpOiB2b2lkIHtcbiAgICB0aGlzLiRoZWFkZXIub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4ge1xuICAgICAgLy8g5qOA5p+l54K55Ye75piv5ZCm5Y+R55Sf5Zyo5o6n5Lu25LiK77yM5aaC5p6c5piv5YiZ5LiN6Kem5Y+R5oqY5Y+gXG4gICAgICBpZiAodGhpcy5zaG91bGRJZ25vcmVDbGljayhldmVudC50YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMudG9nZ2xlKCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5Yik5pat54K55Ye75piv5ZCm5bqU6K+l6KKr5b+955Wl77yI5LiN6Kem5Y+R5oqY5Y+g77yJXG4gICAqIEBwYXJhbSB0YXJnZXQg54K55Ye755qE55uu5qCH5YWD57SgXG4gICAqIEByZXR1cm5zIOaYr+WQpuW6lOivpeW/veeVpeeCueWHu1xuICAgKi9cbiAgcHJpdmF0ZSBzaG91bGRJZ25vcmVDbGljayh0YXJnZXQ6IEV2ZW50VGFyZ2V0KTogYm9vbGVhbiB7XG4gICAgY29uc3QgJHRhcmdldCA9ICQodGFyZ2V0KTtcblxuICAgIC8vIOajgOafpeaYr+WQpueCueWHu+WcqOW8gOWFs+aIluWFtuWtkOWFg+e0oOS4ilxuICAgIGlmIChcbiAgICAgICR0YXJnZXQuaGFzQ2xhc3MoJ3RvZ2dsZS1zd2l0Y2gnKSB8fFxuICAgICAgJHRhcmdldC5oYXNDbGFzcygndG9nZ2xlLWlucHV0JykgfHxcbiAgICAgICR0YXJnZXQuaGFzQ2xhc3MoJ3RvZ2dsZS1sYWJlbCcpIHx8XG4gICAgICAkdGFyZ2V0Lmhhc0NsYXNzKCd0b2dnbGUtaGFuZGxlJykgfHxcbiAgICAgICR0YXJnZXQuY2xvc2VzdCgnLnRvZ2dsZS1zd2l0Y2gnKS5sZW5ndGggPiAwXG4gICAgKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyDmo4Dmn6XmmK/lkKbngrnlh7vlnKjmjInpkq7miJblhbblrZDlhYPntKDkuIpcbiAgICBpZiAoXG4gICAgICAkdGFyZ2V0Lmhhc0NsYXNzKCdtZW51X2J1dHRvbicpIHx8XG4gICAgICAkdGFyZ2V0LmNsb3Nlc3QoJy5tZW51X2J1dHRvbicpLmxlbmd0aCA+IDAgfHxcbiAgICAgICR0YXJnZXQuaGFzQ2xhc3MoJ1RhdmVybkhlbHBlci1idXR0b24nKSB8fFxuICAgICAgJHRhcmdldC5jbG9zZXN0KCcuVGF2ZXJuSGVscGVyLWJ1dHRvbicpLmxlbmd0aCA+IDBcbiAgICApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIOajgOafpeaYr+WQpueCueWHu+WcqOihqOWNleWFg+e0oOS4ilxuICAgIGlmIChcbiAgICAgICR0YXJnZXQuaXMoJ2lucHV0LCBzZWxlY3QsIHRleHRhcmVhLCBidXR0b24sIGEnKSB8fFxuICAgICAgJHRhcmdldC5jbG9zZXN0KCdpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSwgYnV0dG9uLCBhJykubGVuZ3RoID4gMFxuICAgICkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIh+aNouWxleW8gC/mipjlj6DnirbmgIFcbiAgICovXG4gIHB1YmxpYyB0b2dnbGUoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNBbmltYXRpbmcpIHJldHVybjtcblxuICAgIGlmICh0aGlzLiRjb250YWluZXIuaGFzQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKSkge1xuICAgICAgdGhpcy5jb2xsYXBzZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmV4cGFuZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlsZXlvIDlhoXlrrlcbiAgICovXG4gIHB1YmxpYyBleHBhbmQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNBbmltYXRpbmcgfHwgdGhpcy4kY29udGFpbmVyLmhhc0NsYXNzKHRoaXMub3B0aW9ucy5leHBhbmRlZENsYXNzISkpIHJldHVybjtcblxuICAgIHRoaXMuaXNBbmltYXRpbmcgPSB0cnVlO1xuXG4gICAgLy8g5omn6KGM5bGV5byA5YmN5Zue6LCDXG4gICAgaWYgKHRoaXMub3B0aW9ucy5jYWxsYmFja3M/LmJlZm9yZUV4cGFuZCkge1xuICAgICAgdGhpcy5vcHRpb25zLmNhbGxiYWNrcy5iZWZvcmVFeHBhbmQoKTtcbiAgICB9XG5cbiAgICB0aGlzLiRjb250YWluZXIuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKTtcbiAgICB0aGlzLiRjb250ZW50LmFkZENsYXNzKCdhbmltYXRpbmcnKTtcblxuICAgIHRoaXMuJGNvbnRlbnQuc2xpZGVEb3duKHtcbiAgICAgIGR1cmF0aW9uOiB0aGlzLm9wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb24hLmV4cGFuZCxcbiAgICAgIGVhc2luZzogdGhpcy5vcHRpb25zLmVhc2luZ0Z1bmN0aW9uLFxuICAgICAgc3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCh0aGlzKS5jc3Moe1xuICAgICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgtMTBweCkgc2NhbGVZKDAuOTUpJyxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgcHJvZ3Jlc3M6IGZ1bmN0aW9uIChfYW5pbWF0aW9uLCBwcm9ncmVzcykge1xuICAgICAgICAkKHRoaXMpLmNzcyh7XG4gICAgICAgICAgb3BhY2l0eTogcHJvZ3Jlc3MsXG4gICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgkey0xMCAqICgxIC0gcHJvZ3Jlc3MpfXB4KSBzY2FsZVkoJHswLjk1ICsgMC4wNSAqIHByb2dyZXNzfSlgLFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBjb21wbGV0ZTogKCkgPT4ge1xuICAgICAgICB0aGlzLiRjb250ZW50XG4gICAgICAgICAgLmNzcyh7XG4gICAgICAgICAgICBvcGFjaXR5OiAnJyxcbiAgICAgICAgICAgIHRyYW5zZm9ybTogJycsXG4gICAgICAgICAgfSlcbiAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2FuaW1hdGluZycpO1xuXG4gICAgICAgIHRoaXMuaXNBbmltYXRpbmcgPSBmYWxzZTtcblxuICAgICAgICAvLyDmiafooYzlsZXlvIDlkI7lm57osINcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jYWxsYmFja3M/LmFmdGVyRXhwYW5kKSB7XG4gICAgICAgICAgdGhpcy5vcHRpb25zLmNhbGxiYWNrcy5hZnRlckV4cGFuZCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaKmOWPoOWGheWuuVxuICAgKi9cbiAgcHVibGljIGNvbGxhcHNlKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlzQW5pbWF0aW5nIHx8ICF0aGlzLiRjb250YWluZXIuaGFzQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKSkgcmV0dXJuO1xuXG4gICAgdGhpcy5pc0FuaW1hdGluZyA9IHRydWU7XG5cbiAgICAvLyDmiafooYzmipjlj6DliY3lm57osINcbiAgICBpZiAodGhpcy5vcHRpb25zLmNhbGxiYWNrcz8uYmVmb3JlQ29sbGFwc2UpIHtcbiAgICAgIHRoaXMub3B0aW9ucy5jYWxsYmFja3MuYmVmb3JlQ29sbGFwc2UoKTtcbiAgICB9XG5cbiAgICB0aGlzLiRjb250YWluZXIucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKTtcbiAgICB0aGlzLiRjb250ZW50LmFkZENsYXNzKCdhbmltYXRpbmcnKTtcblxuICAgIHRoaXMuJGNvbnRlbnQuc2xpZGVVcCh7XG4gICAgICBkdXJhdGlvbjogdGhpcy5vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uIS5jb2xsYXBzZSxcbiAgICAgIGVhc2luZzogdGhpcy5vcHRpb25zLmVhc2luZ0Z1bmN0aW9uLFxuICAgICAgc3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCh0aGlzKS5jc3Moe1xuICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgwKSBzY2FsZVkoMSknLFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBwcm9ncmVzczogZnVuY3Rpb24gKF9hbmltYXRpb24sIHByb2dyZXNzKSB7XG4gICAgICAgIGNvbnN0IGludmVyc2VQcm9ncmVzcyA9IDEgLSBwcm9ncmVzcztcbiAgICAgICAgJCh0aGlzKS5jc3Moe1xuICAgICAgICAgIG9wYWNpdHk6IGludmVyc2VQcm9ncmVzcyxcbiAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7LTUgKiBwcm9ncmVzc31weCkgc2NhbGVZKCR7MSAtIDAuMDUgKiBwcm9ncmVzc30pYCxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgY29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgdGhpcy4kY29udGVudFxuICAgICAgICAgIC5jc3Moe1xuICAgICAgICAgICAgb3BhY2l0eTogJycsXG4gICAgICAgICAgICB0cmFuc2Zvcm06ICcnLFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLnJlbW92ZUNsYXNzKCdhbmltYXRpbmcnKTtcblxuICAgICAgICB0aGlzLmlzQW5pbWF0aW5nID0gZmFsc2U7XG5cbiAgICAgICAgLy8g5omn6KGM5oqY5Y+g5ZCO5Zue6LCDXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY2FsbGJhY2tzPy5hZnRlckNvbGxhcHNlKSB7XG4gICAgICAgICAgdGhpcy5vcHRpb25zLmNhbGxiYWNrcy5hZnRlckNvbGxhcHNlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5piv5ZCm5bey5bGV5byAXG4gICAqIEByZXR1cm5zIOaYr+WQpuW3suWxleW8gFxuICAgKi9cbiAgcHVibGljIGlzRXhwYW5kZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuJGNvbnRhaW5lci5oYXNDbGFzcyh0aGlzLm9wdGlvbnMuZXhwYW5kZWRDbGFzcyEpO1xuICB9XG5cbiAgLyoqXG4gICAqIOmUgOavgeWunuS+i++8jOenu+mZpOS6i+S7tuebkeWQrFxuICAgKi9cbiAgcHVibGljIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy4kaGVhZGVyLm9mZignY2xpY2snKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/util/collapsible.ts\n")},"./src/util/extension_variables.ts":
/*!*****************************************!*\
  !*** ./src/util/extension_variables.ts ***!
  \*****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   charsPath: () => (/* binding */ charsPath),\n/* harmony export */   extensionFolderPath: () => (/* binding */ extensionFolderPath),\n/* harmony export */   extensionName: () => (/* binding */ extensionName),\n/* harmony export */   extensionSettingName: () => (/* binding */ extensionSettingName),\n/* harmony export */   getCharAvatarPath: () => (/* binding */ getCharAvatarPath),\n/* harmony export */   getOrSaveSettingValue: () => (/* binding */ getOrSaveSettingValue),\n/* harmony export */   getSettingValue: () => (/* binding */ getSettingValue),\n/* harmony export */   getUserAvatarPath: () => (/* binding */ getUserAvatarPath),\n/* harmony export */   saveSettingValue: () => (/* binding */ saveSettingValue)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n// TODO:  any\n\n\nconst extensionName = 'JS-Slash-Runner';\nconst extensionSettingName = 'TavernHelper';\nconst extensionFolderPath = `third-party/${extensionName}`;\n// \nconst charsPath = '/characters/';\nconst getUserAvatarPath = () => `./User Avatars/${_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.user_avatar}`;\nconst getCharAvatarPath = () => {\n    //@ts-ignore\n    const thumbnailPath = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getThumbnailUrl)('avatar', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].avatar);\n    const targetAvatarImg = thumbnailPath.substring(thumbnailPath.lastIndexOf('=') + 1);\n    return charsPath + targetAvatarImg;\n};\n/**\n * \n *\n * @param path \n * @param default_value \n * @returns \n */\nfunction getSettingValue(path, default_value = undefined) {\n    // @ts-ignore\n    return _.get(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings[extensionSettingName], path, default_value);\n}\n/**\n * \n *\n * @param path \n * @param value \n * @returns \n */\nfunction saveSettingValue(path, value) {\n    // @ts-ignore\n    _.set(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings[extensionSettingName], path, value);\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n    return value;\n}\n/**\n *  `default_value`\n *\n * @param path \n * @param default_value \n * @returns \n */\nasync function getOrSaveSettingValue(path, default_value) {\n    // @ts-ignore\n    if (_.has(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings[extensionSettingName], path)) {\n        return getSettingValue(path);\n    }\n    return saveSettingValue(path, default_value);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMEJBQTBCO0FBQ3VGO0FBQzVDO0FBRTlELE1BQU0sYUFBYSxHQUFHLGlCQUFpQixDQUFDO0FBQ3hDLE1BQU0sb0JBQW9CLEdBQUcsY0FBYyxDQUFDO0FBRTVDLE1BQU0sbUJBQW1CLEdBQUcsZUFBZSxhQUFhLEVBQUUsQ0FBQztBQUVsRSxTQUFTO0FBQ0YsTUFBTSxTQUFTLEdBQUcsY0FBYyxDQUFDO0FBQ2pDLE1BQU0saUJBQWlCLEdBQUcsR0FBRyxFQUFFLENBQUMsa0JBQWtCLDREQUFXLEVBQUUsQ0FBQztBQUNoRSxNQUFNLGlCQUFpQixHQUFHLEdBQUcsRUFBRTtJQUNwQyxZQUFZO0lBQ1osTUFBTSxhQUFhLEdBQUcsb0VBQWUsQ0FBQyxRQUFRLEVBQUUsMkRBQVUsQ0FBQywwREFBUyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDOUUsTUFBTSxlQUFlLEdBQUcsYUFBYSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ3BGLE9BQU8sU0FBUyxHQUFHLGVBQWUsQ0FBQztBQUNyQyxDQUFDLENBQUM7QUFFRjs7Ozs7O0dBTUc7QUFDSSxTQUFTLGVBQWUsQ0FBQyxJQUFZLEVBQUUsZ0JBQXFCLFNBQVM7SUFDMUUsYUFBYTtJQUNiLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQywrRUFBa0IsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLElBQUksRUFBRSxhQUFhLENBQUMsQ0FBQztBQUM5RSxDQUFDO0FBRUQ7Ozs7OztHQU1HO0FBQ0ksU0FBUyxnQkFBZ0IsQ0FBSSxJQUFZLEVBQUUsS0FBUTtJQUN4RCxhQUFhO0lBQ2IsQ0FBQyxDQUFDLEdBQUcsQ0FBQywrRUFBa0IsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztJQUM3RCwwRUFBcUIsRUFBRSxDQUFDO0lBQ3hCLE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQUVEOzs7Ozs7R0FNRztBQUNJLEtBQUssVUFBVSxxQkFBcUIsQ0FBSSxJQUFZLEVBQUUsYUFBZ0I7SUFDM0UsYUFBYTtJQUNiLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQywrRUFBa0IsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUM7UUFDMUQsT0FBTyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUNELE9BQU8sZ0JBQWdCLENBQUMsSUFBSSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBQy9DLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzLnRzP2I4MTEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVE9ETzog5Li66K6+572u5Y+Y6YeP5re75Yqg57G75Z6L6ICM6Z2e5L2/55SoIGFueVxuaW1wb3J0IHsgY2hhcmFjdGVycywgZ2V0VGh1bWJuYWlsVXJsLCBzYXZlU2V0dGluZ3NEZWJvdW5jZWQsIHRoaXNfY2hpZCwgdXNlcl9hdmF0YXIgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGV4dGVuc2lvbl9zZXR0aW5ncyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuXG5leHBvcnQgY29uc3QgZXh0ZW5zaW9uTmFtZSA9ICdKUy1TbGFzaC1SdW5uZXInO1xuZXhwb3J0IGNvbnN0IGV4dGVuc2lvblNldHRpbmdOYW1lID0gJ1RhdmVybkhlbHBlcic7XG5cbmV4cG9ydCBjb25zdCBleHRlbnNpb25Gb2xkZXJQYXRoID0gYHRoaXJkLXBhcnR5LyR7ZXh0ZW5zaW9uTmFtZX1gO1xuXG4vLyDojrflj5blpLTlg4/ljp/lm75cbmV4cG9ydCBjb25zdCBjaGFyc1BhdGggPSAnL2NoYXJhY3RlcnMvJztcbmV4cG9ydCBjb25zdCBnZXRVc2VyQXZhdGFyUGF0aCA9ICgpID0+IGAuL1VzZXIgQXZhdGFycy8ke3VzZXJfYXZhdGFyfWA7XG5leHBvcnQgY29uc3QgZ2V0Q2hhckF2YXRhclBhdGggPSAoKSA9PiB7XG4gIC8vQHRzLWlnbm9yZVxuICBjb25zdCB0aHVtYm5haWxQYXRoID0gZ2V0VGh1bWJuYWlsVXJsKCdhdmF0YXInLCBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0uYXZhdGFyKTtcbiAgY29uc3QgdGFyZ2V0QXZhdGFySW1nID0gdGh1bWJuYWlsUGF0aC5zdWJzdHJpbmcodGh1bWJuYWlsUGF0aC5sYXN0SW5kZXhPZignPScpICsgMSk7XG4gIHJldHVybiBjaGFyc1BhdGggKyB0YXJnZXRBdmF0YXJJbWc7XG59O1xuXG4vKipcbiAqIOiOt+WPluaJqeWxleiuvue9ruWPmOmHj+eahOWAvFxuICpcbiAqIEBwYXJhbSBwYXRoIOiuvue9ruWPmOmHj+eahOmUrlxuICogQHBhcmFtIGRlZmF1bHRfdmFsdWUg5rKh5pyJ6K+l6ZSu5pe255qE6buY6K6k5YC8XG4gKiBAcmV0dXJucyDorr7nva7lj5jph4/nmoTlgLxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNldHRpbmdWYWx1ZShwYXRoOiBzdHJpbmcsIGRlZmF1bHRfdmFsdWU6IGFueSA9IHVuZGVmaW5lZCk6IGFueSB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgcmV0dXJuIF8uZ2V0KGV4dGVuc2lvbl9zZXR0aW5nc1tleHRlbnNpb25TZXR0aW5nTmFtZV0sIHBhdGgsIGRlZmF1bHRfdmFsdWUpO1xufVxuXG4vKipcbiAqIOS/neWtmOaJqeWxleiuvue9ruWPmOmHj+eahOWAvFxuICpcbiAqIEBwYXJhbSBwYXRoIOiuvue9ruWPmOmHj+eahOmUrlxuICogQHBhcmFtIHZhbHVlIOiuvue9ruWPmOmHj+eahOWAvFxuICogQHJldHVybnMg6K6+572u5Y+Y6YeP55qE5YC8XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzYXZlU2V0dGluZ1ZhbHVlPFQ+KHBhdGg6IHN0cmluZywgdmFsdWU6IFQpOiBUIHtcbiAgLy8gQHRzLWlnbm9yZVxuICBfLnNldChleHRlbnNpb25fc2V0dGluZ3NbZXh0ZW5zaW9uU2V0dGluZ05hbWVdLCBwYXRoLCB2YWx1ZSk7XG4gIHNhdmVTZXR0aW5nc0RlYm91bmNlZCgpO1xuICByZXR1cm4gdmFsdWU7XG59XG5cbi8qKlxuICog5aaC5p6c5omp5bGV5pyJ5p+Q6K6+572u5Y+Y6YeP77yM5YiZ6L+U5Zue6K+l6K6+572u5Y+Y6YeP55qE5YC877yM5ZCm5YiZ6K6+572u6K+l6K6+572u5Y+Y6YeP55qE5YC85Li6IGBkZWZhdWx0X3ZhbHVlYFxuICpcbiAqIEBwYXJhbSBwYXRoIOiuvue9ruWPmOmHj+eahOmUrlxuICogQHBhcmFtIGRlZmF1bHRfdmFsdWUg5omp5bGV5rKh5pyJ6K+l6K6+572u5Y+Y6YeP5pe25bqU6K+l6K6+572u5bm26L+U5Zue55qE6buY6K6k5YC8XG4gKiBAcmV0dXJucyDorr7nva7lj5jph4/nmoTlgLxcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yU2F2ZVNldHRpbmdWYWx1ZTxUPihwYXRoOiBzdHJpbmcsIGRlZmF1bHRfdmFsdWU6IFQpOiBQcm9taXNlPFQ+IHtcbiAgLy8gQHRzLWlnbm9yZVxuICBpZiAoXy5oYXMoZXh0ZW5zaW9uX3NldHRpbmdzW2V4dGVuc2lvblNldHRpbmdOYW1lXSwgcGF0aCkpIHtcbiAgICByZXR1cm4gZ2V0U2V0dGluZ1ZhbHVlKHBhdGgpO1xuICB9XG4gIHJldHVybiBzYXZlU2V0dGluZ1ZhbHVlKHBhdGgsIGRlZmF1bHRfdmFsdWUpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/util/extension_variables.ts\n")},"./src/util/map_util.ts":
/*!******************************!*\
  !*** ./src/util/map_util.ts ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extract: () => (/* binding */ extract),\n/* harmony export */   get_or_set: () => (/* binding */ get_or_set),\n/* harmony export */   try_set: () => (/* binding */ try_set)\n/* harmony export */ });\nfunction try_set(map, key, value) {\n    if (map.has(key)) {\n        return false;\n    }\n    map.set(key, value);\n    return true;\n}\nfunction get_or_set(map, key, defaulter) {\n    const existing_value = map.get(key);\n    if (existing_value) {\n        return existing_value;\n    }\n    const default_value = defaulter();\n    map.set(key, default_value);\n    return default_value;\n}\nfunction extract(map, key) {\n    const value = map.get(key);\n    if (!value) {\n        return undefined;\n    }\n    map.delete(key);\n    return value;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9tYXBfdXRpbC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBTyxTQUFTLE9BQU8sQ0FBTyxHQUFjLEVBQUUsR0FBTSxFQUFFLEtBQVE7SUFDNUQsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDakIsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0lBQ0QsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDcEIsT0FBTyxJQUFJLENBQUM7QUFDZCxDQUFDO0FBRU0sU0FBUyxVQUFVLENBQU8sR0FBYyxFQUFFLEdBQU0sRUFBRSxTQUFrQjtJQUN6RSxNQUFNLGNBQWMsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3BDLElBQUksY0FBYyxFQUFFLENBQUM7UUFDbkIsT0FBTyxjQUFjLENBQUM7SUFDeEIsQ0FBQztJQUNELE1BQU0sYUFBYSxHQUFHLFNBQVMsRUFBRSxDQUFDO0lBQ2xDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLGFBQWEsQ0FBQyxDQUFDO0lBQzVCLE9BQU8sYUFBYSxDQUFDO0FBQ3ZCLENBQUM7QUFFTSxTQUFTLE9BQU8sQ0FBTyxHQUFjLEVBQUUsR0FBTTtJQUNsRCxNQUFNLEtBQUssR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzNCLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNYLE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7SUFDRCxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2hCLE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy91dGlsL21hcF91dGlsLnRzPzQ5NmUiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIHRyeV9zZXQ8SywgVj4obWFwOiBNYXA8SywgVj4sIGtleTogSywgdmFsdWU6IFYpOiBib29sZWFuIHtcbiAgaWYgKG1hcC5oYXMoa2V5KSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBtYXAuc2V0KGtleSwgdmFsdWUpO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldF9vcl9zZXQ8SywgVj4obWFwOiBNYXA8SywgVj4sIGtleTogSywgZGVmYXVsdGVyOiAoKSA9PiBWKTogViB7XG4gIGNvbnN0IGV4aXN0aW5nX3ZhbHVlID0gbWFwLmdldChrZXkpO1xuICBpZiAoZXhpc3RpbmdfdmFsdWUpIHtcbiAgICByZXR1cm4gZXhpc3RpbmdfdmFsdWU7XG4gIH1cbiAgY29uc3QgZGVmYXVsdF92YWx1ZSA9IGRlZmF1bHRlcigpO1xuICBtYXAuc2V0KGtleSwgZGVmYXVsdF92YWx1ZSk7XG4gIHJldHVybiBkZWZhdWx0X3ZhbHVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdDxLLCBWPihtYXA6IE1hcDxLLCBWPiwga2V5OiBLKTogViB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IHZhbHVlID0gbWFwLmdldChrZXkpO1xuICBpZiAoIXZhbHVlKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBtYXAuZGVsZXRlKGtleSk7XG4gIHJldHVybiB2YWx1ZTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/util/map_util.ts\n")},"./src/util/render_markdown.ts":
/*!*************************************!*\
  !*** ./src/util/render_markdown.ts ***!
  \*************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   renderMarkdown: () => (/* binding */ renderMarkdown)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n\nfunction renderMarkdown(markdown) {\n    const converter = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadMarkdownProcessor)();\n    let htmlText = converter.makeHtml(markdown);\n    htmlText = `<div style="text-align: left; max-height:80dvh; overflow-y: auto;">${htmlText}</div>`;\n    return htmlText;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9yZW5kZXJfbWFya2Rvd24udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBOEQ7QUFFdkQsU0FBUyxjQUFjLENBQUMsUUFBZ0I7SUFDN0MsTUFBTSxTQUFTLEdBQUcsNEVBQXVCLEVBQUUsQ0FBQztJQUM1QyxJQUFJLFFBQVEsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzVDLFFBQVEsR0FBRyxzRUFBc0UsUUFBUSxRQUFRLENBQUM7SUFDbEcsT0FBTyxRQUFRLENBQUM7QUFDbEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy91dGlsL3JlbmRlcl9tYXJrZG93bi50cz9mOGJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbG9hZE1hcmtkb3duUHJvY2Vzc29yIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJNYXJrZG93bihtYXJrZG93bjogc3RyaW5nKSB7XG4gIGNvbnN0IGNvbnZlcnRlciA9IHJlbG9hZE1hcmtkb3duUHJvY2Vzc29yKCk7XG4gIGxldCBodG1sVGV4dCA9IGNvbnZlcnRlci5tYWtlSHRtbChtYXJrZG93bik7XG4gIGh0bWxUZXh0ID0gYDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBsZWZ0OyBtYXgtaGVpZ2h0OjgwZHZoOyBvdmVyZmxvdy15OiBhdXRvO1wiPiR7aHRtbFRleHR9PC9kaXY+YDtcbiAgcmV0dXJuIGh0bWxUZXh0O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/util/render_markdown.ts\n')},"@sillytavern/lib/jszip.min.js":
/*!**************************************************!*\
  !*** external "../../../../../lib/jszip.min.js" ***!
  \**************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__lib_jszip_min_js_715b4132__},"@sillytavern/script":
/*!*******************************************!*\
  !*** external "../../../../../script.js" ***!
  \*******************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__},"@sillytavern/scripts/PromptManager":
/*!**********************************************************!*\
  !*** external "../../../../../scripts/PromptManager.js" ***!
  \**********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_PromptManager_js_3415be00__},"@sillytavern/scripts/RossAscends-mods":
/*!*************************************************************!*\
  !*** external "../../../../../scripts/RossAscends-mods.js" ***!
  \*************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_RossAscends_mods_js_224b6398__},"@sillytavern/scripts/authors-note":
/*!*********************************************************!*\
  !*** external "../../../../../scripts/authors-note.js" ***!
  \*********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_authors_note_js_60883899__},"@sillytavern/scripts/extensions":
/*!*******************************************************!*\
  !*** external "../../../../../scripts/extensions.js" ***!
  \*******************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_extensions_js_86ff8498__},"@sillytavern/scripts/extensions/regex/engine":
/*!********************************************************************!*\
  !*** external "../../../../../scripts/extensions/regex/engine.js" ***!
  \********************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_extensions_regex_engine_js_bce0a3be__},"@sillytavern/scripts/group-chats":
/*!********************************************************!*\
  !*** external "../../../../../scripts/group-chats.js" ***!
  \********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_group_chats_js_79178f54__},"@sillytavern/scripts/i18n":
/*!*************************************************!*\
  !*** external "../../../../../scripts/i18n.js" ***!
  \*************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_i18n_js_b4bbac2e__},"@sillytavern/scripts/macros":
/*!***************************************************!*\
  !*** external "../../../../../scripts/macros.js" ***!
  \***************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_macros_js_3c1c7442__},"@sillytavern/scripts/openai":
/*!***************************************************!*\
  !*** external "../../../../../scripts/openai.js" ***!
  \***************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_openai_js_991751fb__},"@sillytavern/scripts/popup":
/*!**************************************************!*\
  !*** external "../../../../../scripts/popup.js" ***!
  \**************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_popup_js_d782a329__},"@sillytavern/scripts/power-user":
/*!*******************************************************!*\
  !*** external "../../../../../scripts/power-user.js" ***!
  \*******************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_power_user_js_8eb57d1d__},"@sillytavern/scripts/slash-commands":
/*!***********************************************************!*\
  !*** external "../../../../../scripts/slash-commands.js" ***!
  \***********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_js_aacea5c1__},"@sillytavern/scripts/slash-commands/SlashCommand":
/*!************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommand.js" ***!
  \************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommand_js_7714abe5__},"@sillytavern/scripts/slash-commands/SlashCommandArgument":
/*!********************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandArgument.js" ***!
  \********************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandArgument_js_9ae1817d__},"@sillytavern/scripts/slash-commands/SlashCommandCommonEnumsProvider":
/*!*******************************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandCommonEnumsProvider.js" ***!
  \*******************************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandCommonEnumsProvider_js_56229d14__},"@sillytavern/scripts/slash-commands/SlashCommandEnumValue":
/*!*********************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandEnumValue.js" ***!
  \*********************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandEnumValue_js_4a448917__},"@sillytavern/scripts/slash-commands/SlashCommandParser":
/*!******************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandParser.js" ***!
  \******************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandParser_js_585e5f4d__},"@sillytavern/scripts/tags":
/*!*************************************************!*\
  !*** external "../../../../../scripts/tags.js" ***!
  \*************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_tags_js_fe93ed66__},"@sillytavern/scripts/utils":
/*!**************************************************!*\
  !*** external "../../../../../scripts/utils.js" ***!
  \**************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_utils_js_ee651b62__},"@sillytavern/scripts/world-info":
/*!*******************************************************!*\
  !*** external "../../../../../scripts/world-info.js" ***!
  \*******************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_world_info_js_1b945dbf__}},__webpack_module_cache__={},installedChunks,installChunk;function __webpack_require__(Q){var U=__webpack_module_cache__[Q];if(void 0!==U)return U.exports;var F=__webpack_module_cache__[Q]={exports:{}};return __webpack_modules__[Q](F,F.exports,__webpack_require__),F.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.d=(Q,U)=>{for(var F in U)__webpack_require__.o(U,F)&&!__webpack_require__.o(Q,F)&&Object.defineProperty(Q,F,{enumerable:!0,get:U[F]})},__webpack_require__.f={},__webpack_require__.e=Q=>Promise.all(Object.keys(__webpack_require__.f).reduce(((U,F)=>(__webpack_require__.f[F](Q,U),U)),[])),__webpack_require__.u=Q=>Q+".77a08c5046f1d6e53d95.chunk.js",__webpack_require__.o=(Q,U)=>Object.prototype.hasOwnProperty.call(Q,U),__webpack_require__.r=Q=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Q,"__esModule",{value:!0})},installedChunks={main:0},installChunk=Q=>{var U,F,B=Q.__webpack_ids__,s=Q.__webpack_modules__,n=Q.__webpack_runtime__,e=0;for(U in s)__webpack_require__.o(s,U)&&(__webpack_require__.m[U]=s[U]);for(n&&n(__webpack_require__);e<B.length;e++)F=B[e],__webpack_require__.o(installedChunks,F)&&installedChunks[F]&&installedChunks[F][0](),installedChunks[B[e]]=0},__webpack_require__.f.j=(Q,U)=>{var F=__webpack_require__.o(installedChunks,Q)?installedChunks[Q]:void 0;if(0!==F)if(F)U.push(F[1]);else{var B=import("./"+__webpack_require__.u(Q)).then(installChunk,(U=>{throw 0!==installedChunks[Q]&&(installedChunks[Q]=void 0),U}));B=Promise.race([B,new Promise((U=>F=installedChunks[Q]=[U]))]),U.push(F[1]=B)}};var __webpack_exports__=__webpack_require__("./src/index.ts");